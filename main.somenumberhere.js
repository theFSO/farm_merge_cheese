(()=>{
    "use strict";
    // FMC LMAO
    document.addEventListener('DOMContentLoaded', function() {
    // Create and style the button
    const button = document.createElement('button');
    button.innerText = '别问';
    button.style.position = 'fixed';
    button.style.width = '150px';
    button.style.top = '10px';
    button.style.left = '50%';
    button.style.transform = 'translateX(-50%)';
    button.style.padding = '10px 20px';
    button.style.fontSize = '16px';
    button.style.cursor = 'pointer';
    document.body.appendChild(button);
    
    // Create and style the menu
    const menu = document.createElement('div');
    menu.style.position = 'fixed';
    menu.style.top = '50%';
    menu.style.left = '50%';
    menu.style.transform = 'translate(-50%, -50%)';
    menu.style.padding = '20px';
    menu.style.border = '1px solid #ccc';
    menu.style.backgroundColor = '#fff';
    menu.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.1)';
    menu.style.display = 'none';
    document.body.appendChild(menu);
    
    // Create the form elements
    const form = document.createElement('form');
    
    var checkbox1 = document.createElement('input');
    checkbox1.type = 'checkbox';
    checkbox1.id = 'fmcNoConsume';
    const label1 = document.createElement('label');
    label1.htmlFor = '无体力宝石消耗';
    label1.innerText = '无体力宝石消耗';
    form.appendChild(checkbox1);
    form.appendChild(label1);
    form.appendChild(document.createElement('br'));
    
    var checkbox2 = document.createElement('input');
    checkbox2.type = 'checkbox';
    checkbox2.id = 'fmcAlways';
    const label2 = document.createElement('label');
    label2.htmlFor = '永远幸运合成';
    label2.innerText = '永远幸运合成';
    form.appendChild(checkbox2);
    form.appendChild(label2);
    form.appendChild(document.createElement('br'));
    
    const dropdownLabel = document.createElement('label');
    dropdownLabel.htmlFor = 'dropdown';
    dropdownLabel.innerText = '合成修改:';
    form.appendChild(dropdownLabel);
    
    var dropdown = document.createElement('select');
    dropdown.id = 'dropdown';
    const option1 = document.createElement('option');
    option1.value = 'normal';
    option1.innerText = '正常';
    const option2 = document.createElement('option');
    option2.value = 'empty';
    option2.innerText = '空白';
    const option3 = document.createElement('option');
    option3.value = 'gem_6';
    option3.innerText = '顶级宝石';
    const option4 = document.createElement('option');
    option4.value = 'coin_8';
    option4.innerText = '顶级金币';
    const option5 = document.createElement('option');
    option5.value = 'lv4';
    option5.innerText = '自动满级';
    const option6 = document.createElement('option');
    option6.value = 'toolbox';
    option6.innerText = '大工具箱';
    dropdown.appendChild(option1);
    dropdown.appendChild(option2);
    dropdown.appendChild(option3);
    dropdown.appendChild(option4);
    dropdown.appendChild(option5);
    dropdown.appendChild(option6);
    form.appendChild(dropdown);
    
    menu.appendChild(form);
    
    // Add event listener to toggle the menu
    button.addEventListener('click', function() {
    if (menu.style.display === 'none') {
      menu.style.display = 'block';
    } else {
      menu.style.display = 'none';
    }
    });
    });
    var e, t = {
        9529: (e,t,i)=>{
            i.d(t, {
                B: ()=>IO
            });
            var n = i(7582)
              , r = i(3206)
              , o = i(1550)
              , a = i(9093)
              , s = (new URLSearchParams(window.location.search),
            i(7614))
              , _ = i(235)
              , c = i(2844);
            function l(e) {
                try {
                    return localStorage.getItem(e)
                } catch (e) {
                    return null
                }
            }
            function u(e, t) {
                try {
                    return localStorage.setItem(e, t)
                } catch (e) {}
            }
            function d(e) {
                try {
                    localStorage.removeItem(e)
                } catch (e) {}
            }
            var h = function() {
                function e() {}
                return Object.defineProperty(e.prototype, "player", {
                    get: function() {
                        if (this._player)
                            return this._player;
                        var e = l("mock-player-id")
                          , t = !1;
                        return e || (t = !0,
                        u("mock-player-id", e = (0,
                        c.DM)())),
                        this._player = {
                            id: e,
                            name: e,
                            photo: "http://cdn.pixabay.com/photo/2016/08/08/09/17/avatar-1577909_960_720.png",
                            isNewAccount: t
                        },
                        this._player
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initializeSDK = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, t]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.initializePlayer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.authenticateBackend = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, e.auth.customAuth(this.player.id, this.player.name)];
                            case 1:
                                return [2, t.sent()]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.setupBackendAccount = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return i = Math.round((new Date).getTimezoneOffset() / 60),
                            [2, e.playerprofile.setupAccount(this.player.id, this.player.name, this.player.photo, i, t)]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }()
              , p = i(3113)
              , v = i(4842)
              , g = function() {
                function e() {}
                return e.AD_BLOCK = {
                    alias: "ad_block"
                },
                e.CONSENT = {
                    alias: "consent"
                },
                e.CS_IMAGES = {
                    alias: "cs_images"
                },
                e.CU_IMAGES = {
                    alias: "cu_images"
                },
                e.DAILY_BONUS = {
                    alias: "daily_bonus"
                },
                e.DAILY_CHALLENGE = {
                    alias: "daily_challenge"
                },
                e.DANDELION = {
                    alias: "dandelion"
                },
                e.DECALS = {
                    alias: "decals"
                },
                e.DISCOVERY = {
                    alias: "discovery"
                },
                e.EVENTS_BLACKFRIDAY = {
                    alias: "events_blackfriday"
                },
                e.EVENTS_CHOPCHOP = {
                    alias: "events_chopchop"
                },
                e.EVENTS_CHRISTMAS_DEALS = {
                    alias: "events_christmas_deals"
                },
                e.EVENTS_GOLDENCARROT = {
                    alias: "events_goldencarrot"
                },
                e.EVENTS_GOLDENCHRISTMAS = {
                    alias: "events_goldenchristmas"
                },
                e.EVENTS_GOLDENPUMPKIN = {
                    alias: "events_goldenpumpkin"
                },
                e.EVENTS_PIGGYBANK = {
                    alias: "events_piggybank"
                },
                e.EVENTS_SHARED = {
                    alias: "events_shared"
                },
                e.FAKE_ADS = {
                    alias: "fake_ads"
                },
                e.FLOWERS = {
                    alias: "flowers"
                },
                e.FREEBIE = {
                    alias: "freebie"
                },
                e.FRIENDS_FOR_CRATES = {
                    alias: "friends_for_crates"
                },
                e.GREENHOUSE = {
                    alias: "greenhouse"
                },
                e.GREENHOUSE_MERGE_CHAIN_INTRO = {
                    alias: "greenhouse_merge_chain_intro"
                },
                e.HEAVY_OBJECT_OVERLAY = {
                    alias: "heavy_object_overlay"
                },
                e.INGREDIENTS = {
                    alias: "ingredients"
                },
                e.LANGUAGE_FLAGS = {
                    alias: "language_flags"
                },
                e.LEVELUPREWARDS = {
                    alias: "levelUpRewards"
                },
                e.MAIN_HUD = {
                    alias: "main_hud"
                },
                e.MAP_RESOURCES = {
                    alias: "map_resources"
                },
                e.MARKETPLACE = {
                    alias: "marketplace"
                },
                e.ONBOARDING = {
                    alias: "onboarding"
                },
                e.ORDERS_POPUP = {
                    alias: "orders_popup"
                },
                e.PREMIUM_LAND = {
                    alias: "premium_land"
                },
                e.PREMIUM_POPUP = {
                    alias: "premium_popup"
                },
                e.RAIN = {
                    alias: "rain"
                },
                e.REPAIR_AVOCADOFIESTA = {
                    alias: "repair_avocadofiesta"
                },
                e.REPAIR_BAKERY = {
                    alias: "repair_bakery"
                },
                e.REPAIR_BARISTA = {
                    alias: "repair_barista"
                },
                e.REPAIR_BBQ = {
                    alias: "repair_bbq"
                },
                e.REPAIR_DAIRY = {
                    alias: "repair_dairy"
                },
                e.REPAIR_DECORATIONS = {
                    alias: "repair_decorations"
                },
                e.REPAIR_GREENHOUSE = {
                    alias: "repair_greenhouse"
                },
                e.REPAIR_LOOM = {
                    alias: "repair_loom"
                },
                e.REPAIR_MARKET = {
                    alias: "repair_market"
                },
                e.REPAIR_SWEETS = {
                    alias: "repair_sweets"
                },
                e.REPAIR_TOMATO_ON_WHEELS = {
                    alias: "repair_tomato_on_wheels"
                },
                e.REPAIR_TRUFFLELICIOUS = {
                    alias: "repair_trufflelicious"
                },
                e.SETTINGS_POPUP = {
                    alias: "settings_popup"
                },
                e.SHARED = {
                    alias: "shared"
                },
                e.SHOVEL_POPUP = {
                    alias: "shovel_popup"
                },
                e.SPLASH_LANDSCAPE = {
                    alias: "splash_landscape"
                },
                e.SPLASH_PORTRAIT = {
                    alias: "splash_portrait"
                },
                e.STORAGE = {
                    alias: "storage"
                },
                e.TRANSITIONSCREEN_LANDSCAPE = {
                    alias: "transitionScreen_landscape"
                },
                e.TRANSITIONSCREEN_PORTRAIT = {
                    alias: "transitionScreen_portrait"
                },
                e.UI = {
                    alias: "ui"
                },
                e.UPGRADE_CARD = {
                    alias: "upgrade_card"
                },
                e.UPGRADE_CARD_OVERLAY = {
                    alias: "upgrade_card_overlay"
                },
                e.VISTOR_ACTIONS = {
                    alias: "vistor_actions"
                },
                e.WIND = {
                    alias: "wind"
                },
                e
            }()
              , f = function() {
                function e() {}
                return e.ICON_ADBLOCKER = {
                    alias: "icon_adblocker"
                },
                e.POPUP_BG_CONSENT_9SLICE = {
                    alias: "popup_bg_consent_9slice"
                },
                e.CS_HELP_OBSTRUCTION_WHEEL = {
                    alias: "cs_help_obstruction_wheel"
                },
                e.CS_INVITATION = {
                    alias: "cs_invitation"
                },
                e.CS_HELP_OBSTRUCTION_HAY = {
                    alias: "cs_help_obstruction_hay"
                },
                e.CS_HELP_OBSTRUCTION_TRACTOR = {
                    alias: "cs_help_obstruction_tractor"
                },
                e.CU_INVITATION_CLAIMREWARDS = {
                    alias: "cu_invitation_claimrewards"
                },
                e.CU_VISITFRIENDS_CLAIMREWARDS = {
                    alias: "cu_visitfriends_claimrewards"
                },
                e.BG_DB_DAY_END_UPCOMING = {
                    alias: "bg_DB_day_end_upcoming"
                },
                e.BG_DB_DAY_END_CURRENT = {
                    alias: "bg_DB_day_end_current"
                },
                e.BG_DB_DAY_MIDDLE_CURRENT = {
                    alias: "bg_DB_day_middle_current"
                },
                e.BG_DB_DAY_MIDDLE_PAST = {
                    alias: "bg_DB_day_middle_past"
                },
                e.BG_DB_DAY_START_CURRENT = {
                    alias: "bg_DB_day_start_current"
                },
                e.BG_DB_DAY_MIDDLE_UPCOMING = {
                    alias: "bg_DB_day_middle_upcoming"
                },
                e.BG_DB_DAY_START_PAST = {
                    alias: "bg_DB_day_start_past"
                },
                e.ICON_DB_CHECKMARK = {
                    alias: "icon_DB_checkmark"
                },
                e.POPUP_EVENTHEADER_DAILYBONUS_ORNAMENT = {
                    alias: "popup_eventheader_dailybonus_ornament"
                },
                e.POPUP_EVENTHEADER_DAILYBONUS = {
                    alias: "popup_eventheader_dailybonus"
                },
                e.BG_DAILYTASKS_MASK = {
                    alias: "bg_dailytasks_mask"
                },
                e.BG_DAILYTASKS_OVERLAY = {
                    alias: "bg_dailytasks_overlay"
                },
                e.BG_DAILYTASKS = {
                    alias: "bg_dailytasks"
                },
                e.ICON_CHECKMARK_DAILYCHALLENGES_POPUP = {
                    alias: "icon_checkmark_dailychallenges_popup"
                },
                e.ICON_CHECKMARK_DAILYCHALLENGES = {
                    alias: "icon_checkmark_dailychallenges"
                },
                e.ICON_GIFT_DAILYCHALLENGES = {
                    alias: "icon_gift_dailychallenges"
                },
                e.ICON_MARYJANE = {
                    alias: "icon_maryjane"
                },
                e.POPUP_EVENTHEADER_DAILYCHALLENGES = {
                    alias: "popup_eventheader_dailychallenges"
                },
                e.UI_BG_DAILYCHALLENGES_TASK_ACTIVE = {
                    alias: "UI_bg_dailychallenges_task_active"
                },
                e.UI_BG_DAILYCHALLENGES_TASK_DONE = {
                    alias: "UI_bg_dailychallenges_task_done"
                },
                e.UI_BG_DAILYCHALLENGES_TASK_POPUP = {
                    alias: "UI_bg_dailychallenges_task_popup"
                },
                e.UI_PROGRESSBAR_DAILYCHALLENGES_BACKGROUND = {
                    alias: "UI_progressbar_dailychallenges_background"
                },
                e.UI_SCROLLBAR_DAILYCHALLENGES = {
                    alias: "UI_scrollbar_dailychallenges"
                },
                e.DANDELION = {
                    alias: "dandelion"
                },
                e.BENCH = {
                    alias: "bench"
                },
                e.BUSH = {
                    alias: "bush"
                },
                e.CUTE_LIGHTS = {
                    alias: "cute_lights"
                },
                e.BOTTOM_TREELINE_LEFT = {
                    alias: "bottom_treeline_left"
                },
                e.BUSH2 = {
                    alias: "bush2"
                },
                e.EMPTY_POT = {
                    alias: "empty_pot"
                },
                e.FENCE1 = {
                    alias: "fence1"
                },
                e.GRASS1 = {
                    alias: "grass1"
                },
                e.GRASS2 = {
                    alias: "grass2"
                },
                e.GRASS3 = {
                    alias: "grass3"
                },
                e.LAMP_POST = {
                    alias: "lamp_post"
                },
                e.POT = {
                    alias: "pot"
                },
                e.SHED = {
                    alias: "shed"
                },
                e.STONE_PATH = {
                    alias: "stone_path"
                },
                e.TILE_DECAL_TRAINTRACK_SWITCH = {
                    alias: "tile_decal_traintrack_switch"
                },
                e.TREE = {
                    alias: "tree"
                },
                e.DECORATIVE_04 = {
                    alias: "decorative_04"
                },
                e.DECORATIVE_05 = {
                    alias: "decorative_05"
                },
                e.TOP_BACKGROUND = {
                    alias: "top_background"
                },
                e.BOTTOM_TREELINE_RIGHT = {
                    alias: "bottom_treeline_right"
                },
                e.DECORATIVE_02 = {
                    alias: "decorative_02"
                },
                e.BOTTOM_BACKGROUND = {
                    alias: "bottom_background"
                },
                e.DECORATIVE_03 = {
                    alias: "decorative_03"
                },
                e.DECORATIVE_01 = {
                    alias: "decorative_01"
                },
                e.SIDE_TREELINE = {
                    alias: "side_treeline"
                },
                e.ICON_TAB_DISCOVERYBOOK_ANIMALS = {
                    alias: "icon_tab_discoverybook_animals"
                },
                e.ICON_POPUP_HEADER_DISCOVERYBOOK = {
                    alias: "icon_popup_header_discoverybook"
                },
                e.ICON_TAB_DISCOVERYBOOK_BUILDINGS = {
                    alias: "icon_tab_discoverybook_buildings"
                },
                e.ICON_ARROW_DISCOVERYBOOK = {
                    alias: "icon_arrow_discoverybook"
                },
                e.ICON_TAB_DISCOVERYBOOK_CROPS = {
                    alias: "icon_tab_discoverybook_crops"
                },
                e.ICON_TAB_DISCOVERYBOOK_NATURE = {
                    alias: "icon_tab_discoverybook_nature"
                },
                e.ICON_TAB_DISCOVERYBOOK_RECIPES = {
                    alias: "icon_tab_discoverybook_recipes"
                },
                e.ICON_TAB_DISCOVERYBOOK_REWARDS = {
                    alias: "icon_tab_discoverybook_rewards"
                },
                e.BG_MARKETPLACE_FB_BLACKFRIDAY03 = {
                    alias: "bg_marketplace_fb_blackfriday03"
                },
                e.BG_MARKETPLACE_MS_CG_BLACKFRIDAY01 = {
                    alias: "bg_marketplace_ms_cg_blackfriday01"
                },
                e.BG_MARKETPLACE_MS_CG_BLACKFRIDAY02 = {
                    alias: "bg_marketplace_ms_cg_blackfriday02"
                },
                e.BG_MARKETPLACE_MS_CG_BLACKFRIDAY03 = {
                    alias: "bg_marketplace_ms_cg_blackfriday03"
                },
                e.BTN_EVENT_BLACKFRIDAY_ACTIVE = {
                    alias: "btn_event_blackfriday_active"
                },
                e.BG_MARKETPLACE_MS_CG_BLACKFRIDAY04 = {
                    alias: "bg_marketplace_ms_cg_blackfriday04"
                },
                e.BTN_EVENT_BLACKFRIDAY_IDLE = {
                    alias: "btn_event_blackfriday_idle"
                },
                e.HUD_ICON_PERCENTAGE = {
                    alias: "HUD_icon_percentage"
                },
                e.POPUP_BACKGROUND_BLACKFRIDAY_9SLICE = {
                    alias: "popup_background_blackfriday_9slice"
                },
                e.BG_MARKETPLACE_FB_BLACKFRIDAY04 = {
                    alias: "bg_marketplace_fb_blackfriday04"
                },
                e.ICON_EVENTIMAGE_BLACKFRIDAY = {
                    alias: "icon_eventimage_blackfriday"
                },
                e.HUD_ICON_BANNER = {
                    alias: "HUD_icon_banner"
                },
                e.POPUP_EVENTHEADER_BLACKFRIDAY = {
                    alias: "popup_eventheader_blackfriday"
                },
                e.BG_MARKETPLACE_FB_BLACKFRIDAY01 = {
                    alias: "bg_marketplace_fb_blackfriday01"
                },
                e.BG_MARKETPLACE_FB_BLACKFRIDAY02 = {
                    alias: "bg_marketplace_fb_blackfriday02"
                },
                e.ICON_EVENTIMAGE_EXTRAWORKER_START = {
                    alias: "icon_eventimage_extraworker_start"
                },
                e.POPUP_EVENTHEADER_EXTRAWORKER = {
                    alias: "popup_eventheader_extraworker"
                },
                e.ICON_EVENTIMAGE_EXTRAWORKER_CHRISTMAS = {
                    alias: "icon_eventimage_extraworker_christmas"
                },
                e.BTN_HUD_EVENT_EXTRAWORKER_IDLE = {
                    alias: "btn_HUD_event_extraworker_idle"
                },
                e.ICON_EVENTIMAGE_EXTRAWORKER_HALLOWEEN = {
                    alias: "icon_eventimage_extraworker_halloween"
                },
                e.BTN_HUD_EVENT_EXTRAWORKER_DOWN = {
                    alias: "btn_HUD_event_extraworker_down"
                },
                e.BG_MARKETPLACE_FB_CHRISTMASSPECIAL02 = {
                    alias: "bg_marketplace_fb_christmasspecial02"
                },
                e.BG_MARKETPLACE_MS_CG_CHRISTMASSPECIAL02 = {
                    alias: "bg_marketplace_ms_cg_christmasspecial02"
                },
                e.BG_MARKETPLACE_MS_CG_CHRISTMASSPECIAL04 = {
                    alias: "bg_marketplace_ms_cg_christmasspecial04"
                },
                e.CHRISTMAS_DEALS_HUD_ICON_PERCENTAGE = {
                    alias: "christmas_deals_HUD_icon_percentage"
                },
                e.BG_MARKETPLACE_FB_CHRISTMASSPECIAL04 = {
                    alias: "bg_marketplace_fb_christmasspecial04"
                },
                e.BG_MARKETPLACE_FB_CHRISTMASSPECIAL01 = {
                    alias: "bg_marketplace_fb_christmasspecial01"
                },
                e.BG_MARKETPLACE_MS_CG_CHRISTMASSPECIAL01 = {
                    alias: "bg_marketplace_ms_cg_christmasspecial01"
                },
                e.CHRISTMAS_DEALS_HUD_ICON_BANNER = {
                    alias: "christmas_deals_HUD_icon_banner"
                },
                e.POPUP_EVENTHEADER_CHRISTMASSPECIALS = {
                    alias: "popup_eventheader_christmasspecials"
                },
                e.BG_MARKETPLACE_MS_CG_CHRISTMASSPECIAL03 = {
                    alias: "bg_marketplace_ms_cg_christmasspecial03"
                },
                e.ICON_EVENTIMAGE_CHRISTMASSPECIAL = {
                    alias: "icon_eventimage_christmasspecial"
                },
                e.BG_MARKETPLACE_FB_CHRISTMASSPECIAL03 = {
                    alias: "bg_marketplace_fb_christmasspecial03"
                },
                e.BTN_HUD_EVENT_GOLDENCARROT_DOWN = {
                    alias: "btn_HUD_event_goldencarrot_down"
                },
                e.BTN_HUD_EVENT_GOLDENCARROT_IDLE = {
                    alias: "btn_HUD_event_goldencarrot_idle"
                },
                e.ICON_BTN_GOLDENCARROT = {
                    alias: "icon_btn_goldencarrot"
                },
                e.ICON_PROGRESSBAR_EVENT_CARROT_BIG = {
                    alias: "icon_progressbar_event_carrot_big"
                },
                e.ICON_PROGRESSBAR_GOLDENCARROT_KEY = {
                    alias: "icon_progressbar_goldencarrot_key"
                },
                e.POPUP_BG_CONCENT_9SLICE = {
                    alias: "popup_bg_concent_9slice"
                },
                e.POPUP_EVENTHEADER_GOLDENCARROT = {
                    alias: "popup_eventheader_goldencarrot"
                },
                e.ICON_POPUP_GOLDENCARROT_EXPLANATION = {
                    alias: "icon_popup_goldencarrot_explanation"
                },
                e.ICON_EVENTIMAGE_GOLDENCARROT = {
                    alias: "icon_eventimage_goldencarrot"
                },
                e.ICON_PROGRESSBAR_GOLDENCARROT_LOOTCHEST = {
                    alias: "icon_progressbar_goldencarrot_lootchest"
                },
                e.BTN_HUD_EVENT_CHRISTMAS_DOWN = {
                    alias: "btn_HUD_event_christmas_down"
                },
                e.BTN_HUD_EVENT_CHRISTMAS_IDLE = {
                    alias: "btn_HUD_event_christmas_idle"
                },
                e.ICON_BTN_EVENT_GREEN_CHRISTMAS = {
                    alias: "icon_btn_event_green_christmas"
                },
                e.ICON_EVENTIMAGE_CHRISTMAS = {
                    alias: "icon_eventimage_christmas"
                },
                e.ICON_PROGRESSBAR_CHRISTMAS_KEY_SEPIA = {
                    alias: "icon_progressbar_christmas_key_sepia"
                },
                e.ICON_PROGRESSBAR_CHRISTMAS_KEY = {
                    alias: "icon_progressbar_christmas_key"
                },
                e.ICON_PROGRESSBAR_CHRISTMAS_LOOTCHEST_SEPIA = {
                    alias: "icon_progressbar_christmas_lootchest_sepia"
                },
                e.ICON_PROGRESSBAR_CHRISTMAS_LOOTCHEST = {
                    alias: "icon_progressbar_christmas_lootchest"
                },
                e.ICON_PROGRESSBAR_EVENT_JINGLEBALL = {
                    alias: "icon_progressbar_event_jingleball"
                },
                e.ICON_POPUP_CHRISTMAS_EXPLANATION = {
                    alias: "icon_popup_christmas_explanation"
                },
                e.POPUP_EVENTHEADER_CHRISTMAS = {
                    alias: "popup_eventheader_christmas"
                },
                e.UI_PROGRESSBAR_EVENTS_BACKGROUND_CHRISTMAS = {
                    alias: "UI_progressbar_events_background_christmas"
                },
                e.UI_PROGRESSBAR_EVENTS_COUNTER_CHRISTMAS = {
                    alias: "UI_progressbar_events_counter_christmas"
                },
                e.UI_PROGRESSBAR_EVENTS_GOAL_CHRISTMAS = {
                    alias: "UI_progressbar_events_goal_christmas"
                },
                e.UI_PROGRESSBAR_EVENTS_SMALLGIFT_CHRISTMAS = {
                    alias: "UI_progressbar_events_smallgift_christmas"
                },
                e.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS_SEPIA = {
                    alias: "UI_progressbar_events_smallgiftgift_christmas_sepia"
                },
                e.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS = {
                    alias: "UI_progressbar_events_smallgiftgift_christmas"
                },
                e.ICON_EVENTIMAGE_CHRISTMASSHOP = {
                    alias: "icon_eventimage_christmasshop"
                },
                e.ICON_EVENTIMAGE_CHRISTMAS2 = {
                    alias: "icon_eventimage_christmas2"
                },
                e.ICON_EVENTIMAGE_CHRISTMAS1 = {
                    alias: "icon_eventimage_christmas1"
                },
                e.BTN_HUD_EVENT_GOLDENPUMPKIN_IDLE = {
                    alias: "btn_HUD_event_goldenpumpkin_idle"
                },
                e.BTN_HUD_EVENT_GOLDENPUMPKIN_DOWN = {
                    alias: "btn_HUD_event_goldenpumpkin_down"
                },
                e.ICON_PROGRESSBAR_EVENT_PUMPKIN = {
                    alias: "icon_progressbar_event_pumpkin"
                },
                e.ICON_POPUP_GOLDENPUMPKIN_EXPLANATION = {
                    alias: "icon_popup_goldenpumpkin_explanation"
                },
                e.ICON_PROGRESSBAR_GOLDENPUMPKIN_LOOTCHEST = {
                    alias: "icon_progressbar_goldenpumpkin_lootchest"
                },
                e.POPUP_BACKGROUND_EVENT_9SLICE_HALLOWEEN = {
                    alias: "popup_background_event_9slice_halloween"
                },
                e.POPUP_EVENTHEADER_GOLDENPUMPKIN = {
                    alias: "popup_eventheader_goldenpumpkin"
                },
                e.UI_PROGRESSBAR_EVENTS_BACKGROUND_HALLOWEEN = {
                    alias: "UI_progressbar_events_background_halloween"
                },
                e.UI_PROGRESSBAR_EVENTS_COUNTER_HALLOWEEN = {
                    alias: "UI_progressbar_events_counter_halloween"
                },
                e.UI_PROGRESSBAR_EVENTS_GOAL_HALLOWEEN = {
                    alias: "UI_progressbar_events_goal_halloween"
                },
                e.ICON_PROGRESSBAR_GOLDENPUMPKIN_KEY = {
                    alias: "icon_progressbar_goldenpumpkin_key"
                },
                e.ICON_EVENTIMAGE_HALLOWEENSHOP = {
                    alias: "icon_eventimage_halloweenshop"
                },
                e.ICON_EVENTIMAGE_GOLDENPUMPKIN = {
                    alias: "icon_eventimage_goldenpumpkin"
                },
                e.BTN_HUD_EVENT_PIGGYBANK_DOWN = {
                    alias: "btn_HUD_event_piggybank_down"
                },
                e.BTN_HUD_EVENT_PIGGYBANK_IDLE = {
                    alias: "btn_HUD_event_piggybank_idle"
                },
                e.ICON_PROGRESSBAR_EVENT_ENERGY_BIG = {
                    alias: "icon_progressbar_event_energy_big"
                },
                e.ICON_PROGRESSBAR_EVENT_ENERGY_SMALL = {
                    alias: "icon_progressbar_event_energy_small"
                },
                e.ICON_EVENTIMAGE_PIGGYBANK_START = {
                    alias: "icon_eventimage_piggybank_start"
                },
                e.POPUP_EVENTHEADER_PIGGYBANK = {
                    alias: "popup_eventheader_piggybank"
                },
                e.ICON_STICKER_DISCOUNT_PIGGYBANK = {
                    alias: "icon_sticker_discount_piggybank"
                },
                e.BG_POPUP_EVENT_TIMER = {
                    alias: "bg_popup_event_timer"
                },
                e.BTN_EVENT_GREEN_CHRISTMAS_DOWN = {
                    alias: "btn_event_green_christmas_down"
                },
                e.BTN_EVENT_GREEN_CHRISTMAS_IDLE = {
                    alias: "btn_event_green_christmas_idle"
                },
                e.BTN_EVENT_GREY_INACTIVE = {
                    alias: "btn_event_grey_inactive"
                },
                e.BTN_EVENT_RED_DOWN = {
                    alias: "btn_event_red_down"
                },
                e.BTN_EVENT_RED_IDLE = {
                    alias: "btn_event_red_idle"
                },
                e.BTN_EVENT_WHITEPILL_9SLICE = {
                    alias: "btn_event_whitepill_9slice"
                },
                e.ICON_EVENT_TIMER = {
                    alias: "icon_event_timer"
                },
                e.POPUP_BACKGROUND_EVENT_9SLICE_CHRISTMAS = {
                    alias: "popup_background_event_9slice_christmas"
                },
                e.UI_PROGRESSBAR_EVENTS_BACKGROUND = {
                    alias: "UI_progressbar_events_background"
                },
                e.UI_PROGRESSBAR_EVENTS_COUNTER = {
                    alias: "UI_progressbar_events_counter"
                },
                e.UI_PROGRESSBAR_EVENTS_FILL = {
                    alias: "UI_progressbar_events_fill"
                },
                e.UI_PROGRESSBAR_EVENTS_GOAL_SEPIA = {
                    alias: "UI_progressbar_events_goal_sepia"
                },
                e.UI_PROGRESSBAR_EVENTS_GOAL = {
                    alias: "UI_progressbar_events_goal"
                },
                e.ADS_FALL_BACK_TILE = {
                    alias: "ads_fall_back_tile"
                },
                e.BTN_OUTLINE_FALLBACK_AD = {
                    alias: "btn_outline_fallback_ad"
                },
                e.ADS_FALL_BACK_BG = {
                    alias: "ads_fall_back_bg"
                },
                e.OBJ_FLOWERS_00 = {
                    alias: "obj_flowers_00"
                },
                e.OBJ_FLOWERS_01 = {
                    alias: "obj_flowers_01"
                },
                e.OBJ_FLOWERS_02 = {
                    alias: "obj_flowers_02"
                },
                e.OBJ_FLOWERS_03 = {
                    alias: "obj_flowers_03"
                },
                e.OBJ_FLOWERS_04 = {
                    alias: "obj_flowers_04"
                },
                e.OBJ_FLOWERS_05 = {
                    alias: "obj_flowers_05"
                },
                e.OBJ_FLOWERS_06 = {
                    alias: "obj_flowers_06"
                },
                e.OBJ_FLOWERS_07 = {
                    alias: "obj_flowers_07"
                },
                e.OBJ_FLOWERS_08 = {
                    alias: "obj_flowers_08"
                },
                e.OBJ_FLOWERS_09 = {
                    alias: "obj_flowers_09"
                },
                e.OBJ_SAPLING_00 = {
                    alias: "obj_sapling_00"
                },
                e.OBJ_SAPLING_01 = {
                    alias: "obj_sapling_01"
                },
                e.OBJ_SAPLING_02 = {
                    alias: "obj_sapling_02"
                },
                e.BG_FREEBIE_TIMERRIBBON = {
                    alias: "bg_freebie_timerribbon"
                },
                e.ICON_FREEBIE_OFFERS = {
                    alias: "icon_freebie_offers"
                },
                e.ICON_FREEBIE_POPUPHEADER = {
                    alias: "icon_freebie_popupheader"
                },
                e.ICON_INVITEFRIENDS_CRATES = {
                    alias: "icon_invitefriends_crates"
                },
                e.OBJ_GREENHOUSE_01 = {
                    alias: "obj_greenhouse_01"
                },
                e.OBJ_GREENHOUSE_03 = {
                    alias: "obj_greenhouse_03"
                },
                e.OBJ_GREENHOUSE_02 = {
                    alias: "obj_greenhouse_02"
                },
                e.OBJ_GREENHOUSE_05 = {
                    alias: "obj_greenhouse_05"
                },
                e.OBJ_GREENHOUSE_00 = {
                    alias: "obj_greenhouse_00"
                },
                e.OBJ_GREENHOUSE_06 = {
                    alias: "obj_greenhouse_06"
                },
                e.OBJ_GREENHOUSE_09 = {
                    alias: "obj_greenhouse_09"
                },
                e.OBJ_GREENHOUSE_10 = {
                    alias: "obj_greenhouse_10"
                },
                e.OBJ_GREENHOUSE_11 = {
                    alias: "obj_greenhouse_11"
                },
                e.OBJ_GREENHOUSE_12 = {
                    alias: "obj_greenhouse_12"
                },
                e.OBJ_GREENHOUSE_04 = {
                    alias: "obj_greenhouse_04"
                },
                e.OBJ_GREENHOUSE_07 = {
                    alias: "obj_greenhouse_07"
                },
                e.OBJ_GREENHOUSE_08 = {
                    alias: "obj_greenhouse_08"
                },
                e.POPUP_GREENHOUSE_INTRODUCTIONARY = {
                    alias: "popup_greenhouse_introductionary"
                },
                e.HEAVY_OBJECT_HAY_OVERLAY = {
                    alias: "heavy_object_hay_overlay"
                },
                e.HEAVY_OBJECT_WHEEL_OVERLAY = {
                    alias: "heavy_object_wheel_overlay"
                },
                e.ICON_BTN_FACEBOOK = {
                    alias: "icon_btn_facebook"
                },
                e.ICON_BTN_MESSENGER = {
                    alias: "icon_btn_messenger"
                },
                e.ICON_CHECKMARK_FRIENDS = {
                    alias: "icon_checkmark_friends"
                },
                e.HEAVY_OBJECT_TRAKTOR_OVERLAY = {
                    alias: "heavy_object_traktor_overlay"
                },
                e.INGREDIENT_BACON = {
                    alias: "ingredient_bacon"
                },
                e.INGREDIENT_AVOCADO = {
                    alias: "ingredient_avocado"
                },
                e.INGREDIENT_COFFEEBEANS = {
                    alias: "ingredient_coffeebeans"
                },
                e.INGREDIENT_CORN = {
                    alias: "ingredient_corn"
                },
                e.INGREDIENT_GOAT_MILK = {
                    alias: "ingredient_goat_milk"
                },
                e.INGREDIENT_FUR = {
                    alias: "ingredient_fur"
                },
                e.INGREDIENT_MILK = {
                    alias: "ingredient_milk"
                },
                e.INGREDIENT_SUGARCANE = {
                    alias: "ingredient_sugarcane"
                },
                e.INGREDIENT_SUNFLOWER = {
                    alias: "ingredient_sunflower"
                },
                e.INGREDIENT_TOMATO = {
                    alias: "ingredient_tomato"
                },
                e.INGREDIENT_TRUFFLE = {
                    alias: "ingredient_truffle"
                },
                e.INGREDIENT_WHEAT = {
                    alias: "ingredient_wheat"
                },
                e.INGREDIENT_WOOL = {
                    alias: "ingredient_wool"
                },
                e.INGREDIENT_EGG = {
                    alias: "ingredient_egg"
                },
                e.INGREDIENT_CARROT = {
                    alias: "ingredient_carrot"
                },
                e.INGREDIENT_SOYBEAN = {
                    alias: "ingredient_soybean"
                },
                e.CZECHREPUBLIC = {
                    alias: "CzechRepublic"
                },
                e.BRAZIL = {
                    alias: "Brazil"
                },
                e.FRANCE = {
                    alias: "France"
                },
                e.GERMANY = {
                    alias: "Germany"
                },
                e.GREECE = {
                    alias: "Greece"
                },
                e.HUNGARY = {
                    alias: "Hungary"
                },
                e.INDONEZIA = {
                    alias: "Indonezia"
                },
                e.ITALY = {
                    alias: "Italy"
                },
                e.JAPAN = {
                    alias: "Japan"
                },
                e.POLAND = {
                    alias: "Poland"
                },
                e.NETHERLANDS = {
                    alias: "Netherlands"
                },
                e.PORTUGAL = {
                    alias: "Portugal"
                },
                e.SPAIN = {
                    alias: "Spain"
                },
                e.TURKEY = {
                    alias: "Turkey"
                },
                e.SWEDEN = {
                    alias: "Sweden"
                },
                e.USA = {
                    alias: "USA"
                },
                e.VIETNAM = {
                    alias: "Vietnam"
                },
                e.ICON_LEVELUP_LOCK_UNLOCKED = {
                    alias: "icon_levelup_lock_unlocked"
                },
                e.ICON_LEVELUP_LOCK_LOCKED = {
                    alias: "icon_levelup_lock_locked"
                },
                e.ICON_LEVELUP_REWARDS_BREAD = {
                    alias: "icon_levelup_rewards_bread"
                },
                e.ICON_LEVELUP_REWARDS_AVOCADO = {
                    alias: "icon_levelup_rewards_avocado"
                },
                e.ICON_LEVELUP_REWARDS_CAPPUCCINO = {
                    alias: "icon_levelup_rewards_cappuccino"
                },
                e.ICON_LEVELUP_REWARDS_BUTTER = {
                    alias: "icon_levelup_rewards_butter"
                },
                e.ICON_LEVELUP_REWARDS_CARROT = {
                    alias: "icon_levelup_rewards_carrot"
                },
                e.ICON_LEVELUP_REWARDS_CARROTBREAD = {
                    alias: "icon_levelup_rewards_carrotbread"
                },
                e.ICON_LEVELUP_REWARDS_CARROTCAKE = {
                    alias: "icon_levelup_rewards_carrotcake"
                },
                e.ICON_LEVELUP_REWARDS_CHEESE = {
                    alias: "icon_levelup_rewards_cheese"
                },
                e.ICON_LEVELUP_REWARDS_CARROTCRATE = {
                    alias: "icon_levelup_rewards_carrotcrate"
                },
                e.ICON_LEVELUP_REWARDS_CHICKEN = {
                    alias: "icon_levelup_rewards_chicken"
                },
                e.ICON_LEVELUP_REWARDS_CHEESEPOPCORN = {
                    alias: "icon_levelup_rewards_cheesepopcorn"
                },
                e.ICON_LEVELUP_REWARDS_COFFEEBAG = {
                    alias: "icon_levelup_rewards_coffeebag"
                },
                e.ICON_LEVELUP_REWARDS_COFFEEBEANS = {
                    alias: "icon_levelup_rewards_coffeebeans"
                },
                e.ICON_LEVELUP_REWARDS_COINS = {
                    alias: "icon_levelup_rewards_coins"
                },
                e.ICON_LEVELUP_REWARDS_CORNBUNDLED = {
                    alias: "icon_levelup_rewards_cornbundled"
                },
                e.ICON_LEVELUP_REWARDS_CORN = {
                    alias: "icon_levelup_rewards_corn"
                },
                e.ICON_LEVELUP_REWARDS_COW = {
                    alias: "icon_levelup_rewards_cow"
                },
                e.ICON_LEVELUP_REWARDS_DEER = {
                    alias: "icon_levelup_rewards_deer"
                },
                e.ICON_LEVELUP_REWARDS_EGG = {
                    alias: "icon_levelup_rewards_egg"
                },
                e.ICON_LEVELUP_REWARDS_CRATES = {
                    alias: "icon_levelup_rewards_crates"
                },
                e.ICON_LEVELUP_REWARDS_EGGS = {
                    alias: "icon_levelup_rewards_eggs"
                },
                e.ICON_LEVELUP_REWARDS_ESPRESSO = {
                    alias: "icon_levelup_rewards_espresso"
                },
                e.ICON_LEVELUP_REWARDS_ENERGY = {
                    alias: "icon_levelup_rewards_energy"
                },
                e.ICON_LEVELUP_REWARDS_FLOUR = {
                    alias: "icon_levelup_rewards_flour"
                },
                e.ICON_LEVELUP_REWARDS_FUR = {
                    alias: "icon_levelup_rewards_fur"
                },
                e.ICON_LEVELUP_REWARDS_GEMS = {
                    alias: "icon_levelup_rewards_gems"
                },
                e.ICON_LEVELUP_REWARDS_GOAT = {
                    alias: "icon_levelup_rewards_goat"
                },
                e.ICON_LEVELUP_REWARDS_GOATSMILK = {
                    alias: "icon_levelup_rewards_goatsmilk"
                },
                e.ICON_LEVELUP_REWARDS_GOATSMILKBUCKET = {
                    alias: "icon_levelup_rewards_goatsmilkbucket"
                },
                e.ICON_LEVELUP_REWARDS_GOATYOGHURT = {
                    alias: "icon_levelup_rewards_goatyoghurt"
                },
                e.ICON_LEVELUP_REWARDS_GRILLEDBACON = {
                    alias: "icon_levelup_rewards_grilledbacon"
                },
                e.ICON_LEVELUP_REWARDS_GRILLEDSANDWITCH = {
                    alias: "icon_levelup_rewards_grilledsandwitch"
                },
                e.ICON_LEVELUP_REWARDS_JACKET = {
                    alias: "icon_levelup_rewards_jacket"
                },
                e.ICON_LEVELUP_REWARDS_GRILLEDCORN = {
                    alias: "icon_levelup_rewards_grilledcorn"
                },
                e.ICON_LEVELUP_REWARDS_ICECREAMCONE = {
                    alias: "icon_levelup_rewards_icecreamcone"
                },
                e.ICON_LEVELUP_REWARDS_GOATCHEESE = {
                    alias: "icon_levelup_rewards_goatcheese"
                },
                e.ICON_LEVELUP_REWARDS_LEVELUP = {
                    alias: "icon_levelup_rewards_levelup"
                },
                e.ICON_LEVELUP_REWARDS_MILK = {
                    alias: "icon_levelup_rewards_milk"
                },
                e.ICON_LEVELUP_REWARDS_MILKCHURN = {
                    alias: "icon_levelup_rewards_milkchurn"
                },
                e.ICON_LEVELUP_REWARDS_OMELET = {
                    alias: "icon_levelup_rewards_omelet"
                },
                e.ICON_LEVELUP_REWARDS_MUFFIN = {
                    alias: "icon_levelup_rewards_muffin"
                },
                e.ICON_LEVELUP_REWARDS_PANCAKES = {
                    alias: "icon_levelup_rewards_pancakes"
                },
                e.ICON_LEVELUP_REWARDS_PIG = {
                    alias: "icon_levelup_rewards_pig"
                },
                e.ICON_LEVELUP_REWARDS_PILLOW_DEER = {
                    alias: "icon_levelup_rewards_pillow_deer"
                },
                e.ICON_LEVELUP_REWARDS_POPCORN = {
                    alias: "icon_levelup_rewards_popcorn"
                },
                e.ICON_LEVELUP_REWARDS_PURSE = {
                    alias: "icon_levelup_rewards_purse"
                },
                e.ICON_LEVELUP_REWARDS_RAWBACON = {
                    alias: "icon_levelup_rewards_rawbacon"
                },
                e.ICON_LEVELUP_REWARDS_RAWBACONBUNDLED = {
                    alias: "icon_levelup_rewards_rawbaconbundled"
                },
                e.ICON_LEVELUP_REWARDS_SOCKS = {
                    alias: "icon_levelup_rewards_socks"
                },
                e.ICON_LEVELUP_REWARDS_SHEEP = {
                    alias: "icon_levelup_rewards_sheep"
                },
                e.ICON_LEVELUP_REWARDS_SOYBEAN = {
                    alias: "icon_levelup_rewards_soybean"
                },
                e.ICON_LEVELUP_REWARDS_SOYSAUCE = {
                    alias: "icon_levelup_rewards_soysauce"
                },
                e.ICON_LEVELUP_REWARDS_SOYBEANSBUNDLED = {
                    alias: "icon_levelup_rewards_soybeansbundled"
                },
                e.ICON_LEVELUP_REWARDS_SUGAR = {
                    alias: "icon_levelup_rewards_sugar"
                },
                e.ICON_LEVELUP_REWARDS_SUNFLOWER = {
                    alias: "icon_levelup_rewards_sunflower"
                },
                e.ICON_LEVELUP_REWARDS_TIRAMISU = {
                    alias: "icon_levelup_rewards_tiramisu"
                },
                e.ICON_LEVELUP_REWARDS_SUNFLOWEROIL = {
                    alias: "icon_levelup_rewards_sunfloweroil"
                },
                e.ICON_LEVELUP_REWARDS_TOFU = {
                    alias: "icon_levelup_rewards_tofu"
                },
                e.ICON_LEVELUP_REWARDS_TOFUBURGER = {
                    alias: "icon_levelup_rewards_tofuburger"
                },
                e.ICON_LEVELUP_REWARDS_TOMATO = {
                    alias: "icon_levelup_rewards_tomato"
                },
                e.ICON_LEVELUP_REWARDS_SUGARCANE = {
                    alias: "icon_levelup_rewards_sugarcane"
                },
                e.ICON_LEVELUP_REWARDS_TOMATOBURGER = {
                    alias: "icon_levelup_rewards_tomatoburger"
                },
                e.ICON_LEVELUP_REWARDS_TOMATOSALADONSTICK = {
                    alias: "icon_levelup_rewards_tomatosaladonstick"
                },
                e.ICON_LEVELUP_REWARDS_TOMATOFILLED = {
                    alias: "icon_levelup_rewards_tomatofilled"
                },
                e.ICON_LEVELUP_REWARDS_TROUSERS = {
                    alias: "icon_levelup_rewards_trousers"
                },
                e.ICON_LEVELUP_REWARDS_TOMATOSOUP = {
                    alias: "icon_levelup_rewards_tomatosoup"
                },
                e.ICON_LEVELUP_REWARDS_TRUFFLE = {
                    alias: "icon_levelup_rewards_truffle"
                },
                e.ICON_LEVELUP_REWARDS_TRUFFLEGRILLEDCHEESESANDW = {
                    alias: "icon_levelup_rewards_trufflegrilledcheesesandw"
                },
                e.ICON_LEVELUP_REWARDS_WHEAT = {
                    alias: "icon_levelup_rewards_wheat"
                },
                e.ICON_LEVELUP_REWARDS_TRUFFLEBALLS = {
                    alias: "icon_levelup_rewards_truffleballs"
                },
                e.ICON_LEVELUP_REWARDS_TRUFFLEPASTAPLATE = {
                    alias: "icon_levelup_rewards_trufflepastaplate"
                },
                e.ICON_LEVELUP_REWARDS_WOOL = {
                    alias: "icon_levelup_rewards_wool"
                },
                e.ICON_LEVELUP_REWARDS_WOOLUNPROCESSED = {
                    alias: "icon_levelup_rewards_woolunprocessed"
                },
                e.BG_BUTTON_HUD_DAILYCHALLENGES_TIMER = {
                    alias: "bg_button_HUD_dailychallenges_timer"
                },
                e.BG_COUNTER = {
                    alias: "bg_counter"
                },
                e.BG_TASKS_140 = {
                    alias: "bg_tasks_140"
                },
                e.BG_TASKS_232 = {
                    alias: "bg_tasks_232"
                },
                e.BG_TASKS_PILL = {
                    alias: "bg_tasks_pill"
                },
                e.BTN_ADD_ACTIVE = {
                    alias: "btn_add_active"
                },
                e.BTN_ADD_IDLE = {
                    alias: "btn_add_idle"
                },
                e.BTN_BUTTON_HUD_DAILYCHALLENGES_ACTIVE = {
                    alias: "btn_button_HUD_dailychallenges_active"
                },
                e.BTN_BUTTON_HUD_DAILYCHALLENGES_IDLE = {
                    alias: "btn_button_HUD_dailychallenges_idle"
                },
                e.BTN_CRATE_SPAWN = {
                    alias: "btn_crate_spawn"
                },
                e.BTN_HUD_SMALL_FACEBOOK_IDLE = {
                    alias: "btn_HUD_small_facebook_idle"
                },
                e.BTN_HUD_SMALL_FEEDBACK_DOWN = {
                    alias: "btn_HUD_small_feedback_down"
                },
                e.BTN_HUD_SMALL_NEWS_DOWN = {
                    alias: "btn_HUD_small_news_down"
                },
                e.BTN_HUD_SMALL_NEWS_IDLE = {
                    alias: "btn_HUD_small_news_idle"
                },
                e.BTN_HUD_SMALL_SETTINGS_DOWN = {
                    alias: "btn_HUD_small_settings_down"
                },
                e.BTN_HUD_SMALL_SHOVEL_DOWN = {
                    alias: "btn_HUD_small_shovel_down"
                },
                e.BTN_LEVELUP_BACKGROUND = {
                    alias: "btn_levelup_background"
                },
                e.BTN_LEVELUP_BAR_FILL = {
                    alias: "btn_levelup_bar_fill"
                },
                e.BTN_LEVELUP_BAR_OVERLAY = {
                    alias: "btn_levelup_bar_overlay"
                },
                e.BTN_LEVELUP_CROWN = {
                    alias: "btn_levelup_crown"
                },
                e.BTN_MARKETPLACE = {
                    alias: "btn_marketplace"
                },
                e.BTN_ORDERS = {
                    alias: "btn_orders"
                },
                e.BTN_SETTINGS = {
                    alias: "btn_settings"
                },
                e.BTN_SHOVEL = {
                    alias: "btn_shovel"
                },
                e.BTN_TOURNAMENTS = {
                    alias: "btn_tournaments"
                },
                e.CRATESPAWN_IDLE = {
                    alias: "cratespawn_idle"
                },
                e.ICON_BTN_COIN = {
                    alias: "icon_btn_coin"
                },
                e.ICON_BTN_GEM = {
                    alias: "icon_btn_gem"
                },
                e.ICON_BUTTON_HUD_COLLECTIONBOOK = {
                    alias: "icon_button_HUD_collectionbook"
                },
                e.ICON_BUTTON_HUD_DAILYCHALLENGES_ACTIVE = {
                    alias: "icon_button_HUD_dailychallenges_active"
                },
                e.ICON_BUTTON_HUD_DAILYCHALLENGES_INACTIVE = {
                    alias: "icon_button_HUD_dailychallenges_inactive"
                },
                e.ICON_BUTTON_HUD_DAILYCHALLENGES_PILL_NEXT = {
                    alias: "icon_button_HUD_dailychallenges_pill_next"
                },
                e.ICON_BUTTON_HUD_FREEBIE = {
                    alias: "icon_button_HUD_freebie"
                },
                e.ICON_BUTTON_HUD_LOGINBONUS = {
                    alias: "icon_button_HUD_loginbonus"
                },
                e.ICON_BUTTON_HUD_MARKETPLACE = {
                    alias: "icon_button_HUD_marketplace"
                },
                e.ICON_BUTTON_HUD_ORDERS = {
                    alias: "icon_button_HUD_orders"
                },
                e.ICON_BUTTON_HUD_WORKER = {
                    alias: "icon_button_HUD_worker"
                },
                e.ICON_CHARACTER_AVOCADO = {
                    alias: "icon_character_avocado"
                },
                e.ICON_CHARACTER_BAKERY = {
                    alias: "icon_character_bakery"
                },
                e.ICON_CHARACTER_BBQ = {
                    alias: "icon_character_bbq"
                },
                e.ICON_CHARACTER_LOOM = {
                    alias: "icon_character_loom"
                },
                e.ICON_CHARACTER_DAIRY = {
                    alias: "icon_character_dairy"
                },
                e.ICON_CHARACTER_MARKET = {
                    alias: "icon_character_market"
                },
                e.ICON_CHARACTER_TOMATOONWHEELS = {
                    alias: "icon_character_tomatoonwheels"
                },
                e.ICON_CHARACTER_TRUFFLELICIOUS = {
                    alias: "icon_character_trufflelicious"
                },
                e.ICON_CHARACTER_WORKER = {
                    alias: "icon_character_worker"
                },
                e.ICON_CHARACTERS_NARRATIVE_COFFEE = {
                    alias: "icon_characters_narrative_coffee"
                },
                e.ICON_CHARACTERS_NARRATIVE_TOMATO = {
                    alias: "icon_characters_narrative_tomato"
                },
                e.ICON_COUNTER_ENERGY = {
                    alias: "icon_counter_energy"
                },
                e.ICON_COUNTER_GEM = {
                    alias: "icon_counter_gem"
                },
                e.ICON_TASKS_CHECKMARK = {
                    alias: "icon_tasks_checkmark"
                },
                e.ICON_TASKS_COLLECT_COINS = {
                    alias: "icon_tasks_collect_coins"
                },
                e.ICON_TASKS_COMPLETE_ORDERS = {
                    alias: "icon_tasks_complete_orders"
                },
                e.ICON_TASKS_ENERGY = {
                    alias: "icon_tasks_energy"
                },
                e.ICON_TASKS_OPEN_SUPPLIES = {
                    alias: "icon_tasks_open_supplies"
                },
                e.ICON_TASKS_PURCHASE_LAND = {
                    alias: "icon_tasks_purchase_land"
                },
                e.ICON_TASKS_REMOVE_NATURE = {
                    alias: "icon_tasks_remove_nature"
                },
                e.ICON_TASKS_REPAIR = {
                    alias: "icon_tasks_repair"
                },
                e.OVERLAY_LANDSCAPE_GRADIENT = {
                    alias: "overlay_landscape_gradient"
                },
                e.OVERLAY_TOP_GRADIENT = {
                    alias: "overlay_top_gradient"
                },
                e.UI_BUTTON_PROGRESSBAR_DAILYCHALLENGES_BACKGROUND = {
                    alias: "UI_button_progressbar_dailychallenges_background"
                },
                e.UI_BUTTON_PROGRESSBAR_DAILYCHALLENGES_FILL = {
                    alias: "UI_button_progressbar_dailychallenges_fill"
                },
                e.ICON_CHARACTER_COFFEE = {
                    alias: "icon_character_coffee"
                },
                e.BTN_HUD_SMALL_FACEBOOK_DOWN = {
                    alias: "btn_HUD_small_facebook_down"
                },
                e.ICON_CHARACTER_SWEETS = {
                    alias: "icon_character_sweets"
                },
                e.ICON_BUTTON_HUD_STORAGE = {
                    alias: "icon_button_HUD_storage"
                },
                e.ICON_BALLOON_TRAINTICKET = {
                    alias: "icon_balloon_trainticket"
                },
                e.ICON_EVENT_GOLDENCARROT = {
                    alias: "icon_event_goldencarrot"
                },
                e.ICON_EVENT_JINGLEBALL01 = {
                    alias: "icon_event_jingleball01"
                },
                e.ICON_EVENT_JINGLEBALL02 = {
                    alias: "icon_event_jingleball02"
                },
                e.ICON_EVENT_JINGLEBALL03 = {
                    alias: "icon_event_jingleball03"
                },
                e.ICON_EVENT_JINGLEBALL04 = {
                    alias: "icon_event_jingleball04"
                },
                e.ICON_GIFT_BY = {
                    alias: "icon_gift_by"
                },
                e.ICON_GIFT_PY = {
                    alias: "icon_gift_py"
                },
                e.ICON_GIFT_RY = {
                    alias: "icon_gift_ry"
                },
                e.ICON_GIFT_YO = {
                    alias: "icon_gift_yo"
                },
                e.ICON_KEY_BRONZE = {
                    alias: "icon_key_bronze"
                },
                e.ICON_KEY_GOLD = {
                    alias: "icon_key_gold"
                },
                e.ICON_KEY_GOLDEN_CARROT = {
                    alias: "icon_key_golden_carrot"
                },
                e.ICON_KEY_GOLDEN_PUMPKIN = {
                    alias: "icon_key_golden_pumpkin"
                },
                e.ICON_KEY_JINGLEBALL = {
                    alias: "icon_key_jingleball"
                },
                e.ICON_KEY_SILVER = {
                    alias: "icon_key_silver"
                },
                e.ICON_LOOTCRATE_BRONZE = {
                    alias: "icon_lootcrate_bronze"
                },
                e.ICON_LOOTCRATE_GOLD = {
                    alias: "icon_lootcrate_gold"
                },
                e.ICON_LOOTCRATE_GOLDENCARROT = {
                    alias: "icon_lootcrate_GoldenCarrot"
                },
                e.ICON_LOOTCRATE_JINGLEBALLS = {
                    alias: "icon_lootcrate_jingleballs"
                },
                e.ICON_LOOTCRATE_SILVER = {
                    alias: "icon_lootcrate_silver"
                },
                e.ICON_RECIPES_AVOCADO = {
                    alias: "icon_recipes_avocado"
                },
                e.ICON_RECIPES_AVOCADOEGGBURGER = {
                    alias: "icon_recipes_avocadoeggburger"
                },
                e.ICON_RECIPES_AVOCADOONTOAST = {
                    alias: "icon_recipes_avocadoontoast"
                },
                e.ICON_RECIPES_AVOCADOTACO = {
                    alias: "icon_recipes_avocadotaco"
                },
                e.ICON_RECIPES_AVOCADOWRAP = {
                    alias: "icon_recipes_avocadowrap"
                },
                e.ICON_RECIPES_BAG_DEER = {
                    alias: "icon_recipes_bag_deer"
                },
                e.ICON_RECIPES_BREAD = {
                    alias: "icon_recipes_bread"
                },
                e.ICON_RECIPES_BUTTER = {
                    alias: "icon_recipes_butter"
                },
                e.ICON_RECIPES_CAPPUCCINO = {
                    alias: "icon_recipes_cappuccino"
                },
                e.ICON_RECIPES_CARROTBREAD = {
                    alias: "icon_recipes_carrotbread"
                },
                e.ICON_RECIPES_CARROTCAKE = {
                    alias: "icon_recipes_carrotcake"
                },
                e.ICON_RECIPES_CARROTS = {
                    alias: "icon_recipes_carrots"
                },
                e.ICON_RECIPES_CHEESE = {
                    alias: "icon_recipes_cheese"
                },
                e.ICON_RECIPES_CHEESEPOPCORN = {
                    alias: "icon_recipes_cheesepopcorn"
                },
                e.ICON_RECIPES_COFFEEBAG = {
                    alias: "icon_recipes_coffeebag"
                },
                e.ICON_RECIPES_CORN = {
                    alias: "icon_recipes_corn"
                },
                e.ICON_RECIPES_EGGS = {
                    alias: "icon_recipes_eggs"
                },
                e.ICON_RECIPES_ESPRESSO = {
                    alias: "icon_recipes_espresso"
                },
                e.ICON_RECIPES_GOATCHEESE = {
                    alias: "icon_recipes_goatcheese"
                },
                e.ICON_RECIPES_GOATSMILK = {
                    alias: "icon_recipes_goatsmilk"
                },
                e.ICON_RECIPES_GOATYOGHURT = {
                    alias: "icon_recipes_goatyoghurt"
                },
                e.ICON_RECIPES_GRILLEDCORN = {
                    alias: "icon_recipes_grilledcorn"
                },
                e.ICON_RECIPES_GRILLEDSANDWICH = {
                    alias: "icon_recipes_grilledsandwich"
                },
                e.ICON_RECIPES_ICECREAMCONE = {
                    alias: "icon_recipes_icecreamcone"
                },
                e.ICON_RECIPES_JACKET = {
                    alias: "icon_recipes_jacket"
                },
                e.ICON_RECIPES_MILK = {
                    alias: "icon_recipes_milk"
                },
                e.ICON_RECIPES_MUFFIN = {
                    alias: "icon_recipes_muffin"
                },
                e.ICON_RECIPES_OMELET = {
                    alias: "icon_recipes_omelet"
                },
                e.ICON_RECIPES_PANCAKES = {
                    alias: "icon_recipes_pancakes"
                },
                e.ICON_RECIPES_PILLOW_DEER = {
                    alias: "icon_recipes_pillow_deer"
                },
                e.ICON_RECIPES_POPCORN = {
                    alias: "icon_recipes_popcorn"
                },
                e.ICON_RECIPES_RAWBACON = {
                    alias: "icon_recipes_rawbacon"
                },
                e.ICON_RECIPES_SOCKS = {
                    alias: "icon_recipes_socks"
                },
                e.ICON_RECIPES_SOYBEANS = {
                    alias: "icon_recipes_soybeans"
                },
                e.ICON_RECIPES_SOYSAUCE = {
                    alias: "icon_recipes_soysauce"
                },
                e.ICON_RECIPES_SUGAR = {
                    alias: "icon_recipes_sugar"
                },
                e.ICON_RECIPES_SUNFLOWEROIL = {
                    alias: "icon_recipes_sunfloweroil"
                },
                e.ICON_RECIPES_TIRAMISU = {
                    alias: "icon_recipes_tiramisu"
                },
                e.ICON_RECIPES_TOFU = {
                    alias: "icon_recipes_tofu"
                },
                e.ICON_RECIPES_TOFUBURGER = {
                    alias: "icon_recipes_tofuburger"
                },
                e.ICON_RECIPES_TOMATO = {
                    alias: "icon_recipes_tomato"
                },
                e.ICON_RECIPES_TOMATOBURGER = {
                    alias: "icon_recipes_tomatoburger"
                },
                e.ICON_RECIPES_TOMATOFILLED = {
                    alias: "icon_recipes_tomatofilled"
                },
                e.ICON_RECIPES_TOMATOSALADONSTICK = {
                    alias: "icon_recipes_tomatosaladonstick"
                },
                e.ICON_RECIPES_GRILLEDBACON = {
                    alias: "icon_recipes_grilledbacon"
                },
                e.ICON_RECIPES_TROUSERS = {
                    alias: "icon_recipes_trousers"
                },
                e.ICON_RECIPES_TRUFFLE = {
                    alias: "icon_recipes_truffle"
                },
                e.ICON_RECIPES_TRUFFLEBALLS = {
                    alias: "icon_recipes_truffleballs"
                },
                e.ICON_RECIPES_TRUFFLEGRILLEDCHEESESANDW = {
                    alias: "icon_recipes_trufflegrilledcheesesandw"
                },
                e.ICON_RECIPES_TRUFFLEPASTAPLATE = {
                    alias: "icon_recipes_trufflepastaplate"
                },
                e.ICON_RECIPES_WOOL = {
                    alias: "icon_recipes_wool"
                },
                e.ICON_TRAIN_TICKET = {
                    alias: "icon_train_ticket"
                },
                e.OBJ_ANIMAL_CHICKEN_00 = {
                    alias: "obj_animal_chicken_00"
                },
                e.OBJ_ANIMAL_CHICKEN_01 = {
                    alias: "obj_animal_chicken_01"
                },
                e.ICON_RECIPES_TOMATOSOUP = {
                    alias: "icon_recipes_tomatosoup"
                },
                e.OBJ_ANIMAL_CHICKEN_02 = {
                    alias: "obj_animal_chicken_02"
                },
                e.OBJ_ANIMAL_CHICKEN_04 = {
                    alias: "obj_animal_chicken_04"
                },
                e.OBJ_ANIMAL_CHICKEN_05_DEPLETED = {
                    alias: "obj_animal_chicken_05_depleted"
                },
                e.OBJ_ANIMAL_COW_00 = {
                    alias: "obj_animal_cow_00"
                },
                e.OBJ_ANIMAL_COW_01 = {
                    alias: "obj_animal_cow_01"
                },
                e.OBJ_ANIMAL_COW_02 = {
                    alias: "obj_animal_cow_02"
                },
                e.OBJ_ANIMAL_COW_03 = {
                    alias: "obj_animal_cow_03"
                },
                e.OBJ_ANIMAL_COW_04 = {
                    alias: "obj_animal_cow_04"
                },
                e.OBJ_ANIMAL_CHICKEN_03 = {
                    alias: "obj_animal_chicken_03"
                },
                e.OBJ_ANIMAL_DEER_00 = {
                    alias: "obj_animal_deer_00"
                },
                e.OBJ_ANIMAL_DEER_01 = {
                    alias: "obj_animal_deer_01"
                },
                e.OBJ_ANIMAL_DEER_02 = {
                    alias: "obj_animal_deer_02"
                },
                e.OBJ_ANIMAL_DEER_03 = {
                    alias: "obj_animal_deer_03"
                },
                e.OBJ_ANIMAL_DEER_04_REGENERATING = {
                    alias: "obj_animal_deer_04_regenerating"
                },
                e.OBJ_ANIMAL_COW_05_DEPLETED = {
                    alias: "obj_animal_cow_05_depleted"
                },
                e.OBJ_ANIMAL_GOAT_00 = {
                    alias: "obj_animal_goat_00"
                },
                e.OBJ_ANIMAL_GOAT_01 = {
                    alias: "obj_animal_goat_01"
                },
                e.OBJ_ANIMAL_GOAT_02 = {
                    alias: "obj_animal_goat_02"
                },
                e.OBJ_ANIMAL_GOAT_03 = {
                    alias: "obj_animal_goat_03"
                },
                e.OBJ_ANIMAL_GOAT_04 = {
                    alias: "obj_animal_goat_04"
                },
                e.OBJ_ANIMAL_GOAT_05_DEPLETED = {
                    alias: "obj_animal_goat_05_depleted"
                },
                e.ICON_RECIPES_FLOUR = {
                    alias: "icon_recipes_flour"
                },
                e.OBJ_ANIMAL_PIG_01 = {
                    alias: "obj_animal_pig_01"
                },
                e.OBJ_ANIMAL_PIG_02 = {
                    alias: "obj_animal_pig_02"
                },
                e.OBJ_ANIMAL_PIG_03 = {
                    alias: "obj_animal_pig_03"
                },
                e.OBJ_ANIMAL_PIG_04 = {
                    alias: "obj_animal_pig_04"
                },
                e.OBJ_ANIMAL_PIG_05_DEPLETED = {
                    alias: "obj_animal_pig_05_depleted"
                },
                e.OBJ_ANIMAL_SHEEP_01 = {
                    alias: "obj_animal_sheep_01"
                },
                e.OBJ_ANIMAL_SHEEP_03 = {
                    alias: "obj_animal_sheep_03"
                },
                e.OBJ_ANIMAL_SHEEP_04 = {
                    alias: "obj_animal_sheep_04"
                },
                e.OBJ_ANIMAL_SHEEP_05_DEPLETED = {
                    alias: "obj_animal_sheep_05_depleted"
                },
                e.OBJ_ANIMAL_TRUFFLEPIG_00 = {
                    alias: "obj_animal_trufflepig_00"
                },
                e.OBJ_ANIMAL_TRUFFLEPIG_01 = {
                    alias: "obj_animal_trufflepig_01"
                },
                e.OBJ_ANIMAL_TRUFFLEPIG_02 = {
                    alias: "obj_animal_trufflepig_02"
                },
                e.OBJ_ANIMAL_TRUFFLEPIG_03 = {
                    alias: "obj_animal_trufflepig_03"
                },
                e.OBJ_ANIMAL_TRUFFLEPIG_04_REGENERATING = {
                    alias: "obj_animal_trufflepig_04_regenerating"
                },
                e.OBJ_ANIMAL_TRUFFLEPIG_05_DEPLETED = {
                    alias: "obj_animal_trufflepig_05_depleted"
                },
                e.OBJ_ANIMAL_DEER_05_DEPLETED = {
                    alias: "obj_animal_deer_05_depleted"
                },
                e.OBJ_CHICKENCOOP_BROKEN = {
                    alias: "obj_chickencoop_broken"
                },
                e.OBJ_COLLECTION_BROKEN = {
                    alias: "obj_collection_broken"
                },
                e.OBJ_COLLECTION = {
                    alias: "obj_collection"
                },
                e.OBJ_CROPS_AVOCADO_00 = {
                    alias: "obj_crops_avocado_00"
                },
                e.OBJ_CROPS_AVOCADO_01 = {
                    alias: "obj_crops_avocado_01"
                },
                e.OBJ_CROPS_AVOCADO_02 = {
                    alias: "obj_crops_avocado_02"
                },
                e.OBJ_CROPS_AVOCADO_03 = {
                    alias: "obj_crops_avocado_03"
                },
                e.OBJ_CROPS_AVOCADO_04_REGENERATING = {
                    alias: "obj_crops_avocado_04_regenerating"
                },
                e.OBJ_CROPS_AVOCADO_05_DEPLETED = {
                    alias: "obj_crops_avocado_05_depleted"
                },
                e.OBJ_CROPS_CARROT_00 = {
                    alias: "obj_crops_carrot_00"
                },
                e.OBJ_CROPS_CARROT_01 = {
                    alias: "obj_crops_carrot_01"
                },
                e.OBJ_CROPS_CARROT_02 = {
                    alias: "obj_crops_carrot_02"
                },
                e.OBJ_CROPS_CARROT_03 = {
                    alias: "obj_crops_carrot_03"
                },
                e.OBJ_CROPS_CARROT_04 = {
                    alias: "obj_crops_carrot_04"
                },
                e.OBJ_CROPS_CHRISTMASTREE_00 = {
                    alias: "obj_crops_christmastree_00"
                },
                e.OBJ_CROPS_CHRISTMASTREE_01 = {
                    alias: "obj_crops_christmastree_01"
                },
                e.OBJ_CROPS_CHRISTMASTREE_02 = {
                    alias: "obj_crops_christmastree_02"
                },
                e.OBJ_CROPS_CHRISTMASTREE_03 = {
                    alias: "obj_crops_christmastree_03"
                },
                e.OBJ_CROPS_CHRISTMASTREE_04_REGENERATING = {
                    alias: "obj_crops_christmastree_04_regenerating"
                },
                e.OBJ_CROPS_CHRISTMASTREE_05_DEPLETED = {
                    alias: "obj_crops_christmastree_05_depleted"
                },
                e.OBJ_CROPS_COFFEE_00 = {
                    alias: "obj_crops_coffee_00"
                },
                e.OBJ_CROPS_COFFEE_01 = {
                    alias: "obj_crops_coffee_01"
                },
                e.OBJ_CROPS_COFFEE_02 = {
                    alias: "obj_crops_coffee_02"
                },
                e.OBJ_CROPS_COFFEE_03 = {
                    alias: "obj_crops_coffee_03"
                },
                e.OBJ_CROPS_COFFEE_04_REGENERATING = {
                    alias: "obj_crops_coffee_04_regenerating"
                },
                e.OBJ_CROPS_COFFEE_05_DEPLETED = {
                    alias: "obj_crops_coffee_05_depleted"
                },
                e.OBJ_CROPS_CORN_00 = {
                    alias: "obj_crops_corn_00"
                },
                e.OBJ_CROPS_CORN_01 = {
                    alias: "obj_crops_corn_01"
                },
                e.OBJ_CROPS_CORN_03 = {
                    alias: "obj_crops_corn_03"
                },
                e.OBJ_CROPS_CORN_04 = {
                    alias: "obj_crops_corn_04"
                },
                e.OBJ_CROPS_CORN_05_DEPLETED = {
                    alias: "obj_crops_corn_05_depleted"
                },
                e.OBJ_CROPS_SOYBEAN_00 = {
                    alias: "obj_crops_soybean_00"
                },
                e.OBJ_CROPS_SOYBEAN_01 = {
                    alias: "obj_crops_soybean_01"
                },
                e.OBJ_CROPS_SOYBEAN_02 = {
                    alias: "obj_crops_soybean_02"
                },
                e.OBJ_CROPS_SOYBEAN_03 = {
                    alias: "obj_crops_soybean_03"
                },
                e.OBJ_CROPS_SOYBEAN_04_REGENERATING = {
                    alias: "obj_crops_soybean_04_regenerating"
                },
                e.OBJ_CROPS_SOYBEAN_05_DEPLETED = {
                    alias: "obj_crops_soybean_05_depleted"
                },
                e.OBJ_CROPS_SUGARCANE_00 = {
                    alias: "obj_crops_sugarcane_00"
                },
                e.OBJ_CROPS_SUGARCANE_01 = {
                    alias: "obj_crops_sugarcane_01"
                },
                e.OBJ_CROPS_SUGARCANE_02 = {
                    alias: "obj_crops_sugarcane_02"
                },
                e.OBJ_CROPS_SUGARCANE_03 = {
                    alias: "obj_crops_sugarcane_03"
                },
                e.OBJ_CROPS_SUGARCANE_04_REGENERATING = {
                    alias: "obj_crops_sugarcane_04_regenerating"
                },
                e.OBJ_CROPS_SUGARCANE_05_DEPLETED = {
                    alias: "obj_crops_sugarcane_05_depleted"
                },
                e.OBJ_CROPS_SUNFLOWER_00 = {
                    alias: "obj_crops_sunflower_00"
                },
                e.OBJ_CROPS_SUNFLOWER_01 = {
                    alias: "obj_crops_sunflower_01"
                },
                e.OBJ_CROPS_SUNFLOWER_02 = {
                    alias: "obj_crops_sunflower_02"
                },
                e.OBJ_CROPS_SUNFLOWER_03 = {
                    alias: "obj_crops_sunflower_03"
                },
                e.OBJ_CROPS_SUNFLOWER_04 = {
                    alias: "obj_crops_sunflower_04"
                },
                e.OBJ_CROPS_SUNFLOWER_05_DEPLETED = {
                    alias: "obj_crops_sunflower_05_depleted"
                },
                e.OBJ_CROPS_TOMATO_00 = {
                    alias: "obj_crops_tomato_00"
                },
                e.OBJ_CROPS_TOMATO_01 = {
                    alias: "obj_crops_tomato_01"
                },
                e.OBJ_CROPS_TOMATO_02 = {
                    alias: "obj_crops_tomato_02"
                },
                e.OBJ_CROPS_TOMATO_03 = {
                    alias: "obj_crops_tomato_03"
                },
                e.OBJ_CROPS_TOMATO_04_REGENERATING = {
                    alias: "obj_crops_tomato_04_regenerating"
                },
                e.OBJ_CROPS_CORN_02 = {
                    alias: "obj_crops_corn_02"
                },
                e.OBJ_CROPS_WHEAT_00 = {
                    alias: "obj_crops_wheat_00"
                },
                e.OBJ_CROPS_CARROT_05_DEPLETED = {
                    alias: "obj_crops_carrot_05_depleted"
                },
                e.OBJ_CROPS_TOMATO_05_DEPLETED = {
                    alias: "obj_crops_tomato_05_depleted"
                },
                e.OBJ_CROPS_WHEAT_03 = {
                    alias: "obj_crops_wheat_03"
                },
                e.OBJ_CROPS_WHEAT_04 = {
                    alias: "obj_crops_wheat_04"
                },
                e.OBJ_CROPS_WHEAT_05 = {
                    alias: "obj_crops_wheat_05"
                },
                e.OBJ_DECORATEIVE_BARN_BROKEN = {
                    alias: "obj_decorateive_barn_broken"
                },
                e.OBJ_DECORATEIVE_BARN = {
                    alias: "obj_decorateive_barn"
                },
                e.OBJ_DECORATEIVE_BIRDSHOUSE_BROKEN = {
                    alias: "obj_decorateive_birdshouse_broken"
                },
                e.OBJ_DECORATEIVE_BIRDSHOUSE = {
                    alias: "obj_decorateive_birdshouse"
                },
                e.OBJ_DECORATEIVE_CHICKENCOOP_BROKEN = {
                    alias: "obj_decorateive_chickencoop_broken"
                },
                e.OBJ_DECORATEIVE_CHICKENCOOP = {
                    alias: "obj_decorateive_chickencoop"
                },
                e.OBJ_DECORATEIVE_DOGHOUSE_BROKEN = {
                    alias: "obj_decorateive_doghouse_broken"
                },
                e.OBJ_DECORATEIVE_DOGHOUSE = {
                    alias: "obj_decorateive_doghouse"
                },
                e.OBJ_DECORATEIVE_FARMHOUSE_BROKEN = {
                    alias: "obj_decorateive_farmhouse_broken"
                },
                e.OBJ_DECORATEIVE_FARMHOUSE = {
                    alias: "obj_decorateive_farmhouse"
                },
                e.OBJ_DECORATEIVE_FEEDINGTROUGH_BROKEN = {
                    alias: "obj_decorateive_feedingtrough_broken"
                },
                e.OBJ_DECORATEIVE_FEEDINGTROUGH = {
                    alias: "obj_decorateive_feedingtrough"
                },
                e.OBJ_DECORATEIVE_FLOWERPOTS_BROKEN = {
                    alias: "obj_decorateive_flowerpots_broken"
                },
                e.OBJ_DECORATEIVE_FLOWERPOTS = {
                    alias: "obj_decorateive_flowerpots"
                },
                e.OBJ_DECORATEIVE_FOUNTAIN_BROKEN = {
                    alias: "obj_decorateive_fountain_broken"
                },
                e.OBJ_DECORATEIVE_FOUNTAIN = {
                    alias: "obj_decorateive_fountain"
                },
                e.OBJ_DECORATEIVE_HAYWAGON_BROKEN = {
                    alias: "obj_decorateive_haywagon_broken"
                },
                e.OBJ_DECORATEIVE_HAYWAGON = {
                    alias: "obj_decorateive_haywagon"
                },
                e.OBJ_DECORATEIVE_LAMPPOST_BROKEN = {
                    alias: "obj_decorateive_lamppost_broken"
                },
                e.OBJ_DECORATEIVE_LAMPPOST = {
                    alias: "obj_decorateive_lamppost"
                },
                e.OBJ_DECORATEIVE_MILKTANK_BROKEN = {
                    alias: "obj_decorateive_milktank_broken"
                },
                e.OBJ_DECORATEIVE_MILKTANK = {
                    alias: "obj_decorateive_milktank"
                },
                e.OBJ_DECORATEIVE_PICKNICKTABLE_BROKEN = {
                    alias: "obj_decorateive_picknicktable_broken"
                },
                e.OBJ_CROPS_WHEAT_01 = {
                    alias: "obj_crops_wheat_01"
                },
                e.OBJ_CHICKENCOOP = {
                    alias: "obj_chickencoop"
                },
                e.OBJ_DECORATEIVE_SHED_BROKEN = {
                    alias: "obj_decorateive_shed_broken"
                },
                e.OBJ_DECORATEIVE_SHED = {
                    alias: "obj_decorateive_shed"
                },
                e.OBJ_DECORATEIVE_SILO_BROKEN = {
                    alias: "obj_decorateive_silo_broken"
                },
                e.OBJ_DECORATEIVE_SILO = {
                    alias: "obj_decorateive_silo"
                },
                e.OBJ_DECORATEIVE_STONEFLOWERPOT_BROKEN = {
                    alias: "obj_decorateive_stoneflowerpot_broken"
                },
                e.OBJ_DECORATEIVE_STONEFLOWERPOT = {
                    alias: "obj_decorateive_stoneflowerpot"
                },
                e.OBJ_DECORATEIVE_TOILET_CABIN_BROKEN = {
                    alias: "obj_decorateive_toilet_cabin_broken"
                },
                e.OBJ_DECORATEIVE_TOILET_CABIN = {
                    alias: "obj_decorateive_toilet_cabin"
                },
                e.OBJ_DECORATEIVE_WATERTOWER = {
                    alias: "obj_decorateive_watertower"
                },
                e.OBJ_DECORATEIVE_WELL_BROKEN = {
                    alias: "obj_decorateive_well_broken"
                },
                e.OBJ_DECORATEIVE_WATERTOWER_BROKEN = {
                    alias: "obj_decorateive_watertower_broken"
                },
                e.OBJ_DECORATEIVE_WELL = {
                    alias: "obj_decorateive_well"
                },
                e.OBJ_DECORATEIVE_WINDMILL_BROKEN = {
                    alias: "obj_decorateive_windmill_broken"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_CANDYGATE = {
                    alias: "obj_decorative_christmas_candygate"
                },
                e.OBJ_DECORATEIVE_WINDMILL = {
                    alias: "obj_decorateive_windmill"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_ELFMAIL = {
                    alias: "obj_decorative_christmas_elfmail"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_ELFTEDDY = {
                    alias: "obj_decorative_christmas_elfteddy"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_ELFTRAIN = {
                    alias: "obj_decorative_christmas_elftrain"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_GIFT01 = {
                    alias: "obj_decorative_christmas_gift01"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_GIFT02 = {
                    alias: "obj_decorative_christmas_gift02"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_FIREPLACE = {
                    alias: "obj_decorative_christmas_fireplace"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_GIFT03 = {
                    alias: "obj_decorative_christmas_gift03"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_GINGERBELL = {
                    alias: "obj_decorative_christmas_gingerbell"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_GINGERBREADHOUSESMALL = {
                    alias: "obj_decorative_christmas_gingerbreadhousesmall"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_GINGERBREADSNOW = {
                    alias: "obj_decorative_christmas_gingerbreadsnow"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_NUTCRACKER = {
                    alias: "obj_decorative_christmas_nutcracker"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SANTAGIFT = {
                    alias: "obj_decorative_christmas_santagift"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_GINGERBREADHOUSE = {
                    alias: "obj_decorative_christmas_gingerbreadhouse"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SANTAMAIL = {
                    alias: "obj_decorative_christmas_santamail"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SLEIGH = {
                    alias: "obj_decorative_christmas_sleigh"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SNOWCAROLING = {
                    alias: "obj_decorative_christmas_snowcaroling"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SNOWDINNER = {
                    alias: "obj_decorative_christmas_snowdinner"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SNOWFIGHT = {
                    alias: "obj_decorative_christmas_snowfight"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SNOWGIFTING = {
                    alias: "obj_decorative_christmas_snowgifting"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SNOWJELLO = {
                    alias: "obj_decorative_christmas_snowjello"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SNOWLANTERN = {
                    alias: "obj_decorative_christmas_snowlantern"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SNOWGLOBE = {
                    alias: "obj_decorative_christmas_snowglobe"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SNOWREINDEER = {
                    alias: "obj_decorative_christmas_snowreindeer"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_SNOWTELESCOPE = {
                    alias: "obj_decorative_christmas_snowtelescope"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_BLACKCAT = {
                    alias: "obj_decorative_halloween_blackcat"
                },
                e.OBJ_DECORATIVE_CHRISTMAS_TREEBIG = {
                    alias: "obj_decorative_christmas_treebig"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_GHOSTS = {
                    alias: "obj_decorative_halloween_ghosts"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_GRANDFATHERCLOCK = {
                    alias: "obj_decorative_halloween_grandfatherclock"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_CAULDRON = {
                    alias: "obj_decorative_halloween_cauldron"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_GRAVE01 = {
                    alias: "obj_decorative_halloween_grave01"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_GRAVE02 = {
                    alias: "obj_decorative_halloween_grave02"
                },
                e.OBJ_CROPS_WHEAT_02 = {
                    alias: "obj_crops_wheat_02"
                },
                e.OBJ_DECORATEIVE_PICKNICKTABLE = {
                    alias: "obj_decorateive_picknicktable"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_GRAVEYARD = {
                    alias: "obj_decorative_halloween_graveyard"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_PUMPKINPATCHBIG = {
                    alias: "obj_decorative_halloween_pumpkinpatchbig"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_PUMPKINS01 = {
                    alias: "obj_decorative_halloween_pumpkins01"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_PUMPKINS02 = {
                    alias: "obj_decorative_halloween_pumpkins02"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_PUMPKINS03 = {
                    alias: "obj_decorative_halloween_pumpkins03"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_HAUNTEDHOUSE = {
                    alias: "obj_decorative_halloween_hauntedhouse"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_PUMPKINS04 = {
                    alias: "obj_decorative_halloween_pumpkins04"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_SKELETONBENCH = {
                    alias: "obj_decorative_halloween_skeletonbench"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_SKELETONCAROUSEL = {
                    alias: "obj_decorative_halloween_skeletoncarousel"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_SKULLALTAR = {
                    alias: "obj_decorative_halloween_skullaltar"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_SKELETONPICNIC = {
                    alias: "obj_decorative_halloween_skeletonpicnic"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_TREEFACE = {
                    alias: "obj_decorative_halloween_treeface"
                },
                e.OBJ_DECORATIVE_HALLOWEEN_WELL = {
                    alias: "obj_decorative_halloween_well"
                },
                e.OBJ_DELIVERY_CRATE = {
                    alias: "obj_delivery_crate"
                },
                e.OBJ_ECONOMY_MARKETPLACE = {
                    alias: "obj_economy_marketplace"
                },
                e.OBJ_ENERGY_00 = {
                    alias: "obj_energy_00"
                },
                e.OBJ_ENERGY_01 = {
                    alias: "obj_energy_01"
                },
                e.OBJ_ENERGY_02 = {
                    alias: "obj_energy_02"
                },
                e.OBJ_ENERGY_03 = {
                    alias: "obj_energy_03"
                },
                e.OBJ_HEAVY_HAYBLOCKS = {
                    alias: "obj_heavy_hayblocks"
                },
                e.OBJ_HEAVY_TRACTOR = {
                    alias: "obj_heavy_tractor"
                },
                e.OBJ_MISSING_ASSET = {
                    alias: "obj_missing_asset"
                },
                e.OBJ_NATURE_BRICKPILE_02 = {
                    alias: "obj_nature_brickpile_02"
                },
                e.OBJ_NATURE_BRICKPILE_03 = {
                    alias: "obj_nature_brickpile_03"
                },
                e.OBJ_NATURE_BRICKPILE_04 = {
                    alias: "obj_nature_brickpile_04"
                },
                e.OBJ_NATURE_BRICKPILE_05 = {
                    alias: "obj_nature_brickpile_05"
                },
                e.OBJ_NATURE_BRICKPILE_06 = {
                    alias: "obj_nature_brickpile_06"
                },
                e.OBJ_NATURE_BRICKPILE_07 = {
                    alias: "obj_nature_brickpile_07"
                },
                e.OBJ_NATURE_ROCK_LARGE = {
                    alias: "obj_nature_rock_large"
                },
                e.OBJ_NATURE_ROCK_MEDIUM = {
                    alias: "obj_nature_rock_medium"
                },
                e.OBJ_NATURE_ROCK_SMALL = {
                    alias: "obj_nature_rock_small"
                },
                e.OBJ_NATURE_TREE_LARGE = {
                    alias: "obj_nature_tree_large"
                },
                e.OBJ_NATURE_TREE_MEDIUM = {
                    alias: "obj_nature_tree_medium"
                },
                e.OBJ_NATURE_TREE_ONBOARDING = {
                    alias: "obj_nature_tree_onboarding"
                },
                e.OBJ_NATURE_TREE_SMALL = {
                    alias: "obj_nature_tree_small"
                },
                e.OBJ_NATURE_WOOD_PILE_00 = {
                    alias: "obj_nature_wood_pile_00"
                },
                e.OBJ_NATURE_WOOD_PILE_02 = {
                    alias: "obj_nature_wood_pile_02"
                },
                e.OBJ_NATURE_WOOD_PILE_03 = {
                    alias: "obj_nature_wood_pile_03"
                },
                e.OBJ_NATURE_WOOD_PILE_06 = {
                    alias: "obj_nature_wood_pile_06"
                },
                e.OBJ_NATURE_WOOD_PILE_07 = {
                    alias: "obj_nature_wood_pile_07"
                },
                e.OBJ_PROD_AVOCADOFIESTA_BROKEN = {
                    alias: "obj_prod_avocadofiesta_broken"
                },
                e.OBJ_PROD_AVOCADOFIESTA = {
                    alias: "obj_prod_avocadofiesta"
                },
                e.OBJ_PROD_BAKERY_BROKEN = {
                    alias: "obj_prod_bakery_broken"
                },
                e.OBJ_PROD_BAKERY = {
                    alias: "obj_prod_bakery"
                },
                e.OBJ_PROD_BARISTA_BROKEN = {
                    alias: "obj_prod_barista_broken"
                },
                e.OBJ_PROD_BARISTA = {
                    alias: "obj_prod_barista"
                },
                e.OBJ_PROD_BBQ_BROKEN = {
                    alias: "obj_prod_BBQ_broken"
                },
                e.OBJ_PROD_BBQ = {
                    alias: "obj_prod_BBQ"
                },
                e.OBJ_PROD_DAIRYFACTORY_BROKEN = {
                    alias: "obj_prod_dairyfactory_broken"
                },
                e.OBJ_PROD_DAIRYFACTORY = {
                    alias: "obj_prod_dairyfactory"
                },
                e.OBJ_PROD_FARMERSMARKET_BROKEN = {
                    alias: "obj_prod_farmersmarket_broken"
                },
                e.OBJ_PROD_FARMERSMARKET = {
                    alias: "obj_prod_farmersmarket"
                },
                e.OBJ_PROD_LOOM_BROKEN = {
                    alias: "obj_prod_loom_broken"
                },
                e.OBJ_PROD_LOOM = {
                    alias: "obj_prod_loom"
                },
                e.OBJ_PROD_SWEETSSTATION_00 = {
                    alias: "obj_prod_sweetsstation_00"
                },
                e.OBJ_PROD_SWEETSSTATION_BROKEN = {
                    alias: "obj_prod_sweetsstation_broken"
                },
                e.OBJ_PROD_TOMATOONWHEELS_BROKEN = {
                    alias: "obj_prod_tomatoonwheels_broken"
                },
                e.OBJ_PROD_TOMATOONWHEELS = {
                    alias: "obj_prod_tomatoonwheels"
                },
                e.OBJ_PROD_TRUFFLELICIOUS_BROKEN = {
                    alias: "obj_prod_trufflelicious_broken"
                },
                e.OBJ_PROD_TRUFFLELICIOUS = {
                    alias: "obj_prod_trufflelicious"
                },
                e.OBJ_SOCIAL_CRANE = {
                    alias: "obj_social_crane"
                },
                e.OBJ_SOCIAL_CRATE = {
                    alias: "obj_social_crate"
                },
                e.OBJ_SOCIAL_LOCOMOTIVE = {
                    alias: "obj_social_locomotive"
                },
                e.OBJ_SOCIAL_RAIL = {
                    alias: "obj_social_rail"
                },
                e.OBJ_SOCIAL_TRAIN = {
                    alias: "obj_social_train"
                },
                e.OBJ_SOCIAL_TRAINSTATION = {
                    alias: "obj_social_trainstation"
                },
                e.OBJ_SQUADS_SQUADHOUSE = {
                    alias: "obj_squads_squadhouse"
                },
                e.OBJ_TOILET_BROKEN = {
                    alias: "obj_toilet_broken"
                },
                e.OBJ_TOILET = {
                    alias: "obj_toilet"
                },
                e.OBJ_TOOLBOX_LARGE = {
                    alias: "obj_toolbox_large"
                },
                e.OBJ_TOOLBOX_MEDIUM = {
                    alias: "obj_toolbox_medium"
                },
                e.OBJ_TOOLBOX_SMALL = {
                    alias: "obj_toolbox_small"
                },
                e.OBJ_TOOLS_01 = {
                    alias: "obj_tools_01"
                },
                e.OBJ_TOOLS_02 = {
                    alias: "obj_tools_02"
                },
                e.OBJ_TOOLS_03 = {
                    alias: "obj_tools_03"
                },
                e.OBJ_TOOLS_04 = {
                    alias: "obj_tools_04"
                },
                e.OBJ_TOOLS_05 = {
                    alias: "obj_tools_05"
                },
                e.OBJ_TOOLS_06 = {
                    alias: "obj_tools_06"
                },
                e.OBJ_TOOLS_07 = {
                    alias: "obj_tools_07"
                },
                e.OBJ_TOOLS_08 = {
                    alias: "obj_tools_08"
                },
                e.OBJ_TOOLS_09 = {
                    alias: "obj_tools_09"
                },
                e.OBJ_TOOLS_10 = {
                    alias: "obj_tools_10"
                },
                e.OBJ_VALUABLES_COINS_00 = {
                    alias: "obj_valuables_coins_00"
                },
                e.OBJ_VALUABLES_COINS_01 = {
                    alias: "obj_valuables_coins_01"
                },
                e.OBJ_VALUABLES_COINS_02 = {
                    alias: "obj_valuables_coins_02"
                },
                e.OBJ_VALUABLES_COINS_03 = {
                    alias: "obj_valuables_coins_03"
                },
                e.OBJ_VALUABLES_COINS_04 = {
                    alias: "obj_valuables_coins_04"
                },
                e.OBJ_VALUABLES_COINS_06 = {
                    alias: "obj_valuables_coins_06"
                },
                e.OBJ_VALUABLES_COINS_07 = {
                    alias: "obj_valuables_coins_07"
                },
                e.OBJ_VALUABLES_GEMS_00 = {
                    alias: "obj_valuables_gems_00"
                },
                e.OBJ_VALUABLES_GEMS_01 = {
                    alias: "obj_valuables_gems_01"
                },
                e.OBJ_VALUABLES_GEMS_02 = {
                    alias: "obj_valuables_gems_02"
                },
                e.OBJ_VALUABLES_GEMS_03 = {
                    alias: "obj_valuables_gems_03"
                },
                e.OBJ_VALUABLES_GEMS_04 = {
                    alias: "obj_valuables_gems_04"
                },
                e.OBJ_VALUABLES_GEMS_05 = {
                    alias: "obj_valuables_gems_05"
                },
                e.OBJ_WINDMILL_BROKEN = {
                    alias: "obj_windmill_broken"
                },
                e.TILE_BAKED_191_717 = {
                    alias: "tile_baked_191_717"
                },
                e.OBJ_WINDMILL = {
                    alias: "obj_windmill"
                },
                e.TILE_BAKED_191_718 = {
                    alias: "tile_baked_191_718"
                },
                e.TILE_BAKED_191_720 = {
                    alias: "tile_baked_191_720"
                },
                e.TILE_BAKED_191_721 = {
                    alias: "tile_baked_191_721"
                },
                e.TILE_BAKED_191_722 = {
                    alias: "tile_baked_191_722"
                },
                e.TILE_BAKED_191_724 = {
                    alias: "tile_baked_191_724"
                },
                e.TILE_BAKED_191_725 = {
                    alias: "tile_baked_191_725"
                },
                e.TILE_BAKED_191_730 = {
                    alias: "tile_baked_191_730"
                },
                e.TILE_BAKED_191_732 = {
                    alias: "tile_baked_191_732"
                },
                e.TILE_BAKED_191 = {
                    alias: "tile_baked_191"
                },
                e.TILE_BAKED_194 = {
                    alias: "tile_baked_194"
                },
                e.TILE_BAKED_195 = {
                    alias: "tile_baked_195"
                },
                e.TILE_BAKED_196 = {
                    alias: "tile_baked_196"
                },
                e.TILE_BAKED_251_791 = {
                    alias: "tile_baked_251_791"
                },
                e.TILE_BAKED_251_793 = {
                    alias: "tile_baked_251_793"
                },
                e.TILE_BAKED_251_797 = {
                    alias: "tile_baked_251_797"
                },
                e.TILE_BAKED_251 = {
                    alias: "tile_baked_251"
                },
                e.TILE_BAKED_266_716 = {
                    alias: "tile_baked_266_716"
                },
                e.TILE_BAKED_266_717 = {
                    alias: "tile_baked_266_717"
                },
                e.TILE_BAKED_266_718 = {
                    alias: "tile_baked_266_718"
                },
                e.TILE_BAKED_266_720 = {
                    alias: "tile_baked_266_720"
                },
                e.TILE_BAKED_266_721 = {
                    alias: "tile_baked_266_721"
                },
                e.TILE_BAKED_266_722 = {
                    alias: "tile_baked_266_722"
                },
                e.TILE_BAKED_266_724 = {
                    alias: "tile_baked_266_724"
                },
                e.TILE_BAKED_266_725 = {
                    alias: "tile_baked_266_725"
                },
                e.TILE_BAKED_266_728 = {
                    alias: "tile_baked_266_728"
                },
                e.TILE_BAKED_266_731 = {
                    alias: "tile_baked_266_731"
                },
                e.TILE_BAKED_266_733 = {
                    alias: "tile_baked_266_733"
                },
                e.TILE_BAKED_266 = {
                    alias: "tile_baked_266"
                },
                e.TILE_BAKED_269 = {
                    alias: "tile_baked_269"
                },
                e.TILE_BAKED_270 = {
                    alias: "tile_baked_270"
                },
                e.TILE_BAKED_271 = {
                    alias: "tile_baked_271"
                },
                e.TILE_BAKED_283_301 = {
                    alias: "tile_baked_283_301"
                },
                e.TILE_BAKED_283_303 = {
                    alias: "tile_baked_283_303"
                },
                e.TILE_BAKED_283_375_822 = {
                    alias: "tile_baked_283_375_822"
                },
                e.TILE_BAKED_283_435 = {
                    alias: "tile_baked_283_435"
                },
                e.TILE_BAKED_283_436 = {
                    alias: "tile_baked_283_436"
                },
                e.TILE_BAKED_283_437 = {
                    alias: "tile_baked_283_437"
                },
                e.TILE_BAKED_283_438 = {
                    alias: "tile_baked_283_438"
                },
                e.TILE_BAKED_283_479 = {
                    alias: "tile_baked_283_479"
                },
                e.TILE_BAKED_283_482 = {
                    alias: "tile_baked_283_482"
                },
                e.TILE_BAKED_283_483_484 = {
                    alias: "tile_baked_283_483_484"
                },
                e.TILE_BAKED_283_483 = {
                    alias: "tile_baked_283_483"
                },
                e.TILE_BAKED_283_484 = {
                    alias: "tile_baked_283_484"
                },
                e.TILE_BAKED_283_488_817 = {
                    alias: "tile_baked_283_488_817"
                },
                e.TILE_BAKED_283_488 = {
                    alias: "tile_baked_283_488"
                },
                e.TILE_BAKED_283_510 = {
                    alias: "tile_baked_283_510"
                },
                e.TILE_BAKED_283_511 = {
                    alias: "tile_baked_283_511"
                },
                e.TILE_BAKED_283_512 = {
                    alias: "tile_baked_283_512"
                },
                e.TILE_BAKED_283_513 = {
                    alias: "tile_baked_283_513"
                },
                e.TILE_BAKED_283_514 = {
                    alias: "tile_baked_283_514"
                },
                e.TILE_BAKED_283_555_556 = {
                    alias: "tile_baked_283_555_556"
                },
                e.TILE_BAKED_283_555 = {
                    alias: "tile_baked_283_555"
                },
                e.TILE_BAKED_283_556_810 = {
                    alias: "tile_baked_283_556_810"
                },
                e.TILE_BAKED_283_559 = {
                    alias: "tile_baked_283_559"
                },
                e.TILE_BAKED_283_561_562 = {
                    alias: "tile_baked_283_561_562"
                },
                e.TILE_BAKED_283_561_809 = {
                    alias: "tile_baked_283_561_809"
                },
                e.TILE_BAKED_283_561 = {
                    alias: "tile_baked_283_561"
                },
                e.TILE_BAKED_283_562_561 = {
                    alias: "tile_baked_283_562_561"
                },
                e.TILE_BAKED_283_562 = {
                    alias: "tile_baked_283_562"
                },
                e.TILE_BAKED_283_660_816 = {
                    alias: "tile_baked_283_660_816"
                },
                e.TILE_BAKED_283_661_811 = {
                    alias: "tile_baked_283_661_811"
                },
                e.TILE_BAKED_283_662 = {
                    alias: "tile_baked_283_662"
                },
                e.TILE_BAKED_283_663 = {
                    alias: "tile_baked_283_663"
                },
                e.TILE_BAKED_283_675 = {
                    alias: "tile_baked_283_675"
                },
                e.TILE_BAKED_283_676_810 = {
                    alias: "tile_baked_283_676_810"
                },
                e.TILE_BAKED_283_677 = {
                    alias: "tile_baked_283_677"
                },
                e.TILE_BAKED_283_733_292 = {
                    alias: "tile_baked_283_733_292"
                },
                e.TILE_BAKED_283_733 = {
                    alias: "tile_baked_283_733"
                },
                e.TILE_BAKED_283_747_362_660_819 = {
                    alias: "tile_baked_283_747_362_660_819"
                },
                e.TILE_BAKED_283_747_362_674_819 = {
                    alias: "tile_baked_283_747_362_674_819"
                },
                e.TILE_BAKED_283_747_372_297 = {
                    alias: "tile_baked_283_747_372_297"
                },
                e.TILE_BAKED_283_808 = {
                    alias: "tile_baked_283_808"
                },
                e.TILE_BAKED_283_809 = {
                    alias: "tile_baked_283_809"
                },
                e.TILE_BAKED_283_810 = {
                    alias: "tile_baked_283_810"
                },
                e.TILE_BAKED_283_811 = {
                    alias: "tile_baked_283_811"
                },
                e.TILE_BAKED_283_812 = {
                    alias: "tile_baked_283_812"
                },
                e.TILE_BAKED_283_813 = {
                    alias: "tile_baked_283_813"
                },
                e.TILE_BAKED_283_814 = {
                    alias: "tile_baked_283_814"
                },
                e.TILE_BAKED_283_815 = {
                    alias: "tile_baked_283_815"
                },
                e.TILE_BAKED_283_816 = {
                    alias: "tile_baked_283_816"
                },
                e.TILE_BAKED_283_817 = {
                    alias: "tile_baked_283_817"
                },
                e.TILE_BAKED_283_818 = {
                    alias: "tile_baked_283_818"
                },
                e.TILE_BAKED_283_819 = {
                    alias: "tile_baked_283_819"
                },
                e.TILE_BAKED_283_823 = {
                    alias: "tile_baked_283_823"
                },
                e.TILE_BAKED_283_824 = {
                    alias: "tile_baked_283_824"
                },
                e.TILE_BAKED_283_825 = {
                    alias: "tile_baked_283_825"
                },
                e.TILE_BAKED_283_826 = {
                    alias: "tile_baked_283_826"
                },
                e.TILE_BAKED_283 = {
                    alias: "tile_baked_283"
                },
                e.TILE_BAKED_326_790 = {
                    alias: "tile_baked_326_790"
                },
                e.TILE_BAKED_326_792 = {
                    alias: "tile_baked_326_792"
                },
                e.TILE_BAKED_326_797 = {
                    alias: "tile_baked_326_797"
                },
                e.TILE_BAKED_326 = {
                    alias: "tile_baked_326"
                },
                e.TILE_BAKED_358_285 = {
                    alias: "tile_baked_358_285"
                },
                e.TILE_BAKED_358_435 = {
                    alias: "tile_baked_358_435"
                },
                e.TILE_BAKED_358_436_809 = {
                    alias: "tile_baked_358_436_809"
                },
                e.TILE_BAKED_358_437_808 = {
                    alias: "tile_baked_358_437_808"
                },
                e.TILE_BAKED_358_438 = {
                    alias: "tile_baked_358_438"
                },
                e.TILE_BAKED_358_483_484 = {
                    alias: "tile_baked_358_483_484"
                },
                e.TILE_BAKED_358_483 = {
                    alias: "tile_baked_358_483"
                },
                e.TILE_BAKED_358_484_818 = {
                    alias: "tile_baked_358_484_818"
                },
                e.TILE_BAKED_358_484 = {
                    alias: "tile_baked_358_484"
                },
                e.TILE_BAKED_358_488 = {
                    alias: "tile_baked_358_488"
                },
                e.TILE_BAKED_358_489_809 = {
                    alias: "tile_baked_358_489_809"
                },
                e.TILE_BAKED_358_489 = {
                    alias: "tile_baked_358_489"
                },
                e.TILE_BAKED_358_490_489 = {
                    alias: "tile_baked_358_490_489"
                },
                e.TILE_BAKED_358_490 = {
                    alias: "tile_baked_358_490"
                },
                e.TILE_BAKED_358_510 = {
                    alias: "tile_baked_358_510"
                },
                e.TILE_BAKED_358_511 = {
                    alias: "tile_baked_358_511"
                },
                e.TILE_BAKED_358_512 = {
                    alias: "tile_baked_358_512"
                },
                e.TILE_BAKED_358_513 = {
                    alias: "tile_baked_358_513"
                },
                e.TILE_BAKED_358_514 = {
                    alias: "tile_baked_358_514"
                },
                e.TILE_BAKED_358_554_819 = {
                    alias: "tile_baked_358_554_819"
                },
                e.TILE_BAKED_358_554 = {
                    alias: "tile_baked_358_554"
                },
                e.TILE_BAKED_358_557 = {
                    alias: "tile_baked_358_557"
                },
                e.TILE_BAKED_358_560_808 = {
                    alias: "tile_baked_358_560_808"
                },
                e.TILE_BAKED_358_560_810 = {
                    alias: "tile_baked_358_560_810"
                },
                e.TILE_BAKED_358_560 = {
                    alias: "tile_baked_358_560"
                },
                e.TILE_BAKED_358_660 = {
                    alias: "tile_baked_358_660"
                },
                e.TILE_BAKED_358_661_809 = {
                    alias: "tile_baked_358_661_809"
                },
                e.TILE_BAKED_358_661_813 = {
                    alias: "tile_baked_358_661_813"
                },
                e.TILE_BAKED_358_662_814 = {
                    alias: "tile_baked_358_662_814"
                },
                e.TILE_BAKED_358_662 = {
                    alias: "tile_baked_358_662"
                },
                e.TILE_BAKED_358_663_808 = {
                    alias: "tile_baked_358_663_808"
                },
                e.TILE_BAKED_358_663 = {
                    alias: "tile_baked_358_663"
                },
                e.TILE_BAKED_358_733_365 = {
                    alias: "tile_baked_358_733_365"
                },
                e.TILE_BAKED_358_733 = {
                    alias: "tile_baked_358_733"
                },
                e.TILE_BAKED_358_747_362_660 = {
                    alias: "tile_baked_358_747_362_660"
                },
                e.TILE_BAKED_358_747_372_297 = {
                    alias: "tile_baked_358_747_372_297"
                },
                e.TILE_BAKED_358_808_490 = {
                    alias: "tile_baked_358_808_490"
                },
                e.TILE_BAKED_358_808 = {
                    alias: "tile_baked_358_808"
                },
                e.TILE_BAKED_358_809 = {
                    alias: "tile_baked_358_809"
                },
                e.TILE_BAKED_358_810 = {
                    alias: "tile_baked_358_810"
                },
                e.TILE_BAKED_358_811 = {
                    alias: "tile_baked_358_811"
                },
                e.TILE_BAKED_358_812 = {
                    alias: "tile_baked_358_812"
                },
                e.TILE_BAKED_358_813 = {
                    alias: "tile_baked_358_813"
                },
                e.TILE_BAKED_358_814 = {
                    alias: "tile_baked_358_814"
                },
                e.TILE_BAKED_358_815_480 = {
                    alias: "tile_baked_358_815_480"
                },
                e.TILE_BAKED_358_815 = {
                    alias: "tile_baked_358_815"
                },
                e.TILE_BAKED_358_816 = {
                    alias: "tile_baked_358_816"
                },
                e.TILE_BAKED_358_817 = {
                    alias: "tile_baked_358_817"
                },
                e.TILE_BAKED_358_818 = {
                    alias: "tile_baked_358_818"
                },
                e.TILE_BAKED_358_819 = {
                    alias: "tile_baked_358_819"
                },
                e.TILE_BAKED_358 = {
                    alias: "tile_baked_358"
                },
                e.TILE_BAKED_583_435 = {
                    alias: "tile_baked_583_435"
                },
                e.TILE_BAKED_583_436_812 = {
                    alias: "tile_baked_583_436_812"
                },
                e.TILE_BAKED_583_436 = {
                    alias: "tile_baked_583_436"
                },
                e.TILE_BAKED_583_437_814 = {
                    alias: "tile_baked_583_437_814"
                },
                e.TILE_BAKED_583_437 = {
                    alias: "tile_baked_583_437"
                },
                e.TILE_BAKED_583_438_817 = {
                    alias: "tile_baked_583_438_817"
                },
                e.TILE_BAKED_583_438 = {
                    alias: "tile_baked_583_438"
                },
                e.TILE_BAKED_583_485_816 = {
                    alias: "tile_baked_583_485_816"
                },
                e.TILE_BAKED_583_512 = {
                    alias: "tile_baked_583_512"
                },
                e.TILE_BAKED_583_555_556 = {
                    alias: "tile_baked_583_555_556"
                },
                e.TILE_BAKED_583_555 = {
                    alias: "tile_baked_583_555"
                },
                e.TILE_BAKED_583_556_808 = {
                    alias: "tile_baked_583_556_808"
                },
                e.TILE_BAKED_583_564 = {
                    alias: "tile_baked_583_564"
                },
                e.TILE_BAKED_583_565_564 = {
                    alias: "tile_baked_583_565_564"
                },
                e.TILE_BAKED_583_565 = {
                    alias: "tile_baked_583_565"
                },
                e.TILE_BAKED_583_808 = {
                    alias: "tile_baked_583_808"
                },
                e.TILE_BAKED_583_809 = {
                    alias: "tile_baked_583_809"
                },
                e.TILE_BAKED_583_810 = {
                    alias: "tile_baked_583_810"
                },
                e.TILE_BAKED_583_811 = {
                    alias: "tile_baked_583_811"
                },
                e.TILE_BAKED_583_812 = {
                    alias: "tile_baked_583_812"
                },
                e.TILE_BAKED_583_813 = {
                    alias: "tile_baked_583_813"
                },
                e.TILE_BAKED_583_814 = {
                    alias: "tile_baked_583_814"
                },
                e.TILE_BAKED_583_815 = {
                    alias: "tile_baked_583_815"
                },
                e.TILE_BAKED_583_816 = {
                    alias: "tile_baked_583_816"
                },
                e.TILE_BAKED_583_817 = {
                    alias: "tile_baked_583_817"
                },
                e.TILE_BAKED_583_818 = {
                    alias: "tile_baked_583_818"
                },
                e.TILE_BAKED_583_819 = {
                    alias: "tile_baked_583_819"
                },
                e.TILE_BAKED_583 = {
                    alias: "tile_baked_583"
                },
                e.TILE_BAKED_641 = {
                    alias: "tile_baked_641"
                },
                e.TILE_BAKED_647_272 = {
                    alias: "tile_baked_647_272"
                },
                e.TILE_BAKED_650 = {
                    alias: "tile_baked_650"
                },
                e.TILE_BAKED_652_202 = {
                    alias: "tile_baked_652_202"
                },
                e.TILE_BAKED_655_193_729 = {
                    alias: "tile_baked_655_193_729"
                },
                e.TILE_BAKED_655_193 = {
                    alias: "tile_baked_655_193"
                },
                e.TILE_BAKED_655_195_729 = {
                    alias: "tile_baked_655_195_729"
                },
                e.TILE_BAKED_655_195 = {
                    alias: "tile_baked_655_195"
                },
                e.TILE_BAKED_655_205_729 = {
                    alias: "tile_baked_655_205_729"
                },
                e.TILE_BAKED_655_205 = {
                    alias: "tile_baked_655_205"
                },
                e.TILE_BAKED_655_268 = {
                    alias: "tile_baked_655_268"
                },
                e.TILE_BAKED_655_270 = {
                    alias: "tile_baked_655_270"
                },
                e.TILE_BAKED_655_280_729 = {
                    alias: "tile_baked_655_280_729"
                },
                e.TILE_BAKED_655_280 = {
                    alias: "tile_baked_655_280"
                },
                e.TILE_BAKED_656_194 = {
                    alias: "tile_baked_656_194"
                },
                e.TILE_BAKED_656_196 = {
                    alias: "tile_baked_656_196"
                },
                e.TILE_BAKED_656_206 = {
                    alias: "tile_baked_656_206"
                },
                e.TILE_BAKED_656_269 = {
                    alias: "tile_baked_656_269"
                },
                e.TILE_BAKED_656_271 = {
                    alias: "tile_baked_656_271"
                },
                e.TILE_BAKED_656_281 = {
                    alias: "tile_baked_656_281"
                },
                e.TILE_BAKED_658_435 = {
                    alias: "tile_baked_658_435"
                },
                e.TILE_BAKED_658_436_816 = {
                    alias: "tile_baked_658_436_816"
                },
                e.TILE_BAKED_658_436_817 = {
                    alias: "tile_baked_658_436_817"
                },
                e.TILE_BAKED_658_436 = {
                    alias: "tile_baked_658_436"
                },
                e.TILE_BAKED_658_437_817 = {
                    alias: "tile_baked_658_437_817"
                },
                e.TILE_BAKED_658_437 = {
                    alias: "tile_baked_658_437"
                },
                e.TILE_BAKED_658_438_819 = {
                    alias: "tile_baked_658_438_819"
                },
                e.TILE_BAKED_658_438 = {
                    alias: "tile_baked_658_438"
                },
                e.TILE_BAKED_658_554 = {
                    alias: "tile_baked_658_554"
                },
                e.TILE_BAKED_658_563_817 = {
                    alias: "tile_baked_658_563_817"
                },
                e.TILE_BAKED_658_563 = {
                    alias: "tile_baked_658_563"
                },
                e.TILE_BAKED_658_808 = {
                    alias: "tile_baked_658_808"
                },
                e.TILE_BAKED_658_809 = {
                    alias: "tile_baked_658_809"
                },
                e.TILE_BAKED_658_810 = {
                    alias: "tile_baked_658_810"
                },
                e.TILE_BAKED_658_811 = {
                    alias: "tile_baked_658_811"
                },
                e.TILE_BAKED_658_812 = {
                    alias: "tile_baked_658_812"
                },
                e.TILE_BAKED_658_813 = {
                    alias: "tile_baked_658_813"
                },
                e.TILE_BAKED_658_814 = {
                    alias: "tile_baked_658_814"
                },
                e.TILE_BAKED_658_815 = {
                    alias: "tile_baked_658_815"
                },
                e.TILE_BAKED_658_816 = {
                    alias: "tile_baked_658_816"
                },
                e.TILE_BAKED_658_817 = {
                    alias: "tile_baked_658_817"
                },
                e.TILE_BAKED_658_818 = {
                    alias: "tile_baked_658_818"
                },
                e.TILE_BAKED_658_819 = {
                    alias: "tile_baked_658_819"
                },
                e.TILE_BAKED_658 = {
                    alias: "tile_baked_658"
                },
                e.TILE_BAKED_671_196 = {
                    alias: "tile_baked_671_196"
                },
                e.TILE_BAKED_671_271 = {
                    alias: "tile_baked_671_271"
                },
                e.TILE_BAKED_671 = {
                    alias: "tile_baked_671"
                },
                e.TILE_BAKED_674_195 = {
                    alias: "tile_baked_674_195"
                },
                e.TILE_BAKED_674_270 = {
                    alias: "tile_baked_674_270"
                },
                e.TILE_BAKED_674 = {
                    alias: "tile_baked_674"
                },
                e.TILE_BAKED_675_195 = {
                    alias: "tile_baked_675_195"
                },
                e.TILE_BAKED_677_194 = {
                    alias: "tile_baked_677_194"
                },
                e.TILE_BAKED_677_269 = {
                    alias: "tile_baked_677_269"
                },
                e.TILE_BAKED_680_268 = {
                    alias: "tile_baked_680_268"
                },
                e.TILE_BAKED_680 = {
                    alias: "tile_baked_680"
                },
                e.TILE_BAKED_701 = {
                    alias: "tile_baked_701"
                },
                e.TILE_BAKED_702_251 = {
                    alias: "tile_baked_702_251"
                },
                e.TILE_BAKED_702_326 = {
                    alias: "tile_baked_702_326"
                },
                e.TILE_BAKED_707 = {
                    alias: "tile_baked_707"
                },
                e.TILE_BAKED_708 = {
                    alias: "tile_baked_708"
                },
                e.TILE_BAKED_709_199 = {
                    alias: "tile_baked_709_199"
                },
                e.TILE_BAKED_709 = {
                    alias: "tile_baked_709"
                },
                e.TILE_BAKED_710 = {
                    alias: "tile_baked_710"
                },
                e.TILE_BAKED_711_233 = {
                    alias: "tile_baked_711_233"
                },
                e.TILE_BAKED_711 = {
                    alias: "tile_baked_711"
                },
                e.TILE_BAKED_712_234 = {
                    alias: "tile_baked_712_234"
                },
                e.TILE_BAKED_712_794 = {
                    alias: "tile_baked_712_794"
                },
                e.TILE_BAKED_712 = {
                    alias: "tile_baked_712"
                },
                e.TILE_BAKED_713 = {
                    alias: "tile_baked_713"
                },
                e.TILE_BAKED_714_236 = {
                    alias: "tile_baked_714_236"
                },
                e.TILE_BAKED_714_311 = {
                    alias: "tile_baked_714_311"
                },
                e.TILE_BAKED_714_794 = {
                    alias: "tile_baked_714_794"
                },
                e.TILE_BAKED_714 = {
                    alias: "tile_baked_714"
                },
                e.TILE_BAKED_715_788 = {
                    alias: "tile_baked_715_788"
                },
                e.TILE_BAKED_715_789 = {
                    alias: "tile_baked_715_789"
                },
                e.TILE_BAKED_715_794 = {
                    alias: "tile_baked_715_794"
                },
                e.TILE_BAKED_715 = {
                    alias: "tile_baked_715"
                },
                e.TILE_BAKED_716 = {
                    alias: "tile_baked_716"
                },
                e.TILE_BAKED_731 = {
                    alias: "tile_baked_731"
                },
                e.TILE_BAKED_733_285_292 = {
                    alias: "tile_baked_733_285_292"
                },
                e.TILE_BAKED_733_285_809 = {
                    alias: "tile_baked_733_285_809"
                },
                e.TILE_BAKED_733_285_818 = {
                    alias: "tile_baked_733_285_818"
                },
                e.TILE_BAKED_733_285_819 = {
                    alias: "tile_baked_733_285_819"
                },
                e.TILE_BAKED_733_285 = {
                    alias: "tile_baked_733_285"
                },
                e.TILE_BAKED_733_286_512 = {
                    alias: "tile_baked_733_286_512"
                },
                e.TILE_BAKED_733_286_819 = {
                    alias: "tile_baked_733_286_819"
                },
                e.TILE_BAKED_733_286_829 = {
                    alias: "tile_baked_733_286_829"
                },
                e.TILE_BAKED_733_286 = {
                    alias: "tile_baked_733_286"
                },
                e.TILE_BAKED_733_287_511 = {
                    alias: "tile_baked_733_287_511"
                },
                e.TILE_BAKED_733_287 = {
                    alias: "tile_baked_733_287"
                },
                e.TILE_BAKED_733_288_809 = {
                    alias: "tile_baked_733_288_809"
                },
                e.TILE_BAKED_733_288_810 = {
                    alias: "tile_baked_733_288_810"
                },
                e.TILE_BAKED_733_289_285_813 = {
                    alias: "tile_baked_733_289_285_813"
                },
                e.TILE_BAKED_733_289 = {
                    alias: "tile_baked_733_289"
                },
                e.TILE_BAKED_733_290_808 = {
                    alias: "tile_baked_733_290_808"
                },
                e.TILE_BAKED_733_290_809 = {
                    alias: "tile_baked_733_290_809"
                },
                e.TILE_BAKED_733_290 = {
                    alias: "tile_baked_733_290"
                },
                e.TILE_BAKED_733_291_829 = {
                    alias: "tile_baked_733_291_829"
                },
                e.TILE_BAKED_733_292_808 = {
                    alias: "tile_baked_733_292_808"
                },
                e.TILE_BAKED_733_292_809 = {
                    alias: "tile_baked_733_292_809"
                },
                e.TILE_BAKED_733_292_810 = {
                    alias: "tile_baked_733_292_810"
                },
                e.TILE_BAKED_733_292_811 = {
                    alias: "tile_baked_733_292_811"
                },
                e.TILE_BAKED_733_292_813 = {
                    alias: "tile_baked_733_292_813"
                },
                e.TILE_BAKED_733_292_818 = {
                    alias: "tile_baked_733_292_818"
                },
                e.TILE_BAKED_733_292 = {
                    alias: "tile_baked_733_292"
                },
                e.TILE_BAKED_733_300 = {
                    alias: "tile_baked_733_300"
                },
                e.TILE_BAKED_733_302 = {
                    alias: "tile_baked_733_302"
                },
                e.TILE_BAKED_733_303 = {
                    alias: "tile_baked_733_303"
                },
                e.TILE_BAKED_733_326_334 = {
                    alias: "tile_baked_733_326_334"
                },
                e.TILE_BAKED_733_328_339 = {
                    alias: "tile_baked_733_328_339"
                },
                e.TILE_BAKED_733_328_340 = {
                    alias: "tile_baked_733_328_340"
                },
                e.TILE_BAKED_733_328_808 = {
                    alias: "tile_baked_733_328_808"
                },
                e.TILE_BAKED_733_332_300 = {
                    alias: "tile_baked_733_332_300"
                },
                e.TILE_BAKED_733_338_810 = {
                    alias: "tile_baked_733_338_810"
                },
                e.TILE_BAKED_733_360 = {
                    alias: "tile_baked_733_360"
                },
                e.TILE_BAKED_733_361_333 = {
                    alias: "tile_baked_733_361_333"
                },
                e.TILE_BAKED_733_361 = {
                    alias: "tile_baked_733_361"
                },
                e.TILE_BAKED_733_362 = {
                    alias: "tile_baked_733_362"
                },
                e.TILE_BAKED_733_363_829 = {
                    alias: "tile_baked_733_363_829"
                },
                e.TILE_BAKED_733_365_829 = {
                    alias: "tile_baked_733_365_829"
                },
                e.TILE_BAKED_733_365 = {
                    alias: "tile_baked_733_365"
                },
                e.TILE_BAKED_733_367_513 = {
                    alias: "tile_baked_733_367_513"
                },
                e.TILE_BAKED_733_367 = {
                    alias: "tile_baked_733_367"
                },
                e.TILE_BAKED_733_400_411 = {
                    alias: "tile_baked_733_400_411"
                },
                e.TILE_BAKED_733_400_412 = {
                    alias: "tile_baked_733_400_412"
                },
                e.TILE_BAKED_733_404_811 = {
                    alias: "tile_baked_733_404_811"
                },
                e.TILE_BAKED_733_406_811 = {
                    alias: "tile_baked_733_406_811"
                },
                e.TILE_BAKED_733_405_302 = {
                    alias: "tile_baked_733_405_302"
                },
                e.TILE_BAKED_733_410_808 = {
                    alias: "tile_baked_733_410_808"
                },
                e.TILE_BAKED_733_442 = {
                    alias: "tile_baked_733_442"
                },
                e.TILE_BAKED_733_510_363 = {
                    alias: "tile_baked_733_510_363"
                },
                e.TILE_BAKED_733_590_810 = {
                    alias: "tile_baked_733_590_810"
                },
                e.TILE_BAKED_733_590_811 = {
                    alias: "tile_baked_733_590_811"
                },
                e.TILE_BAKED_733_590_815 = {
                    alias: "tile_baked_733_590_815"
                },
                e.TILE_BAKED_733_590 = {
                    alias: "tile_baked_733_590"
                },
                e.TILE_BAKED_733_590_818 = {
                    alias: "tile_baked_733_590_818"
                },
                e.TILE_BAKED_733_600 = {
                    alias: "tile_baked_733_600"
                },
                e.TILE_BAKED_733_603_600 = {
                    alias: "tile_baked_733_603_600"
                },
                e.TILE_BAKED_733_660 = {
                    alias: "tile_baked_733_660"
                },
                e.TILE_BAKED_733_661 = {
                    alias: "tile_baked_733_661"
                },
                e.TILE_BAKED_733_662_816 = {
                    alias: "tile_baked_733_662_816"
                },
                e.TILE_BAKED_733_665_813 = {
                    alias: "tile_baked_733_665_813"
                },
                e.TILE_BAKED_733_665 = {
                    alias: "tile_baked_733_665"
                },
                e.TILE_BAKED_733_667 = {
                    alias: "tile_baked_733_667"
                },
                e.TILE_BAKED_733_735_285_818 = {
                    alias: "tile_baked_733_735_285_818"
                },
                e.TILE_BAKED_733_735_285_819 = {
                    alias: "tile_baked_733_735_285_819"
                },
                e.TILE_BAKED_733_735_285 = {
                    alias: "tile_baked_733_735_285"
                },
                e.TILE_BAKED_733_735_360 = {
                    alias: "tile_baked_733_735_360"
                },
                e.TILE_BAKED_733_735_449_826 = {
                    alias: "tile_baked_733_735_449_826"
                },
                e.TILE_BAKED_733_735_826 = {
                    alias: "tile_baked_733_735_826"
                },
                e.TILE_BAKED_733_736_286_819 = {
                    alias: "tile_baked_733_736_286_819"
                },
                e.TILE_BAKED_733_736_286 = {
                    alias: "tile_baked_733_736_286"
                },
                e.TILE_BAKED_733_736_361 = {
                    alias: "tile_baked_733_736_361"
                },
                e.TILE_BAKED_733_737_287_826 = {
                    alias: "tile_baked_733_737_287_826"
                },
                e.TILE_BAKED_733_737_300_826 = {
                    alias: "tile_baked_733_737_300_826"
                },
                e.TILE_BAKED_733_737_362_826 = {
                    alias: "tile_baked_733_737_362_826"
                },
                e.TILE_BAKED_733_737_376_826 = {
                    alias: "tile_baked_733_737_376_826"
                },
                e.TILE_BAKED_733_737_826 = {
                    alias: "tile_baked_733_737_826"
                },
                e.TILE_BAKED_733_739_439 = {
                    alias: "tile_baked_733_739_439"
                },
                e.TILE_BAKED_733_739 = {
                    alias: "tile_baked_733_739"
                },
                e.TILE_BAKED_733_742_826 = {
                    alias: "tile_baked_733_742_826"
                },
                e.TILE_BAKED_733_744_297_438 = {
                    alias: "tile_baked_733_744_297_438"
                },
                e.TILE_BAKED_733_744_362_660_438_660 = {
                    alias: "tile_baked_733_744_362_660_438_660"
                },
                e.TILE_BAKED_733_745_295_816 = {
                    alias: "tile_baked_733_745_295_816"
                },
                e.TILE_BAKED_733_746_360_436 = {
                    alias: "tile_baked_733_746_360_436"
                },
                e.TILE_BAKED_733_746_360 = {
                    alias: "tile_baked_733_746_360"
                },
                e.TILE_BAKED_733_747_285_810 = {
                    alias: "tile_baked_733_747_285_810"
                },
                e.TILE_BAKED_733_747_285_819 = {
                    alias: "tile_baked_733_747_285_819"
                },
                e.TILE_BAKED_733_747_285_821 = {
                    alias: "tile_baked_733_747_285_821"
                },
                e.TILE_BAKED_733_747_285_826 = {
                    alias: "tile_baked_733_747_285_826"
                },
                e.TILE_BAKED_733_747_285 = {
                    alias: "tile_baked_733_747_285"
                },
                e.TILE_BAKED_733_747_287_585 = {
                    alias: "tile_baked_733_747_287_585"
                },
                e.TILE_BAKED_733_747_287_826 = {
                    alias: "tile_baked_733_747_287_826"
                },
                e.TILE_BAKED_733_747_287 = {
                    alias: "tile_baked_733_747_287"
                },
                e.TILE_BAKED_733_747_297_285 = {
                    alias: "tile_baked_733_747_297_285"
                },
                e.TILE_BAKED_733_747_297_820 = {
                    alias: "tile_baked_733_747_297_820"
                },
                e.TILE_BAKED_733_747_297_483 = {
                    alias: "tile_baked_733_747_297_483"
                },
                e.TILE_BAKED_733_747_297_826 = {
                    alias: "tile_baked_733_747_297_826"
                },
                e.TILE_BAKED_733_747_297 = {
                    alias: "tile_baked_733_747_297"
                },
                e.TILE_BAKED_733_747_299_435_826 = {
                    alias: "tile_baked_733_747_299_435_826"
                },
                e.TILE_BAKED_733_747_300 = {
                    alias: "tile_baked_733_747_300"
                },
                e.TILE_BAKED_733_747_302_826 = {
                    alias: "tile_baked_733_747_302_826"
                },
                e.TILE_BAKED_733_747_302 = {
                    alias: "tile_baked_733_747_302"
                },
                e.TILE_BAKED_733_747_360_826 = {
                    alias: "tile_baked_733_747_360_826"
                },
                e.TILE_BAKED_733_747_360 = {
                    alias: "tile_baked_733_747_360"
                },
                e.TILE_BAKED_733_747_362_285 = {
                    alias: "tile_baked_733_747_362_285"
                },
                e.TILE_BAKED_733_747_362_435_826 = {
                    alias: "tile_baked_733_747_362_435_826"
                },
                e.TILE_BAKED_733_747_362_299 = {
                    alias: "tile_baked_733_747_362_299"
                },
                e.TILE_BAKED_733_747_362_660_436 = {
                    alias: "tile_baked_733_747_362_660_436"
                },
                e.TILE_BAKED_733_747_362_660_819 = {
                    alias: "tile_baked_733_747_362_660_819"
                },
                e.TILE_BAKED_733_747_362_660 = {
                    alias: "tile_baked_733_747_362_660"
                },
                e.TILE_BAKED_733_747_362_826 = {
                    alias: "tile_baked_733_747_362_826"
                },
                e.TILE_BAKED_733_747_372_436_820 = {
                    alias: "tile_baked_733_747_372_436_820"
                },
                e.TILE_BAKED_733_747_372_556 = {
                    alias: "tile_baked_733_747_372_556"
                },
                e.TILE_BAKED_733_747_372_816 = {
                    alias: "tile_baked_733_747_372_816"
                },
                e.TILE_BAKED_733_747_372_819 = {
                    alias: "tile_baked_733_747_372_819"
                },
                e.TILE_BAKED_733_747_372_820 = {
                    alias: "tile_baked_733_747_372_820"
                },
                e.TILE_BAKED_733_747_372_826 = {
                    alias: "tile_baked_733_747_372_826"
                },
                e.TILE_BAKED_733_747_372 = {
                    alias: "tile_baked_733_747_372"
                },
                e.TILE_BAKED_733_747_587 = {
                    alias: "tile_baked_733_747_587"
                },
                e.TILE_BAKED_733_747_600 = {
                    alias: "tile_baked_733_747_600"
                },
                e.TILE_BAKED_733_747 = {
                    alias: "tile_baked_733_747"
                },
                e.TILE_BAKED_733_748_286_588_437 = {
                    alias: "tile_baked_733_748_286_588_437"
                },
                e.TILE_BAKED_733_748_286_588 = {
                    alias: "tile_baked_733_748_286_588"
                },
                e.TILE_BAKED_733_748_286_663_435 = {
                    alias: "tile_baked_733_748_286_663_435"
                },
                e.TILE_BAKED_733_748_286_663 = {
                    alias: "tile_baked_733_748_286_663"
                },
                e.TILE_BAKED_733_748_288_811 = {
                    alias: "tile_baked_733_748_288_811"
                },
                e.TILE_BAKED_733_748_286 = {
                    alias: "tile_baked_733_748_286"
                },
                e.TILE_BAKED_733_748_288 = {
                    alias: "tile_baked_733_748_288"
                },
                e.TILE_BAKED_733_748_298_2147484469 = {
                    alias: "tile_baked_733_748_298_2147484469"
                },
                e.TILE_BAKED_733_748_298_288 = {
                    alias: "tile_baked_733_748_298_288"
                },
                e.TILE_BAKED_733_748_298_809 = {
                    alias: "tile_baked_733_748_298_809"
                },
                e.TILE_BAKED_733_748_298_816 = {
                    alias: "tile_baked_733_748_298_816"
                },
                e.TILE_BAKED_733_748_298_817 = {
                    alias: "tile_baked_733_748_298_817"
                },
                e.TILE_BAKED_733_748_300_489 = {
                    alias: "tile_baked_733_748_300_489"
                },
                e.TILE_BAKED_733_748_298 = {
                    alias: "tile_baked_733_748_298"
                },
                e.TILE_BAKED_733_748_300 = {
                    alias: "tile_baked_733_748_300"
                },
                e.TILE_BAKED_733_748_300_601 = {
                    alias: "tile_baked_733_748_300_601"
                },
                e.TILE_BAKED_733_748_314 = {
                    alias: "tile_baked_733_748_314"
                },
                e.TILE_BAKED_733_748_302 = {
                    alias: "tile_baked_733_748_302"
                },
                e.TILE_BAKED_733_748_361_601 = {
                    alias: "tile_baked_733_748_361_601"
                },
                e.TILE_BAKED_733_748_361_663_818 = {
                    alias: "tile_baked_733_748_361_663_818"
                },
                e.TILE_BAKED_733_748_361_663_819 = {
                    alias: "tile_baked_733_748_361_663_819"
                },
                e.TILE_BAKED_733_748_361_663 = {
                    alias: "tile_baked_733_748_361_663"
                },
                e.TILE_BAKED_733_748_363_299 = {
                    alias: "tile_baked_733_748_363_299"
                },
                e.TILE_BAKED_733_748_363_303 = {
                    alias: "tile_baked_733_748_363_303"
                },
                e.TILE_BAKED_733_748_363_813 = {
                    alias: "tile_baked_733_748_363_813"
                },
                e.TILE_BAKED_733_748_373_810 = {
                    alias: "tile_baked_733_748_373_810"
                },
                e.TILE_BAKED_733_748_373 = {
                    alias: "tile_baked_733_748_373"
                },
                e.TILE_BAKED_733_748_600 = {
                    alias: "tile_baked_733_748_600"
                },
                e.TILE_BAKED_733_748_661 = {
                    alias: "tile_baked_733_748_661"
                },
                e.TILE_BAKED_733_748_663 = {
                    alias: "tile_baked_733_748_663"
                },
                e.TILE_BAKED_733_749_303 = {
                    alias: "tile_baked_733_749_303"
                },
                e.TILE_BAKED_733_748 = {
                    alias: "tile_baked_733_748"
                },
                e.TILE_BAKED_733_756_306 = {
                    alias: "tile_baked_733_756_306"
                },
                e.TILE_BAKED_733_753_375_599 = {
                    alias: "tile_baked_733_753_375_599"
                },
                e.TILE_BAKED_733_763_363 = {
                    alias: "tile_baked_733_763_363"
                },
                e.TILE_BAKED_733_764_378_588 = {
                    alias: "tile_baked_733_764_378_588"
                },
                e.TILE_BAKED_733_766_287_599 = {
                    alias: "tile_baked_733_766_287_599"
                },
                e.TILE_BAKED_733_767_287_826 = {
                    alias: "tile_baked_733_767_287_826"
                },
                e.TILE_BAKED_733_768_287 = {
                    alias: "tile_baked_733_768_287"
                },
                e.TILE_BAKED_733_768_299 = {
                    alias: "tile_baked_733_768_299"
                },
                e.TILE_BAKED_733_768_362_299 = {
                    alias: "tile_baked_733_768_362_299"
                },
                e.TILE_BAKED_733_769_286_602_376 = {
                    alias: "tile_baked_733_769_286_602_376"
                },
                e.TILE_BAKED_733_768_362_826 = {
                    alias: "tile_baked_733_768_362_826"
                },
                e.TILE_BAKED_733_769_586 = {
                    alias: "tile_baked_733_769_586"
                },
                e.TILE_BAKED_733_770_361_601_819 = {
                    alias: "tile_baked_733_770_361_601_819"
                },
                e.TILE_BAKED_733_770_361_601 = {
                    alias: "tile_baked_733_770_361_601"
                },
                e.TILE_BAKED_733_771_286_602_376 = {
                    alias: "tile_baked_733_771_286_602_376"
                },
                e.TILE_BAKED_733_775_625_816 = {
                    alias: "tile_baked_733_775_625_816"
                },
                e.TILE_BAKED_733_776_326 = {
                    alias: "tile_baked_733_776_326"
                },
                e.TILE_BAKED_733_776_429_377 = {
                    alias: "tile_baked_733_776_429_377"
                },
                e.TILE_BAKED_733_778_402_328 = {
                    alias: "tile_baked_733_778_402_328"
                },
                e.TILE_BAKED_733_778_703 = {
                    alias: "tile_baked_733_778_703"
                },
                e.TILE_BAKED_733_779_812 = {
                    alias: "tile_baked_733_779_812"
                },
                e.TILE_BAKED_733_782_407_824 = {
                    alias: "tile_baked_733_782_407_824"
                },
                e.TILE_BAKED_733_782 = {
                    alias: "tile_baked_733_782"
                },
                e.TILE_BAKED_733_785_335_823 = {
                    alias: "tile_baked_733_785_335_823"
                },
                e.TILE_BAKED_733_788_413_822 = {
                    alias: "tile_baked_733_788_413_822"
                },
                e.TILE_BAKED_733_788 = {
                    alias: "tile_baked_733_788"
                },
                e.TILE_BAKED_733_791_416 = {
                    alias: "tile_baked_733_791_416"
                },
                e.TILE_BAKED_733_792_362_819 = {
                    alias: "tile_baked_733_792_362_819"
                },
                e.TILE_BAKED_733_793_336_585 = {
                    alias: "tile_baked_733_793_336_585"
                },
                e.TILE_BAKED_733_794_414_660 = {
                    alias: "tile_baked_733_794_414_660"
                },
                e.TILE_BAKED_733_795 = {
                    alias: "tile_baked_733_795"
                },
                e.TILE_BAKED_733_796_415_663 = {
                    alias: "tile_baked_733_796_415_663"
                },
                e.TILE_BAKED_733_797_422 = {
                    alias: "tile_baked_733_797_422"
                },
                e.TILE_BAKED_733_799_364_301 = {
                    alias: "tile_baked_733_799_364_301"
                },
                e.TILE_BAKED_733_799_364_674_301 = {
                    alias: "tile_baked_733_799_364_674_301"
                },
                e.TILE_BAKED_733_803_289_819 = {
                    alias: "tile_baked_733_803_289_819"
                },
                e.TILE_BAKED_733_803_289 = {
                    alias: "tile_baked_733_803_289"
                },
                e.TILE_BAKED_733_803_353 = {
                    alias: "tile_baked_733_803_353"
                },
                e.TILE_BAKED_733_804 = {
                    alias: "tile_baked_733_804"
                },
                e.TILE_BAKED_733_805_291_811 = {
                    alias: "tile_baked_733_805_291_811"
                },
                e.TILE_BAKED_733_805_366 = {
                    alias: "tile_baked_733_805_366"
                },
                e.TILE_BAKED_733_805_402_299 = {
                    alias: "tile_baked_733_805_402_299"
                },
                e.TILE_BAKED_733_806_375 = {
                    alias: "tile_baked_733_806_375"
                },
                e.TILE_BAKED_733_811 = {
                    alias: "tile_baked_733_811"
                },
                e.TILE_BAKED_733 = {
                    alias: "tile_baked_733"
                },
                e.TILE_BAKED_734_794 = {
                    alias: "tile_baked_734_794"
                },
                e.TILE_BAKED_734 = {
                    alias: "tile_baked_734"
                },
                e.TILE_BAKED_737 = {
                    alias: "tile_baked_737"
                },
                e.TILE_BAKED_738 = {
                    alias: "tile_baked_738"
                },
                e.TILE_BAKED_739_439 = {
                    alias: "tile_baked_739_439"
                },
                e.TILE_BAKED_740_365_290 = {
                    alias: "tile_baked_740_365_290"
                },
                e.TILE_BAKED_740_794 = {
                    alias: "tile_baked_740_794"
                },
                e.TILE_BAKED_741_366 = {
                    alias: "tile_baked_741_366"
                },
                e.TILE_BAKED_747_285_360_816 = {
                    alias: "tile_baked_747_285_360_816"
                },
                e.TILE_BAKED_747_285_360_818 = {
                    alias: "tile_baked_747_285_360_818"
                },
                e.TILE_BAKED_747_285_360_819 = {
                    alias: "tile_baked_747_285_360_819"
                },
                e.TILE_BAKED_747_285_360_820 = {
                    alias: "tile_baked_747_285_360_820"
                },
                e.TILE_BAKED_747_285_360 = {
                    alias: "tile_baked_747_285_360"
                },
                e.TILE_BAKED_747_362_435_287 = {
                    alias: "tile_baked_747_362_435_287"
                },
                e.TILE_BAKED_747_362_660_816 = {
                    alias: "tile_baked_747_362_660_816"
                },
                e.TILE_BAKED_747_362_660_818 = {
                    alias: "tile_baked_747_362_660_818"
                },
                e.TILE_BAKED_747_362_660_819 = {
                    alias: "tile_baked_747_362_660_819"
                },
                e.TILE_BAKED_747_362_660_820 = {
                    alias: "tile_baked_747_362_660_820"
                },
                e.TILE_BAKED_747_362_660 = {
                    alias: "tile_baked_747_362_660"
                },
                e.TILE_BAKED_747_435_287 = {
                    alias: "tile_baked_747_435_287"
                },
                e.TILE_BAKED_747_435 = {
                    alias: "tile_baked_747_435"
                },
                e.TILE_BAKED_747_437_435 = {
                    alias: "tile_baked_747_437_435"
                },
                e.TILE_BAKED_747_662_819 = {
                    alias: "tile_baked_747_662_819"
                },
                e.TILE_BAKED_747 = {
                    alias: "tile_baked_747"
                },
                e.TILE_BAKED_748_286_663_816 = {
                    alias: "tile_baked_748_286_663_816"
                },
                e.TILE_BAKED_748_286_663_817 = {
                    alias: "tile_baked_748_286_663_817"
                },
                e.TILE_BAKED_748_286_663_819 = {
                    alias: "tile_baked_748_286_663_819"
                },
                e.TILE_BAKED_748_286_663 = {
                    alias: "tile_baked_748_286_663"
                },
                e.TILE_BAKED_748_288_811_361 = {
                    alias: "tile_baked_748_288_811_361"
                },
                e.TILE_BAKED_748_288 = {
                    alias: "tile_baked_748_288"
                },
                e.TILE_BAKED_748_298_490 = {
                    alias: "tile_baked_748_298_490"
                },
                e.TILE_BAKED_748_298_511_288 = {
                    alias: "tile_baked_748_298_511_288"
                },
                e.TILE_BAKED_748_303_663 = {
                    alias: "tile_baked_748_303_663"
                },
                e.TILE_BAKED_748_314_817 = {
                    alias: "tile_baked_748_314_817"
                },
                e.TILE_BAKED_748_363_436 = {
                    alias: "tile_baked_748_363_436"
                },
                e.TILE_BAKED_748_363_661_816 = {
                    alias: "tile_baked_748_363_661_816"
                },
                e.TILE_BAKED_748_363_661_817 = {
                    alias: "tile_baked_748_363_661_817"
                },
                e.TILE_BAKED_748_363_661_818 = {
                    alias: "tile_baked_748_363_661_818"
                },
                e.TILE_BAKED_748_363_661_819 = {
                    alias: "tile_baked_748_363_661_819"
                },
                e.TILE_BAKED_748_363_661 = {
                    alias: "tile_baked_748_363_661"
                },
                e.TILE_BAKED_748_373_298 = {
                    alias: "tile_baked_748_373_298"
                },
                e.TILE_BAKED_748_436 = {
                    alias: "tile_baked_748_436"
                },
                e.TILE_BAKED_748_438_436 = {
                    alias: "tile_baked_748_438_436"
                },
                e.TILE_BAKED_748_438 = {
                    alias: "tile_baked_748_438"
                },
                e.TILE_BAKED_748_511 = {
                    alias: "tile_baked_748_511"
                },
                e.TILE_BAKED_748 = {
                    alias: "tile_baked_748"
                },
                e.TILE_BAKED_763_438 = {
                    alias: "tile_baked_763_438"
                },
                e.TILE_BAKED_763_663_818 = {
                    alias: "tile_baked_763_663_818"
                },
                e.TILE_BAKED_767 = {
                    alias: "tile_baked_767"
                },
                e.TILE_BAKED_772_435 = {
                    alias: "tile_baked_772_435"
                },
                e.TILE_BAKED_773 = {
                    alias: "tile_baked_773"
                },
                e.TILE_BAKED_795 = {
                    alias: "tile_baked_795"
                },
                e.TILE_BAKED_799_289_435 = {
                    alias: "tile_baked_799_289_435"
                },
                e.TILE_BAKED_799_664 = {
                    alias: "tile_baked_799_664"
                },
                e.TILE_BAKED_802 = {
                    alias: "tile_baked_802"
                },
                e.TILE_DECAL_TRAINTRACK_STOP = {
                    alias: "tile_decal_traintrack_stop"
                },
                e.TILE_BAKED_433_290 = {
                    alias: "tile_baked_433_290"
                },
                e.TILE_BAKED_433_363 = {
                    alias: "tile_baked_433_363"
                },
                e.TILE_BAKED_433_300 = {
                    alias: "tile_baked_433_300"
                },
                e.TILE_BAKED_433_361 = {
                    alias: "tile_baked_433_361"
                },
                e.TILE_BAKED_433_287 = {
                    alias: "tile_baked_433_287"
                },
                e.TILE_BAKED_433_374 = {
                    alias: "tile_baked_433_374"
                },
                e.TILE_BAKED_433_431 = {
                    alias: "tile_baked_433_431"
                },
                e.TILE_BAKED_433_360 = {
                    alias: "tile_baked_433_360"
                },
                e.TILE_BAKED_433_369 = {
                    alias: "tile_baked_433_369"
                },
                e.TILE_BAKED_433_747_447 = {
                    alias: "tile_baked_433_747_447"
                },
                e.TILE_BAKED_433_733 = {
                    alias: "tile_baked_433_733"
                },
                e.TILE_BAKED_433_433 = {
                    alias: "tile_baked_433_433"
                },
                e.TILE_BAKED_433_747_510 = {
                    alias: "tile_baked_433_747_510"
                },
                e.TILE_BAKED_433_375_812 = {
                    alias: "tile_baked_433_375_812"
                },
                e.TILE_BAKED_433_375 = {
                    alias: "tile_baked_433_375"
                },
                e.TILE_BAKED_433_401 = {
                    alias: "tile_baked_433_401"
                },
                e.TILE_BAKED_433_748_448 = {
                    alias: "tile_baked_433_748_448"
                },
                e.TILE_BAKED_433_799_439 = {
                    alias: "tile_baked_433_799_439"
                },
                e.TILE_BAKED_433_801_441 = {
                    alias: "tile_baked_433_801_441"
                },
                e.TILE_BAKED_433_809 = {
                    alias: "tile_baked_433_809"
                },
                e.TILE_BAKED_433_808 = {
                    alias: "tile_baked_433_808"
                },
                e.TILE_BAKED_433_802_442 = {
                    alias: "tile_baked_433_802_442"
                },
                e.TILE_BAKED_433_812 = {
                    alias: "tile_baked_433_812"
                },
                e.TILE_BAKED_433_813 = {
                    alias: "tile_baked_433_813"
                },
                e.TILE_BAKED_433_811 = {
                    alias: "tile_baked_433_811"
                },
                e.TILE_BAKED_433_810 = {
                    alias: "tile_baked_433_810"
                },
                e.TILE_BAKED_433 = {
                    alias: "tile_baked_433"
                },
                e.TILE_BAKED_476_328 = {
                    alias: "tile_baked_476_328"
                },
                e.TILE_BAKED_433_815 = {
                    alias: "tile_baked_433_815"
                },
                e.TILE_BAKED_476_329 = {
                    alias: "tile_baked_476_329"
                },
                e.TILE_BAKED_476_330 = {
                    alias: "tile_baked_476_330"
                },
                e.TILE_BAKED_476_333 = {
                    alias: "tile_baked_476_333"
                },
                e.TILE_BAKED_476_331 = {
                    alias: "tile_baked_476_331"
                },
                e.TILE_BAKED_433_588 = {
                    alias: "tile_baked_433_588"
                },
                e.TILE_BAKED_476_335_784 = {
                    alias: "tile_baked_476_335_784"
                },
                e.TILE_BAKED_476_335 = {
                    alias: "tile_baked_476_335"
                },
                e.TILE_BAKED_476_776 = {
                    alias: "tile_baked_476_776"
                },
                e.TILE_BAKED_476_777 = {
                    alias: "tile_baked_476_777"
                },
                e.TILE_BAKED_476_778 = {
                    alias: "tile_baked_476_778"
                },
                e.TILE_BAKED_476_779 = {
                    alias: "tile_baked_476_779"
                },
                e.TILE_BAKED_476_781 = {
                    alias: "tile_baked_476_781"
                },
                e.TILE_BAKED_476_332 = {
                    alias: "tile_baked_476_332"
                },
                e.TILE_BAKED_476_784 = {
                    alias: "tile_baked_476_784"
                },
                e.TILE_BAKED_476_785 = {
                    alias: "tile_baked_476_785"
                },
                e.TILE_BAKED_476_786 = {
                    alias: "tile_baked_476_786"
                },
                e.TILE_BAKED_476_795 = {
                    alias: "tile_baked_476_795"
                },
                e.TILE_BAKED_476 = {
                    alias: "tile_baked_476"
                },
                e.TILE_BAKED_508_300_810 = {
                    alias: "tile_baked_508_300_810"
                },
                e.TILE_BAKED_508_300 = {
                    alias: "tile_baked_508_300"
                },
                e.TILE_BAKED_508_377 = {
                    alias: "tile_baked_508_377"
                },
                e.TILE_BAKED_433_747 = {
                    alias: "tile_baked_433_747"
                },
                e.TILE_BAKED_508_401 = {
                    alias: "tile_baked_508_401"
                },
                e.TILE_BAKED_508_702 = {
                    alias: "tile_baked_508_702"
                },
                e.TILE_BAKED_508_703 = {
                    alias: "tile_baked_508_703"
                },
                e.TILE_BAKED_508_748_288_436 = {
                    alias: "tile_baked_508_748_288_436"
                },
                e.TILE_BAKED_508_763_288 = {
                    alias: "tile_baked_508_763_288"
                },
                e.TILE_BAKED_508_769_511 = {
                    alias: "tile_baked_508_769_511"
                },
                e.TILE_BAKED_508_800_362_436_302_489 = {
                    alias: "tile_baked_508_800_362_436_302_489"
                },
                e.TILE_BAKED_508_809 = {
                    alias: "tile_baked_508_809"
                },
                e.TILE_BAKED_476_334_779 = {
                    alias: "tile_baked_476_334_779"
                },
                e.TILE_BAKED_508 = {
                    alias: "tile_baked_508"
                },
                e.TILE_BAKED_508_816 = {
                    alias: "tile_baked_508_816"
                },
                e.TILE_BAKED_508_400 = {
                    alias: "tile_baked_508_400"
                },
                e.TILE_BAKED_476_782 = {
                    alias: "tile_baked_476_782"
                },
                e.TILE_BAKED_508_811 = {
                    alias: "tile_baked_508_811"
                },
                e.TILE_BAKED_476_334 = {
                    alias: "tile_baked_476_334"
                },
                e.OBJ_ANIMAL_SHEEP_00 = {
                    alias: "obj_animal_sheep_00"
                },
                e.ICON_EVENT_GOLDENPUMPKIN = {
                    alias: "icon_event_goldenpumpkin"
                },
                e.OBJ_ANIMAL_PIG_00 = {
                    alias: "obj_animal_pig_00"
                },
                e.OBJ_DELIVERY_CRATES = {
                    alias: "obj_delivery_crates"
                },
                e.OBJ_NATURE_BRICKPILE_00 = {
                    alias: "obj_nature_brickpile_00"
                },
                e.OBJ_VALUABLES_COINS_05 = {
                    alias: "obj_valuables_coins_05"
                },
                e.OBJ_NATURE_WOOD_PILE_04 = {
                    alias: "obj_nature_wood_pile_04"
                },
                e.OBJ_ANIMAL_SHEEP_02 = {
                    alias: "obj_animal_sheep_02"
                },
                e.OBJ_NATURE_BRICKPILE_01 = {
                    alias: "obj_nature_brickpile_01"
                },
                e.OBJ_NATURE_WOOD_PILE_01 = {
                    alias: "obj_nature_wood_pile_01"
                },
                e.OBJ_NATURE_WOOD_PILE_05 = {
                    alias: "obj_nature_wood_pile_05"
                },
                e.ICON_LOOTCRATE_GOLDENPUMPKIN = {
                    alias: "icon_lootcrate_GoldenPumpkin"
                },
                e.OBJ_HEAVY_TRACTORWHEEL = {
                    alias: "obj_heavy_tractorwheel"
                },
                e.BG_MARKETPLACE_CRATES01 = {
                    alias: "bg_marketplace_crates01"
                },
                e.BG_MARKETPLACE_CRATES02 = {
                    alias: "bg_marketplace_crates02"
                },
                e.BG_MARKETPLACE_CRATES03 = {
                    alias: "bg_marketplace_crates03"
                },
                e.BG_MARKETPLACE_CRATES04 = {
                    alias: "bg_marketplace_crates04"
                },
                e.BG_MARKETPLACE_ENERGY01 = {
                    alias: "bg_marketplace_energy01"
                },
                e.BG_MARKETPLACE_ENERGY02 = {
                    alias: "bg_marketplace_energy02"
                },
                e.BG_MARKETPLACE_ENERGY03 = {
                    alias: "bg_marketplace_energy03"
                },
                e.BG_MARKETPLACE_ENERGY04 = {
                    alias: "bg_marketplace_energy04"
                },
                e.BG_MARKETPLACE_GEMS01 = {
                    alias: "bg_marketplace_gems01"
                },
                e.BG_MARKETPLACE_GEMS02 = {
                    alias: "bg_marketplace_gems02"
                },
                e.BG_MARKETPLACE_GEMS03 = {
                    alias: "bg_marketplace_gems03"
                },
                e.BG_MARKETPLACE_GEMS04 = {
                    alias: "bg_marketplace_gems04"
                },
                e.ICON_TAB_CHRISTMAS = {
                    alias: "icon_tab_christmas"
                },
                e.ICON_TAB_HALLOWEEN = {
                    alias: "icon_tab_halloween"
                },
                e.UI_BTN_PRICE_LINE = {
                    alias: "ui_btn_price_line"
                },
                e.BG_MARKETPLACE_HALLOWEEN01 = {
                    alias: "bg_marketplace_halloween01"
                },
                e.BG_MARKETPLACE_HALLOWEEN02 = {
                    alias: "bg_marketplace_halloween02"
                },
                e.BG_MARKETPLACE_HALLOWEEN03 = {
                    alias: "bg_marketplace_halloween03"
                },
                e.BG_MARKETPLACE_CHRISTMAS01 = {
                    alias: "bg_marketplace_christmas01"
                },
                e.BG_MARKETPLACE_HALLOWEEN04 = {
                    alias: "bg_marketplace_halloween04"
                },
                e.BG_MARKETPLACE_CHRISTMAS04 = {
                    alias: "bg_marketplace_christmas04"
                },
                e.BG_MARKETPLACE_CHRISTMAS02 = {
                    alias: "bg_marketplace_christmas02"
                },
                e.BG_MARKETPLACE_CHRISTMAS03 = {
                    alias: "bg_marketplace_christmas03"
                },
                e.ARROW_HANDDIRECTION_DIAGONAL = {
                    alias: "arrow_handdirection_diagonal"
                },
                e.ARROW_HANDDIRECTION_VERTICAL = {
                    alias: "arrow_handdirection_vertical"
                },
                e.ICON_CHARACTER_NPC_1 = {
                    alias: "icon_character_npc_1"
                },
                e.ICON_CHARACTER_NPC_2 = {
                    alias: "icon_character_npc_2"
                },
                e.HAND_ONBOARDING = {
                    alias: "hand_onboarding"
                },
                e.ICON_CHARACTERS_ONBOARDING03 = {
                    alias: "icon_characters_onboarding03"
                },
                e.ICON_CHARACTERS_ONBOARDING04 = {
                    alias: "icon_characters_onboarding04"
                },
                e.ICON_CHARACTERS_ONBOARDING05 = {
                    alias: "icon_characters_onboarding05"
                },
                e.ICON_CHARACTERS_ONBOARDING06 = {
                    alias: "icon_characters_onboarding06"
                },
                e.ICON_POPUP_CHESTS_AND_KEYS_EXPLANATION = {
                    alias: "icon_popup_chests_and_keys_explanation"
                },
                e.ICON_POPUP_DECORATION_EXPLANATION = {
                    alias: "icon_popup_decoration_explanation"
                },
                e.ICON_POPUP_MERGE_EXPLANATION = {
                    alias: "icon_popup_merge_explanation"
                },
                e.ICON_POPUP_REGENERATION_EXPLANATION = {
                    alias: "icon_popup_regeneration_explanation"
                },
                e.ICON_POPUP_UPGRADECARDS_EXPLANATION = {
                    alias: "icon_popup_upgradecards_explanation"
                },
                e.ICON_POPUP_FLOWERS_EXPLANATION = {
                    alias: "icon_popup_flowers_explanation"
                },
                e.ICON_CHARACTERS_ONBOARDING02 = {
                    alias: "icon_characters_onboarding02"
                },
                e.ICON_CHARACTERS_ONBOARDING01 = {
                    alias: "icon_characters_onboarding01"
                },
                e.FINGER_DOWN = {
                    alias: "finger_down"
                },
                e.ICON_ORDERS_REWARD_COINS0 = {
                    alias: "icon_orders_reward_coins0"
                },
                e.ICON_ORDERS_REWARD_COINS2 = {
                    alias: "icon_orders_reward_coins2"
                },
                e.ICON_ORDERS_REWARD_COINS4 = {
                    alias: "icon_orders_reward_coins4"
                },
                e.ICON_ORDERS_REWARD_COINS5 = {
                    alias: "icon_orders_reward_coins5"
                },
                e.ICON_ORDERS_REWARD_COINS6 = {
                    alias: "icon_orders_reward_coins6"
                },
                e.ICON_ORDERS_REWARD_COINS7 = {
                    alias: "icon_orders_reward_coins7"
                },
                e.ICON_ORDERS_REWARDS_GEMS0 = {
                    alias: "icon_orders_rewards_gems0"
                },
                e.ICON_ORDERS_REWARDS_GEMS1 = {
                    alias: "icon_orders_rewards_gems1"
                },
                e.ICON_ORDERS_REWARDS_GEMS2 = {
                    alias: "icon_orders_rewards_gems2"
                },
                e.ICON_ORDERS_REWARDS_GEMS4 = {
                    alias: "icon_orders_rewards_gems4"
                },
                e.ICON_ORDERS_REWARDS_GEMS3 = {
                    alias: "icon_orders_rewards_gems3"
                },
                e.ICON_ORDERS_REWARDS_GEMS5 = {
                    alias: "icon_orders_rewards_gems5"
                },
                e.ICON_POPUP_HEADER_ORDERS = {
                    alias: "icon_popup_header_orders"
                },
                e.ICON_ORDERS_REWARD_COINS3 = {
                    alias: "icon_orders_reward_coins3"
                },
                e.ICON_ORDERS_REWARD_COINS1 = {
                    alias: "icon_orders_reward_coins1"
                },
                e.DUST_PINK_01 = {
                    alias: "dust_pink_01"
                },
                e.DUST_PINK_02 = {
                    alias: "dust_pink_02"
                },
                e.DUST_PINK_03 = {
                    alias: "dust_pink_03"
                },
                e.DUST_PINK_04 = {
                    alias: "dust_pink_04"
                },
                e.ICON_PREMIUMLAND_HEADER = {
                    alias: "icon_premiumland_header"
                },
                e.ICON_PREMIUMLAND_PROMOPIC = {
                    alias: "icon_premiumland_promopic"
                },
                e.ICON_PREMIUMLAND_SPECIALOFFER_RAYS = {
                    alias: "icon_premiumland_specialoffer_rays"
                },
                e.ICON_PREMIUMLAND_SPECIALOFFER = {
                    alias: "icon_premiumland_specialoffer"
                },
                e.RAIN_SPATTER_01 = {
                    alias: "rain_spatter_01"
                },
                e.RAIN_SPATTER_02 = {
                    alias: "rain_spatter_02"
                },
                e.RAIN_SPATTER_03 = {
                    alias: "rain_spatter_03"
                },
                e.RAIN_SPATTER_TRAIN01 = {
                    alias: "rain_spatter_train01"
                },
                e.RAIN_SPATTER_TRAIN02 = {
                    alias: "rain_spatter_train02"
                },
                e.RAIN_SPATTER_TRAIN03 = {
                    alias: "rain_spatter_train03"
                },
                e.RAIN_STREAKS01 = {
                    alias: "rain_streaks01"
                },
                e.RAIN_STREAKS02 = {
                    alias: "rain_streaks02"
                },
                e.RAIN_STREAKS03 = {
                    alias: "rain_streaks03"
                },
                e.ICON_REPAIRBUILDING_AVOCADOFIESTA_BROKEN = {
                    alias: "icon_repairbuilding_avocadofiesta_broken"
                },
                e.ICON_REPAIRBUILDING_AVOCADOFIESTA_REPAIRED = {
                    alias: "icon_repairbuilding_avocadofiesta_repaired"
                },
                e.REPAIR_BAKERY_BROKEN = {
                    alias: "repair_bakery_broken"
                },
                e.REPAIR_BAKERY = {
                    alias: "repair_bakery"
                },
                e.REPAIR_BARISTA_BROKEN = {
                    alias: "repair_barista_broken"
                },
                e.REPAIR_BARISTA = {
                    alias: "repair_barista"
                },
                e.REPAIR_BBQ_BROKEN = {
                    alias: "repair_BBQ_broken"
                },
                e.REPAIR_BBQ = {
                    alias: "repair_BBQ"
                },
                e.REPAIR_DAIRYFACTORY_BROKEN = {
                    alias: "repair_dairyfactory_broken"
                },
                e.REPAIR_DAIRYFACTORY = {
                    alias: "repair_dairyfactory"
                },
                e.OBJ_DECORATEIVE_BARN_UNLOCK = {
                    alias: "obj_decorateive_barn_unlock"
                },
                e.OBJ_DECORATEIVE_BIRDSHOUSE_REPAIR = {
                    alias: "obj_decorateive_birdshouse_repair"
                },
                e.OBJ_DECORATEIVE_CHICKENCOOP_REPAIR = {
                    alias: "obj_decorateive_chickencoop_repair"
                },
                e.OBJ_DECORATEIVE_CHICKENCOOP_UNLOCK = {
                    alias: "obj_decorateive_chickencoop_unlock"
                },
                e.OBJ_DECORATEIVE_BIRDSHOUSE_UNLOCK = {
                    alias: "obj_decorateive_birdshouse_unlock"
                },
                e.OBJ_DECORATEIVE_DOGHOUSE_UNLOCK = {
                    alias: "obj_decorateive_doghouse_unlock"
                },
                e.OBJ_DECORATEIVE_DOGHOUSE_REPAIR = {
                    alias: "obj_decorateive_doghouse_repair"
                },
                e.OBJ_DECORATEIVE_FEEDINGTROUGH_REPAIR = {
                    alias: "obj_decorateive_feedingtrough_repair"
                },
                e.OBJ_DECORATEIVE_FEEDINGTROUGH_UNLOCK = {
                    alias: "obj_decorateive_feedingtrough_unlock"
                },
                e.OBJ_DECORATEIVE_FLOWERPOTS_REPAIR = {
                    alias: "obj_decorateive_flowerpots_repair"
                },
                e.OBJ_DECORATEIVE_FLOWERPOTS_UNLOCK = {
                    alias: "obj_decorateive_flowerpots_unlock"
                },
                e.OBJ_DECORATEIVE_FOUNTAIN_REPAIR = {
                    alias: "obj_decorateive_fountain_repair"
                },
                e.OBJ_DECORATEIVE_FOUNTAIN_UNLOCK = {
                    alias: "obj_decorateive_fountain_unlock"
                },
                e.OBJ_DECORATEIVE_HAYWAGON_REPAIR = {
                    alias: "obj_decorateive_haywagon_repair"
                },
                e.OBJ_DECORATEIVE_HAYWAGON_UNLOCK = {
                    alias: "obj_decorateive_haywagon_unlock"
                },
                e.OBJ_DECORATEIVE_LAMP_POST_REPAIR = {
                    alias: "obj_decorateive_lamp_post_repair"
                },
                e.OBJ_DECORATEIVE_LAMP_POST_UNLOCK = {
                    alias: "obj_decorateive_lamp_post_unlock"
                },
                e.OBJ_DECORATEIVE_MILKTANK_REPAIR = {
                    alias: "obj_decorateive_milktank_repair"
                },
                e.OBJ_DECORATEIVE_MILKTANK_UNLOCK = {
                    alias: "obj_decorateive_milktank_unlock"
                },
                e.OBJ_DECORATEIVE_PICKNICKTABLE_REPAIR = {
                    alias: "obj_decorateive_picknicktable_repair"
                },
                e.OBJ_DECORATEIVE_PICKNICKTABLE_UNLOCK = {
                    alias: "obj_decorateive_picknicktable_unlock"
                },
                e.OBJ_DECORATEIVE_SHED_REPAIR = {
                    alias: "obj_decorateive_shed_repair"
                },
                e.OBJ_DECORATEIVE_SHED_UNLOCK = {
                    alias: "obj_decorateive_shed_unlock"
                },
                e.OBJ_DECORATEIVE_SILO_REPAIR = {
                    alias: "obj_decorateive_silo_repair"
                },
                e.OBJ_DECORATEIVE_SILO_UNLOCK = {
                    alias: "obj_decorateive_silo_unlock"
                },
                e.OBJ_DECORATEIVE_STONEFLOWERPOT_REPAIR = {
                    alias: "obj_decorateive_stoneflowerpot_repair"
                },
                e.OBJ_DECORATEIVE_STONEFLOWERPOT_UNLOCK = {
                    alias: "obj_decorateive_stoneflowerpot_unlock"
                },
                e.OBJ_DECORATEIVE_TOILET_CABIN_REPAIR = {
                    alias: "obj_decorateive_toilet_cabin_repair"
                },
                e.OBJ_DECORATEIVE_TOILET_CABIN_UNLOCK = {
                    alias: "obj_decorateive_toilet_cabin_unlock"
                },
                e.OBJ_DECORATEIVE_WATERTOWER_REPAIR = {
                    alias: "obj_decorateive_watertower_repair"
                },
                e.OBJ_DECORATEIVE_WELL_REPAIR = {
                    alias: "obj_decorateive_well_repair"
                },
                e.OBJ_DECORATEIVE_WELL_UNLOCK = {
                    alias: "obj_decorateive_well_unlock"
                },
                e.OBJ_DECORATEIVE_WINDMILL_REPAIR = {
                    alias: "obj_decorateive_windmill_repair"
                },
                e.OBJ_DECORATEIVE_WATERTOWER_UNLOCK = {
                    alias: "obj_decorateive_watertower_unlock"
                },
                e.OBJ_DECORATEIVE_BARN_REPAIR = {
                    alias: "obj_decorateive_barn_repair"
                },
                e.OBJ_DECORATEIVE_FARMHOUSEUNLOCK = {
                    alias: "obj_decorateive_farmhouseunlock"
                },
                e.OBJ_DECORATEIVE_WINDMILL_UNLOCK = {
                    alias: "obj_decorateive_windmill_unlock"
                },
                e.OBJ_DECORATEIVE_FARMHOUSE_REPAIR = {
                    alias: "obj_decorateive_farmhouse_repair"
                },
                e.REPAIR_GREENHOUSE = {
                    alias: "repair_greenhouse"
                },
                e.REPAIR_LOOM_BROKEN = {
                    alias: "repair_loom_broken"
                },
                e.REPAIR_LOOM = {
                    alias: "repair_loom"
                },
                e.REPAIR_FARMERSMARKET_BROKEN = {
                    alias: "repair_farmersmarket_broken"
                },
                e.REPAIR_FARMERSMARKET = {
                    alias: "repair_farmersmarket"
                },
                e.REPAIR_SWEETSSTATION_BROKEN = {
                    alias: "repair_sweetsstation_broken"
                },
                e.REPAIR_SWEETSSTATION = {
                    alias: "repair_sweetsstation"
                },
                e.ICON_REPAIRBUILDING_TOMATOONWHEELS_REPAIRED = {
                    alias: "icon_repairbuilding_tomatoonwheels_repaired"
                },
                e.ICON_REPAIRBUILDING_TOMATOONWHEELS_BROKEN = {
                    alias: "icon_repairbuilding_tomatoonwheels_broken"
                },
                e.ICON_REPAIRBUILDING_TRUFFLELICIOUS_BROKEN = {
                    alias: "icon_repairbuilding_trufflelicious_broken"
                },
                e.ICON_REPAIRBUILDING_TRUFFLELICIOUS_REPAIRED = {
                    alias: "icon_repairbuilding_trufflelicious_repaired"
                },
                e.ICON_BTN_MUSIC_OFF = {
                    alias: "icon_btn_music_off"
                },
                e.ICON_BTN_MUSIC_ON = {
                    alias: "icon_btn_music_on"
                },
                e.ICON_BTN_SOUND_OFF = {
                    alias: "icon_btn_sound_off"
                },
                e.ICON_BTN_SOUND_ON = {
                    alias: "icon_btn_sound_on"
                },
                e.ICON_POPUP_HEADER_SETTINGS = {
                    alias: "icon_popup_header_settings"
                },
                e.BALLOON_NOTIFICATION_REPAIR = {
                    alias: "balloon_notification_repair"
                },
                e.BTN_EVENT_BLUEFB_DOWN = {
                    alias: "btn_event_blueFB_down"
                },
                e.BTN_EVENT_BLUEFB_IDLE = {
                    alias: "btn_event_blueFB_idle"
                },
                e.BTN_EVENT_GREEN_DOWN = {
                    alias: "btn_event_green_down"
                },
                e.BTN_EVENT_GREEN_IDLE = {
                    alias: "btn_event_green_idle"
                },
                e.BTN_EVENT_PURPLE_DOWN = {
                    alias: "btn_event_purple_down"
                },
                e.BTN_RANK_LEVEL_BEAM_02 = {
                    alias: "btn_rank_level_beam_02"
                },
                e.BTN_EVENT_PURPLE_IDLE = {
                    alias: "btn_event_purple_idle"
                },
                e.BTN_RANK_LEVEL_CIRCLE = {
                    alias: "btn_rank_level_circle"
                },
                e.BUTTERFLY_01 = {
                    alias: "butterfly_01"
                },
                e.BUTTERFLY_02 = {
                    alias: "butterfly_02"
                },
                e.BUTTERFLY_03 = {
                    alias: "butterfly_03"
                },
                e.DISAPPEAR_GLOW_01 = {
                    alias: "disappear_glow_01"
                },
                e.BUTTERFLY_SHADOW = {
                    alias: "butterfly_shadow"
                },
                e.DUST_01 = {
                    alias: "dust_01"
                },
                e.BTN_RANK_LEVEL_BEAM_03 = {
                    alias: "btn_rank_level_beam_03"
                },
                e.DUST_02 = {
                    alias: "dust_02"
                },
                e.DISAPPEAR_GLOW_02 = {
                    alias: "disappear_glow_02"
                },
                e.DUST_05 = {
                    alias: "dust_05"
                },
                e.DUST_06 = {
                    alias: "dust_06"
                },
                e.DUST_08 = {
                    alias: "dust_08"
                },
                e.BTN_RANK_LEVEL_BEAM_01 = {
                    alias: "btn_rank_level_beam_01"
                },
                e.DUST_03 = {
                    alias: "dust_03"
                },
                e.ICON_ARROW_FILLING = {
                    alias: "icon_arrow_filling"
                },
                e.DUST_10 = {
                    alias: "dust_10"
                },
                e.ICON_BTN_CRATE_SPAWN = {
                    alias: "icon_btn_crate_spawn"
                },
                e.ICON_COUNTER_COIN = {
                    alias: "icon_counter_coin"
                },
                e.ICON_NOTIFICATION_ATTENTION = {
                    alias: "icon_notification_attention"
                },
                e.ICON_NOTIFICATION_DONE = {
                    alias: "icon_notification_done"
                },
                e.ICON_NOTIFICATION_EMPTY = {
                    alias: "icon_notification_empty"
                },
                e.ICON_NOTIFICATION_TIME = {
                    alias: "icon_notification_time"
                },
                e.ICON_ONBOARDING_ARROW = {
                    alias: "icon_onboarding_arrow"
                },
                e.ICON_TIMER_REGENERATING = {
                    alias: "icon_timer_regenerating"
                },
                e.OBJ_CRATE_SPARKLES1 = {
                    alias: "obj_crate_sparkles1"
                },
                e.OBJ_CRATE_SPARKLES2 = {
                    alias: "obj_crate_sparkles2"
                },
                e.OBJ_CRATE_SPARKLES3 = {
                    alias: "obj_crate_sparkles3"
                },
                e.OBJ_PLACEHOLDER = {
                    alias: "obj_placeholder"
                },
                e.RAIN_HIT_01 = {
                    alias: "rain_hit_01"
                },
                e.RAIN_HIT_03 = {
                    alias: "rain_hit_03"
                },
                e.RAIN_HIT_02 = {
                    alias: "rain_hit_02"
                },
                e.RAIN_HIT_04 = {
                    alias: "rain_hit_04"
                },
                e.RAIN_STREAK = {
                    alias: "rain_streak"
                },
                e.S_PATICLE_STAR = {
                    alias: "s_paticle_star"
                },
                e.SHOVEL = {
                    alias: "shovel"
                },
                e.STAR_PARTICLE = {
                    alias: "star_particle"
                },
                e.BTN_RANK_LEVEL_BEAM_04 = {
                    alias: "btn_rank_level_beam_04"
                },
                e.S_CONFETTI_BLUE = {
                    alias: "s_confetti_BLUE"
                },
                e.S_CONFETTI_MAGENTA_02 = {
                    alias: "s_confetti_MAGENTA_02"
                },
                e.S_CONFETTI_PURPLE = {
                    alias: "s_confetti_PURPLE"
                },
                e.S_CONFETTI_RED_02 = {
                    alias: "s_confetti_RED_02"
                },
                e.S_CONFETTI_RED = {
                    alias: "s_confetti_RED"
                },
                e.S_CONFETTI_GREEN = {
                    alias: "s_confetti_GREEN"
                },
                e.S_CONFETTI_MAGENTA = {
                    alias: "s_confetti_MAGENTA"
                },
                e.S_CONFETTI_YELLOW_02 = {
                    alias: "s_confetti_YELLOW_02"
                },
                e.S_CONFETTI_CYAAN = {
                    alias: "s_confetti_CYAAN"
                },
                e.S_CONFETTI_YELLOW = {
                    alias: "s_confetti_YELLOW"
                },
                e.ICON_POPUP_SHOVEL_EXPLANATION = {
                    alias: "icon_popup_shovel_explanation"
                },
                e.COPY_LOGOS_LANDSCAPE = {
                    alias: "copy_logos_landscape"
                },
                e.BG_LOADING_LANDSCAPE = {
                    alias: "bg_loading_landscape"
                },
                e.LOGO_FMV_LANDSCAPE = {
                    alias: "logo_fmv_landscape"
                },
                e.COPY_LOGOS_PORTRAIT = {
                    alias: "copy_logos_portrait"
                },
                e.LOGO_FMV_PORTRAIT = {
                    alias: "logo_fmv_portrait"
                },
                e.BG_LOADING_PORTRAIT = {
                    alias: "bg_loading_portrait"
                },
                e.POPUP_STORAGE_BACKGROUND = {
                    alias: "popup_storage_background"
                },
                e.POPUP_STORAGE_FRAME = {
                    alias: "popup_storage_frame"
                },
                e.POPUP_STORAGE_GRADIENTBOTTOM = {
                    alias: "popup_storage_gradientbottom"
                },
                e.POPUP_STORAGE_SHELF = {
                    alias: "popup_storage_shelf"
                },
                e.UI_SCROLLBAR_STORAGE = {
                    alias: "ui_scrollbar_storage"
                },
                e.ICON_POPUP_STORAGE_EXPLANATION = {
                    alias: "icon_popup_storage_explanation"
                },
                e.BG_TRANSITION_FRIENDVISIT_LANDSCAPE = {
                    alias: "bg_transition_friendvisit_landscape"
                },
                e.BG_TRANSITION_FRIENDVISIT_PORTRAIT = {
                    alias: "bg_transition_friendvisit_portrait"
                },
                e.ARROW_OFFSCREEN = {
                    alias: "arrow_offscreen"
                },
                e.AVATAR_130_MASK = {
                    alias: "avatar_130_mask"
                },
                e.AVATAR_130 = {
                    alias: "avatar_130"
                },
                e.AVATAR_248_MASK = {
                    alias: "avatar_248_mask"
                },
                e.AVATAR_248 = {
                    alias: "avatar_248"
                },
                e.BALLOON_TODO_GREEN = {
                    alias: "balloon_todo_green"
                },
                e.BALLOON_TODO = {
                    alias: "balloon_todo"
                },
                e.BG_COUNTER_ORDERTRACKING = {
                    alias: "bg_counter_ordertracking"
                },
                e.BG_LEVELUP_REWARDS = {
                    alias: "bg_levelup_rewards"
                },
                e.BG_ORDERTRACKING_RECIPE = {
                    alias: "bg_ordertracking_recipe"
                },
                e.BG_TIMER_NATURE = {
                    alias: "bg_timer_nature"
                },
                e.BTN_BIG_PINK_ACTIVE = {
                    alias: "btn_big_pink_active"
                },
                e.BTN_BIG_PINK_IDLE = {
                    alias: "btn_big_pink_idle"
                },
                e.BTN_CLOSE_ACTIVE = {
                    alias: "btn_close_active"
                },
                e.BTN_CLOSE_BIG_DOWN = {
                    alias: "btn_close_big_down"
                },
                e.BTN_CLOSE_BIG_IDLE = {
                    alias: "btn_close_big_idle"
                },
                e.BTN_CLOSE_IDLE = {
                    alias: "btn_close_idle"
                },
                e.BTN_CRATESPAWN_TIMERBG_PINK_9SLICE = {
                    alias: "btn_cratespawn_timerbg_pink_9slice"
                },
                e.BTN_CRATESPAWN_TIMERBG_WHITE_9SLICE = {
                    alias: "btn_cratespawn_timerbg_white_9slice"
                },
                e.BTN_CRATESPAWN_VIDEOBG = {
                    alias: "btn_cratespawn_videobg"
                },
                e.BTN_DEFAULT_BLUE_ACTIVE = {
                    alias: "btn_default_blue_active"
                },
                e.BTN_DEFAULT_BLUE_IDLE = {
                    alias: "btn_default_blue_idle"
                },
                e.BTN_DEFAULT_GREEN_ACTIVE = {
                    alias: "btn_default_green_active"
                },
                e.BTN_DEFAULT_GREEN_IDLE = {
                    alias: "btn_default_green_idle"
                },
                e.BTN_DEFAULT_GREY_INACTIVE = {
                    alias: "btn_default_grey_inactive"
                },
                e.BTN_DEFAULT_ORANGE_ACTIVE = {
                    alias: "btn_default_orange_active"
                },
                e.BTN_DEFAULT_ORANGE_IDLE = {
                    alias: "btn_default_orange_idle"
                },
                e.BTN_DEFAULT_RED_ACTIVE = {
                    alias: "btn_default_red_active"
                },
                e.BTN_DEFAULT_RED_IDLE = {
                    alias: "btn_default_red_idle"
                },
                e.BTN_DEFAULT_YELLOW_ACTIVE = {
                    alias: "btn_default_yellow_active"
                },
                e.BTN_DEFAULT_YELLOW_IDLE = {
                    alias: "btn_default_yellow_idle"
                },
                e.BTN_FASTFORWARD_BG_9SLICES = {
                    alias: "btn_fastforward_bg_9slices"
                },
                e.BTN_FEEDBACK = {
                    alias: "btn_feedback"
                },
                e.BTN_HUD_DEFAULT_DOWN = {
                    alias: "btn_HUD_default_down"
                },
                e.BTN_HUD_DEFAULT_IDLE = {
                    alias: "btn_HUD_default_idle"
                },
                e.BTN_HUD_TASKS_DOWN = {
                    alias: "btn_HUD_tasks_down"
                },
                e.BTN_HUD_TASKS_IDLE = {
                    alias: "btn_HUD_tasks_idle"
                },
                e.COLLECT_GLOW = {
                    alias: "collect_glow"
                },
                e.FOG_PREMIUM = {
                    alias: "fog_premium"
                },
                e.HIGHLIGHTER_GREEN = {
                    alias: "highlighter_green"
                },
                e.HIGHLIGHTER_RED = {
                    alias: "highlighter_red"
                },
                e.FOG = {
                    alias: "fog"
                },
                e.ICON_BTN_DISCORD_SHARE_PLACEHOLDER = {
                    alias: "icon_btn_discord_share_placeholder"
                },
                e.ICON_BTN_DISCORD = {
                    alias: "icon_btn_discord"
                },
                e.ICON_BTN_ENERGY = {
                    alias: "icon_btn_energy"
                },
                e.ICON_BTN_FRIEND = {
                    alias: "icon_btn_friend"
                },
                e.ICON_BTN_ORDERS_FASTFORWARD_GEM = {
                    alias: "icon_btn_orders_fastforward_gem"
                },
                e.ICON_BTN_TRAINTICKET = {
                    alias: "icon_btn_trainticket"
                },
                e.ICON_BTN_VIDEO_WHITE = {
                    alias: "icon_btn_video_white"
                },
                e.ICON_BTN_VIDEO = {
                    alias: "icon_btn_video"
                },
                e.ICON_BUBBLE = {
                    alias: "icon_bubble"
                },
                e.ICON_HELP = {
                    alias: "icon_help"
                },
                e.ICON_LAND_LEVEL_BG = {
                    alias: "icon_land_level_bg"
                },
                e.ICON_LAND_LEVEL_LOCK = {
                    alias: "icon_land_level_lock"
                },
                e.ICON_ORDERS_REWARDS_COIN = {
                    alias: "icon_orders_rewards_coin"
                },
                e.ICON_ORDERTRACKING_CHECKMARK = {
                    alias: "icon_ordertracking_checkmark"
                },
                e.ICON_ORDERTRACKING_PROGRESSION = {
                    alias: "icon_ordertracking_progression"
                },
                e.ICON_POPUP_BRICKS = {
                    alias: "icon_popup_bricks"
                },
                e.ICON_POPUP_DISCONNECTION = {
                    alias: "icon_popup_disconnection"
                },
                e.ICON_POPUP_WOOD = {
                    alias: "icon_popup_wood"
                },
                e.ICON_REWARDEDLINK_GIFT = {
                    alias: "icon_rewardedlink_gift"
                },
                e.ICON_REWARDSHORTCUT_GIFT = {
                    alias: "icon_rewardshortcut_gift"
                },
                e.ICON_TIMER_FILLED = {
                    alias: "icon_timer_filled"
                },
                e.ICON_TIMER = {
                    alias: "icon_timer"
                },
                e.ICON_TOOL_HAMMER = {
                    alias: "icon_tool_hammer"
                },
                e.OVERLAY_ADVANCED_PACK_ENERGY = {
                    alias: "overlay_advanced_pack_energy"
                },
                e.OVERLAY_BONUS_FRIEND = {
                    alias: "overlay_bonus_friend"
                },
                e.OVERLAY_BOTTOM_BUTTONBACKGROUND = {
                    alias: "overlay_bottom_buttonbackground"
                },
                e.OVERLAY_INVITEFRIENDS_CRATES = {
                    alias: "overlay_invitefriends_crates"
                },
                e.OVERLAY_LEFT_BUTTONBACKGROUND = {
                    alias: "overlay_left_buttonbackground"
                },
                e.OVERLAY_RIGHT_BUTTONBACKGROUND = {
                    alias: "overlay_right_buttonbackground"
                },
                e.OVERLAY_SMALL = {
                    alias: "overlay_small"
                },
                e.OVERLAY_TOP_COUNTERBACKGROUND = {
                    alias: "overlay_top_counterbackground"
                },
                e.POPOUT_BALLOON_9SLICE = {
                    alias: "popout_balloon_9slice"
                },
                e.POPOUT_BALLOON_TAIL = {
                    alias: "popout_balloon_tail"
                },
                e.POPOUT_NOTIFICATION_9SLICE = {
                    alias: "popout_notification_9slice"
                },
                e.POPOUT_NOTIFICATION_TAIL = {
                    alias: "popout_notification_tail"
                },
                e.POPUP_9SLICE = {
                    alias: "popup_9slice"
                },
                e.POPUP_BACKGROUND_EVENT_9SLICE = {
                    alias: "popup_background_event_9slice"
                },
                e.POPUP_BALLOON_9SLICE = {
                    alias: "popup_balloon_9slice"
                },
                e.POPUP_BALLOON_ORDERTRACKING_9SLICE = {
                    alias: "popup_balloon_ordertracking_9slice"
                },
                e.POPUP_BG_BLACK_9SLICE = {
                    alias: "popup_bg_black_9slice"
                },
                e.POPUP_BG_GREEN_9SLICE = {
                    alias: "popup_bg_green_9slice"
                },
                e.POPUP_BG_LIGHTBROWN01_9SLICE = {
                    alias: "popup_bg_lightbrown01_9slice"
                },
                e.POPUP_BG_LIGHTBROWN02_9SLICE = {
                    alias: "popup_bg_lightbrown02_9slice"
                },
                e.POPUP_NOTIFICATION_9SLICE = {
                    alias: "popup_notification_9slice"
                },
                e.POPUP_TAB_ACTIVE_9SLICE = {
                    alias: "popup_tab_active_9slice"
                },
                e.POPUP_TAB_INACTIVE_9SLICE = {
                    alias: "popup_tab_inactive_9slice"
                },
                e.PROGRESS_BAR_FILL_DYNAMIC_LEFT_GRAY = {
                    alias: "progress_bar_fill_dynamic_left_gray"
                },
                e.PROGRESS_BAR_FILL_DYNAMIC_LEFT = {
                    alias: "progress_bar_fill_dynamic_left"
                },
                e.PROGRESS_BAR_FILL_DYNAMIC_MIDDLE_GRAY = {
                    alias: "progress_bar_fill_dynamic_middle_gray"
                },
                e.PROGRESS_BAR_FILL_DYNAMIC_MIDDLE = {
                    alias: "progress_bar_fill_dynamic_middle"
                },
                e.PROGRESS_BAR_FILL_DYNAMIC_RIGHT_GRAY = {
                    alias: "progress_bar_fill_dynamic_right_gray"
                },
                e.PROGRESS_BAR_FILL_DYNAMIC_RIGHT = {
                    alias: "progress_bar_fill_dynamic_right"
                },
                e.PROGRESS_BAR_FILL_HIGHLIGHT = {
                    alias: "progress_bar_fill_highlight"
                },
                e.PROGRESS_BAR_FILL_SMALL_GREEN = {
                    alias: "progress_bar_fill_small_green"
                },
                e.PROGRESS_BAR_FILL_SMALL_RED = {
                    alias: "progress_bar_fill_small_red"
                },
                e.PROGRESS_BAR_FILL = {
                    alias: "progress_bar_fill"
                },
                e.PROGRESS_BAR_LAND_BG = {
                    alias: "progress_bar_land_bg"
                },
                e.PROGRESS_BAR_PANEL_2_SLICE = {
                    alias: "progress_bar_panel_2_slice"
                },
                e.PROGRESS_BAR_SMALL = {
                    alias: "progress_bar_small"
                },
                e.UI_BTN_CLOSE = {
                    alias: "ui_btn_close"
                },
                e.UI_POPOUT_TAIL = {
                    alias: "ui_popout_tail"
                },
                e.UI_POPUP_SCROLLBAR = {
                    alias: "ui_popup_scrollbar"
                },
                e.ICON_BALLOON_REWARDEDVIDEO = {
                    alias: "icon_balloon_rewardedvideo"
                },
                e.ICON_STAR_UPGRADED_01 = {
                    alias: "icon_star_upgraded_01"
                },
                e.ICON_STAR_UPGRADED_02 = {
                    alias: "icon_star_upgraded_02"
                },
                e.ICON_STAR_UPGRADED_03 = {
                    alias: "icon_star_upgraded_03"
                },
                e.OBJ_UPGRADECARD_BG01 = {
                    alias: "obj_upgradecard_bg01"
                },
                e.OBJ_UPGRADECARD_BG02 = {
                    alias: "obj_upgradecard_bg02"
                },
                e.OBJ_UPGRADECARD_BG03 = {
                    alias: "obj_upgradecard_bg03"
                },
                e.OBJ_UPGRADECARD_CROPS_AVOCADO_03 = {
                    alias: "obj_upgradecard_crops_avocado_03"
                },
                e.OBJ_UPGRADECARD_CROPS_CARROT_03 = {
                    alias: "obj_upgradecard_crops_carrot_03"
                },
                e.OBJ_UPGRADECARD_CROPS_COFFEE_03 = {
                    alias: "obj_upgradecard_crops_coffee_03"
                },
                e.OBJ_UPGRADECARD_CROPS_CORN_03 = {
                    alias: "obj_upgradecard_crops_corn_03"
                },
                e.OBJ_UPGRADECARD_CROPS_SOYBEAN_03 = {
                    alias: "obj_upgradecard_crops_soybean_03"
                },
                e.OBJ_UPGRADECARD_CROPS_SUGARCANE_03 = {
                    alias: "obj_upgradecard_crops_sugarcane_03"
                },
                e.OBJ_UPGRADECARD_CROPS_SUNFLOWER_03 = {
                    alias: "obj_upgradecard_crops_sunflower_03"
                },
                e.OBJ_UPGRADECARD_CROPS_TOMATO_03 = {
                    alias: "obj_upgradecard_crops_tomato_03"
                },
                e.OBJ_UPGRADECARD_CROPS_WHEAT_03 = {
                    alias: "obj_upgradecard_crops_wheat_03"
                },
                e.OBJ_UPGRADECARD_OBJ_ANIMAL_CHICKEN_03 = {
                    alias: "obj_upgradecard_obj_animal_chicken_03"
                },
                e.OBJ_UPGRADECARD_OBJ_ANIMAL_COW_03 = {
                    alias: "obj_upgradecard_obj_animal_cow_03"
                },
                e.OBJ_UPGRADECARD_OBJ_ANIMAL_DEER_03 = {
                    alias: "obj_upgradecard_obj_animal_deer_03"
                },
                e.OBJ_UPGRADECARD_OBJ_ANIMAL_GOAT_03 = {
                    alias: "obj_upgradecard_obj_animal_goat_03"
                },
                e.OBJ_UPGRADECARD_OBJ_ANIMAL_PIG_03 = {
                    alias: "obj_upgradecard_obj_animal_pig_03"
                },
                e.OBJ_UPGRADECARD_OBJ_ANIMAL_SHEEP_03 = {
                    alias: "obj_upgradecard_obj_animal_sheep_03"
                },
                e.OBJ_UPGRADECARD_OBJ_ANIMAL_TRUFFLEPIG_03 = {
                    alias: "obj_upgradecard_obj_animal_trufflepig_03"
                },
                e.BG_UPGRADECARD_01 = {
                    alias: "bg_upgradecard_01"
                },
                e.BG_UPGRADECARD_02 = {
                    alias: "bg_upgradecard_02"
                },
                e.BG_UPGRADECARD_03 = {
                    alias: "bg_upgradecard_03"
                },
                e.BG_UPGRADECARD_ANIMAL_COW_03 = {
                    alias: "bg_upgradecard_animal_cow_03"
                },
                e.BG_UPGRADECARD_ANIMAL_PIG_03 = {
                    alias: "bg_upgradecard_animal_pig_03"
                },
                e.BG_UPGRADECARD_ANIMAL_CHICKEN_03 = {
                    alias: "bg_upgradecard_animal_chicken_03"
                },
                e.BG_UPGRADECARD_ANIMAL_TRUFFLEPIG_03 = {
                    alias: "bg_upgradecard_animal_trufflepig_03"
                },
                e.BG_UPGRADECARD_ANIMAL_SHEEP_03 = {
                    alias: "bg_upgradecard_animal_sheep_03"
                },
                e.BG_UPGRADECARD_CROPS_AVOCADO_03 = {
                    alias: "bg_upgradecard_crops_avocado_03"
                },
                e.BG_UPGRADECARD_CROPS_COFFEE_03 = {
                    alias: "bg_upgradecard_crops_coffee_03"
                },
                e.BG_UPGRADECARD_CROPS_CORN_03 = {
                    alias: "bg_upgradecard_crops_corn_03"
                },
                e.BG_UPGRADECARD_CROPS_SOYBEANS_03 = {
                    alias: "bg_upgradecard_crops_soybeans_03"
                },
                e.BG_UPGRADECARD_CROPS_SUGARCANE_03 = {
                    alias: "bg_upgradecard_crops_sugarcane_03"
                },
                e.BG_UPGRADECARD_CROPS_CARROT_03 = {
                    alias: "bg_upgradecard_crops_carrot_03"
                },
                e.BG_UPGRADECARD_ANIMAL_DEER_03 = {
                    alias: "bg_upgradecard_animal_deer_03"
                },
                e.BG_UPGRADECARD_ANIMAL_GOAT_03 = {
                    alias: "bg_upgradecard_animal_goat_03"
                },
                e.BG_UPGRADECARD_CROPS_SUNFLOWER_03 = {
                    alias: "bg_upgradecard_crops_sunflower_03"
                },
                e.BG_UPGRADECARD_CROPS_TOMATO_03 = {
                    alias: "bg_upgradecard_crops_tomato_03"
                },
                e.BG_UPGRADECARD_CROPS_WHEAT_03 = {
                    alias: "bg_upgradecard_crops_wheat_03"
                },
                e.BTN_HOME = {
                    alias: "btn_home"
                },
                e.ICON_BALLOON_BOOSTBUILDING = {
                    alias: "icon_balloon_boostbuilding"
                },
                e.ICON_BALLOON_FRIEND = {
                    alias: "icon_balloon_friend"
                },
                e.ICON_BALLOON_HEAVYOBJ = {
                    alias: "icon_balloon_heavyobj"
                },
                e.ICON_BALLOON_HUGTREE = {
                    alias: "icon_balloon_hugtree"
                },
                e.ICON_BALLOON_PETANIMALS = {
                    alias: "icon_balloon_petanimals"
                },
                e.ICON_BALLOON_WATERCROPS = {
                    alias: "icon_balloon_watercrops"
                },
                e.ICON_BALLOON_UNLOADDELIVERY = {
                    alias: "icon_balloon_unloaddelivery"
                },
                e.WIND_TRAIL = {
                    alias: "wind_trail"
                },
                e
            }()
              , E = function() {
                function e() {}
                return e.AMBIENCE_FARM = {
                    alias: "ambience_farm"
                },
                e.MAIN_MUSIC_LOOP = {
                    alias: "main_music_loop"
                },
                e.SFX = {
                    alias: "sfx"
                },
                e
            }()
              , m = function() {
                function e() {}
                return e.AMBIENCE_FARM = {
                    alias: "ambience_farm"
                },
                e.MAIN_MUSIC_LOOP = {
                    alias: "main_music_loop"
                },
                e.BUILDING_REPAIRED = {
                    alias: "building_repaired"
                },
                e.BUTTON_TAP = {
                    alias: "button_tap"
                },
                e.CHOP_ROCK = {
                    alias: "chop_rock"
                },
                e.CHOP_WOOD = {
                    alias: "chop_wood"
                },
                e.CLAIM_REWARD_STINGER = {
                    alias: "claim_reward_stinger"
                },
                e.COINS_TAPPED = {
                    alias: "coins_tapped"
                },
                e.COLLECT_INGREDIENT = {
                    alias: "collect_ingredient"
                },
                e.CRATE_REVEAL_CHICKEN = {
                    alias: "crate_reveal_chicken"
                },
                e.CRATE_REVEAL_COW = {
                    alias: "crate_reveal_cow"
                },
                e.CRATE_REVEAL_GOAT = {
                    alias: "crate_reveal_goat"
                },
                e.CRATE_REVEAL_GROPS = {
                    alias: "crate_reveal_grops"
                },
                e.CRATE_REVEAL_PIG = {
                    alias: "crate_reveal_pig"
                },
                e.CRATE_REVEAL_SHEEP = {
                    alias: "crate_reveal_sheep"
                },
                e.CRATE_SPAWN = {
                    alias: "crate_spawn"
                },
                e.CRATE_TAP = {
                    alias: "crate_tap"
                },
                e.CURRENCY_ADDED = {
                    alias: "currency_added"
                },
                e.EXPANSION_SUCCESFUL = {
                    alias: "expansion_succesful"
                },
                e.FOG_DISSAPEAR = {
                    alias: "fog_dissapear"
                },
                e.FRIEND_VISIT_ACTIVTY = {
                    alias: "friend_visit_activty"
                },
                e.LEVEL_UP_CARD = {
                    alias: "level_up_card"
                },
                e.LEVEL_UP = {
                    alias: "level_up"
                },
                e.MERGE_TIER1_01 = {
                    alias: "merge_tier1_01"
                },
                e.MERGE_TIER1_02 = {
                    alias: "merge_tier1_02"
                },
                e.MERGE_TIER1_03 = {
                    alias: "merge_tier1_03"
                },
                e.MERGE_TIER1_04 = {
                    alias: "merge_tier1_04"
                },
                e.MERGE_TIER1_05 = {
                    alias: "merge_tier1_05"
                },
                e.MERGE_TIER1_06 = {
                    alias: "merge_tier1_06"
                },
                e.MERGE_TIER2_01 = {
                    alias: "merge_tier2_01"
                },
                e.MERGE_TIER2_02 = {
                    alias: "merge_tier2_02"
                },
                e.MERGE_TIER2_03 = {
                    alias: "merge_tier2_03"
                },
                e.MERGE_TIER2_04 = {
                    alias: "merge_tier2_04"
                },
                e.MERGE_TIER2_05 = {
                    alias: "merge_tier2_05"
                },
                e.MERGE_TIER2_06 = {
                    alias: "merge_tier2_06"
                },
                e.OBJECT_DROP = {
                    alias: "object_drop"
                },
                e.OBJECT_PICKUP = {
                    alias: "object_pickup"
                },
                e.POPOUT_APPEARS = {
                    alias: "popout_appears"
                },
                e.POPOUT_CLOSE = {
                    alias: "popout_close"
                },
                e.POPOUT_OPEN = {
                    alias: "popout_open"
                },
                e.POPUP_IN = {
                    alias: "popup_in"
                },
                e.POPUP_OUT = {
                    alias: "popup_out"
                },
                e.PURCHASE_COMPLETE = {
                    alias: "purchase_complete"
                },
                e.SELECT_TREE = {
                    alias: "select_tree"
                },
                e.SHOVEL_USE = {
                    alias: "shovel_use"
                },
                e.SPAWN_CHICKEN_2 = {
                    alias: "spawn_chicken_2"
                },
                e.SPAWN_CHICKEN_3 = {
                    alias: "spawn_chicken_3"
                },
                e.SPAWN_CHICKEN_4 = {
                    alias: "spawn_chicken_4"
                },
                e.SPAWN_COW_2 = {
                    alias: "spawn_cow_2"
                },
                e.SPAWN_COW_3 = {
                    alias: "spawn_cow_3"
                },
                e.SPAWN_COW_4 = {
                    alias: "spawn_cow_4"
                },
                e.SPAWN_CROP_2 = {
                    alias: "spawn_crop_2"
                },
                e.SPAWN_CROP_3 = {
                    alias: "spawn_crop_3"
                },
                e.SPAWN_CROP_4 = {
                    alias: "spawn_crop_4"
                },
                e.SPAWN_DEER_1 = {
                    alias: "spawn_deer_1"
                },
                e.SPAWN_DEER_2 = {
                    alias: "spawn_deer_2"
                },
                e.SPAWN_DEER_3 = {
                    alias: "spawn_deer_3"
                },
                e.SPAWN_DEER_4 = {
                    alias: "spawn_deer_4"
                },
                e.SPAWN_GOAT_2 = {
                    alias: "spawn_goat_2"
                },
                e.SPAWN_GOAT_3 = {
                    alias: "spawn_goat_3"
                },
                e.SPAWN_GOAT_4 = {
                    alias: "spawn_goat_4"
                },
                e.SPAWN_OBJECT = {
                    alias: "spawn_object"
                },
                e.SPAWN_PIG_2 = {
                    alias: "spawn_pig_2"
                },
                e.SPAWN_PIG_3 = {
                    alias: "spawn_pig_3"
                },
                e.SPAWN_PIG_4 = {
                    alias: "spawn_pig_4"
                },
                e.SPAWN_SHEEP_2 = {
                    alias: "spawn_sheep_2"
                },
                e.SPAWN_SHEEP_3 = {
                    alias: "spawn_sheep_3"
                },
                e.SPAWN_SHEEP_4 = {
                    alias: "spawn_sheep_4"
                },
                e.TRAIN_MOVING_LOOP = {
                    alias: "train_moving_loop"
                },
                e.TRAIN_TRAVEL_COMPLETE = {
                    alias: "train_travel_complete"
                },
                e.TRAINSTATION_INTERACTION = {
                    alias: "trainstation_interaction"
                },
                e
            }()
              , y = function() {
                function e() {}
                return e.BALOO_REGULAR = {
                    alias: "Baloo_Regular"
                },
                e.HELVETICAROUNDEDLTSTD_BD = {
                    alias: "HelveticaRoundedLTStd-Bd"
                },
                e.HELVETICAROUNDEDLTSTD_BDCN = {
                    alias: "HelveticaRoundedLTStd-BdCn"
                },
                e.MPLUSROUNDED1C_BOLD = {
                    alias: "MPLUSRounded1c-Bold"
                },
                e.NOTOSANSDISPLAY_EXTRACONDENSED_BOLD = {
                    alias: "NotoSansDisplay_ExtraCondensed-Bold"
                },
                e
            }()
              , T = {
                AXE_ANIMATION_COMPLETE: "axe_animation_complete",
                AXE_APPEAR: "axe_appear",
                AXE_CHOP: "axe_chop",
                AXE_DISAPPEAR: "axe_disappear"
            }
              , A = {
                APPEAR: "appear",
                APPEAR_IDLE: "appear_idle",
                IDLE: "idle",
                POP: "pop"
            }
              , C = {
                BUILDING_APPEAR: "building_appear",
                BUILDING_HIDE: "building_hide"
            }
              , I = {
                ANIMATION: "animation"
            }
              , S = {
                ASCEND: "ascend",
                DESCEND: "descend",
                FLY: "fly",
                IDLE: "idle"
            }
              , O = {
                DISAPPEAR_EFFECT: "disappear_effect"
            }
              , b = {
                ANIMATION: "animation"
            }
              , R = {
                CRATE_PRESS: "crate_press",
                CRATE_RELEASE: "crate_release",
                CRATE_WOBBLE: "crate_wobble",
                CRATES_ADDED: "crates_added"
            }
              , w = {
                CRATE_SPAWN_ON_GRID: "crate_spawn_on_grid"
            }
              , D = {
                CRATES_ADDED_UI: "crates_added_UI"
            }
              , N = {
                ANIMATION: "animation"
            }
              , L = {
                DUST_CLOUD: "dust_cloud"
            }
              , B = {
                GIFT_IDLE: "gift_idle",
                GIFT_OPEN: "gift_open"
            }
              , P = {
                HAND_APPEAR: "hand_appear",
                HAND_DISAPPEAR: "hand_disappear",
                NOT_POINT_FINGER: "not_point_finger",
                POINT_FINGER: "point_finger",
                STATIC_NOT_POINTING_FINGER: "static_not_pointing_finger",
                STATIC_POINTING_FINGER: "static_pointing_finger"
            }
              , k = {
                LEVEL_UP_REWARD_LIGHT_BEAM_LOOP: "level_up_reward_light_beam_loop"
            }
              , x = {
                LEVEL_UP_REWARD_SEQENCE_APPEAR: "level_up_reward_seqence_appear",
                LEVEL_UP_REWARD_SEQENCE_HIDE: "level_up_reward_seqence_hide"
            }
              , G = {
                IDLE_BY: "idle_by",
                IDLE_PY: "idle_py",
                IDLE_RY: "idle_ry",
                IDLE_YO: "idle_yo",
                OPEN_BY: "open_by",
                OPEN_PY: "open_py",
                OPEN_RY: "open_ry",
                OPEN_YO: "open_yo",
                OPENED_BY: "opened_by",
                OPENED_PY: "opened_py",
                OPENED_RY: "opened_ry",
                OPENED_YO: "opened_yo"
            }
              , U = {
                MERGE_EFFECT: "merge_effect"
            }
              , F = {
                MERGE_EFFECT: "merge_effect"
            }
              , M = {
                MERGE_EFFECT: "merge_effect"
            }
              , V = {
                NOTIFICATION_CHECKMARK: "notification_checkmark",
                NOTIFICATION_CHECKMARK_ORDERSBUTTON: "notification_checkmark_ordersbutton",
                NOTIFICATION_EXCLAMATIONMARK: "notification_exclamationmark",
                NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON: "notification_exclamationmark_ordersbutton",
                NOTIFICATION_HOURGLASS: "notification_hourglass",
                NOTIFICATION_HOURGLASS_ORDERSBUTTON: "notification_hourglass_ordersbutton"
            }
              , H = {
                REGENERATING_STATE: "regenerating_state"
            }
              , j = {
                ONBOARDING_ARROW_ANIMATION_APEAR: "onboarding_arrow_animation_apear",
                ONBOARDING_ARROW_ANIMATION_DISAPPEAR: "onboarding_arrow_animation_disappear",
                ONBOARDING_ARROW_ANIMATION_IDLE: "onboarding_arrow_animation_idle"
            }
              , K = {
                HOURGLASS_APPEAR: "hourglass_appear",
                HOURGLASS_DISAPPEAR: "hourglass_disappear",
                HOURGLASS_ROTATE: "hourglass_rotate"
            }
              , W = {
                PICK_AXE_APPEAR: "pick_axe_appear",
                PICK_AXE_CHOP1: "pick_axe_chop1",
                PICK_AXE_CHOP2: "pick_axe_chop2",
                PICK_AXE_CHOP3: "pick_axe_chop3",
                PICK_AXE_DISAPPEAR: "pick_axe_disappear"
            }
              , z = {
                ARROW_IN: "arrow_in",
                ARROW_OUT: "arrow_out"
            }
              , Y = {
                RAIN_STREAKS: "rain streaks"
            }
              , J = {
                ANIMATION: "animation"
            }
              , X = {
                IDLE_CLOSED_BRONZE: "idle_closed_bronze",
                IDLE_CLOSED_GOLD: "idle_closed_gold",
                IDLE_CLOSED_SILVER: "idle_closed_silver",
                IDLE_OPENED_BRONZE: "idle_opened_bronze",
                IDLE_OPENED_GOLD: "idle_opened_gold",
                IDLE_OPENED_SILVER: "idle_opened_silver",
                OPENING_BRONZE: "opening_bronze",
                OPENING_GOLD: "opening_gold",
                OPENING_SILVER: "opening_silver"
            }
              , q = {
                IDLE_CLOSED_GOLDENCARROT: "idle_closed_GoldenCarrot",
                IDLE_OPENED_GOLDENCARROT: "idle_opened_GoldenCarrot",
                OPENING_GOLDENCARROT: "opening_GoldenCarrot"
            }
              , Q = {
                IDLE_CLOSED_JINGLEBALLS: "idle_closed_JingleBalls",
                IDLE_OPENED_JINGLEBALLS: "idle_opened_JingleBalls",
                OPENING_JINGLEBALLS: "opening_JingleBalls"
            }
              , Z = {
                IDLE_CLOSED_GOLDENPUMPKIN: "idle_closed_GoldenPumpkin",
                IDLE_OPENED_GOLDENCARROT: "idle_opened_GoldenCarrot",
                OPENING_GOLDENPUMPKIN: "opening_GoldenPumpkin"
            }
              , $ = {
                SHOVEL_ANIMATION: "shovel_animation"
            }
              , ee = {
                SLEEP: "sleep"
            }
              , te = {
                ANIMATION: "animation"
            }
              , ie = {
                ANIMATION: "animation"
            }
              , ne = {
                THROBBER_LOOP: "throbber_loop"
            }
              , re = {
                TRAIN_STEAM: "train_steam"
            }
              , oe = {
                PARTICLE: "particle"
            }
              , ae = {
                VISITFRIENDS_LOADING_INDICATOR: "visitfriends_loading_indicator"
            }
              , se = function() {
                function e() {}
                return e.AXE = (0,
                n.__assign)((0,
                n.__assign)({}, T), {
                    alias: "axe"
                }),
                e.BALLOON_DETACHED_OBJECTS = (0,
                n.__assign)((0,
                n.__assign)({}, A), {
                    alias: "balloon_detached_objects"
                }),
                e.BUILDING_REPAIR = (0,
                n.__assign)((0,
                n.__assign)({}, C), {
                    alias: "building_repair"
                }),
                e.BUTTERFLIES = (0,
                n.__assign)((0,
                n.__assign)({}, I), {
                    alias: "butterflies"
                }),
                e.BUTTERFLIES_ON_TILE = (0,
                n.__assign)((0,
                n.__assign)({}, S), {
                    alias: "butterflies_on_tile"
                }),
                e.CLAIM_CURRENCY = (0,
                n.__assign)((0,
                n.__assign)({}, O), {
                    alias: "claim_currency"
                }),
                e.CONFETTI = (0,
                n.__assign)((0,
                n.__assign)({}, b), {
                    alias: "confetti"
                }),
                e.CRATE_BUTTON = (0,
                n.__assign)((0,
                n.__assign)({}, R), {
                    alias: "crate_button"
                }),
                e.CRATE_SPAWN_ON_GRID = (0,
                n.__assign)((0,
                n.__assign)({}, w), {
                    alias: "crate_spawn_on_grid"
                }),
                e.CRATES_ADDED_UI = (0,
                n.__assign)((0,
                n.__assign)({}, D), {
                    alias: "crates_added_ui"
                }),
                e.DISCOVERY_BOOK_ARROW = (0,
                n.__assign)((0,
                n.__assign)({}, N), {
                    alias: "discovery_book_arrow"
                }),
                e.DUST_CLOUD = (0,
                n.__assign)((0,
                n.__assign)({}, L), {
                    alias: "dust_cloud"
                }),
                e.GIFT_DISCOVERYBOOK = (0,
                n.__assign)((0,
                n.__assign)({}, B), {
                    alias: "gift_discoverybook"
                }),
                e.HOW_TO_PLAY_ACTION = (0,
                n.__assign)((0,
                n.__assign)({}, P), {
                    alias: "how_to_play_action"
                }),
                e.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP = (0,
                n.__assign)((0,
                n.__assign)({}, k), {
                    alias: "level_up_reward_light_beam_loop"
                }),
                e.LEVEL_UP_REWARDS_SEQUENCE = (0,
                n.__assign)((0,
                n.__assign)({}, x), {
                    alias: "level_up_rewards_sequence"
                }),
                e.LOGIN_BONUS_GIFTBOX = (0,
                n.__assign)((0,
                n.__assign)({}, G), {
                    alias: "login_bonus_giftbox"
                }),
                e.LUCKY_MERGE_EFFECT = (0,
                n.__assign)((0,
                n.__assign)({}, U), {
                    alias: "lucky_merge_effect"
                }),
                e.MERGE_BONUS_EFFECT = (0,
                n.__assign)((0,
                n.__assign)({}, F), {
                    alias: "merge_bonus_effect"
                }),
                e.MERGE_EFFECT = (0,
                n.__assign)((0,
                n.__assign)({}, M), {
                    alias: "merge_effect"
                }),
                e.NOTIFICATION_ATTENTION = (0,
                n.__assign)((0,
                n.__assign)({}, V), {
                    alias: "notification_attention"
                }),
                e.OBJECT_REGENERATION = (0,
                n.__assign)((0,
                n.__assign)({}, H), {
                    alias: "object_regeneration"
                }),
                e.ONBOARDING_ARROW = (0,
                n.__assign)((0,
                n.__assign)({}, j), {
                    alias: "onboarding_arrow"
                }),
                e.ORDER_HOURGLASS = (0,
                n.__assign)((0,
                n.__assign)({}, K), {
                    alias: "order_hourglass"
                }),
                e.PICK_AXE = (0,
                n.__assign)((0,
                n.__assign)({}, W), {
                    alias: "pick_axe"
                }),
                e.PICKUP_BUILDING = (0,
                n.__assign)((0,
                n.__assign)({}, z), {
                    alias: "pickup_building"
                }),
                e.RAIN_STREAK = (0,
                n.__assign)((0,
                n.__assign)({}, Y), {
                    alias: "rain_streak"
                }),
                e.READY_TO_HARVEST = (0,
                n.__assign)((0,
                n.__assign)({}, J), {
                    alias: "ready_to_harvest"
                }),
                e.REWARD_CRATES = (0,
                n.__assign)((0,
                n.__assign)({}, X), {
                    alias: "reward_crates"
                }),
                e.REWARD_CRATES_CARROT = (0,
                n.__assign)((0,
                n.__assign)({}, q), {
                    alias: "reward_crates_carrot"
                }),
                e.REWARD_CRATES_JINGLEBALLS = (0,
                n.__assign)((0,
                n.__assign)({}, Q), {
                    alias: "reward_crates_jingleballs"
                }),
                e.REWARD_CRATES_PUMPKIN = (0,
                n.__assign)((0,
                n.__assign)({}, Z), {
                    alias: "reward_crates_pumpkin"
                }),
                e.SHOVEL = (0,
                n.__assign)((0,
                n.__assign)({}, $), {
                    alias: "shovel"
                }),
                e.SLEEP = (0,
                n.__assign)((0,
                n.__assign)({}, ee), {
                    alias: "sleep"
                }),
                e.STAREFFECT = (0,
                n.__assign)((0,
                n.__assign)({}, te), {
                    alias: "stareffect"
                }),
                e.THROBBER_COW = (0,
                n.__assign)((0,
                n.__assign)({}, ie), {
                    alias: "throbber_cow"
                }),
                e.THROBBER_LOOP = (0,
                n.__assign)((0,
                n.__assign)({}, ne), {
                    alias: "throbber_loop"
                }),
                e.TRAIN_STEAM = (0,
                n.__assign)((0,
                n.__assign)({}, re), {
                    alias: "train_steam"
                }),
                e.VISIT_FARM_PARTICLE = (0,
                n.__assign)((0,
                n.__assign)({}, oe), {
                    alias: "visit_farm_particle"
                }),
                e.VISITFRIENDS_LOADING_INDICATOR = (0,
                n.__assign)((0,
                n.__assign)({}, ae), {
                    alias: "visitfriends_loading_indicator"
                }),
                e
            }()
              , _e = function() {
                function e() {}
                return e.MAP_CRAZYGAMES = {
                    alias: "map_crazygames"
                },
                e.MAP_LOCAL_DEV = {
                    alias: "map_local_dev"
                },
                e.MAP_PLAYGROUND = {
                    alias: "map_playground"
                },
                e.MAP_PREMIUM = {
                    alias: "map-premium"
                },
                e.MAP_FACEBOOK = {
                    alias: "map_facebook"
                },
                e.MAP_STANDALONE = {
                    alias: "map_standalone"
                },
                e.MAP_SHORT___NO_SOCIAL_FEATURES = {
                    alias: "map_short_-_no_social_features"
                },
                e.NPC_1 = {
                    alias: "NPC_1"
                },
                e.NPC_2 = {
                    alias: "NPC_2"
                },
                e.AUDIO_CONFIG = {
                    alias: "audio_config"
                },
                e.AVOCADO_3 = {
                    alias: "avocado_3"
                },
                e.AVOCADO_2 = {
                    alias: "avocado_2"
                },
                e.AVOCADO = {
                    alias: "avocado"
                },
                e.AREA_CLOUD = {
                    alias: "area_cloud"
                },
                e.AVOCADO_4 = {
                    alias: "avocado_4"
                },
                e.AVOCADO_1 = {
                    alias: "avocado_1"
                },
                e.BACON = {
                    alias: "bacon"
                },
                e.BAKERY = {
                    alias: "bakery"
                },
                e.BARISTA = {
                    alias: "barista"
                },
                e.BASE_ANIMAL = {
                    alias: "base_animal"
                },
                e.BASE_CROP = {
                    alias: "base_crop"
                },
                e.BASE_DECORATIVE = {
                    alias: "base_decorative"
                },
                e.BASE_EQUIPMENT_OBJECTS = {
                    alias: "base_equipment_objects"
                },
                e.BASE_GOLDEN_ITEM = {
                    alias: "base_golden_item"
                },
                e.BASE_HARVESTABLE_ANIMAL = {
                    alias: "base_harvestable_animal"
                },
                e.BASE_HEAVY_OBJECT = {
                    alias: "base_heavy_object"
                },
                e.BASE_INGREDIENT = {
                    alias: "base_ingredient"
                },
                e.BASE_HARVESTABLE_CROP = {
                    alias: "base_harvestable_crop"
                },
                e.BASE_MERGABLE = {
                    alias: "base_mergable"
                },
                e.BASE_REWARD_CRATE_KEY = {
                    alias: "base_reward_crate_key"
                },
                e.BASE_NATURE_OBJECTS = {
                    alias: "base_nature_objects"
                },
                e.BASE_ROCK = {
                    alias: "base_rock"
                },
                e.BASE_REWARD_CRATE = {
                    alias: "base_reward_crate"
                },
                e.BLUEPRINTS_INDEX = {
                    alias: "blueprints_index"
                },
                e.BASE_TREE = {
                    alias: "base_tree"
                },
                e.BASE_TOOLBOX = {
                    alias: "base_toolbox"
                },
                e.BBQ = {
                    alias: "bbq"
                },
                e.BUILDING_AVOCADOFIESTA = {
                    alias: "building_avocadofiesta"
                },
                e.BUILDING_TRUFFLELICIOUS = {
                    alias: "building_trufflelicious"
                },
                e.CARROT_1 = {
                    alias: "carrot_1"
                },
                e.CARROT_2 = {
                    alias: "carrot_2"
                },
                e.CARROT_3 = {
                    alias: "carrot_3"
                },
                e.CHICKEN_1 = {
                    alias: "chicken_1"
                },
                e.CARROT = {
                    alias: "carrot"
                },
                e.CHICKEN_2 = {
                    alias: "chicken_2"
                },
                e.CARROT_4 = {
                    alias: "carrot_4"
                },
                e.CHICKEN_3 = {
                    alias: "chicken_3"
                },
                e.CHICKEN_4 = {
                    alias: "chicken_4"
                },
                e.COFFEE_1 = {
                    alias: "coffee_1"
                },
                e.COFFEE_2 = {
                    alias: "coffee_2"
                },
                e.COFFEE_4 = {
                    alias: "coffee_4"
                },
                e.COFFEEBEANS = {
                    alias: "coffeebeans"
                },
                e.COIN_1 = {
                    alias: "coin_1"
                },
                e.COFFEE_3 = {
                    alias: "coffee_3"
                },
                e.COIN_3 = {
                    alias: "coin_3"
                },
                e.COIN_4 = {
                    alias: "coin_4"
                },
                e.COIN_2 = {
                    alias: "coin_2"
                },
                e.COIN_5 = {
                    alias: "coin_5"
                },
                e.COIN_7 = {
                    alias: "coin_7"
                },
                e.COIN_6 = {
                    alias: "coin_6"
                },
                e.COIN_8 = {
                    alias: "coin_8"
                },
                e.CORN_1 = {
                    alias: "corn_1"
                },
                e.CORN_2 = {
                    alias: "corn_2"
                },
                e.CORN_3 = {
                    alias: "corn_3"
                },
                e.CORN_4 = {
                    alias: "corn_4"
                },
                e.CORN = {
                    alias: "corn"
                },
                e.COW_2 = {
                    alias: "cow_2"
                },
                e.COW_1 = {
                    alias: "cow_1"
                },
                e.COW_3 = {
                    alias: "cow_3"
                },
                e.COW_4 = {
                    alias: "cow_4"
                },
                e.CRATE_2 = {
                    alias: "crate_2"
                },
                e.CRATE_1 = {
                    alias: "crate_1"
                },
                e.DAILY_CHALLENGE_GIFTBOX = {
                    alias: "daily_challenge_giftbox"
                },
                e.DAIRY = {
                    alias: "dairy"
                },
                e.CRATE = {
                    alias: "crate"
                },
                e.DECORATIVE_BARN = {
                    alias: "decorative_barn"
                },
                e.DECORATIVE_CHICKENCOOP = {
                    alias: "decorative_chickencoop"
                },
                e.DECORATIVE_CHRISTMAS_CANDYGATE = {
                    alias: "decorative_christmas_candygate"
                },
                e.DECORATIVE_BIRDSHOUSE = {
                    alias: "decorative_birdshouse"
                },
                e.DECORATIVE_CHRISTMAS_ELFTEDDY = {
                    alias: "decorative_christmas_elfteddy"
                },
                e.DECORATIVE_CHRISTMAS_ELFMAIL = {
                    alias: "decorative_christmas_elfmail"
                },
                e.DECORATIVE_CHRISTMAS_FIREPLACE = {
                    alias: "decorative_christmas_fireplace"
                },
                e.DECORATIVE_CHRISTMAS_GIFT01 = {
                    alias: "decorative_christmas_gift01"
                },
                e.DECORATIVE_CHRISTMAS_ELFTRAIN = {
                    alias: "decorative_christmas_elftrain"
                },
                e.DECORATIVE_CHRISTMAS_GIFT02 = {
                    alias: "decorative_christmas_gift02"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBELL = {
                    alias: "decorative_christmas_gingerbell"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBREADHOUSE = {
                    alias: "decorative_christmas_gingerbreadhouse"
                },
                e.DECORATIVE_CHRISTMAS_GIFT03 = {
                    alias: "decorative_christmas_gift03"
                },
                e.DECORATIVE_CHRISTMAS_SANTAGIFT = {
                    alias: "decorative_christmas_santagift"
                },
                e.DECORATIVE_CHRISTMAS_NUTCRACKER = {
                    alias: "decorative_christmas_nutcracker"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBREADSNOW = {
                    alias: "decorative_christmas_gingerbreadsnow"
                },
                e.DECORATIVE_CHRISTMAS_SANTAMAIL = {
                    alias: "decorative_christmas_santamail"
                },
                e.DECORATIVE_CHRISTMAS_SLEIGH = {
                    alias: "decorative_christmas_sleigh"
                },
                e.DECORATIVE_CHRISTMAS_SNOWDINNER = {
                    alias: "decorative_christmas_snowdinner"
                },
                e.DECORATIVE_CHRISTMAS_SNOWCAROLING = {
                    alias: "decorative_christmas_snowcaroling"
                },
                e.DECORATIVE_CHRISTMAS_SNOWFIGHT = {
                    alias: "decorative_christmas_snowfight"
                },
                e.DECORATIVE_CHRISTMAS_SNOWGIFTING = {
                    alias: "decorative_christmas_snowgifting"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBREADHOUSESMALL = {
                    alias: "decorative_christmas_gingerbreadhousesmall"
                },
                e.DECORATIVE_CHRISTMAS_SNOWGLOBE = {
                    alias: "decorative_christmas_snowglobe"
                },
                e.DECORATIVE_CHRISTMAS_SNOWJELLO = {
                    alias: "decorative_christmas_snowjello"
                },
                e.DECORATIVE_CHRISTMAS_SNOWLANTERN = {
                    alias: "decorative_christmas_snowlantern"
                },
                e.DECORATIVE_CHRISTMAS_SNOWTELESCOPE = {
                    alias: "decorative_christmas_snowtelescope"
                },
                e.DECORATIVE_CHRISTMAS_SNOWREINDEER = {
                    alias: "decorative_christmas_snowreindeer"
                },
                e.DECORATIVE_DOGHOUSE = {
                    alias: "decorative_doghouse"
                },
                e.DECORATIVE_FARMHOUSE = {
                    alias: "decorative_farmhouse"
                },
                e.DECORATIVE_CHRISTMAS_TREEBIG = {
                    alias: "decorative_christmas_treebig"
                },
                e.DECORATIVE_FEEDINGTROUGH = {
                    alias: "decorative_feedingtrough"
                },
                e.DECORATIVE_FOUNTAIN = {
                    alias: "decorative_fountain"
                },
                e.DECORATIVE_FLOWERPOTS = {
                    alias: "decorative_flowerpots"
                },
                e.DECORATIVE_HALLOWEEN_BLACKCAT = {
                    alias: "decorative_halloween_blackcat"
                },
                e.DECORATIVE_HALLOWEEN_CAULDRON = {
                    alias: "decorative_halloween_cauldron"
                },
                e.DECORATIVE_HALLOWEEN_GRAVE01 = {
                    alias: "decorative_halloween_grave01"
                },
                e.DECORATIVE_HALLOWEEN_GRAVE02 = {
                    alias: "decorative_halloween_grave02"
                },
                e.DECORATIVE_HALLOWEEN_GRANDFATHERCLOCK = {
                    alias: "decorative_halloween_grandfatherclock"
                },
                e.DECORATIVE_HALLOWEEN_GHOSTS = {
                    alias: "decorative_halloween_ghosts"
                },
                e.DECORATIVE_HALLOWEEN_GRAVEYARD = {
                    alias: "decorative_halloween_graveyard"
                },
                e.DECORATIVE_HALLOWEEN_HAUNTEDHOUSE = {
                    alias: "decorative_halloween_hauntedhouse"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINPATCHBIG = {
                    alias: "decorative_halloween_pumpkinpatchbig"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS01 = {
                    alias: "decorative_halloween_pumpkins01"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS02 = {
                    alias: "decorative_halloween_pumpkins02"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS03 = {
                    alias: "decorative_halloween_pumpkins03"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS04 = {
                    alias: "decorative_halloween_pumpkins04"
                },
                e.DECORATIVE_HALLOWEEN_SKELETONBENCH = {
                    alias: "decorative_halloween_skeletonbench"
                },
                e.DECORATIVE_HALLOWEEN_SKELETONCAROUSEL = {
                    alias: "decorative_halloween_skeletoncarousel"
                },
                e.DECORATIVE_HALLOWEEN_SKELETONPICNIC = {
                    alias: "decorative_halloween_skeletonpicnic"
                },
                e.DECORATIVE_HALLOWEEN_TREEFACE = {
                    alias: "decorative_halloween_treeface"
                },
                e.DECORATIVE_HALLOWEEN_SKULLALTAR = {
                    alias: "decorative_halloween_skullaltar"
                },
                e.DECORATIVE_HALLOWEEN_WELL = {
                    alias: "decorative_halloween_well"
                },
                e.DECORATIVE_MILKTANK = {
                    alias: "decorative_milktank"
                },
                e.DECORATIVE_HAYWAGON = {
                    alias: "decorative_haywagon"
                },
                e.DECORATIVE_LAMPPOST = {
                    alias: "decorative_lamppost"
                },
                e.DECORATIVE_PICKNICKTABLE = {
                    alias: "decorative_picknicktable"
                },
                e.DECORATIVE_SHED = {
                    alias: "decorative_shed"
                },
                e.DECORATIVE_SILO = {
                    alias: "decorative_silo"
                },
                e.DECORATIVE_STONEFLOWERPOT = {
                    alias: "decorative_stoneflowerpot"
                },
                e.DECORATIVE_TOILET = {
                    alias: "decorative_toilet"
                },
                e.DECORATIVE_WATERTOWER = {
                    alias: "decorative_watertower"
                },
                e.DECORATIVE_WELL = {
                    alias: "decorative_well"
                },
                e.DECORATIVE_WINDMILL = {
                    alias: "decorative_windmill"
                },
                e.DEER_1 = {
                    alias: "deer_1"
                },
                e.DEER_2 = {
                    alias: "deer_2"
                },
                e.DEER_3 = {
                    alias: "deer_3"
                },
                e.DEER_4 = {
                    alias: "deer_4"
                },
                e.DELIVERY_CARGO = {
                    alias: "delivery_cargo"
                },
                e.DELIVERY_TRUCK = {
                    alias: "delivery_truck"
                },
                e.EGG = {
                    alias: "egg"
                },
                e.ENERGY_1 = {
                    alias: "energy_1"
                },
                e.ENERGY_3 = {
                    alias: "energy_3"
                },
                e.FLOWER_1 = {
                    alias: "flower_1"
                },
                e.ENERGY_2 = {
                    alias: "energy_2"
                },
                e.ENERGY_4 = {
                    alias: "energy_4"
                },
                e.FLOWER_10 = {
                    alias: "flower_10"
                },
                e.FLOWER_2 = {
                    alias: "flower_2"
                },
                e.FLOWER_3 = {
                    alias: "flower_3"
                },
                e.FLOWER_5 = {
                    alias: "flower_5"
                },
                e.FLOWER_4 = {
                    alias: "flower_4"
                },
                e.FLOWER_6 = {
                    alias: "flower_6"
                },
                e.FLOWER_7 = {
                    alias: "flower_7"
                },
                e.FLOWER_8 = {
                    alias: "flower_8"
                },
                e.FLOWER_9 = {
                    alias: "flower_9"
                },
                e.FUR = {
                    alias: "fur"
                },
                e.GEM_1 = {
                    alias: "gem_1"
                },
                e.GEM_3 = {
                    alias: "gem_3"
                },
                e.GEM_2 = {
                    alias: "gem_2"
                },
                e.GEM_4 = {
                    alias: "gem_4"
                },
                e.GEM_5 = {
                    alias: "gem_5"
                },
                e.GEM_6 = {
                    alias: "gem_6"
                },
                e.GOAT_1 = {
                    alias: "goat_1"
                },
                e.GOAT_2 = {
                    alias: "goat_2"
                },
                e.GOAT_4 = {
                    alias: "goat_4"
                },
                e.GOAT_3 = {
                    alias: "goat_3"
                },
                e.GOATMILK = {
                    alias: "goatmilk"
                },
                e.GOLDEN_CARROT = {
                    alias: "golden_carrot"
                },
                e.GOLDEN_CHRISTMAS_TREE_1 = {
                    alias: "golden_christmas_tree_1"
                },
                e.GOLDEN_CHRISTMAS_TREE_2 = {
                    alias: "golden_christmas_tree_2"
                },
                e.GOLDEN_CHRISTMAS_TREE_4 = {
                    alias: "golden_christmas_tree_4"
                },
                e.GOLDEN_CHRISTMAS_TREE_3 = {
                    alias: "golden_christmas_tree_3"
                },
                e.GOLDEN_JINGLEBALL_1 = {
                    alias: "golden_jingleball_1"
                },
                e.GOLDEN_JINGLEBALL_3 = {
                    alias: "golden_jingleball_3"
                },
                e.GOLDEN_JINGLEBALL_2 = {
                    alias: "golden_jingleball_2"
                },
                e.GOLDEN_JINGLEBALL_4 = {
                    alias: "golden_jingleball_4"
                },
                e.GREENHOUSE_1 = {
                    alias: "greenhouse_1"
                },
                e.GOLDEN_PUMPKIN = {
                    alias: "golden_pumpkin"
                },
                e.GREENHOUSE_10 = {
                    alias: "greenhouse_10"
                },
                e.GREENHOUSE_11 = {
                    alias: "greenhouse_11"
                },
                e.GREENHOUSE_2 = {
                    alias: "greenhouse_2"
                },
                e.GREENHOUSE_4 = {
                    alias: "greenhouse_4"
                },
                e.GREENHOUSE_5 = {
                    alias: "greenhouse_5"
                },
                e.GREENHOUSE_3 = {
                    alias: "greenhouse_3"
                },
                e.GREENHOUSE_6 = {
                    alias: "greenhouse_6"
                },
                e.GREENHOUSE_7 = {
                    alias: "greenhouse_7"
                },
                e.GREENHOUSE_9 = {
                    alias: "greenhouse_9"
                },
                e.GREENHOUSE_8 = {
                    alias: "greenhouse_8"
                },
                e.GREENHOUSE = {
                    alias: "greenhouse"
                },
                e.HEAVY_OBJECT_HAY = {
                    alias: "heavy_object_hay"
                },
                e.HEAVY_OBJECT_TRAKTOR = {
                    alias: "heavy_object_traktor"
                },
                e.HEAVY_OBJECT = {
                    alias: "heavy_object"
                },
                e.HEAVY_OBJECT_WHEEL = {
                    alias: "heavy_object_wheel"
                },
                e.LOGIN_GIFTBOX = {
                    alias: "login_giftbox"
                },
                e.LOOM = {
                    alias: "loom"
                },
                e.MILK = {
                    alias: "milk"
                },
                e.MARKET = {
                    alias: "market"
                },
                e.MUSEUM = {
                    alias: "museum"
                },
                e.PIG_1 = {
                    alias: "pig_1"
                },
                e.PIG_4 = {
                    alias: "pig_4"
                },
                e.PIG_2 = {
                    alias: "pig_2"
                },
                e.PIG_3 = {
                    alias: "pig_3"
                },
                e.PREMIUM_CLOUD = {
                    alias: "premium_cloud"
                },
                e.REWARD_CRATE_DAILY_BONUS = {
                    alias: "reward_crate_daily_bonus"
                },
                e.REWARD_CRATE_GOLD = {
                    alias: "reward_crate_gold"
                },
                e.REWARD_CRATE_GOLDEN_CARROT = {
                    alias: "reward_crate_golden_carrot"
                },
                e.REWARD_CRATE_GOLDEN_PUMPKIN_1 = {
                    alias: "reward_crate_golden_pumpkin_1"
                },
                e.REWARD_CRATE_BRONZE = {
                    alias: "reward_crate_bronze"
                },
                e.REWARD_CRATE_GOLDEN_PUMPKIN_2 = {
                    alias: "reward_crate_golden_pumpkin_2"
                },
                e.REWARD_CRATE_JINGLEBALLS_1 = {
                    alias: "reward_crate_jingleballs_1"
                },
                e.REWARD_CRATE_JINGLEBALLS_2 = {
                    alias: "reward_crate_jingleballs_2"
                },
                e.REWARD_CRATE_KEY_BRONZE = {
                    alias: "reward_crate_key_bronze"
                },
                e.REWARD_CRATE_KEY_GOLDEN_CARROT = {
                    alias: "reward_crate_key_golden_carrot"
                },
                e.REWARD_CRATE_KEY_GOLD = {
                    alias: "reward_crate_key_gold"
                },
                e.REWARD_CRATE_KEY_JINGLEBALLS = {
                    alias: "reward_crate_key_jingleballs"
                },
                e.REWARD_CRATE_KEY_GOLDEN_PUMPKIN = {
                    alias: "reward_crate_key_golden_pumpkin"
                },
                e.REWARD_CRATE_SILVER = {
                    alias: "reward_crate_silver"
                },
                e.REWARD_CRATE_KEY_SILVER = {
                    alias: "reward_crate_key_silver"
                },
                e.ROCK_LARGE = {
                    alias: "rock_large"
                },
                e.ROCK_MEDIUM = {
                    alias: "rock_medium"
                },
                e.SAPLING_2 = {
                    alias: "sapling_2"
                },
                e.SAPLING_1 = {
                    alias: "sapling_1"
                },
                e.SAPLING_3 = {
                    alias: "sapling_3"
                },
                e.ROCK_SMALL = {
                    alias: "rock_small"
                },
                e.SHEEP_4 = {
                    alias: "sheep_4"
                },
                e.SHEEP_2 = {
                    alias: "sheep_2"
                },
                e.SHEEP_1 = {
                    alias: "sheep_1"
                },
                e.SHEEP_3 = {
                    alias: "sheep_3"
                },
                e.SOYBEANS_1 = {
                    alias: "soybeans_1"
                },
                e.SHORTCUT_GIFTBOX = {
                    alias: "shortcut_giftbox"
                },
                e.SOYBEANS_2 = {
                    alias: "soybeans_2"
                },
                e.SOYBEANS_3 = {
                    alias: "soybeans_3"
                },
                e.SOYBEANS_4 = {
                    alias: "soybeans_4"
                },
                e.SOYBEANS = {
                    alias: "soybeans"
                },
                e.STONE_1 = {
                    alias: "stone_1"
                },
                e.STONE_2 = {
                    alias: "stone_2"
                },
                e.STONE_4 = {
                    alias: "stone_4"
                },
                e.STONE_3 = {
                    alias: "stone_3"
                },
                e.STONE_5 = {
                    alias: "stone_5"
                },
                e.STONE_6 = {
                    alias: "stone_6"
                },
                e.STONE_8 = {
                    alias: "stone_8"
                },
                e.STONE_7 = {
                    alias: "stone_7"
                },
                e.SUGARCANE_1 = {
                    alias: "sugarcane_1"
                },
                e.SUGARCANE_2 = {
                    alias: "sugarcane_2"
                },
                e.SUGARCANE = {
                    alias: "sugarcane"
                },
                e.SUGARCANE_4 = {
                    alias: "sugarcane_4"
                },
                e.SUGARCANE_3 = {
                    alias: "sugarcane_3"
                },
                e.SUNFLOWER_1 = {
                    alias: "sunflower_1"
                },
                e.SUNFLOWER_2 = {
                    alias: "sunflower_2"
                },
                e.SUNFLOWER_3 = {
                    alias: "sunflower_3"
                },
                e.SUNFLOWER_4 = {
                    alias: "sunflower_4"
                },
                e.SUNFLOWER = {
                    alias: "sunflower"
                },
                e.TOMATO_1 = {
                    alias: "tomato_1"
                },
                e.TICKET = {
                    alias: "ticket"
                },
                e.TOMATO_2 = {
                    alias: "tomato_2"
                },
                e.SWEETS = {
                    alias: "sweets"
                },
                e.TOMATO_4 = {
                    alias: "tomato_4"
                },
                e.TOMATO_3 = {
                    alias: "tomato_3"
                },
                e.TOMATO_ON_WHEELS = {
                    alias: "tomato_on_wheels"
                },
                e.TOMATO = {
                    alias: "tomato"
                },
                e.TOOL_1 = {
                    alias: "tool_1"
                },
                e.TOOL_3 = {
                    alias: "tool_3"
                },
                e.TOOL_10 = {
                    alias: "tool_10"
                },
                e.TOOL_2 = {
                    alias: "tool_2"
                },
                e.TOOL_4 = {
                    alias: "tool_4"
                },
                e.TOOL_7 = {
                    alias: "tool_7"
                },
                e.TOOL_8 = {
                    alias: "tool_8"
                },
                e.TOOL_6 = {
                    alias: "tool_6"
                },
                e.TOOL_5 = {
                    alias: "tool_5"
                },
                e.TOOL_9 = {
                    alias: "tool_9"
                },
                e.TOOLBOX_LARGE = {
                    alias: "toolbox_large"
                },
                e.TOOLBOX_MEDIUM = {
                    alias: "toolbox_medium"
                },
                e.TOOLBOX_SMALL = {
                    alias: "toolbox_small"
                },
                e.TRAINSTATION = {
                    alias: "trainstation"
                },
                e.TREE_LARGE = {
                    alias: "tree_large"
                },
                e.TRAINTRACK_STOP = {
                    alias: "traintrack_stop"
                },
                e.TREE_MEDIUM = {
                    alias: "tree_medium"
                },
                e.TREE_SMALL = {
                    alias: "tree_small"
                },
                e.TREE_ONBOARDING = {
                    alias: "tree_onboarding"
                },
                e.TRUFFLE = {
                    alias: "truffle"
                },
                e.TRUFFLEPIG_1 = {
                    alias: "trufflepig_1"
                },
                e.TRUFFLEPIG_2 = {
                    alias: "trufflepig_2"
                },
                e.TRUFFLEPIG_4 = {
                    alias: "trufflepig_4"
                },
                e.TRUFFLEPIG_3 = {
                    alias: "trufflepig_3"
                },
                e.UPGRADE_CARD_1 = {
                    alias: "upgrade_card_1"
                },
                e.UPGRADE_CARD_3 = {
                    alias: "upgrade_card_3"
                },
                e.UPGRADE_CARD_2 = {
                    alias: "upgrade_card_2"
                },
                e.WHEAT_2 = {
                    alias: "wheat_2"
                },
                e.WHEAT_1 = {
                    alias: "wheat_1"
                },
                e.WHEAT_4 = {
                    alias: "wheat_4"
                },
                e.WHEAT_3 = {
                    alias: "wheat_3"
                },
                e.WHEAT_REWARD = {
                    alias: "wheat_reward"
                },
                e.WHEAT = {
                    alias: "wheat"
                },
                e.WOOD_1 = {
                    alias: "wood_1"
                },
                e.WOOD_2 = {
                    alias: "wood_2"
                },
                e.WOOD_3 = {
                    alias: "wood_3"
                },
                e.WOOD_4 = {
                    alias: "wood_4"
                },
                e.WOOD_5 = {
                    alias: "wood_5"
                },
                e.WOOD_6 = {
                    alias: "wood_6"
                },
                e.WOOD_7 = {
                    alias: "wood_7"
                },
                e.WOOL = {
                    alias: "wool"
                },
                e.WOOD_8 = {
                    alias: "wood_8"
                },
                e.BAKERY_CONFIG = {
                    alias: "bakery_config"
                },
                e.BARISTA_CONFIG = {
                    alias: "barista_config"
                },
                e.BBQ_CONFIG = {
                    alias: "bbq_config"
                },
                e.BUILDING_AVOCADOFIESTA_CONFIG = {
                    alias: "building_avocadofiesta_config"
                },
                e.BUILDING_TRUFFLELICIOUS_CONFIG = {
                    alias: "building_trufflelicious_config"
                },
                e.BUILDINGS_INDEX = {
                    alias: "buildings_index"
                },
                e.DAIRY_CONFIG = {
                    alias: "dairy_config"
                },
                e.DECORATIVE_BARN_CONFIG = {
                    alias: "decorative_barn_config"
                },
                e.DECORATIVE_BIRDSHOUSE_CONFIG = {
                    alias: "decorative_birdshouse_config"
                },
                e.DECORATIVE_CHICKENCOOP_CONFIG = {
                    alias: "decorative_chickencoop_config"
                },
                e.DECORATIVE_CHRISTMAS_CANDYGATE_CONFIG = {
                    alias: "decorative_christmas_candygate_config"
                },
                e.DECORATIVE_CHRISTMAS_ELFMAIL_CONFIG = {
                    alias: "decorative_christmas_elfmail_config"
                },
                e.DECORATIVE_CHRISTMAS_ELFTEDDY_CONFIG = {
                    alias: "decorative_christmas_elfteddy_config"
                },
                e.DECORATIVE_CHRISTMAS_ELFTRAIN_CONFIG = {
                    alias: "decorative_christmas_elftrain_config"
                },
                e.DECORATIVE_CHRISTMAS_FIREPLACE_CONFIG = {
                    alias: "decorative_christmas_fireplace_config"
                },
                e.DECORATIVE_CHRISTMAS_GIFT01_CONFIG = {
                    alias: "decorative_christmas_gift01_config"
                },
                e.DECORATIVE_CHRISTMAS_GIFT02_CONFIG = {
                    alias: "decorative_christmas_gift02_config"
                },
                e.DECORATIVE_CHRISTMAS_GIFT03_CONFIG = {
                    alias: "decorative_christmas_gift03_config"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBELL_CONFIG = {
                    alias: "decorative_christmas_gingerbell_config"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBREADHOUSE_CONFIG = {
                    alias: "decorative_christmas_gingerbreadhouse_config"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBREADHOUSESMALL_CONFIG = {
                    alias: "decorative_christmas_gingerbreadhousesmall_config"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBREADSNOW_CONFIG = {
                    alias: "decorative_christmas_gingerbreadsnow_config"
                },
                e.DECORATIVE_CHRISTMAS_NUTCRACKER_CONFIG = {
                    alias: "decorative_christmas_nutcracker_config"
                },
                e.DECORATIVE_CHRISTMAS_SANTAGIFT_CONFIG = {
                    alias: "decorative_christmas_santagift_config"
                },
                e.DECORATIVE_CHRISTMAS_SANTAMAIL_CONFIG = {
                    alias: "decorative_christmas_santamail_config"
                },
                e.DECORATIVE_CHRISTMAS_SNOWCAROLING_CONFIG = {
                    alias: "decorative_christmas_snowcaroling_config"
                },
                e.DECORATIVE_CHRISTMAS_SNOWDINNER_CONFIG = {
                    alias: "decorative_christmas_snowdinner_config"
                },
                e.DECORATIVE_CHRISTMAS_SLEIGH_CONFIG = {
                    alias: "decorative_christmas_sleigh_config"
                },
                e.DECORATIVE_CHRISTMAS_SNOWFIGHT_CONFIG = {
                    alias: "decorative_christmas_snowfight_config"
                },
                e.DECORATIVE_CHRISTMAS_SNOWGIFTING_CONFIG = {
                    alias: "decorative_christmas_snowgifting_config"
                },
                e.DECORATIVE_CHRISTMAS_SNOWGLOBE_CONFIG = {
                    alias: "decorative_christmas_snowglobe_config"
                },
                e.DECORATIVE_CHRISTMAS_SNOWJELLO_CONFIG = {
                    alias: "decorative_christmas_snowjello_config"
                },
                e.DECORATIVE_CHRISTMAS_SNOWLANTERN_CONFIG = {
                    alias: "decorative_christmas_snowlantern_config"
                },
                e.DECORATIVE_CHRISTMAS_SNOWREINDEER_CONFIG = {
                    alias: "decorative_christmas_snowreindeer_config"
                },
                e.DECORATIVE_CHRISTMAS_SNOWTELESCOPE_CONFIG = {
                    alias: "decorative_christmas_snowtelescope_config"
                },
                e.DECORATIVE_CHRISTMAS_TREEBIG_CONFIG = {
                    alias: "decorative_christmas_treebig_config"
                },
                e.DECORATIVE_DOGHOUSE_CONFIG = {
                    alias: "decorative_doghouse_config"
                },
                e.DECORATIVE_FARMHOUSE_CONFIG = {
                    alias: "decorative_farmhouse_config"
                },
                e.DECORATIVE_FEEDINGTROUGH_CONFIG = {
                    alias: "decorative_feedingtrough_config"
                },
                e.DECORATIVE_FLOWERPOTS_CONFIG = {
                    alias: "decorative_flowerpots_config"
                },
                e.DECORATIVE_FOUNTAIN_CONFIG = {
                    alias: "decorative_fountain_config"
                },
                e.DECORATIVE_HALLOWEEN_BLACKCAT_CONFIG = {
                    alias: "decorative_halloween_blackcat_config"
                },
                e.DECORATIVE_HALLOWEEN_CAULDRON_CONFIG = {
                    alias: "decorative_halloween_cauldron_config"
                },
                e.DECORATIVE_HALLOWEEN_GHOSTS_CONFIG = {
                    alias: "decorative_halloween_ghosts_config"
                },
                e.DECORATIVE_HALLOWEEN_GRANDFATHERCLOCK_CONFIG = {
                    alias: "decorative_halloween_grandfatherclock_config"
                },
                e.DECORATIVE_HALLOWEEN_GRAVE01_CONFIG = {
                    alias: "decorative_halloween_grave01_config"
                },
                e.DECORATIVE_HALLOWEEN_GRAVE02_CONFIG = {
                    alias: "decorative_halloween_grave02_config"
                },
                e.DECORATIVE_HALLOWEEN_GRAVEYARD_CONFIG = {
                    alias: "decorative_halloween_graveyard_config"
                },
                e.DECORATIVE_HALLOWEEN_HAUNTEDHOUSE_CONFIG = {
                    alias: "decorative_halloween_hauntedhouse_config"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINPATCHBIG_CONFIG = {
                    alias: "decorative_halloween_pumpkinpatchbig_config"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS01_CONFIG = {
                    alias: "decorative_halloween_pumpkins01_config"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS02_CONFIG = {
                    alias: "decorative_halloween_pumpkins02_config"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS03_CONFIG = {
                    alias: "decorative_halloween_pumpkins03_config"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS04_CONFIG = {
                    alias: "decorative_halloween_pumpkins04_config"
                },
                e.DECORATIVE_HALLOWEEN_SKELETONBENCH_CONFIG = {
                    alias: "decorative_halloween_skeletonbench_config"
                },
                e.DECORATIVE_HALLOWEEN_SKELETONCAROUSEL_CONFIG = {
                    alias: "decorative_halloween_skeletoncarousel_config"
                },
                e.DECORATIVE_HALLOWEEN_SKELETONPICNIC_CONFIG = {
                    alias: "decorative_halloween_skeletonpicnic_config"
                },
                e.DECORATIVE_HALLOWEEN_SKULLALTAR_CONFIG = {
                    alias: "decorative_halloween_skullaltar_config"
                },
                e.DECORATIVE_HALLOWEEN_TREEFACE_CONFIG = {
                    alias: "decorative_halloween_treeface_config"
                },
                e.DECORATIVE_HALLOWEEN_WELL_CONFIG = {
                    alias: "decorative_halloween_well_config"
                },
                e.DECORATIVE_HAYWAGON_CONFIG = {
                    alias: "decorative_haywagon_config"
                },
                e.DECORATIVE_LAMPPOST_CONFIG = {
                    alias: "decorative_lamppost_config"
                },
                e.DECORATIVE_MILKTANK_CONFIG = {
                    alias: "decorative_milktank_config"
                },
                e.DECORATIVE_PICKNICKTABLE_CONFIG = {
                    alias: "decorative_picknicktable_config"
                },
                e.DECORATIVE_SHED_CONFIG = {
                    alias: "decorative_shed_config"
                },
                e.DECORATIVE_SILO_CONFIG = {
                    alias: "decorative_silo_config"
                },
                e.DECORATIVE_STONEFLOWERPOT_CONFIG = {
                    alias: "decorative_stoneflowerpot_config"
                },
                e.DECORATIVE_TOILET_CONFIG = {
                    alias: "decorative_toilet_config"
                },
                e.DECORATIVE_WATERTOWER_CONFIG = {
                    alias: "decorative_watertower_config"
                },
                e.DECORATIVE_WELL_CONFIG = {
                    alias: "decorative_well_config"
                },
                e.DECORATIVE_WINDMILL_CONFIG = {
                    alias: "decorative_windmill_config"
                },
                e.GREENHOUSE_BUILDING_CONFIG = {
                    alias: "greenhouse_building_config"
                },
                e.LOOM_CONFIG = {
                    alias: "loom_config"
                },
                e.MARKET_CONFIG = {
                    alias: "market_config"
                },
                e.MUSEUM_CONFIG = {
                    alias: "museum_config"
                },
                e.SWEETS_CONFIG = {
                    alias: "sweets_config"
                },
                e.TOMATO_ON_WHEELS_CONFIG = {
                    alias: "tomato_on_wheels_config"
                },
                e.CAMERA_CONFIG = {
                    alias: "camera_config"
                },
                e.CRATE_CONTENT_CONFIG = {
                    alias: "crate_content_config"
                },
                e.CRATE_CONTENT_VALUABLE_SPAWN_CONFIG = {
                    alias: "crate_content_valuable_spawn_config"
                },
                e.CRATE_REGENERATION_CONFIG = {
                    alias: "crate_regeneration_config"
                },
                e.DISCOVERY_TAB_DATA = {
                    alias: "discovery_tab_data"
                },
                e.ENERGY_REGENERATION_CONFIG = {
                    alias: "energy_regeneration_config"
                },
                e.EXTRA_WORKER_CONFIG = {
                    alias: "extra_worker_config"
                },
                e.FAKE_AD_CONFIG = {
                    alias: "fake_ad_config"
                },
                e.FF_GREENHOUSE_REGENERATION_CONFIG = {
                    alias: "ff_greenhouse_regeneration_config"
                },
                e.FF_HARVEST_REGENERATION_CONFIG = {
                    alias: "ff_harvest_regeneration_config"
                },
                e.FF_NATURE_REMOVAL_CONFIG = {
                    alias: "ff_nature_removal_config"
                },
                e.FF_ORDERS_CONFIG = {
                    alias: "ff_orders_config"
                },
                e.HEAVY_OBJECT_OVERLAY_CONFIG = {
                    alias: "heavy_object_overlay_config"
                },
                e.INTERACTION_CONFIG = {
                    alias: "interaction_config"
                },
                e.INVITE_FRIENDS_REWARDS_CONFIG = {
                    alias: "invite_friends_rewards_config"
                },
                e.LOCALIZATION_FLAGS_CONFIG = {
                    alias: "localization_flags_config"
                },
                e.LUCKY_MERGE_CONFIG = {
                    alias: "lucky_merge_config"
                },
                e.MAP_AREAS = {
                    alias: "map_areas"
                },
                e.PREMIUM_AREAS = {
                    alias: "premium_areas"
                },
                e.REGENERATION_GAMEBOT_MESSENGER = {
                    alias: "regeneration_gamebot_messenger"
                },
                e.REWARDED_VIDEOS_CONFIG = {
                    alias: "rewarded_videos_config"
                },
                e.SHORTCUT_BONUS_CONFIG = {
                    alias: "shortcut_bonus_config"
                },
                e.SIGN_IN_BONUS_CONFIG = {
                    alias: "sign_in_bonus_config"
                },
                e.STORAGE_CONFIG = {
                    alias: "storage_config"
                },
                e.TRANSITION_SCREEN_ADS_CONFIG = {
                    alias: "transition_screen_ads_config"
                },
                e.VISIT_FARM_ACTIVITIES_AND_REWARDS = {
                    alias: "visit_farm_activities_and_rewards"
                },
                e.WORKERS_CONFIG = {
                    alias: "workers_config"
                },
                e.CONTROLLED_RANDOMNESS_COINS_CONFIG = {
                    alias: "controlled_randomness_coins_config"
                },
                e.CONTROLLED_RANDOMNESS_CRATE_CONFIG = {
                    alias: "controlled_randomness_crate_config"
                },
                e.CONTROLLED_RANDOMNESS_GEMS_CONFIG = {
                    alias: "controlled_randomness_gems_config"
                },
                e.CONTROLLED_RANDOMNESS_ITEM_TIER_CONFIG = {
                    alias: "controlled_randomness_item_tier_config"
                },
                e.CONTROLLED_RANDOMNESS_REWARD_CRATE_CONFIG = {
                    alias: "controlled_randomness_reward_crate_config"
                },
                e.CONTROLLED_RANDOMNESS_REWARD_CRATE_KEY_CONFIG = {
                    alias: "controlled_randomness_reward_crate_key_config"
                },
                e.NPC_PLAYERS = {
                    alias: "npc_players"
                },
                e.ONBOARDING_DIALOGS = {
                    alias: "onboarding_dialogs"
                },
                e.PROGRESSION_PER_LEVEL = {
                    alias: "progression_per_level"
                },
                e.RECIPE_AVOCADO_EGG_BURGER = {
                    alias: "recipe_avocado_egg_burger"
                },
                e.RECIPE_AVOCADO_ON_TOAST = {
                    alias: "recipe_avocado_on_toast"
                },
                e.RECIPE_AVOCADO_TACO = {
                    alias: "recipe_avocado_taco"
                },
                e.RECIPE_AVOCADO_WRAP = {
                    alias: "recipe_avocado_wrap"
                },
                e.RECIPE_BREAD = {
                    alias: "recipe_bread"
                },
                e.RECIPE_BUTTER = {
                    alias: "recipe_butter"
                },
                e.RECIPE_CAPPUCCINO = {
                    alias: "recipe_cappuccino"
                },
                e.RECIPE_CARROT_BREAD = {
                    alias: "recipe_carrot_bread"
                },
                e.RECIPE_CARROT_CAKE = {
                    alias: "recipe_carrot_cake"
                },
                e.RECIPE_CARROTS = {
                    alias: "recipe_carrots"
                },
                e.RECIPE_CHEESE_POPCORN = {
                    alias: "recipe_cheese_popcorn"
                },
                e.RECIPE_CHEESE = {
                    alias: "recipe_cheese"
                },
                e.RECIPE_COFFEE_BEANS = {
                    alias: "recipe_coffee_beans"
                },
                e.RECIPE_CORN = {
                    alias: "recipe_corn"
                },
                e.RECIPE_EGGS = {
                    alias: "recipe_eggs"
                },
                e.RECIPE_ESPRESSO = {
                    alias: "recipe_espresso"
                },
                e.RECIPE_FLOUR = {
                    alias: "recipe_flour"
                },
                e.RECIPE_FUR_PURSE = {
                    alias: "recipe_fur_purse"
                },
                e.RECIPE_GOAT_CHEESE = {
                    alias: "recipe_goat_cheese"
                },
                e.RECIPE_GOAT_MILK = {
                    alias: "recipe_goat_milk"
                },
                e.RECIPE_GOAT_YOGHURT = {
                    alias: "recipe_goat_yoghurt"
                },
                e.RECIPE_GRILLED_BACON = {
                    alias: "recipe_grilled_bacon"
                },
                e.RECIPE_GRILLED_CORN = {
                    alias: "recipe_grilled_corn"
                },
                e.RECIPE_ICECREAM = {
                    alias: "recipe_icecream"
                },
                e.RECIPE_JACKET = {
                    alias: "recipe_jacket"
                },
                e.RECIPE_MILK = {
                    alias: "recipe_milk"
                },
                e.RECIPE_MINI_TOMATO_BURGER = {
                    alias: "recipe_mini_tomato_burger"
                },
                e.RECIPE_MUFFIN = {
                    alias: "recipe_muffin"
                },
                e.RECIPE_OMELET = {
                    alias: "recipe_omelet"
                },
                e.RECIPE_PANCAKES = {
                    alias: "recipe_pancakes"
                },
                e.RECIPE_PILLOW = {
                    alias: "recipe_pillow"
                },
                e.RECIPE_POPCORN = {
                    alias: "recipe_popcorn"
                },
                e.RECIPE_RAW_BACON = {
                    alias: "recipe_raw_bacon"
                },
                e.RECIPE_SOCKS = {
                    alias: "recipe_socks"
                },
                e.RECIPE_SOY_BEANS = {
                    alias: "recipe_soy_beans"
                },
                e.RECIPE_SOYSAUCE = {
                    alias: "recipe_soysauce"
                },
                e.RECIPE_STUFFED_TOMATOES = {
                    alias: "recipe_stuffed_tomatoes"
                },
                e.RECIPE_SUGAR = {
                    alias: "recipe_sugar"
                },
                e.RECIPE_SUNFLOWER_OIL = {
                    alias: "recipe_sunflower_oil"
                },
                e.RECIPE_TIRAMISU = {
                    alias: "recipe_tiramisu"
                },
                e.RECIPE_TOFU_BURGER = {
                    alias: "recipe_tofu_burger"
                },
                e.RECIPE_TOFU = {
                    alias: "recipe_tofu"
                },
                e.RECIPE_TOMATO_SALAD_ON_A_STICK = {
                    alias: "recipe_tomato_salad_on_a_stick"
                },
                e.RECIPE_TOMATO_SOUP = {
                    alias: "recipe_tomato_soup"
                },
                e.RECIPE_TROUSERS = {
                    alias: "recipe_trousers"
                },
                e.RECIPE_TRUFFLE_GRILLED_CHEESE_SANDWICH = {
                    alias: "recipe_truffle_grilled_cheese_sandwich"
                },
                e.RECIPE_TRUFFLEBALLS = {
                    alias: "recipe_truffleballs"
                },
                e.RECIPE_TRUFFLEPASTA = {
                    alias: "recipe_trufflepasta"
                },
                e.RECIPE_WOOL = {
                    alias: "recipe_wool"
                },
                e.RECIPES_INDEX = {
                    alias: "recipes_index"
                },
                e.RECIPE_GRILLED_SANDWICH = {
                    alias: "recipe_grilled_sandwich"
                },
                e.ITEM_PURCHASE_COSTS_CONFIG = {
                    alias: "item_purchase_costs_config"
                },
                e.MARKETPLACE_ITEMS_CONFIG = {
                    alias: "marketplace_items_config"
                },
                e.MARKETPLACE_SHOPS_CONFIG = {
                    alias: "marketplace_shops_config"
                },
                e.SPECIAL_OFFER_CONFIG = {
                    alias: "special_offer_config"
                },
                e.PREDEFINED_TASKS_CONFIG = {
                    alias: "predefined_tasks_config"
                },
                e.TASK_FACTORY_CONFIG = {
                    alias: "task_factory_config"
                },
                e.TASKS_CONFIG = {
                    alias: "tasks_config"
                },
                e.WORLD_TO_LIFE_ANIMATION_CHANCE_TO_SPAWN = {
                    alias: "world_to_life_animation_chance_to_spawn"
                },
                e.WORLD_TO_LIFE_ANIMATION_INCLUSION_RULES = {
                    alias: "world_to_life_animation_inclusion_rules"
                },
                e.WORLD_TO_LIFE_BUTTERFLIES_SETTINGS = {
                    alias: "world_to_life_butterflies_settings"
                },
                e.WORLD_TO_LIFE_DANDELION_SETTINGS = {
                    alias: "world_to_life_dandelion_settings"
                },
                e.WORLD_TO_LIFE_RAIN_SETTINGS = {
                    alias: "world_to_life_rain_settings"
                },
                e.WORLD_TO_LIFE_SETTINGS = {
                    alias: "world_to_life_settings"
                },
                e.WORLD_TO_LIFE_WIND_SETTINGS = {
                    alias: "world_to_life_wind_settings"
                },
                e
            }()
              , ce = (function() {
                function e() {}
                e.LOW = {
                    quality: "low"
                },
                e.MEDIUM = {
                    quality: "medium"
                },
                e.HIGH = {
                    quality: "high"
                }
            }(),
            function() {
                function e() {}
                return e.SAMPLE_ID = {
                    alias: "sample_id"
                },
                e.CURRENT_LANGUAGE = {
                    alias: "current_language"
                },
                e.DISCOVERY_POPUP_TAB_SHINY = {
                    alias: "discovery_popup_tab_shiny"
                },
                e.DISCOVERY_POPUP_TAB_PRODUCTS = {
                    alias: "discovery_popup_tab_products"
                },
                e.MERGE_BONUS = {
                    alias: "merge_bonus"
                },
                e.CRATES_TIMER = {
                    alias: "crates_timer"
                },
                e.CRATES_RV_TEXT = {
                    alias: "crates_rv_text"
                },
                e.NOT_ENOUGH_WORKERS = {
                    alias: "not_enough_workers"
                },
                e.NOT_ENOUGH_RESOURCES = {
                    alias: "not_enough_resources"
                },
                e.REMOVE_POPOUT_BUTTON = {
                    alias: "remove_popout_button"
                },
                e.REMOVE_POPOUT_HEADER = {
                    alias: "remove_popout_header"
                },
                e.TAP_TO_CONTINUE = {
                    alias: "tap_to_continue"
                },
                e.REWARDS = {
                    alias: "rewards"
                },
                e.LEVEL_UP_TEXT = {
                    alias: "level_up_text"
                },
                e.IN_PROGRESS = {
                    alias: "in_progress"
                },
                e.NOT_ENOUGH_SPACE = {
                    alias: "not_enough_space"
                },
                e.NOT_ENOUGH_SPACE_REWARDS = {
                    alias: "not_enough_space_rewards"
                },
                e.TAB_ORDERS = {
                    alias: "tab_orders"
                },
                e.TAB_INGREDIENTS = {
                    alias: "tab_ingredients"
                },
                e.REPAIR_BUTTON_TEXT = {
                    alias: "repair_button_text"
                },
                e.INSUFFICIENT_RESOURCES = {
                    alias: "insufficient_resources"
                },
                e.PURCHASE_LAND_BUTTON_TEXT = {
                    alias: "purchase_land_button_text"
                },
                e.PURCHASE_LAND_NOT_ENOUGH_RESOURCES_FLOATER = {
                    alias: "purchase_land_not_enough_resources_floater"
                },
                e.PURCHASE_LAND_POPOUT = {
                    alias: "purchase_land_popout"
                },
                e.MARKET = {
                    alias: "market"
                },
                e.BAKERY = {
                    alias: "bakery"
                },
                e.BAKERY_INTRODUCTION = {
                    alias: "bakery_introduction"
                },
                e.DAIRY = {
                    alias: "dairy"
                },
                e.DAIRY_INTRODUCTION = {
                    alias: "dairy_introduction"
                },
                e.BBQ = {
                    alias: "bbq"
                },
                e.BBQ_INTRODUCTION = {
                    alias: "bbq_introduction"
                },
                e.SWEETS = {
                    alias: "sweets"
                },
                e.SWEETS_INTRODUCTION = {
                    alias: "sweets_introduction"
                },
                e.LOOM = {
                    alias: "loom"
                },
                e.LOOM_INTRODUCTION = {
                    alias: "loom_introduction"
                },
                e.NOT_ENOUGH_SPACE_FOR_SPLITTING = {
                    alias: "not_enough_space_for_splitting"
                },
                e.TRAINSTATION = {
                    alias: "trainstation"
                },
                e.DESTINATION = {
                    alias: "destination"
                },
                e.CHANGE_DESTINATION = {
                    alias: "change_destination"
                },
                e.VISIT = {
                    alias: "visit"
                },
                e.CONFIRM = {
                    alias: "confirm"
                },
                e.ORDER_CLAIM = {
                    alias: "order_claim"
                },
                e.ORDER_MAKE = {
                    alias: "order_Make"
                },
                e.TRAVELING_TO_HEADER = {
                    alias: "traveling_to_header"
                },
                e.HEAVY_OBJECT_TITLE = {
                    alias: "heavy_object_title"
                },
                e.HEAVY_OBJECT_BUTTON = {
                    alias: "heavy_object_button"
                },
                e.HEAVY_OBJECT_CUSTOM_SHARE_MESSAGE = {
                    alias: "heavy_object_custom_share_message"
                },
                e.HEAVY_OBJECT_CUSTOM_CTA = {
                    alias: "heavy_object_custom_cta"
                },
                e.INVITE_ACCEPTED_CUSTOM_MESSAGE = {
                    alias: "invite_accepted_custom_message"
                },
                e.CREATES_FOR_FRIENDS_HEADER = {
                    alias: "creates_for_friends_header"
                },
                e.CRATES_FOR_FRIENDS_SUBHEADER = {
                    alias: "crates_for_friends_subheader"
                },
                e.CRATES_FOR_FRIENDS_BUTTON = {
                    alias: "crates_for_friends_button"
                },
                e.CRATES_FOR_FRIENDS_DESCRIPTION = {
                    alias: "crates_for_friends_description"
                },
                e.CREATES_FOR_FRIENDS_CUSTOM_SHARE_MESSAGE = {
                    alias: "creates_for_friends_custom_share_message"
                },
                e.CREATES_FOR_FRIENDS_TOAST_MESSAGE = {
                    alias: "creates_for_friends_toast_message"
                },
                e.CUSTOM_SHARE_CTA = {
                    alias: "custom_share_cta"
                },
                e.CD_POPOUT_NATURE_TITLE = {
                    alias: "cd_popout_nature_title"
                },
                e.CD_POPOUT_REGENERATION_TITLE = {
                    alias: "cd_popout_regeneration_title"
                },
                e.CD_POPOUT_BUTTON_COMPLETE = {
                    alias: "cd_popout_button_complete"
                },
                e.RETURN_BUTTON = {
                    alias: "return_button"
                },
                e.CHEAT_POPUP = {
                    alias: "cheat_popup"
                },
                e.SETTINGS_POPUP = {
                    alias: "settings_popup"
                },
                e.SOUND_ON = {
                    alias: "sound_on"
                },
                e.SOUND_OFF = {
                    alias: "sound_off"
                },
                e.SETTINGS_SOUNDS = {
                    alias: "settings_sounds"
                },
                e.SETTINGS_MUSIC = {
                    alias: "settings_music"
                },
                e.TERMS_OF_SERVICE = {
                    alias: "terms_of_service"
                },
                e.PRIVACY_POLICY = {
                    alias: "privacy_policy"
                },
                e.PLAYER_ID = {
                    alias: "player_id"
                },
                e.GAME_VERSION = {
                    alias: "game_version"
                },
                e.COOLGAMES = {
                    alias: "coolgames"
                },
                e.VISIT_FRIENDS_SUMMARY_HEADER = {
                    alias: "visit_friends_summary_header"
                },
                e.VISIT_FRIENDS_SUMMARY_DESTINATION = {
                    alias: "visit_friends_summary_destination"
                },
                e.VISIT_FRIENDS_SUMMARY_COLLECT_BUTTON = {
                    alias: "visit_friends_summary_collect_button"
                },
                e.VISIT_FRIENDS_SUMMARY_X2 = {
                    alias: "visit_friends_summary_x2"
                },
                e.HELP_HEAVY_OBJECT_TITLE = {
                    alias: "help_heavy_object_title"
                },
                e.HELP_HEAVY_OBJECT_BODY = {
                    alias: "help_heavy_object_body"
                },
                e.VISIT_BY_FRIEND_TOAST_DESCRIPTION = {
                    alias: "visit_by_friend_toast_description"
                },
                e.LAST_VISITED = {
                    alias: "last_visited"
                },
                e.NEVER_VISITED = {
                    alias: "never_visited"
                },
                e.VISITING_FRIEND_HEADER_TEXT = {
                    alias: "visiting_friend_header_text"
                },
                e.GAMEBOT_CRATES_REFILL_MESSAGE = {
                    alias: "gamebot_crates_refill_message"
                },
                e.GAMEBOT_ENERGY_REFILL_MESSAGE = {
                    alias: "gamebot_energy_refill_message"
                },
                e.GAMEBOT_CRATES_ENERGY_REFILL_CTA = {
                    alias: "gamebot_crates_energy_refill_cta"
                },
                e.GAMEBOT_ORDER_MESSAGE = {
                    alias: "gamebot_order_message"
                },
                e.GAMEBOT_ORDER_CTA = {
                    alias: "gamebot_order_cta"
                },
                e.GAMEBOT_READY_FOR_HARVEST_MESSAGE = {
                    alias: "gamebot_ready_for_harvest_message"
                },
                e.GAMEBOT_READY_FOR_HARVEST_CTA = {
                    alias: "gamebot_ready_for_harvest_cta"
                },
                e.MARKET_PLACE_POPUP_HEADER = {
                    alias: "market_place_popup_header"
                },
                e.MARKET_ENERGY_ADVANCED = {
                    alias: "market_energy_advanced"
                },
                e.MARKET_ENERGY_BONUS = {
                    alias: "market_energy_bonus"
                },
                e.MARKET_BUTTON_TEXT = {
                    alias: "market_button_text"
                },
                e.MARKET_ENERGY_SHOP_HEADER = {
                    alias: "market_energy_shop_header"
                },
                e.MARKET_GEM_SHOP_HEADER = {
                    alias: "market_gem_shop_header"
                },
                e.MARKET_GEM_BONUS = {
                    alias: "market_gem_bonus"
                },
                e.MARKET_FREE_TEXT = {
                    alias: "market_free_text"
                },
                e.MARKET_WATCH_TEXT = {
                    alias: "market_watch_text"
                },
                e.CARROT = {
                    alias: "carrot"
                },
                e.CHICKEN = {
                    alias: "chicken"
                },
                e.COIN = {
                    alias: "coin"
                },
                e.GEM = {
                    alias: "gem"
                },
                e.CORN = {
                    alias: "corn"
                },
                e.COW = {
                    alias: "cow"
                },
                e.GOAT = {
                    alias: "goat"
                },
                e.PIG = {
                    alias: "pig"
                },
                e.SHEEP = {
                    alias: "sheep"
                },
                e.SOYBEANS = {
                    alias: "soybeans"
                },
                e.SUGARCANE = {
                    alias: "sugarcane"
                },
                e.SUNFLOWER = {
                    alias: "sunflower"
                },
                e.WHEAT = {
                    alias: "wheat"
                },
                e.CARROT_BREAD = {
                    alias: "carrot_bread"
                },
                e.LOOM_SOCKS_LV1 = {
                    alias: "loom_socks_lv1"
                },
                e.RECIPE_BREAD = {
                    alias: "recipe_bread"
                },
                e.RECIPE_BUTTER = {
                    alias: "recipe_butter"
                },
                e.RECIPE_CARROT_BREAD = {
                    alias: "recipe_carrot_bread"
                },
                e.RECIPE_CARROT_CAKE = {
                    alias: "recipe_carrot_cake"
                },
                e.RECIPE_CARROTS = {
                    alias: "recipe_carrots"
                },
                e.RECIPE_CHEESE_POPCORN = {
                    alias: "recipe_cheese_popcorn"
                },
                e.RECIPE_CHEESE = {
                    alias: "recipe_cheese"
                },
                e.RECIPE_EGGS = {
                    alias: "recipe_eggs"
                },
                e.RECIPE_FLOUR = {
                    alias: "recipe_flour"
                },
                e.RECIPE_GOAT_CHEESE = {
                    alias: "recipe_goat_cheese"
                },
                e.RECIPE_GOAT_MILK = {
                    alias: "recipe_goat_milk"
                },
                e.RECIPE_GOAT_YOGHURT = {
                    alias: "recipe_goat_yoghurt"
                },
                e.RECIPE_GRILLED_BACON = {
                    alias: "recipe_grilled_bacon"
                },
                e.RECIPE_GRILLED_CORN = {
                    alias: "recipe_grilled_corn"
                },
                e.RECIPE_GRILLED_SANDWICH = {
                    alias: "recipe_grilled_sandwich"
                },
                e.RECIPE_ICECREAM = {
                    alias: "recipe_icecream"
                },
                e.RECIPE_JACKET = {
                    alias: "recipe_jacket"
                },
                e.RECIPE_MILK = {
                    alias: "recipe_milk"
                },
                e.RECIPE_MUFFIN = {
                    alias: "recipe_muffin"
                },
                e.RECIPE_OMELET = {
                    alias: "recipe_omelet"
                },
                e.RECIPE_PANCAKES = {
                    alias: "recipe_pancakes"
                },
                e.RECIPE_POPCORN = {
                    alias: "recipe_popcorn"
                },
                e.RECIPE_RAW_BACON = {
                    alias: "recipe_raw_bacon"
                },
                e.RECIPE_SOCKS = {
                    alias: "recipe_socks"
                },
                e.RECIPE_SOYSAUCE = {
                    alias: "recipe_soysauce"
                },
                e.RECIPE_SUGAR = {
                    alias: "recipe_sugar"
                },
                e.RECIPE_SUNFLOWER_OIL = {
                    alias: "recipe_sunflower_oil"
                },
                e.RECIPE_TOFU = {
                    alias: "recipe_tofu"
                },
                e.RECIPE_TOFU_BURGER = {
                    alias: "recipe_tofu_burger"
                },
                e.RECIPE_TROUSERS = {
                    alias: "recipe_trousers"
                },
                e.RECIPE_WOOL = {
                    alias: "recipe_wool"
                },
                e.RECIPE = {
                    alias: "recipe"
                },
                e.CROP = {
                    alias: "crop"
                },
                e.ANIMAL = {
                    alias: "animal"
                },
                e.REFILLED = {
                    alias: "refilled"
                },
                e.ENERGY = {
                    alias: "energy"
                },
                e.CRATES = {
                    alias: "crates"
                },
                e.COINS = {
                    alias: "coins"
                },
                e.GEMS = {
                    alias: "gems"
                },
                e.TICKETS = {
                    alias: "tickets"
                },
                e.EXP = {
                    alias: "exp"
                },
                e.TREES = {
                    alias: "trees"
                },
                e.ROCKS = {
                    alias: "rocks"
                },
                e.CUSTOM_UPDATE_FRIEND_VISIT_TITLE = {
                    alias: "custom_update_friend_visit_title"
                },
                e.CUSTOM_UPDATE_FRIEND_VISIT_CTA = {
                    alias: "custom_update_friend_visit_cta"
                },
                e.SHOVEL_POPUP_HEADER = {
                    alias: "shovel_popup_header"
                },
                e.SHOVEL_POPUP_INFO = {
                    alias: "shovel_popup_info"
                },
                e.SHOVEL_POPUP_REMOVE_HEADER = {
                    alias: "shovel_popup_remove_header"
                },
                e.SHOVEL_POPUP_REMOVE = {
                    alias: "shovel_popup_remove"
                },
                e.BUTTON_OK = {
                    alias: "button_ok"
                },
                e.BUTTON_YES = {
                    alias: "button_yes"
                },
                e.BUTTON_NO = {
                    alias: "button_no"
                },
                e.ONBOARDING_DIALOG_1_1_NPC = {
                    alias: "onboarding_dialog_1_1_npc"
                },
                e.ONBOARDING_DIALOG_2_1_NPC = {
                    alias: "onboarding_dialog_2_1_npc"
                },
                e.ONBOARDING_DIALOG_2_2_NPC = {
                    alias: "onboarding_dialog_2_2_npc"
                },
                e.ONBOARDING_DIALOG_2_3_NPC = {
                    alias: "onboarding_dialog_2_3_npc"
                },
                e.ONBOARDING_DIALOG_2_4_NPC = {
                    alias: "onboarding_dialog_2_4_npc"
                },
                e.ONBOARDING_DIALOG_4_1_NPC = {
                    alias: "onboarding_dialog_4_1_npc"
                },
                e.ONBOARDING_DIALOG_5_1_NPC = {
                    alias: "onboarding_dialog_5_1_npc"
                },
                e.ONBOARDING_DIALOG_5_5_NPC = {
                    alias: "onboarding_dialog_5_5_npc"
                },
                e.ONBOARDING_DIALOG_6_1_NPC = {
                    alias: "onboarding_dialog_6_1_npc"
                },
                e.ONBOARDING_DIALOG_7_1_NPC = {
                    alias: "onboarding_dialog_7_1_npc"
                },
                e.ONBOARDING_DIALOG_8_1_NPC = {
                    alias: "onboarding_dialog_8_1_npc"
                },
                e.ONBOARDING_DIALOG_8_3_NPC = {
                    alias: "onboarding_dialog_8_3_npc"
                },
                e.ONBOARDING_DIALOG_10_1_NPC = {
                    alias: "onboarding_dialog_10_1_npc"
                },
                e.ONBOARDING_DIALOG_11_1_NPC = {
                    alias: "onboarding_dialog_11_1_npc"
                },
                e.ONBOARDING_DIALOG_11_2_NPC = {
                    alias: "onboarding_dialog_11_2_npc"
                },
                e.ONBOARDING_DIALOG_12_1_NPC = {
                    alias: "onboarding_dialog_12_1_npc"
                },
                e.ONBOARDING_DIALOG_12_3_NPC = {
                    alias: "onboarding_dialog_12_3_npc"
                },
                e.ONBOARDING_DIALOG_12_5_NPC = {
                    alias: "onboarding_dialog_12_5_npc"
                },
                e.ONBOARDING_DIALOG_12_6_NPC = {
                    alias: "onboarding_dialog_12_6_npc"
                },
                e.ONBOARDING_DIALOG_13_1_NPC = {
                    alias: "onboarding_dialog_13_1_npc"
                },
                e.ONBOARDING_DIALOG_13_2_NPC = {
                    alias: "onboarding_dialog_13_2_npc"
                },
                e.ONBOARDING_DIALOG_13_3_NPC = {
                    alias: "onboarding_dialog_13_3_npc"
                },
                e.DISCONNECTION_NO_CONNECTION = {
                    alias: "disconnection_no_connection"
                },
                e.DISCONNECTION_TEXT = {
                    alias: "disconnection_text"
                },
                e.CLOSE = {
                    alias: "close"
                },
                e.DISCONNECTION_OVERLAY_TEXT = {
                    alias: "disconnection_overlay_text"
                },
                e.DISCONNECTION_OVERLAY_SUBTEXT = {
                    alias: "disconnection_overlay_subtext"
                },
                e.REPAIRED_MESSAGE = {
                    alias: "repaired_message"
                },
                e.NPC_NAME_1 = {
                    alias: "npc_name_1"
                },
                e.MERGE_2_TOOLTIP = {
                    alias: "merge_2_tooltip"
                },
                e.REQUIREMENTS = {
                    alias: "requirements"
                },
                e.ONBOARDING_POPUP_HEADER = {
                    alias: "onboarding_popup_header"
                },
                e.ONBOARDING_MERGE_INFO = {
                    alias: "onboarding_merge_info"
                },
                e.ONBOARDING_REGENERATION_INFO = {
                    alias: "onboarding_regeneration_info"
                },
                e.ONBOARDING_REGENERATION_TIMER = {
                    alias: "onboarding_regeneration_timer"
                },
                e.ACTIVITY_PREPARE_ORDER_NEW = {
                    alias: "activity_prepare_order_new"
                },
                e.ACTIVITY_PREPARE_ORDER_STARTABLE = {
                    alias: "activity_prepare_order_startable"
                },
                e.ACTIVITY_PREPARE_ORDER_PROGRESS = {
                    alias: "activity_prepare_order_progress"
                },
                e.ACTIVITY_CLAIM_ORDER_COMPLETE = {
                    alias: "activity_claim_order_complete"
                },
                e.ACTIVITY_REPAIR_BUILDING_REPAIRABLE = {
                    alias: "activity_repair_building_repairable"
                },
                e.DISCOVERY_POPUP_HEADER = {
                    alias: "discovery_popup_header"
                },
                e.DISCOVERY_POPUP_TAB_CROPS = {
                    alias: "discovery_popup_tab_crops"
                },
                e.DISCOVERY_POPUP_TAB_ANIMALS = {
                    alias: "discovery_popup_tab_animals"
                },
                e.DISCOVERY_POPUP_TAB_RECIPES = {
                    alias: "discovery_popup_tab_recipes"
                },
                e.DISCOVERY_POPUP_TAB_REWARDS = {
                    alias: "discovery_popup_tab_rewards"
                },
                e.DISCOVERY_POPUP_TAB_NATURE = {
                    alias: "discovery_popup_tab_nature"
                },
                e.DISCOVERY_POPUP_TAB_BUILDINGS = {
                    alias: "discovery_popup_tab_buildings"
                },
                e.DISCOVERY_POPUP_PRODUCT_TEXT = {
                    alias: "discovery_popup_product_text"
                },
                e.DISCOVERY_POPUP_BROKEN_TEXT = {
                    alias: "discovery_popup_broken_text"
                },
                e.DISCOVERY_POPUP_REPAIRED_TEXT = {
                    alias: "discovery_popup_repaired_text"
                },
                e.MARKETPLACE_GEM_HEADER = {
                    alias: "marketplace_gem_header"
                },
                e.MARKETPLACE_CRATE_HEADER = {
                    alias: "marketplace_crate_header"
                },
                e.MARKETPLACE_BEST_DEAL = {
                    alias: "marketplace_best_deal"
                },
                e.MARKETPLACE_RV_LEFT = {
                    alias: "marketplace_rv_left"
                },
                e.MARKETPLACE_CRATES_BANNER = {
                    alias: "marketplace_crates_banner"
                },
                e.MARKETPLACE_GEMS_BANNER = {
                    alias: "marketplace_gems_banner"
                },
                e.MARKETPLACE_ENERGY_BANNER = {
                    alias: "marketplace_energy_banner"
                },
                e.FAKE_AD_INTERSTITIAL = {
                    alias: "fake_ad_interstitial"
                },
                e.FAKE_AD_REWARD = {
                    alias: "fake_ad_reward"
                },
                e.CANCEL = {
                    alias: "cancel"
                },
                e.WOOD = {
                    alias: "wood"
                },
                e.STONE = {
                    alias: "stone"
                },
                e.ONBOARDING_REGENERATION_HEADER = {
                    alias: "onboarding_regeneration_header"
                },
                e.EGG = {
                    alias: "egg"
                },
                e.MILK = {
                    alias: "milk"
                },
                e.GOATMILK = {
                    alias: "goatmilk"
                },
                e.WOOL = {
                    alias: "wool"
                },
                e.BACON = {
                    alias: "bacon"
                },
                e.HEAVY_OBJECT_OVERLAY_TITLE = {
                    alias: "heavy_object_overlay_title"
                },
                e.HEAVY_OBJECT_OVERLAY_SUBTITLE = {
                    alias: "heavy_object_overlay_subtitle"
                },
                e.HEAVY_OBJECT_OVERLAY_EXPLANATION = {
                    alias: "heavy_object_overlay_explanation"
                },
                e.HEAVY_OBJECT_OVERLAY_CLOSE = {
                    alias: "heavy_object_overlay_close"
                },
                e.HEAVY_OBJECT_OVERLAY_INVITE_BUTTON = {
                    alias: "heavy_object_overlay_invite_button"
                },
                e.HEAVY_OBJECT_OVERLAY_FRIENDS_BUTTON = {
                    alias: "heavy_object_overlay_friends_button"
                },
                e.TOURNAMENT_POPUP_HEADER = {
                    alias: "tournament_popup_header"
                },
                e.TOURNAMENT_EARN_EXCLUSIVE_REWARDS = {
                    alias: "tournament_earn_exclusive_rewards"
                },
                e.TOURNAMENT_GUARANTEED_REWARD = {
                    alias: "tournament_guaranteed_reward"
                },
                e.TOURNAMENT_SHARED_AMONG_PLAYERS = {
                    alias: "tournament_shared_among_players"
                },
                e.TOURNAMENT_HOW_IT_WORKS = {
                    alias: "tournament_how_it_works"
                },
                e.TOURNAMENT_PLAY_EXPLANATION = {
                    alias: "tournament_play_explanation"
                },
                e.TOURNAMENT_SHARE_EXPLANATION = {
                    alias: "tournament_share_explanation"
                },
                e.TOURNAMENT_CLAIM_EXPLANATION = {
                    alias: "tournament_claim_explanation"
                },
                e.TOURNAMENT_START_BUTTON = {
                    alias: "tournament_start_button"
                },
                e.TOURNAMENT_TIMER = {
                    alias: "tournament_timer"
                },
                e.TOURNAMENT_END_RESULTS = {
                    alias: "tournament_end_results"
                },
                e.TOURNAMENT_PRIZE_POOL = {
                    alias: "tournament_prize_pool"
                },
                e.TOURNAMENT_INCREASE_PRIZE_POOL = {
                    alias: "tournament_increase_prize_pool"
                },
                e.TOURNAMENT_ENDED = {
                    alias: "tournament_ended"
                },
                e.TOURNAMENT_INVITE_BUTTON = {
                    alias: "tournament_invite_button"
                },
                e.TOURNAMENT_PLAY_BUTTON = {
                    alias: "tournament_play_button"
                },
                e.TOUNAMENT_CLAIM_BUTTON = {
                    alias: "tounament_claim_button"
                },
                e.TOURNAMENT_RETURN_BUTTON = {
                    alias: "tournament_return_button"
                },
                e.TOURNAMENT_ARE_YOU_SURE_INFO = {
                    alias: "tournament_are_you_sure_info"
                },
                e.TOURNAMENT_ARE_YOU_SURE_SCORE_LOST = {
                    alias: "tournament_are_you_sure_score_lost"
                },
                e.ONBOARDING_SKIP = {
                    alias: "onboarding_skip"
                },
                e.PREMIUM_LAND_TEXT = {
                    alias: "premium_land_text"
                },
                e.PREMIUM_LAND_BUTTON_TEXT = {
                    alias: "premium_land_button_text"
                },
                e.NATURE_TIMER_BUTTON = {
                    alias: "nature_timer_button"
                },
                e.TASK_ADDED_POPUP_TITLE = {
                    alias: "task_added_popup_title"
                },
                e.TASK_COMPLETE_POPUP_TITLE = {
                    alias: "task_complete_popup_title"
                },
                e.TASK_OVERVIEW_POPUP_TITLE = {
                    alias: "task_overview_popup_title"
                },
                e.TASK_SHOW_BUTTON = {
                    alias: "task_show_button"
                },
                e.TASK_COMPLETE_ORDER = {
                    alias: "task_complete_order"
                },
                e.TASK_MAKE_ITEM = {
                    alias: "task_make_item"
                },
                e.TASK_REMOVE_NATURE = {
                    alias: "task_remove_nature"
                },
                e.TASK_PURCHASE_LAND = {
                    alias: "task_purchase_land"
                },
                e.TASK_REPAIR_BUILDING = {
                    alias: "task_repair_building"
                },
                e.TASK_USE_ENERGY = {
                    alias: "task_use_energy"
                },
                e.TASK_OPEN_SUPPLIES = {
                    alias: "task_open_supplies"
                },
                e.TASK_MERGE_BONUS = {
                    alias: "task_merge_bonus"
                },
                e.TASK_COLLECT_ITEMS = {
                    alias: "task_collect_items"
                },
                e.EXTRA_WORKER_POPUP_HEADER = {
                    alias: "extra_worker_popup_header"
                },
                e.EXTRA_WORKER_POPUP_SUBTEXT = {
                    alias: "extra_worker_popup_subtext"
                },
                e.EXTRA_WORKER_POPUP_SUBTEXT_1_DAY = {
                    alias: "extra_worker_popup_subtext_1_day"
                },
                e.MISSING_INGREDIENTS_POPUP_HEADER = {
                    alias: "missing_ingredients_popup_header"
                },
                e.MISSING_INGREDIENTS_POPUP_MESSAGE = {
                    alias: "missing_ingredients_popup_message"
                },
                e.TRAINSTATION_INTRODUCTION = {
                    alias: "trainstation_introduction"
                },
                e.MUSEUM_INTRODUCTION = {
                    alias: "museum_introduction"
                },
                e.MUSEUM = {
                    alias: "museum"
                },
                e.MARKETPLACE_INTRODUCTION = {
                    alias: "marketplace_introduction"
                },
                e.MARKETPLACE = {
                    alias: "marketplace"
                },
                e.FEEDBACK_BOX_PLACEHOLDER = {
                    alias: "feedback_box_placeholder"
                },
                e.FEEDBACK_SUBMIT = {
                    alias: "feedback_submit"
                },
                e.FEEDBACK_HEADER_TEXT = {
                    alias: "feedback_header_text"
                },
                e.FEEDBACK_LABEL = {
                    alias: "feedback_label"
                },
                e.FEEDBACK_CATEGORY_HEADER = {
                    alias: "feedback_category_header"
                },
                e.FEEDBACK_CATEGORY_UNSELECTED = {
                    alias: "feedback_category_unselected"
                },
                e.FEEDBACK_CATEGORY_BUG = {
                    alias: "feedback_category_bug"
                },
                e.FEEDBACK_CATEGORY_SUGGESTION = {
                    alias: "feedback_category_suggestion"
                },
                e.FEEDBACK_CATEGORY_FEEDBACK = {
                    alias: "feedback_category_feedback"
                },
                e.FEEDBACK_CATEGORY_COMPLAINT = {
                    alias: "feedback_category_complaint"
                },
                e.FEEDBACK_FAILED_HEADER = {
                    alias: "feedback_failed_header"
                },
                e.FEEDBACK_FAILED_TEXT = {
                    alias: "feedback_failed_text"
                },
                e.FEEDBACK_SUCCES_HEADER = {
                    alias: "feedback_succes_header"
                },
                e.FEEDBACK_SUCCES_TEXT = {
                    alias: "feedback_succes_text"
                },
                e.VISIT_FRIENDS_SUMMARY_DOUBLE_REWARDS_BUTTON = {
                    alias: "visit_friends_summary_double_rewards_button"
                },
                e.WORKER_BUTTON_JOB_DONE = {
                    alias: "worker_button_job_done"
                },
                e.WORKER_BUTTON_AVAILABLE = {
                    alias: "worker_button_available"
                },
                e.WORKER_NO_WORK_AVAILABLE = {
                    alias: "worker_no_work_available"
                },
                e.TRAINSTATION_INCENTIVISE_GROUP_HEADER = {
                    alias: "trainstation_incentivise_group_header"
                },
                e.TRAINSTATION_INCENTIVISE_GROUP_SUBTEXT = {
                    alias: "trainstation_incentivise_group_subtext"
                },
                e.TRAINSTATION_INCENTIVISE_GROUP_BUTTON = {
                    alias: "trainstation_incentivise_group_button"
                },
                e.TASK_REPAIR_BUILDING_BAKERY = {
                    alias: "task_repair_building_bakery"
                },
                e.TASK_REPAIR_BUILDING_DAIRY = {
                    alias: "task_repair_building_dairy"
                },
                e.TASK_REPAIR_BUILDING_LOOM = {
                    alias: "task_repair_building_loom"
                },
                e.TASK_REPAIR_BUILDING_SWEETS = {
                    alias: "task_repair_building_sweets"
                },
                e.TASK_REPAIR_BUILDING_BBQ = {
                    alias: "task_repair_building_bbq"
                },
                e.REWARD_POPOUT_BUTTON_TEXT = {
                    alias: "reward_popout_button_text"
                },
                e.REWARD_POPOUT_HEADER_TEXT = {
                    alias: "reward_popout_header_text"
                },
                e.REWARD_POPOUT_TITLE_BRONZE = {
                    alias: "reward_popout_title_bronze"
                },
                e.REWARD_POPOUT_TITLE_SILVER = {
                    alias: "reward_popout_title_silver"
                },
                e.REWARD_POPOUT_TITLE_GOLD = {
                    alias: "reward_popout_title_gold"
                },
                e.KEYS = {
                    alias: "keys"
                },
                e.ARE_YOU_STILL_THERE_HEADER = {
                    alias: "are_you_still_there_header"
                },
                e.ARE_YOU_STILL_THERE_TEXT = {
                    alias: "are_you_still_there_text"
                },
                e.TOURNAMENT_ARE_YOU_SURE_HEADER = {
                    alias: "tournament_are_you_sure_header"
                },
                e.COMMUNITY_GIFT_HEADER = {
                    alias: "community_gift_header"
                },
                e.COMMUNITY_GIFT_THANKS = {
                    alias: "community_gift_thanks"
                },
                e.COMMUNITY_GIFT_REWARDS = {
                    alias: "community_gift_rewards"
                },
                e.COMMUNITY_GIFT_ERROR_HEADER = {
                    alias: "community_gift_error_header"
                },
                e.COMMUNITY_GIFT_INVALID_LINK = {
                    alias: "community_gift_invalid_link"
                },
                e.PREMIUM_LAND_HEADER_TEXT = {
                    alias: "premium_land_header_text"
                },
                e.PREMIUM_LAND_SPECIAL_OFFER = {
                    alias: "premium_land_special_offer"
                },
                e.REWARD_CHESTS = {
                    alias: "reward_chests"
                },
                e.ONBOARDING_DECORATIVE_OBJECT_HEADER = {
                    alias: "onboarding_decorative_object_header"
                },
                e.ONBOARDING_DECORATIVE_OBJECT_STEP_1 = {
                    alias: "onboarding_decorative_object_step_1"
                },
                e.ONBOARDING_DECORATIVE_OBJECT_STEP_2 = {
                    alias: "onboarding_decorative_object_step_2"
                },
                e.ONBOARDING_DECORATIVE_OBJECT_STEP_3 = {
                    alias: "onboarding_decorative_object_step_3"
                },
                e.ONBOARDING_DECORATIVE_OBJECT_SUBTEXT = {
                    alias: "onboarding_decorative_object_subtext"
                },
                e.DECORATIVE_OBJECT_INTRODUCTION = {
                    alias: "decorative_object_introduction"
                },
                e.DECORATIVE_TOILET_NAME = {
                    alias: "decorative_toilet_name"
                },
                e.DECORATIVE_WINDMILL_NAME = {
                    alias: "decorative_windmill_name"
                },
                e.DECORATIVE_CHICKENCOOP_NAME = {
                    alias: "decorative_chickencoop_name"
                },
                e.TOOLBOXES = {
                    alias: "toolboxes"
                },
                e.TOOLS = {
                    alias: "tools"
                },
                e.TASK_REPAIR_DECORATION_TOILET = {
                    alias: "task_repair_decoration_toilet"
                },
                e.TASK_REPAIR_DECORATION_CHICKENCOOP = {
                    alias: "task_repair_decoration_chickencoop"
                },
                e.TASK_REPAIR_DECORATION_WINDMILL = {
                    alias: "task_repair_decoration_windmill"
                },
                e.TOOLBOX_POPOUT_HEADER_TEXT = {
                    alias: "toolbox_popout_header_text"
                },
                e.TOOLBOX_POPOUT_BUTTON_TEXT = {
                    alias: "toolbox_popout_button_text"
                },
                e.HEAVY_OBJECT_OVERLAY_GEM_BUTTON_TEXT = {
                    alias: "heavy_object_overlay_gem_button_text"
                },
                e.HEAVY_OBJECT_OVERLAY_SUBTEXT = {
                    alias: "heavy_object_overlay_subtext"
                },
                e.ONBOARDING_REWARD_CRATES_HEADER = {
                    alias: "onboarding_reward_crates_header"
                },
                e.ONBOARDING_REWARD_CRATES_STEP_1 = {
                    alias: "onboarding_reward_crates_step_1"
                },
                e.ONBOARDING_REWARD_CRATES_STEP_2 = {
                    alias: "onboarding_reward_crates_step_2"
                },
                e.ONBOARDING_REWARD_CRATES_STEP_3 = {
                    alias: "onboarding_reward_crates_step_3"
                },
                e.ONBOARDING_REWARD_CRATES_SUBTEXT = {
                    alias: "onboarding_reward_crates_subtext"
                },
                e.DISCONNECTION_DEVICE_HEADER = {
                    alias: "disconnection_device_header"
                },
                e.DISCONNECTION_DEVICE_TEXT = {
                    alias: "disconnection_device_text"
                },
                e.DISCONNECTION_DEVICE_BUTTON = {
                    alias: "disconnection_device_button"
                },
                e.HEAVY_OBJECT_OVERLAY_REMOVE = {
                    alias: "heavy_object_overlay_remove"
                },
                e.FREEBIEOFFER_HEADER = {
                    alias: "freebieOffer_header"
                },
                e.FREEBIEOFFER_BODY = {
                    alias: "freebieOffer_body"
                },
                e.FREEBIEOFFER_2XVALUE = {
                    alias: "freebieOffer_2xValue"
                },
                e.UPGRADE_FOUND = {
                    alias: "upgrade_found"
                },
                e.UPGRADE_BUTTON_ACTIVATE = {
                    alias: "upgrade_button_activate"
                },
                e.UPGRADE_FOR_MORE_INGREDIENTS = {
                    alias: "upgrade_for_more_ingredients"
                },
                e.UPGRADE_BUTTON_OWNED = {
                    alias: "upgrade_button_owned"
                },
                e.UPGRADE = {
                    alias: "upgrade"
                },
                e.UPGRADE_SUCCESFUL = {
                    alias: "upgrade_succesful"
                },
                e.UPGRADE_SUCCESFUL_BODY = {
                    alias: "upgrade_succesful_body"
                },
                e.UPGRADE_ONBOARDING_HEADER = {
                    alias: "upgrade_onboarding_header"
                },
                e.UPGRADE_ONBOARDING_STEP_1 = {
                    alias: "upgrade_onboarding_step_1"
                },
                e.UPGRADE_ONBOARDING_STEP_2 = {
                    alias: "upgrade_onboarding_step_2"
                },
                e.UPGRADE_ONBOARDING_STEP_3 = {
                    alias: "upgrade_onboarding_step_3"
                },
                e.UPGRADE_ONBOARDING_SUBTEXT = {
                    alias: "upgrade_onboarding_subtext"
                },
                e.BUTTON_UNAVAILABLE = {
                    alias: "button_unavailable"
                },
                e.FEEDBACK_CATEGORY_PROBLEM_WITH = {
                    alias: "feedback_category_problem_with"
                },
                e.FEEDBACK_CATEGORY_PURCHASES = {
                    alias: "feedback_category_purchases"
                },
                e.FEEDBACK_CATEGORY_LOSING_PROGRESS = {
                    alias: "feedback_category_losing_progress"
                },
                e.FEEDBACK_CATEGORY_DISAPPEARING_ITEMS = {
                    alias: "feedback_category_disappearing_items"
                },
                e.FEEDBACK_CATEGORY_VISITING_FRIENDS = {
                    alias: "feedback_category_visiting_friends"
                },
                e.FEEDBACK_CATEGORY_REMOVING_HEAVY_OBJECTS = {
                    alias: "feedback_category_removing_heavy_objects"
                },
                e.FEEDBACK_CATEGORY_KEYS_CHESTS = {
                    alias: "feedback_category_keys_chests"
                },
                e.FEEDBACK_CATEGORY_EXTRA_WORKERS = {
                    alias: "feedback_category_extra_workers"
                },
                e.FEEDBACK_CATEGORY_GAME_LOADING = {
                    alias: "feedback_category_game_loading"
                },
                e.FEEDBACK_CATEGORY_SOMETHING_ELSE = {
                    alias: "feedback_category_something_else"
                },
                e.RESOURCE_COINS = {
                    alias: "resource_coins"
                },
                e.RESOURCE_GEMS = {
                    alias: "resource_gems"
                },
                e.RESOURCE_TOOLS = {
                    alias: "resource_tools"
                },
                e.RESOURCE_STONE = {
                    alias: "resource_stone"
                },
                e.RESOURCE_WOOD = {
                    alias: "resource_wood"
                },
                e.FLOWERS = {
                    alias: "flowers"
                },
                e.GREENHOUSE = {
                    alias: "greenhouse"
                },
                e.FLOWERS_ONBOARDING_STEP_1 = {
                    alias: "flowers_onboarding_step_1"
                },
                e.FLOWERS_ONBOARDING_STEP_2 = {
                    alias: "flowers_onboarding_step_2"
                },
                e.FLOWERS_ONBOARDING_STEP_3 = {
                    alias: "flowers_onboarding_step_3"
                },
                e.FLOWERS_ONBOARDING_SUBTEXT = {
                    alias: "flowers_onboarding_subtext"
                },
                e.GREENHOUSE_INTRODUCTION_HEADER = {
                    alias: "greenhouse_introduction_header"
                },
                e.GREENHOUSE_INTRODUCTION_TEXT = {
                    alias: "greenhouse_introduction_text"
                },
                e.GREENHOUSE_MERGE_CHAIN_HEADER = {
                    alias: "greenhouse_merge_chain_header"
                },
                e.GREENHOUSE_MERGE_CHAIN_SUBTEXT_FLOWERS = {
                    alias: "greenhouse_merge_chain_subtext_flowers"
                },
                e.GREENHOUSE_MERGE_CHAIN_SUBTEXT_REWARDS = {
                    alias: "greenhouse_merge_chain_subtext_rewards"
                },
                e.DEER = {
                    alias: "deer"
                },
                e.COFFEEPLANT = {
                    alias: "coffeeplant"
                },
                e.COFFEEBEANS = {
                    alias: "coffeebeans"
                },
                e.FUR = {
                    alias: "fur"
                },
                e.RECIPE_ESPRESSO = {
                    alias: "recipe_espresso"
                },
                e.RECIPE_CAPPUCCINO = {
                    alias: "recipe_cappuccino"
                },
                e.RECIPE_TIRAMISU = {
                    alias: "recipe_tiramisu"
                },
                e.RECIPE_PILLOW = {
                    alias: "recipe_pillow"
                },
                e.RECIPE_FUR_PURSE = {
                    alias: "recipe_fur_purse"
                },
                e.RECIPE_COFFEE_BEANS = {
                    alias: "recipe_coffee_beans"
                },
                e.RECIPE_SOY_BEANS = {
                    alias: "recipe_soy_beans"
                },
                e.RECIPE_CORN = {
                    alias: "recipe_corn"
                },
                e.BARISTA = {
                    alias: "barista"
                },
                e.BARISTA_INTRODUCTION = {
                    alias: "barista_introduction"
                },
                e.TASK_REPAIR_BUILDING_BARISTA = {
                    alias: "task_repair_building_barista"
                },
                e.COFFEE = {
                    alias: "coffee"
                },
                e.GREENHOUSE_DISCOVERY_TITLE_TOP = {
                    alias: "greenhouse_discovery_title_top"
                },
                e.GREENHOUSE_DISCOVERY_TITLE_BOTTOM = {
                    alias: "greenhouse_discovery_title_bottom"
                },
                e.GREENHOUSE_DISCOVERY_BODY_TOP = {
                    alias: "greenhouse_discovery_body_top"
                },
                e.GREENHOUSE_DISCOVERY_BODY_BOTTOM = {
                    alias: "greenhouse_discovery_body_bottom"
                },
                e.RATING_GAME_POPUP_HEADER = {
                    alias: "rating_game_popup_header"
                },
                e.RATING_GAME_POPUP_PASS = {
                    alias: "rating_game_popup_pass"
                },
                e.RATING_GAME_POPUP_BAD = {
                    alias: "rating_game_popup_bad"
                },
                e.RATING_GAME_POPUP_NEUTRAL = {
                    alias: "rating_game_popup_neutral"
                },
                e.RATING_GAME_POPUP_GOOD = {
                    alias: "rating_game_popup_good"
                },
                e.RATING_GAME_POPUP_CLOSED = {
                    alias: "rating_game_popup_closed"
                },
                e.RATING_GAME_ASK_WHY = {
                    alias: "rating_game_ask_why"
                },
                e.SIGNIN_BONUS_POPUP_HEADER = {
                    alias: "signin_bonus_popup_header"
                },
                e.SIGNIN_BONUS_POPUP_BODY = {
                    alias: "signin_bonus_popup_body"
                },
                e.SIGNIN_BONUS_POPUP_WARNING = {
                    alias: "signin_bonus_popup_warning"
                },
                e.SIGNIN_BONUS_POPUP_BUTTON = {
                    alias: "signin_bonus_popup_button"
                },
                e.SIGNIN_BONUS_SUCCESSFUL_HEADER = {
                    alias: "signin_bonus_successful_header"
                },
                e.SIGNIN_BONUS_SUCCESSFUL_BODY = {
                    alias: "signin_bonus_successful_body"
                },
                e.SIGNIN_BONUS_SUCCESSFUL_REWARDS = {
                    alias: "signin_bonus_successful_rewards"
                },
                e.SIGNIN_BONUS_SUCCESSFUL_BUTTON = {
                    alias: "signin_bonus_successful_button"
                },
                e.SHORTCUT_BONUS_INCENTIVE_HEADER = {
                    alias: "shortcut_bonus_incentive_header"
                },
                e.SHORTCUT_BONUS_INCENTIVE_BODY = {
                    alias: "shortcut_bonus_incentive_body"
                },
                e.SHORTCUT_BONUS_INCENTIVE_BUTTON = {
                    alias: "shortcut_bonus_incentive_button"
                },
                e.SHORTCUT_BONUS_SUCCESSFUL_HEADER = {
                    alias: "shortcut_bonus_successful_header"
                },
                e.SHORTCUT_BONUS_SUCCESSFUL_BODY = {
                    alias: "shortcut_bonus_successful_body"
                },
                e.SHORTCUT_BONUS_SUCCESSFUL_REWARDS = {
                    alias: "shortcut_bonus_successful_rewards"
                },
                e.SHORTCUT_BONUS_SUCCESSFUL_BUTTON = {
                    alias: "shortcut_bonus_successful_button"
                },
                e.NPC_NAME_2 = {
                    alias: "npc_name_2"
                },
                e.TASK_REPAIR_MUSEUM = {
                    alias: "task_repair_museum"
                },
                e.LUCKY_MERGE = {
                    alias: "lucky_merge"
                },
                e.CONSENT_TEXT_MAIN = {
                    alias: "consent_text_main"
                },
                e.CONSENT_TEXT_ADDITIONAL = {
                    alias: "consent_text_additional"
                },
                e.CONSENT_ACCEPT_BUTTON = {
                    alias: "consent_accept_button"
                },
                e.CONSENT_REJECT_BUTTON = {
                    alias: "consent_reject_button"
                },
                e.EVENT_TIMER_DAYS_REMAINING_1 = {
                    alias: "event_timer_days_remaining_1"
                },
                e.EVENT_TIMER_DAYS_REMAINING_2 = {
                    alias: "event_timer_days_remaining_2"
                },
                e.EVENT_TIMER_DAYS_REMAINING_3 = {
                    alias: "event_timer_days_remaining_3"
                },
                e.EVENT_TIMER_DAYS_REMAINING_4 = {
                    alias: "event_timer_days_remaining_4"
                },
                e.EVENT_TIMER_DAYS_REMAINING_5 = {
                    alias: "event_timer_days_remaining_5"
                },
                e.EVENT_TIMER_DAYS_REMAINING_6 = {
                    alias: "event_timer_days_remaining_6"
                },
                e.EVENT_TIMER_DAYS_REMAINING_7 = {
                    alias: "event_timer_days_remaining_7"
                },
                e.EVENT_TIMER_DAYS_REMAINING_8 = {
                    alias: "event_timer_days_remaining_8"
                },
                e.EVENT_TIMER_DAYS_REMAINING_9 = {
                    alias: "event_timer_days_remaining_9"
                },
                e.EVENT_TIMER_DAYS_REMAINING_10 = {
                    alias: "event_timer_days_remaining_10"
                },
                e.EVENT_TIMER_DAYS_REMAINING_11 = {
                    alias: "event_timer_days_remaining_11"
                },
                e.EVENT_TIMER_DAYS_REMAINING_12 = {
                    alias: "event_timer_days_remaining_12"
                },
                e.EVENT_TIMER_DAYS_REMAINING_13 = {
                    alias: "event_timer_days_remaining_13"
                },
                e.EVENT_TIMER_DAYS_REMAINING_14 = {
                    alias: "event_timer_days_remaining_14"
                },
                e.EVENT_TIMER_DAYS_REMAINING = {
                    alias: "event_timer_days_remaining"
                },
                e.EVENT_CHOPCHOP_HEADER = {
                    alias: "event_chopchop_header"
                },
                e.EVENT_CHOPCHOP_ACTIVE_BODY = {
                    alias: "event_chopchop_active_body"
                },
                e.EVENT_CHOPCHOP_ACTIVE_BUTTON = {
                    alias: "event_chopchop_active_button"
                },
                e.EVENT_CHOPCHOP_ENDED_HEADER = {
                    alias: "event_chopchop_ended_header"
                },
                e.EVENT_CHOPCHOP_ENDED_BODY = {
                    alias: "event_chopchop_ended_body"
                },
                e.NOTIFICATIONS_CRATES_REFILL_TITLE = {
                    alias: "notifications_crates_refill_title"
                },
                e.NOTIFICATIONS_CRATES_REFILL_DESCRIPTION = {
                    alias: "notifications_crates_refill_description"
                },
                e.NOTIFICATIONS_ENERGY_REFILL_TITLE = {
                    alias: "notifications_energy_refill_title"
                },
                e.NOTIFICATIONS_ENERGY_REFILL_DESCRIPTION = {
                    alias: "notifications_energy_refill_description"
                },
                e.NOTIFICATIONS_CRATES_ENERGY_REFILL_CTA = {
                    alias: "notifications_crates_energy_refill_cta"
                },
                e.NOTIFICATIONS_ORDER_TITLE = {
                    alias: "notifications_order_title"
                },
                e.NOTIFICATIONS_ORDER_DESCRIPTION = {
                    alias: "notifications_order_description"
                },
                e.NOTIFICATIONS_ORDER_CTA = {
                    alias: "notifications_order_cta"
                },
                e.NOTIFICATIONS_READY_FOR_HARVEST_TITLE = {
                    alias: "notifications_ready_for_harvest_title"
                },
                e.NOTIFICATIONS_READY_FOR_HARVEST_DESCRIPTION = {
                    alias: "notifications_ready_for_harvest_description"
                },
                e.NOTIFICATIONS_READY_FOR_HARVEST_CTA = {
                    alias: "notifications_ready_for_harvest_cta"
                },
                e.EVENT_PIGGYBANK_HEADER = {
                    alias: "event_piggybank_header"
                },
                e.EVENT_PIGGYBANK_ACTIVE_BODY = {
                    alias: "event_piggybank_active_body"
                },
                e.EVENT_PIGGYBANK_ACTIVE_BUTTON = {
                    alias: "event_piggybank_active_button"
                },
                e.EVENT_PIGGYBANK_DISCOUNT_STICKER_TOPTEXT = {
                    alias: "event_piggybank_discount_sticker_topText"
                },
                e.EVENT_PIGGYBANK_DISCOUNT_STICKER_BOTTOMTEXT = {
                    alias: "event_piggybank_discount_sticker_bottomText"
                },
                e.EVENT_PIGGYBANK_DISCOUNT_STICKER_DISCOUNT = {
                    alias: "event_piggybank_discount_sticker_discount"
                },
                e.EVENT_PIGGYBANK_ENDED_HEADER = {
                    alias: "event_piggybank_ended_header"
                },
                e.EVENT_PIGGYBANK_ENDED_BODY = {
                    alias: "event_piggybank_ended_body"
                },
                e.EVENT_PIGGYBANK_ENDED_BELOW_THRESHHOLD = {
                    alias: "event_piggybank_ended_below_threshhold"
                },
                e.COMPENSATION_HEADER_TEXT = {
                    alias: "compensation_header_text"
                },
                e.COMPENSATION_BODY = {
                    alias: "compensation_body"
                },
                e.COMPENSATION_BUTTON_TEXT = {
                    alias: "compensation_button_text"
                },
                e.EVENT_DAILYBONUS_HEADER = {
                    alias: "event_dailybonus_header"
                },
                e.DAY = {
                    alias: "day"
                },
                e.TODAY = {
                    alias: "today"
                },
                e.EVENT_DAILYBONUS_BODY = {
                    alias: "event_dailybonus_body"
                },
                e.EVENT_DAILYBONUS_DISCLAIMER = {
                    alias: "event_dailybonus_disclaimer"
                },
                e.EVENT_DAILYBONUS_BUTTON_COLLECT = {
                    alias: "event_dailybonus_button_collect"
                },
                e.EVENT_GOLDENCARROT_HEADER = {
                    alias: "event_goldencarrot_header"
                },
                e.EVENT_GOLDENCARROT_BODY_ACTIVE = {
                    alias: "event_goldencarrot_body_active"
                },
                e.EVENT_GOLDENCARROT_BUTTON_GOTIT = {
                    alias: "event_goldencarrot_button_gotit"
                },
                e.EVENT_GOLDENCARROT_BUTTON_CLAIMREWARD = {
                    alias: "event_goldencarrot_button_claimreward"
                },
                e.EVENT_GOLDENCARROT_BODY_COMPLETE = {
                    alias: "event_goldencarrot_body_complete"
                },
                e.EVENT_GOLDENCARROT_BODY_INCOMPLETE = {
                    alias: "event_goldencarrot_body_incomplete"
                },
                e.GOLDENCARROT = {
                    alias: "goldencarrot"
                },
                e.DECORATIVE_DOGHOUSE = {
                    alias: "decorative_doghouse"
                },
                e.DECORATIVE_FARMHOUSE = {
                    alias: "decorative_farmhouse"
                },
                e.DECORATIVE_FEEDINGTROUGH = {
                    alias: "decorative_feedingtrough"
                },
                e.DECORATIVE_FLOWERPOTS = {
                    alias: "decorative_flowerpots"
                },
                e.DECORATIVE_FOUNTAIN = {
                    alias: "decorative_fountain"
                },
                e.DECORATIVE_HAYWAGON = {
                    alias: "decorative_haywagon"
                },
                e.DECORATIVE_LAMPPOST = {
                    alias: "decorative_lamppost"
                },
                e.DECORATIVE_MILKTANK = {
                    alias: "decorative_milktank"
                },
                e.DECORATIVE_PICKNICKTABLE = {
                    alias: "decorative_picknicktable"
                },
                e.DECORATIVE_SHED = {
                    alias: "decorative_shed"
                },
                e.DECORATIVE_SILO = {
                    alias: "decorative_silo"
                },
                e.DECORATIVE_STONEFLOWERPOT = {
                    alias: "decorative_stoneflowerpot"
                },
                e.DECORATIVE_WATERTOWER = {
                    alias: "decorative_watertower"
                },
                e.DECORATIVE_WELL = {
                    alias: "decorative_well"
                },
                e.DECORATIVE_BIRDSHOUSE = {
                    alias: "decorative_birdshouse"
                },
                e.DECORATIVE_BARN = {
                    alias: "decorative_barn"
                },
                e.EXTRAWORKER_ITEM_HEADER = {
                    alias: "extraworker_item_header"
                },
                e.EXTRAWORKER_ITEM_BODY = {
                    alias: "extraworker_item_body"
                },
                e.EXTRAWORKER_ITEM_BUTTON_ACTIVATE = {
                    alias: "extraworker_item_button_activate"
                },
                e.EXTRAWORKER_ITEM_BUTTON_NOTNOW = {
                    alias: "extraworker_item_button_notnow"
                },
                e.GOLDENCARROT_HELP_HEADER = {
                    alias: "goldencarrot_help_header"
                },
                e.GOLDENCARROT_HELP_STEP_1 = {
                    alias: "goldencarrot_help_step_1"
                },
                e.GOLDENCARROT_HELP_STEP_2 = {
                    alias: "goldencarrot_help_step_2"
                },
                e.GOLDENCARROT_HELP_STEP_3 = {
                    alias: "goldencarrot_help_step_3"
                },
                e.GOLDENCARROT_HELP_SUBTEXT = {
                    alias: "goldencarrot_help_subtext"
                },
                e.REWARD_POPOUT_TITLE_EVENT = {
                    alias: "reward_popout_title_event"
                },
                e.NOTIFICATION_SHOVEL = {
                    alias: "notification_shovel"
                },
                e.NEW_VERSION_NOTICE_HEADER = {
                    alias: "new_version_notice_header"
                },
                e.NEW_VERSION_NOTICE_BODY = {
                    alias: "new_version_notice_body"
                },
                e.INACTIVITY_NOTICE_HEADER = {
                    alias: "inactivity_notice_header"
                },
                e.INACTIVITY_NOTICE_BODY = {
                    alias: "inactivity_notice_body"
                },
                e.NAME_COW_1 = {
                    alias: "name_cow_1"
                },
                e.NAME_COW_2 = {
                    alias: "name_cow_2"
                },
                e.NAME_COW_3 = {
                    alias: "name_cow_3"
                },
                e.NAME_COW_4 = {
                    alias: "name_cow_4"
                },
                e.NAME_CHICKEN_1 = {
                    alias: "name_chicken_1"
                },
                e.NAME_CHICKEN_2 = {
                    alias: "name_chicken_2"
                },
                e.NAME_CHICKEN_3 = {
                    alias: "name_chicken_3"
                },
                e.NAME_CHICKEN_4 = {
                    alias: "name_chicken_4"
                },
                e.NAME_GOAT_1 = {
                    alias: "name_goat_1"
                },
                e.NAME_GOAT_2 = {
                    alias: "name_goat_2"
                },
                e.NAME_GOAT_3 = {
                    alias: "name_goat_3"
                },
                e.NAME_GOAT_4 = {
                    alias: "name_goat_4"
                },
                e.NAME_PIG_1 = {
                    alias: "name_pig_1"
                },
                e.NAME_PIG_2 = {
                    alias: "name_pig_2"
                },
                e.NAME_PIG_3 = {
                    alias: "name_pig_3"
                },
                e.NAME_PIG_4 = {
                    alias: "name_pig_4"
                },
                e.NAME_SHEEP_1 = {
                    alias: "name_sheep_1"
                },
                e.NAME_SHEEP_2 = {
                    alias: "name_sheep_2"
                },
                e.NAME_SHEEP_3 = {
                    alias: "name_sheep_3"
                },
                e.NAME_SHEEP_4 = {
                    alias: "name_sheep_4"
                },
                e.NAME_DEER_1 = {
                    alias: "name_deer_1"
                },
                e.NAME_DEER_2 = {
                    alias: "name_deer_2"
                },
                e.NAME_DEER_3 = {
                    alias: "name_deer_3"
                },
                e.NAME_DEER_4 = {
                    alias: "name_deer_4"
                },
                e.EVENT_HALLOWEEN_HEADER = {
                    alias: "event_halloween_header"
                },
                e.EVENT_HALLOWEEN_BODY_ACTIVE = {
                    alias: "event_halloween_body_active"
                },
                e.EVENT_HALLOWEEN_BUTTON_GOTIT = {
                    alias: "event_halloween_button_gotit"
                },
                e.EVENT_HALLOWEEN_BUTTON_CLAIMREWARD = {
                    alias: "event_halloween_button_claimreward"
                },
                e.EVENT_HALLOWEEN_BODY_COMPLETE = {
                    alias: "event_halloween_body_complete"
                },
                e.EVENT_HALLOWEEN_BODY_INCOMPLETE = {
                    alias: "event_halloween_body_incomplete"
                },
                e.GOLDENPUMPKIN = {
                    alias: "goldenpumpkin"
                },
                e.EVENT_HALLOWEEN_HELP_HEADER = {
                    alias: "event_halloween_help_header"
                },
                e.EVENT_HALLOWEEN_HELP_STEP_1 = {
                    alias: "event_halloween_help_step_1"
                },
                e.EVENT_HALLOWEEN_HELP_STEP_2 = {
                    alias: "event_halloween_help_step_2"
                },
                e.EVENT_HALLOWEEN_HELP_STEP_3 = {
                    alias: "event_halloween_help_step_3"
                },
                e.EVENT_HALLOWEEN_HELP_SUBTEXT = {
                    alias: "event_halloween_help_subtext"
                },
                e.EVENT_HALLOWEEN_SHOP_ANNOUNCEMENT_HEADER = {
                    alias: "event_halloween_shop_announcement_header"
                },
                e.EVENT_HALLOWEEN_SHOP_ANNOUNCEMENT_BODY = {
                    alias: "event_halloween_shop_announcement_body"
                },
                e.EVENT_HALLOWEEN_SHOP_ANNOUNCEMENT_BUTTON = {
                    alias: "event_halloween_shop_announcement_button"
                },
                e.HALLOWEEN = {
                    alias: "halloween"
                },
                e.MARKETPLACE_HALLOWEEN_BANNER = {
                    alias: "marketplace_halloween_banner"
                },
                e.MARKETPLACE_LIMITED_ITEM_PURCHASED = {
                    alias: "marketplace_limited_item_purchased"
                },
                e.BUTTON_MOVE_TO_STORAGE = {
                    alias: "button_move_to_storage"
                },
                e.DECORATION_STORAGE = {
                    alias: "decoration_storage"
                },
                e.STORAGE_PLACE = {
                    alias: "storage_place"
                },
                e.STORAGE_IS_FULL = {
                    alias: "storage_is_full"
                },
                e.STORAGE_IS_FULL_BODY = {
                    alias: "storage_is_full_body"
                },
                e.BUTTON_VIEW_STORAGE = {
                    alias: "button_view_storage"
                },
                e.STORAGE_EXPLANATION_STEP_1 = {
                    alias: "storage_explanation_step_1"
                },
                e.STORAGE_EXPLANATION_STEP_2 = {
                    alias: "storage_explanation_step_2"
                },
                e.STORAGE_EXPLANATION_STEP_3 = {
                    alias: "storage_explanation_step_3"
                },
                e.SAVE_FAILED_TITLE = {
                    alias: "save_failed_title"
                },
                e.SAVE_FAILED_SUBTEXT = {
                    alias: "save_failed_subtext"
                },
                e.EVENT_CHRISTMAS_HEADER = {
                    alias: "event_christmas_header"
                },
                e.EVENT_CHRISTMAS_BODY_ACTIVE = {
                    alias: "event_christmas_body_active"
                },
                e.EVENT_CHRISTMAS_BUTTON_GOTIT = {
                    alias: "event_christmas_button_gotit"
                },
                e.EVENT_CHRISTMAS_BUTTON_CLAIMREWARD = {
                    alias: "event_christmas_button_claimreward"
                },
                e.EVENT_CHRISTMAS_BODY_COMPLETE = {
                    alias: "event_christmas_body_complete"
                },
                e.EVENT_CHRISTMAS_BODY_INCOMPLETE = {
                    alias: "event_christmas_body_incomplete"
                },
                e.CHRISTMASBALLS = {
                    alias: "christmasballs"
                },
                e.EVENT_CHRISTMAS_HELP_HEADER = {
                    alias: "event_christmas_help_header"
                },
                e.EVENT_CHRISTMAS_HELP_STEP_1 = {
                    alias: "event_christmas_help_step_1"
                },
                e.EVENT_CHRISTMAS_HELP_STEP_2 = {
                    alias: "event_christmas_help_step_2"
                },
                e.EVENT_CHRISTMAS_HELP_STEP_3 = {
                    alias: "event_christmas_help_step_3"
                },
                e.EVENT_CHRISTMAS_HELP_SUBTEXT = {
                    alias: "event_christmas_help_subtext"
                },
                e.EVENT_CHRISTMAS_SHOP_ANNOUNCEMENT_HEADER = {
                    alias: "event_christmas_shop_announcement_header"
                },
                e.EVENT_CHRISTMAS_SHOP_ANNOUNCEMENT_BODY = {
                    alias: "event_christmas_shop_announcement_body"
                },
                e.EVENT_CHRISTMAS_SHOP_ANNOUNCEMENT_BUTTON = {
                    alias: "event_christmas_shop_announcement_button"
                },
                e.TOMATOPLANT = {
                    alias: "tomatoplant"
                },
                e.TOMATO = {
                    alias: "tomato"
                },
                e.TOMATO_ON_WHEELS = {
                    alias: "tomato_on_wheels"
                },
                e.TOMATO_INTRODUCTION = {
                    alias: "tomato_introduction"
                },
                e.RECIPE_TOMATO_SOUP = {
                    alias: "recipe_tomato_soup"
                },
                e.RECIPE_MINI_TOMATO_BURGER = {
                    alias: "recipe_mini_tomato_burger"
                },
                e.RECIPE_STUFFED_TOMATOES = {
                    alias: "recipe_stuffed_tomatoes"
                },
                e.RECIPE_TOMATO_SALAD_ON_A_STICK = {
                    alias: "recipe_tomato_salad_on_a_stick"
                },
                e.CHRISTMAS = {
                    alias: "christmas"
                },
                e.DECORATIVE_HALLOWEEN_BLACKCAT = {
                    alias: "decorative_halloween_blackcat"
                },
                e.DECORATIVE_HALLOWEEN_CAULDRON = {
                    alias: "decorative_halloween_cauldron"
                },
                e.DECORATIVE_HALLOWEEN_GHOSTS = {
                    alias: "decorative_halloween_ghosts"
                },
                e.DECORATIVE_HALLOWEEN_GRANDFATHERCLOCK = {
                    alias: "decorative_halloween_grandfatherclock"
                },
                e.DECORATIVE_HALLOWEEN_GRAVE01 = {
                    alias: "decorative_halloween_grave01"
                },
                e.DECORATIVE_HALLOWEEN_GRAVE02 = {
                    alias: "decorative_halloween_grave02"
                },
                e.DECORATIVE_HALLOWEEN_GRAVEYARD = {
                    alias: "decorative_halloween_graveyard"
                },
                e.DECORATIVE_HALLOWEEN_HAUNTEDHOUSE = {
                    alias: "decorative_halloween_hauntedhouse"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINPATCH = {
                    alias: "decorative_halloween_pumpkinpatch"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINPATCHBIG = {
                    alias: "decorative_halloween_pumpkinpatchbig"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS01 = {
                    alias: "decorative_halloween_pumpkins01"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS02 = {
                    alias: "decorative_halloween_pumpkins02"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS03 = {
                    alias: "decorative_halloween_pumpkins03"
                },
                e.DECORATIVE_HALLOWEEN_PUMPKINS04 = {
                    alias: "decorative_halloween_pumpkins04"
                },
                e.DECORATIVE_HALLOWEEN_SKELETONBENCH = {
                    alias: "decorative_halloween_skeletonbench"
                },
                e.DECORATIVE_HALLOWEEN_SKELETONCAROUSEL = {
                    alias: "decorative_halloween_skeletoncarousel"
                },
                e.DECORATIVE_HALLOWEEN_SKELETONPICNIC = {
                    alias: "decorative_halloween_skeletonpicnic"
                },
                e.DECORATIVE_HALLOWEEN_SKULLALTAR = {
                    alias: "decorative_halloween_skullaltar"
                },
                e.DECORATIVE_HALLOWEEN_TREEFACE = {
                    alias: "decorative_halloween_treeface"
                },
                e.DECORATIVE_HALLOWEEN_WELL = {
                    alias: "decorative_halloween_well"
                },
                e.BLACKFRIDAY = {
                    alias: "blackfriday"
                },
                e.EVENT_BLACK_FRIDAY_SHOP_ANNOUNCEMENT_HEADER = {
                    alias: "event_black_friday_shop_announcement_header"
                },
                e.EVENT_BLACK_FRIDAY_SHOP_ANNOUNCEMENT_BODY = {
                    alias: "event_black_friday_shop_announcement_body"
                },
                e.EVENT_BLACK_FRIDAY_SHOP_ANNOUNCEMENT_BUTTON = {
                    alias: "event_black_friday_shop_announcement_button"
                },
                e.MARKETPLACE_BLACKFRIDAY_BANNER = {
                    alias: "marketplace_blackfriday_banner"
                },
                e.DAILY_CHALLENGE_POPUP_HEADER = {
                    alias: "daily_challenge_popup_header"
                },
                e.DAILY_CHALLENGE_POPUP_TEXT = {
                    alias: "daily_challenge_popup_text"
                },
                e.DAILY_CHALLENGE_BUTTON_NEXT_IN = {
                    alias: "daily_challenge_button_next_in"
                },
                e.DAILY_CHALLENGE_MERGE = {
                    alias: "daily_challenge_merge"
                },
                e.DAILY_CHALLENGE_COMPLETE_ORDER = {
                    alias: "daily_challenge_complete_order"
                },
                e.DAILY_CHALLENGE_OPEN_SUPPLIES = {
                    alias: "daily_challenge_open_supplies"
                },
                e.DAILY_CHALLENGE_SPEND_ENERGY = {
                    alias: "daily_challenge_spend_energy"
                },
                e.DAILY_CHALLENGE_SPEND_GEMS = {
                    alias: "daily_challenge_spend_gems"
                },
                e.DAILY_CHALLENGE_MERGE_CHAIN = {
                    alias: "daily_challenge_merge_chain"
                },
                e.DAILY_CHALLENGE_COLLECT_INGREDIENTS = {
                    alias: "daily_challenge_collect_ingredients"
                },
                e.DAILY_CHALLENGE_COLLECT_SPECIFIC_INGREDIENT = {
                    alias: "daily_challenge_collect_specific_ingredient"
                },
                e.DAILY_CHALLENGE_OPEN_CRATE = {
                    alias: "daily_challenge_open_crate"
                },
                e.DAILY_CHALLENGE_USE_SHOVEL = {
                    alias: "daily_challenge_use_shovel"
                },
                e.DAILY_CHALLENGE_USE_WORKERS = {
                    alias: "daily_challenge_use_workers"
                },
                e.UPSELL_POPUP_HEADER_ENERGY = {
                    alias: "upsell_popup_header_energy"
                },
                e.UPSELL_POPUP_HEADER_GEMS = {
                    alias: "upsell_popup_header_gems"
                },
                e.UPSELL_POPUP_BUY_ENERGY_TEXT = {
                    alias: "upsell_popup_buy_energy_text"
                },
                e.UPSELL_POPUP_BUY_GEMS_TEXT = {
                    alias: "upsell_popup_buy_gems_text"
                },
                e.MARKETPLACE_CHRISTMAS_BANNER = {
                    alias: "marketplace_christmas_banner"
                },
                e.DISCOVERY_CATEGORY_HALLOWEEN_EVENT_OBJECTS = {
                    alias: "discovery_category_halloween_event_objects"
                },
                e.DISCOVERY_CATEGORY_HALLOWEEN_SHOP_OBJECTS = {
                    alias: "discovery_category_halloween_shop_objects"
                },
                e.DISCOVERY_CATEGORY_CHRISTMAS_EVENT_OBJECTS = {
                    alias: "discovery_category_christmas_event_objects"
                },
                e.DISCOVERY_CATEGORY_CHRISTMAS_SHOP_OBJECTS = {
                    alias: "discovery_category_christmas_shop_objects"
                },
                e.DECORATIVE_CHRISTMAS_CANDYGATE = {
                    alias: "decorative_christmas_candygate"
                },
                e.DECORATIVE_CHRISTMAS_ELFMAIL = {
                    alias: "decorative_christmas_elfmail"
                },
                e.DECORATIVE_CHRISTMAS_ELFTEDDY = {
                    alias: "decorative_christmas_elfteddy"
                },
                e.DECORATIVE_CHRISTMAS_ELFTRAIN = {
                    alias: "decorative_christmas_elftrain"
                },
                e.DECORATIVE_CHRISTMAS_FIREPLACE = {
                    alias: "decorative_christmas_fireplace"
                },
                e.DECORATIVE_CHRISTMAS_GIFT01 = {
                    alias: "decorative_christmas_gift01"
                },
                e.DECORATIVE_CHRISTMAS_GIFT02 = {
                    alias: "decorative_christmas_gift02"
                },
                e.DECORATIVE_CHRISTMAS_GIFT03 = {
                    alias: "decorative_christmas_gift03"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBELL = {
                    alias: "decorative_christmas_gingerbell"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBREADHOUSE = {
                    alias: "decorative_christmas_gingerbreadhouse"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBREADHOUSESMALL = {
                    alias: "decorative_christmas_gingerbreadhousesmall"
                },
                e.DECORATIVE_CHRISTMAS_GINGERBREADSNOW = {
                    alias: "decorative_christmas_gingerbreadsnow"
                },
                e.DECORATIVE_CHRISTMAS_NUTCRACKER = {
                    alias: "decorative_christmas_nutcracker"
                },
                e.DECORATIVE_CHRISTMAS_SANTAGIFT = {
                    alias: "decorative_christmas_santagift"
                },
                e.DECORATIVE_CHRISTMAS_SANTAMAIL = {
                    alias: "decorative_christmas_santamail"
                },
                e.DECORATIVE_CHRISTMAS_SLEIGH = {
                    alias: "decorative_christmas_sleigh"
                },
                e.DECORATIVE_CHRISTMAS_SNOWCAROLING = {
                    alias: "decorative_christmas_snowcaroling"
                },
                e.DECORATIVE_CHRISTMAS_SNOWDINNER = {
                    alias: "decorative_christmas_snowdinner"
                },
                e.DECORATIVE_CHRISTMAS_SNOWFIGHT = {
                    alias: "decorative_christmas_snowfight"
                },
                e.DECORATIVE_CHRISTMAS_SNOWGIFTING = {
                    alias: "decorative_christmas_snowgifting"
                },
                e.DECORATIVE_CHRISTMAS_SNOWGLOBE = {
                    alias: "decorative_christmas_snowglobe"
                },
                e.DECORATIVE_CHRISTMAS_SNOWJELLO = {
                    alias: "decorative_christmas_snowjello"
                },
                e.DECORATIVE_CHRISTMAS_SNOWLANTERN = {
                    alias: "decorative_christmas_snowlantern"
                },
                e.DECORATIVE_CHRISTMAS_SNOWREINDEER = {
                    alias: "decorative_christmas_snowreindeer"
                },
                e.DECORATIVE_CHRISTMAS_SNOWTELESCOPE = {
                    alias: "decorative_christmas_snowtelescope"
                },
                e.DECORATIVE_CHRISTMAS_TREEBIG = {
                    alias: "decorative_christmas_treebig"
                },
                e.CHRISTMASDEALS = {
                    alias: "christmasdeals"
                },
                e.MARKETPLACE_CHRISTMAS_DEALS_BANNER = {
                    alias: "marketplace_christmas_deals_banner"
                },
                e.EVENT_CHRISTMAS_DEALS_SHOP_ANNOUNCEMENT_HEADER = {
                    alias: "event_christmas_deals_shop_announcement_header"
                },
                e.EVENT_CHRISTMAS_DEALS_SHOP_ANNOUNCEMENT_BODY = {
                    alias: "event_christmas_deals_shop_announcement_body"
                },
                e.DAILIES = {
                    alias: "dailies"
                },
                e.MARKETPLACE_QUICK_NAVIGATION = {
                    alias: "marketplace_quick_navigation"
                },
                e.COMING_SOON = {
                    alias: "coming_soon"
                },
                e.AVOCADOPLANT = {
                    alias: "avocadoplant"
                },
                e.AVOCADO = {
                    alias: "avocado"
                },
                e.AVOCADO_FIESTA = {
                    alias: "avocado_fiesta"
                },
                e.RECIPE_AVOCADO_EGG_BURGER = {
                    alias: "recipe_avocado_egg_burger"
                },
                e.RECIPE_AVOCADO_ON_TOAST = {
                    alias: "recipe_avocado_on_toast"
                },
                e.RECIPE_AVOCADO_TACO = {
                    alias: "recipe_avocado_taco"
                },
                e.RECIPE_AVOCADO_WRAP = {
                    alias: "recipe_avocado_wrap"
                },
                e.AVOCADO_INTRODUCTION = {
                    alias: "avocado_introduction"
                },
                e.TRUFFLEPIG = {
                    alias: "trufflepig"
                },
                e.TRUFFLE = {
                    alias: "truffle"
                },
                e.TRUFFLELICIOUS = {
                    alias: "trufflelicious"
                },
                e.RECIPE_TRUFFLEBALLS = {
                    alias: "recipe_truffleballs"
                },
                e.RECIPE_TRUFFLE_GRILLED_CHEESE_SANDWICH = {
                    alias: "recipe_truffle_grilled_cheese_sandwich"
                },
                e.RECIPE_TRUFFLEPASTA = {
                    alias: "recipe_trufflepasta"
                },
                e.TRUFFLELICIOUS_INTRODUCTION = {
                    alias: "trufflelicious_introduction"
                },
                e.LOGIN = {
                    alias: "login"
                },
                e.LOGIN_WITH_FB = {
                    alias: "login_with_FB"
                },
                e.SOCIAL_LOGIN_ERROR = {
                    alias: "social_login_error"
                },
                e.EMAIL_LOGIN_ERROR = {
                    alias: "email_login_error"
                },
                e.LOGOUT = {
                    alias: "logout"
                },
                e.OR = {
                    alias: "or"
                },
                e.VERIFY = {
                    alias: "verify"
                },
                e.CLICK_HERE_TO_CONTINUE_AS_GUEST = {
                    alias: "click_here_to_continue_as_guest"
                },
                e.EMAIL_AUTH_SUBJECT = {
                    alias: "email_auth_subject"
                },
                e.EMAIL_AUTH_PREHEADER = {
                    alias: "email_auth_preheader"
                },
                e.EMAIL_AUTH_INTRO = {
                    alias: "email_auth_intro"
                },
                e.EMAIL_AUTH_GREETINGS = {
                    alias: "email_auth_greetings"
                },
                e.EMAIL_AUTH_TOKEN = {
                    alias: "email_auth_token"
                },
                e.EXAMPLE_EMAIL_ADDRESS = {
                    alias: "example_email_address"
                },
                e.EMAIL_AUTH_TOKEN_REQUEST = {
                    alias: "email_auth_token_request"
                },
                e.CONSENT_POPUP_TEXT = {
                    alias: "consent_popup_text"
                },
                e.CONSENT_POPUP_HEADER = {
                    alias: "consent_popup_header"
                },
                e.CONSENT_POPUP_BUTTON = {
                    alias: "consent_popup_button"
                },
                e.BUY_LAND_BUTTON_TEXT = {
                    alias: "buy_land_button_text"
                },
                e.BUY_LAND_POPOUT = {
                    alias: "buy_land_popout"
                },
                e.SOLD_OUT = {
                    alias: "sold_out"
                },
                e.MERGABLE_OBJECT_TOOLTIP_1 = {
                    alias: "mergable_object_tooltip_1"
                },
                e.LOCKED_LAND_TOOLTIP_1 = {
                    alias: "locked_land_tooltip_1"
                },
                e.LOCKED_LAND_TOOLTIP_2 = {
                    alias: "locked_land_tooltip_2"
                },
                e.VISIT_INVITE_DISCORD_FRIENDS_HEADER = {
                    alias: "visit_invite_discord_friends_header"
                },
                e.VISIT_INVITE_DISCORD_FRIENDS_BODY = {
                    alias: "visit_invite_discord_friends_body"
                },
                e.VISIT_INVITE_DISCORD_FRIENDS_BUTTON = {
                    alias: "visit_invite_discord_friends_button"
                },
                e.TOAST_PLAYER_JOINED_YOUR_SESSION = {
                    alias: "toast_player_joined_your_session"
                },
                e.FRIEND_LIST_FRIENDS = {
                    alias: "friend_list_friends"
                },
                e.FRIEND_LIST_REQUESTS = {
                    alias: "friend_list_requests"
                },
                e.FRIEND_LIST_ADD_FRIEND = {
                    alias: "friend_list_add_friend"
                },
                e.FRIEND_LIST_LAST_ONLINE_MINUTES_AGO = {
                    alias: "friend_list_last_online_minutes_ago"
                },
                e.FRIEND_LIST_LAST_ONLINE_HOURS_AGO = {
                    alias: "friend_list_last_online_hours_ago"
                },
                e.FRIEND_LIST_LAST_ONLINE_DAYS_AGO = {
                    alias: "friend_list_last_online_days_ago"
                },
                e.FRIEND_LIST_LAST_ONLINE_JUST_NOW = {
                    alias: "friend_list_last_online_just_now"
                },
                e.FRIEND_LIST_GO_BACK = {
                    alias: "friend_list_go_back"
                },
                e.FRIEND_LIST_INCOMING_REQUESTS = {
                    alias: "friend_list_incoming_requests"
                },
                e.TRAIN_DESTINATION_INVITE_FRIENDS_HEADER = {
                    alias: "train_destination_invite_friends_header"
                },
                e.TRAIN_DESTINATION_INVITE_FRIENDS_SUBTEXT = {
                    alias: "train_destination_invite_friends_subtext"
                },
                e.ADD_FRIEND_SHARE_CODE = {
                    alias: "add_friend_share_code"
                },
                e.ADD_FRIEND_SEND_FRIEND_REQUEST = {
                    alias: "add_friend_send_friend_request"
                },
                e.ADD_FRIEND_CODE_COPIED_TO_CLIPBOARD = {
                    alias: "add_friend_code_copied_to_clipboard"
                },
                e.ADD_FRIEND_INVALID_CODE = {
                    alias: "add_friend_invalid_code"
                },
                e.ADD_FRIEND_VALIDATION_POPUP = {
                    alias: "add_friend_validation_popup"
                },
                e.ADD_FRIEND_CONFIRMATION_POPUP = {
                    alias: "add_friend_confirmation_popup"
                },
                e.ADD_FRIEND_CONFIRMATION_TOAST = {
                    alias: "add_friend_confirmation_toast"
                },
                e.ADBLOCKER_TITLE = {
                    alias: "adblocker_title"
                },
                e.ADBLOCKER_BODY = {
                    alias: "adblocker_body"
                },
                e.ADBLOCKER_BUTTON = {
                    alias: "adblocker_button"
                },
                e.PURCHASES_UNAVAILABLE_TITLE = {
                    alias: "purchases_unavailable_title"
                },
                e.PURCHASES_UNAVAILABLE_BODY_TOP = {
                    alias: "purchases_unavailable_body_top"
                },
                e.PURCHASES_UNAVAILABLE_BODY_BOTTOM = {
                    alias: "purchases_unavailable_body_bottom"
                },
                e.MARKETPLACE_RIBBON_BEST_VALUE = {
                    alias: "marketplace_ribbon_best_value"
                },
                e.MARKETPLACE_RIBBON_MOST_POPULAR = {
                    alias: "marketplace_ribbon_most_popular"
                },
                e.ONBOARDING_DIALOG_ISLAND_1_NPC = {
                    alias: "onboarding_dialog_island_1_npc"
                },
                e.ONBOARDING_DIALOG_ISLAND_2_NPC = {
                    alias: "onboarding_dialog_island_2_npc"
                },
                e.ONBOARDING_DIALOG_ISLAND_3_NPC = {
                    alias: "onboarding_dialog_island_3_npc"
                },
                e.ONBOARDING_DIALOG_ISLAND_4_NPC = {
                    alias: "onboarding_dialog_island_4_npc"
                },
                e.ONBOARDING_DIALOG_ISLAND_5_NPC = {
                    alias: "onboarding_dialog_island_5_npc"
                },
                e.ONBOARDING_DIALOG_ISLAND_6_NPC = {
                    alias: "onboarding_dialog_island_6_npc"
                },
                e.ONBOARDING_DIALOG_ISLAND_7_NPC = {
                    alias: "onboarding_dialog_island_7_npc"
                },
                e.ONBOARDING_DIALOG_ISLAND_8_NPC = {
                    alias: "onboarding_dialog_island_8_npc"
                },
                e
            }())
              , le = function() {
                function e() {}
                return e.EN_US = {
                    alias: "en_US"
                },
                e.NL_NL = {
                    alias: "nl-NL"
                },
                e.JA_JP = {
                    alias: "ja-JP"
                },
                e.FR_FR = {
                    alias: "fr-FR"
                },
                e.IT_IT = {
                    alias: "it-IT"
                },
                e.DE_DE = {
                    alias: "de-DE"
                },
                e.PT_BR = {
                    alias: "pt-BR"
                },
                e.ES_ES = {
                    alias: "es-ES"
                },
                e.ID_ID = {
                    alias: "id-ID"
                },
                e.PT_PT = {
                    alias: "pt-PT"
                },
                e.TR_TR = {
                    alias: "tr-TR"
                },
                e.PL_PL = {
                    alias: "pl-PL"
                },
                e.VI_VI = {
                    alias: "vi-VI"
                },
                e.SV_SE = {
                    alias: "sv-SE"
                },
                e.HU_HU = {
                    alias: "hu-HU"
                },
                e.GR_GR = {
                    alias: "gr-GR"
                },
                e.CS_CZ = {
                    alias: "cs-CZ"
                },
                e
            }();
            function ue() {
                return (0,
                n.__awaiter)(this, void 0, void 0, (function() {
                    return (0,
                    n.__generator)(this, (function(e) {
                        switch (e.label) {
                        case 0:
                            return [4, (new v.CoolKitDependencyManager).getLocalizationFile()];
                        case 1:
                            return [2, e.sent()]
                        }
                    }
                    ))
                }
                ))
            }
            var de, he, pe = i(1202);
            function ve(e) {
                return Te(e) === de.UNDEFINED
            }
            function ge(e) {
                return null === e
            }
            function fe(e) {
                return Te(e) === de.STRING
            }
            function Ee(e) {
                return Te(e) === de.NUMBER
            }
            function me(e) {
                return Array.isArray(e)
            }
            function ye(e) {
                return Te(e) === de.OBJECT
            }
            function Te(e) {
                return Object.prototype.toString.call(e).slice(8, -1)
            }
            !function(e) {
                e.BOOLEAN = "Boolean",
                e.OBJECT = "Object",
                e.ARRAY = "Array",
                e.STRING = "String",
                e.NUMBER = "Number",
                e.NULL = "Null",
                e.UNDEFINED = "Undefined",
                e.DATE = "Date",
                e.FUNCTION = "Function",
                e.ASYNC_FUNCTION = "AsyncFunction"
            }(de || (de = {})),
            function(e) {
                e[e.WARN = 0] = "WARN",
                e[e.ERROR = 1] = "ERROR",
                e[e.INFO = 2] = "INFO"
            }(he || (he = {}));
            var Ae, Ce = function() {
                function e() {
                    this._allowedMessages = 20,
                    this._rootElement = document.createElement("div"),
                    this._rootElement.setAttribute("class", "logger-root"),
                    this._viewElement = document.createElement("div"),
                    this._viewElement.setAttribute("class", "logger-view"),
                    this._rootElement.appendChild(this._viewElement)
                }
                return e.prototype.toggle = function() {
                    this._rootElement.classList.toggle("hidden")
                }
                ,
                e.prototype.warn = function(e) {
                    this._addText(e, he.WARN)
                }
                ,
                e.prototype.error = function(e) {
                    this._addText(e, he.ERROR)
                }
                ,
                e.prototype.info = function(e) {
                    this._addText(e, he.INFO)
                }
                ,
                e.prototype._addText = function(e, t) {}
                ,
                e
            }();
            !function(e) {
                e[e.DISABLED = 0] = "DISABLED",
                e[e.ERROR = 1] = "ERROR",
                e[e.WARNING = 2] = "WARNING",
                e[e.INFO = 3] = "INFO",
                e[e.DEBUG = 4] = "DEBUG"
            }(Ae || (Ae = {}));
            var Ie = function() {
                function e(e) {
                    var t;
                    this.STYLES = ((t = {})[Ae.DISABLED] = [],
                    t[Ae.ERROR] = ["color:#f01100"],
                    t[Ae.WARNING] = ["color:#e66000"],
                    t[Ae.INFO] = ["color:#1771F1"],
                    t[Ae.DEBUG] = ["color:#a103fc"],
                    t),
                    this.name = e
                }
                return e.Of = function(e, t) {
                    var i = new this(e);
                    return Object.assign(i.STYLES, t),
                    i
                }
                ,
                e.setLogLevel = function(e) {
                    this._logLevel = e
                }
                ,
                e.getLogLevel = function() {
                    return this._logLevel
                }
                ,
                e.setExternalErrorService = function(e) {
                    this._externalErrorService = e
                }
                ,
                e.prototype.debug = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    if (e._logLevel >= Ae.DEBUG) {
                        var n = this.format(Ae.DEBUG, t)[0];
                        console.debug.apply(console, n)
                    }
                }
                ,
                e.prototype.info = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    if (e._logLevel >= Ae.INFO) {
                        var n = this.format(Ae.INFO, t)
                          , r = n[0]
                          , o = n[1];
                        console.info.apply(console, r),
                        e.loggerView.info(o)
                    }
                }
                ,
                e.prototype.warn = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    if (e._logLevel >= Ae.WARNING) {
                        var n = this.format(Ae.WARNING, t)
                          , r = n[0]
                          , o = n[1];
                        console.warn.apply(console, r),
                        e.loggerView.warn(o)
                    }
                }
                ,
                e.prototype.error = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    if (e._logLevel >= Ae.ERROR) {
                        var n = this.format(Ae.ERROR, t)
                          , r = n[0]
                          , o = n[1];
                        console.error.apply(console, r),
                        e.loggerView.error(o)
                    }
                    e._externalErrorService.error(t)
                }
                ,
                e.prototype.concatStyles = function(e, t) {
                    return void 0 === t && (t = ""),
                    "".concat(this.STYLES[e].join(";"), ";").concat(t)
                }
                ,
                e.prototype.format = function(e, t) {
                    var i = t[0]
                      , n = t[1];
                    return t.slice(2),
                    fe(i) && (fe(n) || ve(n)) ? [["%c[".concat(this.name, "] ").concat(i), this.concatStyles(e, n)], ["[".concat(this.name, "] ").concat(i)]] : [t, t]
                }
                ,
                e.loggerView = new Ce,
                e._logLevel = Ae.DEBUG,
                e._externalErrorService = {
                    error: function() {}
                },
                e
            }()
              , Se = function() {
                function e() {
                    this._logger = Ie.Of("BaseGameService")
                }
                return Object.defineProperty(e.prototype, "services", {
                    get: function() {
                        return this._services
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initialize = function(e) {
                    this._services = e
                }
                ,
                e
            }();
            function Oe(e) {
                return "initialize"in e && ((t = Te(e.initialize)) === de.FUNCTION || t === de.ASYNC_FUNCTION);
                var t
            }
            var be, Re = function() {
                function e(e, t) {
                    void 0 === t && (t = !1),
                    this._tasks = {},
                    this._logger = Ie.Of("".concat(e, " Benchmarker")),
                    this._duration = {
                        startTime: 0,
                        endTime: 0,
                        duration: 0
                    },
                    this._verbose = t,
                    this.start()
                }
                return e.prototype.start = function() {
                    this._duration.startTime = Date.now(),
                    this._verbose && this._logger.info("start: ".concat(this._duration.startTime))
                }
                ,
                e.prototype.end = function() {}
                ,
                e.prototype.startTask = function(e) {
                    this._tasks[e] = {
                        startTime: Date.now(),
                        endTime: 0,
                        duration: 0
                    },
                    this._verbose && this._logger.info("".concat(e, " start: ").concat(this._tasks[e].startTime))
                }
                ,
                e.prototype.endTask = function(e) {
                    this._tasks[e] || this.startTask(e),
                    this._tasks[e].endTime = Date.now(),
                    this._verbose && this._logger.info("".concat(e, " end: ").concat(this._tasks[e].endTime))
                }
                ,
                e
            }(), we = function() {
                function e() {}
                return e.prototype.addServices = function(e) {
                    this.services = (0,
                    n.__assign)({}, e)
                }
                ,
                e.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            for (t in e = new Re("game initialize"),
                            this.services)
                                e.startTask(t),
                                this.services[t].initialize(this.services),
                                e.endTask(t);
                            return e.end(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.startServices = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r = this;
                        return (0,
                        n.__generator)(this, (function(o) {
                            switch (o.label) {
                            case 0:
                                t = function(t) {
                                    var i, o, a;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        switch (n.label) {
                                        case 0:
                                            return i = e[t],
                                            o = t.toString(),
                                            a = new Re(o),
                                            [4, Promise.all(i.map((function(e) {
                                                var t = e.toString();
                                                return a.startTask(t),
                                                r.services[e].start().then((function() {
                                                    return a.endTask(t)
                                                }
                                                )).catch((function(e) {
                                                    throw new Error("Service ".concat(t, " failed to start: ").concat(e))
                                                }
                                                ))
                                            }
                                            )))];
                                        case 1:
                                            return n.sent(),
                                            a.end(),
                                            [2]
                                        }
                                    }
                                    ))
                                }
                                ,
                                i = 0,
                                o.label = 1;
                            case 1:
                                return i < e.length ? [5, t(i)] : [3, 4];
                            case 2:
                                o.sent(),
                                o.label = 3;
                            case 3:
                                return i++,
                                [3, 1];
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, Promise.all(Object.values(this.services).map((function(e) {
                                    return Oe(e) ? e.destroy() : Promise.resolve()
                                }
                                )))];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), De = new we, Ne = "LOC_ERROR", Le = [le.EN_US, le.CS_CZ, le.DE_DE, le.ES_ES, le.FR_FR, le.GR_GR, le.HU_HU, le.ID_ID, le.IT_IT, le.JA_JP, le.NL_NL, le.PL_PL, le.PT_BR, le.PT_PT, le.SV_SE, le.TR_TR, le.VI_VI], Be = new Map([]), Pe = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onLanguageChanged = new r.Event,
                    t._loggedMissingKeyAliasess = new Set,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (e = this.services.settings.get("language")) && Le.find((function(t) {
                                    return t.alias === e
                                }
                                )) ? (t = Le.find((function(t) {
                                    return t.alias === e
                                }
                                )),
                                this._activeLanguage = t) : (e = this._getBestUserLocale().alias,
                                t = Le.find((function(t) {
                                    return t.alias === e
                                }
                                )),
                                this._activeLanguage = t),
                                this._initializationPromise || (this._initializationPromise = ue().then((function(e) {
                                    i._manager = new v.LocalizationManager(e),
                                    i._manager.setLanguage(i._activeLanguage)
                                }
                                ))),
                                [4, this._initializationPromise];
                            case 1:
                                return n.sent(),
                                De.services.lazyLoad.loadCurrentLanguageFont(!0),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getManager = function() {
                    return this._manager
                }
                ,
                t.prototype.getLocalizeableContent = function(e) {
                    for (var t = this, i = [], o = 1; o < arguments.length; o++)
                        i[o - 1] = arguments[o];
                    var a = r.StringUtility.formatString.apply(r.StringUtility, (0,
                    n.__spreadArray)([this.getText(e, le.EN_US)], i.map((function(e) {
                        return String(e)
                    }
                    )), !1))
                      , s = {};
                    return Le.forEach((function(o) {
                        var a = 2 === o.alias.split("_").length ? "_" : "-"
                          , _ = o.alias.split(a)[0].toLocaleLowerCase() + "_" + o.alias.split(a)[1].toUpperCase();
                        s[_] = r.StringUtility.formatString.apply(r.StringUtility, (0,
                        n.__spreadArray)([t.getText(e, o)], i.map((function(e) {
                            return String(e)
                        }
                        )), !1))
                    }
                    )),
                    {
                        default: a,
                        localizations: s
                    }
                }
                ,
                t.prototype.getText = function(e, t) {
                    var i, r = this._manager.getText(e, t);
                    if (!r || r.includes(Ne)) {
                        var o = "".concat(this._activeLanguage.alias, ":").concat(e.alias);
                        this._loggedMissingKeyAliasess.has(e.alias) || (this._logger.error("missing localization key ".concat(o)),
                        this._loggedMissingKeyAliasess.add(e.alias)),
                        r = this._getFallbackText.apply(this, (0,
                        n.__spreadArray)([e], null !== (i = Be.get(this._activeLanguage)) && void 0 !== i ? i : [le.EN_US], !1))
                    }
                    return r.replace(/\\n/g, "\n")
                }
                ,
                t.prototype.getLanguage = function() {
                    return this._activeLanguage
                }
                ,
                t.prototype.setLanguage = function(e) {
                    this._manager.setLanguage(e),
                    this._activeLanguage = e,
                    this.services.settings.set("language", e.alias),
                    this.onLanguageChanged.fire(e)
                }
                ,
                t.prototype.switchToNextLanguage = function() {
                    var e = Le.indexOf(this._activeLanguage);
                    e = (e + 1) % Le.length;
                    var t = Le[e];
                    this.setLanguage(t)
                }
                ,
                t.localeToBestFitLocale = function(e) {
                    if (!e)
                        throw new Error("No locale provided");
                    for (var t = e.toLowerCase().split(/-|_/), i = t[0], n = t[1], r = le.EN_US, o = 0; o < Le.length; o++) {
                        var a = Le[o]
                          , s = a.alias.toLowerCase().split(/-|_/)
                          , _ = s[0]
                          , c = s[1];
                        if (_ === i && (r = a,
                        c === n))
                            return a
                    }
                    return r
                }
                ,
                t.prototype._getBestUserLocale = function() {
                    var e = vp.platform.localeStrategy.getLocale();
                    "" === e && (this._logger.info("No locale provided by Platform, falling back to browser locale"),
                    e = navigator.language);
                    var i = t.localeToBestFitLocale(e);
                    return i.alias !== e && this._logger.info("picked ".concat(i.alias, " as best fit for ").concat(e)),
                    i
                }
                ,
                t.prototype._getFallbackText = function(e) {
                    for (var t, i = [], n = 1; n < arguments.length; n++)
                        i[n - 1] = arguments[n];
                    for (; !t && i.length > 0; ) {
                        var r = i.shift()
                          , o = this._manager.getText(e, r);
                        o && !o.includes(Ne) && (t = o)
                    }
                    return null != t ? t : "<".concat(e.alias, ">")
                }
                ,
                t
            }(Se);
            !function(e) {
                e[e.SUCCESS = 0] = "SUCCESS",
                e[e.ALREADY_LOGGED_IN = 1] = "ALREADY_LOGGED_IN",
                e[e.USER_CANCELLED = 2] = "USER_CANCELLED",
                e[e.FAILURE = 3] = "FAILURE",
                e[e.UNKNOWN = 4] = "UNKNOWN"
            }(be || (be = {}));
            var ke, xe, Ge, Ue, Fe, Me, Ve, He, je, Ke, We = function() {
                function e() {
                    var e = this;
                    if (this._lastLoginResult = be.UNKNOWN,
                    this._loginModal = document.getElementById("login-modal"),
                    this._loginFormEmail = document.getElementById("email-login-form"),
                    this._loginButtonEmail = document.getElementById("login-button-email"),
                    this._loginFormEmailToken = document.getElementById("email-token-form"),
                    this._emailInputField = document.getElementById("email-login-input"),
                    this._tokenInputField = document.getElementById("email-token-input"),
                    this._loginButtonEmailToken = document.getElementById("login-button-email-token"),
                    this._loginBackButton = document.getElementById("login-back-button"),
                    this._loginButtonFacebook = document.getElementById("login-social-button-facebook"),
                    this._loginButtonGoogle = document.getElementById("login-social-button-google"),
                    this._continueAsGuestButton = document.getElementById("continue-as-guest"),
                    this._emailLoginErrorMessage = document.getElementById("email-login-error-message"),
                    this._socialLoginErrorMessage = document.getElementById("social-login-error-message"),
                    this._isSubmitting = !1,
                    this._nakamaProvider = new s.v8("mOdD10T72nPmC5e543kLhX0TRLpi64Pq",{
                        host: "1187013846746005515.discordsays.com/nakama",
                        publicHost: "1187013846746005515.discordsays.com/publicNakama",
                        port: "",
                        useSSL: !0,
                        connectivity: {
                            autoReconnect: !1
                        }
                    }),
                    this._nakamaAuthVars = {
                        netversion: s.Gf.NET_VERSION.toString()
                    },
                    this._nakamaId = null,
                    this._isNewPlayer = !1,
                    this._deferredLoginPromiseResolve = null,
                    this._localStorageTokenKey = "StandaloneNakamaUserToken",
                    this._localizationManager = null,
                    this._handleGoogleAuthenticationResponse = function(t) {
                        return (0,
                        n.__awaiter)(e, void 0, void 0, (function() {
                            var e, i, r, o;
                            return (0,
                            n.__generator)(this, (function(n) {
                                switch (n.label) {
                                case 0:
                                    return e = t.credential,
                                    i = (0,
                                    pe.o)(e),
                                    null != (r = i.sub) ? [3, 1] : (this._lastLoginResult = be.FAILURE,
                                    [3, 4]);
                                case 1:
                                    return n.trys.push([1, 3, , 4]),
                                    [4, this._authenticateWithNakama(r)];
                                case 2:
                                    return n.sent(),
                                    this._lastLoginResult = be.SUCCESS,
                                    [3, 4];
                                case 3:
                                    return o = n.sent(),
                                    console.log("Google authentication failed:", o),
                                    this._lastLoginResult = be.FAILURE,
                                    this._showSocialErrorMessage(),
                                    this._resetModal(),
                                    [2];
                                case 4:
                                    return this._resetModal(),
                                    this._resolveLoginAttemptAndCloseDialog(),
                                    [2]
                                }
                            }
                            ))
                        }
                        ))
                    }
                    ,
                    this._doFacebookAuthentication = function() {
                        var t = !0;
                        FB.init({
                            appId: FACEBOOK_AUTH_APP_ID,
                            xfbml: !0,
                            version: FACEBOOK_AUTH_SDK_VERSION
                        }),
                        FB.login((function(i) {
                            return (0,
                            n.__awaiter)(e, void 0, void 0, (function() {
                                var e, r;
                                return (0,
                                n.__generator)(this, (function(n) {
                                    switch (n.label) {
                                    case 0:
                                        if (e = i.authResponse,
                                        "connected" !== i.status || void 0 === e.userID || void 0 === e.accessToken || null === e.userID || null === e.accessToken)
                                            return [3, 4];
                                        r = e.userID,
                                        n.label = 1;
                                    case 1:
                                        return n.trys.push([1, 3, , 4]),
                                        [4, this._authenticateWithNakama(r)];
                                    case 2:
                                        return n.sent(),
                                        this._lastLoginResult = be.SUCCESS,
                                        t = !1,
                                        [3, 4];
                                    case 3:
                                        return n.sent(),
                                        t = !0,
                                        [3, 4];
                                    case 4:
                                        return t ? (console.log("User cancelled Facebook login or authorization failed."),
                                        this._lastLoginResult = be.FAILURE,
                                        this._showSocialErrorMessage(),
                                        [2]) : (this._resetModal(),
                                        this._resolveLoginAttemptAndCloseDialog(),
                                        [2])
                                    }
                                }
                                ))
                            }
                            ))
                        }
                        ))
                    }
                    ,
                    this._doEmailAuthentication = function() {
                        return (0,
                        n.__awaiter)(e, void 0, void 0, (function() {
                            var e, t, i, r;
                            return (0,
                            n.__generator)(this, (function(n) {
                                switch (n.label) {
                                case 0:
                                    if (e = vp.platform.localeStrategy.getLocale(),
                                    t = Pe.localeToBestFitLocale(e),
                                    null === this._emailInputField)
                                        return [3, 4];
                                    i = this._emailInputField.value,
                                    n.label = 1;
                                case 1:
                                    return n.trys.push([1, 3, , 4]),
                                    [4, this._nakamaProvider.auth.sendEmailAuthenticationToken(i, t.alias)];
                                case 2:
                                    return n.sent(),
                                    this._swapEmailAndTokenDialog(),
                                    [3, 4];
                                case 3:
                                    return r = n.sent(),
                                    console.warn("Sending e-mail authentication token failed:", r),
                                    [3, 4];
                                case 4:
                                    return [2]
                                }
                            }
                            ))
                        }
                        ))
                    }
                    ,
                    this._doEmailTokenVerification = function() {
                        return (0,
                        n.__awaiter)(e, void 0, void 0, (function() {
                            var e, t, i, r, o;
                            return (0,
                            n.__generator)(this, (function(n) {
                                switch (n.label) {
                                case 0:
                                    if (null === this._emailInputField || null === this._tokenInputField)
                                        return [3, 7];
                                    e = this._emailInputField.value,
                                    t = this._tokenInputField.value,
                                    n.label = 1;
                                case 1:
                                    return n.trys.push([1, 5, , 6]),
                                    [4, this._nakamaProvider.auth.verifyEmailAuthenticationToken(e, t)];
                                case 2:
                                    return [4, null == (i = n.sent()) ? void 0 : i.json()];
                                case 3:
                                    return r = n.sent().customID,
                                    this._isNewPlayer = !0,
                                    [4, this._authenticateWithNakama(r)];
                                case 4:
                                    return n.sent(),
                                    this._lastLoginResult = be.SUCCESS,
                                    [3, 6];
                                case 5:
                                    return o = n.sent(),
                                    console.warn("Verifying e-mail authentication token failed:", o),
                                    this._lastLoginResult = be.FAILURE,
                                    this._showEmailErrorMessage(),
                                    this._tokenInputField.value = "",
                                    this._isSubmitting = !1,
                                    [2];
                                case 6:
                                    this._resetModal(),
                                    this._resolveLoginAttemptAndCloseDialog(),
                                    n.label = 7;
                                case 7:
                                    return this._isSubmitting = !1,
                                    [2]
                                }
                            }
                            ))
                        }
                        ))
                    }
                    ,
                    this._authenticateWithNakama = function(t) {
                        return (0,
                        n.__awaiter)(e, void 0, void 0, (function() {
                            var e, i, r;
                            return (0,
                            n.__generator)(this, (function(n) {
                                switch (n.label) {
                                case 0:
                                    e = !1,
                                    n.label = 1;
                                case 1:
                                    return n.trys.push([1, 3, , 5]),
                                    i = this,
                                    [4, this._nakamaProvider.auth.customAuth(t, t, e)];
                                case 2:
                                    return i._nakamaId = n.sent(),
                                    [3, 5];
                                case 3:
                                    return n.sent(),
                                    e = !0,
                                    r = this,
                                    [4, this._nakamaProvider.auth.customAuth(t, t, e)];
                                case 4:
                                    return r._nakamaId = n.sent(),
                                    this._isNewPlayer = !0,
                                    [3, 5];
                                case 5:
                                    return u(this._localStorageTokenKey, t),
                                    [2]
                                }
                            }
                            ))
                        }
                        ))
                    }
                    ,
                    function(e, t, i) {
                        var n, r, o = e.getElementsByTagName(t)[0];
                        e.getElementById(i) || ((r = e.createElement(t)).id = i,
                        r.src = "https://connect.facebook.net/en_US/sdk.js",
                        null === (n = o.parentNode) || void 0 === n || n.insertBefore(r, o))
                    }(document, "script", "facebook-jssdk"),
                    function(e, t, i) {
                        var n, r, o = e.getElementsByTagName(t)[0];
                        e.getElementById(i) || ((r = e.createElement(t)).id = i,
                        r.src = "https://accounts.google.com/gsi/client",
                        null === (n = o.parentNode) || void 0 === n || n.insertBefore(r, o))
                    }(document, "script", "google-auth-library"),
                    !(this._loginButtonFacebook && this._loginButtonGoogle && this._loginBackButton && this._loginFormEmail && this._loginFormEmailToken && this._loginButtonEmail && this._loginButtonEmailToken && this._continueAsGuestButton && this._tokenInputField && this._socialLoginErrorMessage && this._emailLoginErrorMessage))
                        throw new Error("HTML for standalone authentication modal not available.");
                    this._loginButtonFacebook.addEventListener("click", this._doFacebookAuthentication),
                    this._loginFormEmail.addEventListener("submit", (function(t) {
                        t.preventDefault(),
                        e._doEmailAuthentication()
                    }
                    ));
                    var t = function() {
                        e._isSubmitting || (e._isSubmitting = !0,
                        e._doEmailTokenVerification())
                    };
                    this._loginFormEmailToken.addEventListener("submit", (function(e) {
                        e.preventDefault(),
                        t()
                    }
                    )),
                    this._loginBackButton.addEventListener("click", (function() {
                        return e._swapEmailAndTokenDialog()
                    }
                    )),
                    this._setContinueAsGuestListener(),
                    this._tokenInputField.addEventListener("keyup", (function() {
                        e._tokenInputField && e._tokenInputField.value.length >= 6 && t()
                    }
                    ))
                }
                return Object.defineProperty(e.prototype, "player", {
                    get: function() {
                        return this._player
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.isUserLoggedIn = function() {
                    return [be.ALREADY_LOGGED_IN, be.SUCCESS].includes(this._lastLoginResult)
                }
                ,
                e.prototype.clearLastLoggedInData = function() {
                    this._lastLoginResult = be.UNKNOWN
                }
                ,
                e.prototype.attemptLogin = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, new Promise((function(t) {
                                return (0,
                                n.__awaiter)(e, void 0, void 0, (function() {
                                    var e, i;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        switch (n.label) {
                                        case 0:
                                            if (this.isUserLoggedIn() && t(this._lastLoginResult),
                                            null == (e = l(this._localStorageTokenKey)))
                                                return [3, 5];
                                            n.label = 1;
                                        case 1:
                                            return n.trys.push([1, 3, , 4]),
                                            [4, this._authenticateWithNakama(e)];
                                        case 2:
                                            return n.sent(),
                                            this._lastLoginResult = be.ALREADY_LOGGED_IN,
                                            [3, 4];
                                        case 3:
                                            return i = n.sent(),
                                            console.warn("Issue logging in:", i),
                                            this._lastLoginResult = be.FAILURE,
                                            d(this._localStorageTokenKey),
                                            [2, this.attemptLogin()];
                                        case 4:
                                            return t(this._lastLoginResult),
                                            [3, 7];
                                        case 5:
                                            return [4, this._injectLocalizations()];
                                        case 6:
                                            n.sent(),
                                            this._deferredLoginPromiseResolve = t,
                                            this._openLoginDialog(),
                                            n.label = 7;
                                        case 7:
                                            return [2]
                                        }
                                    }
                                    ))
                                }
                                ))
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.initializeSDK = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, t];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.initializePlayer = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return null == (e = l(this._localStorageTokenKey)) ? [3, 3] : [4, this._nakamaProvider.client.authenticateCustom(e, !1, e, this._nakamaAuthVars)];
                            case 1:
                                return t = n.sent(),
                                [4, this._nakamaProvider.client.getAccount(t)];
                            case 2:
                                if (i = n.sent(),
                                (r = i.user) && null !== r.id && void 0 !== r.id && null !== r.username && void 0 !== r.username)
                                    return this._player = {
                                        id: r.username,
                                        name: r.username,
                                        photo: "NO PHOTO",
                                        isNewAccount: this._isNewPlayer
                                    },
                                    [2];
                                n.label = 3;
                            case 3:
                                return u("FAKE_PLAYER", o = l("FAKE_PLAYER") || (0,
                                c.DM)()),
                                this._player = {
                                    id: o,
                                    name: o,
                                    photo: "NO PHOTO",
                                    isNewAccount: !1
                                },
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.authenticateBackend = function(e) {
                    var t;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r, o, a;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                if (null == (i = l(this._localStorageTokenKey)))
                                    return [3, 9];
                                n.label = 1;
                            case 1:
                                n.trys.push([1, 7, , 9]),
                                r = !1,
                                n.label = 2;
                            case 2:
                                return n.trys.push([2, 4, , 6]),
                                o = this,
                                [4, e.auth.customAuth(i, i, r)];
                            case 3:
                                return o._nakamaId = n.sent(),
                                [3, 6];
                            case 4:
                                return n.sent(),
                                this._player.isNewAccount = this._isNewPlayer = r = !0,
                                a = this,
                                [4, e.auth.customAuth(i, i, r)];
                            case 5:
                                return a._nakamaId = n.sent(),
                                [3, 6];
                            case 6:
                                return [3, 9];
                            case 7:
                                return n.sent(),
                                console.log("Failed authentication with locally stored token. Clearing..."),
                                d(this._localStorageTokenKey),
                                [4, this.attemptLogin()];
                            case 8:
                                return n.sent(),
                                [3, 9];
                            case 9:
                                return [2, null !== (t = this._nakamaId) && void 0 !== t ? t : ""]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.setupBackendAccount = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return i = Math.round((new Date).getTimezoneOffset() / 60),
                            [2, e.playerprofile.setupAccount(this.player.id, this.player.name, this.player.photo, i, t)]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._setContinueAsGuestListener = function() {
                    var e = this;
                    this._continueAsGuestButton = document.getElementById("continue-as-guest"),
                    this._continueAsGuestButton && this._continueAsGuestButton.addEventListener("click", (function(t) {
                        t.preventDefault(),
                        e._resetModal(),
                        e._continueAsGuest()
                    }
                    ))
                }
                ,
                e.prototype._localized = function(e, t) {
                    for (var i = [], o = 2; o < arguments.length; o++)
                        i[o - 2] = arguments[o];
                    if (null === this._localizationManager)
                        throw new Error("Localizaton manager not initialized -- something went wrong.");
                    var a = this._localizationManager.getText(t);
                    return r.StringUtility.formatString.apply(r.StringUtility, (0,
                    n.__spreadArray)([a], i.map((function(e) {
                        return String(e)
                    }
                    )), !1))
                }
                ,
                e.prototype._injectLocalizations = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o, a, s, _, c, l, u, d, h, p, g;
                        return (0,
                        n.__generator)(this, (function(f) {
                            switch (f.label) {
                            case 0:
                                return e = vp.platform.localeStrategy.getLocale(),
                                t = Pe.localeToBestFitLocale(e).alias,
                                null == (i = Le.find((function(e) {
                                    return e.alias === t
                                }
                                ))) ? [2] : [4, ue()];
                            case 1:
                                return r = f.sent(),
                                this._localizationManager = new v.LocalizationManager(r),
                                this._localizationManager.setLanguage(i),
                                null === this._localizationManager ? [2] : (o = document.getElementById("trans-login-facebook"),
                                a = document.getElementById("trans-or"),
                                s = document.getElementById("trans-continue-as-guest"),
                                _ = this._tokenInputField,
                                c = this._emailInputField,
                                l = this._loginButtonEmail,
                                u = this._loginButtonEmailToken,
                                d = this._socialLoginErrorMessage,
                                h = this._emailLoginErrorMessage,
                                o && a && s && _ && c && l && u && d && h ? (o.innerText = this._localized(ke || (ke = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.LOGIN_WITH_FB),
                                a.innerText = this._localized(xe || (xe = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.OR),
                                _.placeholder = this._localized(Ge || (Ge = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.EMAIL_AUTH_TOKEN),
                                c.placeholder = this._localized(Ue || (Ue = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.EXAMPLE_EMAIL_ADDRESS),
                                l.value = this._localized(Fe || (Fe = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.LOGIN),
                                u.value = this._localized(Me || (Me = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.VERIFY),
                                d.innerText = this._localized(Ve || (Ve = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.SOCIAL_LOGIN_ERROR),
                                h.innerText = this._localized(He || (He = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.EMAIL_LOGIN_ERROR),
                                p = this._localized(je || (je = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.CLICK_HERE_TO_CONTINUE_AS_GUEST),
                                g = p.replace("<>", "<a href='#' id='continue-as-guest'>").replace("</>", "</a>"),
                                s.innerHTML = g,
                                this._setContinueAsGuestListener(),
                                [2]) : (console.warn("Translation injection in template failed; falling back to English."),
                                [2]))
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._resolveLoginAttemptAndCloseDialog = function() {
                    null !== this._deferredLoginPromiseResolve && (this._deferredLoginPromiseResolve(this._lastLoginResult),
                    this._deferredLoginPromiseResolve = null),
                    this._closeLoginDialog(),
                    this._resetModal()
                }
                ,
                e.prototype._swapEmailAndTokenDialog = function() {
                    if (this._loginFormEmail && this._loginFormEmailToken && this._loginFormEmailToken) {
                        if (this._loginFormEmail.classList.contains("d-none"))
                            return this._loginFormEmail.classList.remove("d-none"),
                            void this._loginFormEmailToken.classList.add("d-none");
                        this._loginFormEmail.classList.add("d-none"),
                        this._loginFormEmailToken.classList.remove("d-none")
                    }
                }
                ,
                e.prototype._openLoginDialog = function() {
                    if (!this._loginModal)
                        throw new Error("HTML for standalone login modal not available.");
                    google.accounts.id.initialize({
                        client_id: GOOGLE_AUTH_APP_ID,
                        callback: this._handleGoogleAuthenticationResponse
                    }),
                    google.accounts.id.renderButton(this._loginButtonGoogle, {
                        type: "standard",
                        theme: "outline",
                        text: "continue_with",
                        logo_alignment: "left",
                        size: "large",
                        shape: "rectangular",
                        width: 263
                    }),
                    this._loginModal.setAttribute("open", ""),
                    document.documentElement.classList.add("modal-is-open", "modal-is-opening"),
                    setTimeout((function() {
                        document.documentElement.classList.remove("modal-is-open", "modal-is-opening")
                    }
                    ), 400)
                }
                ,
                e.prototype._continueAsGuest = function() {
                    this._deferredLoginPromiseResolve && (this._lastLoginResult = be.USER_CANCELLED,
                    this._deferredLoginPromiseResolve(this._lastLoginResult)),
                    this._closeLoginDialog()
                }
                ,
                e.prototype._closeLoginDialog = function() {
                    if (!this._loginModal)
                        throw new Error("HTML for standalone login modal not available.");
                    this._loginModal.removeAttribute("open")
                }
                ,
                e.prototype._showSocialErrorMessage = function() {
                    if (!this._socialLoginErrorMessage)
                        throw new Error("HTML for standalone login modal not available.");
                    this._socialLoginErrorMessage.classList.remove("d-none")
                }
                ,
                e.prototype._showEmailErrorMessage = function() {
                    if (!this._emailLoginErrorMessage || !this._loginFormEmail)
                        throw new Error("HTML for standalone login modal not available.");
                    this._loginFormEmail.classList.contains("d-none") && this._swapEmailAndTokenDialog(),
                    this._emailLoginErrorMessage.classList.remove("d-none")
                }
                ,
                e.prototype._resetModal = function() {
                    if (!this._socialLoginErrorMessage || !this._emailLoginErrorMessage || !this._loginFormEmail)
                        throw new Error("HTML for standalone login modal not available.");
                    this._socialLoginErrorMessage.classList.contains("d-none") || this._socialLoginErrorMessage.classList.add("d-none"),
                    this._emailLoginErrorMessage.classList.contains("d-none") || this._emailLoginErrorMessage.classList.add("d-none"),
                    this._loginFormEmail.classList.contains("d-none") && this._swapEmailAndTokenDialog()
                }
                ,
                e
            }(), ze = (function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.azerion = new p.Azerion("25060b53c7344ed6876d935bd896fdd2",{
                        fixMonkeyPatch: !0,
                        fixHrefRemoval: !0
                    }),
                    t
                }
                (0,
                n.__extends)(t, e),
                t.prototype.initializeSDK = function(t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this.azerion.initialize()];
                            case 1:
                                return n.sent(),
                                [4, e.prototype.initializeSDK.call(this, t, i)];
                            case 2:
                                return n.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(We),
            function() {
                function e() {}
                return Object.defineProperty(e, "USE_NAKAMA", {
                    get: function() {
                        return this._hasBeenUsed = !0,
                        !this._isDisabledAtRuntime
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.disableNakama = function() {
                    if (this._hasBeenUsed)
                        throw new Error("NakamaFlag.disableNakama() should be called before NakamaFlag.USE_NAKAMA is used");
                    this._isDisabledAtRuntime = !0
                }
                ,
                e.reset = function() {
                    this._isDisabledAtRuntime = !1,
                    this._hasBeenUsed = !1
                }
                ,
                e._isDisabledAtRuntime = !1,
                e._hasBeenUsed = !1,
                e
            }()), Ye = function() {
                function e(e) {
                    this._data = e
                }
                return Object.defineProperty(e.prototype, "parent", {
                    get: function() {
                        return this._parent
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.onAdded = function(e) {
                    this._parent = e
                }
                ,
                e.prototype.onRemoved = function() {
                    this._parent = void 0
                }
                ,
                e.prototype.serialize = function(e) {
                    return void 0 === e && (e = {}),
                    JSON.parse(JSON.stringify(this._data))
                }
                ,
                e.prototype.requireBehavior = function(e, t, i) {
                    if (!this._parent)
                        throw new Error("Behavior.requireBehavior can only be called if the Behavior has a parent");
                    var n = this._parent.getBehavior(e);
                    return n || (n = new t(i),
                    this._parent.addBehavior(n)),
                    n
                }
                ,
                e
            }();
            !function(e) {
                e.Tile = "tile",
                e.Sprite = "sprite",
                e.Spine = "spine",
                e.Movable = "movable",
                e.Clickable = "clickable",
                e.Dropable = "dropable",
                e.AutoPlace = "autoPlace",
                e.Rewardable = "rewardable",
                e.MoveContentToCell = "moveContentToCell",
                e.Ingredient = "ingredient",
                e.Coin = "coin",
                e.Currency = "currency",
                e.GridPosition = "gridPosition",
                e.RestorePosition = "RestorePosition",
                e.Merging = "merging",
                e.Mergeable = "mergeable",
                e.MergeTrigger = "mergeTrigger",
                e.MergeDetection = "mergeDetection",
                e.MergeResult = "mergeResult",
                e.SplitTrigger = "splitTrigger",
                e.Shovelable = "shovelable",
                e.ShowFloater = "showFloater",
                e.InteractionTap = "interactionTap",
                e.InteractionPick = "interactionPick",
                e.InteractionDrag = "interactionDrag",
                e.InteractionDropStart = "interactionDropStart",
                e.InteractionDropEnd = "interactionDropEnd",
                e.InteractionPriorityTurn = "interactionPriorityTurn",
                e.InteractionCancel = "interactionCancel",
                e.Lootable = "lootable",
                e.Harvestable = "harvestable",
                e.Removeable = "removeable",
                e.CoolDown = "cooldown",
                e.ExtendedTile = "extendedTile",
                e.ExtendedTileChild = "extendedTileChild",
                e.Displaceable = "displaceable",
                e.Interpolation = "interpolation",
                e.Sellable = "sellable",
                e.LootReceived = "lootReceived",
                e.LootTrigger = "lootTrigger",
                e.CooldownPreview = "cooldownPreview",
                e.CooldownFinishedTrigger = "cooldownFinishedTrigger",
                e.CooldownPopout = "cooldownPopout",
                e.ResourceGate = "resourceGate",
                e.ResourceGatePaid = "resourceGatePaid",
                e.Crate = "crate",
                e.CreateSpawn = "crateSpawn",
                e.Hitpoints = "hitpoints",
                e.HitpointsPreview = "hitpointsPreview",
                e.MapSource = "mapSource",
                e.Collectable = "collectable",
                e.Building = "building",
                e.Upgrade = "upgrade",
                e.MapAreaPopout = "mapAreaPopout",
                e.AreaLock = "areaLock",
                e.AreaUnlock = "areaUnlock",
                e.AreaUnlockSpawn = "areaUnlockSpawn",
                e.MapResources = "mapResources",
                e.Source = "source",
                e.Order = "order",
                e.Trainstation = "trainstation",
                e.HeavyObject = "heavyObject",
                e.NotEnoughSpace = "notEnoughSpace",
                e.SpawnAnimation = "spawnAnimation",
                e.ShovelAnimation = "shovelAnimation",
                e.TicketAnimation = "ticketAnimation",
                e.Depleted = "depleted",
                e.WorkerData = "workerData",
                e.VisitorAction = "visitorAction",
                e.Animal = "animal",
                e.Crop = "crop",
                e.DeliveryTruck = "deliveryTruck",
                e.FriendReward = "friendReward",
                e.ArrowPointer = "arrowPointer",
                e.HeavyObjectTapped = "heavyObjectTapped",
                e.ObjectDestruction = "objectRemoval",
                e.PlaySoundTrigger = "playSound",
                e.Sounds = "sounds",
                e.Discovery = "discovery",
                e.RainImpact = "rainImpact",
                e.PickupBuildingStart = "pickupBuildingStart",
                e.PickupBuildingSucces = "pickupBuildingSucces",
                e.Workshop = "workshop",
                e.Decorative = "decorative",
                e.UndiscoveredBuilding = "undiscoveredBuilding",
                e.CrateReward = "crateReward",
                e.CrateRewardKey = "crateRewardKey",
                e.WorldPosition = "worldPosition",
                e.StorageBubble = "storageBubble",
                e.StorageBubbleDrag = "storageBubbleDrag",
                e.StorageBubbleDrop = "storageBubbleDrop",
                e.StorageBubbleTap = "storageBubbleTap",
                e.StorageBubblePop = "storageBubblePop",
                e.StorageBubbleShowContent = "storageBubbleShowContent",
                e.StorageBubbleShowContentTrigger = "storageBubbleShowContentTrigger",
                e.StorageBubbleInteractable = "storageBubbleInteractable",
                e.BubbleSpawnContent = "bubbleSpawnContent",
                e.UpgradeCard = "upgradeCard",
                e.SignInBonusGiftBox = "signInBonusGiftBox",
                e.ShortcutBonusGiftBox = "shortcutBonusGiftBox",
                e.Flower = "flower",
                e.GoldenItem = "goldenItem"
            }(Ke || (Ke = {}));
            var Je = {}
              , Xe = i(2213)
              , qe = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.Animal,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "animation", {
                    get: function() {
                        return this._data.animation
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Animal] = qe;
            var Qe = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.AreaLock,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.AreaLock] = Qe;
            var Ze = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.AreaUnlock,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "column", {
                    get: function() {
                        return this._data.column
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.AreaUnlock] = Ze;
            var $e = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.AreaUnlockSpawn,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ze);
            Je[Ke.AreaUnlockSpawn] = $e;
            var et = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.AutoPlace,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "rootPosition", {
                    get: function() {
                        return this._data.rootPosition
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "neighborsOnly", {
                    get: function() {
                        return this._data.neighborsOnly || !1
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.AutoPlace] = et;
            var tt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.BubbleSpawnContent,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "startPosition", {
                    get: function() {
                        return this._data.startPosition
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.BubbleSpawnContent] = tt;
            var it = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Building,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "ID", {
                    get: function() {
                        return this._data.ID
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Building] = it;
            var nt = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.Clickable,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Clickable] = nt;
            var rt = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.Coin,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Coin] = rt;
            var ot = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Collectable,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "reward", {
                    get: function() {
                        return this._data.reward
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Collectable] = ot;
            var at = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.CoolDown,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "timerId", {
                    get: function() {
                        return this._data.timerId
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.CoolDown] = at;
            var st = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.CooldownPopout,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.CooldownPopout] = st;
            var _t = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.CooldownPreview,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.CooldownPreview] = _t;
            var ct = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.Crate,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Crate] = ct;
            var lt, ut = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Upgrade,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "objectCost", {
                    get: function() {
                        return this._data.gameObjectCost
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Upgrade] = ut,
            function(e) {
                e.BRONZE = "bronze",
                e.SILVER = "silver",
                e.GOLD = "gold",
                e.GOLDEN_CARROT = "goldencarrot",
                e.GOLDEN_PUMPKIN = "goldenpumpkin",
                e.GOLDEN_CHRISTMAS = "christmas",
                e.DAILY_CHALLENGE = "dailychallenge",
                e.DAILY_BONUS = "daily_bonus"
            }(lt || (lt = {}));
            var dt, ht = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.CrateReward,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "crateRewardLevel", {
                    get: function() {
                        return this._data.crateRewardLevel
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "crateRewardUnlockRequirement", {
                    get: function() {
                        return this._data.crateRewardUnlockRequirement
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "crateRewardContent", {
                    get: function() {
                        return this._data.crateRewardContent
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "crateRewardLifetime", {
                    get: function() {
                        return this._data.crateRewardLifetime
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "openingAnimation", {
                    get: function() {
                        return this._data.openingAnimation
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.CrateReward] = ht,
            function(e) {
                e.BRONZE = "bronze",
                e.SILVER = "silver",
                e.GOLD = "gold",
                e.GOLDENCARROT = "goldencarrot"
            }(dt || (dt = {}));
            var pt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.CrateRewardKey,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "keyTier", {
                    get: function() {
                        return this._data.tier
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.CrateRewardKey] = pt;
            var vt = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.CreateSpawn,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.CreateSpawn] = vt;
            var gt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Crop,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Crop] = gt;
            var ft = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Currency,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Currency] = ft;
            var Et = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Decorative,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Decorative] = Et;
            var mt = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.Depleted,
                    t.serializable = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Depleted] = mt;
            var yt = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.Displaceable,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Displaceable] = yt;
            var Tt = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.Dropable,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Dropable] = Tt;
            var At = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.ExtendedTile,
                    i.serializable = !1,
                    i._children = [],
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "width", {
                    get: function() {
                        return this._data.width
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "height", {
                    get: function() {
                        return this._data.height
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "popoutXOffset", {
                    get: function() {
                        return this._data.popoutXOffset || 0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "popoutYOffset", {
                    get: function() {
                        return this._data.popoutYOffset || 0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.removeChildren = function() {
                    this._children = []
                }
                ,
                t.prototype.addChild = function(e) {
                    this._children.push(e)
                }
                ,
                t.prototype.getChildren = function() {
                    return this._children
                }
                ,
                t.prototype.getVerticalOffset = function() {
                    return -(this.height - 1) / 2
                }
                ,
                t
            }(Ye);
            Je[Ke.ExtendedTile] = At;
            var Ct = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.ExtendedTileChild,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "parentTile", {
                    get: function() {
                        return this._data.parentTile
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.ExtendedTileChild] = Ct;
            var It = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.Flower,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Flower] = It;
            var St, Ot = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.FriendReward,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "rewardData", {
                    get: function() {
                        return this._data.rewardData
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.FriendReward] = Ot,
            function(e) {
                e.GOLDENCARROT = "goldencarrot",
                e.GOLDENPUMPKIN = "goldenpumpkin",
                e.GOLDENCHRISTMAS = "christmas"
            }(St || (St = {}));
            var bt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.GoldenItem,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "keyType", {
                    get: function() {
                        return this._data.type
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.GoldenItem] = bt;
            var Rt = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        row: t.row,
                        column: t.column
                    }) || this;
                    return i.type = Ke.GridPosition,
                    i.serializable = !1,
                    i.column = t.column,
                    i.row = t.row,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.GridPosition] = Rt;
            var wt, Dt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.ResourceGate,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "cost", {
                    get: function() {
                        return (0,
                        n.__spreadArray)([], this._data.cost, !0)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "duration", {
                    get: function() {
                        return this._data.duration
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "workers", {
                    get: function() {
                        return this._data.workers || 0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.ResourceGate] = Dt,
            function(e) {
                e.ANIMAL = "animal",
                e.CROPS = "crop",
                e.GREENHOUSE = "greenhouse"
            }(wt || (wt = {}));
            var Nt = {
                x: 0,
                y: 0
            }
              , Lt = function(e) {
                function t(t) {
                    var i, r, o, a, s, _, c, l, u, d = this;
                    return (d = e.call(this, t) || this).type = Ke.Harvestable,
                    d.serializable = !1,
                    d._data.sprite.normal.offset = null !== (i = d._data.sprite.normal.offset) && void 0 !== i ? i : (0,
                    n.__assign)({}, Nt),
                    d._data.sprite.dead ? (d._data.sprite.dead.alias = null !== (r = d._data.sprite.dead.alias) && void 0 !== r ? r : d._data.sprite.normal.alias,
                    d._data.sprite.dead.offset = null !== (o = d._data.sprite.dead.offset) && void 0 !== o ? o : d._data.sprite.normal.offset) : d._data.sprite.dead = (0,
                    n.__assign)({}, d._data.sprite.normal),
                    d._data.sprite.regeneration ? (d._data.sprite.regeneration.alias = null !== (_ = null === (s = null === (a = d._data.sprite) || void 0 === a ? void 0 : a.regeneration) || void 0 === s ? void 0 : s.alias) && void 0 !== _ ? _ : d._data.sprite.normal.alias,
                    d._data.sprite.regeneration.offset = null !== (u = null === (l = null === (c = d._data.sprite) || void 0 === c ? void 0 : c.regeneration) || void 0 === l ? void 0 : l.offset) && void 0 !== u ? u : d._data.sprite.normal.offset) : d._data.sprite.regeneration = (0,
                    n.__assign)({}, d._data.sprite.normal),
                    d
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "harvestableType", {
                    get: function() {
                        return this._data.harvestableType
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "sprite", {
                    get: function() {
                        return this._data.sprite
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "harvests", {
                    get: function() {
                        return this._data.harvests
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "duration", {
                    get: function() {
                        return this._data.duration
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "harvestReward", {
                    get: function() {
                        return this._data.harvestReward
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "removeReward", {
                    get: function() {
                        return this._data.removeReward
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "removalCost", {
                    get: function() {
                        return this._data.removalCost
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isUnlimited", {
                    get: function() {
                        return this._data.unlimitedHarvests
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Harvestable] = Lt;
            var Bt = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.HeavyObject,
                    t.serializable = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "tokenKey", {
                    get: function() {
                        return this._data.tokenKey
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "customShareImage", {
                    get: function() {
                        return this._data.customShareImage
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "friendsHelpedIds", {
                    get: function() {
                        return this._data.friendsHelpedIds ? this._data.friendsHelpedIds : []
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.HeavyObject] = Bt;
            var Pt = function(e) {
                function t(t) {
                    var i = e.call(this, (0,
                    n.__assign)({
                        startAsVisible: !1
                    }, t)) || this;
                    return i.type = Ke.Hitpoints,
                    i.serializable = !0,
                    i.max || (i._data.max = 1),
                    void 0 === i._data.current && (i._data.current = i.max),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "max", {
                    get: function() {
                        return this._data.max
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "current", {
                    get: function() {
                        return this._data.current
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isVisible", {
                    get: function() {
                        return this._data.startAsVisible || this._data.current < this._data.max
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Hitpoints] = Pt;
            var kt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.HitpointsPreview,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.HitpointsPreview] = kt;
            var xt = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.Ingredient,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Ingredient] = xt;
            var Gt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.InteractionPriorityTurn,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "group", {
                    get: function() {
                        return this._data.group
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.InteractionPriorityTurn] = Gt;
            var Ut, Ft = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "data", {
                    get: function() {
                        return this._data
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            !function(e) {
                e[e.NONE = 0] = "NONE",
                e[e.SLOW = 1] = "SLOW",
                e[e.FAST = 2] = "FAST"
            }(Ut || (Ut = {}));
            var Mt = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.InteractionDrag,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ft);
            Je[Ke.InteractionDrag] = Mt;
            var Vt = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.Interpolation,
                    t.serializable = !1,
                    t.startPosition = new v.Vector2,
                    t.endPosition = new v.Vector2,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Interpolation] = Vt;
            var Ht = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.LootReceived,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.LootReceived] = Ht;
            var jt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Lootable,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "loot", {
                    get: function() {
                        return this._data.loot
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Lootable] = jt;
            var Kt, Wt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.MapAreaPopout,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "areaId", {
                    get: function() {
                        return this._data.areaId
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.MapAreaPopout] = Wt,
            function(e) {
                e.TREE = "tree",
                e.ROCK = "rock",
                e.TOOLBOX = "toolbox"
            }(Kt || (Kt = {}));
            var zt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.MapSource,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "sourceType", {
                    get: function() {
                        return this._data.type
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "steps", {
                    get: function() {
                        return this._data.steps
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "stepCount", {
                    get: function() {
                        return Object.keys(this._data.steps).length
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "animationOffset", {
                    get: function() {
                        return this._data.animationOffset
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.MapSource] = zt;
            var Yt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.MergeDetection,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "cell", {
                    get: function() {
                        return this._data.cell
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "chain", {
                    get: function() {
                        return this._data.chain
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.MergeDetection] = Yt;
            var Jt = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.MergeResult,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "experience", {
                    get: function() {
                        return this._data.experience
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "rootResultCell", {
                    get: function() {
                        return this._data.rootResultCell
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "extraResults", {
                    get: function() {
                        return this._data.extraResults
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "objectsToSpawn", {
                    get: function() {
                        return this._data.objectsToSpawn
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isBonusMerge", {
                    get: function() {
                        return this._data.isBonusMerge
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isLuckyMerge", {
                    get: function() {
                        return this._data.isLuckyMerge
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "originalContent", {
                    get: function() {
                        return this._data.originalContent
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.MergeResult] = Jt;
            var Xt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.MergeTrigger,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "cell", {
                    get: function() {
                        return this._data.cell
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "chain", {
                    get: function() {
                        return this._data.chain
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.MergeTrigger] = Xt;
            var qt = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Mergeable,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "target", {
                    get: function() {
                        return this._data.target
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "expReward", {
                    get: function() {
                        return this._data.expReward
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "targetSpecification", {
                    get: function() {
                        return this._data.targetSpecification
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "zeroLuckyChance", {
                    get: function() {
                        return this._data.zeroLuckyChance
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Mergeable] = qt;
            var Qt = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.Merging,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Merging] = Qt;
            var Zt = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.Movable,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Movable] = Zt;
            var $t = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.MoveContentToCell,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "originPosition", {
                    get: function() {
                        return this._data.originPosition ? this._data.originPosition : null
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "targetPosition", {
                    get: function() {
                        return this._data.targetPosition
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.MoveContentToCell] = $t;
            var ei = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.NotEnoughSpace,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "spaceNeeded", {
                    get: function() {
                        return this._data.spaceNeeded
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.NotEnoughSpace] = ei;
            var ti = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.ObjectDestruction,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.ObjectDestruction] = ti;
            var ii = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Order,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "order", {
                    get: function() {
                        return this._data.order
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Order] = ii;
            var ni = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.PickupBuildingStart,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "pickupTime", {
                    get: function() {
                        return this._data.pickupTime
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.PickupBuildingStart] = ni;
            var ri = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Removeable,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "duration", {
                    get: function() {
                        return this._data.duration
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "cost", {
                    get: function() {
                        return this._data.cost
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Removeable] = ri;
            var oi = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        column: t.column,
                        row: t.row
                    }) || this;
                    return i.type = Ke.RestorePosition,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "column", {
                    get: function() {
                        return this._data.column
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "row", {
                    get: function() {
                        return this._data.row
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "position", {
                    get: function() {
                        return {
                            column: this.column,
                            row: this.row
                        }
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.RestorePosition] = oi;
            var ai = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Rewardable,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "amount", {
                    get: function() {
                        return this._data.amount
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "items", {
                    get: function() {
                        return this._data.items
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Rewardable] = ai;
            var si = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Sellable,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "duration", {
                    get: function() {
                        return this._data.duration
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Sellable] = si;
            var _i = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.ShortcutBonusGiftBox,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.ShortcutBonusGiftBox] = _i;
            var ci, li = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.Shovelable,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Shovelable] = li,
            function(e) {
                e[e.TextFloater = 0] = "TextFloater",
                e[e.RewardFloater = 1] = "RewardFloater",
                e[e.VisitorActionFloater = 2] = "VisitorActionFloater"
            }(ci || (ci = {}));
            var ui = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.ShowFloater,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "floaterType", {
                    get: function() {
                        return this._data.floaterType
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "data", {
                    get: function() {
                        return this._data
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.isRewardFloater = function(e) {
                    return e.floaterType === ci.RewardFloater
                }
                ,
                t.isTextFloater = function(e) {
                    return e.floaterType === ci.TextFloater
                }
                ,
                t.isSpineFloater = function(e) {
                    return e.floaterType === ci.VisitorActionFloater
                }
                ,
                t
            }(Ye);
            Je[Ke.ShowFloater] = ui;
            var di = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.SignInBonusGiftBox,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.SignInBonusGiftBox] = di;
            var hi = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.Sounds,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "revealSound", {
                    get: function() {
                        return this._data.reveal
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Sounds] = hi;
            var pi = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Source,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "sourceFor", {
                    get: function() {
                        return this._data.sourceFor
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Source] = pi;
            var vi = function(e) {
                function t(i) {
                    var r = e.call(this, (0,
                    n.__assign)({
                        alias: "undefined",
                        anchor: (0,
                        n.__assign)({}, t.anchor),
                        pivot: (0,
                        n.__assign)({}, t.pivot),
                        offset: (0,
                        n.__assign)({}, t.offset)
                    }, i)) || this;
                    return r.type = Ke.Sprite,
                    r.serializable = !1,
                    r
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "offset", {
                    get: function() {
                        return (0,
                        n.__assign)({}, this._data.offset)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "pivot", {
                    get: function() {
                        return (0,
                        n.__assign)({}, this._data.pivot)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "anchor", {
                    get: function() {
                        return (0,
                        n.__assign)({}, this._data.anchor)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "asset", {
                    get: function() {
                        return {
                            alias: this._data.alias
                        }
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "hitArea", {
                    get: function() {
                        return this._data.hitArea
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.anchor = {
                    x: .5,
                    y: .5
                },
                t.pivot = {
                    x: 0,
                    y: 0
                },
                t.offset = {
                    x: 0,
                    y: 0
                },
                t
            }(Ye);
            Je[Ke.Sprite] = vi;
            var gi = function(e) {
                function t(i) {
                    var r = e.call(this, (0,
                    n.__assign)({
                        alias: "undefined",
                        startingState: "undefined",
                        pivot: (0,
                        n.__assign)({}, t.pivot),
                        offset: (0,
                        n.__assign)({}, t.offset),
                        uiImageOffset: (0,
                        n.__assign)({}, t.uiImageOffset)
                    }, i)) || this;
                    return r.type = Ke.Spine,
                    r.serializable = !1,
                    r
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "offset", {
                    get: function() {
                        return (0,
                        n.__assign)({}, this._data.offset)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "pivot", {
                    get: function() {
                        return (0,
                        n.__assign)({}, this._data.pivot)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "asset", {
                    get: function() {
                        return {
                            alias: this._data.alias
                        }
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "uiAsset", {
                    get: function() {
                        return {
                            alias: this._data.uiImage
                        }
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "uiAssetOffset", {
                    get: function() {
                        return (0,
                        n.__assign)({}, this._data.uiImageOffset)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "startingState", {
                    get: function() {
                        return this._data.startingState
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "hitArea", {
                    get: function() {
                        return this._data.hitArea
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.pivot = {
                    x: 0,
                    y: 0
                },
                t.offset = {
                    x: 0,
                    y: 0
                },
                t.uiImageOffset = {
                    x: 0,
                    y: 0
                },
                t
            }(Ye);
            Je[Ke.Spine] = gi;
            var fi = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.TicketAnimation,
                    t.serializable = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.TicketAnimation] = fi;
            var Ei = function(e) {
                function t(t) {
                    var i = e.call(this, (0,
                    n.__assign)({
                        tile: {
                            id: 0,
                            blueprint: "",
                            blueprintOverrides: null,
                            image: "",
                            offset: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, t)) || this;
                    return i.type = Ke.Tile,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "data", {
                    get: function() {
                        return this._data
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.Tile] = Ei;
            var mi = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Trainstation,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Trainstation] = mi;
            var yi = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.UndiscoveredBuilding,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.UndiscoveredBuilding] = yi;
            var Ti = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.UpgradeCard,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "sellForLoot", {
                    get: function() {
                        return this._data.sellForLoot
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "targetObjectTreeIngredient", {
                    get: function() {
                        return this._data.targetObjectTreeIngredient
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.UpgradeCard] = Ti;
            var Ai = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.VisitorAction,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "actionType", {
                    get: function() {
                        return this._data.actionType
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.VisitorAction] = Ai;
            var Ci = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.Workshop,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Workshop] = Ci;
            var Ii = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        x: t.x,
                        y: t.y
                    }) || this;
                    return i.type = Ke.WorldPosition,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "x", {
                    get: function() {
                        return this._data.x
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "y", {
                    get: function() {
                        return this._data.y
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.WorldPosition] = Ii;
            var Si = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.ShovelAnimation,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.ShovelAnimation] = Si;
            var Oi = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.SpawnAnimation,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.SpawnAnimation] = Oi;
            var bi = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.InteractionCancel,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ft);
            Je[Ke.InteractionCancel] = bi;
            var Ri = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.InteractionDropEnd,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ft);
            Je[Ke.InteractionDropEnd] = Ri;
            var wi = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.InteractionDropStart,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ft);
            Je[Ke.InteractionDropStart] = wi;
            var Di = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.InteractionPick,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ft);
            Je[Ke.InteractionPick] = Di;
            var Ni = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.InteractionTap,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ft);
            Je[Ke.InteractionTap] = Ni;
            var Li = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.ArrowPointer,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.ArrowPointer] = Li;
            var Bi = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.StorageBubble,
                    i.serializable = !0,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "content", {
                    get: function() {
                        return this._data.content.concat([])
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.StorageBubble] = Bi;
            var Pi = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.StorageBubbleDrag,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "position", {
                    get: function() {
                        return (new Xe.Point).copyFrom(this._data.position)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.StorageBubbleDrag] = Pi;
            var ki = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.StorageBubbleDrop,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.StorageBubbleDrop] = ki;
            var xi = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.StorageBubbleInteractable,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye)
              , Gi = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.StorageBubblePop,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye)
              , Ui = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.StorageBubbleShowContent,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "enableInteraction", {
                    get: function() {
                        return this._data.enableInteraction
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye)
              , Fi = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.StorageBubbleShowContentTrigger,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye)
              , Mi = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.StorageBubbleTap,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.StorageBubbleTap] = Mi;
            var Vi = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.CooldownFinishedTrigger,
                    t.serializable = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.CooldownFinishedTrigger] = Vi;
            var Hi = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.Discovery,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.Discovery] = Hi;
            var ji = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.LootTrigger,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.LootTrigger] = ji;
            var Ki = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.PickupBuildingSucces,
                    t.serializable = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.PickupBuildingSucces] = Ki;
            var Wi = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.PlaySoundTrigger,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "mergeData", {
                    get: function() {
                        return this._data.mergeData
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "spawnData", {
                    get: function() {
                        return this._data.spawnData
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "workersData", {
                    get: function() {
                        return this._data.workersData
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.PlaySoundTrigger] = Wi;
            var zi = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.type = Ke.RainImpact,
                    i.serializable = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.RainImpact] = zi;
            var Yi = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.type = Ke.ResourceGatePaid,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Ye);
            Je[Ke.ResourceGatePaid] = Yi;
            var Ji = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.DeliveryTruck,
                    t.serializable = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "animation", {
                    get: function() {
                        return this._data.animation
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.DeliveryTruck] = Ji;
            var Xi, qi = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.type = Ke.WorkerData,
                    t.serializable = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "workerID", {
                    get: function() {
                        return this._data.id
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Ye);
            Je[Ke.WorkerData] = qi,
            function(e) {
                e.BONUS_WORKER = "chopchop",
                e.PIGGYBANK = "piggybank",
                e.GOLDEN_CARROT = "goldencarrot",
                e.GOLDEN_PUMPKIN = "goldenpumpkin",
                e.GOLDEN_CHRISTMAS = "christmas",
                e.HALLOWEEN_SHOP = "halloweenshop",
                e.CHRISTMAS_SHOP = "christmasshop",
                e.BLACK_FRIDAY_SHOP = "blackfridayshop",
                e.CHRISTMAS_DEALS_SHOP = "christmasdealsshop"
            }(Xi || (Xi = {}));
            var Qi, Zi, $i, en, tn, nn, rn, on, an, sn, _n, cn, ln, un, dn = function() {
                function e(e) {
                    this._logger = r.Logger.Of("AnalyticsSubservice"),
                    this._queue = [],
                    this._isInitialized = !1,
                    this._service = e
                }
                return Object.defineProperty(e.prototype, "isInitialized", {
                    get: function() {
                        return this._isInitialized
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.start = function() {
                    this._isInitialized = !0,
                    this._queue.forEach(this.sendEvent, this),
                    this._queue = []
                }
                ,
                e.prototype.processEvent = function(e) {
                    var t;
                    Array.isArray(e) || (e = [e]),
                    this.isInitialized ? e.forEach(this.sendEvent, this) : (t = this._queue).push.apply(t, e)
                }
                ,
                e
            }();
            !function(e) {
                e.START = "start",
                e.COLLECT = "collect",
                e.WORK_PROGRESS_SHOW = "workInProgressShown",
                e.OUT_OF_ENERGY = "outOfEnergy"
            }(Qi || (Qi = {})),
            function(e) {
                e.SPAWNED_10 = "spawned_10",
                e.NO_SPACE_SHOWN = "noSpaceShown",
                e.OUT_OF_CRATES = "outOfCrates"
            }(Zi || (Zi = {})),
            function(e) {
                e.START = "start",
                e.COLLECT = "collect"
            }($i || ($i = {})),
            function(e) {
                e.CLICKED = "clicked",
                e.BUTTON_CHANGE_DESTINATION = "button_changeDestination",
                e.CHANGED_DESTINATION = "changedDestination",
                e.BUTTON_VISIT = "button_visit"
            }(en || (en = {})),
            function(e) {
                e.PROMPTED = "prompted",
                e.CANCELLED = "cancelled",
                e.SUCCESSFUL = "successful"
            }(tn || (tn = {})),
            function(e) {
                e.FRIEND = "friend",
                e.BOT = "bot"
            }(nn || (nn = {})),
            function(e) {
                e.AVAILABLE = "available",
                e.USED = "used"
            }(rn || (rn = {})),
            function(e) {
                e.OPEN_POPOUT = "openPopout",
                e.BUTTON_ASK_HELP = "button_askHelp",
                e.PLAYER_HELPED = "playerHelped"
            }(on || (on = {})),
            function(e) {
                e.PRELOADING = "preloading",
                e.SPLASH_SCREEN = "splash_screen",
                e.AUTHORIZE_PROVIDER = "authorize_provider",
                e.INITIALIZE_GAME_SERVICES = "initialize_game_services"
            }(an || (an = {})),
            function(e) {
                e.heavy_object_traktor = "tractor",
                e.heavy_object_hay = "haybale",
                e.heavy_object_wheel = "wheel"
            }(sn || (sn = {})),
            function(e) {
                e.RV = "fakeRewardedVideo",
                e.INTERSTITIAL = "fakeInterstitial"
            }(_n || (_n = {})),
            function(e) {
                e.SHOW = "show",
                e.CANCELLED = "cancelled",
                e.COMPLETE = "complete",
                e.CLOSED = "closed"
            }(cn || (cn = {})),
            function(e) {
                e.INTRODUCTION = "introduction",
                e.MERGE_TIER_1 = "merge_tier_1",
                e.MERGE_TIER_2 = "merge_tier_2",
                e.MOVE_OBJECTS_TO_ALIGN_THEM = "move_objects_to_align_them",
                e.MERGE_TIER_3 = "merge_tier_3",
                e.HARVEST = "harvest",
                e.COLLECT_INGREDIENTS = "collect_the_ingredients",
                e.ORDER_INTRODUCED = "orders_introduced",
                e.START_ORDER = "start_order",
                e.WAIT_FOR_ORDER_OR_SKIP = "wait_for_order_or_skip_for_free",
                e.COMPLETE_ORDER = "complete_orderer",
                e.COLLECT_COINS_FROM_ORDER = "collect_coins_from_order",
                e.EXPAND = "expand",
                e.EXPAND_SUCCESSFUL = "expand_successful",
                e.SUPPLY_DELIVERIES = "supply_deliveries",
                e.MERGE_BONUS = "merge_bonus",
                e.REGAIN_CONTROL = "control_back_to_the_player",
                e.VISIT_FRIENDS_TRAIN_TICKETS = "visit_friends_train_ticket",
                e.VISIT_FRIENDS_TRAIN_STATION = "visit_friends_train_station",
                e.VISIT_FRIENDS_DESTINATION_POPUP = "visit_friends_destination_popup",
                e.CLEAR_NATURE_TO_REPAIR = "clear_nature_to_repair_food_truck",
                e.CLEAR_NATURE_TO_REPAIR_START_COLLECTING_RESOURCES = "clear_nature_to_repair_food_truck_start_collecting_resources",
                e.CLEAR_NATURE_TO_REPAIR_REPAIR_THE_BUILDING = "clear_nature_to_repair_food_truck_repair_building",
                e.HEAVY_OBJECT_INTRODUCTION = "heavy_object_introduction",
                e.HEAVY_OBJECT_DEPENDING_ON_FRIENDS = "heavy_object_depending_on_friends",
                e.HEAVY_OBJECT_COMPLETE = "heavy_object_complete",
                e.VISIT_FRIENDS_ACTIVITIES = "visit_friends_activities",
                e.VISIT_FRIENDS_RETURN_HOME = "visit_friends_return_home",
                e.MERGE_VISUAL_INSTRUCTIONS = "merge_visual_instructions",
                e.REGENERATION_VISUAL_INSTRUCTIONS = "regeneration_visual_instructions",
                e.DECORATIVE_OBJECT_INTRODUCTION = "decorative_object_introduction",
                e.REWARD_CRATE_INTRODUCTION = "reward_crate_introduction",
                e.GREENHOUSE_MERGE_CHAIN_INTRODUCTION = "greenhouse_merge_chain_introduction",
                e.FLOWERS_INTRODUCTION = "flowers_introduction",
                e.UPGRADE_CARD_INTRODUCTION = "upgrade_card_introduction"
            }(ln || (ln = {})),
            function(e) {
                e.AVAILABLE = "available",
                e.OPENED = "opened",
                e.SUBMISSIONCOMPLETE = "submissionComplete",
                e.SUBMISSIONFAILED = "submissionFailed"
            }(un || (un = {}));
            var hn, pn = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._loadingStartTimestamp = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.setQualitySettingsAlias = function(e) {
                    this._qualitySettingsAlias ? this._service.logger.warn("Can't set the asset quality setting alias more than once!") : this._qualitySettingsAlias = e
                }
                ,
                t.prototype.enterTheGame = function(e, t) {
                    this.processEvent({
                        eventIds: ["session", "entryPoint", e, t]
                    })
                }
                ,
                t.prototype.shortcutEvent = function(e) {
                    this.processEvent({
                        eventIds: ["shortcut", e]
                    })
                }
                ,
                t.prototype.startNewSession = function() {
                    this._service.model.totalSessions > 100 || this.processEvent({
                        eventIds: ["session", "totalSessions", String(this._service.model.totalSessions)]
                    })
                }
                ,
                t.prototype.startNewDaySession = function() {
                    this.processEvent({
                        eventIds: ["daysPlayed", String(this._service.model.totalDays)]
                    })
                }
                ,
                t.prototype.gameBotStatus = function(e) {
                    this.processEvent({
                        eventIds: ["gamebot", e]
                    })
                }
                ,
                t.prototype.areaProgress = function(e, t) {
                    var i = ("0" + t).slice(-2);
                    this.processEvent({
                        eventIds: ["progression", "area", i, e],
                        value: this._service.model.totalSessions
                    })
                }
                ,
                t.prototype.levelProgress = function(e) {
                    this.processEvent({
                        eventIds: ["progression", "level", String(e)],
                        value: this._service.model.totalSessions
                    })
                }
                ,
                t.prototype.buildingRepaired = function(e) {
                    this.processEvent({
                        eventIds: ["progression", "buildingRepaired", e]
                    })
                }
                ,
                t.prototype.decorativeBuildingRepaired = function(e) {
                    this.processEvent({
                        eventIds: ["decorations", e, "repaired"]
                    })
                }
                ,
                t.prototype.decorativeBuildingDiscovered = function(e) {
                    this.processEvent({
                        eventIds: ["decorations", e, "discovered"]
                    })
                }
                ,
                t.prototype.mergeResult = function(e) {
                    var t = e ? "bonus" : "normal";
                    this.processEvent({
                        eventIds: ["gameplay", "merge", t]
                    })
                }
                ,
                t.prototype.harvestTap = function() {
                    this.processEvent({
                        eventIds: ["gameplay", "harvest"]
                    })
                }
                ,
                t.prototype.orderStatus = function(e) {
                    this.processEvent({
                        eventIds: ["gameplay", "order", e]
                    })
                }
                ,
                t.prototype.workOnNature = function(e) {
                    this.processEvent({
                        eventIds: ["gameplay", "nature", e]
                    })
                }
                ,
                t.prototype.cratesStatus = function(e) {
                    this.processEvent({
                        eventIds: ["gameplay", "crates", e]
                    })
                }
                ,
                t.prototype.shovelUsed = function() {
                    this.processEvent({
                        eventIds: ["shovel", "used"]
                    })
                }
                ,
                t.prototype.ticketAvailable = function() {
                    this.processEvent({
                        eventIds: ["social", "visiting", "trainTicket", "available"]
                    })
                }
                ,
                t.prototype.trainStationSteps = function(e) {
                    this.processEvent({
                        eventIds: ["social", "visiting", "trainStation", e]
                    })
                }
                ,
                t.prototype.contextBeforeVisiting = function(e) {
                    this.processEvent({
                        eventIds: ["social", "visiting", "switchContext", e]
                    })
                }
                ,
                t.prototype.destinationType = function(e) {
                    this.processEvent({
                        eventIds: ["social", "visiting", "destination", e]
                    })
                }
                ,
                t.prototype.dailyBonus = function(e) {
                    this.processEvent({
                        eventIds: ["social", "visiting", "dailyBonus", e]
                    })
                }
                ,
                t.prototype.friendReward = function() {
                    this.processEvent({
                        eventIds: ["social", "visiting", "friendActivity", "collected"]
                    })
                }
                ,
                t.prototype.heavyObjectInteraction = function(e, t, i) {
                    this.processEvent({
                        eventIds: ["social", "heavyObjects", e, "".concat(t, "_area").concat(i)]
                    })
                }
                ,
                t.prototype.startLoading = function(e) {
                    this._loadingStartTimestamp.set(e, Date.now()),
                    this.processEvent({
                        eventIds: ["loading", e, "start"]
                    })
                }
                ,
                t.prototype.completeLoading = function(e) {
                    var t = this._loadingStartTimestamp.get(e);
                    if ((0,
                    r.isUndefined)(t))
                        this._service.logger.error("Can't send the loading event for the id: ".concat(e, ", it is not in the timestamp map"));
                    else {
                        this._loadingStartTimestamp.delete(e);
                        var i = Math.round((Date.now() - t) / 1e3)
                          , n = [{
                            eventIds: ["loading", e, "complete"],
                            value: i
                        }, {
                            eventIds: ["loading", e, "loadingDuration", "".concat(Math.min(i, 60))]
                        }];
                        this._qualitySettingsAlias && n.push({
                            eventIds: ["loading", e, "loadingDuration_".concat(this._qualitySettingsAlias), "".concat(Math.min(i, 60))]
                        }),
                        this.processEvent(n)
                    }
                }
                ,
                t.prototype.sendFriendsAmount = function(e) {
                    this.processEvent({
                        eventIds: ["social", "friendsAvailable", String(Math.min(e, 100))]
                    })
                }
                ,
                t.prototype.friendsForCratesPopupStatus = function(e) {
                    this.processEvent({
                        eventIds: ["social", "inviteForCrates", e]
                    })
                }
                ,
                t.prototype.marketplacePopupStatus = function(e) {
                    this.processEvent({
                        eventIds: ["marketplace", e]
                    })
                }
                ,
                t.prototype.marketplaceItemClicked = function(e, t, i) {
                    var n = ["marketplace", e, t];
                    i && n.push(i),
                    this.processEvent({
                        eventIds: n
                    })
                }
                ,
                t.prototype.feedbackFormTriggeredStatus = function(e, t) {
                    t ? this.processEvent({
                        eventIds: ["feedbackForm", e, t]
                    }) : this.processEvent({
                        eventIds: ["feedbackForm", e]
                    })
                }
                ,
                t.prototype.rvAppear = function(e) {
                    this.processEvent({
                        eventIds: ["monetization", "rewardedVideos", e, "appear"]
                    })
                }
                ,
                t.prototype.rvStarted = function(e) {
                    this.processEvent({
                        eventIds: ["monetization", "rewardedVideos", e, "started"]
                    })
                }
                ,
                t.prototype.transitionADShown = function() {
                    this.processEvent({
                        eventIds: ["monetization", "interstitials", "transitionScreen", "showAttempt"]
                    })
                }
                ,
                t.prototype.reportLevelupInterstitialAttempt = function() {
                    this.processEvent({
                        eventIds: ["monetization", "interstitials", "levelup", "showAttempt"]
                    })
                }
                ,
                t.prototype.reportFakeAd = function(e, t) {
                    this.processEvent({
                        eventIds: ["monetization", e, t]
                    })
                }
                ,
                t.prototype.startOnboardingStep = function(e) {
                    this.processEvent({
                        eventIds: ["onboarding", "step", e, "start"]
                    })
                }
                ,
                t.prototype.finishOnboardingStep = function(e) {
                    this.processEvent({
                        eventIds: ["onboarding", "step", e, "complete"]
                    })
                }
                ,
                t.prototype.newPlayerJoined = function(e) {
                    this.processEvent({
                        eventIds: ["social", e, "newPlayerJoined"]
                    })
                }
                ,
                t.prototype.fps = function(e) {
                    e = Math.min(60, e),
                    this.processEvent({
                        eventIds: ["performance", "FPS", Math.round(e).toString()]
                    })
                }
                ,
                t.prototype.reportWatchedAdStatus = function(e, t) {
                    this.processEvent({
                        eventIds: ["monetization", e, t]
                    })
                }
                ,
                t.prototype.reportInvalidInteraction = function(e, t) {
                    this.processEvent({
                        eventIds: ["onboarding", "invalidAction", e, t]
                    })
                }
                ,
                t.prototype.reportOnboardingSkipped = function(e) {
                    this.processEvent({
                        eventIds: ["onboarding", "skipOnboarding", e]
                    })
                }
                ,
                t.prototype.reportOnboardingCrateSpawned = function(e) {
                    this.processEvent({
                        eventIds: ["onboarding", "step", "spawncrate", "".concat(e)]
                    })
                }
                ,
                t.prototype.reportDiscoveryDiaryOpened = function() {
                    this.processEvent({
                        eventIds: ["discoveryDiary", "opened"]
                    })
                }
                ,
                t.prototype.reportDiscoveryDiaryExclamationMarkShown = function() {
                    this.processEvent({
                        eventIds: ["discoveryDiary", "showExclamationMark"]
                    })
                }
                ,
                t.prototype.reportSoundFxTriggered = function(e) {
                    this.processEvent({
                        eventIds: ["settings", "soundFX", e]
                    })
                }
                ,
                t.prototype.reportMusicFxTriggered = function(e) {
                    this.processEvent({
                        eventIds: ["settings", "musicFX", e]
                    })
                }
                ,
                t.prototype.reportPremiumLandPopupOpened = function(e) {
                    this.processEvent({
                        eventIds: ["monetization", "premiumAreas", e, "clicked"]
                    })
                }
                ,
                t.prototype.reportPremiumLandPurchased = function(e) {
                    this.processEvent({
                        eventIds: ["monetization", "premiumAreas", e, "purchased"]
                    })
                }
                ,
                t.prototype.reportFindNeighboursButtonShown = function() {
                    this.processEvent({
                        eventIds: ["social", "community", "findNeighbours", "shown"]
                    })
                }
                ,
                t.prototype.reportFindNeighboursButtonPressed = function() {
                    this.processEvent({
                        eventIds: ["social", "community", "findNeighbours", "pressed"]
                    })
                }
                ,
                t.prototype.reportFollowOfficialGroupAyncResult = function(e) {
                    this.processEvent({
                        eventIds: ["social", "community", "findNeighbours", e]
                    })
                }
                ,
                t.prototype.reportMailboxExclamationShown = function() {
                    this.processEvent({
                        eventIds: ["mailbox", "exclamationShown"]
                    })
                }
                ,
                t.prototype.reportMailboxPressed = function() {
                    this.processEvent({
                        eventIds: ["mailbox", "buttonPressed"]
                    })
                }
                ,
                t.prototype.reportFollowedPageResult = function(e) {
                    this.processEvent({
                        eventIds: ["mailbox", "followpage", e]
                    })
                }
                ,
                t.prototype.reportExtraWorkerOverlayAction = function(e) {
                    this.processEvent({
                        eventIds: ["monetization", "extraWorker", e]
                    })
                }
                ,
                t.prototype.reportExtraWorkersActive = function(e) {
                    this.processEvent({
                        eventIds: ["monetization", "extraWorker", "extraWorkersActive", e.toString()]
                    })
                }
                ,
                t.prototype.reportNewTaskStarted = function(e) {
                    this.processEvent({
                        eventIds: ["tasks", "started", e.toString()]
                    })
                }
                ,
                t.prototype.reportTaskCompleted = function(e) {
                    this.processEvent({
                        eventIds: ["tasks", "completed", e.toString()]
                    })
                }
                ,
                t.prototype.reportTaskPopupOpened = function() {
                    this.processEvent({
                        eventIds: ["tasks", "popup", "show"]
                    })
                }
                ,
                t.prototype.reportTaskTrackButtonPressed = function() {
                    this.processEvent({
                        eventIds: ["tasks", "popup", "button_track"]
                    })
                }
                ,
                t.prototype.reportRewardedChestSpawned = function(e) {
                    this.processEvent({
                        eventIds: ["rewardChests", e, "spawned"]
                    })
                }
                ,
                t.prototype.reportRewardedChestUnlocked = function(e) {
                    this.processEvent({
                        eventIds: ["rewardChests", e, "unlocked"]
                    })
                }
                ,
                t.prototype.reportRewardedMissingKeysPopupAppeared = function(e) {
                    this.processEvent({
                        eventIds: ["rewardChests", e, "missingKeysPopup", "show"]
                    })
                }
                ,
                t.prototype.reportRewardedMissingKeysPopupPurchasePressed = function(e) {
                    this.processEvent({
                        eventIds: ["rewardChests", e, "missingKeysPopup", "purchasePressed"]
                    })
                }
                ,
                t.prototype.reportRewardedMissingKeysPopupPurchaseComplete = function(e) {
                    this.processEvent({
                        eventIds: ["rewardChests", e, "missingKeysPopup", "purchaseComplete"]
                    })
                }
                ,
                t.prototype.reportKeyTypeSpawned = function(e) {
                    this.processEvent({
                        eventIds: ["keys", e, "spawned"]
                    })
                }
                ,
                t.prototype.reportAmountOfMissingKeysPurchased = function(e, t) {
                    this.processEvent({
                        eventIds: ["keys", e, "purchased", "".concat(t)]
                    })
                }
                ,
                t.prototype.reportToolboxSpawned = function(e) {
                    this.processEvent({
                        eventIds: ["tools", "toolbox", "spawned", e]
                    })
                }
                ,
                t.prototype.reportToolboxUsed = function() {
                    this.processEvent({
                        eventIds: ["tools", "toolbox", "used"]
                    })
                }
                ,
                t.prototype.reportToolSpawned = function() {
                    this.processEvent({
                        eventIds: ["tools", "tool", "spawned"]
                    })
                }
                ,
                t.prototype.reportToolMerged = function() {
                    this.processEvent({
                        eventIds: ["tools", "tool", "merged"]
                    })
                }
                ,
                t.prototype.reportUpgradeCardSpawned = function(e) {
                    this.processEvent({
                        eventIds: ["upgrades", "spawned", e]
                    })
                }
                ,
                t.prototype.reportUpgradeCardActivated = function(e, t) {
                    this.processEvent({
                        eventIds: ["upgrades", "activated", e, t.toString()]
                    })
                }
                ,
                t.prototype.reportUpgradeCardMerged = function(e, t) {
                    this.processEvent({
                        eventIds: ["upgrades", "merged", e, t.toString()]
                    })
                }
                ,
                t.prototype.reportUpgradeCardSold = function(e) {
                    this.processEvent({
                        eventIds: ["upgrades", "sold", e.toString()]
                    })
                }
                ,
                t.prototype.reportFreebieOfferInitialized = function() {
                    this.processEvent({
                        eventIds: ["monetization", "freebieOffer", "initialized"]
                    })
                }
                ,
                t.prototype.reportFreebieOfferPurchaseButtonPressed = function() {
                    this.processEvent({
                        eventIds: ["monetization", "freebieOffer", "purchasePressed"]
                    })
                }
                ,
                t.prototype.reportFreebieOfferPurchaseComplete = function() {
                    this.processEvent({
                        eventIds: ["monetization", "freebieOffer", "purchaseComplete"]
                    })
                }
                ,
                t.prototype.reportFreebieOfferPopupManuallyOpened = function() {
                    this.processEvent({
                        eventIds: ["monetization", "freebieOffer", "manuallyOpened"]
                    })
                }
                ,
                t.prototype.reportFreebieOfferPopupAutoOpened = function() {
                    this.processEvent({
                        eventIds: ["monetization", "freebieOffer", "automaticallyOpened"]
                    })
                }
                ,
                t.prototype.reportIncentivePopupOpened = function(e, t) {
                    this.processEvent({
                        eventIds: [e, "incentivePopup", "shown", t]
                    })
                }
                ,
                t.prototype.reportIncentivePopupClosed = function(e) {
                    this.processEvent({
                        eventIds: [e, "incentivePopup", "closed"]
                    })
                }
                ,
                t.prototype.reportLoginButtonPressed = function() {
                    this.processEvent({
                        eventIds: ["msLogin", "incentivePopup", "loginButtonPressed"]
                    })
                }
                ,
                t.prototype.reportShortcutButtonPressed = function() {
                    this.processEvent({
                        eventIds: ["shortcut", "incentivePopup", "addShortcutButtonPressed"]
                    })
                }
                ,
                t.prototype.reportEconomyAtStartSession = function(e, t) {
                    this.processEvent({
                        eventIds: ["economy", "amountOfCoins"],
                        value: e
                    }),
                    this.processEvent({
                        eventIds: ["economy", "amountOfGems"],
                        value: t
                    })
                }
                ,
                t.prototype.reportGreenhousePieceSpawned = function(e) {
                    this.processEvent({
                        eventIds: ["greenHouse", "spawned", e]
                    })
                }
                ,
                t.prototype.reportGreenhousePieceMerged = function(e) {
                    this.processEvent({
                        eventIds: ["greenHouse", "merged", e]
                    })
                }
                ,
                t.prototype.reportGreenhouseCompleted = function(e) {
                    this.processEvent({
                        eventIds: ["greenHouse", "completed", e.toString()]
                    })
                }
                ,
                t.prototype.reportGreenhouseHarvest = function() {
                    this.processEvent({
                        eventIds: ["greenHouse", "harvested"]
                    })
                }
                ,
                t.prototype.reportSaplingSpawned = function(e) {
                    this.processEvent({
                        eventIds: ["greenHouse", "saplings", "spawned", e]
                    })
                }
                ,
                t.prototype.reportSaplingMerged = function(e) {
                    this.processEvent({
                        eventIds: ["greenHouse", "saplings", "merged", e]
                    })
                }
                ,
                t.prototype.reportFlowerSpawned = function(e) {
                    this.processEvent({
                        eventIds: ["greenHouse", "flowers", "spawned", e]
                    })
                }
                ,
                t.prototype.reportFlowerShoveled = function(e) {
                    this.processEvent({
                        eventIds: ["greenHouse", "flowers", "shoveled", e]
                    })
                }
                ,
                t.prototype.reportGaryVisited = function() {
                    this.processEvent({
                        eventIds: ["greenHouse", "visitedGary"]
                    })
                }
                ,
                t.prototype.reportTimedEventPopupInitiated = function(e) {
                    this.processEvent({
                        eventIds: ["events", e, "initiated"]
                    })
                }
                ,
                t.prototype.reportTimedEventPopupAutomaticallyOpened = function(e) {
                    this.processEvent({
                        eventIds: ["events", e, "automaticallyOpened"]
                    })
                }
                ,
                t.prototype.reportTimedEventPopupManuallyOpened = function(e) {
                    this.processEvent({
                        eventIds: ["events", e, "manuallyOpened"]
                    })
                }
                ,
                t.prototype.reportFreeExtraWorkerUsed = function() {
                    this.processEvent({
                        eventIds: ["events", Xi.BONUS_WORKER, "extraWorkerUsed"]
                    })
                }
                ,
                t.prototype.reportPiggyBankPurchaseButtonUnlocked = function() {
                    this.processEvent({
                        eventIds: ["events", Xi.PIGGYBANK, "purchaseButtonUnlocked"]
                    })
                }
                ,
                t.prototype.reportPiggyBankPurchaseButtonPressed = function() {
                    this.processEvent({
                        eventIds: ["events", Xi.PIGGYBANK, "purchaseButtonPressed"]
                    })
                }
                ,
                t.prototype.reportPiggyBankPurchaseSuccessful = function(e) {
                    this.processEvent({
                        eventIds: ["events", Xi.PIGGYBANK, "purchaseSuccesful", "".concat(e)]
                    })
                }
                ,
                t.prototype.reportMSNotificationEntryPoint = function() {
                    this.processEvent({
                        eventIds: ["notifications", "clicked"]
                    })
                }
                ,
                t.prototype.reportGoldenEventItemRewardClaimed = function(e, t) {
                    this.processEvent({
                        eventIds: ["events", e, "rewardClaimed", t]
                    })
                }
                ,
                t.prototype.reportGoldenItemSpawned = function(e) {
                    this.processEvent({
                        eventIds: ["events", e, "spawned"]
                    })
                }
                ,
                t.prototype.reportStoragePopoutShown = function() {
                    this.processEvent({
                        eventIds: ["storage", "popout", "show"]
                    })
                }
                ,
                t.prototype.reportStoragePopoutMoveToStorageButtonPressed = function() {
                    this.processEvent({
                        eventIds: ["storage", "popout", "button_moveToStorage"]
                    })
                }
                ,
                t.prototype.reportStoragePopupShown = function() {
                    this.processEvent({
                        eventIds: ["storage", "decorationStorage", "show"]
                    })
                }
                ,
                t.prototype.reportStoragePopupPlaceButtonPressed = function() {
                    this.processEvent({
                        eventIds: ["storage", "decorationStorage", "button_place"]
                    })
                }
                ,
                t.prototype.reportStorageIsFullPopupShown = function() {
                    this.processEvent({
                        eventIds: ["storage", "storageIsFull", "show"]
                    })
                }
                ,
                t.prototype.reportStorageOnboardingPopupShown = function() {
                    this.processEvent({
                        eventIds: ["storage", "explanationPopup", "opened"]
                    })
                }
                ,
                t.prototype.reportStorageOccupiedSlots = function(e) {
                    this.processEvent({
                        eventIds: ["storage", "storageSlotsOccupied", e.toString()]
                    })
                }
                ,
                t.prototype.reportShopPopupCloseButtonPressed = function(e) {
                    this.processEvent({
                        eventIds: ["events", e, "shopAnnouncement", "button_close"]
                    })
                }
                ,
                t.prototype.reportShopPopupShopButtonPressed = function(e) {
                    this.processEvent({
                        eventIds: ["events", e, "shopAnnouncement", "button_shop"]
                    })
                }
                ,
                t.prototype.reportEventMarketplaceTabOpened = function(e) {
                    this.processEvent({
                        eventIds: ["events", e, "shop", "show"]
                    })
                }
                ,
                t.prototype.reportEventMarketplaceItemPurchased = function(e, t) {
                    this.processEvent({
                        eventIds: ["events", e, "shop", "purchase_".concat(t)]
                    })
                }
                ,
                t.prototype.reportDisplayAdRequested = function() {
                    this.processEvent({
                        eventIds: ["monetization", "displayAds", "showAttempt"]
                    })
                }
                ,
                t.prototype.reportDisplayAdSuccesfullShow = function() {
                    this.processEvent({
                        eventIds: ["monetization", "displayAds", "resolved"]
                    })
                }
                ,
                t.prototype.reportDisplayAdRejected = function(e) {
                    this.processEvent({
                        eventIds: ["monetization", "displayAds", "rejected_".concat(e)]
                    })
                }
                ,
                t.prototype.dailyBonusPopupShown = function() {
                    this.processEvent({
                        eventIds: ["events", "dailybonus", "shown"]
                    })
                }
                ,
                t.prototype.dailyBonusCollected = function(e) {
                    this.processEvent({
                        eventIds: ["events", "dailybonus", "collected", e.toString()]
                    })
                }
                ,
                t.prototype.dailyBonusStreakLost = function(e) {
                    this.processEvent({
                        eventIds: ["events", "dailybonus", "streak_broken", e.toString()]
                    })
                }
                ,
                t.prototype.reportAdStrategyInitializationResult = function(e, t, i) {
                    var n = [e, "initialize", t];
                    i && n.push(i),
                    this.processEvent({
                        eventIds: n
                    })
                }
                ,
                t.prototype.reportAdOppurtunity = function(e, t) {
                    this.processEvent({
                        eventIds: ["opportunity", "".concat(e, "_").concat(t)]
                    })
                }
                ,
                t.prototype.reportAdRequest = function(e, t, i) {
                    this.processEvent({
                        eventIds: ["ad requested", "".concat(e, "_").concat(t), i]
                    })
                }
                ,
                t.prototype.reportAdRequestResult = function(e, t, i, n, r) {
                    var o = ["request result", "".concat(e, "_").concat(t), i, n];
                    r && o.push(r),
                    this.processEvent({
                        eventIds: o
                    })
                }
                ,
                t.prototype.reportAdShowResult = function(e, t, i, n, r) {
                    var o = ["show result", "".concat(e, "_").concat(t), i, n];
                    "FAIL" === n && r && o.push(r),
                    this.processEvent({
                        eventIds: o
                    })
                }
                ,
                t.prototype.reportBannerAdHideAttempt = function() {
                    this.processEvent({
                        eventIds: ["banner_ad", "hide"]
                    })
                }
                ,
                t.prototype.dailyChallengeStarted = function(e) {
                    this.processEvent({
                        eventIds: ["dailyChallenge", e, "started"]
                    })
                }
                ,
                t.prototype.dailyChallengeSubTaskCompleted = function(e, t, i) {
                    this.processEvent({
                        eventIds: ["dailyChallenge", e, t.toString()],
                        value: i
                    })
                }
                ,
                t.prototype.dailyChallengeCompleted = function(e, t) {
                    this.processEvent({
                        eventIds: ["dailyChallenge", e, "completed"],
                        value: t
                    })
                }
                ,
                t.prototype.reportPublisherIdNotWhitelisted = function(e) {
                    this.processEvent({
                        eventIds: ["publisherID_not_whitelisted", e]
                    })
                }
                ,
                t.prototype.sendEvent = function(e) {
                    var t = e.eventIds
                      , i = e.value;
                    this._service.reportDesignEvent(t, i)
                }
                ,
                t
            }(dn), vn = (function() {
                function e() {}
                Object.defineProperty(e.prototype, "player", {
                    get: function() {
                        return this._player
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initializeSDK = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return e.design.startLoading(an.PRELOADING),
                                [4, t];
                            case 1:
                                return i.sent(),
                                e.design.completeLoading(an.PRELOADING),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.initializePlayer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, vp.platform.crazyGamesSDK.user.getUser()];
                            case 1:
                                return e = i.sent(),
                                (0,
                                r.isUndefined)(e) || (0,
                                r.isNull)(e) ? (u("FAKE_PLAYER", t = l("FAKE_PLAYER") || (0,
                                c.DM)()),
                                this._player = {
                                    id: t,
                                    name: t,
                                    photo: "NO PHOTO",
                                    isNewAccount: !1
                                }) : this._player = {
                                    id: "unknown",
                                    name: "unknown",
                                    photo: "unknown",
                                    isNewAccount: !1
                                },
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.authenticateBackend = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, vp.platform.crazyGamesSDK.user.getUserToken()];
                            case 1:
                                t = i.sent(),
                                i.label = 2;
                            case 2:
                                return i.trys.push([2, 4, , 5]),
                                [4, e.auth.crazyGames(t, !0, !1)];
                            case 3:
                                return [2, i.sent()];
                            case 4:
                                return i.sent(),
                                this._player.isNewAccount = !0,
                                [2, e.auth.crazyGames(t, !0, !0)];
                            case 5:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.setupBackendAccount = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r;
                        return (0,
                        n.__generator)(this, (function(o) {
                            switch (o.label) {
                            case 0:
                                return i = Math.round((new Date).getTimezoneOffset() / 60),
                                ze.USE_NAKAMA ? [4, e.playerprofile.getOwnProfile()] : [3, 2];
                            case 1:
                                r = o.sent(),
                                this._player = (0,
                                n.__assign)((0,
                                n.__assign)({}, this._player), {
                                    id: r.userid,
                                    name: r.displayname,
                                    photo: r.avatarurl
                                }),
                                o.label = 2;
                            case 2:
                                return [2, e.playerprofile.setupAccount(this._player.id, this._player.name, this._player.photo, i, t)]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(),
            function() {
                function e() {}
                return Object.defineProperty(e, "lightTiny", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorLight, e.sizeTiny)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightExtraSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorLight, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorLight, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightSmallWithOutline", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorDark,
                            size: e.sizeSmall,
                            strokeSize: 8
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightMedium", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorLight, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorLight, e.sizeLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightExtraLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorLight, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightBoldExtraSmall", {
                    get: function() {
                        return e.getBoldTextStyle(e.colorLight, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightBoldSmall", {
                    get: function() {
                        return e.getBoldTextStyle(e.colorLight, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightBoldMedium", {
                    get: function() {
                        return e.getBoldTextStyle(e.colorLight, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightBoldLarge", {
                    get: function() {
                        return e.getBoldTextStyle(e.colorLight, e.sizeLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightBoldExtraLarge", {
                    get: function() {
                        return e.getBoldTextStyle(e.colorLight, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "greyExtraSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorGrey, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "greySmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorGrey, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "greyMedium", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorGrey, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "greyLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorGrey, e.sizeLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "greyExtraLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorGrey, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkGreyExtraSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkGrey, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkGreySmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkGrey, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkGreyMedium", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkGrey, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkGreyLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkGrey, e.sizeLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkGreyExtraLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkGrey, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkTiny", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeTiny)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkExtraSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkMedium", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkExtraLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "blackTiny", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeTiny)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "blackExtraSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "blackSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "blackMedium", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "blackLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "blackExtraLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDark, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "brightRedExtraSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorBrightRed, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "brightRedMedium", {
                    get: function() {
                        return e.getBoldTextStyle(e.colorBrightRed, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightRedExtraSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorLightRed, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightRedSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorLightRed, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "greenExtraSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorGreen, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "greenSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorGreen, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkGreenMedium", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkGreen, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightGreenMedium", {
                    get: function() {
                        return e.getMarketplaceTextStyle(e.colorLightGreen, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightGreenExtraLarge", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLightGreen,
                            stroke: e.colorExtraDarkGreen,
                            size: e.sizeExtraLarge,
                            strokeSize: 12
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkBrownSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkBrown, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkBrownMedium", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkBrown, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkBrownExtraLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkBrown, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "yellowLargeWithOutline", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorYellow,
                            stroke: e.colorDarkPurple,
                            size: e.sizeLarge,
                            strokeSize: 15
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "yellowBrownLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorYellowBrown, e.sizeLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "yellowBrownMedium", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorYellowBrown, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "blueSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorBlue, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "blueMedium", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorBlue, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkBlueSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDarkBlue, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "turquoiseSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorTurquoise, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkOrangeSmall", {
                    get: function() {
                        return e.getMarketplaceTextStyle(e.colorDarkOrange, e.sizeSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkOrangeMedium", {
                    get: function() {
                        return e.getMarketplaceTextStyle(e.colorDarkOrange, e.sizeMedium)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "darkOrangeLarge", {
                    get: function() {
                        return e.getMarketplaceTextStyle(e.colorDarkOrange, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lightBrownExtraSmall", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorLightBrown, e.sizeExtraSmall)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "dullPurpleExtraLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorDullPurple, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "warmpurpleExtraLarge", {
                    get: function() {
                        return e.getRegularTextStyle(e.colorWarmPurple, e.sizeExtraLarge)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lvlNumberText", {
                    get: function() {
                        return e.getLvlUpTextStyle(e.colorLight, 316)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lvlUpContinueText", {
                    get: function() {
                        return e.getLvlUpTextStyle(e.colorLight, 80)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lvlUpText", {
                    get: function() {
                        return e.getLvlUpTextStyle(e.colorLight, 190)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "lvlUpRewardsText", {
                    get: function() {
                        return e.getLvlUpTextStyle(e.colorLight, 80)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "buildingRepairedText", {
                    get: function() {
                        return e.getLvlUpTextStyle(e.colorLight, 162)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "warningText", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorRed,
                            stroke: e.colorLight,
                            size: 50
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "mergeBonusText", {
                    get: function() {
                        return e.getMergeEffectTextStyle(e.colorGradientBonus, 62, void 0, 12266496)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "luckyBonusText", {
                    get: function() {
                        return e.getMergeEffectTextStyle(e.colorGradientLucky, 62, void 0, 1271552)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "gemsBannerText", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorOrange,
                            size: 60,
                            strokeSize: 8
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "cratesBannerText", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorDarkRed,
                            size: 60,
                            strokeSize: 8
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "energyBannerText", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorPurple,
                            size: 60,
                            strokeSize: 8
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "halloweenBannerText", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorYellow,
                            stroke: e.colorDarkYellow,
                            size: 60,
                            strokeSize: 8
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "christmasBannerText", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorRedBrown,
                            size: 60,
                            strokeSize: 8
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "blackfridayBannerText", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorDark,
                            stroke: e.colorYellowOrange,
                            size: 60,
                            strokeSize: 8
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "christmasDealsBannerText", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorRedBrown,
                            size: 60,
                            strokeSize: 8
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "eventPopupTitleBlue", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLightBlue,
                            stroke: e.colorDarkPurple2,
                            size: e.sizeExtraLarge,
                            strokeSize: 16
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "eventPopupTitleYellow", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorYellow,
                            stroke: e.colorDarkMagenta,
                            size: e.sizeExtraLarge,
                            strokeSize: 16
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "eventPopupTitleGold", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorYellow,
                            stroke: e.colorDarkYellow,
                            size: e.sizeExtraLarge,
                            strokeSize: 16
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "eventPopupTitleBlack", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorDark,
                            stroke: e.colorYellowOrange,
                            size: e.sizeExtraLarge,
                            strokeSize: 16
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "eventPopupTitleChristmas", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorRedBrown,
                            size: e.sizeExtraLarge,
                            strokeSize: 16,
                            dropShadow: !0,
                            dropShadowColor: e.colorPinkishRed,
                            dropShadowDistance: 10,
                            dropShadowAlpha: 1,
                            dropShadowAngle: 1.5
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "eventDiscountTextExtraSmall", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorPlum,
                            size: e.sizeExtraSmall,
                            strokeSize: 12
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "eventDiscountTextMedium", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorPlum,
                            size: e.sizeMedium,
                            strokeSize: 12
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "eventDiscountTextExtraLarge", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorLight,
                            stroke: e.colorPlum,
                            size: e.sizeExtraLarge,
                            strokeSize: 12
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "dailyBonusHeader", {
                    get: function() {
                        return e.getRegularTextWithOutlineAndShadow(e.colorLight, e.colorRedViolet, e.colorPlum, e.sizeExtraLarge, 12)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "dailyChallengeHeader", {
                    get: function() {
                        return e.getRegularTextWithOutline({
                            color: e.colorYellow,
                            stroke: e.colorPinkishRed,
                            size: e.sizeExtraLarge,
                            strokeSize: 16
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "buttonLabel", {
                    get: function() {
                        return this.lightMedium
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "popoutTitle", {
                    get: function() {
                        return this.lightMedium
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "popupTitle", {
                    get: function() {
                        return this.lightMedium
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "popupHeader", {
                    get: function() {
                        return this.darkGreyMedium
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "counter", {
                    get: function() {
                        return this.darkMedium
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e, "currentFontFamily", {
                    get: function() {
                        var e, t;
                        switch (null === (t = null === (e = null == De ? void 0 : De.services) || void 0 === e ? void 0 : e.localization) || void 0 === t ? void 0 : t.getLanguage()) {
                        case le.JA_JP:
                            return y.MPLUSROUNDED1C_BOLD.alias;
                        case le.PL_PL:
                        case le.CS_CZ:
                        case le.VI_VI:
                        case le.GR_GR:
                            return y.NOTOSANSDISPLAY_EXTRACONDENSED_BOLD.alias;
                        default:
                            return y.HELVETICAROUNDEDLTSTD_BDCN.alias
                        }
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.getAdjustedFontSizeForCurrentFontFamily = function(t) {
                    switch (e.currentFontFamily) {
                    case y.MPLUSROUNDED1C_BOLD.alias:
                        return Math.round(.75 * t);
                    case y.NOTOSANSDISPLAY_EXTRACONDENSED_BOLD.alias:
                        return Math.round(.95 * t);
                    default:
                        return Math.round(t)
                    }
                }
                ,
                e.getAssetFontsForCurrentLanguage = function(t) {
                    if (t)
                        return Object.keys(y).map((function(e) {
                            return y[e]
                        }
                        ));
                    switch (e.currentFontFamily) {
                    case y.MPLUSROUNDED1C_BOLD.alias:
                        return [y.MPLUSROUNDED1C_BOLD];
                    case y.NOTOSANSDISPLAY_EXTRACONDENSED_BOLD.alias:
                        return [y.NOTOSANSDISPLAY_EXTRACONDENSED_BOLD];
                    default:
                        return [y.HELVETICAROUNDEDLTSTD_BD, y.HELVETICAROUNDEDLTSTD_BDCN]
                    }
                }
                ,
                e.getRegularTextStyle = function(t, i, n, r) {
                    return void 0 === i && (i = e.sizeMedium),
                    void 0 === n && (n = "center"),
                    void 0 === r && (r = !1),
                    new Xe.TextStyle({
                        fontFamily: e.currentFontFamily,
                        fill: t,
                        fontSize: e.getAdjustedFontSizeForCurrentFontFamily(i),
                        align: n,
                        dropShadow: r,
                        dropShadowAlpha: .14,
                        dropShadowAngle: Math.PI / 4,
                        dropShadowColor: 0,
                        dropShadowDistance: 5
                    })
                }
                ,
                e.getBoldTextStyle = function(t, i, n, r) {
                    return void 0 === i && (i = e.sizeMedium),
                    void 0 === n && (n = "center"),
                    void 0 === r && (r = !0),
                    new Xe.TextStyle({
                        fontFamily: e.currentFontFamily,
                        fill: t,
                        fontSize: e.getAdjustedFontSizeForCurrentFontFamily(i),
                        align: n,
                        dropShadow: r,
                        dropShadowAlpha: .14,
                        dropShadowAngle: Math.PI / 4,
                        dropShadowColor: 0,
                        dropShadowDistance: 5
                    })
                }
                ,
                e.getLvlUpTextStyle = function(t, i, n, r) {
                    return void 0 === i && (i = e.sizeMedium),
                    void 0 === n && (n = "center"),
                    void 0 === r && (r = !0),
                    new Xe.TextStyle({
                        fontFamily: e.currentFontFamily,
                        fill: t,
                        fontSize: e.getAdjustedFontSizeForCurrentFontFamily(i),
                        align: n,
                        dropShadow: r,
                        dropShadowAlpha: .25,
                        dropShadowAngle: Math.PI / 4,
                        dropShadowColor: 0,
                        dropShadowDistance: 12
                    })
                }
                ,
                e.getRegularTextWithOutline = function(t) {
                    var i = t.color
                      , n = t.stroke
                      , r = t.size
                      , o = void 0 === r ? e.sizeMedium : r
                      , a = t.strokeSize
                      , s = void 0 === a ? 6 : a
                      , _ = t.align
                      , c = void 0 === _ ? "center" : _
                      , l = t.dropShadow
                      , u = void 0 !== l && l
                      , d = t.dropShadowColor
                      , h = void 0 === d ? 0 : d
                      , p = t.dropShadowDistance
                      , v = void 0 === p ? 5 : p
                      , g = t.dropShadowAlpha
                      , f = void 0 === g ? .14 : g
                      , E = t.dropShadowAngle
                      , m = void 0 === E ? Math.PI / 4 : E;
                    return new Xe.TextStyle({
                        fontFamily: e.currentFontFamily,
                        fill: i,
                        fontSize: e.getAdjustedFontSizeForCurrentFontFamily(o),
                        align: c,
                        stroke: n,
                        strokeThickness: s,
                        dropShadow: u,
                        dropShadowAlpha: f,
                        dropShadowAngle: m,
                        dropShadowColor: h,
                        dropShadowDistance: v
                    })
                }
                ,
                e.getRegularTextWithOutlineAndShadow = function(t, i, n, r, o, a) {
                    return void 0 === r && (r = e.sizeMedium),
                    void 0 === o && (o = 6),
                    void 0 === a && (a = "center"),
                    new Xe.TextStyle({
                        fontFamily: e.currentFontFamily,
                        fill: t,
                        fontSize: e.getAdjustedFontSizeForCurrentFontFamily(r),
                        align: a,
                        stroke: i,
                        strokeThickness: o,
                        dropShadow: !0,
                        dropShadowAlpha: 1,
                        dropShadowAngle: Math.PI / 4,
                        dropShadowColor: n,
                        dropShadowDistance: 5
                    })
                }
                ,
                e.getMergeEffectTextStyle = function(t, i, n, r) {
                    return void 0 === i && (i = e.sizeMedium),
                    void 0 === n && (n = "center"),
                    new Xe.TextStyle({
                        fontFamily: e.currentFontFamily,
                        fill: t,
                        fontSize: e.getAdjustedFontSizeForCurrentFontFamily(i),
                        align: n,
                        stroke: r,
                        strokeThickness: 8,
                        dropShadow: !0,
                        dropShadowAlpha: .25,
                        dropShadowAngle: Math.PI / 3,
                        dropShadowColor: 0,
                        dropShadowDistance: 6
                    })
                }
                ,
                e.getMarketplaceTextStyle = function(t, i, n, r) {
                    return void 0 === i && (i = e.sizeMedium),
                    void 0 === n && (n = "center"),
                    void 0 === r && (r = !1),
                    new Xe.TextStyle({
                        fontFamily: e.currentFontFamily,
                        fill: t,
                        fontSize: e.getAdjustedFontSizeForCurrentFontFamily(i),
                        align: n,
                        dropShadow: r,
                        dropShadowAlpha: .14,
                        dropShadowAngle: Math.PI / 4,
                        dropShadowColor: 0,
                        dropShadowDistance: 5,
                        lineHeight: 35
                    })
                }
                ,
                e.colorLight = 16777215,
                e.colorGrey = 9410970,
                e.colorDarkGrey = 5990240,
                e.colorDark = 471348,
                e.colorBlack = 0,
                e.colorLightRed = 15534406,
                e.colorRed = 14942208,
                e.colorBrightRed = 15543881,
                e.colorDarkRed = 11929608,
                e.colorRedBrown = 11348522,
                e.colorPinkishRed = 8001067,
                e.colorLightGreen = 2486096,
                e.colorGreen = 3379482,
                e.colorDarkGreen = 3635518,
                e.colorExtraDarkGreen = 26906,
                e.colorBlue = 3387062,
                e.colorDarkBlue = 811903,
                e.colorLightBrown = 13349510,
                e.colorDarkBrown = 3219202,
                e.colorDullPurple = 7885652,
                e.colorOrange = 15424526,
                e.colorDarkOrange = 15942912,
                e.colorPurple = 11338331,
                e.colorDarkPurple = 11610459,
                e.colorWarmPurple = 8398257,
                e.colorYellow = 16772397,
                e.colorDarkYellow = 14314530,
                e.colorYellowOrange = 16756992,
                e.colorYellowBrown = 3088389,
                e.colorLightBlue = 11658228,
                e.colorDarkPurple2 = 5191102,
                e.colorDarkMagenta = 7733672,
                e.colorTurquoise = 2460305,
                e.colorPlum = 8197447,
                e.colorRedViolet = 11809671,
                e.colorDarkTeal = 338477,
                e.colorGradientBonus = [16709982, 16309547, 16493842],
                e.colorGradientLucky = [13434624, 1432832],
                e.sizeTiny = 30,
                e.sizeExtraSmall = 35,
                e.sizeSmall = 45,
                e.sizeMedium = 55,
                e.sizeLarge = 80,
                e.sizeExtraLarge = 120,
                e
            }());
            !function(e) {
                e.SPLASH = "splash",
                e.MAIN_UI = "main_ui",
                e.MAP_RESOURCES = "map_resources",
                e.MAIN_HUD = "main_hud",
                e.BUILDING_REPAIRED_ANIMATION = "building_repaired_animation",
                e.MAIN_SPINE_AND_SHARED_1 = "main_spine_and_shared_1",
                e.MAIN_SPINE_AND_SHARED_2 = "main_spine_and_shared_2",
                e.ONBOARDING = "onboarding",
                e.INGREDIENTS = "ingredients",
                e.CUSTOM_SHARE = "custom_share_images",
                e.DECALS = "decals",
                e.LEVEL_UP = "level_up",
                e.MARKETPLACE = "marketplace",
                e.ORDERS_POPUP = "orders_popup",
                e.SETTINGS_POPUP = "settings_popup",
                e.CUSTOM_UPDATE = "custom_update_images",
                e.FRIENDS_FOR_CRATES = "friends_for_crates",
                e.TRANSITION_SCREEN = "transition_screen",
                e.VISITOR_ACTIONS = "visitor_actions",
                e.SHOVEL_POPUP = "shovel_popup",
                e.SHOVEL_ANIMATION = "shovel_animation",
                e.MAP_JSON = "map_json",
                e.SFX = "sfx",
                e.MUSIC = "music",
                e.FONTS = "fonts",
                e.TRAIN_STEAM = "train_steam",
                e.DISCONNECTION = "disconnection",
                e.DISCOVERY = "discovery",
                e.FAKE_ADS = "fake_ads",
                e.PREMIUM_POPUP = "premium_popup",
                e.PREMIUM_LAND = "premium_land",
                e.FREEBIE = "freebie",
                e.HEAVY_OBJECT_OVERLAY = "heavy_object_overlay",
                e.MERGE_EFFECT = "merge_effect",
                e.MERGE_BONUS_EFFECT = "merge_bonus_effect",
                e.OBJECT_REGENERATION = "object_regeneration",
                e.WORLD_TO_LIFE = "world_to_life",
                e.RAIN = "rain",
                e.DANDELION = "dandelion",
                e.WIND = "wind",
                e.BUTTERFLIES = "butterflies",
                e.BUILDING_PICKUP = "building_pickup",
                e.CONTROLLED_RANDOMNESS = "controlled_randomness",
                e.GREENHOUSE = "greenhouse",
                e.GREENHOUSE_MERGE_CHAIN_INTRO = "greenhouse_merge_chain_intro",
                e.FLOWERS = "flowers",
                e.UPGRADE_CARD = "upgrade_card",
                e.UPGRADE_CARD_OVERLAY = "upgrade_card_overlay",
                e.SPECIAL_OFFER = "special_offer",
                e.DAILY_BONUS = "daily_bonus",
                e.EVENTS = "events",
                e.EVENTS_CHOPCHOP = "events_chopchop",
                e.EVENTS_PIGGYBANK = "events_piggybank",
                e.EVENTS_GOLDENCARROT = "events_goldencarrot",
                e.EVENTS_GOLDENPUMPKIN = "events_goldenpumpkin",
                e.EVENTS_GOLDENCHRISTMAS = "events_goldenchristmas",
                e.EVENTS_BLACKFRIDAY = "events_blackfriday",
                e.EVENTS_CHRISTMAS_DEALS = "events_christmas_deals",
                e.CONSENT = "consent",
                e.DAILY_CHALLENGE = "daily_challenge",
                e.STORAGE = "storage",
                e.AD_BLOCK = "ad_block"
            }(hn || (hn = {}));
            var gn, fn, En = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._groupsToLoad = [],
                    t._groupsInLoading = new Map,
                    t._isLoading = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.addGroups = function(e) {
                    var t = this;
                    Array.isArray(e) || (e = [e]),
                    e.forEach((function(e) {
                        var i = e.id
                          , n = e.assets;
                        t._groupsInLoading.set(i, new Promise((function(e) {
                            t._groupsToLoad.push({
                                id: i,
                                assets: n,
                                resolver: e
                            })
                        }
                        )))
                    }
                    )),
                    this._isLoading || this._loadNext()
                }
                ,
                t.prototype.prioritizeGroup = function(e) {
                    var t = this._getIndex(e);
                    if (t < 0)
                        return this._logger.info("The assets have been loaded for group ID: ".concat(e)),
                        this.getLoadingPromise(e);
                    var i = this._groupsToLoad.splice(t, 1)[0];
                    return this._groupsToLoad.unshift(i),
                    this.getLoadingPromise(e)
                }
                ,
                t.prototype.getLoadingPromise = function(e, t) {
                    var i = this
                      , n = me(e) ? e : [e]
                      , r = [];
                    return n.forEach((function(e) {
                        var n = i._groupsInLoading.get(e);
                        if (n) {
                            if (t) {
                                var o = i._getIndex(e);
                                if (o > -1) {
                                    var a = i._groupsToLoad.splice(o, 1)[0];
                                    i._groupsToLoad.unshift(a),
                                    i._loadGroup(e)
                                }
                            }
                            r.push(n)
                        } else
                            i._logger.warn("There is no loading promise for group ID: ".concat(e))
                    }
                    )),
                    Promise.all(r).then((function() {
                        return i._loadNext()
                    }
                    ))
                }
                ,
                t.prototype.loadCurrentLanguageFont = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, this._loadFontgroup(!1, e)];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.loadAllFonts = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, this._loadFontgroup(!0, e)];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._loadFontgroup = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this.addGroups({
                                    id: hn.FONTS,
                                    assets: {
                                        fonts: vn.getAssetFontsForCurrentLanguage(e)
                                    }
                                }),
                                [4, this.getLoadingPromise(hn.FONTS, t)];
                            case 1:
                                return i.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._loadNext = function() {
                    var e = this;
                    0 !== this._groupsToLoad.length && this._loadGroup(this._groupsToLoad[0].id).then((function() {
                        return e._loadNext()
                    }
                    ))
                }
                ,
                t.prototype._loadGroup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (t = this._getIndex(e)) < 0 ? (this._logger.warn("Can't load the the group ".concat(e, ", there is no data!")),
                                [2]) : (i = this._groupsToLoad.splice(t, 1)[0],
                                [4, this.services.assetLoader.load(i.assets)]);
                            case 1:
                                return n.sent(),
                                i.resolver(),
                                this._isLoading = this._groupsToLoad.length > 0,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getIndex = function(e) {
                    for (var t = 0; t < this._groupsToLoad.length; t++)
                        if (this._groupsToLoad[t].id === e)
                            return t;
                    return -1
                }
                ,
                t
            }(Se), mn = i(2213), yn = "AVATAR_248";
            !function(e) {
                e[e.LARGE = 0] = "LARGE",
                e[e.SMALL = 1] = "SMALL"
            }(fn || (fn = {}));
            var Tn, An, Cn, In, Sn, On, bn = ((gn = {})[fn.LARGE] = {
                size: 248,
                backAsset: f.AVATAR_248,
                maskAsset: f.AVATAR_248_MASK
            },
            gn[fn.SMALL] = {
                size: 130,
                backAsset: f.AVATAR_130,
                maskAsset: f.AVATAR_130_MASK
            },
            gn), Rn = new Map, wn = function() {
                function e(e) {
                    var t;
                    this._lastVisitedTime = 0,
                    this._isVisitable = !1,
                    this._platformId = e.platformId,
                    this._name = e.name,
                    this.photoUrl = e.photoUrl,
                    this._loadPhotoFromUrl(),
                    e.nakamaId && (this.nakamaId = e.nakamaId),
                    this._isRealPlayer = e.isRealPlayer,
                    this._logger = Ie.Of("Player ".concat(e.name, " (").concat(e.platformId, ")"), ((t = {})[Ae.INFO] = ["color:#009c99"],
                    t)),
                    this._logger.info("Player created!")
                }
                return Object.defineProperty(e.prototype, "platformId", {
                    get: function() {
                        return this._platformId
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "name", {
                    get: function() {
                        return this._name
                    },
                    set: function(e) {
                        this._name = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "realPlayer", {
                    get: function() {
                        return this._isRealPlayer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "nakamaId", {
                    get: function() {
                        return this._nakamaId
                    },
                    set: function(e) {
                        this._nakamaId = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.getPhoto = function(e) {
                    var t = this;
                    void 0 === e && (e = fn.LARGE);
                    var i = De.services.resource.getSprite(bn[e].backAsset);
                    i.anchor.set(.5);
                    var n = Rn.get(this._platformId);
                    if (n) {
                        var r = new mn.Sprite(n);
                        return r.anchor.set(.5),
                        r.scale.set(bn[e].size / Math.min(r.width, r.height)),
                        i.addChild(r),
                        i
                    }
                    return this._photoTexture ? this._createRenderedTexture(i, e, this._photoTexture) : this.photoUrl ? this._loadPhotoFromUrl().then((function(n) {
                        t._createRenderedTexture(i, e, n)
                    }
                    )).catch((function(e) {}
                    )) : this._loadImageURL().then((function(n) {
                        t._createRenderedTexture(i, e, n)
                    }
                    )).catch((function(e) {}
                    )),
                    i
                }
                ,
                Object.defineProperty(e.prototype, "photoUrl", {
                    get: function() {
                        return this._photoUrl
                    },
                    set: function(e) {
                        this._photoUrl = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "lastVisitedTime", {
                    get: function() {
                        return this._lastVisitedTime
                    },
                    set: function(e) {
                        this._lastVisitedTime = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "isVisitable", {
                    get: function() {
                        return this._isVisitable
                    },
                    set: function(e) {
                        this._isVisitable = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.getNakamaId = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._nakamaId ? [2, this._nakamaId] : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._loadImageURL = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._photoTexture ? [2, this._photoTexture] : [2, this._loadPhotoFromUrl()]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._loadPhotoFromUrl = function() {
                    var e = this;
                    return this._photoTexturePromise || (this._photoTexturePromise = new Promise((function(t, i) {
                        if (ve(e.photoUrl))
                            i("Photo cannot be loaded because the URL is not provided");
                        else if (e.photoUrl.includes("http")) {
                            var n = Xe.BaseTexture.from(e.photoUrl, {
                                resolution: 1
                            });
                            n.valid && t(new Xe.Texture(n)),
                            n.once("loaded", (function(e) {
                                return t(new Xe.Texture(e))
                            }
                            )),
                            n.once("error", (function() {
                                return t(De.services.resource.getSprite(f[yn]).texture)
                            }
                            ))
                        } else {
                            var r = f[e.photoUrl] || f[yn];
                            De.services.lazyLoad.prioritizeGroup(hn.ONBOARDING).then((function() {
                                t(De.services.resource.getSprite(r).texture)
                            }
                            ))
                        }
                    }
                    )).then((function(t) {
                        return e._photoTexture = t,
                        e._logger.info("Photo was loaded!"),
                        Promise.resolve(t)
                    }
                    ))),
                    this._photoTexturePromise
                }
                ,
                e.prototype._createRenderedTexture = function(e, t, i) {
                    var n = new mn.Sprite;
                    n.texture = i,
                    n.anchor.set(0),
                    n.scale.set(bn[0].size / Math.min(n.width, n.height));
                    var r = De.services.resource.getSprite(bn[0].maskAsset);
                    r.anchor.set(0),
                    n.mask = r;
                    var o = Xe.RenderTexture.create({
                        width: bn[0].size,
                        height: bn[0].size
                    });
                    De.services.canvas.renderer.render(n, o),
                    Rn.set(this._platformId, o),
                    r.destroy(),
                    n.destroy();
                    var a = new mn.Sprite(o);
                    a.anchor.set(.5),
                    a.scale.set(bn[t].size / Math.min(a.width, a.height)),
                    e.addChild(a)
                }
                ,
                e
            }(), Dn = function() {
                function e() {
                    this._player = {
                        id: "mock",
                        name: "mock",
                        photo: "mock",
                        isNewAccount: !1
                    }
                }
                return Object.defineProperty(e, "authenticationResponse", {
                    set: function(e) {
                        this._response = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "player", {
                    get: function() {
                        if (!this._player)
                            throw new Error("SDK has not been initialized yet");
                        return this._player
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initializeSDK = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, vp.platform.discordSDK.ready()];
                            case 1:
                                return e.sent(),
                                [2, t]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.initializePlayer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.getPlayerAvatar = function(e, t) {
                    var i = yn;
                    if (t)
                        i = "https://cdn.discordapp.com/avatars/".concat(e, "/").concat(t, ".png?size=256");
                    else {
                        var n = parseInt(e, 10) / Math.pow(2, 22)
                          , r = Math.floor(n);
                        i = "https://cdn.discordapp.com/embed/avatars/".concat(r % 6, ".png")
                    }
                    return i
                }
                ,
                e.prototype.authenticateBackend = function(t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, o, a, s, _, c;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                if (i = vp.platform,
                                !e._response)
                                    throw new Error("Discord authentication response is missing, go through the login flow first");
                                if (!i.discordSDK.channelId || !i.discordSDK.instanceId)
                                    throw new Error("ChannelId and InstanceId must be non-empty.");
                                return [4, t.auth.discord(e._response, i.discordSDK.channelId, i.discordSDK.instanceId)];
                            case 1:
                                return o = n.sent(),
                                a = o[0],
                                s = o[1],
                                this._player.id = s.id,
                                this._player.name = s.username,
                                i.discordSDK.guildId ? [4, vp.platform.loginStrategy.getGuildName(i.discordSDK.guildId)] : [3, 3];
                            case 2:
                                _ = n.sent(),
                                (0,
                                r.isNull)(_) || (this._player.name = _),
                                n.label = 3;
                            case 3:
                                return c = this.getPlayerAvatar(s.id, s.avatar),
                                this._player.photo = c,
                                [2, a]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.setupBackendAccount = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, e.playerdata.getAllData()];
                            case 1:
                                return i = n.sent(),
                                0 === Object.keys(i).length && (this._player.isNewAccount = !0),
                                r = Math.round((new Date).getTimezoneOffset() / 60),
                                [2, e.playerprofile.setupAccount(this.player.id, this.player.name, this.player.photo, r, t)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), Nn = "fvm-shortcut", Ln = function() {
                function e() {}
                return e.conditionalShortcutPrompt = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return l(Nn) ? [2] : [4, e.fbInstant.canCreateShortcutAsync()];
                            case 1:
                                return i.sent() ? (t.design.shortcutEvent("prompted"),
                                e.fbInstant.createShortcutAsync().then((function() {
                                    u(Nn, "created"),
                                    t.design.shortcutEvent("added")
                                }
                                )),
                                [2]) : [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), Bn = (function() {
                function e(e, t) {
                    this._facebookSDK = e,
                    this._loader = t
                }
                Object.defineProperty(e.prototype, "player", {
                    get: function() {
                        return this._player
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initializeSDK = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return e.design.startLoading(an.PRELOADING),
                                this._loader.setLoadingPromise(t),
                                this._loader.startInitialLoading(),
                                [4, this._facebookSDK.initialize()];
                            case 1:
                                return i.sent(),
                                e.setPlatform(this._facebookSDK.messagingPlatform.platform),
                                e.design.completeLoading(an.PRELOADING),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.initializePlayer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, this._facebookSDK.messagingPlatform.getPlayer()];
                            case 1:
                                return t = i.sent(),
                                this._player = (0,
                                n.__assign)((0,
                                n.__assign)({}, t), {
                                    isNewAccount: !1
                                }),
                                Ln.conditionalShortcutPrompt(this._facebookSDK, e),
                                this._facebookSDK.messagingPlatform.getConnectedFriends().then((function(t) {
                                    return e.design.sendFriendsAmount(t.length)
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.authenticateBackend = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return USE_FACEBOOK ? [4, this._facebookSDK.fbInstant.player.getSignedPlayerInfoAsync()] : [3, 6];
                            case 1:
                                t = i.sent(),
                                i.label = 2;
                            case 2:
                                return i.trys.push([2, 4, , 5]),
                                [4, e.auth.facebookInstant(t.getSignature(), this._player.id, !1)];
                            case 3:
                                return [2, i.sent()];
                            case 4:
                                return i.sent(),
                                this._player.isNewAccount = !0,
                                [2, e.auth.facebookInstant(t.getSignature(), this._player.id, !0)];
                            case 5:
                                return [3, 7];
                            case 6:
                                return [2, e.auth.customAuth(this._player.id, this._player.name)];
                            case 7:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.setupBackendAccount = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r;
                        return (0,
                        n.__generator)(this, (function(o) {
                            switch (o.label) {
                            case 0:
                                return [4, this._facebookSDK.fbInstant.player.getASIDAsync()];
                            case 1:
                                return i = o.sent(),
                                r = Math.round((new Date).getTimezoneOffset() / 60),
                                [2, e.playerprofile.setupAccount(this._player.id, this._player.name, this._player.photo, r, (0,
                                n.__assign)((0,
                                n.__assign)({}, t), {
                                    asid: i
                                }))]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(),
            function() {
                function e() {}
                Object.defineProperty(e.prototype, "player", {
                    get: function() {
                        return this._player
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initializeSDK = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, t];
                            case 1:
                                return [2, e.sent()]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.initializePlayer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, vp.platform.msstart.getSignedInUserAsync().then((function(t) {
                                    e._player = {
                                        id: t.playerId,
                                        name: t.playerId,
                                        photo: "NO PHOTOS ON THIS PLATFORM",
                                        isNewAccount: !1
                                    }
                                }
                                )).catch((function(t) {
                                    var i = l("FAKE_PLAYER") || (0,
                                    c.DM)();
                                    u("FAKE_PLAYER", i),
                                    e._player = {
                                        id: i,
                                        name: i,
                                        photo: "NO PHOTOS ON THIS PLATFORM",
                                        isNewAccount: !1
                                    }
                                }
                                ))];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.authenticateBackend = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return t.trys.push([0, 2, , 3]),
                                [4, e.auth.customAuth(this._player.id, this._player.name, !1)];
                            case 1:
                                return [2, t.sent()];
                            case 2:
                                return t.sent(),
                                this._player.isNewAccount = !0,
                                [2, e.auth.customAuth(this._player.id, this._player.name, !0)];
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.setupBackendAccount = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return i = Math.round((new Date).getTimezoneOffset() / 60),
                            [2, e.playerprofile.setupAccount(this._player.id, this._player.name, this._player.photo, i, t)]
                        }
                        ))
                    }
                    ))
                }
            }(),
            new Map);
            function Pn(e) {
                var t, i = e.remainingTime, n = e.alwaysShowHours, o = void 0 === n || n, a = e.alwaysShowMinutes, s = void 0 === a || a, _ = Math.ceil(i / 864e5);
                if (_ <= 1)
                    return r.StringUtility.formatMilliseconds(i, {
                        alwaysShowHours: o,
                        alwaysShowMinutes: s
                    });
                var c = "".concat(_, "_").concat(De.services.localization.getLanguage().alias);
                if (Bn.has(c))
                    return Bn.get(c);
                var l = De.services.localization.getText(ce.EVENT_TIMER_DAYS_REMAINING).split(";")
                  , u = new Map;
                l.forEach((function(e) {
                    var t = 0
                      , i = 0
                      , n = new RegExp(/\{(.*?)\}/).exec(e);
                    if (n) {
                        var r = n[1];
                        "x" === r ? (t = -1,
                        i = -1) : (t = parseInt(r.split("-")[0]),
                        i = parseInt(r.split("-").pop()));
                        for (var o = t; o <= i; o++)
                            u.set(o, e.replace(r, "count"))
                    } else
                        console.error("no range found in " + e)
                }
                ));
                var d = _.toString()
                  , h = null !== (t = u.get(_)) && void 0 !== t ? t : u.get(-1);
                return h ? d = h.replace("{count}", _.toString()) : console.error("no text found for remaining days: " + _),
                Bn.set(c, d),
                d
            }
            function kn(e) {
                return 60 * e * 1e3
            }
            !function(e) {
                e.EXP = "exp",
                e.LEVEL = "level"
            }(An || (An = {})),
            function(e) {
                e.COINS = "coins",
                e.GEMS = "gems",
                e.CRATES = "crates",
                e.ENERGY = "energy",
                e.TICKETS = "tickets",
                e.STONE = "stone",
                e.WOOD = "wood"
            }(Cn || (Cn = {})),
            function(e) {
                e.TOOLS = "tools"
            }(In || (In = {})),
            function(e) {
                e.WHEAT = "wheat",
                e.EGG = "egg",
                e.SUNFLOWER = "sunflower",
                e.MILK = "milk",
                e.SUGARCANE = "sugarcane",
                e.BACON = "bacon",
                e.CARROT = "carrot",
                e.GOATMILK = "goatmilk",
                e.SOYBEANS = "soybeans",
                e.WOOL = "wool",
                e.CORN = "corn",
                e.FUR = "fur",
                e.COFFEEBEANS = "coffeebeans",
                e.TOMATO = "tomato",
                e.AVOCADO = "avocado",
                e.TRUFFLE = "truffle"
            }(Sn || (Sn = {})),
            function(e) {
                e.COIN_1 = "coin_1",
                e.COIN_2 = "coin_2",
                e.COIN_3 = "coin_3",
                e.COIN_4 = "coin_4",
                e.COIN_5 = "coin_5",
                e.COIN_6 = "coin_6",
                e.COIN_7 = "coin_7",
                e.GEMS_0 = "gems_0",
                e.GEMS_1 = "gems_1",
                e.GEMS_2 = "gems_2",
                e.GEMS_3 = "gems_3",
                e.GEMS_4 = "gems_4",
                e.GEMS_5 = "gems_5"
            }(On || (On = {}));
            var xn, Gn = ((Tn = {})[An.LEVEL] = !0,
            Tn), Un = function() {
                return vp.platform.useABTests
            };
            !function(e) {
                e[e.Control = 0] = "Control",
                e[e.TestGroupA = 1] = "TestGroupA",
                e[e.TestGroupB = 2] = "TestGroupB",
                e[e.TestGroupC = 3] = "TestGroupC"
            }(xn || (xn = {}));
            var Fn, Mn, Vn, Hn, jn = "AB_TEST-005", Kn = function() {
                function e(e) {
                    this._group = null,
                    this._dataWriter = new vp.platform.abTestDataStorage.writer,
                    this._dataProvider = new vp.platform.abTestDataStorage.provider,
                    this._model = e
                }
                return Object.defineProperty(e.prototype, "group", {
                    get: function() {
                        return this._group
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return Un() ? [4, this._setGroup()] : [3, 2];
                            case 1:
                                return e.sent(),
                                [3, 3];
                            case 2:
                                this._model.setabTestData(void 0),
                                e.label = 3;
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.setTestGroupByIndex = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return t = xn[this.getEnumEntryWithIndex(e)],
                            this._model.setabTestData({
                                testGroup: t,
                                testVersion: jn
                            }),
                            this._group = t,
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._setGroup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return e = xn.TestGroupC,
                                [3, 3];
                            case 1:
                                return [4, this._getGroupFromSavedData()];
                            case 2:
                                e = t.sent(),
                                t.label = 3;
                            case 3:
                                return (0,
                                r.isUndefined)(e) && (e = xn[this.getRandomEnumEntry()],
                                this._model.setabTestData({
                                    testGroup: e,
                                    testVersion: jn
                                })),
                                this._group = e,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.getEnumEntryWithIndex = function(e) {
                    return xn[e]
                }
                ,
                e.prototype.getRandomEnumEntry = function() {
                    var e = Object.keys(xn).length / 2 - 1
                      , t = r.Random.int(e);
                    return xn[t]
                }
                ,
                e.prototype._getGroupFromSavedData = function() {
                    var e = this._model.abTestData;
                    if (!(0,
                    r.isUndefined)(e))
                        return jn !== e.testVersion ? void 0 : e.testGroup
                }
                ,
                e
            }(), Wn = i(571), zn = i(4487), Yn = i(6884), Jn = i(890), Xn = function() {
                function e() {}
                return e.prototype.custom = function(e) {
                    zn.n_(e)
                }
                ,
                e.prototype.debug = function(e) {
                    zn.n_({
                        type: "debug",
                        message: e,
                        level: "debug"
                    })
                }
                ,
                e.prototype.buttonClick = function(e) {
                    zn.n_({
                        type: "ui",
                        category: "button.click",
                        message: e,
                        level: "info"
                    })
                }
                ,
                e.prototype.popupOpen = function(e) {
                    zn.n_({
                        type: "ui",
                        category: "popup.open",
                        message: e,
                        level: "info"
                    })
                }
                ,
                e.prototype.popupClose = function(e) {
                    zn.n_({
                        type: "ui",
                        category: "popup.close",
                        message: e,
                        level: "info"
                    })
                }
                ,
                e.prototype.objectInteraction = function(e, t, i) {
                    zn.n_({
                        type: "user",
                        category: "object.interaction",
                        message: "".concat(e, " ").concat(t, " at ").concat(i.column, ",").concat(i.row),
                        level: "info"
                    })
                }
                ,
                e.prototype.inventoryChange = function(e, t, i) {
                    zn.n_({
                        type: "info",
                        category: "inventory.change",
                        message: "".concat(e, " changed from ").concat(t, " to ").concat(i),
                        level: "info"
                    })
                }
                ,
                e.prototype.saveData = function(e, t) {
                    zn.n_({
                        type: "info",
                        category: "save.data",
                        message: "".concat(e, " saving ").concat(t.join(",")),
                        level: "info"
                    })
                }
                ,
                e
            }(), qn = ["No active socket connection", "RPC call timed out", "Cannot show the ad. Reason: timer is still active", "No fill"], Qn = function() {
                function e() {
                    this.breadcrumbs = new Xn,
                    this._enabled = !1,
                    this._filteredErrors = qn,
                    this._encounteredFilteredErrors = [],
                    this._encounteredAllowedErrors = [],
                    this._throttleRate = .25
                }
                return e.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return this._initializationPromise || (void 0,
                            e = "https://".concat("1187013846746005515.discordsays.com/sentry", "/"),
                            Wn.S1({
                                environment: "prod",
                                release: "1.46.0-1",
                                dsn: "https://90a3c58dcd4f417696cf71dacbf186e7@public.sentry.cg-gb.com/26",
                                integrations: function(e) {
                                    return e.concat([new Yn.v({
                                        types: ["crash"]
                                    }), t._getRewriteIntegration()])
                                },
                                beforeSend: this._onBeforeSend.bind(this),
                                beforeBreadcrumb: this._onBeforeBreadcrumb.bind(this),
                                debug: !1,
                                tunnel: e
                            }),
                            this._initializationPromise = Promise.resolve()),
                            [2, this._initializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.error = function(e) {
                    if (e instanceof Error)
                        zn.Tb(e);
                    else
                        try {
                            var t = JSON.stringify(e);
                            zn.Tb(new Error(t))
                        } catch (e) {
                            zn.eN(new Error("Manual exception failed to stringify"))
                        }
                }
                ,
                e.prototype.setUserInfo = function(e) {
                    zn.av({
                        ip_address: "{{auto}}",
                        username: e
                    })
                }
                ,
                e.prototype.addErrorFilters = function(e) {
                    var t;
                    (t = this._filteredErrors).push.apply(t, e)
                }
                ,
                e.prototype.setThrottleRate = function(e) {
                    this._throttleRate = e
                }
                ,
                e.prototype.enableSentryLogging = function() {
                    this._enabled = !0
                }
                ,
                e.prototype._onBeforeSend = function(e, t) {
                    return this._enabled ? this._reshapeUnhandledRejections(e, t) || this._filterEvent(e, t) || this._throttleEvent(e, t) ? null : e : null
                }
                ,
                e.prototype._filterEvent = function(e, t) {
                    if (!t || !t.originalException)
                        return !1;
                    var i = this._getErrorMessageFromOriginalException(t.originalException);
                    if (!i || this._encounteredAllowedErrors.includes(i))
                        return !1;
                    if (this._encounteredFilteredErrors.includes(i))
                        return !0;
                    for (var n = 0; n < this._filteredErrors.length; n++) {
                        var r = this._filteredErrors[n];
                        if (RegExp(r, "g").test(i))
                            return this._encounteredFilteredErrors.push(i),
                            !0
                    }
                    return this._encounteredAllowedErrors.push(i),
                    !1
                }
                ,
                e.prototype._throttleEvent = function(e, t) {
                    return !1
                }
                ,
                e.prototype._reshapeUnhandledRejections = function(e, t) {
                    var i;
                    if (e.exception && e.exception.values && "UnhandledRejection" === e.exception.values[0].type && (null === (i = e.extra) || void 0 === i ? void 0 : i.__serialized__))
                        try {
                            var n = JSON.stringify(e.extra.__serialized__);
                            return this.error(new Error("Unhandled Promise Rejection: " + n)),
                            !0
                        } catch (e) {
                            return !1
                        }
                    return !1
                }
                ,
                e.prototype._onBeforeBreadcrumb = function(e, t) {
                    var i, n, r, o;
                    return "ui.click" === e.category && (null === (i = e.message) || void 0 === i ? void 0 : i.includes("canvas")) || "xhr" === e.category && 200 === (null === (n = e.data) || void 0 === n ? void 0 : n.status_code) && (null === (o = null === (r = e.data) || void 0 === r ? void 0 : r.url) || void 0 === o ? void 0 : o.includes("gameanalytics")) ? null : e
                }
                ,
                e.prototype._getRewriteIntegration = function() {
                    return new Jn.m({
                        iteratee: function(e) {
                            if (e.filename) {
                                var t = e.filename.split("/").pop()
                                  , i = "~/".concat(t);
                                e.filename = i
                            }
                            return e
                        }
                    })
                }
                ,
                e.prototype._getErrorMessageFromOriginalException = function(e) {
                    if ((0,
                    r.isString)(e))
                        return e;
                    if (e.message)
                        return String(e.message);
                    if (e.name)
                        return String(e.name);
                    try {
                        return JSON.stringify(e)
                    } catch (e) {
                        return ""
                    }
                }
                ,
                e
            }(), Zn = new Qn, $n = function() {
                function e() {
                    this.onSavableDataChange = new r.Event,
                    this._isSavable = !0
                }
                return Object.defineProperty(e.prototype, "name", {
                    get: function() {
                        return this._name
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "isSavable", {
                    get: function() {
                        return this._isSavable
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._logger = Ie.Of(this._name),
                                [4, this.onInitialize()];
                            case 1:
                                return i.sent(),
                                [4, this.dataContainer.getPlayerData(this._name)];
                            case 2:
                                return e = i.sent(),
                                (0,
                                r.isUndefined)(e) || (0,
                                r.isNull)(e) || (t = this.migrateData(e),
                                this.onDataReceive(t)),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.getDataToSave = function() {
                    var e, t = this.onDataSave();
                    return (e = {})[this.name] = {
                        data: t,
                        version: this._version
                    },
                    e
                }
                ,
                Object.defineProperty(e.prototype, "dataContainer", {
                    get: function() {
                        return De.services.playerData.currentMapDataContainer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.saveData = function() {
                    this.dataContainer.isSavable && this.onSavableDataChange.fire(this.getDataToSave())
                }
                ,
                e.prototype.migrateData = function(e) {
                    return e.data
                }
                ,
                e
            }(), er = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n._version = 1,
                    n._name = "",
                    n._counter = 0,
                    n._resetAt = -1,
                    n._name = t,
                    n._config = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "counter", {
                    get: function() {
                        return this._counter
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.isMaxReached = function() {
                    return this._counter >= this._config.ADS_MAX
                }
                ,
                t.prototype.countWatchedAd = function() {
                    this._counter += 1,
                    this.saveData()
                }
                ,
                t.prototype.tryToReset = function(e) {
                    this._resetAt + 1e3 * this._config.INTERVAL < e && (this._counter = 0,
                    this._resetAt = e,
                    this.saveData())
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._counter = e.counter,
                    this._resetAt = e.resetAt
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        counter: this._counter,
                        resetAt: this._resetAt
                    }
                }
                ,
                t
            }($n);
            !function(e) {
                e.VALID = "valid",
                e.INVALID = "not_valid",
                e.AD_SKIPPED = "ad_skipped",
                e.FAKE_AD = "fake_ad",
                e.AD_ERROR = "ad_error",
                e.NO_CONSENT = "no_consent",
                e.AD_BLOCK_DETECTED = "ad_block_detected"
            }(Fn || (Fn = {})),
            function(e) {
                e.SUCCES = "success",
                e.FAIL = "fail",
                e.AD_BLOCK_DETECTED = "ad_block_detected"
            }(Mn || (Mn = {})),
            function(e) {
                e.REWARDED_VIDEO = "rewardedVideos",
                e.INTERSTITIAL = "interstitials",
                e.BANNER = "banner"
            }(Vn || (Vn = {})),
            function(e) {
                e.NOT_INITIALIZED = "not_initialized",
                e.INITIALIZING = "initializing",
                e.INITIALIZED = "initialized",
                e.INITIALIZATION_FAILED = "initialization_failed"
            }(Hn || (Hn = {}));
            var tr = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.onAdStart = new r.Event,
                    i.onAdFinish = new r.Event,
                    i.onBannerStart = new r.Event,
                    i.onBannerFinish = new r.Event,
                    i._bannerAdIsVisible = !1,
                    i._adsEnabled = !0,
                    i._interstitialEnabled = !0,
                    i._adsStrategies = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "bannerAdShouldDisplace", {
                    get: function() {
                        return "bottom" === this._adsStrategies[0].bannerAdPosition
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "adsEnabled", {
                    get: function() {
                        return this._adsEnabled
                    },
                    set: function(e) {},
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "interstitialEnabled", {
                    set: function(e) {
                        this._interstitialEnabled = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.setBannerInterval = function(e) {
                    var t = this;
                    void 0 === e && (e = 45e3),
                    this.adsEnabled && this.isBannerAdsSupported() && (this._bannerAdInterval && clearInterval(this._bannerAdInterval),
                    this._logger.info("Setting banner ad interval to ".concat(e / 1e3, " seconds")),
                    this._bannerAdInterval = setInterval((function() {
                        t._bannerAdIsVisible || t.showBannerAd()
                    }
                    ), e))
                }
                ,
                Object.defineProperty(t.prototype, "totalWatchedAds", {
                    get: function() {
                        return this._totalWatchedAdsModel.counter
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.countWatchedAd = function() {
                    this._totalWatchedAdsModel.countWatchedAd()
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._initializationPromise ? [2, this._initializationPromise] : [4, this.services.assetLoader.loadJsons(_e.REWARDED_VIDEOS_CONFIG)];
                            case 1:
                                return t.sent(),
                                [4, this._initializeSubModels()];
                            case 2:
                                return t.sent(),
                                this._initializationPromise = Promise.all(this._adsStrategies.map((function(t) {
                                    return t.initialize().then((function() {
                                        De.services.analytics.design.reportAdStrategyInitializationResult(t.name, "succes"),
                                        e._logger.info("Strategy ".concat(t.name, " initialized"))
                                    }
                                    )).catch((function(i) {
                                        De.services.analytics.design.reportAdStrategyInitializationResult(t.name, "fail"),
                                        Zn.error(i),
                                        e._logger.error("Strategy ".concat(t.name, " failed to initialize: ").concat(i))
                                    }
                                    ))
                                }
                                ))),
                                this._triggerBannerAd(),
                                [2, this._initializationPromise]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.isInterstitialAdsSupported = function() {
                    return this._adsStrategies.map((function(e) {
                        return e.isInterstitialAdsSupported()
                    }
                    )).reduce((function(e, t) {
                        return e || t
                    }
                    ), !1)
                }
                ,
                t.prototype.isRewardedAdsSupported = function() {
                    return this._adsStrategies.map((function(e) {
                        return e.isRewardedAdsSupported()
                    }
                    )).reduce((function(e, t) {
                        return e || t
                    }
                    ), !1)
                }
                ,
                t.prototype.isBannerAdsSupported = function() {
                    return Un() && De.services.analytics.tests.group === xn.TestGroupA ? (this._logger.warn("Banner ads are disabled for test group A"),
                    !1) : this._adsStrategies.map((function(e) {
                        return e.isBannerAdsSupported()
                    }
                    )).reduce((function(e, t) {
                        return e || t
                    }
                    ), !1)
                }
                ,
                t.prototype.showInterstitialAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return De.services.analytics.design.reportAdOppurtunity(Vn.INTERSTITIAL, e),
                            this._logger.info("Trying to show ads..."),
                            De.services.inventory.getAmount(An.LEVEL) > 3 ? this._adsEnabled ? this._interstitialEnabled ? De.services.analytics.model.totalSpent > 0 ? (this._logger.info("...dont show interstitial for paying users"),
                            [2, Promise.resolve({
                                status: Fn.INVALID,
                                reason: "NO_INTERSTITIAL_FOR_PAYING_USERS"
                            })]) : (this.onAdStart.fire(),
                            this.hideBannerAd(),
                            [2, this._recursivelyShowInterstitialAd(0, e).finally((function() {
                                t.setBannerInterval(),
                                t.onAdFinish.fire()
                            }
                            ))]) : (this._logger.info("...interstitial blocked"),
                            [2, Promise.resolve({
                                status: Fn.INVALID,
                                reason: "INTERSTITIALS_DISABLED"
                            })]) : (this._logger.info("...ads not enabled"),
                            [2, Promise.resolve({
                                status: Fn.INVALID,
                                reason: "ADS_DISABLED"
                            })]) : (this._logger.info("...user doesn't meet level requirements"),
                            [2, Promise.resolve({
                                status: Fn.INVALID,
                                reason: "USER_DOESNT_MEET_LEVEL_REQUIREMENTS"
                            })])
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.handleAdError = function() {
                    this._adsStrategies.forEach((function(e) {
                        var t;
                        null === (t = e.handleAdError) || void 0 === t || t.call(e)
                    }
                    ))
                }
                ,
                t.prototype.showConsentScreen = function() {
                    this._adsStrategies.forEach((function(e) {
                        var t;
                        null === (t = e.showConsentScreen) || void 0 === t || t.call(e)
                    }
                    ))
                }
                ,
                t.prototype.showRewardedAd = function(e) {
                    var t = this;
                    return De.services.analytics.design.reportAdOppurtunity(Vn.REWARDED_VIDEO, e),
                    this._adsEnabled ? (this.onAdStart.fire(),
                    this.hideBannerAd(),
                    this._recursivelyShowRewardedAd(0, e).finally((function() {
                        t.setBannerInterval(),
                        t.onAdFinish.fire()
                    }
                    ))) : Promise.resolve({
                        status: Fn.INVALID,
                        reason: "ADS_DISABLED"
                    })
                }
                ,
                t.prototype.showBannerAd = function() {
                    var e = this;
                    return De.services.analytics.design.reportAdOppurtunity(Vn.BANNER, "banner"),
                    this._logger.info("Attempting to show banner ad..."),
                    this._bannerAdIsVisible = !1,
                    this._adsEnabled ? De.services.analytics.model.totalSpent > 0 ? (this._logger.info("...dont show banner ads for paying users"),
                    Promise.resolve({
                        status: Fn.INVALID,
                        reason: "NO_ADS_FOR_PAYING_USERS"
                    })) : this._recursivelyShowBannerAd().then((function(t) {
                        return t.status !== Fn.VALID && (null == t ? void 0 : t.status) !== Fn.FAKE_AD || (e._bannerAdIsVisible = !0,
                        e.onBannerStart.fire(),
                        clearInterval(e._bannerAdInterval)),
                        t
                    }
                    )) : (this._logger.warn("...cannot show banner ads because ads are disabled in the cheats menu."),
                    Promise.resolve({
                        status: Fn.INVALID,
                        reason: "ADS_DISABLED"
                    }))
                }
                ,
                t.prototype.hideBannerAd = function() {
                    return this._logger.info("Hiding banner ad."),
                    clearInterval(this._bannerAdInterval),
                    this._bannerAdIsVisible = !1,
                    Promise.all(this._adsStrategies.map((function(e) {
                        return e.hideBannerAd()
                    }
                    )))
                }
                ,
                t.prototype.isBannerAdActive = function() {
                    return this._bannerAdIsVisible
                }
                ,
                t.prototype._triggerBannerAd = function() {
                    this.adsEnabled && this.isBannerAdsSupported() && this.setBannerInterval()
                }
                ,
                t.prototype._initializeSubModels = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this.services.resource.getJson(_e.REWARDED_VIDEOS_CONFIG).GLOBAL,
                                this._totalWatchedAdsModel = new er("TotalWatchedAdsModel",{
                                    INTERVAL: 1 / 0,
                                    ADS_MAX: 1 / 0
                                }),
                                [4, Promise.all([this.services.autosave.registerModel(this._totalWatchedAdsModel)])];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onBannerShowError = function(e) {
                    var t = "Cannot show banner ad. Code: ".concat(e.code, ", message: ").concat(e.message);
                    return this._bannerAdIsVisible = !1,
                    this._logger.error(t),
                    {
                        status: Fn.INVALID,
                        reason: void 0 === e.code ? "UNKNOWN_ERROR" : e.code
                    }
                }
                ,
                t.prototype._recursivelyShowInterstitialAd = function(e, t) {
                    return void 0 === e && (e = 0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r, o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return i = this._adsStrategies[e],
                                r = e === this._adsStrategies.length - 1,
                                this._logger.info("Trying to show interstitial ad with strategy ".concat(i.name)),
                                i.status !== Hn.INITIALIZED ? (De.services.analytics.design.reportAdShowResult(Vn.INTERSTITIAL, t, i.name, "FAIL", i.status),
                                this._logger.info("Strategy ".concat(i.name, " is not initialized")),
                                r ? [2, {
                                    status: Fn.INVALID,
                                    reason: "STRATEGY_NOT_INITIALIZED"
                                }] : [2, this._recursivelyShowInterstitialAd(e + 1, t)]) : i.isInterstitialAdsSupported() ? (this._logger.info("...strategy ".concat(i.name, " supports interstitial ads.")),
                                [4, i.showInterstitialAd(t)]) : (De.services.analytics.design.reportAdShowResult(Vn.INTERSTITIAL, t, i.name, "FAIL", "NOT_SUPPORTED"),
                                this._logger.info("...strategy ".concat(i.name, " does not support interstitial ads.")),
                                r ? [2, {
                                    status: Fn.INVALID,
                                    reason: "NOT_SUPPORTED"
                                }] : [2, this._recursivelyShowInterstitialAd(e + 1, t)]);
                            case 1:
                                return o = n.sent(),
                                De.services.analytics.design.reportAdShowResult(Vn.INTERSTITIAL, t, i.name, o.status === Fn.VALID ? "SUCCES" : "FAIL", o.reason),
                                this._logger.info("...strategy ".concat(i.name, " returned status ").concat(o.status, " and reason ").concat(o.reason)),
                                o.status === Fn.VALID ? [2, o] : (o.status,
                                Fn.AD_BLOCK_DETECTED,
                                o.status,
                                Fn.NO_CONSENT,
                                r ? [2, o] : [2, this._recursivelyShowInterstitialAd(e + 1, t)])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._recursivelyShowRewardedAd = function(e, t) {
                    return void 0 === e && (e = 0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r, o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return i = this._adsStrategies[e],
                                r = e === this._adsStrategies.length - 1,
                                o = {
                                    status: Fn.INVALID,
                                    reason: ""
                                },
                                this._logger.info("Trying to show rewarded ad with strategy ".concat(i.name)),
                                i.status === Hn.INITIALIZED ? [3, 1] : (De.services.analytics.design.reportAdShowResult(Vn.REWARDED_VIDEO, t, i.name, "FAIL", "STRATEGY_NOT_INITIALIZED"),
                                this._logger.info("Strategy ".concat(i.name, " is not initialized")),
                                r ? [2, {
                                    status: Fn.INVALID,
                                    reason: "STRATEGY_NOT_INITIALIZED"
                                }] : [2, this._recursivelyShowRewardedAd(e + 1, t)]);
                            case 1:
                                return i.isRewardedAdsSupported() ? [3, 2] : (this._logger.info("...strategy ".concat(i.name, " does not support rewarded ads.")),
                                o = {
                                    status: Fn.INVALID,
                                    reason: "NOT_SUPPORTED"
                                },
                                [3, 4]);
                            case 2:
                                return this._logger.info("...strategy ".concat(i.name, " supports rewarded ads.")),
                                [4, i.showRewardedAd(t)];
                            case 3:
                                o = n.sent(),
                                n.label = 4;
                            case 4:
                                return this._logger.info("...strategy ".concat(i.name, " returned status ").concat(o.status, " and reason ").concat(o.reason)),
                                De.services.analytics.design.reportAdShowResult(Vn.REWARDED_VIDEO, t, i.name, o.status === Fn.VALID ? "SUCCES" : "FAIL", o.reason),
                                o.status === Fn.VALID || o.status === Fn.AD_SKIPPED || o.status === Fn.AD_BLOCK_DETECTED || o.status === Fn.NO_CONSENT ? [2, o] : r ? (o.status === Fn.AD_ERROR || (o.status = Fn.FAKE_AD),
                                [2, o]) : [2, this._recursivelyShowRewardedAd(e + 1, t)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._recursivelyShowBannerAd = function(e) {
                    return void 0 === e && (e = 0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = this._adsStrategies[e],
                                i = e === this._adsStrategies.length - 1,
                                this._logger.info("Trying to show banner ad with strategy ".concat(t.name)),
                                t.isBannerAdsSupported() ? (r = {
                                    status: Fn.INVALID,
                                    reason: "UNKNOWN_ERROR"
                                },
                                this._logger.info("...strategy ".concat(t.name, " supports banner ads.")),
                                [4, t.showBannerAd().then((function() {
                                    r.status = Fn.VALID,
                                    r.reason = "SUCCESS"
                                }
                                )).catch((function(e) {
                                    var t = "Cannot show banner ad. Code: ".concat(e.code, ", message: ").concat(e.message);
                                    r.status = Fn.INVALID,
                                    r.reason = t
                                }
                                ))]) : (De.services.analytics.design.reportAdShowResult(Vn.BANNER, "banner", t.name, "FAIL", "NOT_SUPPORTED"),
                                this._logger.info("...strategy ".concat(t.name, " does not support banner ads.")),
                                i ? [2, {
                                    status: Fn.INVALID,
                                    reason: "NOT_SUPPORTED"
                                }] : [2, this._recursivelyShowBannerAd(e + 1)]);
                            case 1:
                                return n.sent(),
                                De.services.analytics.design.reportAdShowResult(Vn.BANNER, "banner", t.name, r.status === Fn.VALID ? "SUCCES" : "FAIL", r.reason),
                                this._logger.info("...strategy ".concat(t.name, " returned status ").concat(r.status, " and reason ").concat(r.reason)),
                                r.status === Fn.VALID ? [2, r] : i ? (r.status,
                                Fn.AD_ERROR,
                                [2, r]) : [2, this._recursivelyShowBannerAd(e + 1)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se)
              , ir = kn(10);
            !function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._restartInterstitialTimer(),
                    i
                }
                (0,
                n.__extends)(t, e),
                t.prototype.showInterstitialAd = function(t) {
                    var i = this;
                    return e.prototype.showInterstitialAd.call(this, t).then((function(e) {
                        return e.status === Fn.VALID && i._restartInterstitialTimer(),
                        e
                    }
                    ))
                }
                ,
                t.prototype.showRewardedAd = function(t) {
                    var i = this;
                    return e.prototype.showRewardedAd.call(this, t).then((function(e) {
                        return e.status === Fn.VALID && i._restartInterstitialTimer(),
                        e
                    }
                    ))
                }
                ,
                t.prototype._restartInterstitialTimer = function() {
                    var e = this;
                    this._logger.info("Restarting interstitial timer"),
                    this.interstitialEnabled = !1,
                    clearInterval(this._interStitialAdInterval),
                    this._interStitialAdInterval = setInterval((function() {
                        e._logger.info("Interstitial enabled"),
                        clearInterval(e._interStitialAdInterval),
                        e.interstitialEnabled = !0
                    }
                    ), ir)
                }
            }(tr);
            function nr(e, t) {
                for (var i = [], o = 2; o < arguments.length; o++)
                    i[o - 2] = arguments[o];
                var a = De.services.localization.getText(t);
                return r.StringUtility.formatString.apply(r.StringUtility, (0,
                n.__spreadArray)([a], i.map((function(e) {
                    return String(e)
                }
                )), !1))
            }
            function rr(e, t) {
                return void 0 === t && (t = {}),
                Object.entries(t).forEach((function(t) {
                    var i = t[0]
                      , n = t[1];
                    e[i].copyFrom(n)
                }
                )),
                e
            }
            function or(e) {
                var t = e.labelText
                  , i = e.spriteModifiers
                  , n = e.labelSettings
                  , r = new v.LabelSettings(n)
                  , o = new v.Label(t,r);
                return i ? rr(o, i) : o
            }
            var ar, sr, _r, cr = function(e) {
                function t(t, i, n, r, o) {
                    void 0 === i && (i = 10),
                    void 0 === n && (n = 10),
                    void 0 === r && (r = 10),
                    void 0 === o && (o = 10);
                    var a = e.call(this, t, i, n, r, o) || this;
                    return a._anchor = new Xe.ObservablePoint(a._onAnchorSet,a,0,0),
                    a
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "anchor", {
                    get: function() {
                        return this._anchor
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.setSizes = function(e) {
                    this.width = e.width,
                    this.height = e.height,
                    this.pivot.set(e.width * this._anchor.x, e.height * this._anchor.y)
                }
                ,
                t.prototype._onAnchorSet = function() {
                    this.setSizes({
                        width: this.width,
                        height: this.height
                    })
                }
                ,
                t
            }(Xe.NineSlicePlane), lr = i(5716), ur = function() {
                function e(e) {
                    var t = this;
                    this.onCustomEvent = new r.Event,
                    this.onStart = new r.Event,
                    this.onUpdate = new r.Event,
                    this.onEnd = new r.Event,
                    this._logger = Ie.Of("Animation Timeline"),
                    this._maxDuration = 0,
                    this._animations = {},
                    this._currentTargets = {},
                    this._config = JSON.parse(JSON.stringify(e)),
                    this._config.forEach((function(e) {
                        t._maxDuration = Math.max(t._maxDuration, e.duration),
                        t._animations[e.name] = {
                            name: e.name,
                            gsapTimeline: new lr.gsap.core.Timeline({
                                paused: !0,
                                repeat: e.repeat,
                                callbackScope: t,
                                onComplete: t._onCompleteAnimation,
                                onCompleteParams: [e.name],
                                onStart: t._onStartAnimation,
                                onStartParams: [e.name],
                                onUpdate: t._onUpdateAnimation,
                                onUpdateParams: [e.name]
                            }),
                            params: {}
                        }
                    }
                    ))
                }
                return e.prototype.setTargets = function(e) {
                    var t = this;
                    this._currentTargets = e,
                    this._config.forEach((function(e) {
                        t._animations[e.name].params = t._createTimelineParams(e)
                    }
                    ))
                }
                ,
                e.prototype.isAnimationPlaying = function(e) {
                    return this._animations[e].gsapTimeline.isActive()
                }
                ,
                e.prototype.play = function(e, t, i) {
                    void 0 === t && (t = 0),
                    void 0 === i && (i = !0);
                    var n = this._animations[e];
                    i ? n.gsapTimeline.kill() : (n.gsapTimeline.pause(0),
                    n.gsapTimeline.progress(0)),
                    this._createTimelineFromAnimation(e),
                    this._animations[e].gsapTimeline.delay(t).restart(t > 0)
                }
                ,
                e.prototype.restart = function(e) {
                    var t;
                    null === (t = this._animations[e]) || void 0 === t || t.gsapTimeline.restart()
                }
                ,
                e.prototype.pause = function(e) {
                    var t;
                    null === (t = this._animations[e]) || void 0 === t || t.gsapTimeline.pause()
                }
                ,
                e.prototype.stop = function(e) {
                    var t, i;
                    null === (t = this._animations[e]) || void 0 === t || t.gsapTimeline.pause(),
                    null === (i = this._animations[e]) || void 0 === i || i.gsapTimeline.progress(0)
                }
                ,
                e.prototype.stopAll = function() {
                    for (var e in this._animations)
                        this.stop(e)
                }
                ,
                e.prototype.dispose = function() {
                    for (var e in this._currentTargets = {},
                    this._animations)
                        this._animations[e].gsapTimeline.kill();
                    this.onCustomEvent.removeAllListeners(),
                    this.onStart.removeAllListeners(),
                    this.onUpdate.removeAllListeners(),
                    this.onEnd.removeAllListeners()
                }
                ,
                e.prototype._createTimelineFromAnimation = function(e) {
                    var t = function(t) {
                        var n = i._animations[e].params[t]
                          , r = [];
                        n.forEach((function(e) {
                            var t;
                            t = Ee(e.params.duration) && e.params.duration <= 0 ? lr.gsap.set(e.target, e.params) : lr.gsap.to(e.target, e.params),
                            r.push(t)
                        }
                        )),
                        i._animations[e].gsapTimeline.add(r, 0)
                    }
                      , i = this;
                    for (var n in this._animations[e].params)
                        t(n)
                }
                ,
                e.prototype._createTimelineParams = function(e) {
                    var t = this
                      , i = {}
                      , n = function(n) {
                        var o = r._currentTargets[n]
                          , a = e.keyframes[n];
                        i[n] = [],
                        a.forEach((function(r) {
                            var a = t._setTargetParamsToTimeline(o, t._currentTargets, r, e.duration);
                            if (i[n] = i[n].concat(a),
                            r.event) {
                                var s = t._createEventMarker(e.name, r, e.duration);
                                i[n].push(s)
                            }
                        }
                        ))
                    }
                      , r = this;
                    for (var o in e.keyframes)
                        n(o);
                    return i
                }
                ,
                e.prototype._createEventMarker = function(e, t, i) {
                    return {
                        target: {},
                        params: {
                            delay: t.time * i,
                            duration: 0,
                            onComplete: this._onCustomEvent,
                            callbackScope: this,
                            onCompleteParams: [e, t.event]
                        }
                    }
                }
                ,
                e.prototype._setTargetParamsToTimeline = function(e, t, i, r) {
                    var o;
                    void 0 === r && (r = 0);
                    var a = i.params
                      , s = []
                      , _ = [];
                    for (var c in this._recurseAndFindIndirectTargets(a, [], _),
                    this._copyIndirectTargetValues(_, a, t),
                    a) {
                        var l = i.duration * r
                          , u = i.time * r
                          , d = a[c]
                          , h = e
                          , p = ((o = {})[c] = d,
                        o);
                        if (ye(d)) {
                            var v = (0,
                            n.__assign)({}, d);
                            h = e[c],
                            p = (0,
                            n.__assign)({}, v)
                        }
                        s.push({
                            target: h,
                            params: (0,
                            n.__assign)((0,
                            n.__assign)({}, p), {
                                delay: u,
                                duration: l,
                                ease: i.ease
                            })
                        })
                    }
                    return s
                }
                ,
                e.prototype._recurseAndFindIndirectTargets = function(e, t, i) {
                    var r = this._getIndirectKeyName(e);
                    if (r)
                        return r;
                    if (ye(e))
                        for (var o in e) {
                            t.push(o);
                            var a = this._recurseAndFindIndirectTargets(e[o], t, i);
                            a && i.push({
                                value: a,
                                keys: (0,
                                n.__spreadArray)([], t, !0)
                            }),
                            t.pop()
                        }
                    return null
                }
                ,
                e.prototype._copyIndirectTargetValues = function(e, t, i) {
                    for (var n = 0, r = e; n < r.length; n++) {
                        var o = r[n];
                        if (Object.prototype.hasOwnProperty.call(i, o.value))
                            for (var a = i[o.value], s = t, _ = 0; _ < o.keys.length; _++) {
                                var c = o.keys[_];
                                void 0 !== a[c] ? _ !== o.keys.length - 1 ? (a = a[c],
                                s = s[c]) : s[c] = JSON.parse(JSON.stringify(a[c])) : this._logger.warn("Missing property from indirect target ".concat(o.value, " => ").concat(c))
                            }
                        else
                            this._logger.warn("Indirect target does not exist ".concat(o.value, ", no values were copied"))
                    }
                }
                ,
                e.prototype._getIndirectKeyName = function(e) {
                    return fe(e) && 0 === e.search("\\$") ? e.replace("$", "") : null
                }
                ,
                e.prototype._onCompleteAnimation = function(e) {
                    this.onEnd.fire(e)
                }
                ,
                e.prototype._onUpdateAnimation = function(e) {
                    this.onUpdate.fire(e)
                }
                ,
                e.prototype._onStartAnimation = function(e) {
                    this.onStart.fire(e)
                }
                ,
                e.prototype._onCustomEvent = function(e, t) {
                    this.onCustomEvent.fire({
                        animation: e,
                        event: t
                    })
                }
                ,
                e
            }(), dr = [{
                name: "button_press",
                duration: .15,
                repeat: 0,
                keyframes: {
                    buttonActive: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            alpha: 1
                        }
                    }],
                    backgroundContainer: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            scale: "$scale"
                        }
                    }],
                    contentContainer: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            scale: "$scale"
                        }
                    }],
                    scale: []
                }
            }, {
                name: "button_release",
                duration: .25,
                repeat: 0,
                keyframes: {
                    buttonActive: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            alpha: 0
                        }
                    }],
                    backgroundContainer: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }],
                    contentContainer: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }],
                    scale: []
                }
            }], hr = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    i._buttonContainer = new Xe.Container,
                    i._content = new Xe.Container,
                    i._isPressed = !1,
                    i._isEnabled = !0,
                    i.name = t.name;
                    var n = De.services.resource.getTexture(t.buttonIdle)
                      , r = De.services.resource.getTexture(t.buttonActive || t.buttonIdle)
                      , o = De.services.resource.getTexture(t.buttonInactive || t.buttonIdle);
                    return i._hasActiveTexture = !!t.buttonActive,
                    i._buttonIdle = new cr(n),
                    i._buttonActive = new cr(r),
                    i._buttonInactive = new cr(o),
                    i._targetPressedScale = t.targetPressedScale ? t.targetPressedScale : 1.05,
                    t.backdropContent && t.backdropContent.forEach((function(e) {
                        return i._buttonContainer.addChild(e)
                    }
                    )),
                    i._buttonActive.alpha = 0,
                    i._buttonIdle.anchor.set(.5),
                    i._buttonActive.anchor.set(.5),
                    i._buttonInactive.anchor.set(.5),
                    i._buttonInactive.alpha = .5,
                    i._buttonContainer.addChild(i._buttonIdle),
                    i._buttonContainer.addChild(i._buttonActive),
                    i._buttonContainer.addChild(i._buttonInactive),
                    i.addChild(i._buttonContainer),
                    i.addChild(i._content),
                    i.setAnimationTargets(),
                    i.buttonMode = !0,
                    i.interactive = !0,
                    t.hitArea && (i.interactiveChildren = !1,
                    i.hitArea = t.hitArea),
                    i.uiHeight = t.uiHeight ? t.uiHeight : i.height,
                    i.enable(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "buttonContainer", {
                    get: function() {
                        return this._buttonContainer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.disable = function() {
                    this._isEnabled = !1,
                    this._buttonActive.visible = !1,
                    this._buttonIdle.visible = !1,
                    this._buttonInactive.visible = !0
                }
                ,
                t.prototype.enable = function() {
                    this._isEnabled = !0,
                    this._buttonActive.visible = !0,
                    this._buttonIdle.visible = !0,
                    this._buttonInactive.visible = !1
                }
                ,
                t.prototype.show = function() {
                    this.visible = !0
                }
                ,
                t.prototype.hide = function() {
                    this.visible = !1
                }
                ,
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    this._animationTimeline.dispose()
                }
                ,
                t.prototype.onClick = function(e) {
                    var t = this;
                    this.removeAllListeners(),
                    this.on("pointerdown", (function(e) {
                        t._isEnabled && (t._buttonPressed(e),
                        t._isPressed = !0)
                    }
                    )),
                    this.on("pointerup", (function(i) {
                        t._isEnabled && (t._isPressed && t._buttonReleased(i, e),
                        t._isPressed = !1)
                    }
                    )),
                    this.on("pointerupoutside", (function() {
                        t._isEnabled && (t._isPressed = !1,
                        t._hasActiveTexture && t._animationTimeline.play("button_release"))
                    }
                    ))
                }
                ,
                t.prototype.setAnimationTargets = function() {
                    this._animationTimeline = new ur(dr),
                    this._animationTimeline.setTargets({
                        buttonActive: this._buttonActive,
                        backgroundContainer: this._buttonContainer,
                        contentContainer: this._content,
                        scale: {
                            scale: {
                                x: this._targetPressedScale,
                                y: this._targetPressedScale
                            }
                        }
                    })
                }
                ,
                t.prototype.addContent = function(e) {
                    this._content.addChild(e)
                }
                ,
                t.prototype.removeContent = function(e) {
                    this._content.removeChild(e)
                }
                ,
                t.prototype._buttonPressed = function(e) {
                    e.stopPropagation(),
                    this._hasActiveTexture && this._animationTimeline.play("button_press"),
                    De.services.audio.playSoundEffect(m.BUTTON_TAP)
                }
                ,
                t.prototype._buttonReleased = function(e, t) {
                    Zn.breadcrumbs.buttonClick(this.name),
                    e.stopPropagation(),
                    t && t(),
                    this._hasActiveTexture && this._animationTimeline.play("button_release")
                }
                ,
                t
            }(Xe.Container), pr = {
                leftWidth: 20,
                topHeight: 10,
                rightWidth: 20,
                bottomHeight: 40
            }, vr = function(e) {
                function t(t, i) {
                    var r = e.call(this, t) || this
                      , o = De.services.resource.getTexture(t.buttonIdle)
                      , a = De.services.resource.getTexture(t.buttonActive || t.buttonIdle)
                      , s = De.services.resource.getTexture(t.buttonInactive || t.buttonIdle)
                      , _ = i.buttonCorners || (0,
                    n.__assign)({}, pr);
                    return r._buttonContainer.removeChild(r._buttonIdle),
                    r._buttonContainer.removeChild(r._buttonActive),
                    r._buttonContainer.removeChild(r._buttonInactive),
                    r._buttonIdle = new cr(o,_.leftWidth,_.topHeight,_.rightWidth,_.bottomHeight),
                    r._buttonActive = new cr(a,_.leftWidth,_.topHeight,_.rightWidth,_.bottomHeight),
                    r._buttonInactive = new cr(s,_.leftWidth,_.topHeight,_.rightWidth,_.bottomHeight),
                    r._buttonIdle.setSizes(i.buttonSizes),
                    r._buttonActive.setSizes(i.buttonSizes),
                    r._buttonInactive.setSizes(i.buttonSizes),
                    r._buttonActive.alpha = 0,
                    r._buttonIdle.anchor.set(.5),
                    r._buttonActive.anchor.set(.5),
                    r._buttonInactive.anchor.set(.5),
                    r._buttonContainer.addChild(r._buttonIdle),
                    r._buttonContainer.addChild(r._buttonActive),
                    r._buttonContainer.addChild(r._buttonInactive),
                    r.setAnimationTargets(),
                    r.interactive = !0,
                    r.enable(),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.updateButtonTexture = function(e, t) {
                    this._buttonIdle.texture = De.services.resource.getTexture(e),
                    this._buttonIdle.textureUpdated(),
                    t && (this._buttonActive.texture = De.services.resource.getTexture(t),
                    this._buttonActive.textureUpdated())
                }
                ,
                t
            }(hr), gr = {
                left: {
                    x: 0,
                    y: .5
                },
                center: {
                    x: .5,
                    y: .5
                },
                right: {
                    x: 1,
                    y: .5
                }
            }, fr = function(e) {
                function t(t, i, n, r) {
                    var o = e.call(this, t, i) || this;
                    o._resourcesService = De.services.resource,
                    o.BUTTON_EDGE_MARGIN = 1.2,
                    o._labelSettings = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: n.fitBoxSizes ? n.fitBoxSizes.height : o._calculateFitToBoxHeight(i),
                        fitWidth: n.fitBoxSizes ? n.fitBoxSizes.width : o._calculateFitToBoxWidth(i)
                    }),
                    o._labelSettings.style = n.textStyle;
                    var a = n.alignment ? gr[n.alignment] : gr.center;
                    return o._buttonText = new v.Label(o._getButtonText(n.text),o._labelSettings),
                    o._buttonText.anchor.copyFrom(a),
                    n.position && o._buttonText.position.set(n.position.x, n.position.y),
                    o.addContent(o._buttonText),
                    r && o.addContent(r),
                    o._updateFontFamily(),
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.updateText = function(e, t) {
                    this._buttonText.text = this._getButtonText(e),
                    t && this._buttonText.position.copyFrom(t)
                }
                ,
                t.prototype.updateTextStyle = function(e) {
                    Object.assign(this._buttonText.style, e)
                }
                ,
                t.prototype._getButtonText = function(e) {
                    return fe(e) ? e : nr(ar || (ar = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), e)
                }
                ,
                t.prototype._calculateFitToBoxWidth = function(e) {
                    return e.buttonSizes.width / this.BUTTON_EDGE_MARGIN
                }
                ,
                t.prototype._calculateFitToBoxHeight = function(e) {
                    return e.buttonSizes.height / this.BUTTON_EDGE_MARGIN
                }
                ,
                t.prototype._updateFontFamily = function() {
                    this._buttonText.style.fontFamily = vn.currentFontFamily
                }
                ,
                t
            }(vr), Er = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._serviceInitializationPromises = {},
                    i._serviceDestroyPromises = {},
                    i.onSceneShowPromise = new Promise((function(e) {
                        return i._onSceneShowPromiseResolve = e
                    }
                    )),
                    i.onSceneHidePromise = new Promise((function(e) {
                        return i._onSceneHidePromiseResolve = e
                    }
                    )),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.addServices = function(e) {
                    this.services = (0,
                    n.__assign)({}, e)
                }
                ,
                t.prototype.initialize = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, this._initializeServices()];
                            case 1:
                                return t.sent(),
                                this.startServices(),
                                e && e(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onShow = function() {
                    e.prototype.onShow.call(this),
                    this._onSceneShowPromiseResolve()
                }
                ,
                t.prototype.onHide = function() {
                    e.prototype.onHide.call(this),
                    this._onSceneHidePromiseResolve()
                }
                ,
                t.prototype.destroy = function(t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, this._destroyServices()];
                            case 1:
                                return i.sent(),
                                e.prototype.destroy.call(this, t),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._initializeServices = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                if (!this.services)
                                    throw new Error("services have not been provided and cannot be initialized!");
                                return Object.keys(this.services).forEach((function(t) {
                                    if (!e.services[t])
                                        throw new Error("service ".concat(String(t), " has not been provided and cannot be initialized!"));
                                    Oe(e.services[t]) && !e._serviceInitializationPromises[t] && (e._serviceInitializationPromises[t] = e.services[t].initialize(e.services))
                                }
                                )),
                                [4, Promise.all(Object.values(this._serviceInitializationPromises))];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.startServices = function() {
                    Object.values(this.services).forEach((function(e) {
                        Oe(e) && e.start()
                    }
                    ))
                }
                ,
                t.prototype._destroyServices = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return Object.keys(this.services).forEach((function(t) {
                                    Oe(e.services[t]) && !e._serviceDestroyPromises[t] && (e._serviceDestroyPromises[t] = e.services[t].destroy())
                                }
                                )),
                                [4, Promise.all(Object.values(this._serviceDestroyPromises))];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(v.View), mr = [{
                name: "open",
                duration: .6,
                repeat: 0,
                keyframes: {
                    content: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            position: {
                                y: "$startTarget"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "back.out",
                        params: {
                            position: {
                                y: "$endTarget"
                            }
                        }
                    }],
                    background: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: "$alpha"
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            alpha: 1
                        }
                    }],
                    startTarget: [],
                    endTarget: [],
                    alpha: []
                }
            }, {
                name: "close",
                duration: .6,
                repeat: 0,
                keyframes: {
                    content: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            position: {
                                y: "$startTarget"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "back.in",
                        params: {
                            position: {
                                y: "$endTarget"
                            }
                        }
                    }],
                    background: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            alpha: "$alpha"
                        }
                    }],
                    startTarget: [],
                    endTarget: [],
                    alpha: []
                }
            }], yr = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.onClosed = new r.Event,
                    i.onOpened = new r.Event,
                    i._logger = r.Logger.Of("BasePopup"),
                    i._content = new Xe.Container,
                    i._popupLocked = !1,
                    i._keepBackground = !1,
                    i._startWithBlackBackground = !1,
                    i._popupPositionOffset = 0,
                    i._pointerDownOutsidePopup = !1,
                    i._content.interactive = !0,
                    i._inputBlocker = (new Xe.Graphics).beginFill(0, .6).drawRect(-1, -1, 2, 2).endFill(),
                    i._inputBlocker.interactive = !0,
                    i._inputBlocker.on("pointerdown", (function(e) {
                        i._pointerDownOutsidePopup = !0,
                        e.stopPropagation()
                    }
                    )),
                    i._inputBlocker.on("pointerup", (function(e) {
                        i._pointerDownOutsidePopup && (i._pointerDownOutsidePopup = !1,
                        e.stopPropagation(),
                        i._tryToClose(e))
                    }
                    )),
                    i.addServices({}),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "popupLocked", {
                    get: function() {
                        return this._popupLocked
                    },
                    set: function(e) {
                        this._popupLocked = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "keepBackground", {
                    set: function(e) {
                        this._keepBackground = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "startWithBlackBackground", {
                    set: function(e) {
                        this._startWithBlackBackground = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.resize = function() {
                    this._resizeInputBlocker()
                }
                ,
                t.prototype.beforeShow = function(t) {
                    this.addChild(this._inputBlocker),
                    this.addChild(this._content),
                    this._setBaseAnimationTargets(this._startWithBlackBackground ? 1 : 0, !0),
                    this._setAnimationListener(),
                    this._resizeInputBlocker(),
                    this._baseAnimation.play("open"),
                    Zn.breadcrumbs.popupOpen(this._name),
                    this._onShowSounds(),
                    e.prototype.beforeShow.call(this, t)
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._popupLocked || this._baseAnimation.isAnimationPlaying("open") || this._baseAnimation.isAnimationPlaying("close") || (this._setBaseAnimationTargets(this._keepBackground ? 1 : 0, !1),
                            this._setAnimationListener(),
                            Zn.breadcrumbs.popupClose(this._name),
                            this._baseAnimation.play("close"),
                            this._baseAnimation.onEnd.listenOnce((function(t) {
                                e._inputBlocker.interactive = !1
                            }
                            ), this),
                            this._onCloseSounds()),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._tryToClose = function(e) {
                    e.stopPropagation();
                    var t = e.data.getLocalPosition(this)
                      , i = t.x
                      , n = t.y;
                    this._content.getLocalBounds().contains(i, n) || this.close()
                }
                ,
                t.prototype._resizeInputBlocker = function() {
                    var e = De.services.canvas.bounds;
                    this._inputBlocker.width = e.width,
                    this._inputBlocker.height = e.height
                }
                ,
                t.prototype._onShowSounds = function() {
                    De.services.audio.playSoundEffect(m.POPUP_IN)
                }
                ,
                t.prototype._onCloseSounds = function() {
                    De.services.audio.playSoundEffect(m.POPUP_OUT)
                }
                ,
                t.prototype.createReferenceLabel = function(e, t) {
                    var i = new v.Label(e,t);
                    return this.addChild(i),
                    i.position.set(-9999999999, -9999999999),
                    i
                }
                ,
                t.prototype._resizePopupContent = function() {
                    var e = De.services.canvas.bounds
                      , t = Math.min((e.height - 175) / this._content.height, 1);
                    this._content.scale.set(t)
                }
                ,
                t.prototype._setBaseAnimationTargets = function(e, t) {
                    var i, n = De.services.canvas.bounds, r = t ? n.height / 2 + this._content.height / 2 : this._popupPositionOffset, o = t ? this._popupPositionOffset : n.height / 2 + this._content.height / 2;
                    null === (i = this._baseAnimation) || void 0 === i || i.dispose(),
                    this._baseAnimation = new ur(mr),
                    this._baseAnimation.setTargets({
                        alpha: {
                            alpha: e
                        },
                        content: this._content,
                        background: this._inputBlocker,
                        startTarget: {
                            position: {
                                x: 0,
                                y: r
                            }
                        },
                        endTarget: {
                            position: {
                                x: 0,
                                y: o
                            }
                        }
                    })
                }
                ,
                t.prototype._setAnimationListener = function() {
                    var e = this;
                    this._baseAnimation.onEnd.addListener((function(t) {
                        "close" === t ? (e._baseAnimation.dispose(),
                        e.onClosed.fire(e)) : e.onOpened.fire()
                    }
                    ), this)
                }
                ,
                t
            }(Er), Tr = {
                size: {
                    width: 1e3,
                    height: 1e3
                },
                headerSize: {
                    width: 750,
                    height: 100
                },
                headerText: void 0,
                headerStyle: vn.popupTitle,
                showCloseButton: !0
            }, Ar = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.HEADER_OFFSET = 50,
                    i.CLOSE_OFFSET = -50,
                    i._properties = (0,
                    n.__assign)((0,
                    n.__assign)({}, Tr), t),
                    i._createBackground(i._properties.size),
                    i._createHeader(i._properties.headerSize, i._properties.headerText, i._properties.headerStyle),
                    i._createCloseButton(i._properties.showCloseButton),
                    i._properties.headerIcon && i._createIcon(i._properties.headerIcon),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.resize = function(e) {
                    this._background.setSizes(e)
                }
                ,
                t.prototype.onCloseClick = function(e) {
                    this._closeButton.onClick(e)
                }
                ,
                t.prototype.updateHeaderText = function(e) {
                    var t;
                    this._header.text = e,
                    null === (t = this._icon) || void 0 === t || t.position.set(this._header.x - (this._header.width / 2 + 90), this._header.y - 20)
                }
                ,
                t.prototype.updateHeaderTextStyle = function(e) {
                    Object.assign(this._header.style, e)
                }
                ,
                t.prototype._createHeader = function(e, t, i) {
                    var r = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: e.height,
                        fitWidth: e.width
                    });
                    r.style = i,
                    this._header = t ? new v.Label(nr(sr || (sr = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), t),r) : new v.Label("",r),
                    this._header.anchor.set(.5),
                    this._properties.customHeaderTextPosition ? this._header.position.set(this._properties.customHeaderTextPosition.x, this._properties.customHeaderTextPosition.y) : this._header.position.set(0, this.HEADER_OFFSET - this._background.height / 2),
                    this.addChild(this._header)
                }
                ,
                t.prototype._createBackground = function(e) {
                    var t = f.POPUP_9SLICE
                      , i = {
                        leftWidth: 10,
                        topHeight: 110,
                        rightWidth: 10,
                        bottomHeight: 10
                    };
                    this._properties.customNineslice && (t = this._properties.customNineslice),
                    this._properties.customNinesliceOptions && (i = (0,
                    n.__assign)((0,
                    n.__assign)({}, i), this._properties.customNinesliceOptions)),
                    this._background = new cr(De.services.resource.getTexture(t),i.leftWidth,i.topHeight,i.rightWidth,i.bottomHeight),
                    this._background.setSizes({
                        width: e.width,
                        height: e.height
                    }),
                    this._background.position.set(-.5 * e.width, -.5 * e.height),
                    this.addChild(this._background)
                }
                ,
                t.prototype._createIcon = function(e) {
                    this._icon = De.services.resource.getSprite(e),
                    this._icon.anchor.set(.5),
                    this._icon.position.set(this._header.x - (this._header.width / 2 + 90), this._header.y - 20),
                    this.addChild(this._icon)
                }
                ,
                t.prototype._createCloseButton = function(e) {
                    this._closeButton = new hr({
                        name: "close",
                        buttonIdle: this._properties.customCloseButtonIdle ? this._properties.customCloseButtonIdle : f.BTN_CLOSE_IDLE,
                        buttonActive: this._properties.customCloseButtonActive ? this._properties.customCloseButtonActive : f.BTN_CLOSE_ACTIVE
                    }),
                    this._properties.customCloseButtonPosition ? this._closeButton.position.set(this._properties.customCloseButtonPosition.x, this._properties.customCloseButtonPosition.y) : this._closeButton.position.set(this.CLOSE_OFFSET + this._background.width / 2, this.HEADER_OFFSET - this._background.height / 2),
                    this._closeButton.visible = e,
                    this.addChild(this._closeButton)
                }
                ,
                t
            }(Xe.Container);
            !function(e) {
                e[e.IMMEDIATE = 0] = "IMMEDIATE",
                e[e.HIGH = 1] = "HIGH",
                e[e.NORMAL = 2] = "NORMAL",
                e[e.TOAST = 3] = "TOAST"
            }(_r || (_r = {}));
            var Cr, Ir, Sr, Or, br, Rr, wr, Dr = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "SignInBonusPopup",
                    i._itemPositions = new Map,
                    i._notification = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    i._options = {
                        popupHeader: ce.SIGNIN_BONUS_POPUP_HEADER,
                        infoImage: f.ICON_FREEBIE_OFFERS,
                        infoText: ce.SIGNIN_BONUS_POPUP_BODY
                    },
                    i._productData = t.productData,
                    i._service = t.service,
                    i.onClosed.listenOnce((function() {
                        return i._service.incentivePopupClosed()
                    }
                    ), i),
                    i._createBackground(),
                    i._createHeader(),
                    i._createInfo(),
                    i._createBonusVisual(),
                    i._createWarning(),
                    i._createColllectRewardsButton(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype._createBackground = function() {
                    var e = this
                      , t = this._getBackgroundSize();
                    this._backGround = new Ar({
                        size: t,
                        headerSize: {
                            width: t.width / 1.5,
                            height: 75
                        },
                        headerStyle: vn.popupTitle,
                        showCloseButton: !0
                    }),
                    this._content.addChild(this._backGround),
                    this._backGround.onCloseClick((function() {
                        return e.close()
                    }
                    ))
                }
                ,
                t.prototype._createHeader = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !1
                    });
                    e.style = vn.lightBoldMedium,
                    this._content.addChild(rr(new v.Label(nr(Cr || (Cr = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), this._options.popupHeader),e), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -this._getBackgroundSize().height / 2 + 37.5 + 10
                        }
                    }))
                }
                ,
                t.prototype._getBackgroundSize = function() {
                    var e = De.services.resource.getSprite(this._options.infoImage).width + 20
                      , t = De.services.resource.getSprite(this._options.infoImage).height + 75 + 520;
                    return {
                        width: Math.max(e, 1e3),
                        height: Math.max(t, 900)
                    }
                }
                ,
                t.prototype._createInfo = function() {
                    this._content.addChild(rr(De.services.resource.getSprite(this._options.infoImage), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: -this._getBackgroundSize().height / 2 + 75 + 130
                        }
                    }));
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: this._getBackgroundSize().width - 20
                    });
                    e.style = vn.darkMedium,
                    this._content.addChild(rr(new v.Label(nr(Ir || (Ir = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), this._options.infoText),e), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: -this._getBackgroundSize().height / 2 + 75 + 40
                        }
                    }))
                }
                ,
                t.prototype._createBonusVisual = function() {
                    var e = new Xe.Container
                      , t = De.services.resource.getSprite(f.ICON_FREEBIE_OFFERS).width
                      , i = De.services.resource.getSprite(f.ICON_FREEBIE_OFFERS).height
                      , n = new v.LabelSettings({
                        fitHeight: 135,
                        fitWidth: 300,
                        fitToBox: !0
                    });
                    n.style = vn.darkMedium;
                    for (var r = 1; r <= 3; r++) {
                        var o = this._productData.reward[r - 1].amount.toString()
                          , a = new v.Label(o,n);
                        a.anchor.set(.5);
                        var s = 10 * (2 - r);
                        a.position.set(-t / 3 + (r - 1) * t / 3 - s, 0),
                        this._itemPositions.set(this._productData.reward[r - 1].key, a.position),
                        e.addChild(a)
                    }
                    e.position.set(0, -this._getBackgroundSize().height / 2 + 150 + i + 5),
                    this._content.addChild(e)
                }
                ,
                t.prototype._createWarning = function() {
                    var e = ce.SIGNIN_BONUS_POPUP_WARNING
                      , t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 200,
                        fitWidth: this._getBackgroundSize().width / 1.2
                    });
                    t.style = vn.darkOrangeMedium,
                    t.style.lineHeight = vn.sizeMedium + 10,
                    this._content.addChild(rr(new v.Label(nr(Sr || (Sr = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), e),t), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: this._getBackgroundSize().height / 2 - 360
                        }
                    }))
                }
                ,
                t.prototype._createColllectRewardsButton = function() {
                    var e = this
                      , t = new fr({
                        name: "collect rewards",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: {
                            width: 300,
                            height: 90
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: ce.SIGNIN_BONUS_POPUP_BUTTON,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    t.position.set(0, this._getBackgroundSize().height / 2 - 90),
                    this._notification.position.set(t.width / 2 - 7, -t.height / 4.5 + 10),
                    t.addChild(this._notification),
                    this._notification.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                    this._notification.visible = !0,
                    t.onClick((function() {
                        return e._onButtonClicked()
                    }
                    )),
                    this._content.addChild(t)
                }
                ,
                t.prototype._onButtonClicked = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._service.signInButtonClicked(),
                            this.onClosed.listenOnce((function() {
                                vp.platform.loginStrategy.attemptLogin().then((function(e) {
                                    e === be.SUCCESS && IO()
                                }
                                ))
                            }
                            ), this),
                            this.close(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr), Nr = [{
                name: "loot_appear",
                duration: .45,
                repeat: 0,
                keyframes: {
                    lootItem: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: .266,
                        duration: .444,
                        event: "spawnStart",
                        ease: "none",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: .266,
                        duration: .368,
                        ease: "sine.out",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .266,
                        duration: .733,
                        ease: "power1.out",
                        params: {
                            position: "$appear"
                        }
                    }],
                    appear: [],
                    itemAngle: [],
                    escapeAngle: [],
                    counter: []
                }
            }, {
                name: "loot_circle",
                duration: .35,
                repeat: 0,
                keyframes: {
                    itemAngle: [{
                        time: 0,
                        duration: 1,
                        ease: "back.in",
                        params: {
                            angle: "$escapeAngle"
                        }
                    }],
                    lootItem: [],
                    appear: [],
                    counter: [],
                    escapeAngle: []
                }
            }, {
                name: "loot_to_top_target",
                duration: .35,
                repeat: 0,
                keyframes: {
                    lootItem: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            scale: {
                                x: .6,
                                y: .6
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.in",
                        params: {
                            position: {
                                x: "$counter"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            position: {
                                y: "$counter"
                            }
                        }
                    }, {
                        time: .9,
                        duration: .1,
                        ease: "none",
                        event: "startCounter",
                        params: {}
                    }],
                    appear: [],
                    itemAngle: [],
                    escapeAngle: [],
                    counter: []
                }
            }, {
                name: "loot_to_bottom_target",
                duration: .35,
                repeat: 0,
                keyframes: {
                    lootItem: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            scale: {
                                x: .6,
                                y: .6
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            position: {
                                x: "$counter"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.in",
                        params: {
                            position: {
                                y: "$counter"
                            }
                        }
                    }, {
                        time: .9,
                        duration: .1,
                        ease: "none",
                        event: "startCounter",
                        params: {}
                    }],
                    appear: [],
                    itemAngle: [],
                    escapeAngle: [],
                    counter: []
                }
            }], Lr = function() {
                function e(e, t, i, o, a) {
                    this.onAnimationComplete = new r.Event,
                    this.onAnimationSpawn = new r.Event,
                    this.onAnimationObjectEnd = new r.Event,
                    this._circleRadius = 175,
                    this._maxAmountofItems = 10,
                    this._distribution = .45,
                    this._totalObjects = 1,
                    this._spacing = 0,
                    this._animationResources = [],
                    this._objectToSpawnSprite = e,
                    this._spawnPosition = t,
                    this._finalPosition = i,
                    this._animationTimelineConfig = (0,
                    n.__spreadArray)([], Nr, !0);
                    var s = Math.floor(Math.log(o) / Math.log(3));
                    this._totalObjects = s >= 1 ? r.NumberUtility.clamp(1, s + 2, this._maxAmountofItems) : 1,
                    this._parentContainer = a,
                    this._spacing = 2 * this._distribution * Math.PI / (this._totalObjects + 1),
                    this._animationResources = this._createAnimationResources(),
                    this._setupAnimationEventListeners()
                }
                return e.prototype.animate = function() {
                    for (var e = 0, t = this._animationResources; e < t.length; e++)
                        t[e].timeline.play("loot_appear")
                }
                ,
                e.prototype._createAnimationResources = function() {
                    for (var e = [], t = 0; t < this._totalObjects; t++) {
                        var i = new Xe.Sprite(this._objectToSpawnSprite.texture);
                        this._parentContainer.addChild(i),
                        i.position.copyFrom(this._spawnPosition),
                        i.anchor.set(.5, .5),
                        i.alpha = 0;
                        var n = this._spacing * (this._totalObjects - 1) * .5
                          , o = t * this._spacing - n
                          , a = Math.sin(o) * this._circleRadius + i.x
                          , s = Math.cos(o) * this._circleRadius + i.y
                          , _ = Math.atan2(s - this._spawnPosition.y, a - this._spawnPosition.x)
                          , c = Math.atan2(this._finalPosition.y - this._spawnPosition.y, this._spawnPosition.x - (this._finalPosition.x - 25))
                          , l = c > -Math.PI / 2 ? (this._totalObjects - (t + 1)) / 10 : t / 10
                          , u = {
                            angle: _
                        }
                          , d = c > -Math.PI / 2 ? {
                            angle: r.NumberUtility.clamp(-3.5, -1 * (c + Math.PI / 4), .2)
                        } : {
                            angle: r.NumberUtility.clamp(-.2, -1 * (c - Math.PI / 4), 3.5)
                        };
                        this._animationTimelineConfig[1].duration = .35 + l;
                        var h = new ur(Nr);
                        h.setTargets({
                            lootItem: i,
                            appear: {
                                position: {
                                    x: a,
                                    y: s
                                }
                            },
                            itemAngle: u,
                            escapeAngle: d,
                            counter: {
                                position: {
                                    x: this._finalPosition.x,
                                    y: this._finalPosition.y
                                }
                            }
                        }),
                        e.push({
                            timeline: h,
                            rewardObject: i,
                            itemAngle: u,
                            startAngle: _
                        })
                    }
                    return e
                }
                ,
                e.prototype._setupAnimationEventListeners = function() {
                    for (var e = this, t = this._animationResources.length, i = function(i) {
                        var n = i.timeline
                          , r = i.rewardObject
                          , o = i.itemAngle;
                        n.onUpdate.addListener((function(t) {
                            "loot_circle" === t && r.position.set(e._spawnPosition.x + e._circleRadius * Math.cos(o.angle), e._spawnPosition.y + e._circleRadius * Math.sin(o.angle))
                        }
                        ), null),
                        n.onCustomEvent.addListener((function(e) {
                            "loot_to_top_target" === e.animation && "startCounter" === e.event && De.services.audio.playSoundEffect(m.CURRENCY_ADDED)
                        }
                        ), void 0),
                        n.onEnd.addListener((function(i) {
                            switch (i) {
                            case "loot_appear":
                                n.play("loot_circle");
                                break;
                            case "loot_circle":
                                e._finalPosition.y > 0 ? n.play("loot_to_bottom_target") : n.play("loot_to_top_target");
                                break;
                            case "loot_to_top_target":
                            case "loot_to_bottom_target":
                                t--,
                                e._onAnimationCompleted(r, n, t)
                            }
                        }
                        ), null)
                    }, n = 0, r = this._animationResources; n < r.length; n++)
                        i(r[n]);
                    this._animationResources[this._animationResources.length - 1].timeline.onCustomEvent.listenOnce((function(t) {
                        "spawnStart" === t.event && e.onAnimationSpawn.fire()
                    }
                    ), this)
                }
                ,
                e.prototype._onAnimationCompleted = function(e, t, i) {
                    e.destroy(),
                    t.dispose(),
                    this.onAnimationObjectEnd.fire(),
                    i <= 0 && (this.onAnimationComplete.fire(),
                    this.onAnimationObjectEnd.removeAllListeners(),
                    this.onAnimationComplete.removeAllListeners(),
                    this.onAnimationSpawn.removeAllListeners())
                }
                ,
                e
            }(), Br = 75, Pr = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "SignInBonusRewardsPopup",
                    i._itemPositions = new Map,
                    i._options = {
                        popupHeader: ce.SIGNIN_BONUS_SUCCESSFUL_HEADER,
                        infoImage: f.ICON_FREEBIE_OFFERS,
                        infoText: ce.SIGNIN_BONUS_SUCCESSFUL_BODY
                    },
                    i._productData = t.productData,
                    i._service = t.service,
                    i.onClosed.listenOnce((function() {
                        i._animateRewards(),
                        i._service.rewardsPopupClosed()
                    }
                    ), i),
                    i._createBackground(),
                    i._createHeader(),
                    i._createGiftVisual(),
                    i._createInfo(),
                    i._createRewardsVisual(),
                    i._createColllectRewardsButton(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype._createBackground = function() {
                    var e = this
                      , t = this._getBackgroundSize();
                    this._backGround = new Ar({
                        size: t,
                        headerSize: {
                            width: t.width / 1.5,
                            height: Br
                        },
                        headerStyle: vn.popupTitle,
                        showCloseButton: !0
                    }),
                    this._content.addChild(this._backGround),
                    this._backGround.onCloseClick((function() {
                        return e.close()
                    }
                    ))
                }
                ,
                t.prototype._getBackgroundSize = function() {
                    var e = De.services.resource.getSprite(this._options.infoImage).width + 100
                      , t = this._getRewardsVisualHeight() + Br + 440 + 190;
                    return {
                        width: Math.max(e, 1e3),
                        height: Math.max(t, 1e3)
                    }
                }
                ,
                t.prototype._createHeader = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !1
                    });
                    e.style = vn.lightBoldMedium,
                    this._content.addChild(rr(new v.Label(nr(Or || (Or = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), this._options.popupHeader),e), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -this._getBackgroundSize().height / 2 + 37.5 + 10
                        }
                    }))
                }
                ,
                t.prototype._createGiftVisual = function() {
                    this._content.addChild(rr(De.services.resource.getSprite(f.ICON_REWARDEDLINK_GIFT), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -this._getBackgroundSize().height / 2 + Br + 220 - 20
                        }
                    }))
                }
                ,
                t.prototype._createInfo = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: this._getBackgroundSize().width - 100
                    });
                    e.style = vn.darkLarge,
                    this._content.addChild(rr(new v.Label(nr(br || (br = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), this._options.infoText),e), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: -this._getBackgroundSize().height / 2 + Br + 440 - 80
                        }
                    }))
                }
                ,
                t.prototype._getRewardsVisualHeight = function() {
                    return De.services.resource.getSprite(f.ICON_FREEBIE_OFFERS).height + Br
                }
                ,
                t.prototype._createRewardsVisual = function() {
                    var e = new Xe.Container
                      , t = De.services.resource.getSprite(f.ICON_FREEBIE_OFFERS).width
                      , i = this._getRewardsVisualHeight()
                      , r = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 60,
                        fitWidth: this._getBackgroundSize().width - 100
                    });
                    r.style = vn.greyMedium,
                    e.addChild(rr(new v.Label(nr(Rr || (Rr = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.SIGNIN_BONUS_SUCCESSFUL_REWARDS),r), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: 0
                        }
                    })),
                    e.addChild(rr(De.services.resource.getSprite(this._options.infoImage), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: 90
                        }
                    }));
                    var o = new v.LabelSettings({
                        fitHeight: 135,
                        fitWidth: 300,
                        fitToBox: !0
                    });
                    o.style = vn.darkMedium;
                    for (var a = 1; a <= 3; a++) {
                        var s = this._productData.reward[a - 1].amount.toString()
                          , _ = new v.Label(s,o);
                        _.anchor.set(.5);
                        var c = 10 * (2 - a);
                        _.position.set(-t / 3 + (a - 1) * t / 3 - c, i - 35),
                        this._itemPositions.set(this._productData.reward[a - 1].key, _.position),
                        e.addChild(_)
                    }
                    e.position.set(0, -this._getBackgroundSize().height / 2 + Br + 440),
                    this._content.addChild(e)
                }
                ,
                t.prototype._createColllectRewardsButton = function() {
                    var e = this
                      , t = new fr({
                        name: "collect rewards",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: {
                            width: 460,
                            height: 90
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: ce.SIGNIN_BONUS_SUCCESSFUL_BUTTON,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    t.position.set(0, this._getBackgroundSize().height / 2 - 90),
                    t.onClick((function() {
                        return e.close()
                    }
                    )),
                    this._content.addChild(t)
                }
                ,
                t.prototype._animateRewards = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._productData.reward.forEach((function(t) {
                                return (0,
                                n.__awaiter)(e, void 0, void 0, (function() {
                                    var e, i, r, o, a, s, _;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        return e = this._itemPositions.get(t.key),
                                        i = De.services.navigation.layers.popup.container,
                                        r = i.toGlobal(e || new Xe.Point(0,0)),
                                        o = De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter({
                                            amount: t.amount,
                                            key: t.key
                                        }),
                                        a = o.target,
                                        s = o.icon,
                                        _ = a.toGlobal(new Xe.Point(0,0)),
                                        new Lr(De.services.resource.getSprite(s),i.toLocal(r),i.toLocal(_),t.amount,i).animate(),
                                        [2]
                                    }
                                    ))
                                }
                                ))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr);
            !function(e) {
                e.MAIN = "MAIN",
                e.FRIEND = "FRIEND"
            }(wr || (wr = {}));
            var kr, xr = function() {
                function e() {
                    this._version = 1,
                    this._name = "NavigationModel",
                    this._currentSceneIndex = wr.MAIN,
                    this._chosenFriendData = null
                }
                return e.prototype.changeScene = function(e) {
                    this._currentSceneIndex = e
                }
                ,
                Object.defineProperty(e.prototype, "currentSceneIndex", {
                    get: function() {
                        return this._currentSceneIndex
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "chosenFriendData", {
                    get: function() {
                        return this._chosenFriendData
                    },
                    set: function(e) {
                        this._chosenFriendData = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }();
            !function(e) {
                e.NOT_RECEIVED = "not_received",
                e.RECEIVED = "received"
            }(kr || (kr = {}));
            var Gr, Ur, Fr, Mr, Vr, Hr = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._state = kr.NOT_RECEIVED,
                    t._name = "SignInBonusModel",
                    t._version = 1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "receivedBonus", {
                    get: function() {
                        return this._state === kr.RECEIVED
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.claimBonus = function() {
                    var e = this;
                    return new Promise((function(t) {
                        e.onSavableDataChange.listenOnce((function(e) {
                            return t()
                        }
                        ), e),
                        e._state = kr.RECEIVED,
                        e.saveData()
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._state = e.state
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        state: this._state
                    }
                }
                ,
                t
            }($n), jr = (function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onClaimed = new r.Event,
                    t._model = new Hr,
                    t
                }
                (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "bonusAvailable", {
                    get: function() {
                        return !vp.platform.loginStrategy.isUserLoggedIn()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.SPECIAL_OFFER)];
                            case 1:
                                return t.sent(),
                                [4, De.services.autosave.registerModel(this._model)];
                            case 2:
                                return t.sent(),
                                this._currentSignInBonusData = this._getSignInBonusData(),
                                De.services.navigation.onSceneChanged.listenOnce((function(t) {
                                    return (0,
                                    n.__awaiter)(e, void 0, void 0, (function() {
                                        return (0,
                                        n.__generator)(this, (function(e) {
                                            switch (e.label) {
                                            case 0:
                                                return t.index !== wr.MAIN ? [3, 2] : [4, t.scene.onSceneShowPromise];
                                            case 1:
                                                e.sent(),
                                                this.openSignInBonusRewardsPopup(),
                                                e.label = 2;
                                            case 2:
                                                return [2]
                                            }
                                        }
                                        ))
                                    }
                                    ))
                                }
                                ), this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openSignInBonusPopup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.SPECIAL_OFFER)];
                            case 1:
                                return t.sent(),
                                De.services.navigation.showPopup(Dr, {
                                    service: this,
                                    productData: this._currentSignInBonusData
                                }),
                                De.services.analytics.design.reportIncentivePopupOpened("msLogin", e),
                                [2, !0]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openSignInBonusRewardsPopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this.canReceiveBonus() ? [4, De.services.lazyLoad.prioritizeGroup(hn.SPECIAL_OFFER)] : [3, 2];
                            case 1:
                                e.sent(),
                                De.services.navigation.showPopup(Pr, {
                                    service: this,
                                    productData: this._currentSignInBonusData
                                }),
                                e.label = 2;
                            case 2:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.incentivePopupClosed = function() {
                    De.services.analytics.design.reportIncentivePopupClosed("msLogin")
                }
                ,
                t.prototype.rewardsPopupClosed = function() {
                    this.claimBonus()
                }
                ,
                t.prototype.signInButtonClicked = function() {
                    De.services.analytics.design.reportLoginButtonPressed()
                }
                ,
                t.prototype.canReceiveBonus = function() {
                    return !!vp.platform.loginStrategy.isUserLoggedIn() && !this._model.receivedBonus
                }
                ,
                t.prototype.claimBonus = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this.canReceiveBonus() ? [4, this._model.claimBonus()] : [2];
                            case 1:
                                return e.sent(),
                                this.onClaimed.fire(),
                                this._currentSignInBonusData.reward.forEach((function(e) {
                                    return De.services.inventory.addAmount(e.key, e.amount)
                                }
                                )),
                                [4, De.services.autosave.forceSave()];
                            case 2:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getSignInBonusData = function() {
                    return {
                        reward: [{
                            key: Cn.GEMS,
                            amount: 45
                        }, {
                            key: Cn.CRATES,
                            amount: 15
                        }, {
                            key: Cn.ENERGY,
                            amount: 15
                        }]
                    }
                }
            }(Se),
            function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.useSandboxPurchases = !1,
                    i.onUnhandledPurchase = new r.Event,
                    i._logger = Ie.Of("IAPService"),
                    i._isSupported = !0,
                    i._catalog = [],
                    i._isPurchasing = !1,
                    i._iapFeature = t,
                    i
                }
                (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isSupported", {
                    get: function() {
                        return this._isSupported
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "catalog", {
                    get: function() {
                        return this._catalog
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.consumePurchase = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                if (e.status !== s.Nk.COMPLETED)
                                    return [3, 5];
                                i.label = 1;
                            case 1:
                                return i.trys.push([1, 3, , 4]),
                                this._logger.info("Consuming payment: " + e.id),
                                [4, this._iapFeature.consumePayment(e.id)];
                            case 2:
                                return i.sent(),
                                [3, 4];
                            case 3:
                                return t = i.sent(),
                                this._logger.error("Failed to consume payment: " + e.id, t),
                                [2];
                            case 4:
                                return this._logger.info("Payment consumed: " + e.id),
                                [2];
                            case 5:
                                return this._logger.error("Payment not in a consumable state: " + e.id, e),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.purchaseItem = function(e) {
                    var t;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r, o, a, s;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return i = new URLSearchParams(window.location.search),
                                r = null !== (t = i.get("publisherId")) && void 0 !== t ? t : void 0,
                                [4, this._iapFeature.startPayment([e], this.useSandboxPurchases, r)];
                            case 1:
                                o = n.sent(),
                                a = De.services.iframePopup.showPopup(o.url),
                                n.label = 2;
                            case 2:
                                return n.trys.push([2, , 4, 5]),
                                this._isPurchasing = !0,
                                [4, this._waitForConfirmation(o, a)];
                            case 3:
                                return s = n.sent(),
                                [3, 5];
                            case 4:
                                return this._isPurchasing = !1,
                                De.services.iframePopup.hidePopup(),
                                [7];
                            case 5:
                                return [2, s]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getUnconsumedPurchases = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return ze.USE_NAKAMA ? [4, this._iapFeature.getConsumablePayments()] : (this._logger.error("Failed to get purchases: Nakama is not being used"),
                                [2, []]);
                            case 1:
                                return [2, e.sent()]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return n.trys.push([0, 2, , 3]),
                                e = this,
                                [4, this._iapFeature.getPaymentCatalog()];
                            case 1:
                                return e._catalog = n.sent(),
                                [3, 3];
                            case 2:
                                return t = n.sent(),
                                i = t && t.message ? t.message : "Failed to fetch the catalog",
                                this._logger.error(i),
                                this._isSupported = !1,
                                [3, 3];
                            case 3:
                                return this._iapFeature.paymentComplete.addListener(this._handlePaymentStatusChange, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._catalog = [],
                            this._iapFeature.paymentComplete.removeListener(this._handlePaymentStatusChange, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._handlePaymentStatusChange = function(e) {
                    this._isPurchasing || e.status !== s.Nk.COMPLETED || e.isConsumed || this.onUnhandledPurchase.fire(e)
                }
                ,
                t.prototype._waitForConfirmation = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i = this;
                        return (0,
                        n.__generator)(this, (function(o) {
                            switch (o.label) {
                            case 0:
                                return [4, new Promise((function(o, a) {
                                    var _ = !1
                                      , c = function(t) {
                                        t.id !== e.id || _ || (_ = !0,
                                        i._iapFeature.paymentComplete.removeListener(c, i),
                                        o(t))
                                    };
                                    i._iapFeature.paymentComplete.addListener(c, i);
                                    var l = function() {
                                        return (0,
                                        n.__awaiter)(i, void 0, void 0, (function() {
                                            var t, i;
                                            return (0,
                                            n.__generator)(this, (function(n) {
                                                switch (n.label) {
                                                case 0:
                                                    return [4, r.TimeDelay.after(1e4).promise];
                                                case 1:
                                                    return n.sent(),
                                                    [4, this._iapFeature.getPaymentsByIds([e.id])];
                                                case 2:
                                                    return t = n.sent()[0],
                                                    _ || ((i = null == t ? void 0 : t.status) === s.Nk.COMPLETED ? c(t) : i === s.Nk.FAILED ? a({
                                                        code: "PAYMENT_FAILED"
                                                    }) : i === s.Nk.CANCELED ? a({
                                                        code: "PAYMENT_CANCELED"
                                                    }) : l()),
                                                    [2]
                                                }
                                            }
                                            ))
                                        }
                                        ))
                                    };
                                    l(),
                                    t.catch((function(t) {
                                        return (0,
                                        n.__awaiter)(i, void 0, void 0, (function() {
                                            var i;
                                            return (0,
                                            n.__generator)(this, (function(n) {
                                                switch (n.label) {
                                                case 0:
                                                    return [4, this._iapFeature.getPaymentsByIds([e.id])];
                                                case 1:
                                                    return (null == (i = n.sent()[0]) ? void 0 : i.status) === s.Nk.COMPLETED ? c(i) : a(t),
                                                    [2]
                                                }
                                            }
                                            ))
                                        }
                                        ))
                                    }
                                    ))
                                }
                                ))];
                            case 1:
                                return [2, o.sent()]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(Se),
            kn(10)), Kr = (function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._restartInterstitialTimer(),
                    i
                }
                (0,
                n.__extends)(t, e),
                t.prototype.showInterstitialAd = function(t) {
                    var i = this;
                    return e.prototype.showInterstitialAd.call(this, t).then((function(e) {
                        return e.status === Fn.VALID && i._restartInterstitialTimer(),
                        e
                    }
                    ))
                }
                ,
                t.prototype.showRewardedAd = function(t) {
                    var i = this;
                    return e.prototype.showRewardedAd.call(this, t).then((function(e) {
                        return e.status === Fn.VALID && i._restartInterstitialTimer(),
                        e
                    }
                    ))
                }
                ,
                t.prototype._restartInterstitialTimer = function() {
                    var e = this;
                    this._logger.info("Restarting interstitial timer"),
                    this.interstitialEnabled = !1,
                    clearInterval(this._interStitialAdInterval),
                    this._interStitialAdInterval = setInterval((function() {
                        e._logger.info("Interstitial enabled"),
                        clearInterval(e._interStitialAdInterval),
                        e.interstitialEnabled = !0
                    }
                    ), jr)
                }
            }(tr),
            1150), Wr = 1e3, zr = {
                width: 500,
                height: 130
            }, Yr = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.priority = _r.IMMEDIATE,
                    t._name = "ConsentPopup",
                    t._inputBlocker.removeAllListeners(),
                    t._createBackground(),
                    t._createText(),
                    t._createPolicyText(),
                    t._createButton(),
                    t._createNoThankYou(),
                    t.consentAnswerPromise = new Promise((function(e) {
                        return t._consentAnswerResolve = e
                    }
                    )),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBackground = function() {
                    this._background = new cr(De.services.resource.getTexture(f.POPUP_BG_CONSENT_9SLICE),150,150,150,150),
                    this._background.setSizes({
                        width: Kr,
                        height: Wr
                    }),
                    this._background.position.set(-575, -500),
                    this._content.addChild(this._background)
                }
                ,
                t.prototype._createText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 950,
                        fitHeight: 425
                    });
                    e.style = vn.darkMedium,
                    this._mainText = rr(new v.Label(nr(Gr || (Gr = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.CONSENT_TEXT_MAIN),e), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: -320
                        }
                    }),
                    this._content.addChild(this._mainText)
                }
                ,
                t.prototype._createPolicyText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 950,
                        fitHeight: 50
                    });
                    e.style = vn.blueSmall,
                    this._policyText = rr(new v.Label(nr(Ur || (Ur = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.CONSENT_TEXT_ADDITIONAL),e), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: 300
                        }
                    }),
                    this._content.addChild(this._policyText),
                    this._policyText.interactive = !0,
                    this._policyText.on("pointerup", this._openPolicy)
                }
                ,
                t.prototype._createButton = function() {
                    var e = this
                      , t = new fr({
                        name: "ConsentButton",
                        buttonIdle: f.BTN_EVENT_GREEN_IDLE,
                        buttonActive: f.BTN_EVENT_GREEN_DOWN,
                        buttonInactive: f.BTN_EVENT_GREEN_IDLE
                    },{
                        buttonSizes: zr,
                        buttonCorners: {
                            leftWidth: 75,
                            topHeight: 70,
                            rightWidth: 75,
                            bottomHeight: 70
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: nr(Fr || (Fr = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.CONSENT_ACCEPT_BUTTON),
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    t.position.set(0, this._policyText.position.y - this._policyText.height - t.height / 2),
                    this._content.addChild(t),
                    t.onClick((function() {
                        return e.answerConsent(!0)
                    }
                    ))
                }
                ,
                t.prototype._createNoThankYou = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return (e = new v.LabelSettings({
                                fitHeight: 210,
                                fitWidth: 730,
                                fitToBox: !0
                            })).style = vn.getRegularTextWithOutline({
                                color: vn.colorLight,
                                stroke: vn.colorDark
                            }),
                            (t = rr(new v.Label(nr(Mr || (Mr = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.CONSENT_REJECT_BUTTON),e), {
                                anchor: {
                                    x: .5,
                                    y: .5
                                }
                            })).position.set(0, 600),
                            this._content.addChild(t),
                            t.interactive = !0,
                            t.once("pointerup", this.answerConsent.bind(this, !1), this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.answerConsent = function(e) {
                    var t = this;
                    this.close(),
                    this.onClosed.listenOnce((function() {
                        return t._consentAnswerResolve(e)
                    }
                    ), this)
                }
                ,
                t.prototype._openPolicy = function() {
                    window.open("https://www.coolgames.com/privacy-policy/")
                }
                ,
                t
            }(yr), Jr = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "ConsentModel",
                    t._version = 1,
                    t._consentGiven = void 0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "consentGiven", {
                    get: function() {
                        return this._consentGiven
                    },
                    set: function(e) {
                        this._consentGiven = e,
                        this.saveData()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._consentGiven = e.consentGiven
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        consentGiven: this._consentGiven
                    }
                }
                ,
                t
            }($n), Xr = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._model = new Jr,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(t) {
                    e.prototype.initialize.call(this, t),
                    this.services.autosave.registerModel(this._model)
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showConsentPopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.CONSENT)];
                            case 1:
                                return e.sent(),
                                [4, De.services.navigation.showPopup(Yr, {})];
                            case 2:
                                return [4, e.sent().consentAnswerPromise];
                            case 3:
                                return [2, e.sent()]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se), qr = (function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                (0,
                n.__extends)(t, e),
                t.prototype.consentResult = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return (0,
                                r.isUndefined)(this._model.consentGiven) ? vp.platform.loginStrategy.isUserLoggedIn() ? [3, 2] : (e = this._model,
                                [4, this._showConsentPopup()]) : [3, 3];
                            case 1:
                                return e.consentGiven = t.sent(),
                                [3, 3];
                            case 2:
                                this._model.consentGiven = !0,
                                t.label = 3;
                            case 3:
                                return [2, this._model.consentGiven]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(Xr),
            i(5487)), Qr = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.onUnhandledPurchase = new r.Event,
                    i.useSandboxPurchases = !1,
                    i._catalog = [],
                    i._nameToIdMap = new Map,
                    i._idToNameMap = new Map,
                    i._isSupported = !0,
                    i._iapFeature = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isSupported", {
                    get: function() {
                        return !!vp.platform.discordSDK && this._isSupported
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "catalog", {
                    get: function() {
                        return this._catalog
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return e = vp.platform.discordSDK,
                            [2, Promise.all([e.commands.getSkus(), vp.platform.deviceStrategy.getDevice()]).then((function(e) {
                                var i = e[0];
                                "mobile" !== e[1] && (t._catalog = i.skus.map((function(e) {
                                    var i = e.name
                                      , n = e.id
                                      , r = e.price;
                                    t._nameToIdMap.set(i, n),
                                    t._idToNameMap.set(n, i);
                                    var a = r.amount / 100
                                      , s = a || 0;
                                    return {
                                        sku: i,
                                        name: i,
                                        price: {
                                            amount: a,
                                            formattedAmount: r ? o.Eg.formatPrice(r) : (a / 100).toString(),
                                            amountWithoutDiscount: s,
                                            formattedAmountWithoutDiscount: r ? o.Eg.formatPrice(r) : (s / 100).toString(),
                                            currency: (null == r ? void 0 : r.currency) || "USD"
                                        }
                                    }
                                }
                                )))
                            }
                            )).catch((function(e) {
                                var i = e ? JSON.stringify(e) : "Failed to fetch the SKUs from Discord";
                                t._logger.error(i),
                                t._isSupported = !1
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.consumePurchase = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return t = e.id,
                            this._iapFeature.consumeEntitlement(t),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.purchaseItem = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a, s;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return n.trys.push([0, 2, , 3]),
                                t = vp.platform,
                                i = t.discordSDK,
                                r = e.sku,
                                (o = this._nameToIdMap.get(r)) ? [4, i.commands.startPurchase({
                                    sku_id: o
                                })] : (this._logger.error("Item not found sku:", r),
                                [2, Promise.reject(new Error("Item not found"))]);
                            case 1:
                                return (a = n.sent()) ? [2, {
                                    id: a[0].id,
                                    status: qr.PaymentStatus.COMPLETED,
                                    items: [{
                                        sku: r,
                                        amount: 1
                                    }],
                                    isConsumed: !1
                                }] : (this._logger.error("Failed to execute purchase"),
                                [2, Promise.reject(new Error("Failed to execute purchase"))]);
                            case 2:
                                return s = n.sent(),
                                this._logger.error("Failed to purchase item", s),
                                [2, Promise.reject(s)];
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getUnconsumedPurchases = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, vp.platform.discordSDK.commands.getEntitlements()];
                            case 1:
                                return e = i.sent().entitlements,
                                [2, e.filter((function(e) {
                                    return !e.consumed
                                }
                                )).map((function(e) {
                                    var i = e.sku_id
                                      , n = t._idToNameMap.get(i);
                                    return {
                                        id: e.id,
                                        status: qr.PaymentStatus.COMPLETED,
                                        items: [{
                                            sku: n,
                                            amount: 1
                                        }],
                                        isConsumed: !1
                                    }
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onUnhandledPurchase = function(e) {
                    this.onUnhandledPurchase.fire(e)
                }
                ,
                t
            }(Se), Zr = function() {
                function e() {}
                return e.prototype.getServices = function(e, t) {
                    return (0,
                    n.__assign)((0,
                    n.__assign)({}, e), {
                        iap: new Qr(t.discordIap)
                    })
                }
                ,
                e
            }(), $r = ["payments.consumePurchaseAsync", "payments.getCatalogAsync", "payments.getPurchasesAsync", "payments.purchaseAsync"];
            !function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n.onUnhandledPurchase = new r.Event,
                    n._logger = Ie.Of("IAPService"),
                    n._isSupported = !0,
                    n._catalog = [],
                    n._shop = t,
                    n._fbInstant = i,
                    n
                }
                (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "useSandboxPurchases", {
                    get: function() {
                        return !1
                    },
                    set: function(e) {
                        this._logger.warn("useSandboxPurchases is always true on FB")
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isSupported", {
                    get: function() {
                        return this._isSupported
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "catalog", {
                    get: function() {
                        return this._catalog
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.consumePurchase = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return n.trys.push([0, 2, , 3]),
                                [4, this._shop.handlePaymentV1(JSON.stringify(e))];
                            case 1:
                                return n.sent(),
                                [3, 3];
                            case 2:
                                return (t = n.sent())instanceof s.ZR ? "INVALID_STATE" !== t.type ? (this._logger.error("Error in _shop.handlePaymentV1: " + JSON.stringify(t)),
                                [2]) : (this._logger.warn("The purchase has already been consumed on Nakama: " + e.id),
                                [3, 3]) : (this._logger.error("Error in _shop.handlePaymentV1: " + JSON.stringify(t)),
                                [2]);
                            case 3:
                                return n.trys.push([3, 5, , 6]),
                                [4, this._fbInstant.payments.consumePurchaseAsync(e.id)];
                            case 4:
                                return n.sent(),
                                [3, 6];
                            case 5:
                                return i = n.sent(),
                                this._logger.error("Error in _fbInstant.payments.consumePurchaseAsync: " + JSON.stringify(i)),
                                [2];
                            case 6:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.purchaseItem = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = {
                                    productID: e.sku
                                },
                                [4, this._fbInstant.payments.purchaseAsync(t)];
                            case 1:
                                return [2, {
                                    id: (i = n.sent()).purchaseToken,
                                    isConsumed: !1,
                                    items: [{
                                        sku: i.productID,
                                        amount: 1
                                    }],
                                    status: s.Nk.COMPLETED,
                                    paymentID: i.paymentID,
                                    productID: i.productID,
                                    signedRequest: i.signedRequest
                                }]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getUnconsumedPurchases = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._fbInstant.payments.getPurchasesAsync().catch((function() {
                                    return []
                                }
                                ))];
                            case 1:
                                return [2, e.sent().map((function(e) {
                                    return {
                                        id: e.purchaseToken,
                                        isConsumed: !1,
                                        items: [{
                                            sku: e.productID,
                                            amount: 1
                                        }],
                                        status: s.Nk.COMPLETED,
                                        paymentID: e.paymentID,
                                        productID: e.productID,
                                        signedRequest: e.signedRequest
                                    }
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.start = function() {
                    var e = this;
                    return Promise.all([this._fbInstant.getSupportedAPIs(), this._fbInstant.payments.getCatalogAsync()]).then((function(t) {
                        var i = t[0]
                          , n = t[1];
                        e._catalog = n.map((function(e) {
                            return {
                                sku: e.productID,
                                name: e.title,
                                price: {
                                    amount: e.priceAmount,
                                    amountWithoutDiscount: e.priceAmount,
                                    currency: e.priceCurrencyCode,
                                    formattedAmount: e.price,
                                    formattedAmountWithoutDiscount: e.price
                                }
                            }
                        }
                        ));
                        var r = i.reduce((function(e, t) {
                            return e[t] = !0,
                            e
                        }
                        ), {});
                        e._isSupported = n.length > 1 && $r.every((function(e) {
                            return r[e]
                        }
                        ))
                    }
                    )).catch((function(t) {
                        var i = t && t.message ? t.message : "Failed to fetch the catalog and supported APIs";
                        e._logger.error(i),
                        e._isSupported = !1
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._catalog = [],
                            [2]
                        }
                        ))
                    }
                    ))
                }
            }(Se);
            !function(e) {
                e.TOURNAMENT_STARTED = "TOURNAMENT_STARTED",
                e.TOURNAMENT_UPDATED = "TOURNAMENT_UPDATED",
                e.TOURNAMENT_ENDED = "TOURNAMENT_ENDED",
                e.ORDER_COMPLETE = "ORDER_COMPLETE",
                e.CRATES_REFILLED = "CRATES_REFILLED",
                e.RESOURCE_READY_FOR_HARVEST = "RESOURCE_READY_FOR_HARVEST",
                e.ENERGY_REFILLED = "ENERGY_REFILLED"
            }(Vr || (Vr = {}));
            !function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._observedGenerators = new Set,
                    t
                }
                (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.assetLoader.loadJsons(_e.REGENERATION_GAMEBOT_MESSENGER)];
                            case 1:
                                return e.sent(),
                                this._config = this.services.resource.getJson(_e.REGENERATION_GAMEBOT_MESSENGER),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return this._observedGenerators.forEach(this.removeRegenerationObservable, this),
                    this._observedGenerators = new Set,
                    Promise.resolve()
                }
                ,
                t.prototype.addRegenerationObservables = function(e) {
                    var t = this;
                    Array.isArray(e) || (e = [e]),
                    e.forEach((function(e) {
                        t._observedGenerators.add(e),
                        e.onTimerStarted.addListener(t._sendRegenerationMessage, t),
                        e.onTimerCancelled.addListener(t._cancelRegenerationMessage, t)
                    }
                    ))
                }
                ,
                t.prototype.removeRegenerationObservable = function(e) {
                    this._observedGenerators.delete(e),
                    e.onTimerStarted.removeListener(this._sendRegenerationMessage, this),
                    e.onTimerCancelled.removeListener(this._cancelRegenerationMessage, this)
                }
                ,
                t.prototype._sendRegenerationMessage = function(e) {
                    var t = e.generator.key
                      , i = this._getConfigFor(t);
                    if (i) {
                        var r = i.GAMEBOT_MESSAGE_TYPE
                          , o = i.GAMEBOT_MESSAGE_TEXT
                          , a = i.GAMEBOT_CTA_TEXT
                          , s = i.GAMEBOT_IMAGE_URL
                          , _ = Vr[r]
                          , c = nr(eo || (eo = (0,
                        n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce[o], De.services.friends.fetchOwnProfile().name)
                          , l = nr(to || (to = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce[a])
                          , u = this.services.notifications.buildImageUrl(s);
                        _ && c && l && u ? this.services.notifications.createMessageForObserver(_, e.generator.spawnInterval, u, c, l, t) : this._logger.error("Gamebot message cannot be sent due to the wrong parameters!")
                    } else
                        this._logger.error("Gamebot message cannot be sent for ".concat(t))
                }
                ,
                t.prototype._cancelRegenerationMessage = function(e) {
                    var t = this._getConfigFor(e.generator.key);
                    if (t) {
                        var i = Vr[t.GAMEBOT_MESSAGE_TYPE];
                        this.services.notifications.cancelMessage(i, e.generator.key)
                    }
                }
                ,
                t.prototype._getConfigFor = function(e) {
                    return this._config.REGENERATION_MESSAGES.find((function(t) {
                        return t.GENERATOR_KEY === e
                    }
                    ))
                }
            }(Se);
            var eo, to, io, no, ro, oo, ao, so, _o, co, lo, uo, ho, po, vo = function() {
                function e() {}
                return e.extractMatchedToDifferenceFromArray = function(e, t) {
                    if (t.reduce((function(e, t) {
                        return e + t
                    }
                    ), 0) <= e)
                        return t.slice();
                    for (var i = t.findIndex((function(t) {
                        return t > e
                    }
                    )), n = -1 === i ? t.slice() : t.slice(0, i), r = this.extractFromTail(e, n), o = Number.MAX_SAFE_INTEGER, a = [], s = r.length; s >= 0; s--) {
                        var _ = r.slice(r.length - s)
                          , c = _.reduce((function(e, t) {
                            return e + t
                        }
                        ), 0)
                          , l = this.extractMatchedToDifferenceFromArray(e - c, n.slice(0, -r.length))
                          , u = l.reduce((function(e, t) {
                            return e + t
                        }
                        ), 0)
                          , d = e - (c + u);
                        if (d < o) {
                            if (0 === d)
                                return _.concat(l);
                            o = d,
                            a = _.concat(l)
                        }
                    }
                    return a
                }
                ,
                e.extractFromTail = function(e, t) {
                    if (!t.length)
                        return [];
                    var i = t[t.length - 1]
                      , n = e - i;
                    return 0 === n ? t.slice(-1) : n < 0 ? [] : this.extractFromTail(n, t.slice(0, -1)).concat(i)
                }
                ,
                e.removeFromArray = function(e, t) {
                    var i = t.indexOf(e);
                    return i >= 0 && t.splice(i, 1),
                    t
                }
                ,
                e.first = function(e) {
                    return e[0]
                }
                ,
                e.last = function(e) {
                    return e[e.length - 1]
                }
                ,
                e
            }(), go = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._version = 1,
                    t._name = "GamebotModel",
                    t._messages = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "allMessages", {
                    get: function() {
                        return this._messages
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.addMessage = function(e) {
                    return this._messages.push(e),
                    this.saveData(),
                    e
                }
                ,
                t.prototype.deleteMessage = function(e, t) {
                    var i = this.getMessage(e, t);
                    i && vo.removeFromArray(i, this._messages),
                    this.saveData()
                }
                ,
                t.prototype.getMessage = function(e, t) {
                    return this._messages.find((function(i) {
                        return i.type === e && i.key === t
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        return t.addMessage(e)
                    }
                    ))
                }
                ,
                t.prototype.onDataSave = function() {
                    return this.allMessages
                }
                ,
                t
            }($n), fo = ((io = {})[Vr.TOURNAMENT_STARTED] = 7,
            io[Vr.TOURNAMENT_UPDATED] = 6,
            io[Vr.TOURNAMENT_ENDED] = 5,
            io[Vr.ORDER_COMPLETE] = 4,
            io[Vr.CRATES_REFILLED] = 3,
            io[Vr.RESOURCE_READY_FOR_HARVEST] = 2,
            io[Vr.ENERGY_REFILLED] = 1,
            io), Eo = (function(e) {
                function t(t, i) {
                    var n, r = e.call(this) || this;
                    return r._logger = Ie.Of("GamebotService", ((n = {})[Ae.INFO] = ["color:#784c01"],
                    n[Ae.WARNING] = ["color:#d98900"],
                    n)),
                    r._model = new go,
                    r._gamebot = t,
                    r._messagingService = i,
                    r
                }
                (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                this.services.connection.onConnect.addListener(this._resendMessages, this),
                                this._updateMessagesOnRestore(),
                                [4, this._subscribeToGamebot()];
                            case 2:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.autosave.unregisterModel(this._model),
                            this.services.connection.onConnect.removeListener(this._resendMessages, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.createMessageForOrder = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o;
                        return (0,
                        n.__generator)(this, (function(a) {
                            return o = nr(no || (no = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), {
                                alias: i.ID
                            }),
                            [2, this.addMessage(Vr.ORDER_COMPLETE, r, {
                                title: "Farm Merge Valley",
                                subtitle: nr(ro || (ro = (0,
                                n.__makeTemplateObject)(["", "", "", ""], ["", "", "", ""])), ce.GAMEBOT_ORDER_MESSAGE, o, De.services.friends.fetchOwnProfile().name),
                                imageUrl: this.buildImageUrl("orders", i.ID),
                                buttons: [{
                                    text: nr(oo || (oo = (0,
                                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GAMEBOT_ORDER_CTA),
                                    type: s.ZK.GAMEPLAY,
                                    payload: {
                                        buildingID: e
                                    }
                                }]
                            }, t.recipe)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.createMessageForResourceHarvest = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r;
                        return (0,
                        n.__generator)(this, (function(o) {
                            return r = nr(ao || (ao = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), {
                                alias: e
                            }),
                            [2, this.addMessage(Vr.RESOURCE_READY_FOR_HARVEST, t, {
                                title: "Farm Merge Valley",
                                imageUrl: this.buildImageUrl("resources", e),
                                subtitle: nr(so || (so = (0,
                                n.__makeTemplateObject)(["", "", "", ""], ["", "", "", ""])), ce.GAMEBOT_READY_FOR_HARVEST_MESSAGE, r, De.services.friends.fetchOwnProfile().name),
                                buttons: [{
                                    text: nr(_o || (_o = (0,
                                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GAMEBOT_READY_FOR_HARVEST_CTA),
                                    type: s.ZK.GAMEPLAY,
                                    payload: {}
                                }]
                            }, i)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.createMessageForObserver = function(e, t, i, n, r, o) {
                    return this.addMessage(e, t, {
                        title: "Farm Merge Valley",
                        imageUrl: i,
                        subtitle: n,
                        buttons: [{
                            text: r,
                            type: s.ZK.GAMEPLAY,
                            payload: {}
                        }]
                    }, o)
                }
                ,
                t.prototype.addMessage = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o, a;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return o = this.services.timer.currentTime + t,
                            a = this._model.addMessage({
                                messageID: "",
                                type: e,
                                payload: i,
                                timestamp: o,
                                key: r,
                                wasSent: !1
                            }),
                            [2, this._sendMessage(a)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.cancelMessage = function(e, t) {
                    var i = this._model.getMessage(e, t);
                    i ? (this._isMessageExpired(i.timestamp) || this._gamebot.deleteMessage(i.messageID),
                    this._model.deleteMessage(e, t),
                    this._logger.info('Successfully removed message with type "'.concat(e, '" and key "').concat(t, '"'))) : this._logger.warn("Cannot cancel message with type ".concat(e, " because it does not exist"))
                }
                ,
                t.prototype.buildImageUrl = function(e) {
                    for (var t = [], i = 1; i < arguments.length; i++)
                        t[i - 1] = arguments[i];
                    t = [e].concat(t);
                    var n = "".concat("https://cdn.games.mobinozer.com/ext/farmmerge/gamebot", "/").concat(t.join("/"));
                    return n.endsWith(".png") || (n += ".png"),
                    n
                }
                ,
                t.prototype._sendMessage = function(e) {
                    var t = this;
                    return new Promise((function(i) {
                        t._gamebot.addMessageV2(e.type, fo[e.type], e.timestamp, e.payload).then((function(n) {
                            e.messageID = n,
                            e.wasSent = !0,
                            t._logger.info("Successfully added new message ".concat(n, ' with type "').concat(e.type, '".')),
                            i(!0)
                        }
                        ), (function(n) {
                            t.services.connection.isConnected ? t._logger.warn('Message with type "'.concat(e.type, '" was not received by the server. Reason: '), n) : t._logger.warn('Message with type "'.concat(e.type, "\" was not received by the server because it's down. The message will be sent once the server is up again.")),
                            i(!1)
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateMessagesOnRestore = function() {
                    var e = this;
                    this._model.allMessages.filter((function(t) {
                        return e._isMessageExpired(t.timestamp)
                    }
                    )).forEach((function(t) {
                        return e._model.deleteMessage(t.type, t.key)
                    }
                    )),
                    this._model.allMessages.filter((function(t) {
                        return !e._isMessageExpired(t.timestamp)
                    }
                    )).forEach((function(t) {
                        return e._gamebot.addMessageV2(t.type, fo[t.type], t.timestamp, t.payload)
                    }
                    ))
                }
                ,
                t.prototype._isMessageExpired = function(e) {
                    return this.services.timer.currentTime > e
                }
                ,
                t.prototype._resendMessages = function() {
                    var e = this;
                    this._model.allMessages.filter((function(e) {
                        return !e.wasSent
                    }
                    )).filter((function(t) {
                        return !e._isMessageExpired(t.timestamp)
                    }
                    )).forEach((function(t) {
                        return e._sendMessage(t)
                    }
                    ))
                }
                ,
                t.prototype._subscribeToGamebot = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return USE_FACEBOOK ? (e = !1,
                                [4, this._messagingService.canSubscribeToGamebot().then((function(t) {
                                    return e = t
                                }
                                )).catch((function(e) {
                                    switch (t._logger.info("Error calling canSubscribeToGamebot()", e),
                                    e.code) {
                                    case "RATE_LIMITED":
                                    case "CLIENT_UNSUPPORTED_OPERATION":
                                        break;
                                    default:
                                        Zn.error(new Error(JSON.stringify(e)))
                                    }
                                }
                                ))]) : [2];
                            case 1:
                                return i.sent(),
                                e ? (this.services.analytics.design.gameBotStatus("prompted"),
                                [4, this._messagingService.subscribeToGameBot().then((function() {
                                    t.services.analytics.design.gameBotStatus("enabled"),
                                    t._logger.info("Subscribed to gamebot")
                                }
                                )).catch((function(e) {
                                    t._logger.warn("Not subscribed to gamebot", e),
                                    "USER_INPUT" === e.code || Zn.error(new Error(JSON.stringify(e)))
                                }
                                ))]) : [2];
                            case 2:
                                return i.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(Se),
            function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.eventStarted = new r.Event,
                    i.checkedForActiveEvents = !1,
                    i._logger = Ie.Of("MockTimedEventFetcherService"),
                    i._activeTimedEvents = [],
                    i._futureTimedEvents = [],
                    i._futureTimedEventListeners = [],
                    i._backendSDK = t,
                    i._initializationPromise = new Promise((function(e) {
                        return i._initializationResolve = e
                    }
                    )),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._getOrFetchConfigFile()];
                            case 1:
                                return e.sent(),
                                (0,
                                r.isUndefined)(this._timedEventData) ? (this._initializationResolve(),
                                [2]) : (this._activeTimedEvents = this._getActiveTimedEvents(),
                                this._futureTimedEvents = this._getFutureTimedEvents(),
                                this._setFutureTimedEventListeners(),
                                this._initializationResolve(),
                                [2])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._futureTimedEventListeners.forEach((function(e) {
                                return clearTimeout(e)
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.fetchActiveTimedEvents = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._initializationPromise];
                            case 1:
                                return e.sent(),
                                this.checkedForActiveEvents = !0,
                                [2, this._activeTimedEvents]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getOrFetchConfigFile = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return ze.USE_NAKAMA ? [4, this._backendSDK.configuration.getOrFetchConfigFile("timed_events")] : [2];
                            case 1:
                                return e = t.sent(),
                                (0,
                                r.isUndefined)(e) ? (this._logger.error("Failed to fetch timed events config file"),
                                [2]) : (this._timedEventData = e.events,
                                [2])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getActiveTimedEvents = function() {
                    return this._timedEventData.filter((function(e) {
                        return e.startTime <= Date.now() && e.endTime >= Date.now()
                    }
                    ))
                }
                ,
                t.prototype._getFutureTimedEvents = function() {
                    return this._timedEventData.filter((function(e) {
                        return e.startTime > Date.now()
                    }
                    ))
                }
                ,
                t.prototype._setFutureTimedEventListeners = function() {
                    var e = this;
                    this._futureTimedEvents.forEach((function(t) {
                        return e._setTimedEventListener(t)
                    }
                    ))
                }
                ,
                t.prototype._setTimedEventListener = function(e) {
                    var t = this;
                    this._futureTimedEventListeners.push(setTimeout((function() {
                        t._activeTimedEvents.push(e),
                        t.eventStarted.fire(e),
                        t._futureTimedEvents = t._futureTimedEvents.filter((function(t) {
                            return t !== e
                        }
                        ))
                    }
                    ), e.startTime - Date.now()))
                }
                ,
                t
            }(Se)), mo = function() {
                function e() {}
                return e.prototype.getServices = function(e, t) {
                    return (0,
                    n.__assign)((0,
                    n.__assign)({}, e), {
                        timedEventFetcherService: new Eo(t)
                    })
                }
                ,
                e.prototype.preServiceInitialization = function() {}
                ,
                e
            }(), yo = kn(10), To = (function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._restartInterstitialTimer(),
                    i
                }
                (0,
                n.__extends)(t, e),
                t.prototype.showInterstitialAd = function(t) {
                    var i = this;
                    return e.prototype.showInterstitialAd.call(this, t).then((function(e) {
                        return e.status === Fn.VALID && i._restartInterstitialTimer(),
                        e
                    }
                    ))
                }
                ,
                t.prototype.showRewardedAd = function(t) {
                    var i = this;
                    return e.prototype.showRewardedAd.call(this, t).then((function(e) {
                        return Un() && De.services.analytics.tests.group === xn.TestGroupC ? (i._logger.warn("Don't reset the timer for test group C"),
                        e) : (e.status === Fn.VALID && i._restartInterstitialTimer(),
                        e)
                    }
                    ))
                }
                ,
                t.prototype._restartInterstitialTimer = function() {
                    var e = this;
                    this._logger.info("Restarting interstitial timer"),
                    this.interstitialEnabled = !1,
                    clearInterval(this._interStitialAdInterval),
                    this._interStitialAdInterval = setInterval((function() {
                        e._logger.info("Interstitial enabled"),
                        clearInterval(e._interStitialAdInterval),
                        e.interstitialEnabled = !0
                    }
                    ), yo)
                }
            }(tr),
            function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._observedGenerators = new Set,
                    t
                }
                (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.assetLoader.loadJsons(_e.REGENERATION_GAMEBOT_MESSENGER)];
                            case 1:
                                return e.sent(),
                                this._config = this.services.resource.getJson(_e.REGENERATION_GAMEBOT_MESSENGER),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return this._observedGenerators = new Set,
                    Promise.resolve()
                }
                ,
                t.prototype.addRegenerationObservables = function(e) {
                    var t = this;
                    Array.isArray(e) || (e = [e]),
                    e.forEach((function(e) {
                        t._observedGenerators.add(e),
                        e.onTimerStarted.addListener(t._sendRegenerationMessage, t)
                    }
                    ))
                }
                ,
                t.prototype.removeRegenerationObservable = function(e) {
                    this._observedGenerators.delete(e),
                    e.onTimerStarted.removeListener(this._sendRegenerationMessage, this)
                }
                ,
                t.prototype._sendRegenerationMessage = function(e) {
                    var t = e.generator.key
                      , i = this._getConfigFor(t);
                    if (i) {
                        var n = i.GAMEBOT_MESSAGE_TYPE
                          , r = (i.GAMEBOT_IMAGE_URL,
                        Vr[n])
                          , o = this._getMessageStrings(r)
                          , a = o.message
                          , s = o.cta
                          , _ = this.services.notifications.buildImageUrl();
                        r && a && s ? this.services.notifications.createMessageForObserver(r, e.generator.spawnInterval, _, a, s, t) : this._logger.error("Gamebot message cannot be sent due to the wrong parameters!")
                    } else
                        this._logger.error("Gamebot message cannot be sent for ".concat(t))
                }
                ,
                t.prototype._getConfigFor = function(e) {
                    return this._config.REGENERATION_MESSAGES.find((function(t) {
                        return t.GENERATOR_KEY === e
                    }
                    ))
                }
                ,
                t.prototype._getMessageStrings = function(e) {
                    switch (e) {
                    case Vr.ENERGY_REFILLED:
                        return {
                            message: nr(co || (co = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_ENERGY_REFILL_DESCRIPTION),
                            cta: nr(lo || (lo = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_CRATES_ENERGY_REFILL_CTA)
                        };
                    case Vr.CRATES_REFILLED:
                        return {
                            message: nr(uo || (uo = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_CRATES_REFILL_DESCRIPTION),
                            cta: nr(ho || (ho = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_CRATES_ENERGY_REFILL_CTA)
                        };
                    default:
                        return {
                            message: "",
                            cta: ""
                        }
                    }
                }
            }(Se),
            function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "MSStartNotificationModel",
                    t._version = 1,
                    t._currentScheduledMessages = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "currentScheduledMessages", {
                    get: function() {
                        return this._currentScheduledMessages
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.updateScheduledMessage = function(e, t) {
                    this._currentScheduledMessages.set(e, t),
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    for (var t in e.currentScheduledMessages)
                        this._currentScheduledMessages.set(t, e.currentScheduledMessages[t])
                }
                ,
                t.prototype.onDataSave = function() {
                    var e = {};
                    return this._currentScheduledMessages.forEach((function(t, i) {
                        e[i] = t
                    }
                    )),
                    {
                        currentScheduledMessages: e
                    }
                }
                ,
                t
            }($n));
            !function(e) {
                e[e.INVALID_SCHEDULE_NOTIFICATION_PARAMETERS = 0] = "INVALID_SCHEDULE_NOTIFICATION_PARAMETERS",
                e[e.NO_ACTIVE_GAME = 1] = "NO_ACTIVE_GAME",
                e[e.SCHEDULE_NOTIFICATION_REQUEST_FAILED = 2] = "SCHEDULE_NOTIFICATION_REQUEST_FAILED"
            }(po || (po = {}));
            var Ao, Co, Io, So, Oo, bo, Ro, wo, Do, No, Lo, Bo = [Vr.ORDER_COMPLETE, Vr.RESOURCE_READY_FOR_HARVEST, Vr.CRATES_REFILLED, Vr.ENERGY_REFILLED];
            !function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._model = new To,
                    t._msstart = vp.platform.msstart,
                    t
                }
                (0,
                n.__extends)(t, e),
                t.prototype.createMessageForOrder = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(o) {
                            return e = nr(Ao || (Ao = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), {
                                alias: i.ID
                            }),
                            [2, this.addMessage(Vr.ORDER_COMPLETE, r, {
                                title: nr(Co || (Co = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_ORDER_TITLE),
                                description: nr(Io || (Io = (0,
                                n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.NOTIFICATIONS_ORDER_DESCRIPTION, e),
                                imageData: this.buildImageUrl(),
                                payload: Vr.ORDER_COMPLETE,
                                callToAction: nr(So || (So = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_ORDER_CTA)
                            }, t.recipe)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.createMessageForResourceHarvest = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r;
                        return (0,
                        n.__generator)(this, (function(o) {
                            return r = nr(Oo || (Oo = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), {
                                alias: e
                            }),
                            [2, this.addMessage(Vr.RESOURCE_READY_FOR_HARVEST, t, {
                                title: nr(bo || (bo = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_READY_FOR_HARVEST_TITLE),
                                description: nr(Ro || (Ro = (0,
                                n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.NOTIFICATIONS_READY_FOR_HARVEST_DESCRIPTION, r),
                                imageData: this.buildImageUrl(),
                                payload: Vr.RESOURCE_READY_FOR_HARVEST,
                                callToAction: nr(wo || (wo = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_READY_FOR_HARVEST_CTA)
                            }, i)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.createMessageForObserver = function(e, t, i, r, o, a) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            return [2, this.addMessage(e, t, {
                                title: this._getTitle(e),
                                description: r,
                                imageData: i,
                                payload: e,
                                callToAction: o
                            }, a)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.addMessage = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r, o, a;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return n.trys.push([0, 2, , 3]),
                                r = {
                                    title: i.title,
                                    description: i.description,
                                    type: Object.keys(Vr).indexOf(e),
                                    imageData: i.imageData,
                                    payload: i.payload,
                                    minDelayInSeconds: t,
                                    callToAction: i.callToAction
                                },
                                this._model.updateScheduledMessage(e, r),
                                [4, this._rescheduleMessages()];
                            case 1:
                                return n.sent(),
                                [2, !0];
                            case 2:
                                switch (o = n.sent(),
                                (a = o).code) {
                                case 0:
                                    this._logger.error("Invalid schedule notification parameters", a);
                                    break;
                                case 1:
                                    this._logger.error("No active game", a);
                                    break;
                                case 2:
                                    this._logger.error("Schedule notification request failed", a);
                                    break;
                                default:
                                    this._logger.error("Unknown error", a)
                                }
                                return [2, !1];
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.cancelMessage = function(e, t) {}
                ,
                t.prototype.buildImageUrl = function(e) {
                    for (var t = [], i = 1; i < arguments.length; i++)
                        t[i - 1] = arguments[i];
                    return "https://cdn.games.mobinozer.com/ext/farmmerge/gamebot/ms_notification_general.png"
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getTitle = function(e) {
                    switch (e) {
                    case Vr.ENERGY_REFILLED:
                        return nr(Do || (Do = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_ENERGY_REFILL_TITLE);
                    case Vr.CRATES_REFILLED:
                        return nr(No || (No = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOTIFICATIONS_CRATES_REFILL_TITLE);
                    default:
                        return ""
                    }
                }
                ,
                t.prototype._rescheduleMessages = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o, a, s, _;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                e = !1,
                                t = new Date,
                                i = new Date(t),
                                e ? i.setMinutes(i.getMinutes() + 5) : (i.setDate(i.getDate() + 1),
                                i.setHours(12, 0, 0, 0)),
                                r = 0,
                                o = Bo,
                                n.label = 1;
                            case 1:
                                return r < o.length ? (a = o[r],
                                (s = this._model.currentScheduledMessages.get(a)) ? (_ = Math.floor((i.getTime() - t.getTime()) / 1e3),
                                s.minDelayInSeconds = _,
                                this._model.updateScheduledMessage(a, s),
                                [4, this._msstart.scheduleNotificationAsync(s)]) : [3, 3]) : [3, 4];
                            case 2:
                                n.sent(),
                                e ? i.setMinutes(i.getMinutes() + 5) : (i.setDate(i.getDate() + 1),
                                i.setHours(12, 0, 0, 0)),
                                n.label = 3;
                            case 3:
                                return r++,
                                [3, 1];
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(Se);
            !function(e) {
                e.Dummy = "dummy",
                e.Dummy1 = "Dummy1",
                e.Dummy2 = "Dummy2",
                e.INTRO_TRACK = "INTRO_TRACK",
                e.MERGE_TRACK_1 = "MERGE_TRACK_1",
                e.MERGE_TRACK_2 = "MERGE_TRACK_2",
                e.MERGE_TRACK_3 = "MERGE_TRACK_3",
                e.MERGE_TRACK_4 = "MERGE_TRACK_4",
                e.AWAIT_LEVELUP_2 = "AWAIT_LEVELUP_2",
                e.AWAIT_LEVELUP_3 = "AWAIT_LEVELUP_3",
                e.HARVEST_TRACK_1 = "HARVEST_TRACK_1",
                e.HARVEST_TRACK_2 = "HARVEST_TRACK_2",
                e.HARVEST_TRACK_3 = "HARVEST_TRACK_3",
                e.HARVEST_TRACK_4 = "HARVEST_TRACK_4",
                e.HARVEST_TRACK_5 = "HARVEST_TRACK_5",
                e.HARVEST_TRACK_6 = "HARVEST_TRACK_6",
                e.HARVEST_TRACK_7 = "HARVEST_TRACK_7",
                e.ORDER_TRACK_1 = "ORDER_TRACK_1",
                e.ORDER_TRACK_2 = "ORDER_TRACK_2",
                e.ORDER_TRACK_3 = "ORDER_TRACK_3",
                e.ORDER_TRACK_4 = "ORDER_TRACK_4",
                e.ORDER_TRACK_5 = "ORDER_TRACK_5",
                e.EXPAND_LAND_TRACK = "EXPAND_LAND_TRACK",
                e.SUPPLY_TRACK = "SUPPLY_TRACK",
                e.MERGE_BONUS_TRACK_1 = "MERGE_BONUS_TRACK_1",
                e.MERGE_BONUS_TRACK_2 = "MERGE_BONUS_TRACK_2",
                e.REGAIN_CONTROL_TRACK = "REGAIN_CONTROL_TRACK",
                e.REPAIR_BUILDING_TRACK_1 = "REPAIR_BUILDING_TRACK_1",
                e.REPAIR_BUILDING_TRACK_2 = "REPAIR_BUILDING_TRACK_2",
                e.REPAIR_BUILDING_TRACK_3 = "REPAIR_BUILDING_TRACK_3",
                e.TRAIN_STATION_TRACK_1 = "TRAIN_STATION_TRACK_1",
                e.TRAIN_STATION_TRACK_2 = "TRAIN_STATION_TRACK_2",
                e.FRIEND_ACTIVITIES_TRACK = "FRIEND_ACTIVITIES_TRACK",
                e.FRIEND_ACTIVITIES_TRACK_2 = "FRIEND_ACTIVITIES_TRACK_2",
                e.FRIEND_ACTIVITIES_TRACK_3 = "FRIEND_ACTIVITIES_TRACK_3",
                e.FRIEND_ACTIVITIES_TRACK_4 = "FRIEND_ACTIVITIES_TRACK_4",
                e.FRIEND_ACTIVITIES_TRACK_5 = "FRIEND_ACTIVITIES_TRACK_5",
                e.FRIEND_ACTIVITIES_FINAL = "FRIEND_ACTIVITIES_FINAL",
                e.HEAVY_OBJECT_TRACK = "HEAVY_OBJECT_TRACK",
                e.REGENERATION_EXPLANATION = "REGENERATION_EXPLANATION",
                e.DECORATIVE_OBJECT_INTRODUCTION = "DECORATIVE_OBJECT_INTRODUCTION",
                e.REWARD_CRATE_INTRODUCTION = "REWARD_CRATE_INTRODUCTION",
                e.GREENHOUSE_MERGE_CHAIN_INTRODUCTION = "GREENHOUSE_MERGE_CHAIN_INTRODUCTION",
                e.FLOWERS_INTRODUCTION = "FLOWERS_INTRODUCTION",
                e.UPGRADE_CARD_INTRODUCTION = "UPGRADE_CARD_INTRODUCTION"
            }(Lo || (Lo = {}));
            var Po, ko, xo = [Lo.INTRO_TRACK, Lo.MERGE_TRACK_1, Lo.MERGE_TRACK_2, Lo.MERGE_TRACK_3, Lo.MERGE_TRACK_4, Lo.AWAIT_LEVELUP_2, Lo.HARVEST_TRACK_1, Lo.HARVEST_TRACK_2, Lo.HARVEST_TRACK_3, Lo.HARVEST_TRACK_4, Lo.HARVEST_TRACK_5, Lo.HARVEST_TRACK_6, Lo.HARVEST_TRACK_7, Lo.ORDER_TRACK_1, Lo.ORDER_TRACK_2, Lo.ORDER_TRACK_3, Lo.ORDER_TRACK_4, Lo.ORDER_TRACK_5, Lo.EXPAND_LAND_TRACK, Lo.SUPPLY_TRACK, Lo.MERGE_BONUS_TRACK_1, Lo.MERGE_BONUS_TRACK_2, Lo.AWAIT_LEVELUP_3, Lo.REGAIN_CONTROL_TRACK], Go = function() {
                function e() {
                    this._logger = r.Logger.Of("BaseService"),
                    this._isActive = !1
                }
                return e.prototype.initialize = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._services = e,
                                [4, this.onInitialize()];
                            case 1:
                                return t.sent(),
                                this._isActive = !0,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.onDestroy()];
                            case 1:
                                return e.sent(),
                                this._isActive = !1,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.start = function() {
                    this.onStart()
                }
                ,
                Object.defineProperty(e.prototype, "isActive", {
                    get: function() {
                        return this._isActive
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "services", {
                    get: function() {
                        return this._services
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e
            }();
            !function(e) {
                e[e.IDLE = 0] = "IDLE",
                e[e.GESTURE_DETECTION = 1] = "GESTURE_DETECTION",
                e[e.GESTURE_LOCK = 2] = "GESTURE_LOCK",
                e[e.GESTURE_RELEASE = 3] = "GESTURE_RELEASE"
            }(Po || (Po = {})),
            function(e) {
                e[e.NONE = 0] = "NONE",
                e[e.TAP = 1] = "TAP",
                e[e.TAPPING = 2] = "TAPPING",
                e[e.SCROLL = 3] = "SCROLL",
                e[e.PINCH_ZOOM = 4] = "PINCH_ZOOM",
                e[e.PAN = 5] = "PAN",
                e[e.FLICK = 6] = "FLICK",
                e[e.OBJECT_PICK = 7] = "OBJECT_PICK",
                e[e.OBJECT_DRAG = 8] = "OBJECT_DRAG",
                e[e.OBJECT_DROP = 9] = "OBJECT_DROP"
            }(ko || (ko = {}));
            var Uo, Fo = {
                TOLERANCE_OBJECT_TAP_TIME: 200,
                TAP_DISTANCE_TRESHOLD: 20,
                SLOW_DRAG_THRESHOLD: .52,
                BUILDING_LONGPRESS_TIME: 1e3
            }, Mo = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onInteractionStart = new r.Event,
                    t.onScroll = new r.Event,
                    t.onPinchStart = new r.Event,
                    t.onPinchUpdate = new r.Event,
                    t.onPan = new r.Event,
                    t.onGestureFlick = new r.Event,
                    t.onGesturePick = new r.Event,
                    t.onGestureDrag = new r.Event,
                    t.onGestureDrop = new r.Event,
                    t.onGestureTap = new r.Event,
                    t.onGestureTapStart = new r.Event,
                    t.onGestureConfirm = new r.Event,
                    t._holdingObject = !1,
                    t._MAX_POINTERS = 2,
                    t._state = Po.IDLE,
                    t._gesture = ko.NONE,
                    t._dragType = Ut.NONE,
                    t._trackedPointerEvents = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isHoldingObject", {
                    get: function() {
                        return this._holdingObject
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "longpressTime", {
                    get: function() {
                        return this._BUILDING_LONGPRESS_TIME
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.canInteractWithHUD = function() {
                    return 0 === this._trackedPointerEvents.length
                }
                ,
                t.prototype.gestureConfirm = function(e) {
                    this._state === Po.GESTURE_DETECTION && (this._gesture = e,
                    this._logger.info("Gesture confirmed: ".concat(ko[e])),
                    this.onGestureConfirm.fire(this._gesture),
                    e !== ko.TAPPING && (this._state = Po.GESTURE_LOCK,
                    this._updateLockedGesture()))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._target = this.services.cameraService.cameraView,
                                [4, De.services.assetLoader.loadJsons(_e.INTERACTION_CONFIG)];
                            case 1:
                                return i.sent(),
                                e = De.services.resource.getJson(_e.INTERACTION_CONFIG),
                                t = (0,
                                n.__assign)((0,
                                n.__assign)({}, Fo), e || {}),
                                this._TOLERANCE_OBJECT_TAP_TIME = t.TOLERANCE_OBJECT_TAP_TIME,
                                this._TAP_DISTANCE_TRESHOLD = t.TAP_DISTANCE_TRESHOLD,
                                this._SLOW_DRAG_THRESHOLD = t.SLOW_DRAG_THRESHOLD,
                                this._BUILDING_LONGPRESS_TIME = t.BUILDING_LONGPRESS_TIME,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    this._target.on("pointerdown", this._onPointerDown, this),
                    this._target.on("pointerup", this._onPointerUpOrOut, this),
                    this._target.on("pointerupoutside", this._onPointerUpOrOut, this),
                    this._target.on("pointercancel", this._onPointerUpOrOut, this),
                    this._target.on("pointermove", this._onPointerMove, this),
                    this._onWheelMove = this._onWheelMove.bind(this),
                    De.services.canvas.view.addEventListener("wheel", this._onWheelMove),
                    window.addEventListener("wheel", (function(e) {
                        return e.preventDefault()
                    }
                    ), {
                        passive: !1
                    })
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._target.off("pointerdown", this._onPointerDown, this),
                            this._target.off("pointerup", this._onPointerUpOrOut, this),
                            this._target.off("pointerupoutside", this._onPointerUpOrOut, this),
                            this._target.off("pointercancel", this._onPointerUpOrOut, this),
                            this._target.off("pointermove", this._onPointerMove, this),
                            De.services.canvas.view.removeEventListener("wheel", this._onWheelMove),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onWheelMove = function(e) {
                    this.onScroll.fire({
                        delta: -.1 * e.deltaY,
                        gesture: ko.SCROLL
                    })
                }
                ,
                t.prototype._onPointerDown = function(e) {
                    if (e.target === this._target) {
                        if (this._logger.info("POINTER DOWN, REGISTER AN EVENT"),
                        this._registerPointer(e),
                        this.onInteractionStart.fire(),
                        this._gesture === ko.FLICK && (this._fireGestureEvent(this.onGestureFlick, !0),
                        this._gesture = ko.NONE),
                        this._trackedPointerEvents.length >= this._MAX_POINTERS && this._gesture !== ko.OBJECT_DRAG) {
                            this._logger.info("POINTER DOWN, WE HAVE 2 POINTERS - TIME TO PAN!");
                            var t = this._trackedPointerEvents[0]
                              , i = this._trackedPointerEvents[1];
                            this._gesture = ko.PINCH_ZOOM,
                            this._state = Po.GESTURE_LOCK,
                            this.onPinchStart.fire({
                                gesture: ko.PINCH_ZOOM,
                                firstPosition: t.activePosition,
                                secondPosition: i.activePosition
                            })
                        }
                        if (this._state === Po.IDLE) {
                            if (this._state = Po.GESTURE_DETECTION,
                            "mouse" === e.data.pointerType && 2 === e.data.button)
                                return;
                            this._fireGestureEvent(this.onGestureTapStart)
                        }
                    }
                }
                ,
                t.prototype._onPointerMove = function(e) {
                    if (this._isTrackedPointer(e)) {
                        if (this._updatePointerData(e),
                        this._updateDragType(this._trackedPointerEvents[0]),
                        e.data.identifier === this._trackedPointerEvents[0].id && this._state === Po.GESTURE_DETECTION) {
                            var t = this._trackedPointerEvents[0];
                            v.Vector2.substract(t.activePosition, t.startPosition).length() > this._TAP_DISTANCE_TRESHOLD && (this._gesture = ko.OBJECT_PICK,
                            this._trackedPointerEvents[0].rightMouseButton || this._fireGestureEvent(this.onGesturePick),
                            this._state === Po.GESTURE_DETECTION && this.gestureConfirm(ko.PAN))
                        }
                        this._state === Po.GESTURE_LOCK && (e.stopPropagation(),
                        this._updateLockedGesture())
                    }
                }
                ,
                t.prototype._onPointerUpOrOut = function(e) {
                    var t = this;
                    if (this._isTrackedPointer(e)) {
                        this._logger.info("POINTER UP TRIGGERED");
                        var i = e.data.identifier === this._trackedPointerEvents[0].id;
                        i && this._state === Po.GESTURE_DETECTION && Date.now() - this._trackedPointerEvents[0].time <= this._TOLERANCE_OBJECT_TAP_TIME && (this.gestureConfirm(ko.TAP),
                        this._fireGestureEvent(this.onGestureTap)),
                        i && this._state === Po.GESTURE_LOCK && (this._gesture === ko.OBJECT_DRAG && (this._gesture = ko.OBJECT_DROP,
                        setTimeout((function() {
                            t._holdingObject = !1
                        }
                        ), 200),
                        this._fireGestureEvent(this.onGestureDrop)),
                        this._gesture === ko.PAN && e.target === this._target && (this._gesture = ko.FLICK,
                        this._fireGestureEvent(this.onGestureFlick))),
                        this._logger.info("POINTER UP- TIME TO CLEAN UP THE POINTERS ARRAY!"),
                        this._trackedPointerEvents = this._trackedPointerEvents.filter((function(t) {
                            return t.id !== e.data.identifier
                        }
                        )),
                        0 === this._trackedPointerEvents.length ? this._state = Po.IDLE : this._gesture === ko.PINCH_ZOOM && (this._state = Po.GESTURE_DETECTION,
                        this.gestureConfirm(ko.PAN))
                    }
                }
                ,
                t.prototype._fireGestureEvent = function(e, t) {
                    void 0 === t && (t = !1),
                    e.fire({
                        position: this._trackedPointerEvents[0].activePosition,
                        startPosition: this._trackedPointerEvents[0].startPosition,
                        deltaPosition: this._trackedPointerEvents[0].deltaPosition,
                        screenPosition: this._trackedPointerEvents[0].screenPosition,
                        dragType: this._dragType,
                        isCancelled: t,
                        gesture: this._gesture
                    })
                }
                ,
                t.prototype._isTrackedPointer = function(e) {
                    return this._trackedPointerEvents.some((function(t) {
                        return t.id === e.data.identifier
                    }
                    ))
                }
                ,
                t.prototype._registerPointer = function(e) {
                    var t = e.data.getLocalPosition(this._target)
                      , i = "mouse" === e.data.pointerType && 2 === e.data.button;
                    this._trackedPointerEvents.push({
                        id: e.data.identifier,
                        screenPosition: e.data.global.clone(),
                        startPosition: t.clone(),
                        activePosition: t.clone(),
                        deltaPosition: new Xe.Point(0,0),
                        time: Date.now(),
                        deltaTime: 0,
                        rightMouseButton: i
                    })
                }
                ,
                t.prototype._updatePointerData = function(e) {
                    for (var t = 0, i = this._trackedPointerEvents; t < i.length; t++) {
                        var n = i[t];
                        if (n.id === e.data.identifier) {
                            var r = e.data.getLocalPosition(this._target);
                            n.deltaPosition.x = r.x - n.activePosition.x,
                            n.deltaPosition.y = r.y - n.activePosition.y,
                            n.screenPosition.copyFrom(e.data.global),
                            n.activePosition.copyFrom(r),
                            n.deltaTime = Date.now() - n.time,
                            n.time = Date.now()
                        }
                    }
                }
                ,
                t.prototype._updateDragType = function(e) {
                    var t = v.Vector2.fromPoint(e.deltaPosition).length() / this._trackedPointerEvents[0].deltaTime;
                    this._dragType = t < this._SLOW_DRAG_THRESHOLD ? Ut.SLOW : Ut.FAST
                }
                ,
                t.prototype._updateLockedGesture = function() {
                    switch (this._gesture) {
                    case ko.OBJECT_PICK:
                        this._gesture = ko.OBJECT_DRAG,
                        this._holdingObject = !0;
                    case ko.OBJECT_DRAG:
                        this._fireGestureEvent(this.onGestureDrag);
                        break;
                    case ko.PINCH_ZOOM:
                        var e = this._trackedPointerEvents[0]
                          , t = this._trackedPointerEvents[1];
                        this.onPinchUpdate.fire({
                            gesture: ko.PINCH_ZOOM,
                            firstPosition: e.activePosition,
                            secondPosition: t.activePosition
                        });
                        break;
                    case ko.PAN:
                        var i = this._trackedPointerEvents[0];
                        this.onPan.fire({
                            deltaPosition: i.deltaPosition,
                            gesture: this._gesture
                        })
                    }
                }
                ,
                t
            }(Go), Vo = function() {
                function e(e) {
                    this.stepFinished = new r.Event,
                    this.stepCanceled = new r.Event,
                    this.key = e,
                    this._logger = Ie.Of(e)
                }
                return e.prototype.initialize = function(e) {
                    this._dependencies = e
                }
                ,
                e.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.execute()];
                            case 1:
                                return e.sent(),
                                this.stepFinished.fire(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.close = function() {
                    this.stepCanceled.fire()
                }
                ,
                e
            }(), Ho = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._dependencies.onboarding.inputBlocker.removeInputBlocker(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), jo = function(e) {
                function t(t) {
                    return e.call(this, t) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.Mergeable]).forEach((function(e) {
                                var t, i, n = null === (t = e.content) || void 0 === t ? void 0 : t.getBehavior(Ke.Mergeable);
                                null === (i = e.content) || void 0 === i || i.replaceBehavior(new qt({
                                    target: n.target,
                                    expReward: n.expReward,
                                    targetSpecification: n.targetSpecification,
                                    zeroLuckyChance: !0
                                }))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Ko = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._cratesSpawnPositions = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return e = 0,
                            [2, new Promise((function(i) {
                                0 !== t._cratesSpawnPositions.length ? t._dependencies.hudService.hudContainer.setCrateSpawnData(t._cratesSpawnPositions, (function(r) {
                                    return (0,
                                    n.__awaiter)(t, void 0, void 0, (function() {
                                        var t;
                                        return (0,
                                        n.__generator)(this, (function(n) {
                                            return this._dependencies.mapGrid.getCell(r.column, r.row) ? (t = this._cratesSpawnPositions.indexOf(r),
                                            this._cratesSpawnPositions.splice(t, 0),
                                            e += 1,
                                            De.services.analytics.design.reportOnboardingCrateSpawned(e),
                                            0 === this._cratesSpawnPositions.length && i(),
                                            [2]) : [2]
                                        }
                                        ))
                                    }
                                    ))
                                }
                                )) : i()
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo);
            !function(e) {
                e[e.HUD = 0] = "HUD",
                e[e.ONBOARDING = 1] = "ONBOARDING",
                e[e.POPUP = 2] = "POPUP"
            }(Uo || (Uo = {}));
            var Wo, zo = function() {
                function e() {
                    this._logger = r.Logger.Of("Onboarding Input Blocker"),
                    this._container = null,
                    this._inputBlocker = (new Xe.Graphics).beginFill(0, 1e-5).drawRect(-1, -1, 2, 2).endFill(),
                    this._inputBlocker.interactive = !0
                }
                return e.prototype.addInputBlocker = function(e, t, i) {
                    if (ge(this._container)) {
                        if (t === Uo.ONBOARDING)
                            this._inputBlocker.position.copyFrom(i.getCameraPosition()),
                            this._inputBlocker.width = i.getCameraBounds().width,
                            this._inputBlocker.height = i.getCameraBounds().height;
                        else {
                            var n = De.services.canvas.bounds;
                            this._inputBlocker.width = n.width,
                            this._inputBlocker.height = n.height
                        }
                        this._container = e,
                        this._container.addChild(this._inputBlocker)
                    } else
                        this._logger.error("cannot add blocker as it is already added to another container, did you forget to remove it?")
                }
                ,
                e.prototype.removeInputBlocker = function() {
                    ge(this._container) ? this._logger.warn("cannot remove blocker as it isn't added to a container") : (this._container.removeChild(this._inputBlocker),
                    this._container = null)
                }
                ,
                e
            }();
            !function(e) {
                e.main = "main",
                e.areas = "areas",
                e.background = "background"
            }(Wo || (Wo = {}));
            var Yo, Jo = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e, t) {
                    this._tiledMapService = e,
                    this._projection = t
                }
                ,
                t.prototype.draw = function() {
                    var e = this;
                    this._tiledMapService.forEachTileInLayer(Wo.background, (function(t, i, n) {
                        if (n) {
                            var r = e._projection.getWorldPosition(t, i)
                              , o = De.services.resource.getSprite({
                                alias: n.image
                            });
                            o.position.copyFrom(r),
                            o.anchor.copyFrom(e._projection.defaultAnchor),
                            e.addChild(o)
                        }
                    }
                    ))
                }
                ,
                t
            }(Xe.Container), Xo = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e) {
                    this._projection = e
                }
                ,
                t
            }(Xe.Container), qo = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e, t) {
                    this._tiledMapService = e,
                    this._projection = t
                }
                ,
                t.prototype.draw = function() {
                    var e = this;
                    De.services.lazyLoad.getLoadingPromise(hn.DECALS).then((function() {
                        e._tiledMapService.getDecals().forEach((function(t) {
                            var i = De.services.resource.getSprite({
                                alias: t.alias
                            })
                              , n = e._projection.getEditorRemappedPosition(t.position)
                              , r = e._projection.projection.projectIntoPlane(n);
                            i.anchor.set(.5, t.flip.vertical ? 0 : 1),
                            i.scale.set(t.flip.horizontal ? -1 : 1, t.flip.vertical ? -1 : 1),
                            i.angle = t.rotation,
                            i.width = t.width,
                            i.height = t.height,
                            i.position.copyFrom(r),
                            e.addChild(i)
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Xe.Container);
            !function(e) {
                e.BACKGROUD = "background",
                e.DECALS = "decals",
                e.MAIN = "main",
                e.LAYER_SELECTION = "layerSelection",
                e.WORLD_ANIMATION = "worldAnimation",
                e.PREVIEW_UI = "preview_ui",
                e.ONBOARDING = "onboarding",
                e.POPOUTS = "popouts",
                e.STORAGE_BUBBLES = "storage_bubbles",
                e.FLOATERS = "floaters"
            }(Yo || (Yo = {}));
            var Qo, Zo = function(e) {
                function t() {
                    var t, i = null !== e && e.apply(this, arguments) || this;
                    return i.layers = ((t = {})[Yo.BACKGROUD] = i.addChild(new Jo),
                    t[Yo.DECALS] = i.addChild(new qo),
                    t[Yo.MAIN] = i.addChild(new Xo),
                    t[Yo.LAYER_SELECTION] = i.addChild(new Xe.Container),
                    t[Yo.WORLD_ANIMATION] = i.addChild(new Xe.Container),
                    t[Yo.PREVIEW_UI] = i.addChild(new Xe.Container),
                    t[Yo.POPOUTS] = i.addChild(new Xe.Container),
                    t[Yo.STORAGE_BUBBLES] = i.addChild(new Xe.Container),
                    t[Yo.FLOATERS] = i.addChild(new Xe.Container),
                    t[Yo.ONBOARDING] = i.addChild(new Xe.Container),
                    t),
                    i._logger = Ie.Of("MapGridView"),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e) {
                    this.layers.background.initialize(e.tiledMap, e.axonometricProjection),
                    this.layers.decals.initialize(e.tiledMap, e.axonometricProjection),
                    this.layers.background.draw(),
                    this.layers.decals.draw(),
                    this.layers.main.initialize(e.axonometricProjection),
                    this.layers.main.interactiveChildren = !1,
                    this.layers.decals.interactiveChildren = !1,
                    this.layers.background.interactiveChildren = !1,
                    this.layers.floaters.interactiveChildren = !1,
                    this.layers.layerSelection.interactiveChildren = !1
                }
                ,
                t.prototype.prepare = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.draw = function() {}
                ,
                t.prototype.update = function() {}
                ,
                t
            }(Xe.Container), $o = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._layerToAddInputBlocker = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._dependencies.onboarding.inputBlocker.addInputBlocker(this._getLayerContainer(this._layerToAddInputBlocker), this._layerToAddInputBlocker, this._dependencies.cameraService),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getLayerContainer = function(e) {
                    switch (e) {
                    case Uo.ONBOARDING:
                        return this._dependencies.mapGridView.getLayer(Yo.ONBOARDING);
                    case Uo.HUD:
                        return this._dependencies.hudService.hudContainer;
                    case Uo.POPUP:
                        return De.services.navigation.popupLayer.container;
                    default:
                        return this._logger.warn("couldn't find layer for InputBlockerLayers.".concat(e, ". Returning MainLayer")),
                        this._dependencies.mapGridView.getLayer(Yo.MAIN)
                    }
                }
                ,
                t
            }(Vo);
            !function(e) {
                e[e.DEFAULT = 0] = "DEFAULT",
                e[e.ONBOARDING = 1] = "ONBOARDING"
            }(Qo || (Qo = {}));
            var ea, ta, ia, na = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._crateButtonType = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                switch (this._crateButtonType) {
                                case Qo.DEFAULT:
                                    return [3, 1];
                                case Qo.ONBOARDING:
                                    return [3, 3]
                                }
                                return [3, 5];
                            case 1:
                            case 5:
                                return [4, this._dependencies.hudService.hudContainer.setDefaultCratesButtonController()];
                            case 2:
                            case 4:
                            case 6:
                                return e.sent(),
                                [3, 7];
                            case 3:
                                return [4, this._dependencies.hudService.hudContainer.setOnboardingCratesButtonController()];
                            case 7:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), ra = function(e) {
                function t(t) {
                    return e.call(this, t) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._dependencies.onboarding.handHelper.removeHandAnimation(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), oa = function(e) {
                function t(t, i) {
                    void 0 === i && (i = !0);
                    var n = e.call(this, t) || this;
                    return n._awaitHiding = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._dependencies.dialogService.removeOnClick(),
                                this._awaitHiding ? [4, this._dependencies.dialogService.hideDialog()] : [3, 2];
                            case 1:
                                return e.sent(),
                                [3, 3];
                            case 2:
                                this._dependencies.dialogService.hideDialog(),
                                e.label = 3;
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), aa = function(e) {
                function t(t, i, n) {
                    void 0 === n && (n = !0);
                    var r = e.call(this, t) || this;
                    return r._elementsToHide = i,
                    r._saveInModel = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    var e = this;
                    return this._elementsToHide.forEach((function(t) {
                        e._dependencies.onboarding.hideHudElement(t, void 0, e._saveInModel)
                    }
                    )),
                    Promise.resolve()
                }
                ,
                t
            }(Vo), sa = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._message = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._logger.info(this._message),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), _a = function(e) {
                function t(t, i) {
                    void 0 === i && (i = !1);
                    var n = e.call(this, "SendAnalyticsStep") || this;
                    return n._stepName = t,
                    n._isTrackCompleted = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return this._isTrackCompleted ? this._sendForFinish() : this._sendForStart(),
                    Promise.resolve()
                }
                ,
                t.prototype._sendForStart = function() {
                    De.services.analytics.wasStepStartEventSent(this._stepName) || (De.services.analytics.saveStepStartStatus(this._stepName),
                    De.services.analytics.design.startOnboardingStep(this._stepName))
                }
                ,
                t.prototype._sendForFinish = function() {
                    De.services.analytics.wasStepFinishEventSent(this._stepName) || (De.services.analytics.saveStepFinishStatus(this._stepName),
                    De.services.analytics.design.finishOnboardingStep(this._stepName))
                }
                ,
                t
            }(Vo);
            function ca(e) {
                return !isNaN(e.column) && !isNaN(e.row)
            }
            function la(e) {
                return ca(e[0])
            }
            !function(e) {
                e[e.HUD = 0] = "HUD",
                e[e.MAIN = 1] = "MAIN",
                e[e.POPUP = 2] = "POPUP"
            }(ea || (ea = {})),
            function(e) {
                function t(t, i, n, r, o, a, s) {
                    void 0 === s && (s = !1);
                    var _ = e.call(this, t) || this;
                    return _._layerToAddAnimation = i,
                    _._handAnimationSpineData = r,
                    _._velocity = o,
                    _._loop = a,
                    _._startPosition = n,
                    _._mirror = s,
                    _
                }
                (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e = ca(this._startPosition) ? this._convertCellPositionToCoordinate(this._startPosition) : this._startPosition,
                            this._dependencies.onboarding.handHelper.showHandAnimation({
                                layer: this._getLayerContainer(this._layerToAddAnimation),
                                handAnimationSpineData: this._convertData(this._handAnimationSpineData),
                                startPosition: e,
                                velocity: this._velocity,
                                loop: this._loop,
                                mirror: this._mirror
                            }),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getLayerContainer = function(e) {
                    switch (e) {
                    case ea.MAIN:
                        return this._dependencies.mapGridView.getLayer(Yo.ONBOARDING);
                    case ea.HUD:
                        return De.services.navigation.layers.hud.container;
                    case ea.POPUP:
                        return De.services.navigation.layers.popup.container;
                    default:
                        return this._logger.warn("couldn't find layer for AnimatedHandLayers.".concat(e, ". Returning MainLayer")),
                        this._dependencies.mapGridView.getLayer(Yo.MAIN)
                    }
                }
                ,
                t.prototype._convertData = function(e) {
                    var t = this
                      , i = [];
                    return e.forEach((function(e) {
                        e.points ? la(e.points) ? i.push({
                            points: t._convertCellPositionsToCoordinates(e.points)
                        }) : i.push({
                            points: e.points
                        }) : e.idle ? i.push({
                            idle: e.idle
                        }) : i.push({
                            effectAnimationName: e.effectAnimationName
                        })
                    }
                    )),
                    i
                }
                ,
                t.prototype._convertCellPositionToCoordinate = function(e) {
                    return this._dependencies.axonometricProjection.getWorldPosition(e.column, e.row)
                }
                ,
                t.prototype._convertCellPositionsToCoordinates = function(e) {
                    var t = this;
                    return e.map((function(e) {
                        return t._dependencies.axonometricProjection.getWorldPosition(e.column, e.row)
                    }
                    ))
                }
            }(Vo),
            function(e) {
                e.CLICK = "click",
                e.CLICK_AND_DRAG = "clickAndDrag",
                e.DELAY = "delay"
            }(ta || (ta = {})),
            function(e) {
                e.UP = "up",
                e.DOWN = "down",
                e.LEFT_UP = "leftUp",
                e.LEFT_DOWN = "leftDown",
                e.RIGHT_UP = "rightUp",
                e.RIGHT_DOWN = "rightDown"
            }(ia || (ia = {}));
            var ua, da, ha, pa, va, ga, fa = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._addedChildren = new Map,
                    n._options = i,
                    n._timeline = lr.gsap.timeline(),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return De.services.actions.on("onboarding.removeAnimations", this._removeAnimations, this),
                                this._options.await ? [4, this._executeAnimations()] : [3, 2];
                            case 1:
                                return e.sent(),
                                [3, 3];
                            case 2:
                                this._executeAnimations(),
                                e.label = 3;
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._removeAnimations = function() {
                    var e = this;
                    this._options.loop = !1,
                    this._timeline && (this._timeline.kill(),
                    this._addedChildren.forEach((function(t, i) {
                        return e._removeChildFromLayer(i, t)
                    }
                    ))),
                    De.services.actions.off("onboarding.removeAnimations", this._removeAnimations, this)
                }
                ,
                t.prototype._executeAnimations = function(e) {
                    return void 0 === e && (e = 0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return e >= this._options.animations.length ? this._options.loop ? [4, this._executeAnimations()] : [3, 2] : [3, 3];
                            case 1:
                                i.sent(),
                                i.label = 2;
                            case 2:
                                return [2];
                            case 3:
                                switch ((t = this._options.animations[e]).animationName) {
                                case ta.CLICK:
                                    return [3, 4];
                                case ta.CLICK_AND_DRAG:
                                    return [3, 6];
                                case ta.DELAY:
                                    return [3, 8]
                                }
                                return [3, 10];
                            case 4:
                                return [4, this._showClickAnimation(t)];
                            case 5:
                                return i.sent(),
                                [3, 11];
                            case 6:
                                return [4, this._showClickAndDragAnimation(t)];
                            case 7:
                                return i.sent(),
                                [3, 11];
                            case 8:
                                return [4, this._showIdleAnimation(t.duration)];
                            case 9:
                                return i.sent(),
                                [3, 11];
                            case 10:
                                this._logger.warn("Unknown animation type: ".concat(t.animationName)),
                                i.label = 11;
                            case 11:
                                return [4, this._executeAnimations(e + 1)];
                            case 12:
                                return i.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showClickAnimation = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a, s, _, c, l, u, d, h, p, v, g, f;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = e.points,
                                i = e.duration,
                                r = e.mirror,
                                o = i / 1e3 / 100,
                                a = t ? this._getCoordinates(t.startPosition) : {
                                    x: 0,
                                    y: 0
                                },
                                s = this._prepareHandSprite(),
                                _ = this._getLayerContainer(e.layer || ea.HUD),
                                c = 0,
                                l = 1,
                                r && (s.scale.x = -s.scale.x,
                                c = -(s.width / 2 + 20),
                                l = -1),
                                this._addChildToLayer(s, _),
                                s.position.set(a.x + c, a.y + 180),
                                this._timeline = lr.gsap.timeline(),
                                u = 0,
                                d = 25 * o,
                                s.alpha = 0,
                                h = s.scale.x,
                                p = s.scale.y,
                                s.scale.set(.5 * h, .5 * p),
                                this._timeline.to(s, {
                                    alpha: 1,
                                    duration: d
                                }, 0),
                                this._timeline.to(s.scale, {
                                    x: h,
                                    y: p,
                                    duration: d,
                                    ease: "back.out"
                                }, 0),
                                u += d + 10 * o,
                                v = 15 * o,
                                this._timeline.to(s, {
                                    angle: -10 * l,
                                    duration: v / 2
                                }, u),
                                u += v,
                                g = 15 * o,
                                this._timeline.to(s, {
                                    angle: 0,
                                    duration: g
                                }, u),
                                u += g + 10 * o,
                                f = 25 * o,
                                this._timeline.to(s, {
                                    alpha: 0,
                                    duration: f
                                }, u),
                                this._timeline.to(s.scale, {
                                    x: .5 * h,
                                    y: .5 * p,
                                    duration: f,
                                    ease: "back.in"
                                }, u),
                                [4, this._timeline.play().then((function() {
                                    return new Promise((function(e) {
                                        return setTimeout(e, i)
                                    }
                                    ))
                                }
                                ))];
                            case 1:
                                return n.sent(),
                                this._removeChildFromLayer(s, _),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showClickAndDragAnimation = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a, s, _, c, l, u, d, h, p, v, g, f, E, m, y, T, A, C, I;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                switch (t = e.points,
                                i = e.duration,
                                r = e.addGridArrow,
                                o = i / 1e3 / 100,
                                a = t ? this._getCoordinates(t.startPosition) : {
                                    x: 0,
                                    y: 0
                                },
                                s = t && t.endPosition ? this._getCoordinates(t.endPosition) : {
                                    x: 0,
                                    y: 0
                                },
                                _ = 1,
                                c = this._prepareHandSprite(),
                                l = this._getLayerContainer(e.layer || ea.MAIN),
                                d = 0,
                                h = 0,
                                !0) {
                                case a.x === s.x:
                                    u = a.y < s.y ? ia.DOWN : ia.UP;
                                    break;
                                case a.y === s.y:
                                    u = a.x < s.x ? ia.RIGHT_DOWN : ia.LEFT_UP;
                                    break;
                                case a.x < s.x:
                                    u = a.y < s.y ? ia.RIGHT_DOWN : ia.RIGHT_UP;
                                    break;
                                default:
                                    u = a.y < s.y ? ia.LEFT_DOWN : ia.LEFT_UP
                                }
                                switch (p = this._prepareArrowSprite(u),
                                u) {
                                case ia.UP:
                                    h = -p.width / 2,
                                    p.anchor.set(.5, 0);
                                    break;
                                case ia.DOWN:
                                    p.scale.y = -p.scale.y,
                                    h = -p.width / 2,
                                    p.anchor.set(.5, 0);
                                    break;
                                case ia.RIGHT_DOWN:
                                    p.scale.y = -p.scale.y,
                                    c.scale.x = -c.scale.x,
                                    _ = -1,
                                    d = -(c.width + 20);
                                    break;
                                case ia.LEFT_DOWN:
                                    p.scale.y = -p.scale.y,
                                    p.scale.x = -p.scale.x;
                                    break;
                                case ia.LEFT_UP:
                                    _ = -1,
                                    c.scale.x = -c.scale.x,
                                    p.scale.x = -p.scale.x,
                                    d = -(c.width + 20)
                                }
                                return c.position.set(a.x + 180 + d, a.y + 180),
                                this._timeline = lr.gsap.timeline(),
                                v = 0,
                                g = 10 * o,
                                c.alpha = 0,
                                f = c.scale.x,
                                E = c.scale.y,
                                c.scale.set(.5 * f, .5 * E),
                                this._timeline.to(c, {
                                    alpha: 1,
                                    duration: g
                                }, 0),
                                this._timeline.to(c.scale, {
                                    x: f,
                                    y: E,
                                    duration: g,
                                    ease: "back.out"
                                }, 0),
                                v += g + 5 * o,
                                m = 10 * o,
                                this._timeline.to(c, {
                                    angle: -10 * _,
                                    duration: m / 2
                                }, v),
                                r && (y = p.scale.x,
                                T = p.scale.y,
                                p.alpha = 0,
                                this._timeline.to(p, {
                                    alpha: 1,
                                    duration: m / 2
                                }, v + m / 2),
                                this._timeline.to(p.scale, {
                                    x: 1.2 * y,
                                    y: 1.2 * T,
                                    duration: m / 2,
                                    ease: "sine.out"
                                }, v + m / 2),
                                this._timeline.to(p.scale, {
                                    x: y,
                                    y: T,
                                    duration: m / 2,
                                    ease: "sine.in"
                                }, v + m / 4 * 3)),
                                v += m + 5 * o,
                                A = 35 * o,
                                this._timeline.to(c.position, {
                                    x: s.x + 180 + d,
                                    y: s.y + 180,
                                    duration: A
                                }, v),
                                r && (p.position.set(a.x + h, a.y + 80),
                                this._addChildToLayer(p, l),
                                this._timeline.to(p.position, {
                                    x: s.x - 0 + h,
                                    y: s.y + 80,
                                    duration: A,
                                    ease: "sine.inOut"
                                }, v)),
                                v += A + 5 * o,
                                C = 10 * o,
                                this._timeline.to(c, {
                                    angle: 0,
                                    duration: C
                                }, v),
                                v += C + 5 * o,
                                I = 15 * o,
                                this._timeline.to(c, {
                                    alpha: 0,
                                    duration: I
                                }, v),
                                this._timeline.to(c.scale, {
                                    x: .5 * f,
                                    y: .5 * E,
                                    duration: I,
                                    ease: "back.in"
                                }, v),
                                r && this._timeline.to(p, {
                                    alpha: 0,
                                    duration: I
                                }, v),
                                this._addChildToLayer(c, l),
                                [4, this._timeline.play().then((function() {
                                    return new Promise((function(e) {
                                        return setTimeout(e, i)
                                    }
                                    ))
                                }
                                ))];
                            case 1:
                                return n.sent(),
                                this._removeChildFromLayer(c, l),
                                this._removeChildFromLayer(p, l),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._prepareHandSprite = function() {
                    var e = De.services.resource.getSprite(f.HAND_ONBOARDING);
                    return e.anchor.set(.5),
                    e
                }
                ,
                t.prototype._prepareArrowSprite = function(e) {
                    var t;
                    switch (e) {
                    case ia.UP:
                    case ia.DOWN:
                        t = De.services.resource.getSprite(f.ARROW_HANDDIRECTION_VERTICAL);
                        break;
                    case ia.LEFT_UP:
                    case ia.LEFT_DOWN:
                    case ia.RIGHT_UP:
                    case ia.RIGHT_DOWN:
                    default:
                        t = De.services.resource.getSprite(f.ARROW_HANDDIRECTION_DIAGONAL)
                    }
                    return t.anchor.set(1, 0),
                    t.position.x += 0,
                    t.position.y += 80,
                    t
                }
                ,
                t.prototype._addChildToLayer = function(e, t) {
                    t.addChild(e),
                    this._addedChildren.set(e, t)
                }
                ,
                t.prototype._removeChildFromLayer = function(e, t) {
                    this._addedChildren.has(e) && (this._addedChildren.delete(e),
                    t.removeChild(e),
                    e.destroy())
                }
                ,
                t.prototype._showIdleAnimation = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, new Promise((function(t) {
                                    return setTimeout(t, e)
                                }
                                ))];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getLayerContainer = function(e) {
                    switch (e) {
                    case ea.MAIN:
                        return this._dependencies.mapGridView.getLayer(Yo.ONBOARDING);
                    case ea.HUD:
                        return De.services.navigation.layers.hud.container;
                    case ea.POPUP:
                        return De.services.navigation.layers.popup.container;
                    default:
                        return this._logger.warn("couldn't find layer for AnimatedHandLayers.".concat(e, ". Returning MainLayer")),
                        this._dependencies.mapGridView.getLayer(Yo.MAIN)
                    }
                }
                ,
                t.prototype._getCoordinates = function(e) {
                    return ca(e) ? this._dependencies.axonometricProjection.getWorldPosition(e.column, e.row) : e
                }
                ,
                t
            }(Vo), Ea = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.NORMAL,
                    i._name = "TaskAnnouncementPopup",
                    i._task = t.task,
                    i._createTitle(),
                    i._createTaskContent(),
                    i._createContinueText(),
                    i._inputBlocker.off("pointerup", void 0, i),
                    i.onOpened.listenOnce((function() {
                        return (0,
                        n.__awaiter)(i, void 0, void 0, (function() {
                            return (0,
                            n.__generator)(this, (function(e) {
                                return this._inputBlocker.once("pointerup", this.close, this),
                                this._content.interactive = !0,
                                this._content.once("pointerup", this.close, this),
                                [2]
                            }
                            ))
                        }
                        ))
                    }
                    ), i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerdown", this._tryToClose, this)
                }
                ,
                t.prototype._createTitle = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 200,
                        fitWidth: 600
                    });
                    e.style = vn.lvlUpText,
                    this._title = new v.Label(nr(ua || (ua = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TASK_ADDED_POPUP_TITLE),e),
                    this._title.anchor.set(.5),
                    this._title.position.set(0, -De.services.canvas.height / 2 + 350),
                    this._content.addChild(this._title)
                }
                ,
                t.prototype._createTaskContent = function() {
                    var e = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE));
                    e.setSizes({
                        width: 800,
                        height: 300
                    }),
                    e.anchor.set(.5),
                    e.position.set(0, -200);
                    var t = De.services.resource.getSprite(f.BG_TASKS_232);
                    t.position.set(t.width / 1.5 - e.width / 2, e.y - 20),
                    t.anchor.set(.5);
                    var i = this._task.getVisual()
                      , n = Math.min((t.width - 55) / i.width, (t.height - 55) / i.height);
                    i.scale.set(n),
                    t.addChild(i);
                    var r = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 100,
                        fitWidth: 400
                    });
                    r.style = vn.darkMedium;
                    var o = new v.Label(this._task.description,r);
                    o.anchor.set(0, .5),
                    o.position.set(-100, e.y);
                    var a = De.services.resource.getSprite(f.BG_TASKS_PILL);
                    a.anchor.set(.5),
                    a.position.set(t.x, t.y + t.height / 2 + a.height / 5),
                    r.style = vn.darkSmall;
                    var s = new v.Label("".concat(this._task.goal.currentValue, "/").concat(this._task.goal.targetValue),r);
                    s.anchor.set(.5),
                    s.position.set(a.x, a.y),
                    this._content.addChild(e, t, o, a, s)
                }
                ,
                t.prototype._createContinueText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !1
                    });
                    e.style = vn.lvlUpContinueText,
                    this._tapToContinueText = new v.Label(nr(da || (da = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAP_TO_CONTINUE),e),
                    this._tapToContinueText.anchor.set(.5),
                    this._tapToContinueText.position.set(0, 400),
                    this._content.addChild(this._tapToContinueText)
                }
                ,
                t
            }(yr);
            !function(e) {
                e.FLOUR = "recipe_flour",
                e.EGGS = "recipe_eggs",
                e.BREAD = "recipe_bread",
                e.SUNFLOWER_OIL = "recipe_sunflower_oil",
                e.OMELET = "recipe_omelet",
                e.MILK = "recipe_milk",
                e.CHEESE = "recipe_cheese",
                e.BUTTER = "recipe_butter",
                e.SUGAR = "recipe_sugar",
                e.MUFFIN = "recipe_muffin",
                e.PANCAKES = "recipe_pancakes",
                e.RAW_BACON = "recipe_raw_bacon",
                e.GRILLED_SANDWICH = "recipe_grilled_sandwich",
                e.GRILLED_BACON = "recipe_grilled_bacon",
                e.CARROTS = "recipe_carrots",
                e.CARROT_BREAD = "recipe_carrot_bread",
                e.CARROT_CAKE = "recipe_carrot_cake",
                e.GOAT_MILK = "recipe_goat_milk",
                e.GOAT_CHEESE = "recipe_goat_cheese",
                e.ICECREAM = "recipe_icecream",
                e.SOY_SAUCE = "recipe_soysauce",
                e.TOFU = "recipe_tofu",
                e.WOOL = "recipe_wool",
                e.SOCKS = "recipe_socks",
                e.JACKET = "recipe_jacket",
                e.TROUSERS = "recipe_trousers",
                e.GRILLED_CORN = "recipe_grilled_corn",
                e.POPCORN = "recipe_popcorn",
                e.CHEESE_POPCORN = "recipe_cheese_popcorn",
                e.TOFU_BURGER = "recipe_tofu_burger",
                e.GOAT_YOGHURT = "recipe_goat_yoghurt",
                e.COFFEE_BEANS = "recipe_coffee_beans",
                e.FUR_PURSE = "recipe_fur_purse",
                e.CAPPUCCINO = "recipe_cappuccino",
                e.CORN = "recipe_corn",
                e.ESPRESSO = "recipe_espresso",
                e.PILLOW = "recipe_pillow",
                e.SOYBEANS = "recipe_soy_beans",
                e.TIRAMISU = "recipe_tiramisu",
                e.TOMATO_BURGER = "recipe_mini_tomato_burger",
                e.TOMATO_SOUP = "recipe_tomato_soup",
                e.STUFFED_TOMATO = "recipe_stuffed_tomatoes",
                e.TOMATO_ON_A_STICK = "recipe_tomato_salad_on_a_stick",
                e.AVOCADO_TACO = "recipe_avocado_taco",
                e.AVOCADO_ON_TOAST = "recipe_avocado_on_toast",
                e.AVOCADO_WRAP = "recipe_avocado_wrap",
                e.AVOCADO_EGG_BURGER = "recipe_avocado_egg_burger",
                e.TRUFFLE_BALLS = "recipe_truffleballs",
                e.TRUFFLE_GRILLED_CHEESE_SANDWICH = "recipe_truffle_grilled_cheese_sandwich",
                e.TRUFFLE_PASTA = "recipe_trufflepasta"
            }(ha || (ha = {})),
            function(e) {
                e.CHICKEN = "chicken",
                e.COW = "cow",
                e.CARROT = "carrot",
                e.CORN = "corn",
                e.GOAT = "goat",
                e.PIG = "pig",
                e.SHEEP = "sheep",
                e.SOYBEAN = "soybeans",
                e.SUGARCANE = "sugarcane",
                e.SUNFLOWER = "sunflower",
                e.WHEAT = "wheat",
                e.COFFEEBEANS = "coffee",
                e.DEER = "deer",
                e.TOMATO = "tomato",
                e.AVOCADO = "avocado",
                e.TRUFFLE = "truffle"
            }(ga || (ga = {}));
            var ma, ya, Ta, Aa, Ca, Ia = ((pa = {})[ga.CHICKEN] = f.ICON_LEVELUP_REWARDS_CHICKEN,
            pa[ga.COW] = f.ICON_LEVELUP_REWARDS_COW,
            pa[ga.CARROT] = f.ICON_LEVELUP_REWARDS_CARROT,
            pa[ga.GOAT] = f.ICON_LEVELUP_REWARDS_GOAT,
            pa[ga.PIG] = f.ICON_LEVELUP_REWARDS_PIG,
            pa[ga.SHEEP] = f.ICON_LEVELUP_REWARDS_SHEEP,
            pa[ga.SOYBEAN] = f.ICON_LEVELUP_REWARDS_SOYBEAN,
            pa[ga.SUGARCANE] = f.ICON_LEVELUP_REWARDS_SUGARCANE,
            pa[ga.SUNFLOWER] = f.ICON_LEVELUP_REWARDS_SUNFLOWER,
            pa[ga.WHEAT] = f.ICON_LEVELUP_REWARDS_WHEAT,
            pa[ga.CORN] = f.ICON_LEVELUP_REWARDS_CORN,
            pa[ga.COFFEEBEANS] = f.ICON_LEVELUP_REWARDS_COFFEEBEANS,
            pa[ga.DEER] = f.ICON_LEVELUP_REWARDS_DEER,
            pa[ga.TOMATO] = f.ICON_LEVELUP_REWARDS_TOMATO,
            pa[ga.AVOCADO] = f.ICON_LEVELUP_REWARDS_AVOCADO,
            pa[ga.TRUFFLE] = f.ICON_LEVELUP_REWARDS_TRUFFLE,
            pa[Cn.COINS] = f.ICON_LEVELUP_REWARDS_COINS,
            pa[Cn.CRATES] = f.ICON_LEVELUP_REWARDS_CRATES,
            pa[Cn.ENERGY] = f.ICON_LEVELUP_REWARDS_ENERGY,
            pa[Cn.GEMS] = f.ICON_LEVELUP_REWARDS_GEMS,
            pa[Cn.WOOD] = f.ICON_LEVELUP_REWARDS_GEMS,
            pa[Cn.STONE] = f.ICON_LEVELUP_REWARDS_GEMS,
            pa[Cn.TICKETS] = f.OVERLAY_ADVANCED_PACK_ENERGY,
            pa[An.EXP] = f.ICON_LEVELUP_REWARDS_LEVELUP,
            pa[An.LEVEL] = f.ICON_LEVELUP_REWARDS_LEVELUP,
            pa[ha.BREAD] = f.ICON_LEVELUP_REWARDS_BREAD,
            pa[ha.CARROT_BREAD] = f.ICON_LEVELUP_REWARDS_CARROTBREAD,
            pa[ha.CARROT_CAKE] = f.ICON_LEVELUP_REWARDS_CARROTCAKE,
            pa[ha.CARROTS] = f.ICON_LEVELUP_REWARDS_CARROTCRATE,
            pa[ha.MUFFIN] = f.ICON_LEVELUP_REWARDS_MUFFIN,
            pa[ha.OMELET] = f.ICON_LEVELUP_REWARDS_OMELET,
            pa[ha.GRILLED_BACON] = f.ICON_LEVELUP_REWARDS_GRILLEDBACON,
            pa[ha.GRILLED_CORN] = f.ICON_LEVELUP_REWARDS_GRILLEDCORN,
            pa[ha.GRILLED_SANDWICH] = f.ICON_LEVELUP_REWARDS_GRILLEDSANDWITCH,
            pa[ha.TOFU_BURGER] = f.ICON_LEVELUP_REWARDS_TOFUBURGER,
            pa[ha.BUTTER] = f.ICON_LEVELUP_REWARDS_BUTTER,
            pa[ha.CHEESE] = f.ICON_LEVELUP_REWARDS_CHEESE,
            pa[ha.GOAT_CHEESE] = f.ICON_LEVELUP_REWARDS_GOATCHEESE,
            pa[ha.GOAT_YOGHURT] = f.ICON_LEVELUP_REWARDS_GOATYOGHURT,
            pa[ha.EGGS] = f.ICON_LEVELUP_REWARDS_EGGS,
            pa[ha.FLOUR] = f.ICON_LEVELUP_REWARDS_FLOUR,
            pa[ha.GOAT_MILK] = f.ICON_LEVELUP_REWARDS_GOATSMILK,
            pa[ha.MILK] = f.ICON_LEVELUP_REWARDS_MILK,
            pa[ha.RAW_BACON] = f.ICON_LEVELUP_REWARDS_RAWBACON,
            pa[ha.SOY_SAUCE] = f.ICON_LEVELUP_REWARDS_SOYSAUCE,
            pa[ha.SUGAR] = f.ICON_LEVELUP_REWARDS_SUGAR,
            pa[ha.SUNFLOWER_OIL] = f.ICON_LEVELUP_REWARDS_SUNFLOWEROIL,
            pa[ha.TOFU] = f.ICON_LEVELUP_REWARDS_TOFU,
            pa[ha.WOOL] = f.ICON_LEVELUP_REWARDS_WOOL,
            pa[ha.JACKET] = f.ICON_LEVELUP_REWARDS_JACKET,
            pa[ha.SOCKS] = f.ICON_LEVELUP_REWARDS_SOCKS,
            pa[ha.TROUSERS] = f.ICON_LEVELUP_REWARDS_TROUSERS,
            pa[ha.CHEESE_POPCORN] = f.ICON_LEVELUP_REWARDS_CHEESEPOPCORN,
            pa[ha.ICECREAM] = f.ICON_LEVELUP_REWARDS_ICECREAMCONE,
            pa[ha.PANCAKES] = f.ICON_LEVELUP_REWARDS_PANCAKES,
            pa[ha.POPCORN] = f.ICON_LEVELUP_REWARDS_POPCORN,
            pa[ha.CORN] = f.ICON_LEVELUP_REWARDS_CORNBUNDLED,
            pa[ha.COFFEE_BEANS] = f.ICON_LEVELUP_REWARDS_COFFEEBAG,
            pa[ha.SOYBEANS] = f.ICON_LEVELUP_REWARDS_SOYBEANSBUNDLED,
            pa[ha.FUR_PURSE] = f.ICON_LEVELUP_REWARDS_PURSE,
            pa[ha.CAPPUCCINO] = f.ICON_LEVELUP_REWARDS_CAPPUCCINO,
            pa[ha.ESPRESSO] = f.ICON_LEVELUP_REWARDS_ESPRESSO,
            pa[ha.PILLOW] = f.ICON_LEVELUP_REWARDS_PILLOW_DEER,
            pa[ha.TIRAMISU] = f.ICON_LEVELUP_REWARDS_TIRAMISU,
            pa[ha.TOMATO_BURGER] = f.ICON_LEVELUP_REWARDS_TOMATOBURGER,
            pa[ha.STUFFED_TOMATO] = f.ICON_LEVELUP_REWARDS_TOMATOFILLED,
            pa[ha.TOMATO_SOUP] = f.ICON_LEVELUP_REWARDS_TOMATOSOUP,
            pa[ha.TOMATO_ON_A_STICK] = f.ICON_LEVELUP_REWARDS_TOMATOSALADONSTICK,
            pa[ha.AVOCADO_TACO] = f.ICON_RECIPES_AVOCADOTACO,
            pa[ha.AVOCADO_ON_TOAST] = f.ICON_RECIPES_AVOCADOONTOAST,
            pa[ha.AVOCADO_WRAP] = f.ICON_RECIPES_AVOCADOWRAP,
            pa[ha.AVOCADO_EGG_BURGER] = f.ICON_RECIPES_AVOCADOEGGBURGER,
            pa[ha.TRUFFLE_BALLS] = f.ICON_RECIPES_TRUFFLEBALLS,
            pa[ha.TRUFFLE_GRILLED_CHEESE_SANDWICH] = f.ICON_RECIPES_TRUFFLEGRILLEDCHEESESANDW,
            pa[ha.TRUFFLE_PASTA] = f.ICON_RECIPES_TRUFFLEPASTAPLATE,
            pa), Sa = ((va = {})[Cn.COINS] = f.ICON_LEVELUP_REWARDS_COINS,
            va[Cn.CRATES] = f.ICON_LEVELUP_REWARDS_CRATES,
            va[Cn.ENERGY] = f.ICON_LEVELUP_REWARDS_ENERGY,
            va[Cn.GEMS] = f.ICON_LEVELUP_REWARDS_GEMS,
            va[Cn.WOOD] = f.ICON_LEVELUP_REWARDS_GEMS,
            va[Cn.STONE] = f.ICON_LEVELUP_REWARDS_GEMS,
            va[Cn.TICKETS] = f.OVERLAY_ADVANCED_PACK_ENERGY,
            va[Sn.WHEAT] = f.ICON_LEVELUP_REWARDS_WHEAT,
            va[Sn.EGG] = f.ICON_LEVELUP_REWARDS_EGGS,
            va[Sn.SUNFLOWER] = f.ICON_LEVELUP_REWARDS_SUNFLOWER,
            va[Sn.MILK] = f.ICON_LEVELUP_REWARDS_MILK,
            va[Sn.SUGARCANE] = f.ICON_LEVELUP_REWARDS_SUGARCANE,
            va[Sn.BACON] = f.ICON_LEVELUP_REWARDS_RAWBACON,
            va[Sn.CARROT] = f.ICON_LEVELUP_REWARDS_CARROT,
            va[Sn.GOATMILK] = f.ICON_LEVELUP_REWARDS_GOATSMILK,
            va[Sn.SOYBEANS] = f.ICON_LEVELUP_REWARDS_SOYBEAN,
            va[Sn.WOOL] = f.ICON_LEVELUP_REWARDS_WOOL,
            va[Sn.CORN] = f.ICON_LEVELUP_REWARDS_CORN,
            va[Sn.FUR] = f.ICON_LEVELUP_REWARDS_FUR,
            va[Sn.COFFEEBEANS] = f.ICON_LEVELUP_REWARDS_COFFEEBEANS,
            va[Sn.TOMATO] = f.ICON_LEVELUP_REWARDS_TOMATO,
            va[Sn.AVOCADO] = f.ICON_LEVELUP_REWARDS_AVOCADO,
            va[Sn.TRUFFLE] = f.ICON_LEVELUP_REWARDS_TRUFFLE,
            va), Oa = {
                x: 0,
                y: -90
            }, ba = {
                x: 95,
                y: -30
            }, Ra = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._logger = Ie.Of("LevelRewardCard"),
                    i._showLock = t.showLock || !1,
                    i._createBackground(),
                    t.inventoryItem && i._createInventoryItemCard(t.inventoryItem),
                    t.recipe && i._createRecipeCard(t.recipe),
                    t.crateContent && i._createCrateContentCard(t.crateContent),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._createBackground = function() {
                    this._cardBackground = this.addChild(De.services.resource.getSprite(f.BG_LEVELUP_REWARDS)),
                    this._cardBackground.anchor.set(.5),
                    this._textSettings = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: this._cardBackground.width - 50
                    })
                }
                ,
                t.prototype._createInventoryItemCard = function(e) {
                    var t = Ia[e.key];
                    this.addChild(rr(De.services.resource.getSprite(t), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: Oa
                    })),
                    this._showLock && this.addChild(rr(De.services.resource.getSprite(f.ICON_LEVELUP_LOCK_UNLOCKED), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: ba
                    })),
                    this._textSettings.style = vn.darkMedium;
                    var i = e.amount.toString();
                    this.addChild(rr(new v.Label(i,this._textSettings), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 60
                        }
                    })),
                    this._textSettings.style = vn.lightMedium;
                    var n = De.services.localization.getText({
                        alias: e.key
                    });
                    this.addChild(rr(new v.Label(n,this._textSettings), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 150
                        }
                    }))
                }
                ,
                t.prototype._createRecipeCard = function(e) {
                    var t = De.services.recipes.getRecipe(e)
                      , i = Ia[t.ID];
                    this.addChild(rr(De.services.resource.getSprite(i), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: Oa
                    })),
                    this._showLock && this.addChild(rr(De.services.resource.getSprite(f.ICON_LEVELUP_LOCK_UNLOCKED), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: ba
                    })),
                    this._textSettings.style = vn.darkMedium;
                    var r = De.services.localization.getText({
                        alias: t.ID
                    });
                    this.addChild(rr(new v.Label(r,this._textSettings), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 60
                        }
                    })),
                    this._textSettings.style = vn.lightMedium,
                    this.addChild(rr(new v.Label(nr(ma || (ma = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.RECIPE),this._textSettings), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 150
                        }
                    }))
                }
                ,
                t.prototype._createCrateContentCard = function(e) {
                    var t = De.services.blueprintCollection.getBlueprint(e)
                      , i = t.id.split("_")[0]
                      , n = Ia[i];
                    if (n) {
                        this.addChild(rr(De.services.resource.getSprite(n), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: Oa
                        })),
                        this._showLock && this.addChild(rr(De.services.resource.getSprite(f.ICON_LEVELUP_LOCK_UNLOCKED), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: ba
                        })),
                        this._textSettings.style = vn.darkMedium;
                        var r = De.services.gameObjectFactory.getMeaningfulCroppedName(t.id)
                          , o = De.services.localization.getText({
                            alias: r
                        });
                        this.addChild(rr(new v.Label(o,this._textSettings), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: 0,
                                y: 60
                            }
                        })),
                        this._textSettings.style = vn.lightMedium;
                        var a = t.components.crop ? "crop" : "animal"
                          , s = De.services.localization.getText({
                            alias: a
                        });
                        this.addChild(rr(new v.Label(s,this._textSettings), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: 0,
                                y: 150
                            }
                        }))
                    } else
                        this._logger.warn("no image on new crate content ".concat(e))
                }
                ,
                t
            }(Xe.Container), wa = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.NORMAL,
                    i._name = "TaskCompletePopup",
                    i._task = t.task,
                    i._onCloseCallback = t.onCloseCallback,
                    i._createInfo(),
                    i._createTitle(),
                    i._createRewards(),
                    i._createContinueText(),
                    i._inputBlocker.off("pointerup", void 0, i),
                    i.onOpened.listenOnce((function() {
                        return (0,
                        n.__awaiter)(i, void 0, void 0, (function() {
                            return (0,
                            n.__generator)(this, (function(e) {
                                return this._inputBlocker.once("pointerup", this.close, this),
                                this._content.interactive = !0,
                                this._content.once("pointerup", this.close, this),
                                [2]
                            }
                            ))
                        }
                        ))
                    }
                    ), i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return De.services.tasks.animateTaskRewards(this._task, this),
                            this._onCloseCallback && this._onCloseCallback(),
                            e.prototype.close.call(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerdown", this._tryToClose, this)
                }
                ,
                t.prototype._createTitle = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 200,
                        fitWidth: 600
                    });
                    e.style = vn.lvlUpText,
                    this._title = new v.Label(nr(ya || (ya = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TASK_COMPLETE_POPUP_TITLE),e),
                    this._title.anchor.set(.5),
                    this._title.position.set(0, -De.services.canvas.height / 2 + 300),
                    this._content.addChild(this._title)
                }
                ,
                t.prototype._createInfo = function() {
                    var e = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE));
                    e.setSizes({
                        width: 800,
                        height: 300
                    }),
                    e.anchor.set(.5),
                    e.position.set(0, -250);
                    var t = De.services.resource.getSprite(f.BG_TASKS_232);
                    t.position.set(t.width / 1.5 - e.width / 2, e.y - 20),
                    t.anchor.set(.5);
                    var i = this._task.getVisual()
                      , n = Math.min((t.width - 55) / i.width, (t.height - 55) / i.height);
                    i.scale.set(n),
                    t.addChild(i);
                    var r = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 100,
                        fitWidth: 400
                    });
                    r.style = vn.darkMedium;
                    var o = new v.Label(this._task.description,r);
                    o.anchor.set(0, .5),
                    o.position.set(-100, e.y);
                    var a = De.services.resource.getSprite(f.BG_TASKS_PILL);
                    a.anchor.set(.5),
                    a.position.set(t.x, t.y + t.height / 2 + a.height / 5),
                    r.style = vn.darkSmall;
                    var s = new v.Label("".concat(this._task.goal.targetValue, "/").concat(this._task.goal.targetValue),r);
                    s.anchor.set(.5),
                    s.position.set(a.x, a.y);
                    var _ = De.services.resource.getSprite(f.ICON_TASKS_CHECKMARK);
                    _.anchor.set(.5),
                    _.position.set(0, e.y - e.height / 1.75),
                    this._content.addChild(e, t, o, a, s, _)
                }
                ,
                t.prototype._createRewards = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 100,
                        fitWidth: 400
                    });
                    e.style = vn.lightBoldLarge;
                    var t = new v.Label("".concat(nr(Ta || (Ta = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.REWARDS), ":"),e);
                    t.anchor.set(.5),
                    t.position.set(0, 0);
                    var i = this._task.getRewards()
                      , r = new Xe.Container;
                    i.forEach((function(e, t) {
                        var i = "inventory" === e.type ? new Ra({
                            inventoryItem: {
                                amount: e.amount,
                                key: e.key
                            }
                        }) : new Ra({
                            crateContent: e.key
                        });
                        i.position.set(360 * t, 0),
                        r.addChild(i)
                    }
                    )),
                    r.position.set(-180 * (i.length - 1), 350),
                    this._content.addChild(t, r)
                }
                ,
                t.prototype._createContinueText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !1
                    });
                    e.style = vn.lvlUpContinueText,
                    this._tapToContinueText = new v.Label(nr(Aa || (Aa = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAP_TO_CONTINUE),e),
                    this._tapToContinueText.anchor.set(.5),
                    this._tapToContinueText.position.set(0, 800),
                    this._content.addChild(this._tapToContinueText)
                }
                ,
                t
            }(yr), Da = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._dialogName = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._dependencies.dialogService.setCurrentDialogData(this._dependencies.dialogService.dialogs[this._dialogName]),
                            De.services.navigation.isPopupTypeOpen(Ea) || De.services.navigation.isPopupTypeOpen(wa) ? De.services.navigation.onPopupClosed.listenOnce((function() {
                                e.execute()
                            }
                            ), this) : this._dependencies.dialogService.showDialog(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Na = function(e) {
                function t(t, i, n) {
                    void 0 === n && (n = !0);
                    var r = e.call(this, t) || this;
                    return r._elementsToShow = i,
                    r._isSavedInModel = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._elementsToShow.forEach((function(t) {
                                e._dependencies.onboarding.showHudElement(t, e._isSavedInModel)
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo);
            !function(e) {
                e[e.ENABLED = 0] = "ENABLED",
                e[e.DISABLED = 1] = "DISABLED"
            }(Ca || (Ca = {}));
            var La, Ba, Pa, ka, xa, Ga, Ua, Fa, Ma, Va, Ha = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._cameraState = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._dependencies.onboarding.updateCameraState(this._cameraState),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), ja = function(e) {
                function t(t, i, n, r, o) {
                    void 0 === r && (r = .8),
                    void 0 === o && (o = !1);
                    var a = e.call(this, t) || this;
                    return a._zoomValue = i,
                    a._duration = r,
                    a._awaitPromise = o,
                    a._moveTo = n,
                    a._duration = r,
                    a
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return (e = this._dependencies.mapGrid.getCell(this._moveTo.column, this._moveTo.row)) ? this._awaitPromise ? [4, this._dependencies.cameraService.animateCameraZoomAndMoveToCell(this._zoomValue, e, this._duration, !0)] : [3, 2] : (this._logger.error("couldn't find gridcell with col: ".concat(this._moveTo.column, ", row: ").concat(this._moveTo.row, ". Is it already unlocked?")),
                                [2]);
                            case 1:
                                return t.sent(),
                                [3, 3];
                            case 2:
                                this._dependencies.cameraService.animateCameraZoomAndMoveToCell(this._zoomValue, e, this._duration, !0),
                                t.label = 3;
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Ka = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._gestureTypes = i,
                    r._allowGesture = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._gestureTypes.forEach((function(t) {
                                t === ko.OBJECT_DRAG ? e._allowGesture ? e._dependencies.interactionWhitelistService.allowAllDrags() : e._dependencies.interactionWhitelistService.blockAllDrags() : t === ko.TAP && (e._allowGesture ? e._dependencies.interactionWhitelistService.allowAllTaps() : e._dependencies.interactionWhitelistService.blockAllTaps())
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Wa = function() {
                function e(e, t, i) {
                    void 0 === t && (t = []),
                    void 0 === i && (i = []),
                    this.onTrackStartable = new r.Event,
                    this.onTrackUnavailable = new r.Event,
                    this.onTrackCanceled = new r.Event,
                    this._steps = [],
                    this._exitTriggers = [],
                    this._isInitialized = !1,
                    this._startable = !1,
                    this._activeStep = null,
                    this.key = e,
                    this._triggers = t,
                    this._exitTriggers = i,
                    this._logger = Ie.Of("Onboarding_".concat(this.key))
                }
                return e.prototype.initialize = function(e) {
                    var t = this;
                    this._isInitialized = !0,
                    this._dependencies = e,
                    this._onInitialize(e),
                    this._triggers.forEach((function(i) {
                        i.onStatusChanged.addListener(t._onTriggerChanged, t),
                        i.initialize(e)
                    }
                    )),
                    this._checkTriggers()
                }
                ,
                e.prototype.destroy = function() {
                    var e = this;
                    this._triggers.forEach((function(t) {
                        t.onStatusChanged.removeListener(e._onTriggerChanged, e),
                        t.destroy()
                    }
                    ))
                }
                ,
                e.prototype.execute = function() {
                    var e = this;
                    return this._isInitialized || Promise.reject("Track has not been initialized"),
                    this._listenToExitTriggers(),
                    this._onExecute(),
                    this._steps.forEach((function(t) {
                        return t.initialize(e._dependencies)
                    }
                    )),
                    this._executeSteps()
                }
                ,
                e.prototype.cancel = function() {
                    var e;
                    null === (e = this._activeStep) || void 0 === e || e.close(),
                    this._onCancel()
                }
                ,
                e.prototype.addTrigger = function(e) {
                    this._isInitialized ? this._logger.error("Triggers must be added to onboarding track before initialization. track ".concat(this.key)) : this._triggers.push(e)
                }
                ,
                e.prototype._onCancel = function() {}
                ,
                e.prototype._executeSteps = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, new Promise((function(t, i) {
                                var n = function() {
                                    var r = e._steps.shift();
                                    r ? (e._activeStep = r,
                                    r.stepCanceled.addListener((function() {
                                        r.stepFinished.removeListener(n, e),
                                        e._stepCanceled(),
                                        i()
                                    }
                                    ), e),
                                    r.stepFinished.addListener(n, e),
                                    r.start()) : t()
                                };
                                n()
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._onTriggerChanged = function() {
                    this._checkTriggers()
                }
                ,
                e.prototype._checkTriggers = function() {
                    !this._startable && this._triggers.every((function(e) {
                        return !0 === e.status
                    }
                    )) && (this._startable = !0,
                    this.onTrackStartable.fire(this)),
                    this._startable && this._triggers.some((function(e) {
                        return !1 === e.status
                    }
                    )) && (this._startable = !1,
                    this.onTrackUnavailable.fire(this))
                }
                ,
                e.prototype._listenToExitTriggers = function() {
                    var e = this;
                    this._exitTriggers.forEach((function(t) {
                        t.onStatusChanged.addListener(e._checkExitTriggers, e),
                        t.initialize(e._dependencies)
                    }
                    ))
                }
                ,
                e.prototype._checkExitTriggers = function() {
                    var e;
                    this._exitTriggers.some((function(e) {
                        return !0 === e.status
                    }
                    )) && (null === (e = this._activeStep) || void 0 === e || e.close())
                }
                ,
                e.prototype._stepCanceled = function() {
                    var e = this;
                    this._startable = !1,
                    this._triggers.forEach((function(t) {
                        t.onStatusChanged.removeListener(e._onTriggerChanged, e),
                        t.status = !1
                    }
                    )),
                    this._exitTriggers.forEach((function(t) {
                        t.onStatusChanged.removeListener(e._checkExitTriggers, e),
                        t.status = !1
                    }
                    )),
                    this._steps = [],
                    this.onTrackCanceled.fire(this)
                }
                ,
                e.prototype._isStepArray = function(e) {
                    if (0 === e.length)
                        return !1;
                    var t = e[0];
                    return !ve(t.execute) && !ve(t.initialize) && !ve(t.key)
                }
                ,
                e
            }(), za = ((La = {})[Cn.COINS] = f.ICON_ORDERS_REWARD_COINS4,
            La[Cn.GEMS] = f.ICON_BTN_GEM,
            La[Cn.ENERGY] = f.ICON_BTN_ENERGY,
            La[Cn.TICKETS] = f.ICON_BALLOON_TRAINTICKET,
            La[Cn.STONE] = f.ICON_POPUP_BRICKS,
            La[Cn.WOOD] = f.ICON_POPUP_WOOD,
            La[Cn.CRATES] = f.ICON_BALLOON_UNLOADDELIVERY,
            La), Ya = ((Ba = {})[An.EXP] = f.BTN_LEVELUP_CROWN,
            Ba[An.LEVEL] = {
                alias: "none"
            },
            Ba), Ja = ((Pa = {})[Sn.WHEAT] = f.INGREDIENT_WHEAT,
            Pa[Sn.EGG] = f.INGREDIENT_EGG,
            Pa[Sn.SUNFLOWER] = f.INGREDIENT_SUNFLOWER,
            Pa[Sn.MILK] = f.INGREDIENT_MILK,
            Pa[Sn.SUGARCANE] = f.INGREDIENT_SUGARCANE,
            Pa[Sn.BACON] = f.INGREDIENT_BACON,
            Pa[Sn.CARROT] = f.INGREDIENT_CARROT,
            Pa[Sn.GOATMILK] = f.INGREDIENT_GOAT_MILK,
            Pa[Sn.SOYBEANS] = f.INGREDIENT_SOYBEAN,
            Pa[Sn.WOOL] = f.INGREDIENT_WOOL,
            Pa[Sn.CORN] = f.INGREDIENT_CORN,
            Pa[Sn.FUR] = f.INGREDIENT_FUR,
            Pa[Sn.COFFEEBEANS] = f.INGREDIENT_COFFEEBEANS,
            Pa[Sn.TOMATO] = f.INGREDIENT_TOMATO,
            Pa[Sn.AVOCADO] = f.INGREDIENT_AVOCADO,
            Pa[Sn.TRUFFLE] = f.INGREDIENT_TRUFFLE,
            Pa), Xa = ((ka = {})[On.COIN_1] = f.ICON_ORDERS_REWARD_COINS0,
            ka[On.COIN_2] = f.ICON_ORDERS_REWARD_COINS1,
            ka[On.COIN_3] = f.ICON_ORDERS_REWARD_COINS2,
            ka[On.COIN_4] = f.ICON_ORDERS_REWARD_COINS3,
            ka[On.COIN_5] = f.ICON_ORDERS_REWARD_COINS4,
            ka[On.COIN_6] = f.ICON_ORDERS_REWARD_COINS5,
            ka[On.COIN_7] = f.ICON_ORDERS_REWARD_COINS6,
            ka[On.GEMS_0] = f.ICON_ORDERS_REWARDS_GEMS0,
            ka[On.GEMS_1] = f.ICON_ORDERS_REWARDS_GEMS1,
            ka[On.GEMS_2] = f.ICON_ORDERS_REWARDS_GEMS2,
            ka[On.GEMS_3] = f.ICON_ORDERS_REWARDS_GEMS3,
            ka[On.GEMS_4] = f.ICON_ORDERS_REWARDS_GEMS4,
            ka[On.GEMS_5] = f.ICON_ORDERS_REWARDS_GEMS5,
            ka), qa = ((xa = {})[Cn.GEMS] = {
                icon: f.ICON_COUNTER_GEM,
                header: ce.MARKETPLACE_GEM_HEADER
            },
            xa[Cn.CRATES] = {
                icon: f.ICON_BALLOON_UNLOADDELIVERY,
                header: ce.MARKETPLACE_CRATE_HEADER
            },
            xa[Cn.COINS] = {
                icon: f.ICON_COUNTER_COIN,
                header: ce.COINS
            },
            xa[Cn.ENERGY] = {
                icon: f.ICON_COUNTER_ENERGY,
                header: ce.ENERGY
            },
            xa[Cn.TICKETS] = {
                icon: f.ICON_TRAIN_TICKET,
                header: ce.TICKETS
            },
            xa[Cn.STONE] = {
                icon: f.OBJ_NATURE_BRICKPILE_04,
                header: ce.COINS
            },
            xa[Cn.WOOD] = {
                icon: f.OBJ_NATURE_WOOD_PILE_04,
                header: ce.COINS
            },
            (0,
            n.__assign)((0,
            n.__assign)((0,
            n.__assign)({}, za), Ja), Ya)), Qa = ((Ga = {})[Cn.COINS] = ce.COINS,
            Ga[Cn.GEMS] = ce.GEMS,
            Ga[Cn.ENERGY] = ce.ENERGY,
            Ga[Cn.TICKETS] = ce.TICKETS,
            Ga[Cn.STONE] = ce.STONE,
            Ga[Cn.WOOD] = ce.WOOD,
            Ga[Cn.CRATES] = ce.CRATES,
            Ga);
            !function(e) {
                e.CRATES = "Crates",
                e.ENERGY = "Energy",
                e.GEMS = "Gems"
            }(Ua || (Ua = {})),
            function(e) {
                e.HALLOWEEN = "Halloween",
                e.CHRISTMAS = "Christmas",
                e.VALENTINES = "Valentines",
                e.BLACK_FRIDAY = "BlackFriday",
                e.CHRISTMAS_DEALS = "ChristmasDeals"
            }(Fa || (Fa = {})),
            function(e) {
                e.FREE = "free",
                e.AD = "ad",
                e.Inventory = "inventory",
                e.IAP = "iap"
            }(Ma || (Ma = {})),
            function(e) {
                e.OBJECT = "object",
                e.OBJECT_BUBBLE = "object_bubble",
                e.INVENTORY = "inventory"
            }(Va || (Va = {}));
            var Za = function(e) {
                return e.payment.type === Ma.AD
            }
              , $a = function(e) {
                return e.payment.type === Ma.IAP
            }
              , es = function(e) {
                return e.payment.type === Ma.Inventory
            }
              , ts = function(e) {
                return e.id.includes("_no_ads")
            }
              , is = function(e) {
                return e.type === Va.OBJECT
            }
              , ns = function(e) {
                return e.type === Va.INVENTORY
            }
              , rs = "energy_generator"
              , os = "crates_generator"
              , as = i(5317)
              , ss = [{
                name: "rank_bar",
                duration: .75,
                repeat: 0,
                keyframes: {
                    crown: [{
                        time: 0,
                        duration: .33,
                        ease: "sine.out",
                        params: {
                            scale: {
                                x: 1.25,
                                y: 1.25
                            }
                        }
                    }, {
                        time: .33,
                        duration: .33,
                        ease: "sine.in",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }],
                    progress: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            value: "+=0"
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "back.inOut",
                        params: {
                            value: "$targetProgress"
                        }
                    }],
                    targetProgress: []
                }
            }]
              , _s = [{
                name: "scale",
                duration: .15,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: "+=0",
                            scale: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .5,
                        ease: "sine.out",
                        params: {
                            scale: {
                                x: .63,
                                y: .63
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.in",
                        params: {
                            scale: {
                                x: .75,
                                y: .75
                            }
                        }
                    }]
                }
            }]
              , cs = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    t._oldValue = 0,
                    t._currentValue = 0,
                    t._maskRadius = 100,
                    t._maskStart = -.3 * Math.PI,
                    t._maskEnd = 1.3 * Math.PI,
                    t._maskLength = Math.abs(t._maskEnd - t._maskStart),
                    t._inventoryService = De.services.inventory,
                    t._experienceService = De.services.experience,
                    t._container = t.addChild(new Xe.Container),
                    t._container.interactive = !0,
                    t._container.x = 75,
                    t._container.y = 50,
                    t._container.scale.set(.75);
                    var i = rr(De.services.resource.getSprite(f.BTN_LEVELUP_BACKGROUND), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })
                      , n = rr(De.services.resource.getSprite(f.BTN_LEVELUP_BAR_FILL), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })
                      , r = rr(De.services.resource.getSprite(f.BTN_LEVELUP_BAR_OVERLAY), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    });
                    t._crownIcon = rr(De.services.resource.getSprite(f.BTN_LEVELUP_CROWN), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -68
                        }
                    });
                    var o = (new Xe.Graphics).beginFill(0).arc(0, 0, t._maskRadius, t._maskStart, t._maskEnd, !1).lineTo(0, 0).endFill();
                    n.mask = o;
                    var a = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 90,
                        fitWidth: 90
                    });
                    a.style = vn.lightBoldLarge;
                    var s = rr(new v.Label("X",a), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 3,
                            y: 0
                        }
                    });
                    s.text = String(t._experienceService.getLevel()),
                    t._container.addChild(i, n, r, t._crownIcon, s, o),
                    t._container.on("pointerdown", (function(e) {
                        e.stopPropagation(),
                        t._showExperienceProgression()
                    }
                    )),
                    t._rankLevel = s,
                    t._progressMask = o,
                    t._expItem = t._inventoryService.getInventoryItem(An.EXP),
                    t._expItem.onChanged.addListener(t._onExpChanged, t);
                    var _ = t._experienceService.getCurrentExp()
                      , c = {
                        key: An.EXP,
                        current: _,
                        old: 0
                    };
                    return t._onExpChanged(c),
                    t.AnimateRankBar(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.AnimateRankBar = function() {
                    var e = this;
                    De.services.audio.playSoundEffect(m.CURRENCY_ADDED);
                    var t = !1;
                    String(this._experienceService.getLevel()) !== this._rankLevel.text && (this._rankLevel.text = String(this._experienceService.getLevel()),
                    t = !0,
                    this._currentValue++),
                    this._progress = {
                        value: this._oldValue
                    };
                    var i = {
                        value: this._currentValue
                    }
                      , n = new ur(ss);
                    n.setTargets({
                        crown: this._crownIcon,
                        progress: this._progress,
                        targetProgress: i
                    }),
                    n.play("rank_bar"),
                    n.onUpdate.addListener((function() {
                        t || r.NumberUtility.clamp(0, e._progress.value, 1);
                        var i = e._maskLength * Math.max(0, e._progress.value % 1);
                        e._progressMask.clear(),
                        e._progressMask.beginFill(0).arc(0, 0, e._maskRadius, e._maskStart, e._maskStart + i, !1).lineTo(0, 0).endFill()
                    }
                    ), this),
                    n.onEnd.listenOnce((function() {
                        n.dispose()
                    }
                    ), this)
                }
                ,
                t.prototype.scaleRankBar = function() {
                    var e = new ur(_s);
                    e.setTargets({
                        container: this._container
                    }),
                    e.play("scale"),
                    e.onEnd.listenOnce((function() {
                        e.dispose()
                    }
                    ), this)
                }
                ,
                t.prototype.destroy = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    e.prototype.destroy.apply(this, t),
                    this._expItem.onChanged.removeListener(this._onExpChanged, this)
                }
                ,
                t.prototype._onExpChanged = function(e) {
                    e.old > e.current || (this._oldValue = this._currentValue % 1,
                    this._currentValue = this._experienceService.getLevelProgress())
                }
                ,
                t.prototype._addAutoSaveCheatVisuals = function() {
                    var e = rr(De.services.resource.getSprite(f.BTN_DEFAULT_GREY_INACTIVE), {
                        position: {
                            x: 200,
                            y: 0
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: 2,
                            y: 2
                        }
                    })
                      , t = rr(De.services.resource.getSprite(f.BTN_CLOSE_IDLE), {
                        position: {
                            x: 200,
                            y: 0
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: 1.5,
                            y: 1.5
                        }
                    })
                      , i = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 100,
                        fitWidth: 150,
                        style: vn.lightBoldExtraLarge
                    })
                      , n = rr(new v.Label("Autosave",i), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 200,
                            y: 0
                        }
                    });
                    t.alpha = De.services.cheats.allowSave ? 0 : 1,
                    e.interactive = !0,
                    e.on("pointerdown", (function(e) {
                        e.stopPropagation(),
                        window._DEVCHEATS.toggleAllowSaving()
                    }
                    )),
                    De.services.cheats.allowSavingValueChanged.addListener((function() {
                        t.alpha = De.services.cheats.allowSave ? 0 : 1
                    }
                    ), this),
                    this._container.addChild(e, n, t)
                }
                ,
                t.prototype._showExperienceProgression = function() {
                    var e = this;
                    if ((0,
                    r.isUndefined)(this._experienceProgressionPositionTimeline) && (0,
                    r.isUndefined)(this._experienceProgressionScaleTimeline)) {
                        this._experienceProgressionPositionTimeline = lr.gsap.timeline(),
                        this._experienceProgressionScaleTimeline = lr.gsap.timeline();
                        var t = this._container.addChild(new Xe.Container);
                        t.scale.set(0);
                        var i = this._experienceService.getCurrentExp()
                          , n = this._experienceService.getNextLevelExp()
                          , o = "".concat(i, "/").concat(n);
                        this._experienceService.isMaxLevel && (o = "Max level reached");
                        var a = new v.LabelSettings({
                            fitToBox: !0,
                            fitHeight: 68,
                            style: vn.lightBoldMedium
                        })
                          , s = new v.Label(o,a);
                        s.anchor.set(0, .5);
                        var _ = t.addChild(new cr(De.services.resource.getTexture(f.POPUP_BG_BLACK_9SLICE),11,11,11,11));
                        _.setSizes({
                            width: s.width + 25,
                            height: 70
                        }),
                        _.position.set(0),
                        _.anchor.set(0, .5),
                        t.addChild(s),
                        s.position.set(12.5, 0),
                        this._experienceProgressionPositionTimeline.add(lr.gsap.to(t.position, {
                            x: -75,
                            y: 150,
                            duration: .3,
                            ease: as.Yv.easeOut
                        })),
                        this._experienceProgressionPositionTimeline.add(lr.gsap.to(t.position, {
                            x: 0,
                            y: 0,
                            duration: .3,
                            ease: as.Yv.easeOut,
                            delay: 3
                        })),
                        this._experienceProgressionScaleTimeline.add(lr.gsap.to(t.scale, {
                            x: 1,
                            y: 1,
                            duration: .3,
                            ease: as.Yv.easeOut
                        })),
                        this._experienceProgressionScaleTimeline.add(lr.gsap.to(t.scale, {
                            x: 0,
                            y: 0,
                            duration: .3,
                            ease: as.Yv.easeOut,
                            delay: 3
                        })),
                        this._experienceProgressionScaleTimeline.eventCallback("onComplete", (function() {
                            var i, n;
                            null === (i = e._experienceProgressionPositionTimeline) || void 0 === i || i.kill(),
                            null === (n = e._experienceProgressionScaleTimeline) || void 0 === n || n.kill(),
                            e._experienceProgressionPositionTimeline = void 0,
                            e._experienceProgressionScaleTimeline = void 0,
                            t.destroy()
                        }
                        ))
                    }
                }
                ,
                t
            }(Xe.Container)
              , ls = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    i.data = t;
                    var n = t.backgroundPivotOffset ? t.backgroundPivotOffset : {
                        x: 0,
                        y: 0
                    }
                      , r = i.addChild(new cr(De.services.resource.getTexture(t.meterBackground),t.backgroundSliceParams.leftWidth,t.backgroundSliceParams.topHeight,t.backgroundSliceParams.rightWidth,t.backgroundSliceParams.bottomHeight));
                    r.setSizes(t.backgroundSize),
                    r.anchor.set(.5),
                    r.pivot.set(r.pivot.x + n.x, r.pivot.y + n.y),
                    r.name = "fill meter background";
                    var o = new cr(De.services.resource.getTexture(t.meterFill),t.meterFillSliceParams.leftWidth,t.meterFillSliceParams.topHeight,t.meterFillSliceParams.rightWidth,t.meterFillSliceParams.bottomHeight);
                    o.anchor.set(.5),
                    o.setSizes(t.fillSize),
                    i.addChild(o),
                    o.name = "fill meter fill",
                    i.progressText = i.addChild(rr(new v.Label(t.progressAmount + " / " + t.targetAmount.toString(),t.targetCounterLabelSettings), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    i.progressText.name = "fill meter progress text";
                    var a = Math.max(t.fillSize.width * (t.progressAmount / t.targetAmount), .001);
                    return i.progressMask = o.addChild((new Xe.Graphics).beginFill(16777215).drawRect(0, 0, a, o.height).endFill()),
                    o.mask = i.progressMask,
                    i.progressMask.name = "fill meter progress mask",
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Xe.Container);
            function us(e) {
                var t = f.OVERLAY_BONUS_FRIEND
                  , i = De.services.blueprintCollection.getBlueprint(e)
                  , n = i.components.sprite || {}
                  , r = i.components.spine || {};
                return n.alias ? t = {
                    alias: n.alias
                } : r.alias && r.startingState && r.uiImage && (t = {
                    alias: r.uiImage
                }),
                t
            }
            function ds(e, t, i) {
                var n = Math.min(t / e.width, 1)
                  , r = i ? Math.min(i / e.height, 1) : n;
                return e.scale.set(n, r),
                e
            }
            var hs, ps, vs = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.onAnimationEnd = new r.Event,
                    i.onPlayDisappearStart = new r.Event,
                    i._logger = r.Logger.Of("Service"),
                    i._dependencies = t,
                    i._createVisuals(),
                    i.position.set(i._dependencies.dailyChallengeButton.position.x, i._dependencies.dailyChallengeButton.position.y),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.playAppear = function() {
                    var e = this;
                    return new Promise((function(t) {
                        lr.gsap.to(e.position, {
                            x: e._dependencies.crateButton.position.x,
                            y: e._dependencies.crateButton.position.y - 250,
                            ease: "back.out",
                            duration: .5
                        }),
                        lr.gsap.to(e.scale, {
                            x: 1,
                            y: 1,
                            ease: "back.out",
                            duration: .5,
                            onComplete: t
                        })
                    }
                    ))
                }
                ,
                t.prototype.playCheckmarkPulse = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, new Promise((function(t) {
                                lr.gsap.to(e._checkmark.scale, {
                                    x: 1.4,
                                    y: 1.4,
                                    ease: "back.out",
                                    duration: .2,
                                    onComplete: function() {
                                        lr.gsap.to(e._checkmark.scale, {
                                            x: 1,
                                            y: 1,
                                            ease: "back.out",
                                            duration: .2,
                                            onComplete: t
                                        })
                                    }
                                })
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.playRewardAnimation = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._giveReward(this._dependencies.target.reward)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.playDisappear = function() {
                    var e = this;
                    return this.onPlayDisappearStart.fire(),
                    new Promise((function(t) {
                        lr.gsap.to(e.position, {
                            x: e._dependencies.dailyChallengeButton.position.x,
                            y: e._dependencies.dailyChallengeButton.position.y,
                            duration: .5
                        }),
                        lr.gsap.to(e.scale, {
                            x: 0,
                            y: 0,
                            duration: .5,
                            onComplete: function() {
                                e.onAnimationEnd.fire(),
                                t()
                            }
                        })
                    }
                    ))
                }
                ,
                t.prototype.destroy = function(t) {
                    return e.prototype.destroy.call(this, t),
                    Promise.resolve()
                }
                ,
                t.prototype._createVisuals = function() {
                    var e = this.addChild(De.services.resource.getSprite(f.UI_BG_DAILYCHALLENGES_TASK_POPUP));
                    e.anchor.set(.5),
                    this._checkmark = De.services.resource.getSprite(f.ICON_CHECKMARK_DAILYCHALLENGES_POPUP),
                    this._checkmark.anchor.set(.5),
                    this._checkmark.position.set(-e.width / 2 + this._checkmark.width / 2 + 50, 0),
                    e.addChild(this._checkmark);
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: .8 * e.width
                    });
                    t.style = vn.darkMedium;
                    var i = new v.Label(nr(hs || (hs = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), {
                        alias: this._dependencies.challengeData.localizedTask
                    }, this._dependencies.target.amount),t);
                    i.anchor.set(0, .5),
                    i.position.set(this._checkmark.position.x + this._checkmark.width / 2 + 25, this._checkmark.position.y),
                    e.addChild(i),
                    this._rewardImageForAnimation = ds(this._getRewardImage(this._dependencies.target.reward), 80),
                    this._rewardImageForAnimation.anchor.set(.5, 1),
                    this._rewardImageForAnimation.position.set(e.x + e.width / 2 - this._rewardImageForAnimation.width / 2 - 20, e.y + 17),
                    e.addChild(this._rewardImageForAnimation),
                    this._rewardImageForAnimation.name = "reward image",
                    t.style = vn.lightSmallWithOutline,
                    e.addChild(rr(new v.Label(ns(this._dependencies.target.reward) ? this._dependencies.target.reward.data.amount.toString() : "1",t), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: this._rewardImageForAnimation.x,
                            y: this._rewardImageForAnimation.y + 5
                        }
                    })).name = "reward amount text",
                    this.scale.set(0)
                }
                ,
                t.prototype._getRewardImage = function(e) {
                    switch (e.type) {
                    case Va.INVENTORY:
                        return this._getInventoryRewardImage(e.data.key);
                    case Va.OBJECT:
                        return De.services.resource.getSprite(us(e.data[0]));
                    default:
                        return De.services.resource.getSprite(f.OVERLAY_BONUS_FRIEND)
                    }
                }
                ,
                t.prototype._getInventoryRewardImage = function(e) {
                    return e === Cn.ENERGY ? De.services.resource.getSprite(f.OBJ_ENERGY_03) : De.services.resource.getSprite(za[e])
                }
                ,
                t.prototype._giveReward = function(e) {
                    return is(e) ? this._dependencies.rewardService.giveObjectRewardWithAnimation({
                        rewardBlueprintID: e.data[0],
                        blueprintComponents: De.services.blueprintCollection.getBlueprint(e.data[0]).components,
                        container: this,
                        bubble: this._currentBubble,
                        animationEndEvent: this.onPlayDisappearStart,
                        bubblePosition: new Xe.Point(0,-500),
                        image: this._rewardImageForAnimation
                    }) : ns(e) ? this._dependencies.rewardService.giveInventoryReward({
                        reward: e.data,
                        parent: this._rewardImageForAnimation
                    }) : Promise.resolve()
                }
                ,
                t
            }(Xe.Container), gs = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "dailyChallenge",
                        buttonIdle: f.BTN_HUD_DEFAULT_IDLE,
                        buttonActive: f.BTN_HUD_DEFAULT_DOWN,
                        targetPressedScale: 1.316
                    }) || this;
                    return i._rewardAnimationQueue = [],
                    i._currentRewardAnimation = void 0,
                    i._currentState = {
                        number: 0
                    },
                    i._switchBubbleParent = new r.Event,
                    i._currentDailyChallengeData = void 0,
                    i._logger = r.Logger.Of("Button"),
                    i._dependencies = t,
                    i._dailyChallengeService = t.services.dailyChallenge,
                    i._addOnClickBehavior(t),
                    i._dailyChallengeService.onDailyChallengeTaskRewardReady.addListener(i._onRewardReady, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !(0,
                        r.isUndefined)(this._dailyChallengeService.model.data.timerID)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function(t) {
                    var i;
                    e.prototype.destroy.call(this, t),
                    this._dailyChallengeService.onDailyChallengeTaskRewardReady.removeListener(this._onRewardReady, this),
                    null === (i = this._timer) || void 0 === i || i.onUpdate.removeListener(this._onUpdate, this)
                }
                ,
                t.prototype.challengeActive = function(e) {
                    this._currentDailyChallengeData && this._removeVisuals(),
                    this._createVisuals(),
                    this._setNotificationIcon(),
                    this._updateButtonVisuals(),
                    this._currentDailyChallengeData = e
                }
                ,
                t.prototype._removeVisuals = function() {
                    var e;
                    null === (e = this._timer) || void 0 === e || e.onUpdate.removeListener(this._onUpdate, this),
                    this._fillmeter.destroy(),
                    this._claimButton.destroy(),
                    this._mainButtonIconActive.destroy(),
                    this._mainButtonIconInactive.destroy(),
                    this._timerBackground.destroy(),
                    this._notificationIcon.destroy(),
                    this._currentState.number = 0
                }
                ,
                t.prototype._createVisuals = function() {
                    var e = this._dailyChallengeService.model.data;
                    (0,
                    r.isUndefined)(e.timerID) ? this._logger.error("No timerID found in model data, cannot add listeners.") : (this._mainButtonIconActive = this.addChild(De.services.resource.getSprite(f.ICON_BUTTON_HUD_DAILYCHALLENGES_ACTIVE)),
                    this._mainButtonIconActive.anchor.set(.5),
                    this._mainButtonIconActive.position.set(0, -35),
                    this._mainButtonIconInactive = this.addChild(De.services.resource.getSprite(f.ICON_BUTTON_HUD_DAILYCHALLENGES_INACTIVE)),
                    this._mainButtonIconInactive.anchor.set(.5),
                    this._mainButtonIconInactive.position.set(0, -35),
                    this._mainButtonIconInactive.visible = !1,
                    this._timerBackground = this.addChild(this._createTimerVisuals()),
                    this._timerBackground.position.set(0, 85),
                    this._currentState.number = this._dailyChallengeService.model.getFinishedTargets().length,
                    this._createFillMeter(e),
                    this._claimButton = this.addChild(this._createClaimButton()),
                    this._claimButton.position.set(this._fillmeter.position.x, this._fillmeter.position.y),
                    this._claimButton.visible = !1,
                    this._timer = De.services.timer.getTimerByID(e.timerID),
                    this._timer.onUpdate.addListener(this._onUpdate, this))
                }
                ,
                t.prototype._createFillMeter = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 110
                    });
                    t.style = vn.lightSmall,
                    this._fillmeter = this.addChild(new ls({
                        meterBackground: f.UI_BUTTON_PROGRESSBAR_DAILYCHALLENGES_BACKGROUND,
                        backgroundSize: {
                            width: 167,
                            height: 64
                        },
                        backgroundSliceParams: {
                            leftWidth: 0,
                            topHeight: 0,
                            rightWidth: 0,
                            bottomHeight: 0
                        },
                        meterFill: f.UI_BUTTON_PROGRESSBAR_DAILYCHALLENGES_FILL,
                        fillSize: {
                            width: 152,
                            height: 48
                        },
                        meterFillSliceParams: {
                            leftWidth: 24,
                            topHeight: 23,
                            rightWidth: 25,
                            bottomHeight: 22
                        },
                        targetAmount: e.targets.length,
                        progressAmount: this._currentState.number,
                        targetCounterLabelSettings: t
                    })),
                    this._fillmeter.position.set(0, this._timerBackground.position.y - 50)
                }
                ,
                t.prototype._setNotificationIcon = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._notificationIcon = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                                this._notificationIcon.position.set(this.width / 3, -this.height / 3),
                                this.addChild(this._notificationIcon),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return e.sent(),
                                this._updateNotificationState(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateNotificationState = function() {
                    this._notificationIcon.visible = !1,
                    this._dailyChallengeService.model.hasUnclaimedRewards() && (this._notificationIcon.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                    this._notificationIcon.visible = !0,
                    De.services.analytics.design.reportDiscoveryDiaryExclamationMarkShown())
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    this.onClick((function() {
                        e.services.interactionService.canInteractWithHUD() && (e.services.dailyChallenge.openDailyChallengePopup(),
                        e.events.hudElementClicked.fire())
                    }
                    ))
                }
                ,
                t.prototype._onRewardReady = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return (t = this._dependencies.services.hudService.hudContainer.getUIelement(Ns.CratesButtonUI)) ? (0,
                            r.isUndefined)(this._currentRewardAnimation) ? (this._currentRewardAnimation = this.parent.addChild(new vs({
                                storageBubbleService: this._dependencies.services.storageBubble,
                                mapGridView: this._dependencies.services.mapGridView,
                                cameraService: this._dependencies.services.cameraService,
                                rewardService: this._dependencies.services.rewardService,
                                dailyChallengeButton: this,
                                crateButton: t,
                                target: e,
                                challengeData: this._dailyChallengeService.model.data
                            })),
                            this._currentRewardAnimation.playAppear().then((function() {
                                return i._currentRewardAnimation.playCheckmarkPulse()
                            }
                            )).then((function() {
                                return i._currentRewardAnimation.playRewardAnimation()
                            }
                            )).then((function() {
                                return i._currentRewardAnimation.playDisappear()
                            }
                            )).then((function() {
                                return i._currentRewardAnimation.destroy()
                            }
                            )).then((function() {
                                return i._pulseButtonAndUpdateVisuals()
                            }
                            )).then((function() {
                                return i._updateButtonVisuals()
                            }
                            )).then((function() {
                                return i._finalize()
                            }
                            )),
                            [2]) : (this._rewardAnimationQueue.push(e),
                            [2]) : (this._logger.error("Crates button not found"),
                            [2])
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._pulseButtonAndUpdateVisuals = function() {
                    var e = this
                      , t = this._dailyChallengeService.model.data;
                    this._fillmeter.progressText.text = this._currentState.number + 1 + " / " + t.targets.length.toString();
                    var i = this._fillmeter.data.fillSize.width * ((this._currentState.number + 1) / t.targets.length);
                    return new Promise((function(t) {
                        var n = lr.gsap.timeline();
                        lr.gsap.to(e._fillmeter.progressMask, {
                            width: i,
                            ease: "back.out",
                            duration: .25,
                            onComplete: function() {
                                e._currentState.number = e._currentState.number + 1,
                                t()
                            }
                        }),
                        n.add(lr.gsap.to(e.scale, {
                            x: 1.3,
                            y: 1.3,
                            duration: .1,
                            ease: as.Yv.easeIn
                        })),
                        n.add(lr.gsap.to(e.scale, {
                            x: 1,
                            y: 1,
                            duration: .1,
                            ease: as.Yv.easeOut
                        }))
                    }
                    ))
                }
                ,
                t.prototype._updateButtonVisuals = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return this._mainButtonIconActive.visible = !1,
                            this._mainButtonIconInactive.visible = !1,
                            e = this._dailyChallengeService.model.data,
                            this._currentState.number === e.targets.length ? e.mainChallenge.collected ? (this._claimButton.visible = !0,
                            this._fillmeter.visible = !1,
                            this._claimButton.disable(),
                            this._claimButton.updateText(De.services.localization.getText(ce.DAILY_CHALLENGE_BUTTON_NEXT_IN)),
                            this._mainButtonIconInactive.visible = !0,
                            this._notificationIcon.visible = !1) : (this._claimButton.visible = !0,
                            this._claimButton.enable(),
                            this._claimButton.updateText(De.services.localization.getText(ce.ORDER_CLAIM)),
                            this._fillmeter.visible = !1,
                            this._mainButtonIconActive.visible = !0,
                            this._notificationIcon.visible = !0,
                            this._notificationIcon.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                            this._claimButton.onClick((function() {
                                return (0,
                                n.__awaiter)(t, void 0, void 0, (function() {
                                    return (0,
                                    n.__generator)(this, (function(e) {
                                        switch (e.label) {
                                        case 0:
                                            return this._dailyChallengeService.mainTaskRewardCollected(),
                                            this._claimButton.disable(),
                                            [4, this._rewardMainChallenge()];
                                        case 1:
                                            return e.sent(),
                                            this._updateButtonVisuals(),
                                            [2]
                                        }
                                    }
                                    ))
                                }
                                ))
                            }
                            ))) : (this._claimButton.visible = !1,
                            this._fillmeter.visible = !0,
                            this._notificationIcon.visible = !1,
                            this._mainButtonIconActive.visible = !0),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._rewardMainChallenge = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, this._giveReward()];
                            case 1:
                                return i.sent(),
                                this._switchBubbleParent.fire(),
                                e = (Date.now() - this._dailyChallengeService.model.data.timerStarted) / 36e5,
                                t = Math.round(100 * e) / 100,
                                De.services.analytics.design.dailyChallengeCompleted(this._dailyChallengeService.model.data.task, t),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._finalize = function() {
                    this._currentRewardAnimation = void 0,
                    this._rewardAnimationQueue.length > 0 && this._onRewardReady(this._rewardAnimationQueue.shift())
                }
                ,
                t.prototype._createTimerVisuals = function() {
                    var e = De.services.resource.getSprite(f.BG_BUTTON_HUD_DAILYCHALLENGES_TIMER);
                    e.anchor.set(.5);
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 80,
                        fitWidth: 140
                    });
                    return t.style = vn.lightSmall,
                    this._timerText = new v.Label("00 00",t),
                    this._timerText.anchor.set(.5),
                    e.addChild(this._timerText),
                    e
                }
                ,
                t.prototype._onUpdate = function() {
                    this._timerText.text = r.StringUtility.formatMilliseconds(this._timer.remainingTime, {
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        },
                        showSecondsBelowMilliseconds: 36e5
                    })
                }
                ,
                t.prototype._createClaimButton = function() {
                    return new fr({
                        name: "DailyChallengeClaimButton",
                        buttonIdle: f.BTN_BUTTON_HUD_DAILYCHALLENGES_IDLE,
                        buttonActive: f.BTN_BUTTON_HUD_DAILYCHALLENGES_ACTIVE,
                        buttonInactive: f.ICON_BUTTON_HUD_DAILYCHALLENGES_PILL_NEXT
                    },{
                        buttonSizes: {
                            width: 180,
                            height: 66
                        },
                        buttonCorners: {
                            leftWidth: 0,
                            topHeight: 0,
                            rightWidth: 0,
                            bottomHeight: 0
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: ce.ORDER_CLAIM,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })
                }
                ,
                t.prototype._giveReward = function() {
                    var e = this._dailyChallengeService.model.data
                      , t = De.services.resource.getSprite(us("daily_challenge_giftbox"));
                    t.anchor.copyFrom(this._mainButtonIconActive.anchor),
                    t.position.copyFrom(this._mainButtonIconActive.position),
                    this._mainButtonIconActive.parent.addChild(t);
                    var i = {}
                      , r = De.services.blueprintCollection.getBlueprint("daily_challenge_giftbox").components.crateReward;
                    return r && (i = {
                        crateReward: (0,
                        n.__assign)((0,
                        n.__assign)({}, r), {
                            crateRewardContent: e.mainChallenge.rewards
                        })
                    }),
                    this._dependencies.services.rewardService.giveObjectRewardWithAnimation({
                        rewardBlueprintID: "daily_challenge_giftbox",
                        blueprintComponents: i,
                        container: this,
                        animationEndEvent: this._switchBubbleParent,
                        bubble: void 0,
                        bubblePosition: new Xe.Point(-350,-930),
                        image: t
                    })
                }
                ,
                t
            }(hr);
            !function(e) {
                e[e.AVAILABLE = 0] = "AVAILABLE",
                e[e.STARTABLE = 1] = "STARTABLE",
                e[e.IN_PROGRESS = 2] = "IN_PROGRESS",
                e[e.COMPLETE = 3] = "COMPLETE"
            }(ps || (ps = {}));
            var fs, Es = function(e) {
                function t(t) {
                    var i = this
                      , n = De.services.resource.getTexture(f.OVERLAY_LEFT_BUTTONBACKGROUND)
                      , r = new cr(n,1,n.height / 2,n.width - 1,n.height / 2);
                    return r.width = 200,
                    r.anchor.set(.5),
                    r.position.set(-15, 0),
                    (i = e.call(this, {
                        name: "orders",
                        buttonIdle: f.BTN_HUD_DEFAULT_IDLE,
                        buttonActive: f.BTN_HUD_DEFAULT_DOWN,
                        targetPressedScale: 1.316,
                        backdropContent: [r],
                        uiHeight: 200
                    }) || this).addContent(rr(De.services.resource.getSprite(f.ICON_BUTTON_HUD_ORDERS), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    i._ordersService = t.services.ordersService,
                    i._setNotificationIcon(),
                    i._updateNotificationState(),
                    i._ordersService.onOrderStateChange.addListener(i._updateNotificationState, i),
                    i._ordersService.onNewOrder.addListener(i._updateNotificationState, i),
                    i._ordersService.onOrderRewarded.addListener(i._updateNotificationState, i),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return this._ordersService.getCurrentOrders().length > 0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    this._ordersService.onOrderStateChange.removeListener(this._updateNotificationState, this),
                    this._ordersService.onNewOrder.removeListener(this._updateNotificationState, this),
                    this._ordersService.onOrderRewarded.removeListener(this._updateNotificationState, this)
                }
                ,
                t.prototype._setNotificationIcon = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._notificationIcon = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                                this._notificationIcon.position.set(this.width / 4 - 7, -this.height / 4.5 + 10),
                                this.addChild(this._notificationIcon),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return e.sent(),
                                this._updateNotificationState(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateNotificationState = function() {
                    this._notificationIcon.visible = !1;
                    for (var e = 0, t = this._ordersService.getBuildingsWithActiveOrders(); e < t.length; e++) {
                        var i = t[e]
                          , n = this._ordersService.getOrderByBuilding(i);
                        if (n) {
                            if (n.state === ps.COMPLETE) {
                                this._notificationIcon.state.setAnimation(0, V.NOTIFICATION_CHECKMARK_ORDERSBUTTON, !0),
                                this._notificationIcon.visible = !0;
                                break
                            }
                            if (n.state === ps.STARTABLE) {
                                this._notificationIcon.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                                this._notificationIcon.visible = !0;
                                continue
                            }
                        }
                    }
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    this.onClick((function() {
                        e.services.interactionService.canInteractWithHUD() && (e.events.openOrders.fire(),
                        e.events.hudElementClicked.fire())
                    }
                    ))
                }
                ,
                t
            }(hr), ms = .58, ys = function(e) {
                function t(t, i) {
                    void 0 === i && (i = !1);
                    var n = e.call(this) || this;
                    return n.onButtonClick = new r.Event,
                    n._notification = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    n._textAnimation = null,
                    n._textAnimationTimeline = lr.gsap.timeline(),
                    n._currentState = {
                        number: 0
                    },
                    n._resourceService = De.services.resource,
                    n._uiContainer = n._createBasicCounter(t, i),
                    i ? n._createPurchaseButton() : n._setUpInputBlocker(),
                    n.addChild(n._uiContainer),
                    n._notification.position.set(132, -15),
                    n
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "widthWithoutNotification", {
                    get: function() {
                        return 288
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.showNotification = function() {
                    this._notification.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !0),
                    this.addChild(this._notification)
                }
                ,
                t.prototype.hideNotification = function() {
                    this._notification.state.clearTracks(),
                    this.removeChild(this._notification)
                }
                ,
                t.prototype.destroy = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    e.prototype.destroy.apply(this, t),
                    this.onButtonClick.removeAllListeners()
                }
                ,
                t.prototype._updateLabel = function(e, t, i, n) {
                    var r = this;
                    void 0 === n && (n = 0),
                    this._textAnimationTimeline.kill(),
                    this._textAnimationTimeline = lr.gsap.timeline();
                    var o = this._currentState.number;
                    this._textAnimation && (this._textAnimation.kill(),
                    this._textAnimation = null,
                    this._textAnimationTimeline.add(lr.gsap.fromTo(this._currentState, {
                        number: o
                    }, {
                        number: e - (e - t),
                        duration: n + .15,
                        onUpdateParams: [this._currentState]
                    }))),
                    this._textAnimation = lr.gsap.fromTo(this._currentState, {
                        number: t
                    }, {
                        number: e,
                        snap: "text",
                        duration: .366,
                        onUpdateParams: [this._currentState]
                    }),
                    this._textAnimationTimeline.add(lr.gsap.to(this._icon.scale, {
                        x: 1.14,
                        y: 1.14,
                        duration: .166,
                        ease: as.Yv.easeIn
                    }), n),
                    this._textAnimationTimeline.add(lr.gsap.to(this._icon.scale, {
                        x: ms,
                        y: ms,
                        duration: .166,
                        ease: as.Yv.easeOut
                    })),
                    this._textAnimationTimeline.add(this._textAnimation, n),
                    this._textAnimationTimeline.eventCallback("onUpdate", (function() {
                        o !== r._currentState.number && (r._label.text = i ? "".concat(Math.floor(r._currentState.number), "/").concat(i) : "".concat(Math.floor(r._currentState.number)))
                    }
                    )),
                    this._textAnimationTimeline.eventCallback("onComplete", (function() {
                        r._textAnimationTimeline.kill(),
                        r._textAnimation = null
                    }
                    ))
                }
                ,
                t.prototype._createBasicCounter = function(e, t) {
                    var i = new Xe.Container
                      , n = De.services.resource.getTexture(f.OVERLAY_TOP_COUNTERBACKGROUND)
                      , r = new cr(n,n.width / 2,n.height / 2,n.width / 2,n.height / 2);
                    r.width = 288,
                    r.anchor.set(.5),
                    i.addChild(r),
                    this._icon = rr(this._resourceService.getSprite(e), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: ms,
                            y: ms
                        }
                    }),
                    this._icon.position.set(this._icon.width / 2 - 144 + 10, 0),
                    i.addChild(this._icon);
                    var o = new v.LabelSettings({
                        fitWidth: t ? 125 : 200,
                        fitHeight: 100,
                        fitToBox: !0
                    });
                    o.style = vn.lightMedium;
                    var a = rr(new v.Label("0",o), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: t ? -3 : 37.5,
                            y: 0
                        }
                    });
                    return i.addChild(a),
                    this._label = a,
                    i
                }
                ,
                t.prototype._createPurchaseButton = function() {
                    var e = this
                      , t = new hr({
                        name: "hudPurchase",
                        buttonIdle: f.BTN_ADD_IDLE,
                        buttonActive: f.BTN_ADD_ACTIVE,
                        hitArea: new Xe.Rectangle(-120,-40,300,140)
                    });
                    t.position.set(144 - t.width / 2 - 6, 3),
                    t.onClick((function() {
                        e.onButtonClick.fire()
                    }
                    )),
                    this._uiContainer.addChild(t)
                }
                ,
                t.prototype._setUpInputBlocker = function() {
                    this.interactive = !0,
                    this.on("pointerdown", (function(e) {
                        e.stopPropagation()
                    }
                    ))
                }
                ,
                t
            }(Xe.Container), Ts = function(e) {
                function t() {
                    var t = e.call(this, f.ICON_COUNTER_COIN, !1) || this;
                    return t._coinItem = De.services.inventory.getInventoryItem(Cn.COINS),
                    t._coinItem.onAnimateChanges.addListener(t._onCoinsChanged, t),
                    t._coinItem.onAnimateChanges.addListener(t._onCoinsChangedSound, t),
                    t._updateLabel(t._coinItem.amount, t._coinItem.amount),
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    e.prototype.destroy.apply(this, t),
                    this._coinItem.onAnimateChanges.removeListener(this._onCoinsChanged, this),
                    this._coinItem.onAnimateChanges.removeListener(this._onCoinsChangedSound, this)
                }
                ,
                t.prototype._onCoinsChanged = function(e) {
                    this._updateLabel(e.current, e.old, void 0, 0)
                }
                ,
                t.prototype._onCoinsChangedSound = function(e) {
                    var t = e.current < e.old ? m.PURCHASE_COMPLETE : m.CURRENCY_ADDED;
                    De.services.audio.playSoundEffect(t)
                }
                ,
                t
            }(ys), As = function(e) {
                function t(t) {
                    var i = e.call(this, f.ICON_COUNTER_ENERGY, !0) || this;
                    return i._events = t.events,
                    i._energyGenerator = De.services.resourceRegeneration.getGenerator(rs),
                    i.onButtonClick.addListener((function() {
                        i._events.energyRequest.fire()
                    }
                    ), i),
                    i._energyItem = De.services.inventory.getInventoryItem(Cn.ENERGY),
                    i._energyItem.onAnimateChanges.addListener(i._onEnergyChanged, i),
                    i._updateLabel(i._energyItem.amount, i._energyItem.amount, i._energyGenerator.maxAmount),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    e.prototype.destroy.apply(this, t),
                    this._energyItem.onAnimateChanges.removeListener(this._onEnergyChanged, this)
                }
                ,
                t.prototype._onEnergyChanged = function(e) {
                    this._updateLabel(e.current, e.old, this._energyGenerator.maxAmount, 0)
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    this.onButtonClick.addListener((function() {
                        e.services.interactionService.canInteractWithHUD() && (e.services.marketplaceService.openMarketplaceShop(Ua.ENERGY),
                        e.events.hudElementClicked.fire())
                    }
                    ), null)
                }
                ,
                t
            }(ys), Cs = function(e) {
                function t(t) {
                    var i = e.call(this, f.ICON_COUNTER_GEM, !0) || this;
                    return i._gemItem = De.services.inventory.getInventoryItem(Cn.GEMS),
                    i._gemItem.onAnimateChanges.addListener(i._onGemsChanged, i),
                    i._updateLabel(i._gemItem.amount, i._gemItem.amount),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    e.prototype.destroy.apply(this, t),
                    this._gemItem.onAnimateChanges.removeListener(this._onGemsChanged, this)
                }
                ,
                t.prototype._onGemsChanged = function(e) {
                    this._updateLabel(e.current, e.old, void 0, 0)
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    this.onButtonClick.addListener((function() {
                        e.services.interactionService.canInteractWithHUD() && (e.services.marketplaceService.openMarketplaceShop(Ua.GEMS),
                        e.events.hudElementClicked.fire())
                    }
                    ), null)
                }
                ,
                t
            }(ys), Is = function() {
                function e(e) {
                    var t;
                    this._logger = Ie.Of("StateMachine", ((t = {})[Ae.INFO] = ["color: white", "background: #8f8f8f"],
                    t)),
                    this._target = e,
                    this._currentState = void 0,
                    this._previousState = void 0
                }
                return Object.defineProperty(e.prototype, "target", {
                    get: function() {
                        return this._target
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "currentState", {
                    get: function() {
                        return this._currentState
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "previousState", {
                    get: function() {
                        return this._previousState
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.changeStateTo = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i = this;
                        return (0,
                        n.__generator)(this, (function(r) {
                            switch (r.label) {
                            case 0:
                                return t = function() {
                                    return (0,
                                    n.__awaiter)(i, void 0, void 0, (function() {
                                        var t, i;
                                        return (0,
                                        n.__generator)(this, (function(n) {
                                            switch (n.label) {
                                            case 0:
                                                return [4, e.enter()];
                                            case 1:
                                                return n.sent(),
                                                this._previousState = this.currentState,
                                                this._currentState = e,
                                                this._logger.info("State was changed! Previous: ".concat(null === (t = this._previousState) || void 0 === t ? void 0 : t.constructor.name, ", Current ").concat(null === (i = this._currentState) || void 0 === i ? void 0 : i.constructor.name)),
                                                [2]
                                            }
                                        }
                                        ))
                                    }
                                    ))
                                }
                                ,
                                this._currentState ? [4, this._currentState.exit()] : [3, 3];
                            case 1:
                                return r.sent(),
                                [4, t()];
                            case 2:
                                return r.sent(),
                                [3, 5];
                            case 3:
                                return [4, t()];
                            case 4:
                                r.sent(),
                                r.label = 5;
                            case 5:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), Ss = [{
                name: "animateIn",
                duration: 1,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "power2.out",
                        params: {
                            alpha: 0
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "power2.out",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: .28,
                        duration: .72,
                        ease: "back.out",
                        params: {
                            position: {
                                x: 0,
                                y: "+=400"
                            }
                        }
                    }]
                }
            }], Os = [{
                name: "animateOut",
                duration: 1,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 1,
                        ease: "back.in",
                        params: {
                            position: {
                                x: 0,
                                y: "-=400"
                            }
                        }
                    }]
                }
            }];
            !function(e) {
                e[e.HIDDEN = 0] = "HIDDEN",
                e[e.SHOWING = 1] = "SHOWING",
                e[e.IDLE = 2] = "IDLE",
                e[e.HIDING = 3] = "HIDING"
            }(fs || (fs = {}));
            var bs, Rs, ws, Ds, Ns, Ls, Bs = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    i.onClosed = new r.Event,
                    i.priority = _r.TOAST,
                    i._toastState = fs.HIDDEN,
                    i._content = new Xe.Container;
                    var n = De.services.resource.getTexture(f.POPUP_NOTIFICATION_9SLICE);
                    i._background = new cr(n,10,10,10,10);
                    var o = De.services.canvas
                      , a = i._options.width || 746
                      , s = i._options.height || 182;
                    return i._background.setSizes({
                        width: a,
                        height: s
                    }),
                    i._background.anchor.set(.5, .5),
                    i.x = 0,
                    i.y = o.top - s,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e) {
                    e()
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.beforeShow = function(t) {
                    this.addChild(this._background),
                    this.addChild(this._content),
                    e.prototype.beforeShow.call(this, t)
                }
                ,
                t.prototype.show = function(e) {
                    var t = this;
                    this._startShowAnimation().then((function() {
                        t.interactive = !0,
                        t.once("pointerdown", t.close, t)
                    }
                    )).then((function() {
                        return r.TimeDelay.after(5e3).promise
                    }
                    )).then((function() {
                        t._toastState === fs.IDLE && t.close()
                    }
                    )),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._startHideAnimation().then((function() {
                                e.onClosed.fire(e)
                            }
                            )).catch((function(e) {}
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype.resize = function() {}
                ,
                t.prototype._startShowAnimation = function() {
                    var e = this;
                    if (this._toastState !== fs.HIDDEN)
                        return Promise.reject();
                    this._toastState = fs.SHOWING;
                    var t = new ur(Ss);
                    return t.setTargets({
                        container: this
                    }),
                    t.play("animateIn"),
                    new Promise((function(i) {
                        t.onEnd.addListener((function() {
                            e._toastState = fs.IDLE,
                            t.dispose(),
                            i()
                        }
                        ), null)
                    }
                    ))
                }
                ,
                t.prototype._startHideAnimation = function() {
                    var e = this;
                    if (this._toastState !== fs.IDLE)
                        return Promise.reject();
                    this._toastState = fs.HIDING;
                    var t = new ur(Os);
                    return t.setTargets({
                        container: this
                    }),
                    t.play("animateOut"),
                    new Promise((function(i) {
                        t.onEnd.addListener((function() {
                            e._toastState = fs.HIDDEN,
                            t.dispose(),
                            i()
                        }
                        ), null)
                    }
                    ))
                }
                ,
                t
            }(v.View), Ps = [{
                name: "spawn",
                duration: .4,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.out",
                        params: {
                            alpha: 1,
                            scale: {
                                x: .4,
                                y: .4
                            },
                            position: {
                                x: "$appear",
                                y: "$appear"
                            }
                        }
                    }],
                    middlePoint: [],
                    endPoint: [],
                    appear: []
                }
            }, {
                name: "fly",
                duration: .55,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: .72,
                        ease: "linear.in",
                        params: {
                            position: {
                                x: "$middlePoint"
                            }
                        }
                    }, {
                        time: .72,
                        duration: .28,
                        ease: "power1.in",
                        params: {
                            position: {
                                x: "$endPoint"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .72,
                        ease: "power2.in",
                        params: {
                            position: {
                                y: "$middlePoint"
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "linear.in",
                        params: {
                            scale: {
                                x: .25,
                                y: .25
                            }
                        }
                    }, {
                        time: .72,
                        duration: .28,
                        ease: "linear.in",
                        params: {
                            position: {
                                y: "$endPoint"
                            }
                        }
                    }, {
                        time: .9,
                        duration: .1,
                        ease: "linear.in",
                        params: {
                            alpha: 0
                        }
                    }],
                    middlePoint: [],
                    endPoint: [],
                    appear: []
                }
            }], ks = .9 * Math.PI / 4, xs = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._iconContainer = new Xe.Container,
                    i._rewardIcon = f.ICON_BTN_CRATE_SPAWN,
                    i._animationTimelineConfig = (0,
                    n.__spreadArray)([], Ps, !0),
                    i._animationResources = [],
                    i._createAvatar(t),
                    i._createDescription(t),
                    i._createReward(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._startShowAnimation = function() {
                    var t = this;
                    return this._animationResources = this._createAnimationResources(),
                    this._setupAnimationEventListeners(),
                    e.prototype._startShowAnimation.call(this).then((function() {
                        t.playAnimation()
                    }
                    ))
                }
                ,
                t.prototype._createAvatar = function(e) {
                    var t = e.playerAvatarSprite;
                    this._content.addChild(rr(t, {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: -280,
                            y: 0
                        }
                    }))
                }
                ,
                t.prototype._createDescription = function(e) {
                    var t = e.playerName
                      , i = e.description;
                    this._content.addChild(rr(new Xe.Text(t,vn.darkMedium), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -40
                        }
                    }));
                    var n = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 80,
                        fitWidth: this._background.width - 350
                    });
                    n.style = vn.greySmall,
                    this._content.addChild(rr(new v.Label(i,n), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 35
                        }
                    }))
                }
                ,
                t.prototype._createReward = function(e) {
                    var t = e.reward;
                    this._content.addChild(this._iconContainer),
                    this._iconContainer.position.set(260, 0),
                    this._spineIcon = De.services.resource.getSpine(se.CRATES_ADDED_UI),
                    this._spineIcon.position.set(0, 65),
                    this._iconContainer.addChild(this._spineIcon),
                    this._iconContainer.addChild(rr(new Xe.Sprite(t.amountBackgroundTexture), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: .8,
                            y: .8
                        },
                        position: {
                            x: 50,
                            y: 40
                        }
                    })),
                    this._iconContainer.addChild(rr(new Xe.Text("+".concat(t.amount),vn.lightExtraSmall), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 50,
                            y: 40
                        }
                    }))
                }
                ,
                t.prototype.playAnimation = function() {
                    this._spineIcon.state.setAnimation(0, D.CRATES_ADDED_UI, !1);
                    for (var e = 0, t = this._animationResources; e < t.length; e++)
                        t[e].timeline.play("spawn")
                }
                ,
                t.prototype._createAnimationResources = function() {
                    for (var e = [], t = this._calculatePosition(this.parent, this._spineIcon), i = 0; i < 3; i++) {
                        var n = this.parent.addChild(De.services.resource.getSprite(this._rewardIcon));
                        n.position.set(t.x, t.y + 320),
                        n.anchor.set(.5, .5),
                        n.alpha = 0;
                        var r = i * ks - 2 * ks * .5 - .25
                          , o = 175 * Math.sin(r) + n.x
                          , a = 175 * Math.cos(r) + n.y
                          , s = (3 - (i + 1)) / 6;
                        this._animationTimelineConfig[1].duration = .55 + s;
                        var _ = new ur(Ps);
                        _.setTargets({
                            container: n,
                            appear: {
                                position: {
                                    x: o,
                                    y: a
                                }
                            },
                            middlePoint: {
                                position: {
                                    x: this.position.x + this.width / 2,
                                    y: -25
                                }
                            },
                            endPoint: {
                                position: {
                                    x: this._options.buttonPosition.x,
                                    y: this._options.buttonPosition.y
                                }
                            }
                        }),
                        e.push({
                            timeline: _,
                            crate: n
                        })
                    }
                    return e
                }
                ,
                t.prototype._setupAnimationEventListeners = function() {
                    for (var e = this, t = this._animationResources.length, i = function(i) {
                        var n = i.timeline
                          , r = i.crate;
                        n.onEnd.addListener((function(i) {
                            switch (i) {
                            case "spawn":
                                n.play("fly");
                                break;
                            case "fly":
                                t--,
                                e._onAnimationCompleted(r, n, t === e._animationResources.length - 1)
                            }
                        }
                        ), null)
                    }, n = 0, r = this._animationResources; n < r.length; n++)
                        i(r[n])
                }
                ,
                t.prototype._onAnimationCompleted = function(e, t, i) {
                    e.destroy(),
                    t.dispose(),
                    i && this._options.onShown()
                }
                ,
                t.prototype._calculatePosition = function(e, t, i) {
                    return void 0 === i && (i = new Xe.Point(0,0)),
                    t !== e && t ? (i.x += t.x,
                    i.y += t.y,
                    this._calculatePosition(e, t.parent, i)) : i
                }
                ,
                t
            }(Bs), Gs = function() {
                function e(e) {
                    this._logger = Ie.Of("State"),
                    this._stateMachine = e
                }
                return Object.defineProperty(e.prototype, "stateMachine", {
                    get: function() {
                        return this._stateMachine
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e
            }(), Us = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.enter = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.stateMachine.cratesButton.hideRVButton(),
                            this.stateMachine.cratesButton.showSpawnCrateButton(),
                            this.stateMachine.cratesButton.hideTimeIndicator(),
                            this.stateMachine.cratesButton.onClick(this._onClick.bind(this)),
                            De.services.inventory.getInventoryItem(Cn.CRATES).onAnimateChanges.addListener(this._onAmountChanged, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.exit = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.stateMachine.cratesButton.onClick((function() {}
                            )),
                            De.services.inventory.getInventoryItem(Cn.CRATES).onAnimateChanges.removeListener(this._onAmountChanged, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onClick = function() {
                    this.stateMachine.dependencies.events.hudElementClicked.fire()
                }
                ,
                t.prototype._onAmountChanged = function(e) {
                    this.stateMachine.updateCratesAmountText(e)
                }
                ,
                t
            }(Gs), Fs = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onClick = function() {
                    this.stateMachine.dependencies.events.spawnCrates.fire({}),
                    e.prototype._onClick.call(this)
                }
                ,
                t.prototype._onAmountChanged = function(t) {
                    e.prototype._onAmountChanged.call(this, t),
                    t.current < this.stateMachine.dependencies.crateRegeneration.maxAmount && this.stateMachine.changeStateTo(new Vs(this.stateMachine))
                }
                ,
                t
            }(Us), Ms = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.enter = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e.prototype.enter.call(this),
                            this.stateMachine.cratesButton.showTimeIndicator(),
                            this.stateMachine.updateTimeIndicator(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onAmountChanged = function(t) {
                    e.prototype._onAmountChanged.call(this, t),
                    t.current >= this.stateMachine.dependencies.crateRegeneration.maxAmount ? this._cratesAtOrOverLimit() : t.current > 0 ? this._cratesUnderLimit() : t.current <= 0 && this._cratesEmpty()
                }
                ,
                t.prototype._cratesAtOrOverLimit = function() {
                    this.stateMachine.changeStateTo(new Fs(this.stateMachine))
                }
                ,
                t.prototype._cratesUnderLimit = function() {
                    var e = new Vs(this.stateMachine);
                    this.stateMachine.changeStateTo(e)
                }
                ,
                t.prototype._cratesEmpty = function() {}
                ,
                t
            }(Us), Vs = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onClick = function() {
                    this.stateMachine.dependencies.events.spawnCrates.fire({}),
                    e.prototype._onClick.call(this)
                }
                ,
                t.prototype._cratesEmpty = function() {
                    var e = vp.platform.cratesButtonStrategy.getOutOfCrateState(this.stateMachine);
                    this.stateMachine.changeStateTo(e)
                }
                ,
                t
            }(Ms), Hs = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.enter = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return e.prototype.enter.call(this),
                            this.stateMachine.updateCratesAmountText({
                                current: De.services.inventory.getAmount(Cn.CRATES),
                                old: De.services.inventory.getAmount(Cn.CRATES)
                            }),
                            this._tryToShowToasts((function() {
                                return t._transitToNextState()
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._tryToShowToasts = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a, s, _ = this;
                        return (0,
                        n.__generator)(this, (function(c) {
                            switch (c.label) {
                            case 0:
                                return t = De.services.token.inviteFriendsClaims,
                                i = t.token,
                                0 !== (o = t.claims).length ? [3, 2] : [4, r.TimeDelay.nextFrame()];
                            case 1:
                            case 4:
                                return c.sent(),
                                e(),
                                [2];
                            case 2:
                                return [4, De.services.friends.fetchProfiles(o.map((function(e) {
                                    return {
                                        userid: e
                                    }
                                }
                                )))];
                            case 3:
                                return a = c.sent(),
                                s = o.map((function(e) {
                                    return new Promise((function(t) {
                                        var r = De.services.resource.getSprite(f.AVATAR_130)
                                          , o = "Someone"
                                          , s = a.find((function(t) {
                                            var i = t.nakamaId;
                                            return e === i
                                        }
                                        ));
                                        s && (r = s.getPhoto(),
                                        o = s.name),
                                        De.services.navigation.showToast(xs, {
                                            playerAvatarSprite: r,
                                            playerName: o,
                                            description: nr(bs || (bs = (0,
                                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.CREATES_FOR_FRIENDS_TOAST_MESSAGE),
                                            reward: {
                                                amount: _.stateMachine.inviteFriendsConfig.INVITE_FRIENDS_REWARD,
                                                amountBackgroundTexture: De.services.resource.getTexture(f.OVERLAY_BONUS_FRIEND)
                                            },
                                            buttonPosition: {
                                                x: _.stateMachine.cratesButton.x + 75,
                                                y: _.stateMachine.cratesButton.y
                                            },
                                            onShown: function() {
                                                De.services.token.removeUsedToken(e, i),
                                                De.services.inventory.addAmount(Cn.CRATES, _.stateMachine.inviteFriendsConfig.INVITE_FRIENDS_REWARD),
                                                t()
                                            }
                                        })
                                    }
                                    ))
                                }
                                )),
                                [4, Promise.all(s)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._transitToNextState = function() {
                    var e = De.services.inventory.getAmount(Cn.CRATES)
                      , t = this.stateMachine.dependencies.crateRegeneration.maxAmount;
                    if (e <= 0) {
                        var i = vp.platform.cratesButtonStrategy.getOutOfCrateState(this.stateMachine);
                        this.stateMachine.changeStateTo(i)
                    } else
                        e >= t ? this.stateMachine.changeStateTo(new Fs(this.stateMachine)) : e < t && this.stateMachine.changeStateTo(new Vs(this.stateMachine))
                }
                ,
                t
            }(Us), js = function(e) {
                function t() {
                    var t = this
                      , i = {
                        name: "spawnCrate",
                        buttonIdle: f.CRATESPAWN_IDLE
                    };
                    (t = e.call(this, i) || this)._setButtonAnimation();
                    var n = rr(De.services.resource.getSprite(f.BTN_CRATE_SPAWN), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -12
                        }
                    });
                    return t.addContent(n),
                    t._wobbleTimout = setInterval((function() {
                        t._playWobbleSpine()
                    }
                    ), 5e3),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onClick = function(t) {
                    var i = this;
                    e.prototype.onClick.call(this, t),
                    this.on("pointerdown", (function() {
                        i._playPressSpine(),
                        i._isButtonDown = !0,
                        De.services.audio.playSoundEffect(m.CRATE_TAP),
                        De.services.audio.stopSoundEffect(m.BUTTON_TAP)
                    }
                    )),
                    this.on("pointerup", (function() {
                        i._isButtonDown && (i._playReleaseSpine(),
                        i._resetWobbleTimer())
                    }
                    )),
                    this.on("pointerupoutside", (function() {
                        i._isButtonDown && (i._playReleaseSpine(),
                        i._resetWobbleTimer())
                    }
                    ))
                }
                ,
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    clearInterval(this._wobbleTimout)
                }
                ,
                t.prototype.playCratesAddedAnimation = function() {
                    this._crateAnimation.state.setAnimation(1, "crates_added", !1),
                    this.children.includes(this._crateAnimation) || this.addChild(this._crateAnimation)
                }
                ,
                t.prototype._setButtonAnimation = function() {
                    var e = this;
                    this._crateAnimation = De.services.resource.getSpine(se.CRATE_BUTTON),
                    this._resetWobbleTimer(),
                    this._isButtonDown = !1,
                    this._crateAnimation.stateData.setMix("crate_release", "crate_press", .25),
                    this._crateAnimation.stateData.setMix("crate_press", "crate_release", .25),
                    this._crateAnimation.stateData.setMix("crates_added", "crates_added", .25),
                    this._crateAnimation.stateData.setMix("crate_wobble", "crate_press", .25),
                    this._crateAnimation.state.addListener({
                        complete: function() {
                            e._buttonIdle.scale.set(.9)
                        }
                    })
                }
                ,
                t.prototype._playPressSpine = function() {
                    this._crateAnimation.state.clearTrack(1),
                    this._crateAnimation.state.setAnimation(0, "crate_press", !1),
                    this.children.includes(this._crateAnimation) || this.addChild(this._crateAnimation)
                }
                ,
                t.prototype._playReleaseSpine = function() {
                    this._crateAnimation.state.setAnimation(0, "crate_release", !1)
                }
                ,
                t.prototype._resetWobbleTimer = function() {
                    var e = this;
                    clearInterval(this._wobbleTimout),
                    this._wobbleTimout = setInterval((function() {
                        e._playWobbleSpine()
                    }
                    ), 5e3),
                    this._isButtonDown = !1
                }
                ,
                t.prototype._playWobbleSpine = function() {
                    De.services.inventory.hasInventoryItem(Cn.CRATES) && (De.services.inventory.getAmount(Cn.CRATES) < 1 || this._isButtonDown || (this._resetWobbleTimer(),
                    this._buttonIdle.scale.set(.2),
                    this._crateAnimation.state.setAnimation(0, "crate_wobble", !1),
                    this.children.includes(this._crateAnimation) || this.addChild(this._crateAnimation)))
                }
                ,
                t
            }(hr), Ks = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._rvRewardAmount = t,
                    i._addSpawnCrateButton(),
                    i._addCrateCounter(),
                    i._addRvButton(),
                    i._addTimeIndicator(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onClick = function(e) {
                    this._spawnCrateButton.onClick(e)
                }
                ,
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    this._spawnCrateButton.destroy()
                }
                ,
                t.prototype.updateAmount = function(e, t, i) {
                    e > t ? (this._spawnCrateButton.playCratesAddedAnimation(),
                    this.animateCounter(e, t, i)) : this._cratesAmountText.text = "".concat(e, "/").concat(i)
                }
                ,
                t.prototype.animateCounter = function(e, t, i) {
                    var n = this;
                    this._spawnCrateButton.interactive = !1;
                    var r = lr.gsap.timeline();
                    r.add(lr.gsap.to(this._cratesAmountText.scale, {
                        x: 1.3,
                        y: 1.3,
                        duration: .233,
                        ease: as.Yv.easeIn
                    })),
                    r.add(lr.gsap.to(this._cratesAmountText.scale, {
                        x: 1,
                        y: 1,
                        duration: .233,
                        ease: as.Yv.easeOut
                    })),
                    r.add(lr.gsap.fromTo(this._cratesAmountText, {
                        text: t.toString()
                    }, {
                        text: e.toString(),
                        snap: "text",
                        duration: .466
                    }), 0),
                    r.eventCallback("onUpdate", (function() {
                        n._cratesAmountText.text = "".concat(n._cratesAmountText.text, "/").concat(i)
                    }
                    )),
                    r.eventCallback("onComplete", (function() {
                        r.kill(),
                        n._spawnCrateButton.interactive = !0
                    }
                    ))
                }
                ,
                t.prototype.updateTimer = function(e, t) {
                    this._cratesToAddText.text = nr(Rs || (Rs = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.CRATES_TIMER, e),
                    this._timerText.text = t
                }
                ,
                t.prototype.showSpawnCrateButton = function() {
                    this._spawnCrateButton.visible = !0
                }
                ,
                t.prototype.hideSpawnCrateButton = function() {
                    this._spawnCrateButton.visible = !1
                }
                ,
                t.prototype.showTimeIndicator = function() {
                    this._timeIndicator.visible = !0,
                    this._crateAmountIndicator.position.set(0, 82)
                }
                ,
                t.prototype.hideTimeIndicator = function() {
                    this._timeIndicator.visible = !1,
                    this._crateAmountIndicator.position.set(0, 100)
                }
                ,
                t.prototype.showRvbutton = function() {
                    this._rvContainer.visible = !0
                }
                ,
                t.prototype.hideRVButton = function() {
                    this._rvContainer.visible = !1
                }
                ,
                t.prototype._addSpawnCrateButton = function() {
                    this._spawnCrateButton = this.addChild(new js);
                    var e = new cr(De.services.resource.getTexture(f.BTN_CRATESPAWN_TIMERBG_WHITE_9SLICE),20,20,20,20);
                    e.anchor.set(.5, 1),
                    e.setSizes({
                        width: 190,
                        height: 110
                    }),
                    e.position.set(0, 160),
                    this.addChild(e),
                    this.hideSpawnCrateButton()
                }
                ,
                t.prototype._addCrateCounter = function() {
                    this._crateAmountIndicator = this.addChild(new Xe.Container);
                    var e = new v.LabelSettings({
                        fitToBox: !1,
                        fitHeight: 100,
                        fitWidth: 175
                    });
                    e.style = vn.darkMedium,
                    this._cratesAmountText = new v.Label("0",e),
                    this._cratesAmountText.anchor.set(.5, .5),
                    this._crateAmountIndicator.addChild(this._cratesAmountText),
                    this._crateAmountIndicator.position.set(0, 90)
                }
                ,
                t.prototype._addTimeIndicator = function() {
                    this._timeIndicator = this.addChild(new Xe.Container);
                    var e = new cr(De.services.resource.getTexture(f.BTN_CRATESPAWN_TIMERBG_PINK_9SLICE),20,10,20,40);
                    e.anchor.set(.5, .5),
                    e.position.set(0, 5),
                    e.setSizes({
                        width: 190,
                        height: 65
                    }),
                    this._timeIndicator.addChild(e);
                    var t = new v.LabelSettings({
                        fitToBox: !1,
                        fitHeight: 100,
                        fitWidth: 175
                    });
                    t.style = vn.darkTiny,
                    this._cratesToAddText = new v.Label(nr(ws || (ws = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.CRATES_TIMER),t),
                    this._cratesToAddText.anchor.set(.5, .5),
                    this._cratesToAddText.position.set(0, -43),
                    t.style = vn.lightSmall,
                    this._timerText = new v.Label("00 00",t),
                    this._timerText.anchor.set(.5, .5),
                    this._timeIndicator.addChild(this._cratesToAddText, this._timerText),
                    this._timeIndicator.position.set(0, 162),
                    this._timeIndicator.visible = !1,
                    this.hideTimeIndicator()
                }
                ,
                t.prototype._addRvButton = function() {
                    this._rvContainer = this.addChild(new Xe.Container);
                    var e = rr(De.services.resource.getSprite(f.BTN_CRATESPAWN_VIDEOBG), {
                        anchor: {
                            x: .5,
                            y: 1
                        },
                        position: {
                            x: 0,
                            y: 200
                        }
                    })
                      , t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: 100
                    });
                    t.style = vn.buttonLabel;
                    var i = new v.Label("+" + this._rvRewardAmount,t);
                    i.anchor.set(.5, .5),
                    i.position.set(-40, 75);
                    var n = rr(De.services.resource.getSprite(f.ICON_BTN_VIDEO_WHITE), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 45,
                            y: 75
                        }
                    });
                    this._rvContainer.addChild(e, i, n),
                    this.hideRVButton()
                }
                ,
                t
            }(Xe.Container), Ws = function(e) {
                function t(t, i) {
                    var r = e.call(this, {}) || this;
                    return r.marketplaceService = i,
                    r.dependencies = t,
                    r.adsConfig = (0,
                    n.__assign)({}, De.services.resource.getJson(_e.REWARDED_VIDEOS_CONFIG)),
                    r.inviteFriendsConfig = (0,
                    n.__assign)({}, De.services.resource.getJson(_e.INVITE_FRIENDS_REWARDS_CONFIG)),
                    r.cratesButton = new Ks(r.adsConfig.RV_REWARDS),
                    r.updateTimeIndicator(),
                    r
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.dependencies.container.addChild(this.cratesButton),
                            De.services.timer.tick.addListener(this._onTick, this),
                            this.changeStateTo(new Hs(this)),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    this.cratesButton.destroy(),
                    De.services.timer.tick.removeListener(this._onTick, this)
                }
                ,
                t.prototype.resize = function(e) {
                    this.cratesButton.position.set(0, e.bounds.height / 2 - 225)
                }
                ,
                t.prototype.updateTimeIndicator = function() {
                    var e = this.dependencies.crateRegeneration
                      , t = e.timeBeforeNextSpawn
                      , i = e.amountPerInterval;
                    this.cratesButton.updateTimer(String(i), r.StringUtility.formatMilliseconds(t, {
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        }
                    }))
                }
                ,
                t.prototype.updateCratesAmountText = function(e) {
                    var t = this.dependencies.crateRegeneration.maxAmount;
                    this.cratesButton.updateAmount(e.current, e.old, t),
                    0 === e.current && De.services.analytics.design.cratesStatus(Zi.OUT_OF_CRATES)
                }
                ,
                t.prototype._onTick = function() {
                    De.services.friends.canResetInvitationCounter(De.services.timer.currentTime) && De.services.friends.resetInvitationCounter(),
                    this.dependencies.crateRegeneration.timeBeforeNextSpawn > 0 ? this.updateTimeIndicator() : this.cratesButton.hideTimeIndicator()
                }
                ,
                t
            }(Is), zs = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.enter = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.stateMachine.cratesButton.hideRVButton(),
                            this.stateMachine.cratesButton.showSpawnCrateButton(),
                            this.stateMachine.cratesButton.hideTimeIndicator(),
                            this.stateMachine.cratesButton.onClick(this._spawnCrate.bind(this)),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.exit = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.stateMachine.cratesButton.onClick((function() {}
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._spawnCrate = function() {
                    var e = this.stateMachine.crateSpawnPositions.pop();
                    e && (this.stateMachine.updateCratesAmountText({
                        current: this.stateMachine.crateSpawnPositions.length,
                        old: this.stateMachine.crateSpawnPositions.length + 1
                    }),
                    this.stateMachine.dependencies.events.spawnCrates.fire({
                        position: e
                    }),
                    this.stateMachine.dependencies.events.hudElementClicked.fire(),
                    this.stateMachine.crateSpawnCallback(e),
                    0 === this.stateMachine.crateSpawnPositions.length && this.exit())
                }
                ,
                t
            }(Gs), Ys = function(e) {
                function t(t, i) {
                    return e.call(this, t, i) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.dependencies.container.addChild(this.cratesButton),
                            this.changeStateTo(new zs(this)),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.setCrateSpawnPositionData = function(e, t) {
                    this.crateSpawnPositions = e,
                    this.crateSpawnCallback = t,
                    this.updateCratesAmountText({
                        current: e.length,
                        old: 0
                    })
                }
                ,
                t
            }(Ws), Js = [{
                name: "animateIn",
                duration: .35,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 1,
                        ease: "power2.out",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "power2.out",
                        params: {
                            pivot: {
                                x: "$arrivalPoint",
                                y: "$arrivalPoint"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "power2.out",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }],
                    arrivalPoint: []
                }
            }, {
                name: "animateOut",
                duration: .35,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 1,
                        ease: "power2.in",
                        params: {
                            alpha: .5
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "power2.in",
                        params: {
                            pivot: {
                                x: "$arrivalPoint",
                                y: "$arrivalPoint"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "power2.in",
                        params: {
                            scale: {
                                x: 1.6,
                                y: 1.6
                            }
                        }
                    }],
                    arrivalPoint: []
                }
            }], Xs = 450, qs = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._commonEvents = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "hudContainer", {
                    get: function() {
                        return this._hudContainer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.showHudElement = function(e) {
                    var t, i, n = null === (t = this._hudContainer) || void 0 === t ? void 0 : t.getUIelement(e);
                    if ((0,
                    r.isUndefined)(n) || null !== (i = n.canShow) && void 0 !== i && !i)
                        return Promise.resolve();
                    var o = n.drawer;
                    return null == o || o.elementIsShowing(n),
                    this.playAnimation(n, "animateIn", {
                        x: 0,
                        y: 0
                    })
                }
                ,
                t.prototype.hideHudElement = function(e, t) {
                    return void 0 === t && (t = !1),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, o, a;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return i = this._hudContainer.getUIelement(e),
                            (0,
                            r.isUndefined)(i) ? [2, Promise.resolve()] : (null == (o = i.drawer) || o.elementIsHiding(i),
                            a = new Xe.Point(Xs,Xs),
                            n_[e] === Ls.X_AXIS ? (a.x *= -1 * Math.sign(i.x),
                            a.y = 0) : (a.y *= -1 * Math.sign(i.y),
                            a.x = 0),
                            [2, this.playAnimation(i, "animateOut", a, t)])
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hideExtraElementsFromDrawer = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, o = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return i = this._hudContainer.getDrawerElement(e),
                            (0,
                            r.isUndefined)(i) ? [2, Promise.resolve()] : (i.extraElements.forEach((function(e) {
                                var n = new Xe.Point(Xs,Xs);
                                return i._extraElementsAnimationDirection === Ls.X_AXIS ? (n.x *= -1 * Math.sign(e.x),
                                n.y = 0) : (n.y *= -1 * Math.sign(e.y),
                                n.x = 0),
                                o.playAnimation(e, "animateOut", n, t)
                            }
                            )),
                            [2])
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showExtraElementsFromDrawer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return t = this._hudContainer.getDrawerElement(e),
                            (0,
                            r.isUndefined)(t) ? [2, Promise.resolve()] : (t.extraElements.forEach((function(e) {
                                return i.playAnimation(e, "animateIn", {
                                    x: 0,
                                    y: 0
                                })
                            }
                            )),
                            [2])
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.playAnimation = function(e, t, i, n) {
                    return new Promise((function(r) {
                        if (n)
                            return e.pivot.copyFrom(i),
                            void r();
                        var o = new ur(Js);
                        o.setTargets({
                            container: e,
                            arrivalPoint: {
                                pivot: i
                            }
                        }),
                        o.onEnd.addListener((function() {
                            o.dispose(),
                            r()
                        }
                        ), null),
                        o.play(t)
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._hudContainer = De.services.navigation.showHUD(o_, {
                                events: this._commonEvents,
                                services: this.services
                            }),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), Qs = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._logger = r.Logger.Of("HudDrawer"),
                    i._extraElements = [],
                    i._hudElements = t,
                    i._hudElements.forEach((function(e) {
                        return e.drawer = i
                    }
                    )),
                    i._hudElements.forEach((function(e, t) {
                        var r;
                        i._containerIsShowing = (0,
                        n.__assign)((0,
                        n.__assign)({}, i._containerIsShowing), ((r = {})[t] = !0,
                        r))
                    }
                    )),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "extraElements", {
                    get: function() {
                        return this._extraElements
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.elementIsShowing = function(e) {
                    this._containerIsShowing[this._hudElements.indexOf(e)] = !0,
                    this._updateDrawerVisual()
                }
                ,
                t.prototype.elementIsHiding = function(e) {
                    this._containerIsShowing[this._hudElements.indexOf(e)] = !1,
                    this._updateDrawerVisual()
                }
                ,
                t
            }(Xe.Container), Zs = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._extraElementsAnimationDirection = Ls.Y_AXIS,
                    i._asset = f.OVERLAY_BOTTOM_BUTTONBACKGROUND,
                    i._drawerIsVisible = !0,
                    i._initialize(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.replaceCrateButton = function(e) {
                    this._hudElements.shift(),
                    this._hudElements.unshift(e),
                    this._containerIsShowing[this._hudElements.indexOf(e)] = !0,
                    e.drawer = this,
                    this._updateDrawerVisual()
                }
                ,
                t.prototype.updatePosition = function(e) {
                    this._originalDrawerPosition = new Xe.Point(-e.bounds.width / 2,e.bounds.height / 2 - 225),
                    this._drawerImage.position.copyFrom(this._originalDrawerPosition)
                }
                ,
                t.prototype.addElement = function(e) {}
                ,
                t.prototype.removeElement = function(e) {}
                ,
                t.prototype._updateDrawerVisual = function() {
                    var e = this;
                    this._hudElements.every((function(t) {
                        return !e._containerIsShowing[e._hudElements.indexOf(t)]
                    }
                    )) && this._drawerIsVisible ? this._hideDrawer() : this._hudElements.some((function(t) {
                        return e._containerIsShowing[e._hudElements.indexOf(t)]
                    }
                    )) && !this._drawerIsVisible && this._showDrawer()
                }
                ,
                t.prototype._showDrawer = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._drawerIsVisible || (this._drawerIsVisible = !0,
                            lr.gsap.to(this._drawerImage.position, {
                                x: this._drawerImage.position.x,
                                y: this._originalDrawerPosition.y,
                                duration: .35,
                                ease: "power2.out"
                            })),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._hideDrawer = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._drawerIsVisible ? (this._drawerIsVisible = !1,
                            lr.gsap.to(this._drawerImage.position, {
                                x: this._drawerImage.position.x,
                                y: this._drawerImage.position.y + Xs,
                                duration: .35,
                                ease: "power2.in"
                            }),
                            [2]) : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._initialize = function() {
                    var e = De.services.resource.getTexture(this._asset);
                    this._drawerImage = new cr(e,e.width / 2,e.height - 1,e.width / 2,1),
                    this._drawerImage.height = 900,
                    this._drawerImage.width = De.services.canvas.width,
                    this.addChild(this._drawerImage)
                }
                ,
                t
            }(Qs), $s = function(e) {
                function t() {
                    var t = e.call(this) || this
                      , i = De.services.canvas.currentOrientation === v.Orientation.Portrait ? De.services.resource.getTexture(f.OVERLAY_TOP_GRADIENT) : De.services.resource.getTexture(f.OVERLAY_LANDSCAPE_GRADIENT);
                    return t._topGradient = t._createTopGradient(i),
                    t._topGradient.visible = !0,
                    t.addChild(t._topGradient),
                    t._bottomGradient = t._createBottomGradient(i),
                    t._bottomGradient.visible = !1,
                    t.addChild(t._bottomGradient),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.resize = function() {
                    this._topGradient.setSizes({
                        width: De.services.canvas.width,
                        height: this._topGradient.height
                    }),
                    this._bottomGradient.setSizes({
                        width: De.services.canvas.width,
                        height: this._bottomGradient.height
                    }),
                    this._topGradient.position.set(0, De.services.canvas.top),
                    this._bottomGradient.position.set(0, De.services.canvas.bottom)
                }
                ,
                t.prototype.setTopGradientVisibilityState = function(e) {
                    this._topGradient.visible = e
                }
                ,
                t.prototype.setBottomGradientVisibilityState = function(e) {
                    this._bottomGradient.visible = e
                }
                ,
                t.prototype._createTopGradient = function(e) {
                    var t = new cr(e,1,0,1,0);
                    return t.width = De.services.canvas.width,
                    t.anchor.set(.5, 0),
                    t.position.set(0, De.services.canvas.top),
                    t
                }
                ,
                t.prototype._createBottomGradient = function(e) {
                    var t = new cr(e,1,0,1,0);
                    return t.width = De.services.canvas.width,
                    t.scale.set(1, -1),
                    t.anchor.set(.5, 0),
                    t.position.set(0, De.services.canvas.bottom),
                    t
                }
                ,
                t
            }(Xe.Container), e_ = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._extraElementsAnimationDirection = Ls.X_AXIS,
                    i._hudElements.forEach((function(e) {
                        return i.addChild(e)
                    }
                    )),
                    i._buttonIsVisible = (0,
                    n.__assign)({}, i._containerIsShowing),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.updatePosition = function(e) {
                    var t, i = -(e.bounds.width / 2 - 50), n = -(e.bounds.height / 2 - 100);
                    this.position.set(i + 150, n + 200 + ((null === (t = vp.platform.hudStrategy.drawerOffsets) || void 0 === t ? void 0 : t.topDrawer) || 0));
                    var r = this._getAllVisibleElements();
                    r.forEach((function(e, t) {
                        var i = 0 === t ? void 0 : r[t - 1]
                          , n = void 0 === i ? 40 : i.y + i.uiHeight / 2 + e.uiHeight / 2;
                        e.position.set(-110, n)
                    }
                    ))
                }
                ,
                t.prototype.addElement = function(e) {
                    this.addChild(e),
                    this._hudElements.push(e),
                    this._extraElements.push(e),
                    this._containerIsShowing[this._hudElements.indexOf(e)] = !0,
                    e.position.set(-450, 0),
                    this._updateDrawerVisual()
                }
                ,
                t.prototype.removeElement = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._hudElements.includes(e) && this._extraElements.includes(e) ? [4, this._animateButton(e, new Xe.Point(e.position.x - 500,e.position.y))] : [2];
                            case 1:
                                return t.sent(),
                                this.removeChild(e),
                                this._hudElements.splice(this._hudElements.indexOf(e), 1),
                                this._extraElements.splice(this._extraElements.indexOf(e), 1),
                                delete this._containerIsShowing[this._hudElements.indexOf(e)],
                                delete this._buttonIsVisible[this._hudElements.indexOf(e)],
                                this._updateDrawerVisual(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateDrawerVisual = function() {
                    var e = this;
                    this._hudElements.filter((function(t) {
                        return !e._containerIsShowing[e._hudElements.indexOf(t)]
                    }
                    )).forEach((function(t) {
                        e._buttonIsVisible[e._hudElements.indexOf(t)] = !1
                    }
                    ));
                    var t = this._getAllVisibleElements()
                      , i = new Map;
                    t.forEach((function(n, o) {
                        var a = 0 === o ? void 0 : t[o - 1]
                          , s = void 0 === a ? void 0 : i.get(a)
                          , _ = 40;
                        (0,
                        r.isUndefined)(s) || (0,
                        r.isUndefined)(a) || (_ = s.y + a.uiHeight / 2 + n.uiHeight / 2),
                        e._buttonIsVisible[e._hudElements.indexOf(n)] || (n.position.set(n.position.x, _),
                        e._buttonIsVisible[e._hudElements.indexOf(n)] = !0),
                        i.set(n, new Xe.Point(-110,_))
                    }
                    )),
                    i.forEach((function(t, i) {
                        e._animateButton(i, t)
                    }
                    ))
                }
                ,
                t.prototype._animateButton = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            return [2, new Promise((function(i) {
                                var n = t.y > e.position.y;
                                lr.gsap.to(e, {
                                    x: t.x,
                                    y: t.y,
                                    duration: n ? .35 : .55,
                                    ease: n ? "power2.out" : "power2.in",
                                    onComplete: i
                                })
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getAllVisibleElements = function() {
                    var e = this;
                    return this._hudElements.filter((function(t) {
                        return e._containerIsShowing[e._hudElements.indexOf(t)]
                    }
                    ))
                }
                ,
                t
            }(Qs), t_ = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._extraElementsAnimationDirection = Ls.X_AXIS,
                    i._asset = f.OVERLAY_RIGHT_BUTTONBACKGROUND,
                    i._drawerIsVisible = !0,
                    i._initialize(),
                    i._hudElements.forEach((function(e) {
                        return i._drawerImage.addChild(e)
                    }
                    )),
                    i._buttonIsVisible = (0,
                    n.__assign)({}, i._containerIsShowing),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.updatePosition = function(e) {
                    var t, i = this, n = e.bounds.width / 2 - 25, r = -(e.bounds.height / 2 - 100);
                    this._originalDrawerPosition = new Xe.Point(n - 30,r + 150 + ((null === (t = vp.platform.hudStrategy.drawerOffsets) || void 0 === t ? void 0 : t.topDrawer) || 0)),
                    this._drawerImage.position.copyFrom(this._originalDrawerPosition),
                    this._hudElements.filter((function(e) {
                        return i._containerIsShowing[i._hudElements.indexOf(e)]
                    }
                    )).forEach((function(e, t) {
                        e.position.set(50, 130 * t + 50)
                    }
                    ))
                }
                ,
                t.prototype.addElement = function(e) {}
                ,
                t.prototype.removeElement = function(e) {}
                ,
                t.prototype._updateDrawerVisual = function() {
                    var e = this;
                    this._hudElements.filter((function(t) {
                        return !e._containerIsShowing[e._hudElements.indexOf(t)]
                    }
                    )).forEach((function(t) {
                        e._buttonIsVisible[e._hudElements.indexOf(t)] = !1
                    }
                    )),
                    this._hudElements.filter((function(t) {
                        return e._containerIsShowing[e._hudElements.indexOf(t)]
                    }
                    )).forEach((function(t, i) {
                        var n = 130 * i + 50;
                        e._buttonIsVisible[e._hudElements.indexOf(t)] || (t.position.set(t.position.x, n),
                        e._buttonIsVisible[e._hudElements.indexOf(t)] = !0),
                        e._animateButton(t, new Xe.Point(50,n))
                    }
                    )),
                    this._hudElements.every((function(t) {
                        return !e._containerIsShowing[e._hudElements.indexOf(t)]
                    }
                    )) && this._drawerIsVisible ? this._hideDrawer() : (this._hudElements.some((function(t) {
                        return e._containerIsShowing[e._hudElements.indexOf(t)]
                    }
                    )) && !this._drawerIsVisible && this._showDrawer(),
                    this._updateDrawerSize())
                }
                ,
                t.prototype._animateButton = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return i = t.y > e.position.y,
                            lr.gsap.to(e, {
                                x: t.x,
                                y: t.y,
                                duration: i ? .35 : .55,
                                ease: i ? "power2.out" : "power2.in"
                            }),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateDrawerSize = function() {
                    var e = this
                      , t = this._hudElements.filter((function(t) {
                        return e._containerIsShowing[e._hudElements.indexOf(t)]
                    }
                    )).length
                      , i = 100 * t + 30 * (t - 1)
                      , n = i > this._drawerImage.height;
                    lr.gsap.to(this._drawerImage, {
                        height: i,
                        duration: n ? .35 : .55,
                        ease: n ? "power2.out" : "power2.in"
                    })
                }
                ,
                t.prototype._showDrawer = function() {
                    this._drawerIsVisible || (this._drawerIsVisible = !0,
                    lr.gsap.to(this._drawerImage.position, {
                        x: this._originalDrawerPosition.x,
                        y: this._drawerImage.position.y,
                        duration: .35,
                        ease: "power2.out"
                    }))
                }
                ,
                t.prototype._hideDrawer = function() {
                    this._drawerIsVisible && (this._drawerIsVisible = !1,
                    lr.gsap.to(this._drawerImage.position, {
                        x: this._drawerImage.position.x + Xs,
                        y: this._drawerImage.position.y,
                        duration: .35,
                        ease: "power2.in"
                    }))
                }
                ,
                t.prototype._initialize = function() {
                    var e = De.services.resource.getTexture(this._asset);
                    this._drawerImage = new cr(e,e.width - 1,e.height / 2,1,e.height / 2),
                    this._drawerImage.height = 100 * this._hudElements.length + 30 * (this._hudElements.length - 1),
                    this._drawerImage.width = 125,
                    this._drawerImage.anchor.set(.5, 0),
                    this.addChild(this._drawerImage)
                }
                ,
                t
            }(Qs);
            !function(e) {
                e[e.RankBarUI = 0] = "RankBarUI",
                e[e.CoinCounterUI = 1] = "CoinCounterUI",
                e[e.GemCounterUI = 2] = "GemCounterUI",
                e[e.EnergyCounterUI = 3] = "EnergyCounterUI",
                e[e.SettingsButtonUI = 4] = "SettingsButtonUI",
                e[e.ShovelButtonUI = 5] = "ShovelButtonUI",
                e[e.MarketplaceButtonUI = 6] = "MarketplaceButtonUI",
                e[e.CratesButtonUI = 7] = "CratesButtonUI",
                e[e.OrderButtonUI = 8] = "OrderButtonUI",
                e[e.DiscoveryButtonUI = 9] = "DiscoveryButtonUI",
                e[e.FeedbackButtonUI = 10] = "FeedbackButtonUI",
                e[e.TaskButtonUI = 11] = "TaskButtonUI",
                e[e.MailboxButtonUI = 12] = "MailboxButtonUI",
                e[e.FacebookButtonUI = 13] = "FacebookButtonUI",
                e[e.ExtraWorkerButtonUI = 14] = "ExtraWorkerButtonUI",
                e[e.SpecialOfferButtonUI = 15] = "SpecialOfferButtonUI",
                e[e.SignInBonusButtonUI = 16] = "SignInBonusButtonUI",
                e[e.DailyChallengeButtonUI = 17] = "DailyChallengeButtonUI",
                e[e.StorageButtonUI = 18] = "StorageButtonUI"
            }(Ns || (Ns = {})),
            function(e) {
                e.X_AXIS = "x_axis",
                e.Y_AXIS = "y_axis"
            }(Ls || (Ls = {}));
            var i_, n_ = ((Ds = {})[Ns.RankBarUI] = Ls.Y_AXIS,
            Ds[Ns.CoinCounterUI] = Ls.Y_AXIS,
            Ds[Ns.GemCounterUI] = Ls.Y_AXIS,
            Ds[Ns.EnergyCounterUI] = Ls.Y_AXIS,
            Ds[Ns.MarketplaceButtonUI] = Ls.Y_AXIS,
            Ds[Ns.CratesButtonUI] = Ls.Y_AXIS,
            Ds[Ns.DiscoveryButtonUI] = Ls.Y_AXIS,
            Ds[Ns.DailyChallengeButtonUI] = Ls.Y_AXIS,
            Ds[Ns.StorageButtonUI] = Ls.X_AXIS,
            Ds[Ns.OrderButtonUI] = Ls.X_AXIS,
            Ds[Ns.FeedbackButtonUI] = Ls.X_AXIS,
            Ds[Ns.SettingsButtonUI] = Ls.X_AXIS,
            Ds[Ns.ShovelButtonUI] = Ls.X_AXIS,
            Ds[Ns.MailboxButtonUI] = Ls.X_AXIS,
            Ds[Ns.FacebookButtonUI] = Ls.X_AXIS,
            Ds[Ns.ExtraWorkerButtonUI] = Ls.X_AXIS,
            Ds[Ns.TaskButtonUI] = Ls.X_AXIS,
            Ds[Ns.SpecialOfferButtonUI] = Ls.X_AXIS,
            Ds[Ns.SignInBonusButtonUI] = Ls.X_AXIS,
            Ds);
            !function(e) {
                e[e.LeftDrawer = 0] = "LeftDrawer",
                e[e.RightDrawer = 1] = "RightDrawer",
                e[e.BottomDrawer = 2] = "BottomDrawer"
            }(i_ || (i_ = {}));
            var r_, o_ = function(e) {
                function t(t) {
                    var i, n = e.call(this, {}) || this;
                    return n._shopStockListeners = [],
                    n.addServices({}),
                    n._dependencies = t,
                    vp.platform.hudStrategy.initializeElements(t),
                    n._hudGradientOverlay = new $s,
                    n._rankBar = new cs,
                    n._gemsCounter = new Cs(t),
                    n._coinsCounter = new Ts,
                    n._energyCounter = new As(t),
                    n._orderButton = new Es(t),
                    n._cratesButtonController = new Ws({
                        container: n,
                        events: t.events,
                        crateRegeneration: De.services.resourceRegeneration.getGenerator(os),
                        crateInventory: De.services.inventory.getInventoryItem(Cn.CRATES)
                    },n._dependencies.services.marketplaceService),
                    n._dailyChallengeButton = new gs(t),
                    n._createDrawers(),
                    n._addChildren(),
                    n._uiElements = ((i = {})[Ns.RankBarUI] = n._rankBar,
                    i[Ns.CoinCounterUI] = n._coinsCounter,
                    i[Ns.GemCounterUI] = n._gemsCounter,
                    i[Ns.EnergyCounterUI] = n._energyCounter,
                    i[Ns.SettingsButtonUI] = vp.platform.hudStrategy.settingsButton,
                    i[Ns.ShovelButtonUI] = vp.platform.hudStrategy.shovelButton,
                    i[Ns.MarketplaceButtonUI] = vp.platform.hudStrategy.marketplaceButton,
                    i[Ns.CratesButtonUI] = n._cratesButtonController.cratesButton,
                    i[Ns.OrderButtonUI] = n._orderButton,
                    i[Ns.DiscoveryButtonUI] = vp.platform.hudStrategy.discoveryButton,
                    i[Ns.FeedbackButtonUI] = vp.platform.hudStrategy.feedbackButton,
                    i[Ns.TaskButtonUI] = vp.platform.hudStrategy.taskButton,
                    i[Ns.MailboxButtonUI] = vp.platform.hudStrategy.mailboxButton,
                    i[Ns.FacebookButtonUI] = vp.platform.hudStrategy.facebookButton,
                    i[Ns.ExtraWorkerButtonUI] = vp.platform.hudStrategy.extraWorkerButton,
                    i[Ns.SpecialOfferButtonUI] = vp.platform.hudStrategy.specialOfferButton,
                    i[Ns.SignInBonusButtonUI] = vp.platform.hudStrategy.signInBonusButton,
                    i[Ns.DailyChallengeButtonUI] = n._dailyChallengeButton,
                    i[Ns.StorageButtonUI] = vp.platform.hudStrategy.storageButton,
                    i),
                    n.resize({
                        bounds: De.services.canvas.bounds,
                        orientation: De.services.canvas.currentOrientation
                    }),
                    De.services.adsService.onBannerStart.addListener(n._resizedByBanner, n),
                    De.services.adsService.onBannerFinish.addListener(n._resizedByBanner, n),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.onDestroy = function() {
                    De.services.adsService.onBannerFinish.removeListener(this._resizedByBanner, this),
                    De.services.adsService.onBannerStart.removeListener(this._resizedByBanner, this),
                    this._shopStockListeners.forEach((function(e) {
                        var t = e.event
                          , i = e.callback;
                        t.removeListener(i, void 0)
                    }
                    ))
                }
                ,
                t.prototype.show = function(e) {
                    this.resize({
                        bounds: De.services.canvas.bounds,
                        orientation: De.services.canvas.currentOrientation
                    }),
                    this._setUpShopStockListeners(Ua.GEMS, this._gemsCounter),
                    this._setUpShopStockListeners(Ua.ENERGY, this._energyCounter),
                    this._cratesButtonController.initialize().then(e)
                }
                ,
                t.prototype.hide = function(e) {
                    this._cratesButtonController.destroy(),
                    e()
                }
                ,
                t.prototype.resize = function(e) {
                    var t, i, n, o = e.bounds.width, a = e.bounds.height, s = De.services.canvas.height / window.innerHeight, _ = 50 + ((null === (t = vp.platform.hudStrategy.drawerOffsets) || void 0 === t ? void 0 : t.leftDrawer) || 0), c = 25 + ((null === (i = vp.platform.hudStrategy.drawerOffsets) || void 0 === i ? void 0 : i.rightDrawer) || 0), l = 100 + ((null === (n = vp.platform.hudStrategy.drawerOffsets) || void 0 === n ? void 0 : n.topDrawer) || 0), u = 70 * s * 2, d = 0;
                    De.services.adsService.isBannerAdsSupported() && De.services.adsService.adsEnabled && De.services.adsService.bannerAdShouldDisplace && (d = De.services.adsService.isBannerAdActive() ? u : 0),
                    e.bounds.height -= d;
                    var h = -(o / 2 - _)
                      , p = o / 2 - c
                      , g = -(a / 2 - l)
                      , f = (a - d) / 2 - 50;
                    if (this._cratesButtonController.resize(e),
                    this._energyCounter.x = p - this._energyCounter.widthWithoutNotification / 2,
                    this._energyCounter.y = g,
                    this._gemsCounter.x = this._energyCounter.x - this._gemsCounter.widthWithoutNotification - _,
                    this._gemsCounter.y = g,
                    this._coinsCounter.x = this._gemsCounter.x - this._coinsCounter.widthWithoutNotification - _,
                    this._coinsCounter.y = g,
                    this._rankBar.x = h - 50,
                    this._rankBar.y = g - 50,
                    (0,
                    r.isUndefined)(vp.platform.hudStrategy.discoveryButton) || (vp.platform.hudStrategy.discoveryButton.x = p - 85,
                    vp.platform.hudStrategy.discoveryButton.y = f - 75),
                    this._dailyChallengeButton.x = p - 250,
                    this._dailyChallengeButton.y = f - 75,
                    (0,
                    r.isUndefined)(vp.platform.hudStrategy.storageButton) || (vp.platform.hudStrategy.storageButton.x = p - 85,
                    vp.platform.hudStrategy.storageButton.y = f - 300),
                    (0,
                    r.isUndefined)(vp.platform.hudStrategy.marketplaceButton) || (vp.platform.hudStrategy.marketplaceButton.x = h + 55,
                    vp.platform.hudStrategy.marketplaceButton.y = f - 75),
                    (0,
                    r.isUndefined)(vp.platform.hudStrategy.specialOfferButton) || (vp.platform.hudStrategy.specialOfferButton.x = h + 55,
                    vp.platform.hudStrategy.specialOfferButton.y = f - 75 - vp.platform.hudStrategy.specialOfferButton.height - 10),
                    Object.values(this._uiDrawers).forEach((function(t) {
                        return t.updatePosition(e)
                    }
                    )),
                    (0,
                    r.isUndefined)(vp.platform.hudStrategy.signInBonusButton) || (vp.platform.hudStrategy.signInBonusButton.x = h + 55,
                    vp.platform.hudStrategy.signInBonusButton.y = f - 75 - vp.platform.hudStrategy.signInBonusButton.height - 10),
                    this._hudGradientOverlay.resize(),
                    De.services.canvas.targetOrientation === v.Orientation.Landscape) {
                        this._hudGradientOverlay.setBottomGradientVisibilityState(!0);
                        var E = this.getDrawerElement(i_.BottomDrawer);
                        (0,
                        r.isUndefined)(E) || (E.visible = !1)
                    }
                }
                ,
                t.prototype.getUIelement = function(e) {
                    return this._uiElements[e]
                }
                ,
                t.prototype.getAllUIElements = function() {
                    return this._uiElements
                }
                ,
                t.prototype.getDrawerElement = function(e) {
                    return this._uiDrawers[e]
                }
                ,
                t.prototype.getAllUIDrawers = function() {
                    return Object.values(this._uiDrawers)
                }
                ,
                t.prototype.setOnboardingCratesButtonController = function() {
                    var e, t, i;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return r = null === (e = this._cratesButtonController) || void 0 === e ? void 0 : e.dependencies,
                            null === (t = this._cratesButtonController) || void 0 === t || t.destroy(),
                            this._cratesButtonController = new Ys(r,this._dependencies.services.marketplaceService),
                            this._uiElements[Ns.CratesButtonUI] = this._cratesButtonController.cratesButton,
                            this._cratesButtonController.resize({
                                bounds: De.services.canvas.bounds,
                                orientation: De.services.canvas.currentOrientation
                            }),
                            null === (i = this.getDrawerElement(i_.BottomDrawer)) || void 0 === i || i.replaceCrateButton(this._cratesButtonController.cratesButton),
                            [2, this._cratesButtonController.initialize()]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.setCrateSpawnData = function(e, t) {
                    this._isOnboardingController(this._cratesButtonController) && this._cratesButtonController.setCrateSpawnPositionData(e, t)
                }
                ,
                t.prototype.setDefaultCratesButtonController = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return t = this._cratesButtonController.dependencies,
                            this._cratesButtonController.destroy(),
                            this._cratesButtonController = new Ws(t,this._dependencies.services.marketplaceService),
                            this._uiElements[Ns.CratesButtonUI] = this._cratesButtonController.cratesButton,
                            this._cratesButtonController.resize({
                                bounds: De.services.canvas.bounds,
                                orientation: De.services.canvas.currentOrientation
                            }),
                            null === (e = this.getDrawerElement(i_.BottomDrawer)) || void 0 === e || e.replaceCrateButton(this._cratesButtonController.cratesButton),
                            [2, this._cratesButtonController.initialize()]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getRewardIconAndCounter = function(e) {
                    switch (e.key) {
                    case Cn.COINS:
                        return {
                            target: this.getUIelement(Ns.CoinCounterUI),
                            icon: f.ICON_COUNTER_COIN
                        };
                    case Cn.GEMS:
                        return {
                            target: this.getUIelement(Ns.GemCounterUI),
                            icon: f.ICON_COUNTER_GEM
                        };
                    case Cn.ENERGY:
                        return {
                            target: this.getUIelement(Ns.EnergyCounterUI),
                            icon: f.ICON_COUNTER_ENERGY
                        };
                    case Cn.CRATES:
                        return {
                            target: this.getUIelement(Ns.CratesButtonUI),
                            icon: qa[e.key]
                        };
                    case An.EXP:
                        return {
                            target: this.getUIelement(Ns.RankBarUI),
                            icon: qa[e.key]
                        };
                    default:
                        return {
                            target: this.getUIelement(Ns.OrderButtonUI),
                            icon: qa[e.key]
                        }
                    }
                }
                ,
                t.prototype._resizedByBanner = function() {
                    this.resize({
                        bounds: De.services.canvas.bounds,
                        orientation: De.services.canvas.targetOrientation
                    })
                }
                ,
                t.prototype._isOnboardingController = function(e) {
                    return e instanceof Ys
                }
                ,
                t.prototype._setUpShopStockListeners = function(e, t) {
                    for (var i = this._dependencies.services.marketplaceService, n = this._dependencies.services.marketplaceService.getItemConfigsByShop(e).filter((function(e) {
                        return Za(e) || ts(e)
                    }
                    )), r = function(e) {
                        if (!i.hasStock(n[e].id))
                            return "continue";
                        var r = i.getStockItem(n[e].id)
                          , a = function() {
                            r.amount < 1 ? t.hideNotification() : t.showNotification()
                        };
                        r.onChanged.addListener(a, void 0),
                        o._shopStockListeners.push({
                            event: r.onChanged,
                            callback: a
                        }),
                        r.amount > 0 && t.showNotification()
                    }, o = this, a = 0; a < n.length; a++)
                        r(a)
                }
                ,
                t.prototype._createDrawers = function() {
                    var e, t = [this._orderButton];
                    t.push.apply(t, vp.platform.hudStrategy.leftDrawer);
                    var i = [this._cratesButtonController.cratesButton, this._dailyChallengeButton];
                    vp.platform.hudStrategy.marketplaceButton && i.push(vp.platform.hudStrategy.marketplaceButton),
                    vp.platform.hudStrategy.discoveryButton && i.push(vp.platform.hudStrategy.discoveryButton);
                    var n = new e_(t)
                      , r = new t_(vp.platform.hudStrategy.rightDrawer)
                      , o = new Zs(i);
                    this._uiDrawers = ((e = {})[i_.LeftDrawer] = n,
                    e[i_.RightDrawer] = r,
                    e[i_.BottomDrawer] = o,
                    e)
                }
                ,
                t.prototype._addChildren = function() {
                    var e = this;
                    this.addChild(this._hudGradientOverlay),
                    Object.values(this._uiDrawers).forEach((function(t) {
                        return e.addChild(t)
                    }
                    )),
                    this.addChild(this._coinsCounter),
                    this.addChild(this._energyCounter),
                    this.addChild(this._gemsCounter),
                    this.addChild(this._rankBar),
                    this.addChild(this._dailyChallengeButton),
                    vp.platform.hudStrategy.marketplaceButton && this.addChild(vp.platform.hudStrategy.marketplaceButton),
                    vp.platform.hudStrategy.discoveryButton && this.addChild(vp.platform.hudStrategy.discoveryButton),
                    vp.platform.hudStrategy.storageButton && this.addChild(vp.platform.hudStrategy.storageButton),
                    vp.platform.hudStrategy.specialOfferButton && this.addChild(vp.platform.hudStrategy.specialOfferButton),
                    vp.platform.hudStrategy.signInBonusButton && this.addChild(vp.platform.hudStrategy.signInBonusButton)
                }
                ,
                t
            }(Er), a_ = [Ns.CoinCounterUI, Ns.CratesButtonUI, Ns.EnergyCounterUI, Ns.GemCounterUI, Ns.OrderButtonUI, Ns.ShovelButtonUI, Ns.DiscoveryButtonUI, Ns.MarketplaceButtonUI, Ns.ExtraWorkerButtonUI, Ns.TaskButtonUI, Ns.SpecialOfferButtonUI, Ns.DailyChallengeButtonUI], s_ = function(e) {
                function t() {
                    return e.call(this, Lo.INTRO_TRACK) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = this;
                    ["wheat_1", "wheat_1", "wheat_1"].forEach((function(t) {
                        e._dependencies.crateContent.queueContent(t)
                    }
                    ));
                    var t = [{
                        column: 74,
                        row: 74
                    }, {
                        column: 74,
                        row: 73
                    }, {
                        column: 73,
                        row: 73
                    }]
                      , i = t.filter((function(t) {
                        var i = e._dependencies.mapGrid.getCell(t.column, t.row);
                        if (!(null == i ? void 0 : i.content))
                            return t
                    }
                    ))
                      , r = t.concat([])
                      , o = i.length;
                    0 !== o ? (r = r.splice(-o),
                    this._steps.push(new _a(ln.INTRODUCTION), new sa("LogStep","Start of Intro Track"), new $o("BlockUserInputStep",Uo.ONBOARDING), new na("ChangeButtonStep",Qo.ONBOARDING), new aa("HideElementStep",a_), new ja("ZoomCameraStep",1.5,{
                        column: 73,
                        row: 73
                    },.01,!0), new Ha("block the camera interactions",Ca.DISABLED), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new Na("ShowElementStep",[Ns.CratesButtonUI]), new Da("ConversationWithAnswerStep","supply_1"), new fa("ShowClickStep",{
                        animations: [{
                            layer: ea.HUD,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    x: -80,
                                    y: De.services.canvas.bottom - 350
                                }
                            },
                            mirror: !0,
                            duration: 1250
                        }, {
                            animationName: ta.DELAY,
                            duration: 200
                        }],
                        loop: !0
                    }), new Ko("AwaitCratesSpawnedStep",(0,
                    n.__spreadArray)([], r.reverse(), !0)), new jo("Change all mergeable items' lucky chance to 0"), new aa("HideElementStep",[Ns.CratesButtonUI]), new ra("HideAnimatedHandStep"), new oa("HideConversationStep"), new Ho("AllowUserInputStep"), new _a(ln.INTRODUCTION,!0), new sa("LogStep","End of Intro Track"))) : this._steps.push(new _a(ln.INTRODUCTION,!0), new sa("LogStep","End of Intro Track"))
                }
                ,
                t.prototype._onCancel = function() {
                    this._dependencies.onboarding.inputBlocker.removeInputBlocker()
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), __ = function() {
                function e(e, t, i) {
                    void 0 === i && (i = !1),
                    this.onGameObjectAdded = new r.Event,
                    this.onGameObjectRemoved = new r.Event,
                    this._gameObjects = [],
                    this._gameObjectContainer = e,
                    this._filter = t,
                    this._debug = i,
                    this._initialize()
                }
                return e.prototype.destroy = function() {
                    this._gameObjectContainer.onGameObjectAdded.removeListener(this._onGameObjectAddedHandler, this),
                    this._gameObjectContainer.onGameObjectAvailable.removeListener(this._onGameObjectAvailableHandler, this),
                    this._gameObjectContainer.onGameObjectRemoved.removeListener(this._onGameObjectRemovedHandler, this);
                    for (var e = 0; e < this._gameObjects.length; e++) {
                        var t = this._gameObjects[e];
                        t.onBehaviorAdded.removeListener(this._onBehaviorAddedHandler, this),
                        t.onBehaviorRemoved.removeListener(this._onBehaviorRemovedHandler, this),
                        this.onGameObjectRemoved.fire(t)
                    }
                }
                ,
                e.prototype.addGameObjectIfMatch = function(e) {
                    -1 !== this._gameObjects.indexOf(e) || this._filter.matchesGameObject(e) && (this._debug && this._logger.info("Object added to family: ", e.id, this._filter),
                    this._gameObjects.push(e),
                    this.onGameObjectAdded.fire(e))
                }
                ,
                e.prototype.removeGameObject = function(e) {
                    var t = this._gameObjects.indexOf(e);
                    -1 !== t && (this._debug && this._logger.info("Object removed from family: ", e.id, this._filter),
                    this._gameObjects.splice(t, 1),
                    this.onGameObjectRemoved.fire(e))
                }
                ,
                e.prototype.getGameObjects = function() {
                    return (0,
                    n.__spreadArray)([], this._gameObjects, !0)
                }
                ,
                e.prototype.forEach = function(e) {
                    for (var t = this._gameObjects.length - 1; t >= 0; t--)
                        e(this._gameObjects[t])
                }
                ,
                e.prototype._initialize = function() {
                    var e = this;
                    this._logger = Ie.Of("Family: '".concat(this._filter.uuid, "'")),
                    this._gameObjectContainer.getAllGameObjects().forEach((function(t) {
                        e._onGameObjectAddedHandler(t),
                        e._onGameObjectAvailableHandler(t)
                    }
                    )),
                    this._gameObjectContainer.onGameObjectAdded.addListener(this._onGameObjectAddedHandler, this),
                    this._gameObjectContainer.onGameObjectAvailable.addListener(this._onGameObjectAvailableHandler, this),
                    this._gameObjectContainer.onGameObjectRemoved.addListener(this._onGameObjectRemovedHandler, this)
                }
                ,
                e.prototype._onGameObjectAddedHandler = function(e) {
                    e.onBehaviorAdded.addListener(this._onBehaviorAddedHandler, this),
                    e.onBehaviorRemoved.addListener(this._onBehaviorRemovedHandler, this)
                }
                ,
                e.prototype._onGameObjectAvailableHandler = function(e) {
                    this.addGameObjectIfMatch(e)
                }
                ,
                e.prototype._onGameObjectRemovedHandler = function(e) {
                    this.removeGameObject(e),
                    e.onBehaviorAdded.removeListener(this._onBehaviorAddedHandler, this),
                    e.onBehaviorRemoved.removeListener(this._onBehaviorRemovedHandler, this)
                }
                ,
                e.prototype._onBehaviorAddedHandler = function(e) {
                    var t = e.gameObject
                      , i = e.behavior;
                    this._filter.matchesBehavior(i) && this.addGameObjectIfMatch(t)
                }
                ,
                e.prototype._onBehaviorRemovedHandler = function(e) {
                    var t = e.gameObject
                      , i = e.behavior;
                    this._filter.matchesBehavior(i) && -1 !== this._gameObjects.indexOf(t) && this.removeGameObject(t)
                }
                ,
                e
            }(), c_ = function() {
                function e(e) {
                    this._behaviorTypes = e.concat([]),
                    this._behaviorTypes.sort()
                }
                return Object.defineProperty(e.prototype, "uuid", {
                    get: function() {
                        return this._behaviorTypes.join("-")
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.matchesBehaviorType = function(e) {
                    return -1 !== this._behaviorTypes.indexOf(e)
                }
                ,
                e.prototype.matchesBehavior = function(e) {
                    return this.matchesBehaviorType(e.type)
                }
                ,
                e.prototype.matchesGameObject = function(e) {
                    for (var t = 0, i = this._behaviorTypes.length; t < i; ++t)
                        if (!e.hasBehavior(this._behaviorTypes[t]))
                            return !1;
                    return !0
                }
                ,
                e
            }(), l_ = function(e) {
                function t(t, i, n, r) {
                    void 0 === n && (n = -1),
                    void 0 === r && (r = !1);
                    var o = e.call(this, t) || this;
                    return o._resolveAfterAmount = n,
                    o._behaviorsToFilter = i,
                    o._resolveIfNoneFound = r,
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    var e = this;
                    return this._family = new __(this._dependencies.world,new c_(this._behaviorsToFilter)),
                    new Promise((function(t, i) {
                        e._resolveIfNoneFound && 0 === e._family.getGameObjects().length && t();
                        var n = function(i) {
                            e._resolveAfterAmount -= 1,
                            0 !== e._family.getGameObjects().length && 0 !== e._resolveAfterAmount || (e._family.onGameObjectRemoved.removeListener(n, e),
                            e._family.destroy(),
                            t())
                        };
                        e._family.onGameObjectRemoved.addListener(n, e)
                    }
                    ))
                }
                ,
                t
            }(Vo), u_ = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._tracksToComplete = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._tracksToComplete.forEach((function(t) {
                                e._dependencies.onboarding.markTrackAsComplete(t)
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo);
            !function(e) {
                e[e.ADD = 0] = "ADD",
                e[e.REMOVE = 1] = "REMOVE"
            }(r_ || (r_ = {}));
            var d_ = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._dragData = i,
                    r._action = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._action === r_.ADD ? this._dependencies.interactionWhitelistService.allowDrag(this._dragData) : this._dependencies.interactionWhitelistService.removeDrag(this._dragData),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo);
            function h_(e, t) {
                var i = e.getFilledCellsWithBehaviors([Ke.Mergeable]).filter((function(e) {
                    var i;
                    return (null === (i = e.content) || void 0 === i ? void 0 : i.getBlueprintID()) === t
                }
                ));
                if (!(i.length < 3)) {
                    var n, r, o = i[0], a = i[1];
                    return Math.abs(o.row - a.row) + Math.abs(o.column - a.column) === 1 ? (n = i[2],
                    r = o) : (n = a,
                    r = o),
                    {
                        start: n,
                        end: r
                    }
                }
                Ie.Of("OnboardingUtils.getObjectPositionsToMerge").warn("couldn't find at least 3 objects to merge with blueprintId: ".concat(t))
            }
            function p_(e, t) {
                var i, n = e.getFilledCellsWithBehaviors([Ke.ExtendedTile].concat(t))[0];
                if (n) {
                    var r = null === (i = n.content) || void 0 === i ? void 0 : i.getBehavior(Ke.ExtendedTile);
                    if (r) {
                        var o = r.getChildren().map((function(e) {
                            var t = e.getBehavior(Ke.GridPosition);
                            if (t)
                                return {
                                    column: t.column,
                                    row: t.row
                                }
                        }
                        ));
                        return o.push({
                            column: n.column,
                            row: n.row
                        }),
                        o
                    }
                }
            }
            function v_(e, t) {
                return e.getFilledCellsWithBehaviors([Ke.Upgrade, Ke.Building]).find((function(i) {
                    var n, r;
                    if (i.content) {
                        var o = null === (n = i.content) || void 0 === n ? void 0 : n.getBehavior(Ke.Upgrade)
                          , a = null === (r = i.content) || void 0 === r ? void 0 : r.getBehavior(Ke.Building);
                        return o && a && !t.isBuildingActive(a.ID) && e.hasEnoughItems(o.objectCost) ? i : void 0
                    }
                }
                ))
            }
            function g_(e, t) {
                var i = e.getFilledCellsWithBehaviors([Ke.Collectable]);
                if (!ve(i[0])) {
                    var n = 0
                      , r = {
                        row: 0,
                        column: 0
                    };
                    return i.forEach((function(e) {
                        if (e.content) {
                            var i = t.getWorldPosition(e.column, e.row).y;
                            i > n && (r = {
                                column: e.column,
                                row: e.row
                            },
                            n = i)
                        }
                    }
                    )),
                    r
                }
            }
            function f_(e, t) {
                var i = e.getFilledCellsWithBehaviors([Ke.Mergeable]).filter((function(e) {
                    var i;
                    return (null === (i = e.content) || void 0 === i ? void 0 : i.getBlueprintID()) === t
                }
                ))
                  , n = [];
                return i.forEach((function(e) {
                    var r = i.filter((function(t) {
                        if (t !== e)
                            return t
                    }
                    ))
                      , o = [];
                    r.forEach((function(i) {
                        i.getNeighbors().forEach((function(i) {
                            var n;
                            (null === (n = i.content) || void 0 === n ? void 0 : n.getBlueprintID()) === t && i !== e && o.push(i)
                        }
                        ))
                    }
                    )),
                    o.forEach((function(t) {
                        n.push({
                            start: e,
                            end: t
                        })
                    }
                    ))
                }
                )),
                n
            }
            ce.ONBOARDING_POPUP_HEADER,
            f.ICON_POPUP_MERGE_EXPLANATION,
            ce.ONBOARDING_MERGE_INFO;
            var E_, m_ = function(e) {
                function t() {
                    return e.call(this, Lo.MERGE_TRACK_1) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = {
                        column: 74,
                        row: 74
                    }
                      , t = f_(this._dependencies.gridFilter, "wheat_1");
                    this._steps.push(new _a(ln.MERGE_TIER_1), new sa("LogStep","Start of Merge Track 1"), new aa("HideElementStep",a_), new Ha("block the camera interactions",Ca.DISABLED), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new Da("ShowConversationStep","merge_1"), new ja("ZoomCameraStep",1.5,e,1.5), new d_("allow the user to drag the first object",t,r_.ADD), new fa("ShowClickAndDragStep",{
                        animations: [{
                            layer: ea.MAIN,
                            animationName: ta.CLICK_AND_DRAG,
                            points: {
                                startPosition: e,
                                endPosition: {
                                    column: 74,
                                    row: 73
                                }
                            },
                            duration: 2e3,
                            addGridArrow: !0
                        }, {
                            animationName: ta.DELAY,
                            duration: 200
                        }],
                        loop: !0
                    }), new l_("AwaitObjectWithBehaviorRemoveStep",[Ke.MergeTrigger],1), new u_("MarkTrackAsCompletedStep",[Lo.MERGE_TRACK_1]), new d_("remove the position from the whitelist",t,r_.REMOVE), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new ra("HideAnimatedHandStep"), new oa("HideConversationStep"), new _a(ln.MERGE_TIER_1,!0), new Ha("block the camera interactions",Ca.DISABLED), new sa("LogStep","End of Merge Track 1"))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), y_ = function(e) {
                function t(t, i, n) {
                    void 0 === n && (n = .8);
                    var r = e.call(this, t) || this;
                    return r._moveTo = i,
                    r._duration = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return (e = this._dependencies.mapGrid.getCell(this._moveTo.column, this._moveTo.row)) ? (this._dependencies.cameraService.disable(),
                                [4, this._dependencies.cameraService.animateCameraToCell(e, this._duration, !0)]) : (this._logger.error("couldn't find gridcell with col: ".concat(this._moveTo.column, ", row: ").concat(this._moveTo.row, ". Is it already unlocked?")),
                                [2]);
                            case 1:
                                return t.sent(),
                                this._dependencies.onboarding.isCameraDisabled() || this._dependencies.cameraService.enable(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), T_ = "wheat_2", A_ = function(e) {
                function t() {
                    return e.call(this, Lo.MERGE_TRACK_2) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = h_(this._dependencies.gridFilter, T_);
                    if (void 0 !== e) {
                        var t = f_(this._dependencies.gridFilter, T_);
                        this._steps.push(new _a(ln.MERGE_TIER_2), new sa("LogStep","Start of Merge Track 2"), new aa("HideElementStep",a_), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new y_("MoveCameraStep",e.start), new Da("ShowConversationStep","merge_2"), new fa("ShowClickAndDragStep",{
                            animations: [{
                                layer: ea.MAIN,
                                animationName: ta.CLICK_AND_DRAG,
                                points: {
                                    startPosition: e.start,
                                    endPosition: e.end
                                },
                                duration: 2e3,
                                addGridArrow: !0
                            }, {
                                animationName: ta.DELAY,
                                duration: 200
                            }],
                            loop: !0
                        }), new d_("allow the user to drag the second object",t,r_.ADD), new l_("AwaitObjectWithBehaviorRemoveStep",[Ke.MergeTrigger],1), new d_("remove the position from the whitelist",t,r_.REMOVE), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new ra("HideAnimatedHandStep"), new oa("HideConversationStep"), new _a(ln.MERGE_TIER_2,!0), new sa("LogStep","End of Merge Track 2"))
                    }
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa);
            !function(e) {
                e.BAKERY = "bakery",
                e.SWEETS = "sweets",
                e.LOOM = "loom",
                e.BBQ = "bbq",
                e.DAIRY = "dairy",
                e.MARKET = "market",
                e.MUSEUM = "museum",
                e.BARISTA = "barista",
                e.GREENHOUSE = "greenhouse_building",
                e.TOMATO_ON_WHEELS = "tomato_on_wheels",
                e.BUILDING_AVOCADOFIESTA = "building_avocadofiesta",
                e.BUILDING_TRUFFLELICIOUS = "building_trufflelicious"
            }(E_ || (E_ = {}));
            var C_, I_, S_, O_, b_ = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._command = n,
                    r._buildingID = i,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return "pause" === this._command ? this._dependencies.onboarding.isBuildingPaused(this._buildingID) || this._dependencies.onboarding.pauseBuilding(this._buildingID) : this._dependencies.onboarding.isBuildingPaused(this._buildingID) && (this._dependencies.onboarding.unpauseBuilding(this._buildingID),
                            this._dependencies.ordersService.onBuildingUnpaused(this._buildingID)),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), R_ = "wheat_3", w_ = function(e) {
                function t() {
                    return e.call(this, Lo.MERGE_TRACK_4) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = h_(this._dependencies.gridFilter, R_);
                    if (void 0 !== e) {
                        var t = f_(this._dependencies.gridFilter, R_);
                        this._steps.push(new b_("Pause market so the service doesn't create an order for it",E_.MARKET,"pause"), new _a(ln.MERGE_TIER_3), new sa("LogStep","Start of Merge Track 4"), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new aa("HideElementStep",a_), new y_("MoveCameraStep",e.start), new Da("ShowConversationStep","merge_4"), new fa("ShowClickAndDragStep",{
                            animations: [{
                                layer: ea.MAIN,
                                animationName: ta.CLICK_AND_DRAG,
                                points: {
                                    startPosition: e.start,
                                    endPosition: e.end
                                },
                                duration: 2e3,
                                addGridArrow: !0
                            }, {
                                animationName: ta.DELAY,
                                duration: 200
                            }],
                            loop: !0
                        }), new d_("allow the user to drag the final object",t,r_.ADD), new l_("AwaitObjectWithBehaviorRemoveStep",[Ke.MergeTrigger],1), new d_("remove the position from the whitelist",t,r_.REMOVE), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new ra("HideAnimatedHandStep"), new oa("HideConversationStep"), new _a(ln.MERGE_TIER_3,!0), new sa("LogStep","End of Merge Track 4"))
                    }
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), D_ = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._popup = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    var e = this;
                    return new Promise((function(t, i) {
                        var n = e._onPopupClosed.bind(e, (function() {
                            De.services.navigation.onPopupClosed.removeListener(n, e),
                            t()
                        }
                        ));
                        De.services.navigation.onPopupClosed.addListener(n, e)
                    }
                    ))
                }
                ,
                t.prototype._onPopupClosed = function(e, t) {
                    t instanceof this._popup && e()
                }
                ,
                t
            }(Vo), N_ = [{
                name: "move",
                duration: .3,
                repeat: 0,
                keyframes: {
                    spawnContainer: [{
                        time: 0,
                        duration: 1,
                        ease: "back.out",
                        params: {
                            position: {
                                x: "+=360"
                            }
                        }
                    }]
                }
            }], L_ = [{
                name: "scroll",
                duration: .4,
                repeat: 0,
                keyframes: {
                    scrollContainer: [{
                        time: 0,
                        duration: 1,
                        ease: "back.in",
                        params: {
                            position: {
                                x: "$scrollTarget"
                            }
                        }
                    }],
                    scrollTarget: []
                }
            }], B_ = [{
                name: "fadeIn",
                duration: .5,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: "+=0"
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            alpha: 1
                        }
                    }]
                }
            }, {
                name: "fadeOut",
                duration: .5,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: "+=0"
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            alpha: 0
                        }
                    }]
                }
            }, {
                name: "halfFadeOut",
                duration: .5,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: "+=0"
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            alpha: .5
                        }
                    }]
                }
            }], P_ = [{
                name: "rank_bar",
                duration: .75,
                repeat: 0,
                keyframes: {
                    progress: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            value: "+=0"
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "back.out",
                        params: {
                            value: "$targetProgress"
                        }
                    }],
                    targetProgress: []
                }
            }], k_ = [{
                name: "disappear",
                duration: 1,
                repeat: 0,
                keyframes: {
                    scrollContainer: [{
                        time: 0,
                        duration: .6,
                        ease: "back.in",
                        params: {
                            position: {
                                x: "$scrollTarget"
                            }
                        }
                    }],
                    spine: [{
                        time: .6,
                        duration: .4,
                        ease: "sine.in",
                        params: {
                            position: {
                                x: "$spineTarget",
                                y: "$spineTarget"
                            }
                        }
                    }],
                    scrollTarget: [],
                    spineTarget: []
                }
            }], x_ = [{
                name: "fade",
                duration: .6,
                repeat: 0,
                keyframes: {
                    inputBlocker: [{
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            alpha: "$alpha"
                        }
                    }],
                    content: [],
                    targetPos: [],
                    alpha: []
                }
            }, {
                name: "move",
                duration: .6,
                repeat: 0,
                keyframes: {
                    content: [{
                        time: 0,
                        duration: 0,
                        ease: "back.in",
                        params: {
                            position: {
                                y: "$targetPos"
                            }
                        }
                    }],
                    inputBlocker: [],
                    targetPos: [],
                    alpha: []
                }
            }], G_ = [{
                name: "appear",
                duration: .7,
                repeat: 0,
                keyframes: {
                    card: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: 0,
                        duration: .57,
                        ease: "back.out",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .57,
                        duration: .42,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }]
                }
            }], U_ = [{
                name: "appear",
                duration: .3,
                repeat: 0,
                keyframes: {
                    continueText: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "back.out",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }]
                }
            }, {
                name: "loop",
                duration: 2,
                repeat: -1,
                keyframes: {
                    continueText: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .3,
                        duration: .1,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1.2,
                                y: 1.2
                            }
                        }
                    }, {
                        time: .4,
                        duration: .1,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .5,
                        duration: .1,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1.2,
                                y: 1.2
                            }
                        }
                    }, {
                        time: .6,
                        duration: .1,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .7,
                        duration: .3,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }]
                }
            }, {
                name: "hide",
                duration: .3,
                repeat: 0,
                keyframes: {
                    continueText: [{
                        time: 0,
                        duration: 1,
                        ease: "back.in",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }]
                }
            }], F_ = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.HIGH,
                    i._name = "LevelUpPopup",
                    i._cards = [],
                    i._maskRadius = 300,
                    i._maskStart = -.3 * Math.PI,
                    i._maskEnd = 1.3 * Math.PI,
                    i._maskLength = Math.abs(i._maskEnd - i._maskStart),
                    i._rewardSequenceArray = [],
                    i._rewardToCardIndexMap = new Map,
                    i._level = t.levelUpData.level,
                    i._rewards = t.levelUpData.rewards,
                    i._recipes = t.levelUpData.recipes,
                    i._crateContents = t.levelUpData.crateContents,
                    i._hudContainer = t.hudService.hudContainer,
                    i._onCloseCallback = t.onCloseCallback,
                    i._scrollWidth = De.services.canvas.width - 100,
                    i._inputBlocker.off("pointerup", void 0, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._createHideAnimation(),
                            this._showHideAnimations(),
                            this._animateRewards(),
                            this._onCloseCallback && this._onCloseCallback(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.show = function(e) {
                    De.services.adsService.hideBannerAd(),
                    De.services.analytics.design.reportLevelupInterstitialAttempt(),
                    this._handleOrientation(),
                    this._createSpineAnimation(),
                    this._createCardsData(),
                    this._createMoveAnimation(),
                    this._createScrollAnimation(),
                    this._createProgressionAnimation(),
                    this._createContinueText(),
                    this._setAllListeners(),
                    this._showSpineAnimation(),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    De.services.adsService.setBannerInterval(),
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._options = {},
                    v.GroupsCore.Updateables.remove(this._scrollContainer),
                    this._disposeAllTimelines(),
                    this._lvlUpAnimation.destroy()
                }
                ,
                t.prototype.resize = function() {
                    e.prototype.resize.call(this),
                    this._handleOrientation()
                }
                ,
                t.prototype._onShowSounds = function() {
                    De.services.audio.playSoundEffect(m.LEVEL_UP)
                }
                ,
                t.prototype._onCloseSounds = function() {}
                ,
                t.prototype._showInterstitialAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.adsService.showInterstitialAd("levelUp")];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._disposeAllTimelines = function() {
                    this._rewardSequenceArray.forEach((function(e) {
                        e.dispose()
                    }
                    )),
                    this._rewardMoveAnimation.dispose(),
                    this._rewardScrollAnimation.dispose(),
                    this._disappearAnimation.dispose(),
                    this._fadeAnimation.dispose(),
                    this._tapToContinueAnimation.dispose()
                }
                ,
                t.prototype._showHideAnimations = function() {
                    this._tapToContinueAnimation.stopAll(),
                    this._tapToContinueAnimation.play("hide"),
                    this._disappearAnimation.setTargets({
                        scrollContainer: this._scrollContainer,
                        scrollTarget: {
                            position: new Xe.Point(De.services.canvas.width + this._scrollContainer.width,0)
                        },
                        spine: this._targetContainer,
                        spineTarget: {
                            position: {
                                x: this._localRankBar.x,
                                y: this._localRankBar.y
                            }
                        }
                    }),
                    this._disappearAnimation.play("disappear"),
                    this._fadeAnimation.play("fade"),
                    this._lvlUpAnimation.state.setAnimation(1, "level_up_reward_seqence_hide", !1)
                }
                ,
                t.prototype._showProgressionAnimation = function() {
                    this._rankBarProgressionAnimation.play("rank_bar")
                }
                ,
                t.prototype._showContinueAnimation = function() {
                    this._tapToContinueAnimation.play("appear")
                }
                ,
                t.prototype._showSpineAnimation = function() {
                    this._lvlUpAnimation.state.setAnimation(1, "level_up_reward_seqence_appear", !1)
                }
                ,
                t.prototype._moveSpawnContainer = function() {
                    this._rewardMoveAnimation.play("move")
                }
                ,
                t.prototype._moveScrollContainer = function() {
                    this._spawnContainer.width < this._scrollWidth && this._scrollContainer.disableScroll(),
                    this._scrollContainer.addContent(this._spawnContainer),
                    this._scrollContainer.setBounds(new Xe.Rectangle(-153,this._spawnContainer.y - this._spawnContainer.height / 2,this._scrollWidth,this._spawnContainer.height)),
                    this._rewardScrollAnimation.play("scroll")
                }
                ,
                t.prototype._showRewardSequence = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, o = this;
                        return (0,
                        n.__generator)(this, (function(a) {
                            switch (a.label) {
                            case 0:
                                e = function(e) {
                                    var i;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        switch (n.label) {
                                        case 0:
                                            return (i = t._cards[e]).position.set(0, 575),
                                            [4, r.TimeDelay.nextFrame()];
                                        case 1:
                                            return n.sent(),
                                            t.addChild(i),
                                            t._rewardSequenceArray[e].setTargets({
                                                card: i
                                            }),
                                            t._rewardSequenceArray[e].play("appear"),
                                            [4, new Promise((function(t) {
                                                o._rewardSequenceArray[e].onEnd.addListener((function() {
                                                    t()
                                                }
                                                ), o)
                                            }
                                            ))];
                                        case 2:
                                            return n.sent(),
                                            t._spawnContainer.addChild(i),
                                            t.removeChild(i),
                                            i.position.set(360 * -e, 0),
                                            [2]
                                        }
                                    }
                                    ))
                                }
                                ,
                                t = this,
                                i = 0,
                                a.label = 1;
                            case 1:
                                return i < this._rewardSequenceArray.length ? [5, e(i)] : [3, 4];
                            case 2:
                                a.sent(),
                                a.label = 3;
                            case 3:
                                return i++,
                                [3, 1];
                            case 4:
                                return v.GroupsCore.Updateables.add(this._scrollContainer),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createCardsData = function() {
                    var e = this;
                    this._scrollContainer = this.addChild(new v.ScrollableContainer({
                        friction: .8,
                        scrollX: !0,
                        scrollY: !1,
                        autoFitContent: !0
                    })),
                    this._scrollContainer.interactive = !1,
                    this._spawnContainer = this.addChild(new Xe.Container),
                    this._spawnContainer.position.set(0, 575),
                    this._crateContents.forEach((function(t) {
                        return e._cards.push(new Ra({
                            crateContent: t,
                            showLock: !0
                        }))
                    }
                    )),
                    this._recipes.forEach((function(t) {
                        return e._cards.push(new Ra({
                            recipe: t,
                            showLock: !0
                        }))
                    }
                    )),
                    this._rewards.forEach((function(t) {
                        var i = new Ra({
                            inventoryItem: t
                        });
                        e._cards.push(i),
                        e._rewardToCardIndexMap.set(t.key, i)
                    }
                    ));
                    for (var t = 0; t < this._cards.length; t++) {
                        var i = new ur(G_);
                        this._rewardSequenceArray.push(i),
                        i.onStart.listenOnce((function() {
                            return De.services.audio.playSoundEffect(m.LEVEL_UP_CARD)
                        }
                        ), null),
                        t < this._cards.length - 1 ? i.onEnd.addListener((function() {
                            return e._moveSpawnContainer()
                        }
                        ), this) : i.onEnd.addListener((function() {
                            return (0,
                            n.__awaiter)(e, void 0, void 0, (function() {
                                return (0,
                                n.__generator)(this, (function(e) {
                                    switch (e.label) {
                                    case 0:
                                        return [4, r.TimeDelay.nextFrame()];
                                    case 1:
                                        return e.sent(),
                                        this._moveScrollContainer(),
                                        [2]
                                    }
                                }
                                ))
                            }
                            ))
                        }
                        ), this)
                    }
                }
                ,
                t.prototype._createMoveAnimation = function() {
                    this._rewardMoveAnimation = new ur(N_),
                    this._rewardMoveAnimation.setTargets({
                        spawnContainer: this._spawnContainer
                    })
                }
                ,
                t.prototype._createScrollAnimation = function() {
                    this._rewardScrollAnimation = new ur(L_);
                    var e = 360 * this._cards.length < this._scrollWidth ? 360 * this._cards.length : this._scrollWidth
                      , t = new Xe.Point(-e / 2 + 180,0);
                    this._rewardScrollAnimation.setTargets({
                        scrollContainer: this._scrollContainer,
                        scrollTarget: {
                            position: t
                        }
                    })
                }
                ,
                t.prototype._createHideAnimation = function() {
                    var e = this
                      , t = this._hudContainer.getUIelement(Ns.RankBarUI)
                      , i = this._hudContainer.toGlobal(t.position);
                    this._localRankBar = this._lvlUpAnimation.toLocal(i),
                    this._targetContainer = this._lvlUpAnimation.addChild(new Xe.Container),
                    this._targetContainer.position.copyFrom(new Xe.Point(this._rankBarBone.data.x,-this._rankBarBone.data.y)),
                    this._disappearAnimation = new ur(k_),
                    this._disappearAnimation.setTargets({
                        scrollContainer: this._scrollContainer,
                        scrollTarget: {
                            position: new Xe.Point(De.services.canvas.width,0)
                        },
                        spine: this._targetContainer,
                        spineTarget: {
                            position: {
                                x: this._localRankBar.x,
                                y: this._localRankBar.y
                            }
                        }
                    }),
                    this._disappearAnimation.onUpdate.addListener((function() {
                        e._rankBarBone.data.x = e._targetContainer.x,
                        e._rankBarBone.data.y = -e._targetContainer.y,
                        e._rankBarBone.update()
                    }
                    ), this),
                    this._rankBarStartPos = new Xe.Point(this._rankBarBone.data.x,this._rankBarBone.data.y),
                    this._fadeAnimation = new ur(x_),
                    this._fadeAnimation.setTargets({
                        alpha: {
                            alpha: this._keepBackground ? 1 : 0
                        },
                        inputBlocker: this._inputBlocker,
                        content: this._content,
                        targetPos: this
                    })
                }
                ,
                t.prototype._createContinueText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !1
                    });
                    e.style = vn.lvlUpContinueText,
                    this._tapToContinueText = new v.Label(nr(C_ || (C_ = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAP_TO_CONTINUE),e),
                    this._tapToContinueText.anchor.set(.5),
                    this._tapToContinueText.position.set(0, 920),
                    this._tapToContinueText.scale.set(0),
                    this.addChild(this._tapToContinueText),
                    this._tapToContinueAnimation = new ur(U_),
                    this._tapToContinueAnimation.setTargets({
                        continueText: this._tapToContinueText
                    })
                }
                ,
                t.prototype._createProgressionAnimation = function() {
                    var e = this
                      , t = {
                        value: 0
                    }
                      , i = {
                        value: De.services.experience.getLevelProgress()
                    };
                    this._rankBarProgressionAnimation = new ur(P_),
                    this._rankBarProgressionAnimation.setTargets({
                        progress: t,
                        targetProgress: i
                    }),
                    this._rankBarProgressionAnimation.onUpdate.addListener((function() {
                        var i = e._maskLength * Math.max(0, t.value);
                        e._progressMask.clear(),
                        e._progressMask.lineStyle(200, 0).arc(0, 0, e._maskRadius, e._maskStart, e._maskStart + i, !1).endFill()
                    }
                    ), this),
                    this._rankBarProgressionAnimation.onEnd.listenOnce((function() {
                        e._rankBarProgressionAnimation.dispose()
                    }
                    ), this)
                }
                ,
                t.prototype._createSpineAnimation = function() {
                    this._beamAnimation = De.services.resource.getSpine(se.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP),
                    this._beamAnimation.alpha = 0,
                    this._genericFadeAnimation = new ur(B_),
                    this._genericFadeAnimation.setTargets({
                        container: this._beamAnimation
                    });
                    var e = rr(De.services.resource.getSprite(f.BTN_LEVELUP_BAR_FILL), {
                        scale: {
                            x: 4.35,
                            y: 4.35
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    });
                    this._lvlUpAnimation = De.services.resource.getSpine(se.LEVEL_UP_REWARDS_SEQUENCE),
                    this.addChild(this._beamAnimation, this._lvlUpAnimation);
                    var t = this._lvlUpAnimation.skeleton
                      , i = t.findSlot("btn_rank_level_level_up_panel_backdrop")
                      , r = i.currentSprite.parent
                      , o = i.currentSprite.anchor.clone()
                      , a = i.currentSprite.scale.clone();
                    e.anchor = o,
                    e.position.set(0, 3),
                    this._progressMask = (new Xe.Graphics).lineStyle(200, 0).arc(0, 0, this._maskRadius, this._maskStart, this._maskStart, !1).endFill(),
                    this._progressMask.scale = a,
                    r.addChild(e, this._progressMask),
                    e.mask = this._progressMask,
                    this._rankBarBone = t.findBone("rank_level");
                    var s = t.findSlot("btn_rank_level_34_txt")
                      , _ = s.currentSprite.parent
                      , c = s.currentSprite.anchor.clone()
                      , l = s.currentSprite.scale.clone();
                    _.removeChildren();
                    var u = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 400,
                        fitWidth: De.services.canvas.width - 200
                    });
                    u.style = vn.lvlNumberText;
                    var d = new v.Label((this._level - 1).toString(),u);
                    d.anchor = c,
                    d.scale = l,
                    _.addChild(d);
                    var h = t.findSlot("btn_rank_level_35_txt_big").currentSprite.parent;
                    h.removeChildren();
                    var p = new v.Label(this._level.toString(),u);
                    p.anchor = c,
                    p.scale.set(1.3 * l.x, 1.3 * l.y),
                    h.addChild(p),
                    u.style = vn.lvlUpText;
                    var g = t.findSlot("btn_rank_level_level_up_txt")
                      , E = g.currentSprite.parent
                      , m = new v.Label(nr(I_ || (I_ = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.LEVEL_UP_TEXT),u);
                    m.anchor.set(.55, .5),
                    m.scale = g.currentSprite.scale,
                    E.removeChildren(),
                    E.addChild(m),
                    u.style = vn.lvlUpRewardsText;
                    var y = t.findSlot("btn_rank_level_level_up_txt_rewards")
                      , T = y.currentSprite.parent
                      , A = new v.Label(nr(S_ || (S_ = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.REWARDS),u);
                    A.anchor.set(.45, .5),
                    A.scale = y.currentSprite.scale,
                    T.removeChildren(),
                    T.addChild(A)
                }
                ,
                t.prototype._setAllListeners = function() {
                    var e = this;
                    this._lvlUpAnimation.state.addListener({
                        event: function(t, i) {
                            "reward_appear" === i.data.name && e._showRewardSequence(),
                            "light_beam_appear" === i.data.name && (e._beamAnimation.state.setAnimation(0, "level_up_reward_light_beam_loop", !0),
                            e._genericFadeAnimation.play("fadeIn")),
                            "progress_bar_cleared" === i.data.name ? e._showProgressionAnimation() : e._genericFadeAnimation.play("fadeOut")
                        }
                    }),
                    this._lvlUpAnimation.state.addListener({
                        complete: function(t) {
                            return (0,
                            n.__awaiter)(e, void 0, void 0, (function() {
                                return (0,
                                n.__generator)(this, (function(e) {
                                    switch (e.label) {
                                    case 0:
                                        return "level_up_reward_seqence_hide" !== t.animation.name ? [3, 2] : [4, r.TimeDelay.nextFrame()];
                                    case 1:
                                        e.sent(),
                                        this._rankBarBone.data.x = this._rankBarStartPos.x,
                                        this._rankBarBone.data.y = this._rankBarStartPos.y,
                                        this._hudContainer.getUIelement(Ns.RankBarUI).scaleRankBar(),
                                        this.onClosed.fire(this),
                                        this._showInterstitialAd(),
                                        e.label = 2;
                                    case 2:
                                        return [2]
                                    }
                                }
                                ))
                            }
                            ))
                        }
                    }),
                    this._rewardScrollAnimation.onEnd.listenOnce((function() {
                        e._showContinueAnimation(),
                        e._inputBlocker.once("pointerup", e.close, e),
                        e._scrollContainer.interactive = !0
                    }
                    ), this),
                    this._tapToContinueAnimation.onEnd.listenOnce((function(t) {
                        "appear" === t && e._tapToContinueAnimation.play("loop")
                    }
                    ), this)
                }
                ,
                t.prototype._handleOrientation = function() {
                    De.services.canvas.currentOrientation === v.Orientation.Portrait || (this.scale.set(.85),
                    this._inputBlocker.scale.x *= 1.25,
                    this._inputBlocker.scale.y *= 1.25)
                }
                ,
                t.prototype._animateRewards = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._rewards.forEach((function(t) {
                                var i = t.amount
                                  , r = t.key;
                                return (0,
                                n.__awaiter)(e, void 0, void 0, (function() {
                                    var e, t, o, a, s, _, c, l, u;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        return e = null === (u = this._rewardToCardIndexMap.get(r)) || void 0 === u ? void 0 : u.getGlobalPosition(),
                                        t = De.services.navigation.layers.popup.container,
                                        o = e || new Xe.Point(0,0),
                                        a = De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter({
                                            amount: i,
                                            key: r
                                        }),
                                        s = a.target,
                                        _ = a.icon,
                                        c = s.toGlobal(new Xe.Point(0,0)),
                                        (l = new Lr(De.services.resource.getSprite(_),t.toLocal(o),t.toLocal(c),i,t)).onAnimationComplete.addListener((function() {
                                            De.services.inventory.getInventoryItem(r).updateVisuals()
                                        }
                                        ), null),
                                        l.animate(),
                                        [2]
                                    }
                                    ))
                                }
                                ))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr), M_ = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._levelReached = !1,
                    n._level = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {
                    De.services.experience.getLevel() >= this._level && (this._levelReached = !0)
                }
                ,
                t.prototype._onExecute = function() {
                    this._levelReached || this._steps.push(new sa("LogStep","Start of AwaitLevelupTrack " + this._level), new aa("HideElementStep",a_), new D_("AwaitPopupClosedStep",F_), new sa("LogStep","End of AwaitLevelupTrack " + this._level))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), V_ = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._families = [],
                    r._validPositions = [],
                    r._positionToMatch = i,
                    r._behavior = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return e = new Promise((function(e, i) {
                                    t._promiseResolve = e
                                }
                                )),
                                this._setUp(),
                                [4, e];
                            case 1:
                                return i.sent(),
                                this._cleanUp(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._setUp = function() {
                    var e = this
                      , t = new __(this._dependencies.world,new c_([this._behavior]));
                    this._families.push(t),
                    t.onGameObjectAdded.addListener(this._onObjectAdded, this),
                    t.onGameObjectRemoved.addListener(this._onObjectRemoved, this),
                    t.getGameObjects().forEach((function(t) {
                        return e._onObjectRemoved(t)
                    }
                    ))
                }
                ,
                t.prototype._cleanUp = function() {
                    this._families.forEach((function(e) {
                        e.onGameObjectAdded.removeAllListeners(),
                        e.onGameObjectRemoved.removeAllListeners()
                    }
                    ))
                }
                ,
                t.prototype._onObjectRemoved = function(e) {
                    var t = this._getMatchingObjectPosition(e);
                    t && e.hasBehavior(this._behavior) && this._checkForCompletion(t)
                }
                ,
                t.prototype._onObjectAdded = function(e) {
                    var t = this._getMatchingObjectPosition(e);
                    if (t) {
                        var i = this._validPositions.indexOf(t);
                        -1 !== i && this._validPositions.splice(i, 1)
                    }
                }
                ,
                t.prototype._checkForCompletion = function(e) {
                    this._promiseResolve ? this._positionToMatch === e && this._promiseResolve() : this._logger.warn("Can't complete onboarding step before it was started!")
                }
                ,
                t.prototype._getMatchingObjectPosition = function(e) {
                    var t = e.getBehavior(Ke.GridPosition);
                    return t && this._positionToMatch.column === t.column && this._positionToMatch.row === t.row ? this._positionToMatch : null
                }
                ,
                t
            }(Vo), H_ = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._tapData = i,
                    r._addToWhitelist = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._addToWhitelist ? this._dependencies.interactionWhitelistService.allowTap(this._tapData) : this._dependencies.interactionWhitelistService.removeTapWhitelist(this._tapData),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), j_ = function(e) {
                function t() {
                    return e.call(this, Lo.HARVEST_TRACK_1) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = this._dependencies.gridFilter.getCellPositionsWithBehaviors([Ke.Harvestable])[0];
                    this._steps.push(new _a(ln.HARVEST), new sa("LogStep","Start of Harvest Track 1"), new aa("HideElementStep",a_), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new y_("MoveCameraStep",e), new Ha("allow the user to move the camera",Ca.ENABLED), new Da("ShowConversationStep","harvest_1"), new H_("allow the user to tap the harvestable",e,!0), new fa("ShowClickStep",{
                        animations: [{
                            layer: ea.MAIN,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    column: e.column,
                                    row: e.row
                                }
                            },
                            mirror: !0,
                            duration: 1250
                        }, {
                            animationName: ta.DELAY,
                            duration: 200
                        }],
                        loop: !0
                    }), new V_("AwaitBehaviorRemovedStep",e,Ke.InteractionTap), new ra("HideAnimatedHandStep"), new H_("remove the position from the whitelist",e,!1), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new oa("HideConversationStep"), new _a(ln.HARVEST,!0), new sa("LogStep","End of Harvest Track 1"))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), K_ = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event,
                    this._blueprintIDToCheck = "wheat"
                }
                return e.prototype.initialize = function(e) {
                    this._dependencies = e,
                    this._setup()
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._setup = function() {
                    this._family = new __(this._dependencies.world,new c_([Ke.Collectable])),
                    this._family.onGameObjectAdded.addListener(this._checkForCompletion, this),
                    this._checkForCompletion()
                }
                ,
                e.prototype._checkForCompletion = function() {
                    var e = this
                      , t = this._family.getGameObjects();
                    0 !== t.length && t.forEach((function(t) {
                        if (t.getBlueprintID() === e._blueprintIDToCheck)
                            return r.TimeDelay.nextFrame().then((function() {
                                e.status = !0,
                                e.onStatusChanged.fire()
                            }
                            )),
                            void e._family.onGameObjectAdded.removeListener(e._checkForCompletion, e)
                    }
                    ))
                }
                ,
                e
            }(), W_ = function(e) {
                function t(t) {
                    var i = e.call(this, t, [new K_]) || this;
                    return i._onboardingTrack = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    this._onboardingTrack === Lo.HARVEST_TRACK_2 && this._steps.push(new _a(ln.COLLECT_INGREDIENTS));
                    var e = g_(this._dependencies.gridFilter, this._dependencies.axonometricProjection)
                      , t = this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.Collectable]);
                    ve(e) ? this._onboardingTrack === Lo.HARVEST_TRACK_5 && this._steps.push(new _a(ln.COLLECT_INGREDIENTS,!0)) : this._steps.push(new sa("LogStep","Start of " + this._onboardingTrack), new aa("HideElementStep",a_), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new fa("ShowClickStep",{
                        animations: [{
                            layer: ea.MAIN,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    column: e.column,
                                    row: e.row
                                }
                            },
                            mirror: !0,
                            duration: 1250
                        }, {
                            animationName: ta.DELAY,
                            duration: 200
                        }],
                        loop: !0
                    }), new H_("allow the user to tap the harvestable",t,!0), new l_("Wait for one wheat object to be collected by the user",[Ke.Collectable],1), new H_("remove the data",t,!1), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new ra("HideAnimatedHandStep"), new sa("LogStep","End of " + this._onboardingTrack))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), z_ = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._buildingID = i,
                    r._state = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, new Promise((function(t, i) {
                                var n = e._dependencies.ordersService.getOrderByBuilding(e._buildingID);
                                if (ve(n))
                                    e._logger.error("couldn't find order with buildingID: ".concat(e._buildingID)),
                                    i();
                                else {
                                    var r = function(i) {
                                        i.buildingID === e._buildingID && i.state === e._state && (e._dependencies.ordersService.onOrderStateChange.removeListener(r, e),
                                        t())
                                    };
                                    e._dependencies.ordersService.onOrderStateChange.addListener(r, e),
                                    r(n)
                                }
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Y_ = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._popup = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    var e = this;
                    return new Promise((function(t, i) {
                        var n = e._onPopupOpened.bind(e, (function() {
                            De.services.navigation.onPopupOpened.removeListener(n, e),
                            t()
                        }
                        ));
                        De.services.navigation.onPopupOpened.addListener(n, e)
                    }
                    ))
                }
                ,
                t.prototype._onPopupOpened = function(e, t) {
                    t instanceof this._popup && e()
                }
                ,
                t
            }(Vo), J_ = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._delayMS = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, r.TimeDelay.after(this._delayMS).promise];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), X_ = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._popup = i,
                    r._options = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.navigation.isPopupTypeOpen(this._popup) || De.services.navigation.showPopup(this._popup, this._options),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), q_ = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._freeTrackerValueToSet = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.fastForward.setFreeTrackerStatus(this._freeTrackerValueToSet),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Q_ = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._popup = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return (e = De.services.navigation.popupLayer.currentView)instanceof this._popup && (e.popupLocked = !0),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo);
            !function(e) {
                e.NONE = "none",
                e.FREE = "free",
                e.RV = "rv",
                e.BUY = "buy"
            }(O_ || (O_ = {}));
            var Z_, $_, ec = function(e) {
                function t(t, i, n, r, o, a) {
                    void 0 === o && (o = 8),
                    void 0 === a && (a = 8);
                    var s = e.call(this) || this;
                    return s.interactive = !0,
                    s.key = t,
                    s._resourceService = De.services.resource,
                    s._headers = s._createHeader(i, n, r, a, o),
                    s.addChild(s._headers.active.image, s._headers.active.label, s._headers.inactive.image, s._headers.inactive.label),
                    s._setTabSize(n, r),
                    s.setActive(!1),
                    s
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.setActive = function(e) {
                    this._headers.active.image.visible = e,
                    this._headers.active.label.visible = e,
                    this._headers.inactive.image.visible = !e,
                    this._headers.inactive.label.visible = !e
                }
                ,
                t.prototype._setTabSize = function(e, t) {
                    this._headers.active.image.setSizes({
                        width: e,
                        height: t
                    }),
                    this._headers.inactive.image.setSizes({
                        width: e,
                        height: t
                    })
                }
                ,
                t.prototype._createHeader = function(e, t, i, n, o) {
                    var a = this._resourceService.getTexture(f.POPUP_TAB_ACTIVE_9SLICE)
                      , s = this._resourceService.getTexture(f.POPUP_TAB_INACTIVE_9SLICE)
                      , _ = new cr(a,20,20,20,20)
                      , c = new cr(s,20,20,20,20);
                    _.anchor.set(.5),
                    c.anchor.set(.5);
                    var l, u, d = {
                        fitWidth: t - n,
                        fitHeight: i - o,
                        fitToBox: !0
                    }, h = new v.LabelSettings(d), p = new v.LabelSettings(d);
                    if (h.style = vn.darkLarge,
                    p.style = vn.greyLarge,
                    (0,
                    r.isString)(e))
                        (l = new v.Label(e,h)).anchor.set(.5),
                        (u = new v.Label(e,p)).anchor.set(.5);
                    else {
                        (l = De.services.resource.getSprite(e)).anchor.set(.5),
                        (u = De.services.resource.getSprite(e)).anchor.set(.5),
                        u.alpha = .5;
                        var g = Math.min((t - n) / l.width, (i - o) / l.height);
                        l.scale.set(g),
                        u.scale.set(g)
                    }
                    return {
                        active: {
                            image: _,
                            label: l
                        },
                        inactive: {
                            image: c,
                            label: u
                        }
                    }
                }
                ,
                t
            }(Xe.Container), tc = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    i.onTabSwitch = new r.Event;
                    var n = (t.width - 2 * t.tabSpacing) / t.headers.length - t.tabSpacing
                      , o = t.tabHeight;
                    return i._tabGroupMap = i._createTabsGroups(t.headers, t.width, t.height, n, o),
                    i._positionHeaders(t.tabSpacing),
                    i._positionContentContainers(t.tabHeight),
                    i.contentSize = {
                        width: t.width,
                        height: t.height - o
                    },
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(e) {
                    var t = this;
                    this._tabGroupMap.forEach((function(e) {
                        e.tabHeader.off("pointerdown", t._onTabPointerDown, t),
                        e.tabHeader.off("pointerupoutside", (function() {
                            t._tabTarget = void 0
                        }
                        ), t),
                        e.tabHeader.off("pointerup", t._onTabPointerUp, t)
                    }
                    ))
                }
                ,
                t.prototype.addTabContent = function(e, t) {
                    var i = this._tabGroupMap.get(e);
                    i && i.tabContent.addChild(t)
                }
                ,
                t.prototype.addTabHeaderIcon = function(e, t) {
                    var i = this._tabGroupMap.get(e);
                    i && i.tabHeader.addChild(t)
                }
                ,
                t.prototype.switchToTab = function(e) {
                    var t = this._tabGroupMap.get(e);
                    if ((0,
                    r.isUndefined)(t) && (t = this._tabGroupMap.get(Ua.GEMS)),
                    t) {
                        switch (this._activeTabKey = e,
                        e) {
                        case Fa.HALLOWEEN:
                            De.services.analytics.design.reportEventMarketplaceTabOpened(Xi.HALLOWEEN_SHOP);
                            break;
                        case Fa.CHRISTMAS:
                            De.services.analytics.design.reportEventMarketplaceTabOpened(Xi.CHRISTMAS_SHOP);
                            break;
                        case Fa.BLACK_FRIDAY:
                            De.services.analytics.design.reportEventMarketplaceTabOpened(Xi.BLACK_FRIDAY_SHOP)
                        }
                        this._tabGroupMap.forEach((function(e) {
                            e.tabHeader.setActive(!1),
                            e.tabContent.visible = !1
                        }
                        )),
                        t.tabHeader.setActive(!0),
                        t.tabContent.visible = !0,
                        this.onTabSwitch.fire({
                            header: {
                                key: e,
                                label: t.tabHeader.name
                            },
                            content: t.tabContent
                        })
                    }
                }
                ,
                t.prototype._positionHeaders = function(e) {
                    var t = this
                      , i = this._tabGroupMap.size - 1
                      , n = Array.from(this._tabGroupMap).reverse();
                    1 !== n.length && n.forEach((function(n) {
                        var r = n[1].tabHeader;
                        r.pivot.set(-.5 * r.width, 1),
                        r.position.set(e + (r.width + e) * i, 30),
                        i--,
                        t.addChild(r)
                    }
                    ))
                }
                ,
                t.prototype._positionContentContainers = function(e) {
                    var t = this;
                    this._tabGroupMap.forEach((function(i) {
                        var n = i.tabContent;
                        n.position.set(0, e),
                        t.addChild(n)
                    }
                    ))
                }
                ,
                t.prototype._createTabsGroups = function(e, t, i, n, o) {
                    for (var a = this, s = new Map, _ = 0; _ < e.length; _++) {
                        var c = e[_]
                          , l = new ec(c.key,c.label,n,o)
                          , u = this._getEventHeaderIcon(c.key);
                        (0,
                        r.isNull)(u) || this._addEventIconToTab(u, l),
                        l.on("pointerdown", this._onTabPointerDown, this),
                        l.on("pointerupoutside", (function() {
                            a._tabTarget = void 0
                        }
                        ), this),
                        l.on("pointerup", this._onTabPointerUp, this);
                        var d = new Xe.Container;
                        s.set(c.key, {
                            tabHeader: l,
                            tabContent: d
                        })
                    }
                    return s
                }
                ,
                t.prototype._addEventIconToTab = function(e, t) {
                    e.anchor.set(.5, 1),
                    e.position.y = -t.height / 2,
                    t.addChild(e),
                    t.position.y -= e.height
                }
                ,
                t.prototype._getEventHeaderIcon = function(e) {
                    var t = null;
                    switch (e) {
                    case Fa.HALLOWEEN:
                        t = new Xe.Sprite(De.services.resource.getTexture(f.ICON_TAB_HALLOWEEN));
                        break;
                    case Fa.CHRISTMAS:
                        t = new Xe.Sprite(De.services.resource.getTexture(f.ICON_TAB_CHRISTMAS));
                        break;
                    default:
                        t = null
                    }
                    return t
                }
                ,
                t.prototype._onTabPointerDown = function(e) {
                    e.stopPropagation(),
                    this._tabTarget = e.target
                }
                ,
                t.prototype._onTabPointerUp = function(e) {
                    if (this._tabTarget) {
                        var t = e.target;
                        this.switchToTab(t.key),
                        De.services.audio.playSoundEffect(m.BUTTON_TAP),
                        this._tabTarget = void 0
                    }
                }
                ,
                t
            }(Xe.Container), ic = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.priority = _r.IMMEDIATE,
                    t._name = "NoConnectionPopup",
                    t._createPopupBackground(),
                    t._createDisconnectIcon(),
                    t._createMainText(),
                    t._createButton(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createPopupBackground = function() {
                    this._popupBackground = new Ar({
                        size: {
                            width: 850,
                            height: 900
                        },
                        headerText: ce.DISCONNECTION_NO_CONNECTION,
                        headerStyle: vn.popupTitle,
                        showCloseButton: !1
                    }),
                    this._content.addChild(this._popupBackground)
                }
                ,
                t.prototype._createDisconnectIcon = function() {
                    this._icon = rr(De.services.resource.getSprite(f.ICON_POPUP_DISCONNECTION), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -160
                        }
                    }),
                    this._content.addChild(this._icon)
                }
                ,
                t.prototype._createMainText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 750
                    });
                    e.style = vn.darkMedium,
                    this._mainText = new v.Label(nr(Z_ || (Z_ = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.DISCONNECTION_TEXT),e),
                    this._mainText.anchor.set(.5, .5),
                    this._mainText.position.set(0, this._icon.position.y + this._icon.height / 2 + 125),
                    this._content.addChild(this._mainText)
                }
                ,
                t.prototype._createButton = function() {
                    var e = this
                      , t = {
                        name: "close",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    };
                    this._closeButton = new fr(t,{
                        buttonSizes: {
                            width: 375,
                            height: 85
                        }
                    },{
                        text: ce.CLOSE,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    }),
                    this._closeButton.position.set(0, this._popupBackground.height / 2 - 125),
                    this._closeButton.onClick((function() {
                        e.close()
                    }
                    )),
                    this._content.addChild(this._closeButton)
                }
                ,
                t
            }(yr), nc = function(e) {
                return function(t) {
                    return (0,
                    n.__awaiter)(void 0, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return De.services.connection.isConnected ? [4, e(t)] : [3, 2];
                            case 1:
                                return [2, i.sent()];
                            case 2:
                                return De.services.navigation.showPopup(ic, {}),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
            }, rc = function() {
                function e(e) {
                    this.dependencies = e
                }
                return e.prototype.finalize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }();
            !function(e) {
                e[e.SUCCESS = 0] = "SUCCESS",
                e[e.ERROR = 1] = "ERROR",
                e[e.FAIL = 2] = "FAIL"
            }($_ || ($_ = {}));
            var oc, ac = function(e) {
                function t(t, i, n, r) {
                    var o = e.call(this) || this;
                    o._resourcesServices = De.services.resource,
                    o.addChild(new cr(o._resourcesServices.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE),10,10,10,10)).setSizes({
                        width: n,
                        height: r
                    });
                    var a = rr(o._resourcesServices.getSprite(Ja[t]), {
                        anchor: {
                            x: .5,
                            y: 1
                        },
                        position: {
                            x: .5 * n,
                            y: .7 * r
                        }
                    })
                      , s = .8 * r / a.height;
                    a.scale.set(s),
                    o.addChild(a);
                    var _ = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: r / 3.5,
                        fitWidth: n - 50
                    });
                    _.style = vn.darkSmall;
                    var c = rr(new v.Label(String(i),_), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    });
                    return c.position.set(.5 * n, r - .5 * c.height),
                    o.addChild(c),
                    o._amountText = c,
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.updateAmount = function(e) {
                    this._amountText.text = e.toString()
                }
                ,
                t
            }(Xe.Container), sc = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n._inventoryService = De.services.inventory,
                    n._calculatedSquareSize = 0,
                    n._ingredientsMap = new Map,
                    n._scrollContainer = new v.ScrollableContainer({
                        friction: .8,
                        autoFitContent: !0
                    }),
                    n._scrollContainer.position.set(15, 15),
                    n._scrollContainer.setBounds(new Xe.Rectangle(0,0,t,i)),
                    n.addChild(n._scrollContainer),
                    n._calculatedSquareSize = (t - 90) / 5,
                    n._fitAndMaskScrollContainer(),
                    v.GroupsCore.Updateables.add(n._scrollContainer),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    e.prototype.destroy.apply(this, t),
                    v.GroupsCore.Updateables.remove(this._scrollContainer)
                }
                ,
                t.prototype.addIngredients = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        if (!t._ingredientsMap.get(e)) {
                            var i = new ac(e,t._inventoryService.getAmount(e),t._calculatedSquareSize,t._calculatedSquareSize);
                            t._scrollContainer.addContent(i),
                            t._ingredientsMap.set(e, i)
                        }
                    }
                    )),
                    this._repositionIngredients()
                }
                ,
                t.prototype._fitAndMaskScrollContainer = function() {
                    var e = (new Xe.Graphics).beginFill(16777215).drawShape(this._scrollContainer.getBounds()).endFill();
                    this._scrollContainer.mask = e,
                    this.addChild(e),
                    this._scrollContainer.setPosition(new Xe.Point(0,0))
                }
                ,
                t.prototype._repositionIngredients = function() {
                    var e = this
                      , t = 0;
                    this._ingredientsMap.forEach((function(i) {
                        var n = t % 5
                          , r = Math.floor(t / 5);
                        i.x = (15 + e._calculatedSquareSize) * n,
                        i.y = (30 + e._calculatedSquareSize) * r,
                        t++
                    }
                    )),
                    this._scrollContainer.fitContentBounds()
                }
                ,
                t
            }(Xe.Container), _c = [{
                name: "scaleUp",
                duration: .195,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }]
                }
            }], cc = [{
                name: "scaleDown",
                duration: .195,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 1,
                        ease: "power2.out",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }]
                }
            }], lc = {
                left: {
                    x: 0,
                    y: .5
                },
                center: {
                    x: .5,
                    y: .5
                },
                right: {
                    x: 1,
                    y: .5
                }
            }, uc = function(e) {
                function t(t, i, n, r, o) {
                    var a, s = this;
                    (s = e.call(this, t, i, n) || this)._iconPosition = r.iconPosition,
                    s._icon = De.services.resource.getSprite(r.iconImage);
                    var _ = r.iconAlignment ? lc[r.iconAlignment] : lc.center;
                    s._icon.anchor.copyFrom(_),
                    s._icon.position.set(r.iconPosition.x, r.iconPosition.y);
                    var c = null !== (a = r.iconScale) && void 0 !== a ? a : s.icon.scale;
                    return s._icon.scale.set(c.x, c.y),
                    s.addContent(s._icon),
                    o && s.addContent(o),
                    s
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "icon", {
                    get: function() {
                        return this._icon
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.updateIcon = function(e, t, i) {
                    var n = null != t ? t : this._iconPosition
                      , r = null != i ? i : this.icon.scale
                      , o = e ? De.services.resource.getTexture(e) : Xe.Texture.EMPTY;
                    this._icon.texture = o,
                    this._icon.updateTransform(),
                    this._icon.position.set(n.x, n.y),
                    this._icon.scale.set(r.x, r.y),
                    this._icon.anchor.set(.5),
                    this.addContent(this._icon)
                }
                ,
                t
            }(fr);
            !function(e) {
                e[e.MAKE = 0] = "MAKE",
                e[e.FAST_FORWARD = 1] = "FAST_FORWARD",
                e[e.CLAIM = 2] = "CLAIM"
            }(oc || (oc = {}));
            var dc, hc = {
                bottomHeight: 30,
                leftWidth: 20,
                rightWidth: 20,
                topHeight: 20
            }, pc = function(e) {
                function t(t, i) {
                    var n, o, a, s = e.call(this) || this;
                    s.onClaim = new r.Event,
                    s.onFastForward = new r.Event,
                    s.onMake = new r.Event,
                    s._resourcesService = De.services.resource,
                    s._timer = null,
                    s._buttonStateMap = ((n = {})[ps.AVAILABLE] = oc.MAKE,
                    n[ps.COMPLETE] = oc.CLAIM,
                    n[ps.IN_PROGRESS] = oc.FAST_FORWARD,
                    n[ps.STARTABLE] = oc.MAKE,
                    n),
                    s._fastForwardIconSettings = ((o = {})[O_.NONE] = null,
                    o[O_.FREE] = {
                        iconPosition: {
                            x: 0,
                            y: 0
                        },
                        asset: void 0,
                        text: ce.CD_POPOUT_BUTTON_COMPLETE,
                        textPosition: {
                            x: 0,
                            y: -5
                        }
                    },
                    o[O_.BUY] = {
                        iconPosition: {
                            x: -50,
                            y: -15
                        },
                        asset: f.ICON_BTN_ORDERS_FASTFORWARD_GEM,
                        text: void 0,
                        textPosition: {
                            x: 40,
                            y: -5
                        }
                    },
                    o[O_.RV] = {
                        iconPosition: {
                            x: 0,
                            y: -2
                        },
                        asset: f.ICON_BTN_VIDEO_WHITE,
                        text: void 0,
                        textPosition: {
                            x: 40,
                            y: -5
                        }
                    },
                    o);
                    var _ = s._createBackgroundTimer(t - 12, 1.5 * i);
                    s.addChild(_);
                    var c = s._resourcesService.getSprite(f.ICON_TIMER_REGENERATING);
                    c.position.set(0, -10),
                    c.scale.set(1.25),
                    _.addChild(c);
                    var l = new v.LabelSettings({
                        fitHeight: .5 * i,
                        fitWidth: .75 * t,
                        fitToBox: !0
                    });
                    l.style = vn.lightTiny;
                    var u = new v.Label("00M 00S",l);
                    return u.anchor.set(0, .5),
                    u.position.x = c.x + c.width + 5,
                    u.position.y = c.height / 2 - 5,
                    _.addChild(u),
                    s._buttons = ((a = {})[oc.CLAIM] = s.addChild(s._createClaimButton(t, i)),
                    a[oc.MAKE] = s.addChild(s._createMakeButton(t, i)),
                    a[oc.FAST_FORWARD] = s.addChild(s._createFastForwardButton(t, i)),
                    a),
                    s.pivot.set(.5 * t, 0),
                    s._timerBackground = _,
                    s._timerLabel = u,
                    s
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    e.prototype.destroy.apply(this, t),
                    this.onClaim.removeAllListeners(),
                    this.onFastForward.removeAllListeners(),
                    this.onMake.removeAllListeners(),
                    this._timer && this._timer.onUpdate.removeListener(this._updateTimeLabel, this)
                }
                ,
                t.prototype.setCurentOrder = function(e) {
                    this._currentOrder = e
                }
                ,
                t.prototype.updateOrderButtons = function(e) {
                    if (e === this._currentOrder) {
                        var t = this._buttons[0];
                        e.state !== ps.STARTABLE ? t.updateButtonTexture(f.BTN_DEFAULT_ORANGE_IDLE, f.BTN_DEFAULT_ORANGE_ACTIVE) : t.updateButtonTexture(f.BTN_DEFAULT_GREEN_IDLE, f.BTN_DEFAULT_GREEN_ACTIVE),
                        this._swapButtons(e),
                        this._currentOrderState = e.state
                    }
                }
                ,
                t.prototype.setOrderTimer = function(e) {
                    this._timer && (this._timer.onUpdate.removeListener(this._updateTimeLabel, this),
                    this._timer = null),
                    this._timer = e,
                    this._timer.onUpdate.addListener(this._updateTimeLabel, this)
                }
                ,
                t.prototype.updateFastForwardButton = function(e) {
                    if (e) {
                        var t = e.cost
                          , i = e.type
                          , n = this._buttons[oc.FAST_FORWARD]
                          , r = this._fastForwardIconSettings[i];
                        if (r) {
                            n.updateIcon(r.asset, r.iconPosition);
                            var o = r.text ? r.text : t.amount <= 0 ? "" : t.amount.toString();
                            n.updateText(o, r.textPosition)
                        }
                    }
                }
                ,
                t.prototype._updateTimeLabel = function(e) {
                    var t = e.remainingTime;
                    this._timerLabel.text = r.StringUtility.formatMilliseconds(t, {
                        showSecondsBelowMilliseconds: 36e5,
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        }
                    })
                }
                ,
                t.prototype._createClaimButton = function(e, t) {
                    var i = new fr({
                        name: "orderClaim",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: e,
                            height: t
                        },
                        buttonCorners: hc
                    },{
                        text: ce.ORDER_CLAIM,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -8
                        }
                    });
                    return i.onClick(this._onClaimButtonPressed.bind(this)),
                    i.visible = !1,
                    i
                }
                ,
                t.prototype._createMakeButton = function(e, t) {
                    var i = new fr({
                        name: "orderMake",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREEN_IDLE
                    },{
                        buttonSizes: {
                            width: e,
                            height: t
                        },
                        buttonCorners: hc
                    },{
                        text: ce.ORDER_MAKE,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -8
                        }
                    });
                    return i.onClick(this._onMakeButtonPressed.bind(this)),
                    i.visible = !1,
                    i
                }
                ,
                t.prototype._createFastForwardButton = function(e, t) {
                    var i = new uc({
                        name: "orderFastForward",
                        buttonIdle: f.BTN_DEFAULT_ORANGE_IDLE,
                        buttonActive: f.BTN_DEFAULT_ORANGE_ACTIVE
                    },{
                        buttonSizes: {
                            width: e,
                            height: t
                        },
                        buttonCorners: hc
                    },{
                        text: "",
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: 0
                        },
                        fitBoxSizes: {
                            width: e - 50,
                            height: t
                        }
                    },{
                        iconImage: f.ICON_BTN_ORDERS_FASTFORWARD_GEM,
                        iconPosition: {
                            x: 0,
                            y: 0
                        }
                    });
                    return i.onClick(this._onFastForwardButtonPressed.bind(this)),
                    i.visible = !1,
                    i
                }
                ,
                t.prototype._createBackgroundTimer = function(e, t) {
                    var i = new cr(this._resourcesService.getTexture(f.BTN_FASTFORWARD_BG_9SLICES),20,20,20,20);
                    return i.setSizes({
                        width: e,
                        height: t
                    }),
                    i.anchor.set(.5, 1),
                    i
                }
                ,
                t.prototype._onClaimButtonPressed = function() {
                    this.onClaim.fire(this._currentOrder)
                }
                ,
                t.prototype._onMakeButtonPressed = function() {
                    this.onMake.fire(this._currentOrder)
                }
                ,
                t.prototype._onFastForwardButtonPressed = function() {
                    this.onFastForward.fire(this._currentOrder)
                }
                ,
                t.prototype._swapButtons = function(e) {
                    var t = this._getTheButtons(this._currentOrderState, e.state)
                      , i = t.currentButton
                      , n = t.nextButton;
                    i.visible = n.visible = !0;
                    var r = new ur(cc);
                    r.setTargets({
                        container: i
                    }),
                    r.onEnd.addListener((function() {
                        return r.dispose()
                    }
                    ), null),
                    r.play("scaleDown");
                    var o = new ur(_c);
                    o.setTargets({
                        container: n
                    }),
                    o.onEnd.addListener((function() {
                        return o.dispose()
                    }
                    ), null),
                    o.play("scaleUp"),
                    e.state === ps.IN_PROGRESS ? this._showTimerBackground() : this._hideTimerBackground()
                }
                ,
                t.prototype._getTheButtons = function(e, t) {
                    return {
                        currentButton: this._buttons[this._buttonStateMap[e]] || new Xe.Container,
                        nextButton: this._buttons[this._buttonStateMap[t]]
                    }
                }
                ,
                t.prototype._showTimerBackground = function() {
                    var e = new ur(_c);
                    e.setTargets({
                        container: this._timerBackground
                    }),
                    e.onEnd.addListener((function() {
                        return e.dispose()
                    }
                    ), null),
                    e.play("scaleUp")
                }
                ,
                t.prototype._hideTimerBackground = function() {
                    var e = new ur(cc);
                    e.setTargets({
                        container: this._timerBackground
                    }),
                    e.onEnd.addListener((function() {
                        return e.dispose()
                    }
                    ), null),
                    e.play("scaleDown")
                }
                ,
                t
            }(Xe.Container), vc = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n._blueprintCollectionService = De.services.blueprintCollection,
                    n._resourcesService = De.services.resource,
                    t.forEach((function(e, t) {
                        var i = n._resourcesService.getSprite(Xa[e]);
                        i.anchor.set(0, .5),
                        i.position.set((10 + i.width) * t, 0),
                        n.addChild(i)
                    }
                    )),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Xe.Container), gc = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    n._resourcesService = De.services.resource,
                    n._localizationService = De.services.localization;
                    var r = new cr(n._resourcesService.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE),10,10,10,10);
                    r.anchor.set(.5),
                    r.setSizes({
                        width: t,
                        height: i
                    }),
                    n.addChild(r),
                    n._rewardCenterContainer = new Xe.Container,
                    n.addChild(n._rewardCenterContainer);
                    var o = new v.LabelSettings({
                        fitWidth: 300,
                        fitHeight: i,
                        fitToBox: !0
                    });
                    o.style = vn.darkMedium;
                    var a = new v.Label(n._localizationService.getText(ce.REWARDS),o);
                    return a.anchor.set(0, .5),
                    n._rewardCenterContainer.addChild(a),
                    n._rewardItemsContainer = new Xe.Container,
                    n._rewardCenterContainer.addChild(n._rewardItemsContainer),
                    n._rewardsText = a,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createRewardPreview = function(e) {
                    this._rewardItemsContainer.destroy({
                        children: !0
                    }),
                    this._rewardItemsContainer = new Xe.Container,
                    this._rewardItemsContainer.position.set(this._rewardsText.width, 0),
                    this._rewardCenterContainer.addChild(this._rewardItemsContainer);
                    var t = new vc(e,200);
                    t.position.x = 37.5,
                    this._rewardItemsContainer.addChild(t);
                    var i = this._rewardsText.width + 75 * (e.length + 1);
                    this._rewardCenterContainer.pivot.set(.5 * i, 0)
                }
                ,
                t
            }(Xe.Container), fc = function(e) {
                function t(t, i, n) {
                    var r = e.call(this) || this;
                    r._resourcesService = De.services.resource,
                    r.selected = De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN02_9SLICE),
                    r.unSelected = De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE),
                    r.interactive = !0,
                    r.buttonMode = !0,
                    r.orderData = t,
                    r._background = new cr(r.unSelected,10,10,10,10),
                    r._background.setSizes({
                        width: i,
                        height: n
                    }),
                    r._background.anchor.set(0, 0),
                    r.addChild(r._background);
                    var o = rr(r._resourcesService.getSprite(r.orderData.recipe.image), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: .5 * r._background.width,
                            y: .35 * r._background.height
                        }
                    });
                    return ds(o, .75 * r._background.width),
                    r.addChild(o),
                    r._stateIndicatorContainer = new Xe.Container,
                    r._stateIndicatorContainer.position.set(i, 0),
                    r.addChild(r._stateIndicatorContainer),
                    r._stateIndicators = r._createOrderStatusIcon(r._background.width, r._background.height),
                    r._rewardContainer = r._createRewardContainer(r.orderData.recipe.reward, 0),
                    r._rewardContainer.position.set(i / 2 - r._rewardContainer.width / 2, .85 * n),
                    r.addChild(r._rewardContainer),
                    r.changeState(r.orderData.order.state),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.changeState = function(e) {
                    for (var t in this._stateIndicators)
                        this._stateIndicators[t].visible = !1;
                    this._stateIndicators[ps[e]].visible = !0,
                    this.alpha = e === ps.AVAILABLE ? .8 : 1
                }
                ,
                t.prototype.setSelected = function() {
                    this._background.texture = this.selected,
                    this._background.textureUpdated(),
                    this.scale.set(1)
                }
                ,
                t.prototype.setUnSelected = function() {
                    this._background.texture = this.unSelected,
                    this._background.textureUpdated(),
                    this.scale.set(.8)
                }
                ,
                t.prototype._createRewardContainer = function(e, t) {
                    var i = new vc(e,t);
                    return i.scale.set(.55),
                    i
                }
                ,
                t.prototype._createOrderStatusIcon = function(e, t) {
                    var i = {
                        COMPLETE: new Xe.Sprite(this._resourcesService.getTexture(f.ICON_NOTIFICATION_DONE)),
                        IN_PROGRESS: new Xe.Sprite(this._resourcesService.getTexture(f.ICON_TIMER_REGENERATING)),
                        STARTABLE: new Xe.Sprite(this._resourcesService.getTexture(f.ICON_NOTIFICATION_ATTENTION)),
                        AVAILABLE: new Xe.Sprite(Xe.Texture.EMPTY)
                    };
                    for (var n in i) {
                        var r = i[n];
                        r.position.set(-5, 5),
                        r.anchor.set(1, 0),
                        r.scale.set(e / r.width * .4, t / r.height * .4),
                        this._stateIndicatorContainer.addChild(i[n])
                    }
                    return i.IN_PROGRESS.scale.set(t / i.IN_PROGRESS.height * .4),
                    i.IN_PROGRESS.position.set(-5, -5),
                    i
                }
                ,
                t
            }(Xe.Container), Ec = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n.onOrderSelected = new r.Event,
                    n._orders = [],
                    n._maxOrders = De.services.buildings.allBuildingsWithRecipes.length,
                    n._calculatedOrderWidth = (t - (2 * n._maxOrders + 1)) / n._maxOrders,
                    n._calculatedSpacing = (t - 18 - n._calculatedOrderWidth * n._maxOrders) / n._maxOrders - 1,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function() {
                    for (var t = [], i = 0; i < arguments.length; i++)
                        t[i] = arguments[i];
                    e.prototype.destroy.apply(this, t),
                    this.onOrderSelected.removeAllListeners()
                }
                ,
                t.prototype.removeOrders = function() {
                    this.removeChildren(),
                    this._orders = []
                }
                ,
                t.prototype.addOrders = function(e) {
                    for (var t = 0; t < this._maxOrders; t++) {
                        var i = e[t];
                        if (!i)
                            break;
                        var n = this._createOrderElement(i)
                          , r = 12 + (this._calculatedSpacing + this._calculatedOrderWidth) * this._orders.length;
                        n.pivot.set(.5 * this._calculatedOrderWidth, 0),
                        n.position.x = r + n.pivot.x,
                        n.changeState(i.order.state),
                        n.on("pointerdown", this._selectOrder, this),
                        this.addChild(n),
                        this._orders.push(n)
                    }
                }
                ,
                t.prototype.updateOrderStatus = function(e) {
                    for (var t = 0, i = this._orders; t < i.length; t++) {
                        var n = i[t];
                        if (e === n.orderData.order)
                            return void n.changeState(e.state)
                    }
                }
                ,
                t.prototype.selectOrderElement = function(e) {
                    for (var t = 0, i = this._orders; t < i.length; t++) {
                        var n = i[t];
                        if (e === n.orderData.order)
                            return void this._selectOrder({
                                target: n
                            })
                    }
                }
                ,
                t.prototype._selectOrder = function(e) {
                    var t = e.target;
                    this._orders.forEach((function(e) {
                        return e.setUnSelected()
                    }
                    )),
                    t.setSelected(),
                    this.onOrderSelected.fire(t.orderData)
                }
                ,
                t.prototype._createOrderElement = function(e) {
                    return new fc(e,this._calculatedOrderWidth,this._calculatedOrderWidth)
                }
                ,
                t
            }(Xe.Container), mc = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n.helpIconPressed = new r.Event,
                    n._resourcesService = De.services.resource,
                    n._recipeIngredientsMap = new Map,
                    n._ingredientsContainer = new Xe.Container,
                    n.addChild(n._ingredientsContainer),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createRecipePreview = function(e, t, i) {
                    this._ingredientsContainer.destroy({
                        children: !0
                    }),
                    this._ingredientsContainer = new Xe.Container,
                    this._ingredientsContainer.position.set(25, 0),
                    this._recipeIngredientsMap.clear(),
                    this._createVisuals(t, i),
                    this.updateRecipeRequirements(e),
                    this.addChild(this._ingredientsContainer)
                }
                ,
                t.prototype.updateItemRequirement = function(e, t) {
                    var i = this._recipeIngredientsMap.get(e);
                    if (i) {
                        var n = t < i.ingredient.amount ? vn.lightRedExtraSmall : vn.darkExtraSmall;
                        i.textVisual.text = this._formatAmountString(t, i.ingredient.amount),
                        i.textVisual.style = n
                    }
                }
                ,
                t.prototype.updateRecipeRequirements = function(e) {
                    var t = this
                      , i = De.services.recipes.getRecipe(e.recipe);
                    e.state !== ps.IN_PROGRESS && e.state !== ps.COMPLETE || i.ingredients.forEach((function(e) {
                        var i = t._recipeIngredientsMap.get(e.key);
                        i && (i.textVisual.alpha = 0)
                    }
                    ))
                }
                ,
                t.prototype._createVisuals = function(e, t) {
                    var i = this
                      , n = [];
                    e.ingredients.forEach((function(e) {
                        var r = new Xe.Sprite(i._resourcesService.getTexture(Ja[e.key]))
                          , o = t.get(e.key)
                          , a = (o = Ee(o) ? o : 0) < e.amount ? vn.lightRedExtraSmall : vn.darkExtraSmall
                          , s = {
                            sprite: r,
                            textVisual: new Xe.Text(i._formatAmountString(o, e.amount),a),
                            ingredient: e
                        };
                        n.push(s),
                        i._recipeIngredientsMap.set(e.key, s)
                    }
                    ));
                    var r = new Xe.Sprite(this._resourcesService.getTextureByAlias(e.image.alias))
                      , o = this._createRecipeArithmeticOperators(e.ingredients.length);
                    this._updateVisuals(n, r, o)
                }
                ,
                t.prototype._updateVisuals = function(e, t, i) {
                    var n = this;
                    e.forEach((function(e, t) {
                        var r = 90 * t * 2;
                        rr(e.sprite, {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            scale: {
                                x: .75,
                                y: .75
                            },
                            position: {
                                x: r,
                                y: -15
                            }
                        }),
                        n._ingredientsContainer.addChild(e.sprite);
                        var o = rr(De.services.resource.getSprite(f.ICON_HELP), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: e.sprite.width - 10,
                                y: -e.sprite.width / 2
                            }
                        });
                        e.sprite.addChild(o),
                        o.interactive = !0,
                        o.addListener("pointertap", (function() {
                            var t;
                            null === (t = n.helpIconPressed) || void 0 === t || t.fire(e.ingredient.key)
                        }
                        ));
                        var a = e.textVisual;
                        rr(a, {
                            anchor: {
                                x: .5,
                                y: 0
                            },
                            position: {
                                x: e.sprite.x,
                                y: 50
                            }
                        }),
                        n._ingredientsContainer.addChild(a);
                        var s = i[t];
                        rr(s, {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: r + 90,
                                y: e.sprite.position.y
                            }
                        }),
                        n._ingredientsContainer.addChild(s)
                    }
                    )),
                    ds(rr(t, {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 180 * e.length + 35,
                            y: -15
                        }
                    }), 175),
                    this._ingredientsContainer.addChild(t),
                    this.pivot.set(this._ingredientsContainer.width, 0)
                }
                ,
                t.prototype._createRecipeArithmeticOperators = function(e) {
                    for (var t = [], i = 0; i < e - 1; i++) {
                        var n = new Xe.Text("+",vn.darkMedium);
                        t.push(n)
                    }
                    var r = new Xe.Text("=",vn.darkMedium);
                    return t.push(r),
                    t
                }
                ,
                t.prototype._formatAmountString = function(e, t) {
                    var i = "${0}/${1}";
                    return (i = i.replace("${0}", e.toString())).replace("${1}", t.toString())
                }
                ,
                t
            }(Xe.Container), yc = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    n._resourcesService = De.services.resource;
                    var r = new gc(t - 20,100);
                    r.position.set(500, 270),
                    n.addChild(r),
                    n._npcImage = new Xe.Sprite(Xe.Texture.EMPTY),
                    rr(n._npcImage, {
                        position: {
                            x: 30,
                            y: 260
                        },
                        anchor: {
                            x: 0,
                            y: 1
                        }
                    }),
                    n.addChild(n._npcImage);
                    var o = new mc(t,i);
                    o.position.set(t, 100),
                    n.addChild(o);
                    var a = new pc(200,90);
                    a.position.set(990, 275),
                    n.addChild(a);
                    var s = new Ec(t,150);
                    return s.position.set(0, 370),
                    n.addChild(s),
                    n.recipePreview = o,
                    n.rewardPreview = r,
                    n.orderListSelector = s,
                    n.orderMultiButton = a,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.swapNpcImage = function(e) {
                    var t = De.services.buildings.getBuildingConfigProperty(e.buildingID, "npcIconKey");
                    this._npcImage.texture = this._resourcesService.getTexture({
                        alias: t
                    }),
                    this._npcImage.texture.update()
                }
                ,
                t
            }(Xe.Container);
            !function(e) {
                e[e.ORDERS = 0] = "ORDERS",
                e[e.INGREDIENTS = 1] = "INGREDIENTS"
            }(dc || (dc = {}));
            var Tc, Ac, Cc, Ic = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    i.priority = _r.NORMAL,
                    i._name = "OrdersPopup",
                    i._tabHeaders = {
                        ORDERS: {
                            key: "orders",
                            label: nr(Tc || (Tc = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAB_ORDERS)
                        },
                        INGREDIENTS: {
                            key: "ingredients",
                            label: nr(Ac || (Ac = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAB_INGREDIENTS)
                        }
                    },
                    i._headerSize = {
                        width: 666.6666666666666,
                        height: 75
                    },
                    i._popupSize = {
                        width: 1e3,
                        height: 730
                    },
                    i._tabContentGroupSize = {
                        width: 1e3,
                        height: 625
                    },
                    i._recipeService = De.services.recipes,
                    i._inventoryService = De.services.inventory,
                    i._timerService = De.services.timer,
                    i._assetLoaderService = De.services.assetLoader,
                    i._fastForwardService = De.services.fastForward,
                    i._defaultTab = i._tabHeaders.ORDERS.key,
                    i._fastForwardTracker = null,
                    i._selectedBuilding = t.buildingID,
                    i._ordersService = t.ordersService,
                    i._upgradeCardService = t.upgradeCard;
                    var r = new Ar({
                        size: {
                            width: i._popupSize.width,
                            height: i._popupSize.height
                        },
                        headerSize: {
                            width: i._headerSize.width,
                            height: i._headerSize.height
                        },
                        headerText: ce.TAB_ORDERS,
                        headerStyle: vn.popupTitle,
                        headerIcon: f.ICON_POPUP_HEADER_ORDERS
                    });
                    r.onCloseClick((function() {
                        return i.close()
                    }
                    )),
                    i._content.addChild(r);
                    var o = new tc({
                        headers: i._getTabHeaders(),
                        width: i._tabContentGroupSize.width,
                        height: i._tabContentGroupSize.height,
                        tabHeight: 60,
                        tabSpacing: 2
                    });
                    return o.position.x = -.5 * i._popupSize.width,
                    o.position.y = -.5 * i._popupSize.height + 105,
                    i._content.addChild(o),
                    i._tabContentGroup = o,
                    i._popupBackground = r,
                    i.addServices(i.services),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, e.prototype.initialize.call(this, (function() {}
                                ))];
                            case 1:
                                return i.sent(),
                                [4, Promise.all([this._assetLoaderService.loadAtlases(g.INGREDIENTS)])];
                            case 2:
                                return i.sent(),
                                this._prepareOrderTabContent(),
                                this._prepareIngredientsTabContent(),
                                this._tabContentGroup.onTabSwitch.addListener(this._onTabSwitch, this),
                                this._ordersService.onOrderStateChange.addListener(this._onOrderStateChange, this),
                                this._ordersService.onNewOrder.addListener(this._onNewOrder, this),
                                this._inventoryService.onItemAmountChange.addListener(this._onInventoryAmountChange, this),
                                t(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    var e;
                    this._ordersService.onOrderStateChange.removeListener(this._onOrderStateChange, this),
                    this._ordersService.onNewOrder.removeListener(this._onNewOrder, this),
                    this._inventoryService.onItemAmountChange.removeListener(this._onInventoryAmountChange, this),
                    null === (e = this._fastForwardTracker) || void 0 === e || e.strategyChanged.removeListener(this._onStrategyChanged, this),
                    this._options = {}
                }
                ,
                t.prototype._isOrdersOnboardingFinished = function() {
                    return !this._options.onboardingService.activeTrackKey
                }
                ,
                t.prototype._getTabHeaders = function() {
                    var e = [this._tabHeaders.ORDERS];
                    return this._isOrdersOnboardingFinished() && e.push(this._tabHeaders.INGREDIENTS),
                    e
                }
                ,
                t.prototype._onTabSwitch = function(e) {
                    var t = {
                        width: this._popupSize.width,
                        height: this._popupSize.height
                    };
                    e.header.key === this._tabHeaders.INGREDIENTS.key && (t.height = 1.2 * t.height),
                    this._popupBackground.resize(t)
                }
                ,
                t.prototype._prepareIngredientsTabContent = function() {
                    var e = this
                      , t = Object.values(Sn).filter((function(t) {
                        return e._inventoryService.hasAmount(t, 1)
                    }
                    ));
                    this._ingredientsTabContent = new sc(this._tabContentGroup.contentSize.width,1.2 * this._tabContentGroup.contentSize.height),
                    this._ingredientsTabContent.addIngredients(t),
                    this._tabContentGroup.addTabContent(this._tabHeaders.INGREDIENTS.key, this._ingredientsTabContent)
                }
                ,
                t.prototype._prepareOrderTabContent = function() {
                    var e = this;
                    this._ordersTabContent = new yc(this._tabContentGroup.contentSize.width,this._tabContentGroup.contentSize.height),
                    this._ordersTabContent.orderMultiButton.onClaim.listenOnce(this._onOrderClaim, this),
                    this._ordersTabContent.orderMultiButton.onMake.listenOnce(this._onOrderMake, this),
                    this._ordersTabContent.orderMultiButton.onFastForward.addListener(this._onOrderFastForward, this),
                    this._isOrdersOnboardingFinished() && this._ordersTabContent.recipePreview.helpIconPressed.listenOnce(this._openDiscoveryPopup, this),
                    this._ordersTabContent.orderListSelector.onOrderSelected.addListener(this._onSelectedOrder, this);
                    var t = this._getActiveOrdersWithRecipes();
                    this._ordersTabContent.orderListSelector.addOrders(t);
                    var i = t[0];
                    if (this._selectedBuilding) {
                        var n = t.find((function(t) {
                            return t.order.buildingID === e._selectedBuilding
                        }
                        ));
                        i = null != n ? n : i
                    }
                    this._ordersTabContent.orderListSelector.selectOrderElement(i.order),
                    this._tabContentGroup.switchToTab(this._defaultTab),
                    this._tabContentGroup.addTabContent(this._tabHeaders.ORDERS.key, this._ordersTabContent)
                }
                ,
                t.prototype._onNewOrder = function() {
                    var e = this;
                    this._ordersTabContent.orderListSelector.removeOrders();
                    var t = this._getActiveOrdersWithRecipes()
                      , i = t[0];
                    if (this._selectedBuilding) {
                        var n = t.find((function(t) {
                            return t.order.buildingID === e._selectedBuilding
                        }
                        ));
                        i = null != n ? n : i
                    }
                    this._ordersTabContent.orderListSelector.addOrders(t),
                    this._ordersTabContent.orderListSelector.selectOrderElement(i.order)
                }
                ,
                t.prototype._onInventoryAmountChange = function(e) {
                    this._ordersTabContent.recipePreview.updateItemRequirement(e.key, e.current)
                }
                ,
                t.prototype._onSelectedOrder = function(e) {
                    var t = this._getCollectedRecipeIngredients(e.recipe);
                    this._ordersTabContent.recipePreview.createRecipePreview(e.order, e.recipe, t),
                    this._ordersTabContent.rewardPreview.createRewardPreview(e.recipe.reward),
                    this._ordersTabContent.orderMultiButton.setCurentOrder(e.order),
                    this._ordersTabContent.orderMultiButton.updateOrderButtons(e.order),
                    this._ordersTabContent.swapNpcImage(e.order),
                    this._updateOrderTimer(e.order),
                    this._fastForwardTracker = this._getFastForwardTracker(e.order),
                    this._fastForwardTracker && (this._fastForwardTracker.strategyChanged.addListener(this._onStrategyChanged, this),
                    this._ordersTabContent.orderMultiButton.updateFastForwardButton(this._fastForwardTracker))
                }
                ,
                t.prototype._onOrderClaim = function(e) {
                    this._claimOrder(e),
                    this.close()
                }
                ,
                t.prototype._onOrderMake = function(e) {
                    this._makeOrder(e),
                    this._updateOrderTimer(e),
                    this._fastForwardTracker = this._getFastForwardTracker(e),
                    this._fastForwardTracker && (this._fastForwardTracker.strategyChanged.addListener(this._onStrategyChanged, this),
                    this._ordersTabContent.orderMultiButton.updateFastForwardButton(this._fastForwardTracker)),
                    this._ordersTabContent.orderMultiButton.onMake.listenOnce(this._onOrderMake, this)
                }
                ,
                t.prototype._onStrategyChanged = function(e) {
                    this._ordersTabContent.orderMultiButton.updateFastForwardButton(this._fastForwardTracker),
                    e === O_.RV && De.services.analytics.design.rvAppear("fastForwardOrder")
                }
                ,
                t.prototype._onOrderFastForward = function(e) {
                    this._fastForwardTracker && this._fastForwardTracker.type === O_.FREE ? this._fastForwardForFree(e) : nc(this._fastForwardOrder.bind(this, e))()
                }
                ,
                t.prototype._onOrderStateChange = function(e) {
                    this._ordersTabContent.orderMultiButton.updateOrderButtons(e),
                    this._ordersTabContent.orderListSelector.updateOrderStatus(e),
                    this._ordersTabContent.recipePreview.updateRecipeRequirements(e)
                }
                ,
                t.prototype._updateOrderTimer = function(e) {
                    if (e.timerId) {
                        var t = this._timerService.getTimerByID(e.timerId);
                        this._ordersTabContent.orderMultiButton.setOrderTimer(t)
                    }
                }
                ,
                t.prototype._getActiveOrdersWithRecipes = function() {
                    var e = this
                      , t = [];
                    return this._ordersService.getBuildingsWithActiveOrders().forEach((function(i) {
                        var n = e._ordersService.getOrderByBuilding(i);
                        if (n) {
                            var r = e._recipeService.getRecipe(n.recipe);
                            t.push({
                                order: n,
                                recipe: r
                            })
                        }
                    }
                    )),
                    t
                }
                ,
                t.prototype._getCollectedRecipeIngredients = function(e) {
                    var t = this
                      , i = new Map;
                    return e.ingredients.forEach((function(e) {
                        var n = t._inventoryService.getAmount(e.key);
                        i.set(e.key, n)
                    }
                    )),
                    i
                }
                ,
                t.prototype._getFastForwardTracker = function(e) {
                    return this._fastForwardTracker && (this._fastForwardTracker.destroy(),
                    this._fastForwardTracker = null),
                    e.state === ps.IN_PROGRESS && (this._fastForwardTracker = this._fastForwardService.createTrackerForOrders(e.timerId)),
                    this._fastForwardTracker
                }
                ,
                t.prototype._fastForwardOrder = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                if (!this._fastForwardTracker)
                                    throw new Error("OrderPreviewController: you can't use the FFTracker because it has been destroyed!");
                                return [4, this._fastForwardTracker.strategy.execute()];
                            case 1:
                                return (t = i.sent().result) === $_.SUCCESS ? this._timerService.getTimerByID(e.timerId).forceComplete() : t === $_.FAIL && this._fastForwardTracker.cost.key === Cn.GEMS && this._options.marketplaceService.openMarketplaceShop(Ua.GEMS),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._fastForwardForFree = function(e) {
                    this._timerService.getTimerByID(e.timerId).forceComplete()
                }
                ,
                t.prototype._claimOrder = function(e) {
                    this._ordersService.rewardOrder(e.buildingID)
                }
                ,
                t.prototype._makeOrder = function(e) {
                    var t = this._recipeService.getRecipe(e.recipe).ingredients;
                    if (this._inventoryService.hasEnoughItems(t))
                        this._ordersService.startOrder(e.buildingID),
                        De.services.analytics.design.orderStatus($i.START);
                    else {
                        var i = [];
                        t.forEach((function(e) {
                            De.services.inventory.hasAmount(e.key, e.amount) || i.push({
                                objectName: e.key,
                                image: us(e.key),
                                totalRequired: e.amount,
                                currentAmount: De.services.inventory.getAmount(e.key)
                            })
                        }
                        )),
                        this._ordersService.openMissingIngredientPopup(i)
                    }
                }
                ,
                t.prototype._openDiscoveryPopup = function(e) {
                    De.services.discovery.openDiscoveryPopup(this._upgradeCardService, e)
                }
                ,
                t
            }(yr), Sc = {
                x: 625,
                y: -30
            }, Oc = function(e) {
                function t() {
                    return e.call(this, Lo.ORDER_TRACK_1) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = p_(this._dependencies.gridFilter, [Ke.Building]);
                    if (e) {
                        this._steps.push(new sa("LogStep","Start of Order Track 1"), new aa("HideElementStep",a_), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1));
                        var t = this._dependencies.ordersService.getOrderByBuilding(E_.MARKET);
                        (0,
                        r.isUndefined)(t) ? this._steps.push(new b_("Pause the market in case the user has refreshed application",E_.MARKET,"pause"), new _a(ln.ORDER_INTRODUCED), new y_("MoveCameraStep",{
                            column: 71,
                            row: 70
                        }), new b_("Unpause market and update the orders",E_.MARKET,"unpause"), new Da("Explain how to make an order","order_1"), new q_("Set a free tracker so the next order can be skipped for free",!0), new H_("allow the user to tap the food truck",e,!0), new _a(ln.ORDER_INTRODUCED,!0), new _a(ln.START_ORDER), new Y_("AwaitPopupOpenStep",Ic), new H_("remove the position from the whitelist",e,!1), new oa("HideConversationStep",!1)) : this._steps.push(new X_("force the order popup to be opened if it isn't already",Ic,{
                            ordersService: this._dependencies.ordersService,
                            marketplaceService: this._dependencies.marketplaceService,
                            onboardingService: this._dependencies.onboarding,
                            upgradeCard: this._dependencies.upgradeCard
                        }), new Y_("AwaitPopupOpenStep",Ic)),
                        this._steps.push(new Q_("locking the popup so it cannot be closed",Ic), new J_("Wait for the popup to be opened",1e3), new fa("ShowClickStep",{
                            animations: [{
                                layer: ea.POPUP,
                                animationName: ta.CLICK,
                                points: {
                                    startPosition: Sc
                                },
                                duration: 1250
                            }, {
                                animationName: ta.DELAY,
                                duration: 200
                            }],
                            loop: !0
                        }), new z_("Wait for the order to be started",E_.MARKET,ps.IN_PROGRESS), new ra("HideAnimatedHandStep"), new _a(ln.START_ORDER,!0), new sa("LogStep","End of Order Track 1"))
                    } else
                        this._logger.error("couldn't find food truck position")
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), bc = function(e) {
                function t() {
                    return e.call(this, Lo.ORDER_TRACK_2) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    this._steps.push(new _a(ln.WAIT_FOR_ORDER_OR_SKIP), new sa("LogStep","Start of Order Track 2"), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new aa("HideElementStep",a_), new X_("force the order popup to be opened if it isn't already",Ic,{
                        ordersService: this._dependencies.ordersService,
                        marketplaceService: this._dependencies.marketplaceService,
                        onboardingService: this._dependencies.onboarding,
                        upgradeCard: this._dependencies.upgradeCard
                    }), new fa("ShowClickStep",{
                        animations: [{
                            animationName: ta.DELAY,
                            duration: 200
                        }, {
                            layer: ea.POPUP,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: Sc
                            },
                            duration: 1250
                        }],
                        loop: !0
                    }), new z_("Wait for the order to be finished",E_.MARKET,ps.COMPLETE), new ra("HideAnimatedHandStep"), new sa("LogStep","End of Order Track 2"), new _a(ln.WAIT_FOR_ORDER_OR_SKIP,!0))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), Rc = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._buildingID = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, new Promise((function(t, i) {
                                var n = function(i) {
                                    i.buildingID === e._buildingID && (e._dependencies.ordersService.onOrderRewarded.removeListener(n, e),
                                    t())
                                };
                                e._dependencies.ordersService.onOrderRewarded.addListener(n, e)
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), wc = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._popup = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return (e = De.services.navigation.popupLayer.currentView)instanceof this._popup && (e.popupLocked = !1,
                            e.close()),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Dc = function(e) {
                function t() {
                    return e.call(this, Lo.ORDER_TRACK_3) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    this._steps.push(new _a(ln.COMPLETE_ORDER), new sa("LogStep","Start of Order Track 3"), new aa("HideElementStep",a_), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new X_("force the order popup to be opened if it isn't already",Ic,{
                        ordersService: this._dependencies.ordersService,
                        marketplaceService: this._dependencies.marketplaceService,
                        onboardingService: this._dependencies.onboarding,
                        upgradeCard: this._dependencies.upgradeCard
                    }), new fa("ShowClickStep",{
                        animations: [{
                            animationName: ta.DELAY,
                            duration: 200
                        }, {
                            layer: ea.POPUP,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: Sc
                            },
                            duration: 1250
                        }],
                        loop: !0
                    }), new Rc("wait for the order rewards to be claimed",E_.MARKET), new wc("force the order popup to close",Ic), new q_("remove the free tracker value",!1), new ra("HideAnimatedHandStep"), new _a(ln.COMPLETE_ORDER,!0), new sa("LogStep","End of Order Track 3"))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), Nc = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._behaviorsToFilter = i,
                    r._behaviorsToAddData = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._dependencies.gridFilter.getFilledCellsWithBehaviors(this._behaviorsToFilter).forEach((function(t) {
                                e._behaviorsToAddData.forEach((function(e) {
                                    var i, n = new e.behavior(e.behaviorData);
                                    null === (i = t.content) || void 0 === i || i.addBehavior(n)
                                }
                                ))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Lc = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event,
                    this._blueprintIDToCheck = "coin_1"
                }
                return e.prototype.initialize = function(e) {
                    var t = this;
                    this._dependencies = e,
                    e.onboarding.isTrackCompleted(Lo.ORDER_TRACK_4) ? r.TimeDelay.nextFrame().then((function() {
                        t.status = !0,
                        t.onStatusChanged.fire()
                    }
                    )) : this._setup()
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._setup = function() {
                    this._family = new __(this._dependencies.world,new c_([Ke.Collectable])),
                    this._family.onGameObjectAdded.addListener(this._checkForCompletion, this),
                    this._checkForCompletion()
                }
                ,
                e.prototype._checkForCompletion = function() {
                    var e = this
                      , t = this._family.getGameObjects();
                    0 !== t.length && t.forEach((function(t) {
                        t.getBlueprintID() === e._blueprintIDToCheck && (r.TimeDelay.nextFrame().then((function() {
                            e.status = !0,
                            e.onStatusChanged.fire()
                        }
                        )),
                        e._family.onGameObjectAdded.removeListener(e._checkForCompletion, e))
                    }
                    ))
                }
                ,
                e
            }(), Bc = function(e) {
                function t() {
                    return e.call(this, Lo.ORDER_TRACK_4, [new Lc]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = g_(this._dependencies.gridFilter, this._dependencies.axonometricProjection)
                      , t = this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.Collectable]);
                    ve(e) ? this._logger.error("couldn't find collectable on the map") : this._steps.push(new _a(ln.COLLECT_COINS_FROM_ORDER), new sa("LogStep","Start of Order Track 4"), new aa("HideElementStep",a_), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new Da("Explain to the user that they can collect the coins","order_2"), new Nc("Add arrow pointers on top of the coins",[Ke.Collectable],[{
                        behavior: Li,
                        behaviorData: {}
                    }]), new y_("MoveCameraStep",e), new fa("ShowClickStep",{
                        animations: [{
                            animationName: ta.DELAY,
                            duration: 200
                        }, {
                            layer: ea.MAIN,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    column: e.column,
                                    row: e.row
                                }
                            },
                            mirror: !0,
                            duration: 1250
                        }],
                        loop: !0
                    }), new H_("allow the user to tap the collectable",t,!0), new l_("Wait for 1 coin to be collected",[Ke.ArrowPointer],1), new ra("HideAnimatedHandStep"), new oa("HideConversationStep"), new Na("ShowElementStep",[Ns.CoinCounterUI]), new sa("LogStep","End of Order Track 4"))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), Pc = [Ns.CratesButtonUI, Ns.EnergyCounterUI, Ns.GemCounterUI, Ns.OrderButtonUI, Ns.ShovelButtonUI, Ns.DiscoveryButtonUI, Ns.MarketplaceButtonUI, Ns.ExtraWorkerButtonUI, Ns.TaskButtonUI, Ns.SpecialOfferButtonUI, Ns.DailyChallengeButtonUI], kc = function(e) {
                function t() {
                    return e.call(this, Lo.ORDER_TRACK_5, [new Lc]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = g_(this._dependencies.gridFilter, this._dependencies.axonometricProjection)
                      , t = this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.Collectable]);
                    ve(e) ? this._logger.error("couldn't find collectable on the map") : this._steps.push(new sa("LogStep","Start of Order Track 5"), new aa("HideElementStep",Pc), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new Nc("Add arrow pointers on top of the coins",[Ke.Collectable],[{
                        behavior: Li,
                        behaviorData: {}
                    }]), new H_("allow the user to tap the collectable",t,!0), new l_("Wait for the rest of the coins to be collected",[Ke.ArrowPointer]), new ra("HideAnimatedHandStep"), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new _a(ln.COLLECT_COINS_FROM_ORDER,!0), new sa("LogStep","End of Order Track 5"))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa);
            !function(e) {
                e[e.LOCK = 0] = "LOCK",
                e[e.BUY = 1] = "BUY",
                e[e.UNLOCKED = 2] = "UNLOCKED",
                e[e.UNLOCKABLE = 3] = "UNLOCKABLE",
                e[e.DISABLED = 4] = "DISABLED"
            }(Cc || (Cc = {}));
            var xc, Gc = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._areaIDToUnlock = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    var e = this;
                    return new Promise((function(t) {
                        var i = function(n) {
                            n.area.id === e._areaIDToUnlock && n.area.state === Cc.UNLOCKED && (e._dependencies.mapAreaService.onAreaStateChange.removeListener(i, e),
                            t())
                        };
                        e._dependencies.mapAreaService.onAreaStateChange.addListener(i, e);
                        var n = e._dependencies.mapAreaService.getMapArea(e._areaIDToUnlock);
                        n && r.TimeDelay.nextFrame().then((function() {
                            i({
                                area: n
                            })
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Uc = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._cellPositions = i,
                    r._behaviorsToRemove = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return la(this._cellPositions) ? this._cellPositions.forEach((function(t) {
                                var i = e._dependencies.mapGrid.getCell(t.column, t.row);
                                i ? e._behaviorsToRemove.forEach((function(e) {
                                    var t;
                                    null === (t = i.content) || void 0 === t || t.removeBehaviorByType(e)
                                }
                                )) : e._logger.warn("couldn't find cell with position: col ".concat(t.column, " and row ").concat(t.row))
                            }
                            )) : this._dependencies.gridFilter.getFilledCellsWithBehaviors(this._cellPositions).forEach((function(t) {
                                e._behaviorsToRemove.forEach((function(e) {
                                    var i;
                                    null === (i = t.content) || void 0 === i || i.removeBehaviorByType(e)
                                }
                                ))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo);
            !function(e) {
                e[e.HUD = 0] = "HUD",
                e[e.MAIN = 1] = "MAIN"
            }(xc || (xc = {}));
            var Fc, Mc, Vc, Hc, jc, Kc, Wc, zc, Yc, Jc, Xc, qc, Qc, Zc, $c, el, tl, il, nl = function(e) {
                function t(t, i, n, r, o, a) {
                    void 0 === a && (a = !0);
                    var s = e.call(this, t) || this;
                    return s._spineAnimation = null,
                    s._layerToAddEffect = i,
                    s._effectAsset = n,
                    s._effectAnimationName = r,
                    s._effectPosition = o,
                    s._waitForCompletion = a,
                    s
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadSpines(this._effectAsset)];
                            case 1:
                                return i.sent(),
                                this._spineAnimation = De.services.resource.getSpine(this._effectAsset),
                                this._spineAnimation.state.setAnimation(0, this._effectAnimationName, !1),
                                this._spineAnimation.pivot.set(.5),
                                e = ca(this._effectPosition) ? this._dependencies.axonometricProjection.getWorldPosition(this._effectPosition.column, this._effectPosition.row) : this._effectPosition,
                                this._spineAnimation.position.set(e.x, e.y),
                                this._getLayerContainer(this._layerToAddEffect).addChild(this._spineAnimation),
                                [2, new Promise((function(e) {
                                    var i;
                                    null === (i = t._spineAnimation) || void 0 === i || i.state.addListener({
                                        complete: function() {
                                            return (0,
                                            n.__awaiter)(t, void 0, void 0, (function() {
                                                var t;
                                                return (0,
                                                n.__generator)(this, (function(i) {
                                                    switch (i.label) {
                                                    case 0:
                                                        return [4, r.TimeDelay.nextFrame()];
                                                    case 1:
                                                        return i.sent(),
                                                        null === (t = this._spineAnimation) || void 0 === t || t.destroy(),
                                                        this._waitForCompletion && e(),
                                                        [2]
                                                    }
                                                }
                                                ))
                                            }
                                            ))
                                        }
                                    }),
                                    t._waitForCompletion || e()
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getLayerContainer = function(e) {
                    switch (e) {
                    case xc.MAIN:
                        return this._dependencies.mapGridView.getLayer(Yo.PREVIEW_UI);
                    case xc.HUD:
                        return this._dependencies.hudService.hudContainer;
                    default:
                        return this._logger.warn("couldn't find layer for OnScreenEffectLayers.".concat(e, ". Returning MainLayer")),
                        this._dependencies.mapGridView.getLayer(Yo.MAIN)
                    }
                }
                ,
                t
            }(Vo), rl = function(e) {
                function t() {
                    return e.call(this, Lo.EXPAND_LAND_TRACK) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = this._getUnlockLandPopoutPosition();
                    ve(e) ? this._logger.error("couldn't get a unlock land popout position") : this._steps.push(new sa("LogStep","Start of ExpandLandTrack"), new $o("BlockUserInputStep",Uo.ONBOARDING), new aa("HideElementStep",Pc), new _a(ln.EXPAND), new Uc("Make the Food Truck unmovable",[{
                        column: 72,
                        row: 71
                    }],[Ke.Movable]), new J_("AwaitTimerStep",1e3), new y_("MoveCameraStep",{
                        column: 68,
                        row: 72
                    }), new Da("ShowConversationStep","expand_land_1"), new fa("ShowClickStep",{
                        animations: [{
                            animationName: ta.DELAY,
                            duration: 200
                        }, {
                            layer: ea.MAIN,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    x: e.x - 50,
                                    y: e.y - 25
                                }
                            },
                            mirror: !0,
                            duration: 1250
                        }],
                        loop: !0
                    }), new Ho("AllowUserInputStep"), new Gc("AwaitLandUnlockedStep","A2"), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new ra("Hide the animated hand"), new oa("HideConversationStep",!1), new nl("OnScreenEffectStep",xc.MAIN,se.CONFETTI,"animation",{
                        column: 73,
                        row: 77
                    },!1), new J_("AwaitTimerStep",3600), new _a(ln.EXPAND,!0), new _a(ln.EXPAND_SUCCESSFUL), new _a(ln.EXPAND_SUCCESSFUL,!0), new sa("LogStep","End of ExpandLandTrack"))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t.prototype._getUnlockLandPopoutPosition = function() {
                    var e = this._dependencies.mapAreaService.getAreaMarker("A2");
                    if (!ve(e)) {
                        var t = this._dependencies.axonometricProjection.getEditorRemappedPosition(e.position)
                          , i = this._dependencies.axonometricProjection.projection.projectIntoPlane(t);
                        return i.y = i.y - 150,
                        i
                    }
                }
                ,
                t
            }(Wa), ol = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._numberOfCrates = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return e = De.services.inventory.getAmount(Cn.CRATES),
                            [2, new Promise((function(i) {
                                var r = function(o) {
                                    return (0,
                                    n.__awaiter)(t, void 0, void 0, (function() {
                                        return (0,
                                        n.__generator)(this, (function(t) {
                                            return o.key === Cn.CRATES && e > De.services.inventory.getAmount(Cn.CRATES) && (this._numberOfCrates -= 1,
                                            e = De.services.inventory.getAmount(Cn.CRATES),
                                            this._numberOfCrates <= 0 && (De.services.inventory.onItemAmountChange.removeListener(r, this),
                                            i())),
                                            e = De.services.inventory.getAmount(Cn.CRATES),
                                            [2]
                                        }
                                        ))
                                    }
                                    ))
                                };
                                De.services.inventory.onItemAmountChange.addListener(r, t)
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), al = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._dialogName = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return (e = this._dependencies.dialogService.dialogs[this._dialogName]).waitForInput = !0,
                                this._dependencies.dialogService.setCurrentDialogData(e),
                                [4, this._dependencies.dialogService.showDialog()];
                            case 1:
                                return i.sent(),
                                [2, new Promise((function(e) {
                                    t._dependencies.dialogService.onClick((function() {
                                        t._dependencies.dialogService.removeOnClick(),
                                        t._dependencies.dialogService.hideDialog().then(e)
                                    }
                                    ))
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), sl = function(e) {
                function t() {
                    return e.call(this, Lo.REGAIN_CONTROL_TRACK) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onExecute = function() {
                    this._steps.push(new sa("LogStep","Start of Regain control track"), new _a(ln.REGAIN_CONTROL), new al("ConversationWithAnswerStep","regain_control_1"), new Na("ShowElementStep",[Ns.CoinCounterUI, Ns.EnergyCounterUI, Ns.GemCounterUI, Ns.OrderButtonUI, Ns.SettingsButtonUI, Ns.MarketplaceButtonUI, Ns.ShovelButtonUI, Ns.DiscoveryButtonUI, Ns.CratesButtonUI, Ns.ExtraWorkerButtonUI, Ns.TaskButtonUI, Ns.SpecialOfferButtonUI, Ns.DailyChallengeButtonUI]), new Ka("allow all inputs",[ko.OBJECT_DRAG, ko.TAP],!0), new na("ChangeButtonStep",Qo.DEFAULT), new fa("ShowClickStep",{
                        animations: [{
                            layer: ea.HUD,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    x: -80,
                                    y: De.services.canvas.bottom - 350
                                }
                            },
                            mirror: !0,
                            duration: 1250
                        }, {
                            animationName: ta.DELAY,
                            duration: 200
                        }],
                        loop: !0
                    }), new ol("AwaitNumberOfCratesSpawnedStep",2), new ra("HideAnimatedHandStep"), new J_("AwaitTimerStep",5e3), new _a(ln.REGAIN_CONTROL,!0), new sa("LogStep","End of Regain control track"))
                }
                ,
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), _l = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._positions = i,
                    r._behaviors = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    var e = this;
                    return new Promise((function(t, i) {
                        e._setUp(t)
                    }
                    )).then((function() {
                        return e._cleanUp()
                    }
                    ))
                }
                ,
                t.prototype._setUp = function(e) {
                    this._family = new __(this._dependencies.world,new c_(this._behaviors)),
                    this._family.onGameObjectAdded.addListener(this._onObjectAdded.bind(this, e), this),
                    this._onObjectAdded(e)
                }
                ,
                t.prototype._cleanUp = function() {
                    this._family ? this._family.onGameObjectAdded.removeAllListeners() : this._logger.warn("Can't complete onboarding step before it was started!")
                }
                ,
                t.prototype._onObjectAdded = function(e) {
                    if (this._family) {
                        var t = this._family.getGameObjects().map((function(e) {
                            var t;
                            return null !== (t = e.getBehavior(Ke.GridPosition)) && void 0 !== t ? t : {
                                column: -1,
                                row: -1
                            }
                        }
                        ));
                        this._positions.every((function(e) {
                            return t.some((function(t) {
                                return e.column === t.column && e.row === t.row
                            }
                            ))
                        }
                        )) && e()
                    } else
                        this._logger.warn("Can't update onboarding step before it was started!")
                }
                ,
                t
            }(Vo), cl = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    var t = this;
                    this._dependencies = e,
                    e.onboarding.isTrackCompleted(Lo.REPAIR_BUILDING_TRACK_1) ? r.TimeDelay.nextFrame().then((function() {
                        t.status = !0,
                        t.onStatusChanged.fire()
                    }
                    )) : this._setup()
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._setup = function() {
                    this._family = new __(this._dependencies.world,new c_([Ke.UndiscoveredBuilding, Ke.Building])),
                    this._family.onGameObjectAdded.addListener(this._checkForCompletion, this),
                    this._checkForCompletion()
                }
                ,
                e.prototype._checkForCompletion = function() {
                    var e = this
                      , t = this._family.getGameObjects();
                    0 !== t.length && t.forEach((function(t) {
                        var i = t.getBehavior(Ke.Building);
                        i && !De.services.buildings.isDecorative(i.ID) && (De.services.buildings.isBuildingActive(i.ID) || (r.TimeDelay.nextFrame().then((function() {
                            e.status = !0,
                            e.onStatusChanged.fire()
                        }
                        )),
                        e._family.onGameObjectAdded.removeListener(e._checkForCompletion, e)))
                    }
                    ))
                }
                ,
                e
            }(), ll = function() {
                function e(e) {
                    this.status = !1,
                    this.onStatusChanged = new r.Event,
                    this._trackKey = e
                }
                return e.prototype.initialize = function(e) {
                    this._dependencies = e,
                    e.onboarding.isTrackCompleted(this._trackKey) ? (this.status = !0,
                    this.onStatusChanged.fire()) : e.onboarding.onTrackCompleted.addListener(this._onTrackCompleted, this)
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._onTrackCompleted = function(e) {
                    e === this._trackKey && (this.status = !0,
                    this.onStatusChanged.fire(),
                    this._dependencies.onboarding.onTrackCompleted.removeListener(this._onTrackCompleted, this))
                }
                ,
                e
            }(), ul = [Ns.CratesButtonUI, Ns.EnergyCounterUI, Ns.GemCounterUI, Ns.ShovelButtonUI, Ns.DiscoveryButtonUI, Ns.MarketplaceButtonUI, Ns.SpecialOfferButtonUI, Ns.ExtraWorkerButtonUI, Ns.OrderButtonUI, Ns.TaskButtonUI, Ns.DailyChallengeButtonUI], dl = function(e) {
                function t() {
                    return e.call(this, Lo.REPAIR_BUILDING_TRACK_1, [new cl, new ll(Lo.REGAIN_CONTROL_TRACK)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onExecute = function() {
                    var e = this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.UndiscoveredBuilding])[0]
                      , t = p_(this._dependencies.gridFilter, [Ke.UndiscoveredBuilding]);
                    t ? this._steps.push(new sa("LogStep","Start of Repair Building Track 1"), new aa("hide the hud elements",ul), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new _a(ln.CLEAR_NATURE_TO_REPAIR), new y_("MoveCameraStep",e), new Da("ShowConversationStep","repair_building_1"), new J_("AwaitTimerStep",3e3), new fa("ShowClickStep",{
                        animations: [{
                            layer: ea.MAIN,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    row: e.row - 1,
                                    column: e.column - 1
                                }
                            },
                            mirror: !0,
                            duration: 1250
                        }, {
                            animationName: ta.DELAY,
                            duration: 200
                        }],
                        loop: !0
                    }), new H_("allow the user to tap the food truck",t,!0), new _l("AwaitBehaviorAddedStep",[e],[Ke.InteractionTap]), new Ka("allow all inputs",[ko.OBJECT_DRAG, ko.TAP],!0), new ra("HideAnimatedHandStep"), new oa("HideConversationStep",!0), new _a(ln.CLEAR_NATURE_TO_REPAIR,!0), new sa("LogStep","End of Repair Building Track 1")) : this._logger.error("couldn't find repairable building position")
                }
                ,
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), hl = function(e) {
                function t(t, i, n, r) {
                    void 0 === n && (n = -1),
                    void 0 === r && (r = !1);
                    var o = e.call(this, t) || this;
                    return o._resolveAfterAmount = n,
                    o._behaviorsToFilter = i,
                    o._resolveIfNoneFound = r,
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    var e = this;
                    return this._family = new __(this._dependencies.world,new c_(this._behaviorsToFilter)),
                    new Promise((function(t, i) {
                        e._resolveIfNoneFound && 0 === e._family.getGameObjects().length && t();
                        var n = function(i) {
                            e._resolveAfterAmount -= 1,
                            0 !== e._family.getGameObjects().length && 0 !== e._resolveAfterAmount || (e._family.onGameObjectAdded.removeListener(n, e),
                            e._family.destroy(),
                            t())
                        };
                        e._family.onGameObjectAdded.addListener(n, e)
                    }
                    ))
                }
                ,
                t
            }(Vo), pl = function(e) {
                function t() {
                    return e.call(this, Lo.REPAIR_BUILDING_TRACK_2, [new ll(Lo.REPAIR_BUILDING_TRACK_1)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onExecute = function() {
                    var e = this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.Upgrade])[0];
                    this._steps.push(new sa("LogStep","Start of Repair Building Track 2"), new aa("hide the hud elements",ul), new Ka("block all inputs",[ko.OBJECT_DRAG],!1), new y_("MoveCameraStep",e), new _a(ln.CLEAR_NATURE_TO_REPAIR_START_COLLECTING_RESOURCES), new Da("ShowConversationStep","repair_building_2"), new Nc("ExtendBehaviorStep",[Ke.MapSource],[{
                        behavior: Li,
                        behaviorData: {}
                    }]), new hl("AwaitObjectWithBehaviorAddStep",[Ke.WorkerData],1,!1), new oa("HideConversationStep"), new Uc("BehaviorRemoveStep",[Ke.ArrowPointer],[Ke.ArrowPointer]), new Ka("AllowUserInputStep",[ko.OBJECT_DRAG],!0), new Na("show the hud elements",ul), new sa("LogStep","End of Repair Building Track 2"))
                }
                ,
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), vl = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    var t = this;
                    this._dependencies = e,
                    e.onboarding.isTrackCompleted(Lo.REPAIR_BUILDING_TRACK_3) ? r.TimeDelay.nextFrame().then((function() {
                        t.status = !0,
                        t.onStatusChanged.fire()
                    }
                    )) : this._setup()
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._setup = function() {
                    this._dependencies.mapGrid.onContentAdded.addListener(this._checkForCompletion, this),
                    this._checkForCompletion()
                }
                ,
                e.prototype._checkForCompletion = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return e.sent(),
                                v_(this._dependencies.gridFilter, De.services.buildings) || De.services.buildings.activeBuildings.length > 1 ? (this._dependencies.mapGrid.onContentAdded.removeListener(this._checkForCompletion, this),
                                [4, r.TimeDelay.nextFrame()]) : [3, 3];
                            case 2:
                                e.sent(),
                                this.status = !0,
                                this.onStatusChanged.fire(),
                                e.label = 3;
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), gl = function(e) {
                function t() {
                    return e.call(this, Lo.REPAIR_BUILDING_TRACK_3, [new ll(Lo.REPAIR_BUILDING_TRACK_2), new vl]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = v_(this._dependencies.gridFilter, De.services.buildings)
                      , t = p_(this._dependencies.gridFilter, [Ke.Upgrade]);
                    e && t && e.content ? (null == e ? void 0 : e.column) && (null == e ? void 0 : e.row) ? this._steps.push(new _a(ln.CLEAR_NATURE_TO_REPAIR_START_COLLECTING_RESOURCES,!0), new aa("hide the hud elements",ul), new sa("LogStep","Start of Repair Building Track 3"), new $o("BlockUserInputStep",Uo.POPUP), new _a(ln.CLEAR_NATURE_TO_REPAIR_REPAIR_THE_BUILDING), new Na("show the hud elements",ul), new Ho("AllowUserInputStep"), new _a(ln.CLEAR_NATURE_TO_REPAIR_REPAIR_THE_BUILDING,!0), new sa("LogStep","End of Repair Building Track 3")) : this._logger.error("repairableBuilding doesn't have a column or row") : this._logger.error("Couldn't find a building that we can repair, did something change between the trigger and here?")
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), fl = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._localizedText = ce.TAP_TO_CONTINUE,
                    t && (i._localizedText = t),
                    i._createText(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._createText = function() {
                    var e = new v.LabelSettings({
                        fitHeight: 189,
                        fitWidth: 657,
                        fitToBox: !0
                    });
                    e.style = vn.getRegularTextWithOutline({
                        color: vn.colorLight,
                        stroke: vn.colorDark
                    }),
                    this.addChild(rr(new v.Label(nr(Fc || (Fc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), this._localizedText),e), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    }))
                }
                ,
                t
            }(Xe.Container), El = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "OnboardingInfoPopup",
                    i._inputBlocker.interactive = !0,
                    i._createBackground(),
                    i._createInfo(),
                    i._createTapToContinue(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype.close = function() {
                    var t, i;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._content.interactive = !1,
                                this._inputBlocker.interactive = !1,
                                this._content.off("pointerup", this.close, this),
                                this._inputBlocker.off("pointerdown", this._tryToClose, this),
                                [4, e.prototype.close.call(this)];
                            case 1:
                                return n.sent(),
                                null === (i = (t = this._options).onClose) || void 0 === i || i.call(t),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createBackground = function() {
                    var e = this._getBackgroundSize();
                    this._backGround = new Ar({
                        size: e,
                        headerSize: {
                            width: e.width / 1.5,
                            height: 75
                        },
                        headerText: this._options.popupHeader,
                        headerStyle: vn.popupTitle,
                        showCloseButton: !1
                    }),
                    this._content.addChild(this._backGround)
                }
                ,
                t.prototype._getBackgroundSize = function() {
                    var e = De.services.resource.getSprite(this._options.infoImage).width + 10
                      , t = De.services.resource.getSprite(this._options.infoImage).height + 75 + 200;
                    return {
                        width: Math.max(e, 1e3),
                        height: Math.max(t, 700)
                    }
                }
                ,
                t.prototype._createInfo = function() {
                    if (this._content.addChild(rr(De.services.resource.getSprite(this._options.infoImage), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: -this._content.height / 2 + 75 + 40
                        }
                    })),
                    this._options.infoText) {
                        var e = new v.LabelSettings({
                            fitToBox: !0,
                            fitHeight: 200,
                            fitWidth: this._getBackgroundSize().width / 1.2
                        });
                        e.style = vn.darkMedium,
                        this._content.addChild(rr(new v.Label(nr(Mc || (Mc = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), this._options.infoText),e), {
                            anchor: {
                                x: .5,
                                y: 0
                            },
                            position: {
                                x: 0,
                                y: this._content.height / 2 - e.fitHeight - 50
                            }
                        }))
                    }
                    this._options.extraContent && this._content.addChild(this._options.extraContent)
                }
                ,
                t.prototype._createTapToContinue = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, r.TimeDelay.after(3e3).promise];
                            case 1:
                                return t.sent(),
                                (e = new fl).position.set(0, this._getBackgroundSize().height / 2 + 75),
                                this._content.addChild(e),
                                this._content.interactive = !0,
                                this._content.on("pointerup", this.close, this),
                                this._inputBlocker.on("pointerup", this._tryToClose, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr), ml = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._options = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.navigation.showPopup(El, (0,
                                n.__assign)({}, this._options))];
                            case 1:
                                return t.sent(),
                                [2, new Promise((function(t) {
                                    var i = function() {
                                        De.services.navigation.onPopupClosed.removeListener(i, e),
                                        t()
                                    };
                                    De.services.navigation.onPopupClosed.addListener(i, e)
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), yl = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    if (e.onboarding.isTrackCompleted(Lo.REGENERATION_EXPLANATION))
                        return this._trigger();
                    this._cropsFamily = new __(e.world,new c_([Ke.Crop, Ke.CoolDown, Ke.Harvestable, Ke.InteractionTap])),
                    this._animalsFamily = new __(e.world,new c_([Ke.Animal, Ke.CoolDown, Ke.InteractionTap])),
                    this._cropsFamily.onGameObjectAdded.addListener(this._trigger, this),
                    this._animalsFamily.onGameObjectAdded.addListener(this._trigger, this)
                }
                ,
                e.prototype.destroy = function() {
                    this._cropsFamily && this._cropsFamily.destroy(),
                    this._animalsFamily && this._animalsFamily.destroy()
                }
                ,
                e.prototype._trigger = function() {
                    var e = this;
                    r.TimeDelay.nextFrame().then((function() {
                        e._cropsFamily.onGameObjectAdded.removeListener(e._trigger, e),
                        e._animalsFamily.onGameObjectAdded.removeListener(e._trigger, e),
                        e.status = !0,
                        e.onStatusChanged.fire()
                    }
                    ))
                }
                ,
                e
            }(), Tl = function(e) {
                function t() {
                    return e.call(this, Lo.REGENERATION_EXPLANATION, [new yl, new ll(Lo.REGAIN_CONTROL_TRACK)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = new v.LabelSettings({
                        fitHeight: 65,
                        fitWidth: 250,
                        fitToBox: !0
                    });
                    e.style = vn.blueMedium;
                    var t = new v.Label(nr(Vc || (Vc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.ONBOARDING_REGENERATION_TIMER),e);
                    t.position.set(-80, 35),
                    t.anchor.y = .5,
                    this._steps.push(new _a(ln.REGENERATION_VISUAL_INSTRUCTIONS), new sa("LogStep","Enter the RegenerationExplanationTrack"), new u_("MarkTrackAsCompletedStep",[Lo.REGENERATION_EXPLANATION]), new ml("Show the popup to explain the regeneration",{
                        popupHeader: ce.ONBOARDING_REGENERATION_HEADER,
                        infoImage: f.ICON_POPUP_REGENERATION_EXPLANATION,
                        infoText: ce.ONBOARDING_REGENERATION_INFO,
                        extraContent: t
                    }), new _a(ln.REGENERATION_VISUAL_INSTRUCTIONS,!0))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), Al = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    e.onboarding.isTrackCompleted(Lo.REWARD_CRATE_INTRODUCTION) ? this._updateStatus() : (this._rewardCrateFamily = new __(e.world,new c_([Ke.CrateReward, Ke.InteractionTap, Ke.GridPosition])),
                    this._rewardCrateKeyFamily = new __(e.world,new c_([Ke.CrateRewardKey, Ke.InteractionTap, Ke.GridPosition])),
                    this._rewardCrateFamily.onGameObjectAdded.addListener(this._trigger, this),
                    this._rewardCrateKeyFamily.onGameObjectAdded.addListener(this._trigger, this))
                }
                ,
                e.prototype.destroy = function() {
                    this._rewardCrateFamily && this._rewardCrateFamily.destroy(),
                    this._rewardCrateKeyFamily && this._rewardCrateKeyFamily.destroy()
                }
                ,
                e.prototype._trigger = function(e) {
                    this._updateStatus()
                }
                ,
                e.prototype._updateStatus = function() {
                    var e = this;
                    r.TimeDelay.nextFrame().then((function() {
                        e._rewardCrateFamily.onGameObjectAdded.removeListener(e._trigger, e),
                        e._rewardCrateKeyFamily.onGameObjectAdded.removeListener(e._trigger, e),
                        e.status = !0,
                        e.onStatusChanged.fire()
                    }
                    ))
                }
                ,
                e
            }(), Cl = function(e) {
                function t() {
                    return e.call(this, Lo.REWARD_CRATE_INTRODUCTION, [new Al, new ll(Lo.REGAIN_CONTROL_TRACK)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    this._steps.push(new _a(ln.REWARD_CRATE_INTRODUCTION), new sa("LogStep","Enter the RewardCrateIntroductionTrack"), new ml("Show the popup to introduce the decorative item",{
                        popupHeader: ce.ONBOARDING_REWARD_CRATES_HEADER,
                        infoImage: f.ICON_POPUP_CHESTS_AND_KEYS_EXPLANATION,
                        extraContent: this._getExtraContent()
                    }), new u_("MarkTrackAsCompletedStep",[Lo.REWARD_CRATE_INTRODUCTION]), new _a(ln.REWARD_CRATE_INTRODUCTION,!0))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t.prototype._getExtraContent = function() {
                    var e = new Xe.Container;
                    e.position.set(0, 255);
                    var t = De.services.resource.getSprite(f.ICON_POPUP_CHESTS_AND_KEYS_EXPLANATION).width
                      , i = new v.LabelSettings({
                        fitHeight: 135,
                        fitWidth: 300,
                        fitToBox: !0
                    });
                    i.style = vn.darkSmall;
                    for (var r = 1; r <= 3; r++) {
                        var o = "ONBOARDING_REWARD_CRATES_STEP_".concat(r)
                          , a = new v.Label(nr(Hc || (Hc = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce[o]),i);
                        a.anchor.set(.5),
                        a.position.set(-t / 3 + (r - 1) * t / 3, 0),
                        e.addChild(a)
                    }
                    var s = new v.LabelSettings({
                        fitHeight: 75,
                        fitWidth: t - 20,
                        fitToBox: !0
                    });
                    s.style = vn.greySmall;
                    var _ = new v.Label(nr(jc || (jc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.ONBOARDING_REWARD_CRATES_SUBTEXT),s);
                    return _.anchor.set(.5),
                    _.position.set(0, 155),
                    e.addChild(_),
                    e
                }
                ,
                t
            }(Wa), Il = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    e.onboarding.isTrackCompleted(Lo.UPGRADE_CARD_INTRODUCTION) ? this._updateStatus() : (this._family = new __(e.world,new c_([Ke.UpgradeCard, Ke.InteractionTap, Ke.GridPosition])),
                    this._family.onGameObjectAdded.addListener(this._updateStatus, this))
                }
                ,
                e.prototype.destroy = function() {
                    this._family && this._family.destroy()
                }
                ,
                e.prototype._updateStatus = function() {
                    var e = this;
                    r.TimeDelay.nextFrame().then((function() {
                        e._family.onGameObjectAdded.removeListener(e._updateStatus, e),
                        e.status = !0,
                        e.onStatusChanged.fire()
                    }
                    ))
                }
                ,
                e
            }(), Sl = function(e) {
                function t() {
                    return e.call(this, Lo.UPGRADE_CARD_INTRODUCTION, [new Il, new ll(Lo.REGAIN_CONTROL_TRACK)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = this;
                    this._steps.push(new _a(ln.UPGRADE_CARD_INTRODUCTION), new sa("LogStep","Enter the UpgradeCardIntroductionTrack"), new u_("MarkTrackAsCompletedStep",[Lo.UPGRADE_CARD_INTRODUCTION]), new ml("Show the popup to introduce the upgrade card",{
                        popupHeader: ce.UPGRADE_ONBOARDING_HEADER,
                        infoImage: f.ICON_POPUP_UPGRADECARDS_EXPLANATION,
                        extraContent: this._getExtraContent(),
                        onClose: function() {
                            return e._dependencies.upgradeCard.onUpgradeCardIntroClosed.fire()
                        }
                    }), new _a(ln.UPGRADE_CARD_INTRODUCTION,!0))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t.prototype._getExtraContent = function() {
                    var e = new Xe.Container;
                    e.position.set(0, 255);
                    var t = De.services.resource.getSprite(f.ICON_POPUP_UPGRADECARDS_EXPLANATION).width
                      , i = new v.LabelSettings({
                        fitHeight: 135,
                        fitWidth: 300,
                        fitToBox: !0
                    });
                    i.style = vn.darkSmall;
                    for (var r = 1; r <= 3; r++) {
                        var o = "UPGRADE_ONBOARDING_STEP_".concat(r)
                          , a = new v.Label(nr(Kc || (Kc = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce[o]),i);
                        a.anchor.set(.5);
                        var s = 10 * (2 - r);
                        a.position.set(-t / 3 + (r - 1) * t / 3 - s, 10),
                        e.addChild(a)
                    }
                    var _ = new v.LabelSettings({
                        fitHeight: 75,
                        fitWidth: t - 20,
                        fitToBox: !0
                    });
                    _.style = vn.greySmall;
                    var c = new v.Label(nr(Wc || (Wc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.UPGRADE_ONBOARDING_SUBTEXT),_);
                    return c.anchor.set(.5),
                    c.position.set(0, 180),
                    e.addChild(c),
                    e
                }
                ,
                t
            }(Wa), Ol = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    e.onboarding.isTrackCompleted(Lo.GREENHOUSE_MERGE_CHAIN_INTRODUCTION) ? this._updateStatus() : (this._mergeableObjects = new __(e.world,new c_([Ke.Mergeable, Ke.InteractionTap, Ke.GridPosition])),
                    this._mergeableObjects.onGameObjectAdded.addListener(this._trigger, this))
                }
                ,
                e.prototype.destroy = function() {
                    this._mergeableObjects && this._mergeableObjects.destroy()
                }
                ,
                e.prototype._trigger = function(e) {
                    "greenhouse" === e.getBlueprintID().split("_")[0] && this._updateStatus()
                }
                ,
                e.prototype._updateStatus = function() {
                    var e = this;
                    r.TimeDelay.nextFrame().then((function() {
                        e._mergeableObjects.onGameObjectAdded.removeListener(e._trigger, e),
                        e.status = !0,
                        e.onStatusChanged.fire()
                    }
                    ))
                }
                ,
                e
            }(), bl = -130, Rl = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.priority = _r.NORMAL,
                    t._name = "GreenhouseMergeChainIntroduction",
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, e.prototype.initialize.call(this, (function() {}
                                ))];
                            case 1:
                                return i.sent(),
                                this._inputBlocker.clear(),
                                this._inputBlocker.beginFill(24595, .7).drawRect(-1, -1, 2, 2).endFill(),
                                this._createMainScreen(),
                                t(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createMainScreen = function() {
                    var e = rr(De.services.resource.getSprite(f.POPUP_GREENHOUSE_INTRODUCTIONARY), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: bl
                        }
                    });
                    this._content.addChild(e),
                    this._content.addChild(this._createHeaderText(e)),
                    this._content.addChild(this._createGreenhouseText(e)),
                    this._content.addChild(this._createSubtitleFlowerText(e)),
                    this._content.addChild(this._createSubtitleRewardsText(e)),
                    this._createTapToContinue(e)
                }
                ,
                t.prototype._createHeaderText = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: 400
                    });
                    t.style = vn.darkMedium;
                    var i = new v.Label(nr(zc || (zc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GREENHOUSE_DISCOVERY_TITLE_TOP),t);
                    return i.anchor.set(.5),
                    i.position.set(0, -e.height / 2 + 170 + bl),
                    i
                }
                ,
                t.prototype._createGreenhouseText = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 200,
                        fitWidth: 400
                    });
                    t.style = vn.lightGreenExtraLarge;
                    var i = new v.Label(nr(Yc || (Yc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GREENHOUSE_DISCOVERY_TITLE_BOTTOM),t);
                    return i.anchor.set(.5),
                    i.position.set(0, -e.height / 2 + 260 + bl),
                    i
                }
                ,
                t.prototype._createSubtitleFlowerText = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 100,
                        fitWidth: 800
                    });
                    t.style = vn.yellowLargeWithOutline;
                    var i = new v.Label(nr(Jc || (Jc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GREENHOUSE_DISCOVERY_BODY_TOP).toLocaleUpperCase(),t);
                    return i.anchor.set(.5),
                    i.position.set(0, e.height / 2 - 205 + bl),
                    i
                }
                ,
                t.prototype._createSubtitleRewardsText = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 100,
                        fitWidth: 800
                    });
                    t.style = vn.yellowLargeWithOutline;
                    var i = new v.Label(nr(Xc || (Xc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GREENHOUSE_DISCOVERY_BODY_BOTTOM).toLocaleUpperCase(),t);
                    return i.anchor.set(.5),
                    i.position.set(0, e.height / 2 - 125 + bl),
                    i
                }
                ,
                t.prototype._createTapToContinue = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, r.TimeDelay.after(1e3).promise];
                            case 1:
                                return i.sent(),
                                (t = new fl).position.set(0, e.height / 2 + 50 + bl),
                                this._content.addChild(t),
                                this._content.interactive = !0,
                                this._content.on("pointerup", this.close, this),
                                this._inputBlocker.interactive = !0,
                                this._inputBlocker.on("pointerup", this._tryToClose, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr), wl = function(e) {
                function t() {
                    return e.call(this, Lo.GREENHOUSE_MERGE_CHAIN_INTRODUCTION, [new Ol, new ll(Lo.REGAIN_CONTROL_TRACK)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    this._steps.push(new _a(ln.GREENHOUSE_MERGE_CHAIN_INTRODUCTION), new sa("LogStep","Enter the GreenhouseMergeChainIntroductionTrack"), new X_("Show the popup to introduce the merge chain",Rl,{}), new D_("AwaitPopupClosedStep",Rl), new _a(ln.GREENHOUSE_MERGE_CHAIN_INTRODUCTION,!0))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), Dl = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event,
                    this._blueprintIDToCheck = "sapling_1"
                }
                return e.prototype.initialize = function(e) {
                    e.onboarding.isTrackCompleted(Lo.FLOWERS_INTRODUCTION) ? this._updateStatus() : (this._family = new __(e.world,new c_([Ke.Dropable, Ke.Mergeable, Ke.GridPosition])),
                    this._family.onGameObjectAdded.addListener(this._trigger, this))
                }
                ,
                e.prototype.destroy = function() {
                    var e;
                    null === (e = this._family) || void 0 === e || e.destroy()
                }
                ,
                e.prototype._trigger = function(e) {
                    e.getBlueprintID() === this._blueprintIDToCheck && this._updateStatus()
                }
                ,
                e.prototype._updateStatus = function() {
                    var e = this;
                    r.TimeDelay.nextFrame().then((function() {
                        e._family.onGameObjectAdded.removeListener(e._trigger, e),
                        e.status = !0,
                        e.onStatusChanged.fire()
                    }
                    ))
                }
                ,
                e
            }(), Nl = function(e) {
                function t() {
                    return e.call(this, Lo.FLOWERS_INTRODUCTION, [new Dl, new ll(Lo.REGAIN_CONTROL_TRACK)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    this._steps.push(new _a(ln.FLOWERS_INTRODUCTION), new sa("LogStep","Enter the FlowersIntroductionTrack"), new ml("Show the popup to introduce the flowers",{
                        popupHeader: ce.FLOWERS,
                        infoImage: f.ICON_POPUP_FLOWERS_EXPLANATION,
                        extraContent: this._getExtraContent()
                    }), new u_("MarkTrackAsCompletedStep",[Lo.FLOWERS_INTRODUCTION]), new _a(ln.FLOWERS_INTRODUCTION,!0))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t.prototype._getExtraContent = function() {
                    var e = new Xe.Container;
                    e.position.set(0, 255);
                    var t = De.services.resource.getSprite(f.ICON_POPUP_FLOWERS_EXPLANATION).width
                      , i = new v.LabelSettings({
                        fitHeight: 135,
                        fitWidth: 300,
                        fitToBox: !0
                    });
                    i.style = vn.darkSmall;
                    for (var r = 1; r <= 3; r++) {
                        var o = "FLOWERS_ONBOARDING_STEP_".concat(r)
                          , a = new v.Label(nr(qc || (qc = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce[o]),i);
                        a.anchor.set(.5),
                        a.position.set(-t / 3 + (r - 1) * t / 3, 0),
                        e.addChild(a)
                    }
                    var s = new v.LabelSettings({
                        fitHeight: 75,
                        fitWidth: t - 20,
                        fitToBox: !0
                    });
                    s.style = vn.greySmall;
                    var _ = new v.Label(nr(Qc || (Qc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FLOWERS_ONBOARDING_SUBTEXT),s);
                    return _.anchor.set(.5),
                    _.position.set(0, 155),
                    e.addChild(_),
                    e
                }
                ,
                t
            }(Wa), Ll = function() {
                function e() {}
                return e.prototype.getMapSequenceTracks = function() {
                    return [new s_, new m_, new A_, new w_, new M_(Lo.AWAIT_LEVELUP_2,2), new j_, new W_(Lo.HARVEST_TRACK_2), new W_(Lo.HARVEST_TRACK_3), new W_(Lo.HARVEST_TRACK_4), new W_(Lo.HARVEST_TRACK_5), new W_(Lo.HARVEST_TRACK_6), new W_(Lo.HARVEST_TRACK_7), new Oc, new bc, new Dc, new Bc, new kc, new rl, new sl]
                }
                ,
                e.prototype.getMapTracks = function() {
                    return [new dl, new pl, new gl, new Tl, new Cl, new Sl, new wl, new Nl]
                }
                ,
                e.prototype.getInteractionReadyTracks = function() {
                    return [Lo.REGAIN_CONTROL_TRACK, Lo.REPAIR_BUILDING_TRACK_2, Lo.REPAIR_BUILDING_TRACK_3, Lo.REGENERATION_EXPLANATION, Lo.REWARD_CRATE_INTRODUCTION, Lo.UPGRADE_CARD_INTRODUCTION, Lo.GREENHOUSE_MERGE_CHAIN_INTRODUCTION, Lo.FLOWERS_INTRODUCTION]
                }
                ,
                e
            }(), Bl = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._cellPositions = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._cells = this._getGridCells(this._cellPositions),
                                this._addListeners(),
                                [4, new Promise((function(t, i) {
                                    e._promiseResolve = t
                                }
                                ))];
                            case 1:
                                return t.sent(),
                                this._removeListeners(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getGridCells = function(e) {
                    var t = this;
                    return e.reduce((function(e, i) {
                        var n = t._dependencies.mapGrid.getCell(i.column, i.row);
                        return void 0 !== n && e.push(n),
                        e
                    }
                    ), [])
                }
                ,
                t.prototype._checkForCompletion = function() {
                    this._promiseResolve ? this._cells.every((function(e) {
                        return null === e.content
                    }
                    )) && this._promiseResolve() : this._logger.warn("Can't complete onboarding step before it was started!")
                }
                ,
                t.prototype._addListeners = function() {
                    var e = this;
                    this._cells.forEach((function(t) {
                        t.onContentRemoved.addListener(e._checkForCompletion, e)
                    }
                    ))
                }
                ,
                t.prototype._removeListeners = function() {
                    var e = this;
                    this._cells.forEach((function(t) {
                        t.onContentRemoved.removeListener(e._checkForCompletion, e)
                    }
                    ))
                }
                ,
                t
            }(Vo), Pl = function() {
                function e(e) {
                    this.status = !1,
                    this.onStatusChanged = new r.Event,
                    this._blueprintIDToCheck = "ticket",
                    this._trackKey = e
                }
                return e.prototype.initialize = function(e) {
                    var t = this;
                    this._dependencies = e,
                    e.onboarding.isTrackCompleted(this._trackKey) ? r.TimeDelay.nextFrame().then((function() {
                        t.status = !0,
                        t.onStatusChanged.fire()
                    }
                    )) : this._setup()
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._setup = function() {
                    this._family = new __(this._dependencies.world,new c_([Ke.Collectable])),
                    this._family.onGameObjectAdded.addListener(this._checkForCompletion, this),
                    this._checkForCompletion()
                }
                ,
                e.prototype._checkForCompletion = function() {
                    var e = this
                      , t = this._family.getGameObjects();
                    0 !== t.length && t.forEach((function(t) {
                        if (t.getBlueprintID() === e._blueprintIDToCheck)
                            return r.TimeDelay.nextFrame().then((function() {
                                e.status = !0,
                                e.onStatusChanged.fire()
                            }
                            )),
                            void e._family.onGameObjectAdded.removeListener(e._checkForCompletion, e)
                    }
                    ))
                }
                ,
                e
            }(), kl = function(e) {
                function t() {
                    var t = e.call(this, Lo.TRAIN_STATION_TRACK_1, [new Pl(Lo.TRAIN_STATION_TRACK_1), new ll(Lo.REGAIN_CONTROL_TRACK)]) || this;
                    return t._blueprintIDToCheck = "ticket",
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onExecute = function() {
                    var e = this._getTrainTicketLocation();
                    void 0 !== e && this._steps.push(new _a(ln.VISIT_FRIENDS_TRAIN_TICKETS), new sa("LogStep","Start of Train Station Track 1"), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new aa("HideElementStep",[Ns.CoinCounterUI, Ns.CratesButtonUI, Ns.EnergyCounterUI, Ns.GemCounterUI, Ns.OrderButtonUI, Ns.ShovelButtonUI, Ns.RankBarUI, Ns.DiscoveryButtonUI, Ns.MarketplaceButtonUI, Ns.ExtraWorkerButtonUI, Ns.TaskButtonUI, Ns.SpecialOfferButtonUI, Ns.MailboxButtonUI, Ns.FacebookButtonUI],!1), new Da("ConversationWithAnswerStep","train_station_1"), new y_("MoveCameraStep",e), new fa("ShowClickStep",{
                        animations: [{
                            animationName: ta.DELAY,
                            duration: 200
                        }, {
                            layer: ea.MAIN,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: e
                            },
                            mirror: !0,
                            duration: 1250
                        }],
                        loop: !0
                    }), new H_("allow the user to tap the train ticket",e,!0), new Bl("AwaitEmptyCellStep",[e]), new u_("MarkTrackAsCompletedStep",[Lo.TRAIN_STATION_TRACK_1]), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new ra("HideAnimatedHandStep"), new oa("HideConversationStep"), new _a(ln.VISIT_FRIENDS_TRAIN_TICKETS,!0), new sa("LogStep","End of Train Station Track 1"))
                }
                ,
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onDestroy = function() {}
                ,
                t.prototype._getTrainTicketLocation = function() {
                    var e, t = this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.Collectable]);
                    if (0 !== t.length) {
                        for (var i = 0; i < t.length; i++) {
                            var n = t[i];
                            if ((null === (e = n.content) || void 0 === e ? void 0 : e.getBlueprintID()) === this._blueprintIDToCheck)
                                return {
                                    row: n.row,
                                    column: n.column
                                }
                        }
                        this._logger.warn("Couldn't get a gridcell with a train ticket")
                    } else
                        this._logger.warn("Couldn't get a gridcell with collectable behavior")
                }
                ,
                t
            }(Wa), xl = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    var e = this;
                    return new Promise((function(t) {
                        De.services.navigation.currentSceneIndex === wr.FRIEND ? t() : De.services.transition.arrivedAtFriendFarm.listenOnce(t, e)
                    }
                    ))
                }
                ,
                t
            }(Vo), Gl = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    return r._cellPositions = i,
                    r._behaviorsToAdd = n,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._cellPositions.forEach((function(t) {
                                var i = e._dependencies.mapGrid.getCell(t.column, t.row);
                                i ? e._behaviorsToAdd.forEach((function(e) {
                                    var t, n = new e.behavior(e.behaviorData);
                                    null === (t = i.content) || void 0 === t || t.addBehavior(n)
                                }
                                )) : e._logger.warn("couldn't find cell with position: col ".concat(t.column, " and row ").concat(t.row))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Ul = function(e) {
                function t(t) {
                    return e.call(this, t) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._dependencies.friendReward.enable(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Fl = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._npcDestinationBoolean = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.friends.toggleNpcDestination(this._npcDestinationBoolean),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), Ml = i(2213), Vl = function(e) {
                function t(t) {
                    var i = t.scrollableContainer
                      , n = t.inputAreaParent
                      , r = t.debug
                      , o = void 0 !== r && r
                      , a = t.texture
                      , s = t.bottomHeight
                      , _ = void 0 === s ? void 0 : s
                      , c = t.leftWidth
                      , l = void 0 === c ? void 0 : c
                      , u = t.rightWidth
                      , d = void 0 === u ? void 0 : u
                      , h = t.topHeight
                      , p = void 0 === h ? void 0 : h
                      , g = t.xOffset
                      , f = void 0 === g ? 0 : g
                      , E = t.yOffset
                      , m = void 0 === E ? 0 : E
                      , y = t.scrollableContainerHeightOffset
                      , T = void 0 === y ? 0 : y
                      , A = e.call(this, a, l || a.width / 2, p || a.height / 2, d, _) || this;
                    return A._isDragging = null,
                    A._debugMode = !1,
                    A._debugHexColor = 14483507,
                    A._linkedContainer = i,
                    A._linkedContainerHeight = A._linkedContainer.getBounds().height + T,
                    A._inputAreaParentContainer = n,
                    A._interactionArea = new Xe.Graphics,
                    A._debugMode = o,
                    A._debugMode && A._extendContentContainerForDebugging(),
                    A.height = A._getCalculatedHeight(),
                    A.width = a.width,
                    A._startPositionScrollbar = new v.Vector2(A._linkedContainer.getBounds().width / 2 - (A.width + f),-A._linkedContainerHeight / 2 - m),
                    A._startPositionLinkedContainer = new v.Vector2(A._linkedContainer.getPosition().x,A._linkedContainer.getPosition().y),
                    A.position.x = A._startPositionScrollbar.x,
                    A.position.y = A._startPositionScrollbar.y,
                    A._boundOnUpCallback = A._onUp.bind(A),
                    A._boundOnDownCallback = A._onDown.bind(A),
                    A._boundOnMoveCallback = A._onMove.bind(A),
                    A._addInteractableArea(),
                    A
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    this._removeInteractionListeners()
                }
                ,
                t.prototype.update = function(e, t) {
                    this.position.y = this._startPositionScrollbar.y + this._getRelativeContentYMovement() / this._getOverflowRatio()
                }
                ,
                t.prototype._addInteractableArea = function() {
                    this._interactionArea.beginFill(this._debugHexColor, this._debugMode ? .5 : 1e-4).drawRect(0, 0, 70, this._linkedContainerHeight).endFill(),
                    this._interactionArea.position = this.position,
                    this._interactionArea.position.x -= this._interactionArea.width / 2,
                    this._interactionArea.interactive = !0,
                    this._inputAreaParentContainer.addChild(this._interactionArea),
                    this._addInteractionListeners()
                }
                ,
                t.prototype._addInteractionListeners = function() {
                    this._interactionArea.addListener("pointerdown", this._boundOnDownCallback),
                    this._interactionArea.addListener("pointermove", this._boundOnMoveCallback),
                    this._interactionArea.addListener("pointerup", this._boundOnUpCallback),
                    this._interactionArea.addListener("pointerupoutside", this._boundOnUpCallback)
                }
                ,
                t.prototype._removeInteractionListeners = function() {
                    this._interactionArea.removeListener("pointerdown", this._boundOnDownCallback),
                    this._interactionArea.removeListener("pointermove", this._boundOnMoveCallback),
                    this._interactionArea.removeListener("pointerup", this._boundOnUpCallback),
                    this._interactionArea.removeListener("pointerupoutside", this._boundOnUpCallback)
                }
                ,
                t.prototype._onDown = function(e) {
                    if (!this._isDragging) {
                        this._isDragging = !0,
                        e.stopPropagation();
                        var t = -e.data.getLocalPosition(this._interactionArea).y * this._getOverflowRatio();
                        this._linkedContainer.setPosition(new Ml.Point(this._linkedContainer.getPosition().x,t))
                    }
                }
                ,
                t.prototype._onUp = function(e) {
                    e.stopPropagation(),
                    this._isDragging = !1
                }
                ,
                t.prototype._onMove = function(e) {
                    if (this._isDragging) {
                        e.stopPropagation();
                        var t = -e.data.getLocalPosition(this._interactionArea).y * this._getOverflowRatio();
                        this._linkedContainer.setPosition(new Ml.Point(this._linkedContainer.getPosition().x,t))
                    }
                }
                ,
                t.prototype._getRelativeContentYMovement = function() {
                    var e = this._linkedContainer.getPosition().y;
                    return this._startPositionLinkedContainer.y - e
                }
                ,
                t.prototype._getOverflowRatio = function() {
                    var e = this._linkedContainer.getContentBounds().height / this._linkedContainerHeight;
                    return e < 1 ? 1 : e
                }
                ,
                t.prototype._getCalculatedHeight = function() {
                    return this._linkedContainerHeight / this._getOverflowRatio()
                }
                ,
                t.prototype._extendContentContainerForDebugging = function() {
                    var e = new Xe.Graphics;
                    e.beginFill(14483507, 1).drawRect(-50, 0, 100, 100).endFill(),
                    e.position.y = 2e4,
                    this._linkedContainer._contentContainer.addChild(e),
                    this._linkedContainer.fitContentBounds()
                }
                ,
                t
            }(Xe.NineSlicePlane), Hl = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.onElementClick = new r.Event,
                    i.playerData = t,
                    i._createVisuals(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onVisitButtonClick = function(e) {
                    this._visitButton.onClick(e)
                }
                ,
                t.prototype._createVisuals = function() {
                    this._createBackground(),
                    this._createDestinationInfo(),
                    this._createVisitButton()
                }
                ,
                t.prototype._createBackground = function() {
                    var e = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE));
                    e.setSizes({
                        width: 800,
                        height: 170
                    }),
                    e.anchor.set(.5),
                    this.addChild(e)
                }
                ,
                t.prototype._createDestinationInfo = function() {
                    var e = rr(De.services.resource.getSprite(f.AVATAR_248), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: -this.width / 2 + 85,
                            y: 0
                        },
                        scale: {
                            x: .5,
                            y: .5
                        }
                    });
                    this.addChild(e);
                    var t = rr(this.playerData.getPhoto(fn.SMALL), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: e.x,
                            y: e.y
                        }
                    });
                    this.addChild(t);
                    var i = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 70,
                        fitWidth: 450
                    });
                    i.style = vn.darkMedium;
                    var o = new v.Label(this.playerData.name,i);
                    o.anchor.set(0, .5),
                    o.position.set(t.x + 80, -22),
                    this.addChild(o);
                    var a = Math.abs(this.playerData.lastVisitedTime - De.services.timer.currentTime)
                      , s = r.StringUtility.getTimeUnitsFromMilliseconds(a)
                      , _ = s.hours
                      , c = s.minutes
                      , l = s.seconds;
                    i.style = vn.darkGreyExtraSmall;
                    var u = _ >= 24 ? Math.floor(_ / 24) + "d" : _ >= 1 ? _ + "h" : c >= 1 ? c + "m" : l + "s"
                      , d = 0 === this.playerData.lastVisitedTime ? nr(Zc || (Zc = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.NEVER_VISITED) : nr($c || ($c = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.LAST_VISITED, u)
                      , h = this.addChild(new v.Label(d,i));
                    h.anchor.set(0, .5),
                    h.position.set(o.x, 32)
                }
                ,
                t.prototype._createVisitButton = function() {
                    this._visitButton = this.addChild(new fr({
                        name: "visit",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: {
                            width: 160,
                            height: 85
                        }
                    },{
                        text: ce.VISIT,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })),
                    this._visitButton.position.set(300, 5),
                    De.services.friends.hasVisitedToday(this.playerData) || this._createBonusIcon(),
                    De.services.inventory.getAmount(Cn.TICKETS) <= 0 && this._visitButton.disable()
                }
                ,
                t.prototype._createBonusIcon = function() {
                    var e = rr(De.services.resource.getSprite(f.OVERLAY_BONUS_FRIEND), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: this._visitButton.x + this._visitButton.width / 2,
                            y: this._visitButton.y - this._visitButton.height / 2
                        },
                        scale: {
                            x: .5,
                            y: .5
                        }
                    });
                    this.addChild(e);
                    var t = vn.getRegularTextStyle(vn.colorLight, 70)
                      , i = new Xe.Text("x2",t);
                    i.anchor.set(.5),
                    e.addChild(i)
                }
                ,
                t
            }(Xe.Container), jl = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n._boundScrollCallback = n._onScroll.bind(n),
                    n._connectedFriendsData = t,
                    n._incentivise = i,
                    n.on("added", n._onAdded, n),
                    n.on("removed", n._onDestroy, n),
                    n._createVisuals(),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onVisitDestinationButtonPressed = function(e) {
                    this._callback = e
                }
                ,
                t.prototype.onVisitOfficialGroupButtonPressed = function(e) {
                    this._visitGroupCallback = e
                }
                ,
                t.prototype.show = function() {
                    this._scrollbar && v.GroupsCore.Updateables.add(this._scrollbar),
                    this._friendContainer && v.GroupsCore.Updateables.add(this._friendContainer),
                    this.visible = !0
                }
                ,
                t.prototype.hide = function() {
                    this.visible = !1
                }
                ,
                t.prototype._createVisuals = function() {
                    this._createHeaderUI(),
                    this._createListOfFriends(),
                    this._createPlatformButtons(),
                    this._finalizeScrollContainer()
                }
                ,
                t.prototype._createHeaderUI = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 150,
                        fitWidth: 900
                    });
                    e.style = vn.darkGreyMedium;
                    var t = this.addChild(new v.Label(nr(el || (el = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.DESTINATION),e));
                    t.anchor.set(.5),
                    t.position.set(0, -325)
                }
                ,
                t.prototype._createListOfFriends = function() {
                    var e = this;
                    this._friendContainer = new v.ScrollableContainer({
                        friction: .8
                    }),
                    this._friendContainer.setBounds(new Xe.Rectangle(-450,-275,900,725)),
                    this.addChild(this._friendContainer),
                    this._connectedFriendsData.forEach((function(t, i) {
                        var n = new Hl(t);
                        n.position.y = 1.1 * n.height * i,
                        n.onVisitButtonClick((function() {
                            return e._callback(t)
                        }
                        )),
                        e._friendContainer.addContent(n)
                    }
                    ))
                }
                ,
                t.prototype._createPlatformButtons = function() {
                    var e = this;
                    this._incentivise.getTrainStationIncentiviseButtons().forEach((function(t) {
                        t.position.y = 1.1 * t.height * e._connectedFriendsData.length,
                        e._friendContainer.addContent(t)
                    }
                    ))
                }
                ,
                t.prototype._finalizeScrollContainer = function() {
                    this._friendContainer.fitContentBounds();
                    var e = this._friendContainer.getContentBounds();
                    e.x = this._friendContainer.getBounds().x,
                    e.width = this._friendContainer.getBounds().width;
                    var t = e.height >= this._friendContainer.getBounds().height;
                    e.height = Math.max(e.height, this._friendContainer.getBounds().height),
                    this._friendContainer.setContentBounds(e);
                    var i = (new Xe.Graphics).beginFill(16777215).drawShape(this._friendContainer.getBounds()).endFill();
                    if (this._friendContainer.mask = i,
                    this.addChild(i),
                    t) {
                        this._friendContainer.setPosition(new Xe.Point(0,0));
                        var n = De.services.resource.getTexture(f.UI_POPUP_SCROLLBAR);
                        this._scrollbar = new Vl({
                            inputAreaParent: this,
                            scrollableContainer: this._friendContainer,
                            texture: n,
                            debug: !1,
                            yOffset: -90,
                            xOffset: 26
                        }),
                        this._scrollbar.mask = i,
                        this.addChild(this._scrollbar)
                    }
                }
                ,
                t.prototype._onAdded = function() {
                    addEventListener("wheel", this._boundScrollCallback)
                }
                ,
                t.prototype._onDestroy = function() {
                    this._scrollbar && v.GroupsCore.Updateables.remove(this._scrollbar),
                    this._friendContainer && v.GroupsCore.Updateables.remove(this._friendContainer),
                    removeEventListener("wheel", this._boundScrollCallback)
                }
                ,
                t.prototype._onScroll = function(e) {
                    this._friendContainer && this._friendContainer.setPosition(new Xe.Point(this._friendContainer.getPosition().x,this._friendContainer.getPosition().y - e.deltaY))
                }
                ,
                t
            }(Xe.Container), Kl = function(e) {
                function t() {
                    var t = this
                      , i = {
                        name: "visit",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    }
                      , n = {
                        buttonSizes: {
                            width: Wl / 2,
                            height: 85
                        }
                    }
                      , r = {
                        text: ce.VISIT,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: -n.buttonSizes.width / 2 + 25,
                            y: -5
                        },
                        alignment: "left",
                        fitBoxSizes: {
                            height: n.buttonSizes.height,
                            width: n.buttonSizes.width / 2
                        }
                    }
                      , o = {
                        iconImage: f.ICON_BTN_TRAINTICKET,
                        iconPosition: {
                            x: 160,
                            y: -5
                        }
                    };
                    t = e.call(this, i, n, r, o) || this;
                    var a = new Xe.Text(De.services.inventory.getAmount(Cn.TICKETS).toString() + "/1",vn.buttonLabel);
                    return a.anchor.set(1, .5),
                    a.position.set(100, -5),
                    De.services.inventory.getAmount(Cn.TICKETS) <= 0 && t.disable(),
                    t.addContent(a),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(uc), Wl = 900, zl = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._visitButtonCallback = null,
                    i._destinationButtonCallback = null,
                    i._connectedFriendsData = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.changeTarget = function(e) {
                    this._selectedPlayer = e
                }
                ,
                t.prototype.onDestinationButtonClicked = function(e) {
                    this._destinationButtonCallback = e
                }
                ,
                t.prototype.onVisitButtonClicked = function(e) {
                    this._visitButtonCallback = e
                }
                ,
                t.prototype.show = function() {
                    this._createVisuals(),
                    this.visible = !0
                }
                ,
                t.prototype.hide = function() {
                    this.removeChildren(),
                    this._destinationButtonCallback = null,
                    this._visitButtonCallback = null,
                    this.visible = !1
                }
                ,
                t.prototype._createVisuals = function() {
                    this._createHeaderUI(),
                    this._createPlayerInfoUI(),
                    this._createDestinationButtonUI(),
                    this._createVisitButtonUi(),
                    De.services.friends.hasVisitedToday(this._selectedPlayer) || this._createBonusIcon()
                }
                ,
                t.prototype._createHeaderUI = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 150,
                        fitWidth: Wl
                    });
                    e.style = vn.darkGreyMedium;
                    var t = this.addChild(new v.Label(nr(tl || (tl = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.DESTINATION),e));
                    t.anchor.set(.5),
                    t.position.set(0, -325)
                }
                ,
                t.prototype._createPlayerInfoUI = function() {
                    var e = rr(this._selectedPlayer.getPhoto(), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -145
                        }
                    });
                    this.addChild(e),
                    this._destinationName = this.addChild(new Xe.Text(this._selectedPlayer.name,vn.darkMedium)),
                    this._destinationName.anchor.set(.5, .5),
                    this._destinationName.position.set(e.x, e.y + 175)
                }
                ,
                t.prototype._createDestinationButtonUI = function() {
                    var e = this;
                    if (this._changeDestinationButton = this.addChild(new fr({
                        name: "changeDestination",
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: {
                            width: Wl / 2 + 50,
                            height: 85
                        }
                    },{
                        text: ce.CHANGE_DESTINATION,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })),
                    this._changeDestinationButton.position.set(this._destinationName.x, this._destinationName.y + 125),
                    !De.services.friends.hasVisitedToday(this._selectedPlayer)) {
                        var t = rr(De.services.resource.getSprite(f.OVERLAY_BONUS_FRIEND), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: this._changeDestinationButton.x + this._changeDestinationButton.width / 2,
                                y: this._changeDestinationButton.y - this._changeDestinationButton.height / 2
                            },
                            scale: {
                                x: .5,
                                y: .5
                            }
                        });
                        this.addChild(t);
                        var i = vn.getRegularTextStyle(vn.colorLight, 70)
                          , n = new Xe.Text("x2",i);
                        n.anchor.set(.5),
                        t.addChild(n)
                    }
                    this._changeDestinationButton.onClick((function() {
                        e._destinationButtonCallback && e._destinationButtonCallback()
                    }
                    ))
                }
                ,
                t.prototype._createVisitButtonUi = function() {
                    var e = this;
                    if (this._visitButton = this.addChild(new Kl),
                    this._visitButton.position.set(this._changeDestinationButton.x, this._changeDestinationButton.y + 220),
                    this._visitButton.onClick((function() {
                        e._visitButtonCallback && e._visitButtonCallback()
                    }
                    )),
                    De.services.inventory.getAmount(Cn.TICKETS) > 0) {
                        var t = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION);
                        t.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !0),
                        t.position.set(this._visitButton.width / 2, -25),
                        this._visitButton.addChild(t)
                    }
                }
                ,
                t.prototype._createBonusIcon = function() {
                    this._bonusIcon = rr(De.services.resource.getSprite(f.OVERLAY_BONUS_FRIEND), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: this._destinationName.x + 115,
                            y: this._destinationName.y - 100
                        }
                    }),
                    this.addChild(this._bonusIcon);
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: this._bonusIcon.width - 32
                    });
                    e.style = vn.lightExtraSmall;
                    var t = new v.Label(nr(il || (il = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.VISIT_FRIENDS_SUMMARY_X2),e);
                    t.anchor.set(.5),
                    this._bonusIcon.addChild(t)
                }
                ,
                t
            }(Xe.Container), Yl = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.NORMAL,
                    i._name = "TrainstationPopup",
                    i._creatingContext = !1,
                    i._focusPlayer = null,
                    t.focusPlayer && (i._focusPlayer = t.focusPlayer),
                    i._incentivise = t.incentivise,
                    i._createPopupBackground(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, e.prototype.initialize.call(this, (function() {}
                                ))];
                            case 1:
                                return n.sent(),
                                [4, this._getFriendDataWithinTimelimit(1e3)];
                            case 2:
                                return i = n.sent(),
                                this._connectedFriends = i,
                                this._chosenPlayerDestination = (0,
                                r.isNull)(this._focusPlayer) ? i[0] : this._focusPlayer,
                                this._connectedFriends.length > 0 && this._createChangeDestinationScreen(),
                                this._createMainScreen(),
                                t(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    var t = this;
                    this._popupBackground.onCloseClick((function() {
                        return t.close()
                    }
                    )),
                    this._showMainScreen(),
                    e()
                }
                ,
                t.prototype.hide = function(e) {}
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerdown", this._tryToClose, this)
                }
                ,
                t.prototype._getFriendDataWithinTimelimit = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = null,
                                i = new Promise((function(i) {
                                    t = setTimeout((function() {
                                        i(De.services.npcService.getRepeatableNPCs())
                                    }
                                    ), e)
                                }
                                )),
                                [4, Promise.race([i, this._getFriendData()])];
                            case 1:
                                return r = n.sent(),
                                null !== t && clearTimeout(t),
                                [2, this._insertOneTimeVisitableNPCs(r)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._insertOneTimeVisitableNPCs = function(e) {
                    return De.services.npcService.getOneTimeVisitableNPCs().concat(e)
                }
                ,
                t.prototype._getFriendData = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return (e = De.services.friends.getVisitableFriends()).sort((function(e, t) {
                                return e.lastVisitedTime - t.lastVisitedTime
                            }
                            )),
                            [2, e]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createPopupBackground = function() {
                    this._popupBackground = new Ar({
                        size: {
                            width: 850,
                            height: 950
                        },
                        headerText: ce.TRAINSTATION,
                        headerStyle: vn.popupTitle
                    }),
                    this._content.addChild(this._popupBackground)
                }
                ,
                t.prototype._createMainScreen = function() {
                    this._mainScreen = new zl(this._connectedFriends),
                    this._mainScreen.hide(),
                    this._content.addChild(this._mainScreen)
                }
                ,
                t.prototype._createChangeDestinationScreen = function() {
                    this._changeDestinationScreen = new jl(this._connectedFriends,this._incentivise),
                    this._changeDestinationScreen.hide(),
                    this._content.addChild(this._changeDestinationScreen)
                }
                ,
                t.prototype._showMainScreen = function() {
                    this._mainScreen.changeTarget(this._chosenPlayerDestination),
                    this._mainScreen.show(),
                    this._mainScreen.onDestinationButtonClicked(this._onChangeDestinationButtonPressed.bind(this)),
                    this._mainScreen.onVisitButtonClicked(nc(this._onVisitButtonPressed.bind(this, this._chosenPlayerDestination)))
                }
                ,
                t.prototype._showChangeDestinationScreen = function() {
                    var e = this;
                    this._changeDestinationScreen.onVisitDestinationButtonPressed(nc((function(t) {
                        De.services.analytics.design.trainStationSteps(en.CHANGED_DESTINATION),
                        e._onVisitButtonPressed(t)
                    }
                    ))),
                    this._changeDestinationScreen.show()
                }
                ,
                t.prototype._onChangeDestinationButtonPressed = function() {
                    this._mainScreen.hide(),
                    this._showChangeDestinationScreen(),
                    De.services.analytics.design.trainStationSteps(en.BUTTON_CHANGE_DESTINATION)
                }
                ,
                t.prototype._onVisitButtonPressed = function(e) {
                    var t = this;
                    if (this._popupLocked = !1,
                    De.services.onboardingGameService.model.isTrackCompleted(Lo.FRIEND_ACTIVITIES_TRACK) && De.services.analytics.design.destinationType(e.realPlayer ? nn.FRIEND : nn.BOT),
                    !e.realPlayer)
                        return this.close(),
                        void De.services.transition.goToFriendsFarm(e);
                    this._creatingContext || (this._creatingContext = !0,
                    this._sendAnalyticsBeforeVisiting(),
                    vp.platform.friendFetcher.connectToPlayer(e).then((function(i) {
                        i ? (t.close(),
                        t._sendAnalyticsWhenVisiting(t._chosenPlayerDestination, e),
                        De.services.transition.goToFriendsFarm(e)) : t._creatingContext = !1
                    }
                    )))
                }
                ,
                t.prototype._sendAnalyticsBeforeVisiting = function() {
                    De.services.analytics.design.trainStationSteps(en.BUTTON_VISIT),
                    De.services.analytics.design.contextBeforeVisiting(tn.PROMPTED)
                }
                ,
                t.prototype._sendAnalyticsWhenVisiting = function(e, t) {
                    De.services.analytics.design.contextBeforeVisiting(tn.SUCCESSFUL),
                    !De.services.friends.hasVisitedToday(e) && (De.services.analytics.design.dailyBonus(rn.AVAILABLE),
                    e === t && De.services.analytics.design.dailyBonus(rn.USED))
                }
                ,
                t
            }(yr), Jl = function(e) {
                function t() {
                    return e.call(this, Lo.TRAIN_STATION_TRACK_2, [new ll(Lo.TRAIN_STATION_TRACK_1)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onExecute = function() {
                    var e = this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.Trainstation])[0]
                      , t = p_(this._dependencies.gridFilter, [Ke.Trainstation]);
                    t ? this._steps.push(new _a(ln.VISIT_FRIENDS_TRAIN_STATION), new sa("LogStep","Start of Train Station Track 2"), new aa("HideElementStep",[Ns.CoinCounterUI, Ns.CratesButtonUI, Ns.EnergyCounterUI, Ns.GemCounterUI, Ns.OrderButtonUI, Ns.ShovelButtonUI, Ns.RankBarUI, Ns.DiscoveryButtonUI, Ns.MarketplaceButtonUI, Ns.ExtraWorkerButtonUI, Ns.MailboxButtonUI, Ns.FacebookButtonUI],!1), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new Fl("ForceNpcDestinationStep",!0), new y_("MoveCameraStep",{
                        column: 67,
                        row: 69
                    }), new Gl("Enable the clicks on the train station back",[e],[{
                        behavior: nt,
                        behaviorData: {}
                    }]), new fa("ShowClickStep",{
                        animations: [{
                            animationName: ta.DELAY,
                            duration: 200
                        }, {
                            layer: ea.MAIN,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    column: 66,
                                    row: 68
                                }
                            },
                            mirror: !0,
                            duration: 1250
                        }],
                        loop: !0
                    }), new H_("allow the user to tap the trainstation",t,!0), new _a(ln.VISIT_FRIENDS_TRAIN_STATION,!0), new _a(ln.VISIT_FRIENDS_DESTINATION_POPUP), new Y_("AwaitPopupOpenStep",Yl), new Q_("locking the popup so it cannot be closed",Yl), new ra("HideAnimatedHandStep"), new Da("ConversationWithAnswerStep","train_station_2"), new J_("AwaitTimerStep",1e3), new fa("ShowClickStep",{
                        animations: [{
                            layer: ea.POPUP,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    x: 200,
                                    y: 280
                                }
                            },
                            duration: 1250
                        }, {
                            animationName: ta.DELAY,
                            duration: 200
                        }],
                        loop: !0
                    }), new D_("AwaitPopupClosedStep",Yl), new _a(ln.VISIT_FRIENDS_DESTINATION_POPUP,!0), new oa("HideConversationStep"), new ra("HideAnimatedHandStep"), new xl("AwaitGoingToNPCFarm"), new Fl("ForceNpcDestinationStep",!1), new Ul("EnableFriendRewardServiceStep"), new sa("LogStep","End of Train Station Track 2")) : this._logger.error("couldn't find trainstation position")
                }
                ,
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onDestroy = function() {}
                ,
                t
            }(Wa), Xl = new RegExp("^\\d+:\\d+$");
            function ql(e, t) {
                return Ee(e) ? "".concat(e).concat(":").concat(t) : "".concat(e.column).concat(":").concat(e.row)
            }
            function Ql(e) {
                var t = e.split(":");
                return {
                    column: parseInt(t[0]),
                    row: parseInt(t[1])
                }
            }
            function Zl(e) {
                return Xl.test(e)
            }
            var $l, eu, tu, iu, nu, ru, ou, au, su = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    this._dependencies = e,
                    this._dependencies.interactionService.onGestureConfirm.addListener(this._triggered, this)
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._triggered = function() {
                    var e = this;
                    this._dependencies.interactionService.onGestureConfirm.removeListener(this._triggered, this),
                    this._dependencies.interactionWhitelistService.allowAllDrags(),
                    this._dependencies.interactionWhitelistService.allowAllTaps(),
                    du.forEach((function(t) {
                        return e._dependencies.onboarding.showHudElement(t, !1)
                    }
                    )),
                    this.status = !0,
                    this.onStatusChanged.fire()
                }
                ,
                e
            }(), _u = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._popoutId = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, new Promise((function(t, i) {
                                var n = e._dependencies.popout.getPopoutById(e._popoutId);
                                n ? n.onButtonClick.addListener(t, e) : (e._logger.error("couldn't get an active popout with id: ".concat(e._popoutId)),
                                i())
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), cu = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._exitTriggers = [],
                    n._exitTriggers = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._exitTriggers.forEach((function(e) {
                                e.onStatusChanged.removeAllListeners()
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Vo), lu = function() {
                function e(e) {
                    this.status = !1,
                    this.onStatusChanged = new r.Event,
                    this._trackKey = e,
                    this._onObjectAdded = this._onObjectAdded.bind(this)
                }
                return Object.defineProperty(e.prototype, "targetObject", {
                    get: function() {
                        if (!this._targetObject)
                            throw new Error("Can't access targetObject before trigger status is true");
                        return this._targetObject
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initialize = function(e) {
                    this._dependencies = e,
                    e.onboarding.isTrackCompleted(this._trackKey) ? this._triggerComplete() : this._setup()
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._triggerComplete = function() {
                    this.status = !0,
                    this.onStatusChanged.fire()
                }
                ,
                e.prototype._setup = function() {
                    this._family = new __(this._dependencies.world,new c_([Ke.HeavyObject, Ke.InteractionTap, Ke.GridPosition])),
                    this._family.onGameObjectAdded.addListener(this._onObjectAdded, this),
                    this._family.getGameObjects().length > 0 && this._onObjectAdded(this._family.getGameObjects()[0])
                }
                ,
                e.prototype._onObjectAdded = function(e) {
                    e.hasBehavior(Ke.FriendReward) || (this._family.onGameObjectAdded.removeListener(this._onObjectAdded, this),
                    this._targetObject = e,
                    this._triggerComplete())
                }
                ,
                e
            }(), uu = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "HeavyObjectOverlay",
                    i._mainContainer = new Xe.Container,
                    i._inputBlocker.off("pointerup", void 0, i),
                    i._hitpoints = i._options.object.getBehavior(Ke.Hitpoints),
                    i._friends = i._options.object.getBehavior(Ke.HeavyObject),
                    i._mainContainer.alpha = 0,
                    i.onOpened.listenOnce((function() {
                        i._mainContainer.alpha = 1,
                        i._inputBlocker.on("pointerup", i._tryToClose, i)
                    }
                    ), i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return De.services.adsService.hideBannerAd(),
                                [4, De.services.assetLoader.loadJsons(_e.HEAVY_OBJECT_OVERLAY_CONFIG)];
                            case 1:
                                return t.sent(),
                                this._config = De.services.resource.getJson(_e.HEAVY_OBJECT_OVERLAY_CONFIG),
                                this._price = this._hitpoints.max * this._config.PRICE_PER_HITPOINT,
                                this._createHeaderText(),
                                this._createObjectImage(),
                                this._createFriendsContainer(),
                                this._createExplanationText(),
                                [4, vp.platform.customShare.canUseHeavyObjectSocialShare()];
                            case 2:
                                return t.sent() && this._createInviteButton(),
                                this._createRemoveWithGemsButton(),
                                this.addChild(this._mainContainer),
                                e(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    De.services.adsService.setBannerInterval(),
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerdown", this._tryToClose, this)
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._mainContainer.destroy(),
                            e.prototype.close.call(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createHeaderText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 150,
                        fitWidth: De.services.canvas.width - 100
                    });
                    e.style = vn.lightBoldExtraLarge;
                    var t = new v.Label(nr($l || ($l = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.HEAVY_OBJECT_OVERLAY_TITLE),e);
                    t.anchor.set(.5, .5),
                    t.position.set(0, -De.services.canvas.height / 2.8),
                    this._mainContainer.addChild(t)
                }
                ,
                t.prototype._createObjectImage = function() {
                    var e = De.services.resource.getSprite({
                        alias: "".concat(this._options.object.getBlueprintID(), "_overlay")
                    });
                    e.anchor.set(.5),
                    e.position.set(0, -De.services.canvas.height / 6),
                    this._mainContainer.addChild(e)
                }
                ,
                t.prototype._createExplanationText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 250,
                        fitWidth: De.services.canvas.width - 100
                    });
                    e.style = vn.lightBoldLarge;
                    var t = new v.Label(nr(eu || (eu = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.HEAVY_OBJECT_OVERLAY_SUBTEXT, this._hitpoints.current),e);
                    t.anchor.set(.5, .5),
                    t.position.set(0, 0),
                    e.style = vn.lightBoldLarge;
                    var i = new v.Label(nr(tu || (tu = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.HEAVY_OBJECT_OVERLAY_CLOSE),e);
                    i.anchor.set(.5, .5),
                    i.position.set(0, De.services.canvas.height / 2.6),
                    this._mainContainer.addChild(t, i)
                }
                ,
                t.prototype._createFriendsContainer = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, o, a, s, _;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                e = new Xe.Container,
                                t = 20,
                                i = this._hitpoints.max - this._hitpoints.current,
                                o = 0,
                                n.label = 1;
                            case 1:
                                return o < this._hitpoints.max ? (a = De.services.resource.getSprite(f.AVATAR_130),
                                o < this._friends.friendsHelpedIds.length ? [4, De.services.friends.fetchProfile({
                                    userid: this._friends.friendsHelpedIds[o]
                                })] : [3, 3]) : [3, 5];
                            case 2:
                                s = n.sent(),
                                (0,
                                r.isUndefined)(s) ? this._logger.warn("Could not find player profile for ".concat(this._friends.friendsHelpedIds[o])) : a = s.getPhoto(fn.SMALL),
                                n.label = 3;
                            case 3:
                                (_ = rr(a, {
                                    anchor: {
                                        x: .5,
                                        y: .5
                                    }
                                })).position.set(o * (_.width + t) + _.width / 2, 0),
                                e.addChild(_),
                                o < i && this._addCheckmark(e, {
                                    x: o * (_.width + t) + _.width / 2,
                                    y: _.height / 2
                                }),
                                n.label = 4;
                            case 4:
                                return o++,
                                [3, 1];
                            case 5:
                                return e.position.set(-e.width / 2, 180),
                                this._mainContainer.addChild(e),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._addCheckmark = function(e, t) {
                    var i = rr(De.services.resource.getSprite(f.ICON_CHECKMARK_FRIENDS), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    });
                    i.position.set(t.x, t.y),
                    e.addChild(i)
                }
                ,
                t.prototype._createInviteButton = function() {
                    var e = this
                      , t = new uc({
                        name: "selectFriends",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 700,
                            height: 120
                        }
                    },{
                        text: nr(iu || (iu = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.HEAVY_OBJECT_OVERLAY_INVITE_BUTTON),
                        textStyle: vn.lightBoldLarge,
                        position: {
                            x: 50,
                            y: -5
                        },
                        fitBoxSizes: {
                            width: 540,
                            height: 120
                        },
                        alignment: "center"
                    },{
                        iconImage: vp.platform.platformAssets.shareIcon || f.ICON_HELP,
                        iconPosition: {
                            x: -325,
                            y: -3
                        },
                        iconAlignment: "left"
                    });
                    t.position.set(0, De.services.canvas.height / 5),
                    t.onClick((function() {
                        return e._onAskForHelpClicked()
                    }
                    )),
                    this._mainContainer.addChild(t)
                }
                ,
                t.prototype._createRemoveWithGemsButton = function() {
                    var e = this
                      , t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 120,
                        fitWidth: 100
                    });
                    t.style = vn.lightBoldLarge;
                    var i = new v.Label(this._price.toString(),t);
                    i.anchor.set(1, .5);
                    var r = new Xe.Container;
                    r.position.set(350 - r.width - 50, -5),
                    r.addChild(i);
                    var o = new uc({
                        name: "remove",
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE
                    },{
                        buttonSizes: {
                            width: 700,
                            height: 120
                        }
                    },{
                        text: nr(nu || (nu = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.HEAVY_OBJECT_OVERLAY_REMOVE),
                        textStyle: vn.lightBoldLarge,
                        position: {
                            x: -300,
                            y: -5
                        },
                        fitBoxSizes: {
                            width: 400,
                            height: 120
                        },
                        alignment: "left"
                    },{
                        iconImage: f.ICON_BTN_GEM,
                        iconPosition: {
                            x: 350 - r.width - 100,
                            y: 0
                        }
                    },r);
                    o.position.set(0, De.services.canvas.height / 3.4),
                    o.onClick((function() {
                        return e._onRemoveClicked()
                    }
                    )),
                    this._mainContainer.addChild(o)
                }
                ,
                t.prototype._onAskForHelpClicked = function() {
                    this._options.heavyObjectService.onAskForHelpClicked(this._options.object, this._options.image, this._options.cellPosition, this._options.id),
                    this.close.bind(this)
                }
                ,
                t.prototype._onRemoveClicked = function() {
                    this._options.heavyObjectService.onHireHelpClicked(this._options.object, this._price),
                    this.close.bind(this)
                }
                ,
                t
            }(yr), du = [Ns.OrderButtonUI, Ns.CratesButtonUI, Ns.DiscoveryButtonUI], hu = function(e) {
                function t() {
                    var t = this
                      , i = new lu(Lo.HEAVY_OBJECT_TRACK);
                    return (t = e.call(this, Lo.HEAVY_OBJECT_TRACK, [new ll(Lo.REGAIN_CONTROL_TRACK), i], [new su]) || this)._heavyObjectTrackTrigger = i,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = this._getHeavyObjectThatWasTapped();
                    e ? this._steps.push(new _a(ln.HEAVY_OBJECT_INTRODUCTION), new sa("LogStep","Start of the Heavy Object Track"), new Ka("block all inputs",[ko.OBJECT_DRAG, ko.TAP],!1), new aa("HideElementStep",du,!1), new y_("MoveCameraStep",e), new Da("ShowConversationStep","heavy_object_1"), new H_("allow the user to tap the heavy object",e,!0), new fa("ShowClickStep",{
                        animations: [{
                            layer: ea.MAIN,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: {
                                    column: e.column - 1,
                                    row: e.row - 1
                                }
                            },
                            mirror: !0,
                            duration: 1250
                        }, {
                            animationName: ta.DELAY,
                            duration: 200
                        }],
                        loop: !0
                    }), new _u("AwaitPopoutClosedStep","HO" + ql(e)), new oa("HideConversationStep"), new ra("HideAnimatedHandStep"), new _a(ln.HEAVY_OBJECT_INTRODUCTION,!0), new _a(ln.HEAVY_OBJECT_DEPENDING_ON_FRIENDS), new cu("DisableExitTriggers",this._exitTriggers), new D_("AwaitPopupClosedStep",uu), new al("ConversationWithAnswerStep","heavy_object_2"), new Ka("allow all inputs",[ko.OBJECT_DRAG, ko.TAP],!0), new _a(ln.HEAVY_OBJECT_DEPENDING_ON_FRIENDS,!0), new _a(ln.HEAVY_OBJECT_COMPLETE), new Na("ShowElementStep",du,!1), new _a(ln.HEAVY_OBJECT_COMPLETE,!0), new sa("LogStep","End of the Heavy Object Track")) : this._logger.error("Couldn't find a heavy object with interaction")
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t.prototype._getHeavyObjectThatWasTapped = function() {
                    return this._heavyObjectTrackTrigger.targetObject.getBehavior(Ke.GridPosition)
                }
                ,
                t
            }(Wa), pu = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getMapTracks = function() {
                    return e.prototype.getMapTracks.call(this).concat([new kl, new Jl, new hu])
                }
                ,
                t.prototype.getInteractionReadyTracks = function() {
                    return e.prototype.getInteractionReadyTracks.call(this).concat([Lo.TRAIN_STATION_TRACK_2, Lo.HEAVY_OBJECT_TRACK])
                }
                ,
                t
            }(Ll), vu = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    e.onboarding.isTrackCompleted(Lo.DECORATIVE_OBJECT_INTRODUCTION) ? this._updateStatus() : (this._family = new __(e.world,new c_([Ke.Building, Ke.UndiscoveredBuilding, Ke.InteractionTap, Ke.GridPosition])),
                    this._family.onGameObjectAdded.addListener(this._trigger, this))
                }
                ,
                e.prototype.destroy = function() {
                    this._family && this._family.destroy()
                }
                ,
                e.prototype._trigger = function(e) {
                    this._isDecorativeBuilding(e) && this._updateStatus()
                }
                ,
                e.prototype._updateStatus = function() {
                    var e = this;
                    r.TimeDelay.nextFrame().then((function() {
                        e._family.onGameObjectAdded.removeListener(e._trigger, e),
                        e.status = !0,
                        e.onStatusChanged.fire()
                    }
                    ))
                }
                ,
                e.prototype._isDecorativeBuilding = function(e) {
                    var t = e.getBehavior(Ke.Building);
                    return !(0,
                    r.isNull)(t) && De.services.buildings.isDecorative(t.ID)
                }
                ,
                e
            }(), gu = function(e) {
                function t() {
                    return e.call(this, Lo.DECORATIVE_OBJECT_INTRODUCTION, [new vu, new ll(Lo.REGAIN_CONTROL_TRACK)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    this._steps.push(new _a(ln.DECORATIVE_OBJECT_INTRODUCTION), new sa("LogStep","Enter the DecorativeObjectIntroductionTrack"), new u_("MarkTrackAsCompletedStep",[Lo.DECORATIVE_OBJECT_INTRODUCTION]), new ml("Show the popup to introduce the decorative item",{
                        popupHeader: ce.ONBOARDING_DECORATIVE_OBJECT_HEADER,
                        infoImage: f.ICON_POPUP_DECORATION_EXPLANATION,
                        extraContent: this._getExtraContent()
                    }), new _a(ln.DECORATIVE_OBJECT_INTRODUCTION,!0))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t.prototype._getExtraContent = function() {
                    var e = new Xe.Container;
                    e.position.set(0, 255);
                    var t = De.services.resource.getSprite(f.ICON_POPUP_DECORATION_EXPLANATION).width
                      , i = new v.LabelSettings({
                        fitHeight: 135,
                        fitWidth: 300,
                        fitToBox: !0
                    });
                    i.style = vn.darkSmall;
                    for (var r = 1; r <= 3; r++) {
                        var o = "ONBOARDING_DECORATIVE_OBJECT_STEP_".concat(r)
                          , a = new v.Label(nr(ru || (ru = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce[o]),i);
                        a.anchor.set(.5),
                        a.position.set(-t / 3 + (r - 1) * t / 3, 0),
                        e.addChild(a)
                    }
                    var s = new v.LabelSettings({
                        fitHeight: 75,
                        fitWidth: t - 20,
                        fitToBox: !0
                    });
                    s.style = vn.greySmall;
                    var _ = new v.Label(nr(ou || (ou = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.ONBOARDING_DECORATIVE_OBJECT_SUBTEXT),s);
                    return _.anchor.set(.5),
                    _.position.set(0, 155),
                    e.addChild(_),
                    e
                }
                ,
                t
            }(Wa), fu = (function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                (0,
                n.__extends)(t, e),
                t.prototype.getMapTracks = function() {
                    return e.prototype.getMapTracks.call(this).concat([new kl, new Jl, new hu, new gu])
                }
                ,
                t.prototype.getInteractionReadyTracks = function() {
                    return e.prototype.getInteractionReadyTracks.call(this).concat([Lo.TRAIN_STATION_TRACK_2, Lo.HEAVY_OBJECT_TRACK, Lo.DECORATIVE_OBJECT_INTRODUCTION])
                }
            }(Ll),
            i(700));
            (function() {
                function e() {
                    this.name = "AIPAdsStrategy",
                    this.status = Hn.NOT_INITIALIZED,
                    this.bannerAdPosition = "none",
                    this.useIntervalForBannerAds = !1,
                    this._logger = r.Logger.Of("AIPAdsStrategy"),
                    this._canOpenConsentScreen = !0,
                    this._consentRequired = !0,
                    this._consentGiven = !1,
                    this._loadingScreenConsentPopupShown = !1
                }
                e.prototype.initialize = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            t = AD_IN_PLAY_GAME_TAG_CONTROL,
                            i = AD_IN_PLAY_GAME_ID;
                            try {
                                if (this.status = Hn.INITIALIZING,
                                this._service = new fu.AIPAdsService,
                                Un())
                                    switch (De.services.analytics.tests.group) {
                                    case xn.TestGroupA:
                                        t = AD_IN_PLAY_GAME_TAG_TEST_GROUP_A;
                                        break;
                                    case xn.TestGroupB:
                                        t = AD_IN_PLAY_GAME_TAG_TEST_GROUP_B;
                                        break;
                                    case xn.TestGroupC:
                                        t = AD_IN_PLAY_GAME_TAG_TEST_GROUP_C;
                                        break;
                                    default:
                                        t = AD_IN_PLAY_GAME_TAG_CONTROL
                                    }
                                "FMVStandalone" === i && (r = new URLSearchParams(window.location.search),
                                o = null !== (e = r.get("publisherId")) && void 0 !== e ? e : "",
                                i = o),
                                document.addEventListener("aip_consentscreen", function(e) {
                                    a._loadingScreenConsentPopupShown = !0
                                }
                                .bind(this)),
                                document.addEventListener("aip_consentnotrequired", function(e) {
                                    a._consentRequired = !1
                                }
                                .bind(this)),
                                document.addEventListener("aip_consent", function(e) {
                                    var t = window.__cmp("getCMPData");
                                    "purposeConsents"in t && ("1"in t.purposeConsents && t.purposeConsents[1] ? a._consentGiven = !0 : a._canOpenConsentScreen ? a._loadingScreenConsentPopupShown || (a._consentGiven = !1,
                                    a.showConsentScreen()) : a._canOpenConsentScreen = !0)
                                }
                                .bind(this))
                            } catch (e) {
                                return this.status = Hn.INITIALIZATION_FAILED,
                                [2, Promise.reject(e)]
                            }
                            return [2, this._service.initialize({}, i, t).then((function() {
                                a.status = Hn.INITIALIZED
                            }
                            )).catch((function(e) {
                                return a.status = Hn.INITIALIZATION_FAILED,
                                Promise.reject(e)
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showInterstitialAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, this._showInterstialAd()]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showRewardedAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, this._showRewardedAd()]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.isRewardedAdsSupported = function() {
                    return this._service.isRewardedAdsSupported()
                }
                ,
                e.prototype.isInterstitialAdsSupported = function() {
                    return this._service.isInterstitialAdsSupported()
                }
                ,
                e.prototype.isBannerAdsSupported = function() {
                    return !1
                }
                ,
                e.prototype.prepareInterstitialAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, {
                                status: Mn.SUCCES,
                                reason: ""
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.prepareRewardedAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, {
                                status: Mn.SUCCES,
                                reason: ""
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showBannerAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.hideBannerAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.handleAdError = function() {}
                ,
                e.prototype.showConsentScreen = function() {
                    this._consentRequired ? this._consentGiven ? this._logger.error("Trying to trigger the consent screen, but the consent has already been given.") : (this._canOpenConsentScreen = !1,
                    window.aipAPItag.showCMPScreen()) : this._logger.error("Trying to trigger the consent screen, but consent is not required.")
                }
                ,
                e.prototype._showRewardedAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._consentRequired && !this._consentGiven ? [2, {
                                status: Fn.NO_CONSENT,
                                reason: "NO_CONSENT"
                            }] : [2, this._showAd("rewarded")]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._showInterstialAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, this._showAd("interstitial")]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._showAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a, s = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = "rewarded" === e ? this._service.showRewardedAd.bind(this._service) : this._service.showInterstitialAd.bind(this._service),
                                i = Fn.INVALID,
                                r = void 0,
                                o = "",
                                [4, t().catch((function(t) {
                                    return s._logger.error("Failed to show ".concat(e, " ad: ").concat(t)),
                                    r = t,
                                    fu.AdServiceStatus.AD_SHOWN_FAIL
                                }
                                ))];
                            case 1:
                                switch (a = n.sent()) {
                                case fu.AdServiceStatus.SUCCESS:
                                    i = Fn.VALID;
                                    break;
                                case fu.AdServiceStatus.AD_SHOWN_FAIL:
                                    if (r && r === fu.AIPAdErrorType.VIDEO_AD_ERROR) {
                                        i = Fn.INVALID,
                                        o = r;
                                        break
                                    }
                                    if (r && r === fu.AIPAdErrorType.VIDEO_AD_EMPTY) {
                                        i = Fn.INVALID,
                                        o = "no_fill";
                                        break
                                    }
                                    if (r && r === fu.AIPAdErrorType.USER_HAS_ADBLOCK) {
                                        i = "rewarded" === e ? Fn.AD_BLOCK_DETECTED : Fn.INVALID,
                                        o = "AD_BLOCK_DETECTED";
                                        break
                                    }
                                    i = Fn.INVALID,
                                    o = r;
                                    break;
                                default:
                                    i = Fn.INVALID,
                                    o = a
                                }
                                return [2, {
                                    status: i,
                                    reason: o
                                }]
                            }
                        }
                        ))
                    }
                    ))
                }
            }
            )(),
            function() {
                function e() {
                    this.status = Hn.NOT_INITIALIZED,
                    this.name = "AzerionAdsStrategy",
                    this.bannerAdPosition = "bottom",
                    this.useIntervalForBannerAds = !1,
                    this._logger = r.Logger.Of("AzerionAdsStrategy")
                }
                e.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.azerion = vp.platform.initializePlatform.azerion,
                            this.status = Hn.INITIALIZED,
                            this._logger.info("Azerion Ads Initialized"),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.isInterstitialAdsSupported = function() {
                    return !0
                }
                ,
                e.prototype.isBannerAdsSupported = function() {
                    return !1
                }
                ,
                e.prototype.isRewardedAdsSupported = function() {
                    return !0
                }
                ,
                e.prototype.prepareInterstitialAd = function(e) {
                    return this.azerion.ads.interstitial.preloadAd().then((function() {
                        return {
                            status: Mn.SUCCES,
                            reason: "interstitial ad loaded"
                        }
                    }
                    )).catch((function() {
                        return {
                            status: Mn.FAIL,
                            reason: "UNKNOWN_ERROR"
                        }
                    }
                    ))
                }
                ,
                e.prototype.prepareRewardedAd = function(e) {
                    return this.azerion.ads.rewarded.preloadAd().then((function() {
                        return {
                            status: Mn.SUCCES,
                            reason: "rewarded ad loaded"
                        }
                    }
                    )).catch((function() {
                        return {
                            status: Mn.FAIL,
                            reason: "UNKNOWN_ERROR"
                        }
                    }
                    ))
                }
                ,
                e.prototype.showInterstitialAd = function() {
                    return this.azerion.ads.interstitial.showAd().then((function() {
                        return {
                            status: Fn.VALID,
                            reason: "SUCCESS"
                        }
                    }
                    )).catch((function() {
                        return {
                            status: Fn.INVALID,
                            reason: "UNKNOWN_ERROR"
                        }
                    }
                    ))
                }
                ,
                e.prototype.showRewardedAd = function() {
                    return this.azerion.ads.rewarded.showAd().then((function() {
                        return {
                            status: Fn.VALID,
                            reason: "SUCCESS"
                        }
                    }
                    )).catch((function() {
                        return {
                            status: Fn.INVALID,
                            reason: "UNKNOWN_ERROR"
                        }
                    }
                    ))
                }
                ,
                e.prototype.showBannerAd = function() {
                    throw new Error("Method not implemented.")
                }
                ,
                e.prototype.hideBannerAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
            }(),
            function() {
                function e(e) {
                    this.name = "CrazyGamesAdsStrategy",
                    this.status = Hn.NOT_INITIALIZED,
                    this.useIntervalForBannerAds = !1,
                    this.bannerAdPosition = "bottom",
                    this._hasAdblock = !0,
                    this._logger = r.Logger.Of("CrazyGamesAdsStrategy"),
                    this._crazyGamesSdk = e
                }
                e.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this.status = Hn.INITIALIZING,
                                e = this,
                                [4, this._crazyGamesSdk.ad.hasAdblock()];
                            case 1:
                                return e._hasAdblock = t.sent(),
                                this._logger.info("Crazygames Ads Initialized. adblock = ".concat(this._hasAdblock)),
                                this.status = Hn.INITIALIZED,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.isInterstitialAdsSupported = function() {
                    return !this._hasAdblock
                }
                ,
                e.prototype.isBannerAdsSupported = function() {
                    return !1
                }
                ,
                e.prototype.isRewardedAdsSupported = function() {
                    return !this._hasAdblock
                }
                ,
                e.prototype.prepareInterstitialAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, {
                                status: Mn.SUCCES,
                                reason: ""
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.prepareRewardedAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, {
                                status: Mn.SUCCES,
                                reason: ""
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showInterstitialAd = function() {
                    var e = this;
                    return new Promise((function(t) {
                        e._crazyGamesSdk.ad.requestAd("midgame", {
                            adStarted: function() {
                                return e._logger.info("Interstitial Ad Started")
                            },
                            adFinished: function() {
                                e._logger.info("Interstitial Ad Finished"),
                                t({
                                    status: Fn.VALID,
                                    reason: "SUCCESS"
                                })
                            },
                            adError: function(i) {
                                e._logger.warn("Interstitial Ad Error ".concat(i)),
                                t({
                                    status: Fn.INVALID,
                                    reason: i
                                })
                            }
                        })
                    }
                    ))
                }
                ,
                e.prototype.showRewardedAd = function() {
                    var e = this;
                    return new Promise((function(t) {
                        e._crazyGamesSdk.ad.requestAd("rewarded", {
                            adStarted: function() {
                                return e._logger.info("Rewarded Ad Started")
                            },
                            adFinished: function() {
                                e._logger.info("Rewarded Ad Finished"),
                                t({
                                    status: Fn.VALID,
                                    reason: "SUCCESS"
                                })
                            },
                            adError: function(i) {
                                e._logger.warn("Rewarded Ad Error ".concat(i)),
                                t({
                                    status: Fn.INVALID,
                                    reason: i
                                })
                            }
                        })
                    }
                    ))
                }
                ,
                e.prototype.showBannerAd = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype.hideBannerAd = function() {
                    return Promise.resolve()
                }
            }(),
            function() {
                function e(e) {
                    this.name = "FacebookAdsStrategy",
                    this.status = Hn.NOT_INITIALIZED,
                    this.useIntervalForBannerAds = !0,
                    this.bannerAdPosition = "bottom",
                    this._rewardedAdReady = !1,
                    this._interstitialAdReady = !1,
                    this._logger = r.Logger.Of("FacebookAdsStrategy"),
                    this._facebookSDK = e
                }
                Object.defineProperty(e.prototype, "_platform", {
                    get: function() {
                        return this._facebookSDK.messagingPlatform.platform
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "_platformIDSet", {
                    get: function() {
                        var e, t;
                        switch (this._platform) {
                        case a.Platform.ANDROID:
                            return null !== (e = FACEBOOK_AD_IDS.ANDROID) && void 0 !== e ? e : FACEBOOK_AD_IDS.WEB;
                        case a.Platform.IOS:
                            return null !== (t = FACEBOOK_AD_IDS.IOS) && void 0 !== t ? t : FACEBOOK_AD_IDS.WEB;
                        default:
                            return FACEBOOK_AD_IDS.WEB
                        }
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "_rewardedVideoPlacementID", {
                    get: function() {
                        return this._platformIDSet.REWARDED_VIDEO
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "_interstitialPlacementID", {
                    get: function() {
                        return this._platformIDSet.INTERSTITIAL
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "_bannerPlacementID", {
                    get: function() {
                        return this._platformIDSet.BANNER
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initialize = function() {
                    var e = this;
                    return this.status = Hn.INITIALIZING,
                    this._setPlacementIDs(),
                    this._facebookSDK.ads.initialize().then((function() {
                        e._logger.info("FacebookAdsStrategy initialized"),
                        e.status = Hn.INITIALIZED
                    }
                    )).catch((function(t) {
                        e._logger.error("Failed to initialize FacebookAdsStrategy", t),
                        e.status = Hn.INITIALIZATION_FAILED
                    }
                    ))
                }
                ,
                e.prototype.isInterstitialAdsSupported = function() {
                    return this._facebookSDK.ads.isInterstitialAdsSupported()
                }
                ,
                e.prototype.isBannerAdsSupported = function() {
                    return !1
                }
                ,
                e.prototype.isRewardedAdsSupported = function() {
                    return this._facebookSDK.ads.isRewardedAdsSupported()
                }
                ,
                e.prototype.prepareInterstitialAd = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return De.services.analytics.design.reportAdRequest(Vn.INTERSTITIAL, e, this.name),
                            [2, this._facebookSDK.ads.prepareInterstitialAd(t).then((function(t) {
                                return t === a.AdServiceStatus.SUCCESS ? (i._interstitialAdReady = !0,
                                De.services.analytics.design.reportAdRequestResult(Vn.INTERSTITIAL, e, i.name, "SUCCESS"),
                                {
                                    status: Mn.SUCCES,
                                    reason: "interstitial ad loaded"
                                }) : (De.services.analytics.design.reportAdRequestResult(Vn.INTERSTITIAL, i.name, "FAIL", t),
                                {
                                    status: Mn.FAIL,
                                    reason: t
                                })
                            }
                            )).catch((function(e) {
                                return De.services.analytics.design.reportAdRequestResult(Vn.INTERSTITIAL, i.name, "FAIL", e.code),
                                i._logger.error("Failed to prepare interstitial ad ".concat(e.message)),
                                {
                                    status: Mn.FAIL,
                                    reason: e
                                }
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.prepareRewardedAd = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return De.services.analytics.design.reportAdRequest(Vn.REWARDED_VIDEO, e, this.name),
                            [2, this._facebookSDK.ads.prepareRewardedAd(t).then((function(t) {
                                return t === a.AdServiceStatus.SUCCESS ? (i._rewardedAdReady = !0,
                                De.services.analytics.design.reportAdRequestResult(Vn.REWARDED_VIDEO, e, i.name, "SUCCESS"),
                                {
                                    status: Mn.SUCCES,
                                    reason: "rewarded ad loaded"
                                }) : (De.services.analytics.design.reportAdRequestResult(Vn.REWARDED_VIDEO, e, i.name, "FAIL", t),
                                {
                                    status: Mn.FAIL,
                                    reason: t
                                })
                            }
                            )).catch((function(t) {
                                return De.services.analytics.design.reportAdRequestResult(Vn.REWARDED_VIDEO, e, i.name, "FAIL", t.code),
                                i._logger.error("Failed to prepare rewarded ad ".concat(t.message)),
                                {
                                    status: Mn.FAIL,
                                    reason: t
                                }
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showInterstitialAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._interstitialAdReady ? [3, 2] : [4, this.prepareInterstitialAd(e)];
                            case 1:
                                if (i.sent(),
                                !this._interstitialAdReady)
                                    return [2, {
                                        status: Fn.INVALID,
                                        reason: "NO_AD_READY"
                                    }];
                                i.label = 2;
                            case 2:
                                return [2, this._facebookSDK.ads.showInterstitialAd().then((function(e) {
                                    return {
                                        status: t._getAdValidityStatus(e),
                                        reason: "SUCCESS"
                                    }
                                }
                                )).catch((function(e) {
                                    return t._reportError(Vn.INTERSTITIAL, e),
                                    {
                                        status: t._getAdValidityStatus(e.code),
                                        reason: e.code
                                    }
                                }
                                )).finally((function() {
                                    t._interstitialAdReady = !1
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showRewardedAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._rewardedAdReady ? [3, 2] : [4, this.prepareRewardedAd(e)];
                            case 1:
                                if (i.sent(),
                                !this._rewardedAdReady)
                                    return [2, {
                                        status: Fn.INVALID,
                                        reason: "NO_AD_READY"
                                    }];
                                i.label = 2;
                            case 2:
                                return [2, this._facebookSDK.ads.showRewardedAd().then((function(e) {
                                    return {
                                        status: t._getAdValidityStatus(e),
                                        reason: "SUCCESS"
                                    }
                                }
                                )).catch((function(e) {
                                    return t._reportError(Vn.REWARDED_VIDEO, e),
                                    {
                                        status: t._getAdValidityStatus(e.code),
                                        reason: e.code
                                    }
                                }
                                )).finally((function() {
                                    t._rewardedAdReady = !1
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showBannerAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, Promise.resolve()]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.hideBannerAd = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype._setPlacementIDs = function() {
                    this._facebookSDK.ads.setInterstitialId(this._interstitialPlacementID),
                    this._facebookSDK.ads.setRewardedId(this._rewardedVideoPlacementID),
                    this._facebookSDK.ads.setBannerId(this._bannerPlacementID)
                }
                ,
                e.prototype._reportError = function(e, t) {
                    this._logger.error("Ad cannot be showed for some reason. Code: ".concat(t.code, ", message: ").concat(t.message))
                }
                ,
                e.prototype._getAdValidityStatus = function(e) {
                    return e === a.AdServiceStatus.SUCCESS ? Fn.VALID : e === a.AdServiceStatus.AD_SHOWN_FAIL ? Fn.AD_SKIPPED : Fn.INVALID
                }
            }(),
            function(e) {
                e.REQUEST_THROTTLED = "REQUEST_THROTTLED",
                e.LOAD_ADS_CLIENT_FAILURE = "LOAD_ADS_CLIENT_FAILURE",
                e.LOAD_ADS_FAILURE = "LOAD_ADS_FAILURE",
                e.SHOW_ADS_COMPLETED_FAILURE = "SHOW_ADS_COMPLETED_FAILURE"
            }(au || (au = {}));
            var Eu, mu = "top:320x50", yu = (function() {
                function e(e) {
                    this.name = "MSStartAdsStrategy",
                    this.status = Hn.NOT_INITIALIZED,
                    this.bannerAdPosition = "top",
                    this.useIntervalForBannerAds = !1,
                    this._logger = r.Logger.Of("MSStartAdsStrategy"),
                    this._currentInsterstitialAd = null,
                    this._currentRewardedAd = null,
                    this._currentBannerAdConfiguration = null,
                    this._isBannerAdSupported = !1,
                    this._isBannerAdTriggerAnalyticsReported = !1,
                    this._isBannerAdResultAnalyticsReported = !1,
                    this._msStartSDK = e,
                    this.prepareBannerAd()
                }
                e.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                this.status = Hn.INITIALIZING,
                                t.label = 1;
                            case 1:
                                return t.trys.push([1, 3, , 4]),
                                [4, this.prepareBannerAd()];
                            case 2:
                                return t.sent(),
                                [3, 4];
                            case 3:
                                return e = t.sent(),
                                this._logger.error("Failed to initialize MSStartAdsStrategy: ".concat(e)),
                                this.status = Hn.INITIALIZATION_FAILED,
                                [2];
                            case 4:
                                return this.status = Hn.INITIALIZED,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.isInterstitialAdsSupported = function() {
                    return !0
                }
                ,
                e.prototype.isBannerAdsSupported = function() {
                    return this._isBannerAdSupported
                }
                ,
                e.prototype.isRewardedAdsSupported = function() {
                    return !0
                }
                ,
                e.prototype.prepareInterstitialAd = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return De.services.analytics.design.reportAdRequest(Vn.INTERSTITIAL, e, this.name),
                            (0,
                            r.isNull)(this._currentInsterstitialAd) ? [2, this._msStartSDK.loadAdsAsync(!1).then((function(i) {
                                return t._currentInsterstitialAd = i,
                                De.services.analytics.design.reportAdRequestResult(Vn.INTERSTITIAL, e, t.name, "SUCCES"),
                                {
                                    status: Mn.SUCCES,
                                    reason: "interstitial ad loaded"
                                }
                            }
                            )).catch((function(e) {
                                return t._logger.error("Failed to load interstitial ad: ".concat(e)),
                                De.services.analytics.design.reportAdRequestResult(Vn.INTERSTITIAL, t.name, "FAIL", e.code),
                                e.extra && e.extra.adBlockerDetected ? {
                                    status: Mn.AD_BLOCK_DETECTED,
                                    reason: "AD_BLOCK_DETECTED"
                                } : (e.code,
                                e.code,
                                au.LOAD_ADS_FAILURE,
                                {
                                    status: Mn.FAIL,
                                    reason: e.code
                                })
                            }
                            ))] : [2, {
                                status: Mn.SUCCES,
                                reason: "already loaded"
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showInterstitialAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (0,
                                r.isNull)(this._currentInsterstitialAd) ? [4, this.prepareInterstitialAd(e)] : [3, 2];
                            case 1:
                                if (t = n.sent(),
                                (0,
                                r.isNull)(this._currentInsterstitialAd))
                                    return t.status === Mn.AD_BLOCK_DETECTED ? [2, {
                                        status: Fn.AD_BLOCK_DETECTED,
                                        reason: "AD_BLOCK_DETECTED"
                                    }] : [2, {
                                        status: Fn.INVALID,
                                        reason: t.reason
                                    }];
                                n.label = 2;
                            case 2:
                                i = void 0,
                                n.label = 3;
                            case 3:
                                return n.trys.push([3, 5, , 6]),
                                [4, this._msStartSDK.showAdsAsync(this._currentInsterstitialAd.instanceId)];
                            case 4:
                                return i = n.sent(),
                                [3, 6];
                            case 5:
                                return o = n.sent(),
                                this._currentInsterstitialAd = null,
                                this._logger.error("Failed to show interstitial ad: ".concat(o)),
                                [2, {
                                    status: Fn.INVALID,
                                    reason: o.code
                                }];
                            case 6:
                                return [2, new Promise((function(e) {
                                    i && i.showAdsCompletedAsync || e({
                                        status: Fn.INVALID,
                                        reason: "NO_AD_READY"
                                    }),
                                    i.showAdsCompletedAsync.then((function(t) {
                                        e({
                                            status: Fn.VALID,
                                            reason: "SUCCESS"
                                        })
                                    }
                                    )).catch((function(e) {
                                        return {
                                            status: Fn.INVALID,
                                            reason: "".concat(e.code, " \n").concat(e.description)
                                        }
                                    }
                                    )).finally((function() {
                                        a._currentInsterstitialAd = null
                                    }
                                    ))
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.prepareRewardedAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return De.services.analytics.design.reportAdRequest(Vn.REWARDED_VIDEO, e, this.name),
                            (0,
                            r.isNull)(this._currentRewardedAd) ? [2, this._msStartSDK.loadAdsAsync(!0).then((function(i) {
                                return t._currentRewardedAd = i,
                                De.services.analytics.design.reportAdRequestResult(Vn.REWARDED_VIDEO, e, t.name, "SUCCES"),
                                {
                                    status: Mn.SUCCES,
                                    reason: "rewarded ad loaded"
                                }
                            }
                            )).catch((function(e) {
                                return t._logger.error("Failed to load rewarded ad: ".concat(e)),
                                De.services.analytics.design.reportAdRequestResult(Vn.REWARDED_VIDEO, t.name, "FAIL", e.code),
                                e.extra && e.extra.adBlockerDetected ? {
                                    status: Mn.AD_BLOCK_DETECTED,
                                    reason: "AD_BLOCK_DETECTED"
                                } : (e.code,
                                e.code,
                                au.LOAD_ADS_FAILURE,
                                {
                                    status: Mn.FAIL,
                                    reason: e.code
                                })
                            }
                            ))] : [2, {
                                status: Mn.SUCCES,
                                reason: "already loaded"
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showRewardedAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (0,
                                r.isNull)(this._currentRewardedAd) ? [4, this.prepareRewardedAd(e)] : [3, 2];
                            case 1:
                                if (t = n.sent(),
                                (0,
                                r.isNull)(this._currentRewardedAd))
                                    return t.status === Mn.AD_BLOCK_DETECTED ? [2, {
                                        status: Fn.AD_BLOCK_DETECTED,
                                        reason: "AD_BLOCK_DETECTED"
                                    }] : [2, {
                                        status: Fn.INVALID,
                                        reason: t.reason
                                    }];
                                n.label = 2;
                            case 2:
                                i = void 0,
                                n.label = 3;
                            case 3:
                                return n.trys.push([3, 5, , 6]),
                                [4, this._msStartSDK.showAdsAsync(this._currentRewardedAd.instanceId)];
                            case 4:
                                return i = n.sent(),
                                [3, 6];
                            case 5:
                                return o = n.sent(),
                                this._currentRewardedAd = null,
                                this._logger.error("Failed to show rewarded ad: ".concat(o)),
                                [2, {
                                    status: Fn.INVALID,
                                    reason: o.code
                                }];
                            case 6:
                                return [2, new Promise((function(e) {
                                    i && i.showAdsCompletedAsync || e({
                                        status: Fn.INVALID,
                                        reason: "NO_AD_READY"
                                    }),
                                    i.showAdsCompletedAsync.then((function(t) {
                                        e({
                                            status: Fn.VALID,
                                            reason: "SUCCESS"
                                        })
                                    }
                                    )).catch((function(t) {
                                        "SHOW_ADS_COMPLETED_FAILURE" === t.code ? e({
                                            status: Fn.AD_SKIPPED,
                                            reason: "SKIPPED"
                                        }) : e({
                                            status: Fn.INVALID,
                                            reason: t.description
                                        })
                                    }
                                    )).finally((function() {
                                        a._currentRewardedAd = null
                                    }
                                    ))
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.prepareBannerAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._currentBannerAdConfiguration = mu,
                            this.bannerAdPosition = "top",
                            window.innerWidth > window.innerHeight && (this._isBannerAdSupported = !0),
                            [2, Promise.resolve()]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showBannerAd = function() {
                    var e = this;
                    return this._fireBannerAdTriggerAnalytics(),
                    new Promise((function(t, i) {
                        if (!e._currentBannerAdConfiguration)
                            return Promise.reject("NO_AD_PLACEMENT_FOUND");
                        e._msStartSDK.showDisplayAdsAsync(e._currentBannerAdConfiguration).then((function() {
                            e._fireBannerAdResultAnalytics(),
                            t()
                        }
                        )).catch((function(t) {
                            e._fireBannerAdResultAnalytics(t.code),
                            i(t)
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.hideBannerAd = function() {
                    var e = this;
                    return new Promise((function(t) {
                        e._msStartSDK.hideDisplayAdsAsync().then((function() {
                            return t()
                        }
                        )).catch((function(i) {
                            e._logger.warn("Failed to hide banner ad", i),
                            t()
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._fireBannerAdTriggerAnalytics = function() {
                    this._isBannerAdTriggerAnalyticsReported || (this._isBannerAdTriggerAnalyticsReported = !0,
                    De.services.analytics.design.reportDisplayAdRequested())
                }
                ,
                e.prototype._fireBannerAdResultAnalytics = function(e) {
                    void 0 === e && (e = null),
                    this._isBannerAdResultAnalyticsReported || (this._isBannerAdResultAnalyticsReported = !0,
                    (0,
                    r.isNull)(e) ? De.services.analytics.design.reportDisplayAdSuccesfullShow() : De.services.analytics.design.reportDisplayAdRejected(e.code))
                }
            }(),
            function() {
                function e() {
                    this.name = "NoAdsStrategy",
                    this.status = Hn.NOT_INITIALIZED,
                    this.useIntervalForBannerAds = !1,
                    this.bannerAdPosition = "top"
                }
                return e.prototype.initialize = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype.isInterstitialAdsSupported = function() {
                    return !1
                }
                ,
                e.prototype.isBannerAdsSupported = function() {
                    return !1
                }
                ,
                e.prototype.isRewardedAdsSupported = function() {
                    return !1
                }
                ,
                e.prototype.prepareInterstitialAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, {
                                status: Mn.SUCCES,
                                reason: ""
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.prepareRewardedAd = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, {
                                status: Mn.SUCCES,
                                reason: ""
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.showInterstitialAd = function() {
                    return Promise.resolve({
                        status: Fn.INVALID,
                        reason: "ADS_UNSUPPORTED"
                    })
                }
                ,
                e.prototype.showRewardedAd = function() {
                    return Promise.resolve({
                        status: Fn.INVALID,
                        reason: "ADS_UNSUPPORTED"
                    })
                }
                ,
                e.prototype.showBannerAd = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype.hideBannerAd = function() {
                    return Promise.resolve()
                }
                ,
                e
            }()), Tu = i(6806), Au = function() {
                function e(e) {
                    this._number = e,
                    this._logger = r.Logger.Of("GADimension"),
                    this._currentValue = "",
                    this._availableValues = []
                }
                return e.prototype._setUpDimension = function(e) {
                    if (!e || 0 === e.length)
                        throw new Error("Custom dimensions can't be empty");
                    if (e.length > 20)
                        throw new Error("Custom dimensions can't be more than 20");
                    Tu.GameAnalytics["configureAvailableCustomDimensions0" + this._number](e),
                    this._availableValues = e
                }
                ,
                e.prototype._setDimension = function(e) {
                    0 === this._availableValues.length && this._logger.warn("Dimension ".concat(this._number, " is not set up")),
                    this._availableValues.includes(e) || this._logger.warn("Value ".concat(e, " is not available for dimension ").concat(this._number, ", accepted values are ").concat(this._availableValues.join(", "))),
                    this._currentValue !== e && (Tu.GameAnalytics["setCustomDimension0" + this._number](e),
                    this._currentValue = e)
                }
                ,
                e
            }(), Cu = function(e) {
                function t(t) {
                    return e.call(this, t) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.update = function() {
                    r.Logger.Of("MockDimension").info("MockDimension update called")
                }
                ,
                t
            }(Au), Iu = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this
                      , n = Math.min(De.services.analytics.model.totalDays, 97);
                    return i._setUpDimension([String(n), String(n + 1), "99OrMore"]),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.update = function() {
                    var e = De.services.analytics.model
                      , t = String(e.totalDays);
                    e.totalDays >= 99 && (t = "99OrMore"),
                    this._setDimension(t)
                }
                ,
                t
            }(Au), Su = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this
                      , n = De.services.experience.getLevel()
                      , r = Array.from({
                        length: 20
                    }, (function(e, t) {
                        return String(n + t)
                    }
                    ));
                    return i._setUpDimension(r),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.update = function() {
                    var e = De.services.experience.getLevel();
                    this._setDimension(String(e))
                }
                ,
                t
            }(Au), Ou = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._values = ["guest", "$0", "$0.01-$3", "$3-$20", "$20-$100", "$100-$200", "$200-$500", "$500-$1000", "$1000+"],
                    i._setUpDimension(i._values),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.update = function() {
                    var e = De.services.analytics.model.totalSpent
                      , t = 0;
                    switch (!0) {
                    case e > 1e3:
                        t = 8;
                        break;
                    case e > 500:
                        t = 7;
                        break;
                    case e > 200:
                        t = 6;
                        break;
                    case e > 100:
                        t = 5;
                        break;
                    case e > 20:
                        t = 4;
                        break;
                    case e > 3:
                        t = 3;
                        break;
                    case e > 0:
                        t = 2;
                        break;
                    default:
                        t = vp.platform.loginStrategy.isUserLoggedIn() ? 1 : 0
                    }
                    var i = this._values[t];
                    this._setDimension(i)
                }
                ,
                t
            }(Au);
            !function(e) {
                e.DAILY_CHALLENGE = "daily_challenge",
                e.DAILY_BONUS = "daily_bonus",
                e.PUBLISHER_IDS = "publisher_ids"
            }(Eu || (Eu = {}));
            var bu, Ru, wu, Du = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._backendSDK = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return ze.USE_NAKAMA ? (Object.values(Eu).forEach((function(t) {
                                return (0,
                                n.__awaiter)(e, void 0, void 0, (function() {
                                    var e, i;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        switch (n.label) {
                                        case 0:
                                            return n.trys.push([0, 2, , 3]),
                                            [4, this._backendSDK.configuration.getOrFetchConfigFile(t)];
                                        case 1:
                                            return e = n.sent(),
                                            (0,
                                            r.isUndefined)(e) ? (this._logger.warn('Failed to load configuration "'.concat(t, '", data is undefined')),
                                            [2]) : (this._logger.info('Loaded configuration "'.concat(t, '"')),
                                            [3, 3]);
                                        case 2:
                                            return i = n.sent(),
                                            this._logger.error('Failed to load configuration "'.concat(t, '" with error: ').concat(i)),
                                            [3, 3];
                                        case 3:
                                            return [2]
                                        }
                                    }
                                    ))
                                }
                                ))
                            }
                            )),
                            [2]) : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.loadConfiguration = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return n.trys.push([0, 5, , 6]),
                                ze.USE_NAKAMA ? [4, this._backendSDK.configuration.getOrFetchConfigFile(e)] : [3, 2];
                            case 1:
                                return t = n.sent(),
                                [3, 4];
                            case 2:
                                return [4, this.fetchConfigurationFromEndpoint(e)];
                            case 3:
                                t = n.sent(),
                                n.label = 4;
                            case 4:
                                return [2, t];
                            case 5:
                                return i = n.sent(),
                                this._logger.error('Failed to load cached configuration "'.concat(e, '" with error: ').concat(i, ", make sure to add configuration to NakamaConfigurations enum")),
                                [2, void 0];
                            case 6:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.fetchConfigurationFromEndpoint = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                t = "https://".concat("1187013846746005515.discordsays.com/nakama", "/"),
                                i = "api/configurations",
                                n.label = 1;
                            case 1:
                                return n.trys.push([1, 5, , 6]),
                                [4, fetch(t + i, {
                                    method: "POST",
                                    body: JSON.stringify({})
                                })];
                            case 2:
                                return (r = n.sent()).ok ? [4, r.json()] : [3, 4];
                            case 3:
                                return o = n.sent(),
                                [2, JSON.parse(o.configs[e])];
                            case 4:
                                return [3, 6];
                            case 5:
                                return a = n.sent(),
                                this._logger.error('Failed to fetch configuration "'.concat(e, '" with error: ').concat(a)),
                                [3, 6];
                            case 6:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se), Nu = "not_provided", Lu = (function(e) {
                function t(t) {
                    var i, n = this;
                    (n = e.call(this, t) || this)._fetchList = [],
                    n._currentPublisherId = "";
                    var r = null !== (i = new URLSearchParams(window.location.search).get("publisherId")) && void 0 !== i ? i : Nu;
                    return n._currentPublisherId = r,
                    n._setUpDimension([n._currentPublisherId]),
                    n
                }
                (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._fetchPublisherIdWhitelist()];
                            case 1:
                                return e.sent(),
                                [4, this._checkPublisherId()];
                            case 2:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.update = function() {}
                ,
                t.prototype._checkPublisherId = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, new Promise((function(t, i) {
                                -1 !== e._fetchList.indexOf(e._currentPublisherId) ? (e._setDimension(e._currentPublisherId),
                                t()) : (e._sendGAEvent(),
                                i(e._currentPublisherId === Nu ? "Publisher id not provided" : "Publisher id ".concat(e._currentPublisherId, " not found in the whitelist")))
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._fetchPublisherIdWhitelist = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, De.services.nakamaConfigurationLoadService.loadConfiguration(Eu.PUBLISHER_IDS)];
                            case 1:
                                return (null == (e = i.sent()) ? void 0 : e.publisher_ids) ? e.publisher_ids.forEach((function(e) {
                                    t._fetchList.push(e)
                                }
                                )) : this._logger.error("Publisher id whitelist not found"),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._sendGAEvent = function() {
                    Tu.GameAnalytics.initialize("bc94da2219a0c03b1c3ac298bed49a2d", "83cc35aaa4c916b0561ffe0ca201f6e834250f0b"),
                    Tu.GameAnalytics.startSession(),
                    De.services.analytics.design.start(),
                    De.services.analytics.design.reportPublisherIdNotWhitelisted(this._currentPublisherId),
                    Tu.GameAnalytics.endSession()
                }
            }(Au),
            function(e) {
                function t(i) {
                    var n = e.call(this, i) || this;
                    if (!t._sessionUAType)
                        throw new Error("User acquisition type is not set, should be set before the constructor is called");
                    var r = De.services.analytics.model;
                    return r.getUserAcquisitionType() || r.setUserAcquisitionType(t._sessionUAType),
                    n._permanentUAType = r.getUserAcquisitionType(),
                    n._setUpDimension([n._permanentUAType]),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.setValue = function(e) {
                    this._sessionUAType = e
                }
                ,
                t.prototype.update = function() {
                    this._setDimension(this._permanentUAType)
                }
                ,
                t
            }(Au)), Bu = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "FriendsListPopup",
                    i._friends = t,
                    i._height = 200 + 55 * (i._friends.length + 1),
                    i._createBackground(),
                    i._createContent(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBackground = function() {
                    this._background = new Ar({
                        size: {
                            width: 1200,
                            height: this._height
                        },
                        showCloseButton: !1
                    }),
                    this._content.addChild(this._background)
                }
                ,
                t.prototype._createContent = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: this._height - 200,
                        fitWidth: 1140
                    });
                    e.style = vn.darkMedium;
                    var t = 0 === this._friends.length ? "No friends" : this._friends.map((function(e) {
                        return "".concat(e.id, ": ").concat(e.name)
                    }
                    )).join(",\n")
                      , i = new v.Label(t,e);
                    i.anchor.set(.5),
                    i.position.set(0, 50),
                    this._content.addChild(i)
                }
                ,
                t
            }(yr);
            !function(e) {
                e.Money = "KeyM",
                e.Advertisement = "KeyV",
                e.Boxes = "KeyB",
                e.Energy = "KeyN",
                e.Cooldown = "KeyC",
                e.Level = "KeyL",
                e.Ticket = "KeyT",
                e.Exp = "KeyX",
                e.Ingredients = "KeyI",
                e.ExportData = "KeyO",
                e.ClearStorage = "KeyG",
                e.ResetHeavyObject = "KeyJ",
                e.MobileLogger = "KeyP",
                e.PerformanceStats = "KeyS",
                e.Onboarding = "KeyF",
                e.SpriteDebug = "KeyD",
                e.ToggleNPCDestination = "KeyK",
                e.UnlockAllAreas = "KeyU",
                e.BannerAd = "KeyH",
                e.ToggleOnScreenCheatUI = "KeyR"
            }(bu || (bu = {})),
            function(e) {
                e.PLUS = "Equal",
                e.MINUS = "Minus"
            }(Ru || (Ru = {})),
            function(e) {
                e.INVENTORY = "Inventory",
                e.DATA = "Data",
                e.TASKS = "Tasks",
                e.ADS = "Ads",
                e.UI = "UI",
                e.DEBUG = "Debug",
                e.COOLDOWN = "Cooldown",
                e.EVENTS = "Events",
                e.DAILY_CHALLENGE = "Daily Challenge",
                e.CRATE_COOLDOWN = "Crate Cooldown",
                e.MISC = "Misc",
                e.WORLD_TO_LIFE = "World to Life",
                e.PLATFORM = "Platform"
            }(wu || (wu = {}));
            var Pu, ku, xu = function(e) {
                function t(t) {
                    var i = e.call(this, "Show connected friends", t) || this;
                    return i._logger = r.Logger.Of("ShowConnectedFriendsCheat"),
                    i.addEvent.addListener(i.execute, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return vp.platform.facebookSDK.messagingPlatform.getConnectedFriends().then((function(e) {
                                console.log(e),
                                De.services.navigation.closeAllPopups(),
                                De.services.navigation.showPopup(Bu, e, !1)
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(function() {
                function e(e, t, i) {
                    this.addEvent = new r.Event,
                    this.minEvent = new r.Event,
                    this.assignButton = !1,
                    this.assignedButton = null,
                    this._active = !1,
                    this.title = e,
                    this.minTitle = t,
                    this.key = i
                }
                return e.prototype.setupKeyBinds = function() {
                    var e = this;
                    window.addEventListener("keydown", (function(t) {
                        var i = t.code;
                        if (Object.values(Ru).includes(i) && e._active)
                            return i === Ru.PLUS && e.addEvent.fire(),
                            void (i === Ru.MINUS && e.minEvent.fire());
                        e._active = i === e.key
                    }
                    ))
                }
                ,
                e
            }()), Gu = (function() {
                function e() {}
                e.prototype.initialize = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype.getPlatformCheats = function() {
                    return [new xu]
                }
            }(),
            function() {
                function e() {}
                return e.prototype.initialize = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype.getPlatformCheats = function() {
                    return []
                }
                ,
                e
            }()), Uu = function() {
                function e(e) {
                    this._discordSdk = e
                }
                return e.prototype.openExternalLink = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, this._discordSdk.commands.openExternalLink({
                                url: e
                            }).then((function(e) {
                                return e
                            }
                            )).catch((function(e) {
                                return e
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.canUseHeavyObjectSocialShare = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return vp.platform.loginStrategy.isUserLoggedIn() ? [4, vp.platform.discordSDK.commands.getChannelPermissions()] : [2, !1];
                            case 1:
                                return e = t.sent().permissions,
                                [2, o.Qs.can(o.Pl.CREATE_INSTANT_INVITE, e)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.heavyObject = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, new Promise((function(t, i) {
                                if (!vp.platform.loginStrategy.isUserLoggedIn())
                                    return vp.platform.loginStrategy.attemptLogin().then((function(e) {
                                        e === be.SUCCESS && IO()
                                    }
                                    )),
                                    i("USER_NOT_LOGGED_IN");
                                e._discordSdk.commands.openInviteDialog().then((function() {
                                    t()
                                }
                                )).catch((function(e) {
                                    i(e)
                                }
                                ))
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.cratesForFriends = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }();
            i(7462),
            function(e) {
                e.SHARE_CONTENT = "SHARE_CONTENT",
                e.INVITE_FRIEND = "INVITE_FRIEND"
            }(Pu || (Pu = {})),
            function(e) {
                e.HEAVY_OBJECT = "HEAVY_OBJECT",
                e.CRATES_FOR_FRIENDS = "CRATES_FOR_FRIENDS"
            }(ku || (ku = {}));
            var Fu, Mu, Vu, Hu, ju, Ku = function(e) {
                return e && e.type === ku.CRATES_FOR_FRIENDS
            }, Wu = function(e) {
                return e && e.type === ku.HEAVY_OBJECT
            }, zu = (function() {
                function e(e) {
                    this._logger = Ie.Of("FacebookCustomShare"),
                    this._facebookSDK = e
                }
                e.prototype.openExternalLink = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.canUseHeavyObjectSocialShare = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, !0]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.heavyObject = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o;
                        return (0,
                        n.__generator)(this, (function(a) {
                            switch (a.label) {
                            case 0:
                                return [4, this._facebookSDK.messagingPlatform.getPlayer()];
                            case 1:
                                switch (t = a.sent(),
                                i = e.shareType || Pu.INVITE_FRIEND,
                                r = {
                                    text: i === Pu.INVITE_FRIEND ? De.services.localization.getLocalizeableContent(ce.HEAVY_OBJECT_CUSTOM_SHARE_MESSAGE) : nr(Fu || (Fu = (0,
                                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.HEAVY_OBJECT_CUSTOM_SHARE_MESSAGE),
                                    buttonText: i === Pu.INVITE_FRIEND ? De.services.localization.getLocalizeableContent(ce.HEAVY_OBJECT_CUSTOM_CTA, t.name) : nr(Mu || (Mu = (0,
                                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.HEAVY_OBJECT_CUSTOM_CTA, t.name),
                                    image: e.image
                                },
                                o = {
                                    senderID: t.id,
                                    position: e.position,
                                    areaID: e.areaID,
                                    name: e.blueprintID,
                                    type: ku.HEAVY_OBJECT,
                                    rewardToken: e.rewardToken
                                },
                                i) {
                                case Pu.SHARE_CONTENT:
                                    return [2, this._shareContent((0,
                                    n.__assign)((0,
                                    n.__assign)({}, r), {
                                        payload: o
                                    }))];
                                case Pu.INVITE_FRIEND:
                                default:
                                    return [2, this._inviteAsync((0,
                                    n.__assign)((0,
                                    n.__assign)({}, r), {
                                        data: o
                                    }))]
                                }
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.cratesForFriends = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(r) {
                            switch (r.label) {
                            case 0:
                                return [4, this._facebookSDK.messagingPlatform.getPlayer()];
                            case 1:
                                return t = r.sent(),
                                i = {
                                    text: nr(Vu || (Vu = (0,
                                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.CREATES_FOR_FRIENDS_CUSTOM_SHARE_MESSAGE),
                                    buttonText: nr(Hu || (Hu = (0,
                                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.CREATES_FOR_FRIENDS_CUSTOM_SHARE_MESSAGE, t.name),
                                    image: e.image,
                                    payload: {
                                        senderID: t.id,
                                        type: ku.CRATES_FOR_FRIENDS,
                                        rewardToken: e.rewardToken
                                    }
                                },
                                [2, this._shareContent(i)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._inviteAsync = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, this._facebookSDK.messagingPlatform.inviteAsync(e)]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._shareContent = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return [2, this._facebookSDK.messagingPlatform.shareContent(e).catch((function(e) {
                                var i = ye(e) ? JSON.stringify(e) : e;
                                t._logger.error("The custom share has not succeeded! " + i)
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
            }(),
            function() {
                function e() {}
                return e.prototype.openExternalLink = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.canUseHeavyObjectSocialShare = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, !1]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.heavyObject = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.cratesForFriends = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }()), Yu = function() {
                function e() {
                    this._friendslist = [],
                    this._logger = r.Logger.Of("DiscordFriendFetcherStrategy")
                }
                return e.prototype.fetchFriends = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return vp.platform.loginStrategy.isUserLoggedIn() ? [4, this._fetchFriends()] : [2, []];
                            case 1:
                                return e.sent(),
                                0 === this._friendslist.length && this._logger.warn("You have no friends... (in the activity)"),
                                [2, this._friendslist]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.connectToPlayer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, !0]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._fetchFriends = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, (e = vp.platform).discordSDK.commands.getInstanceConnectedParticipants()];
                            case 1:
                                return t = n.sent(),
                                0 === (i = t.participants).length ? (this._logger.warn("You have no friends... (in the activity)"),
                                [2]) : (this._friendslist = i.map((function(t) {
                                    return {
                                        platformuserid: t.id,
                                        isVisitable: !0,
                                        photoUrl: e.initializePlatform.getPlayerAvatar(t.id, t.avatar),
                                        platformDisplayName: r._getFriendDisplayName(t)
                                    }
                                }
                                )),
                                [2])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._getFriendDisplayName = function(e) {
                    return e.nickname ? e.nickname : e.username && "0" !== e.discriminator ? "".concat(e.username, "#").concat(e.discriminator) : (null == e ? void 0 : e.global_name) ? e.global_name : e.username
                }
                ,
                e
            }(), Ju = (function() {
                function e() {}
                e.prototype.fetchFriends = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, vp.platform.facebookSDK.messagingPlatform.getConnectedFriends()];
                            case 1:
                                return [2, e.sent().map((function(e) {
                                    return {
                                        platformuserid: e.id,
                                        isVisitable: !0,
                                        photoUrl: e.photo
                                    }
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.connectToPlayer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, vp.platform.facebookContext.createContext(e).then((function() {
                                return !0
                            }
                            )).catch((function(e) {
                                return e !== a.ErrorCodeType.USER_INPUT && e.code !== a.ErrorCodeType.USER_INPUT && e.message !== a.ErrorCodeType.USER_INPUT || (De.services.analytics.design.contextBeforeVisiting(tn.CANCELLED),
                                !1)
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
            }(),
            function() {
                function e() {}
                return e.prototype.fetchFriends = function() {
                    return Promise.resolve([])
                }
                ,
                e.prototype.connectToPlayer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, !0]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }()), Xu = function() {
                function e() {}
                return e.prototype.getLocale = function() {
                    return navigator.language
                }
                ,
                e
            }(), qu = (function() {
                function e() {
                    this._isLoggedIn = !1,
                    this._addedAuthListener = !1,
                    this._logger = r.Logger.Of("CrazyGamesLoginStrategy")
                }
                e.prototype.isUserLoggedIn = function() {
                    return this._isLoggedIn
                }
                ,
                e.prototype.attemptLogin = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, o = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this._checkExistingLogin()];
                            case 1:
                                if (n.sent(),
                                this._isLoggedIn)
                                    return [2, be.ALREADY_LOGGED_IN];
                                e = vp.platform,
                                n.label = 2;
                            case 2:
                                return n.trys.push([2, 4, , 5]),
                                [4, e.crazyGamesSDK.user.showAuthPrompt()];
                            case 3:
                                return n.sent(),
                                [2, be.SUCCESS];
                            case 4:
                                return t = n.sent(),
                                this._logger.error("User cancelled login", t),
                                this._addedAuthListener || (this._addedAuthListener = !0,
                                i = function(t) {
                                    o._logger.info("addAuthListener triggered"),
                                    (0,
                                    r.isUndefined)(t) || (0,
                                    r.isNull)(t) || (o._logger.info("removeAuthListener"),
                                    e.crazyGamesSDK.user.removeAuthListener(i),
                                    window.location.reload())
                                }
                                ,
                                this._logger.info("addAuthListener"),
                                e.crazyGamesSDK.user.addAuthListener(i)),
                                t.code ? (t.code,
                                [2, be.USER_CANCELLED]) : [2, be.FAILURE];
                            case 5:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._checkExistingLogin = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return i.sent(),
                                [4, (e = vp.platform).crazyGamesSDK.user.isUserAccountAvailable()];
                            case 2:
                                return i.sent() ? [4, e.crazyGamesSDK.user.getUser()] : (this._isLoggedIn = !1,
                                [2]);
                            case 3:
                                return t = i.sent(),
                                (0,
                                r.isUndefined)(t) || (0,
                                r.isNull)(t) ? this._isLoggedIn = !1 : this._isLoggedIn = !0,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(),
            "discord_access_token"), Qu = function() {
                function e() {
                    var e = this;
                    this._isUserLoggedIn = !1,
                    this._logger = r.Logger.Of("DiscordLoginStrategy"),
                    this.authenticatePromise = new Promise((function(t) {
                        return e._authenticateResolve = t
                    }
                    ))
                }
                return e.prototype.isUserLoggedIn = function() {
                    return this._isUserLoggedIn
                }
                ,
                e.prototype.getGuildName = function(e) {
                    var t, i, r;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this._getGuildMember(e)];
                            case 1:
                                return (null == (o = n.sent()) ? void 0 : o.nick) ? [2, o.nick] : (null === (t = null == o ? void 0 : o.user) || void 0 === t ? void 0 : t.username) && "0" !== (null === (i = null == o ? void 0 : o.user) || void 0 === i ? void 0 : i.discriminator) ? [2, "".concat(o.user.username, "#").concat(o.user.discriminator)] : (null === (r = null == o ? void 0 : o.user) || void 0 === r ? void 0 : r.global_name) ? [2, o.user.global_name] : [2, null]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.attemptLogin = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return n.trys.push([0, 6, , 7]),
                                [4, (e = vp.platform).discordSDK.ready()];
                            case 1:
                                return n.sent(),
                                [4, e.discordSDK.commands.authorize({
                                    client_id: "1187013846746005515",
                                    state: "",
                                    prompt: "none",
                                    scope: ["identify", "guilds.members.read", "rpc.activities.write"],
                                    response_type: "code"
                                })];
                            case 2:
                                return t = n.sent().code,
                                [4, this._getAccessTokenData(t)];
                            case 3:
                                return i = n.sent(),
                                r = i.accessToken,
                                o = i.newLogin,
                                [4, this._authenticateWithDiscord(t, r)];
                            case 4:
                                return n.sent(),
                                [4, this._setActivity()];
                            case 5:
                                return n.sent(),
                                this._authenticateResolve(),
                                this._isUserLoggedIn = !0,
                                [2, o ? be.SUCCESS : be.ALREADY_LOGGED_IN];
                            case 6:
                                return n.sent(),
                                this._authenticateResolve(),
                                localStorage.removeItem(qu),
                                [2, be.FAILURE];
                            case 7:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._setActivity = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, (e = vp.platform).discordSDK.ready()];
                            case 1:
                                return t.sent(),
                                [4, e.discordSDK.commands.setActivity({
                                    activity: {
                                        details: "Building my dream farm",
                                        type: 0,
                                        state: "Join now and let's farm together!",
                                        assets: {
                                            large_image: "embedded_cover",
                                            large_text: "Farm Merge Valley"
                                        }
                                    }
                                })];
                            case 2:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._getAccessTokenData = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = !1,
                                !(i = localStorage.getItem(qu) ? JSON.parse(localStorage.getItem(qu)) : null) || i.expiresAt < Date.now() ? (i || (t = !0),
                                [4, s.HS.getDiscordAccessToken(e, "1187013846746005515.discordsays.com/publicNakama", {
                                    host: "1187013846746005515.discordsays.com/nakama",
                                    publicHost: "1187013846746005515.discordsays.com/publicNakama",
                                    port: "",
                                    useSSL: !0,
                                    connectivity: {
                                        autoReconnect: !1
                                    }
                                }.verbose || !1, !0)]) : [3, 2];
                            case 1:
                                r = n.sent(),
                                i = {
                                    accessToken: r.access_token,
                                    expiresAt: Date.now() + r.expires_in
                                },
                                localStorage.setItem(qu, JSON.stringify(i)),
                                n.label = 2;
                            case 2:
                                return [2, {
                                    accessToken: i.accessToken,
                                    newLogin: t
                                }]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._authenticateWithDiscord = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i = this;
                        return (0,
                        n.__generator)(this, (function(r) {
                            return [2, vp.platform.discordSDK.commands.authenticate({
                                access_token: t
                            }).then((function(e) {
                                i._accessToken = t,
                                Dn.authenticationResponse = e
                            }
                            )).catch((function(t) {
                                return (0,
                                n.__awaiter)(i, void 0, void 0, (function() {
                                    var i;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        switch (n.label) {
                                        case 0:
                                            return 4009 !== t.code ? [3, 2] : (localStorage.removeItem(qu),
                                            [4, this._getAccessTokenData(e)]);
                                        case 1:
                                            return i = n.sent(),
                                            [2, this._authenticateWithDiscord(e, i.accessToken)];
                                        case 2:
                                            throw new Error("Failed to authenticate with Discord: " + t)
                                        }
                                    }
                                    ))
                                }
                                ))
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._getGuildMember = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return n.trys.push([0, 3, , 4]),
                                [4, fetch("https://discord.com/api/users/@me/guilds/".concat(e, "/member"), {
                                    method: "GET",
                                    headers: {
                                        Authorization: "Bearer ".concat(this._accessToken)
                                    }
                                })];
                            case 1:
                                if (!(t = n.sent()).ok)
                                    throw new Error("Error fetching guild member: ".concat(t.statusText));
                                return [4, t.json()];
                            case 2:
                                return [2, n.sent()];
                            case 3:
                                return i = n.sent(),
                                this._logger.error("Failed to fetch guild member", i),
                                [2, null];
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), Zu = (function() {
                function e() {
                    this._isLoggedIn = !1,
                    this._loginCheckPromise = this._checkExistingLogin()
                }
                e.prototype.isUserLoggedIn = function() {
                    return this._isLoggedIn
                }
                ,
                e.prototype.attemptLogin = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, this._loginCheckPromise];
                            case 1:
                                if (i.sent(),
                                this._isLoggedIn)
                                    return [2, be.ALREADY_LOGGED_IN];
                                e = vp.platform,
                                i.label = 2;
                            case 2:
                                return i.trys.push([2, 4, , 5]),
                                [4, e.msstart.signInAsync()];
                            case 3:
                                return i.sent(),
                                this._isLoggedIn = !0,
                                [2, be.SUCCESS];
                            case 4:
                                return (t = i.sent()).code ? (t.code,
                                [2, be.USER_CANCELLED]) : [2, be.FAILURE];
                            case 5:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._checkExistingLogin = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                t.sent(),
                                e = vp.platform,
                                t.label = 2;
                            case 2:
                                return t.trys.push([2, 4, , 5]),
                                [4, e.msstart.getSignedInUserAsync()];
                            case 3:
                                return t.sent(),
                                this._isLoggedIn = !0,
                                [3, 5];
                            case 4:
                                return t.sent(),
                                [3, 5];
                            case 5:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(),
            function() {
                function e() {}
                return e.prototype.isUserLoggedIn = function() {
                    return !0
                }
                ,
                e.prototype.attemptLogin = function() {
                    return Promise.resolve(be.SUCCESS)
                }
                ,
                e
            }()), $u = (function() {
                function e(e) {
                    this._logger = Ie.Of("CustomShare"),
                    this._facebookSDK = e
                }
                e.prototype.sendPostVisit = function(e, t) {
                    return void 0 === t && (t = a.GameUpdateStrategy.IMMEDIATE),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this._setPlayerData()];
                            case 1:
                                return n.sent(),
                                this._playerData ? this._playerData.realPlayer ? [4, this._facebookSDK.messagingPlatform.getCurrentContext()] : [2, Promise.resolve()] : [2, Promise.reject("playerData is not set in CustomUpdate module, can't send custom share.")];
                            case 2:
                                return n.sent() ? (i = this._playerData,
                                [4, De.services.lazyLoad.getLoadingPromise(hn.CUSTOM_UPDATE)]) : (this._logger.error("sendPostVisit: Not in a context when returning home"),
                                [2]);
                            case 3:
                                return n.sent(),
                                r = De.services.imageExtract.fromPixiToBase64(this._getCustomShareImage(f.CU_VISITFRIENDS_CLAIMREWARDS)),
                                [2, this._sendUpdate({
                                    text: De.services.localization.getLocalizeableContent(ce.CUSTOM_UPDATE_FRIEND_VISIT_TITLE, i.name, e.name),
                                    buttonText: De.services.localization.getLocalizeableContent(ce.CUSTOM_UPDATE_FRIEND_VISIT_CTA),
                                    image: r,
                                    strategy: t,
                                    template: "friend_visited"
                                })]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.sendInviteAcceptedCustomUpdate = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, this._setPlayerData()];
                            case 1:
                                return i.sent(),
                                this._playerData ? this._playerData.realPlayer ? [4, this._facebookSDK.messagingPlatform.getCurrentContext()] : [2, Promise.resolve()] : [2, Promise.reject("playerData is not set in CustomUpdate module, can't send custom share.")];
                            case 2:
                                return i.sent() ? (e = this._playerData,
                                [4, De.services.lazyLoad.getLoadingPromise(hn.CUSTOM_UPDATE)]) : (this._logger.error("sendInviteAcceptedCustomUpdate:: Not in a context"),
                                [2]);
                            case 3:
                                return i.sent(),
                                t = De.services.imageExtract.fromPixiToBase64(this._getCustomShareImage(f.CU_INVITATION_CLAIMREWARDS)),
                                [2, this._sendUpdate({
                                    text: De.services.localization.getLocalizeableContent(ce.INVITE_ACCEPTED_CUSTOM_MESSAGE, e.name),
                                    buttonText: De.services.localization.getLocalizeableContent(ce.VISIT_FRIENDS_SUMMARY_COLLECT_BUTTON),
                                    image: t,
                                    strategy: a.GameUpdateStrategy.IMMEDIATE,
                                    template: "friend_visited"
                                })]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._sendUpdate = function(e) {
                    return this._facebookSDK.messagingPlatform.sendGameUpdate(e)
                }
                ,
                e.prototype._getCustomShareImage = function(e) {
                    var t = De.services.resource.getSprite(e)
                      , i = t.addChild(De.services.friends.fetchOwnProfile().getPhoto());
                    return i.width = 168,
                    i.height = 168,
                    i.position.set(120, 122),
                    t
                }
                ,
                e.prototype._setPlayerData = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return void 0 !== this._playerData || (this._playerData = De.services.friends.fetchOwnProfile()),
                            [2]
                        }
                        ))
                    }
                    ))
                }
            }(),
            function() {
                function e() {}
                return e.prototype.getDevice = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, Promise.resolve("UNKNOWN")]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }()), ed = function() {
                function e() {}
                return e.prototype.getDevice = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return /Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent) || navigator.userAgent.includes("Mac") && "ontouchend"in document ? [2, "mobile"] : [2, "desktop"]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), td = (function() {
                function e() {
                    this._progress = 0,
                    this._logger = Ie.Of("FBLoader")
                }
                e.prototype.setLoadingPromise = function(e) {
                    this._loadingPromise = e
                }
                ,
                e.prototype.startInitialLoading = function() {
                    var e = this;
                    if (this._logger.debug("start loading"),
                    !this._loadingPromise)
                        throw new Error("Loading promise is not set!");
                    this._loadingPromise.then((function() {
                        e._progress = 100
                    }
                    ));
                    var t = 0
                      , i = 0
                      , n = setInterval((function() {
                        i < 100 && e._progress < 100 ? (t = 3 / (i += 1),
                        e._progress = 100 - 100 * t) : clearInterval(n)
                    }
                    ), 50)
                }
                ,
                e.prototype.getLoadingProgress = function() {
                    return this._progress
                }
            }(),
            function() {
                function e() {}
                return e.prototype.getAllPlayerData = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return (e = l("playerData")) ? [2, JSON.parse(atob(e.split("").reverse().join("")))] : [2, {}]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }()), id = function() {
                function e() {
                    this._localDataProvider = new td
                }
                return e.prototype.savePlayerData = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, this._localDataProvider.getAllPlayerData()];
                            case 1:
                                return t = i.sent(),
                                e = (0,
                                n.__assign)((0,
                                n.__assign)({}, t), e),
                                u("playerData", btoa(JSON.stringify(e)).split("").reverse().join("")),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), nd = (function() {
                function e() {
                    this._isInstalled = !1
                }
                e.prototype.isGameInstalled = function() {
                    return "cgpwa" === $msstart.getEntryPointInfo().entryPointId && (this._isInstalled = !0),
                    this._isInstalled
                }
                ,
                e.prototype.installGamePrompt = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, $msstart.promptInstallAsync()];
                            case 1:
                                e.sent(),
                                e.label = 2;
                            case 2:
                                return this._isInstalled = !0,
                                [4, r.TimeDelay.after(1e3)];
                            case 3:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
            }(),
            function() {
                function e() {}
                return e.prototype.isGameInstalled = function() {
                    return !0
                }
                ,
                e.prototype.installGamePrompt = function() {
                    return Promise.resolve()
                }
                ,
                e
            }()), rd = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i._createAvatar(t),
                    i._createDescription(t),
                    i._createButton(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._createAvatar = function(e) {
                    var t = e.playerAvatarSprite;
                    this._content.addChild(rr(t, {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: -280,
                            y: 0
                        }
                    }))
                }
                ,
                t.prototype._createDescription = function(e) {
                    var t = e.playerName
                      , i = e.description
                      , n = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 70,
                        fitWidth: 400
                    });
                    n.style = vn.darkMedium,
                    this._content.addChild(rr(new v.Label(t,n), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -30
                        }
                    })),
                    n.style = vn.greySmall,
                    this._content.addChild(rr(new v.Label(i,n), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 30
                        }
                    }))
                }
                ,
                t.prototype._createButton = function(e) {
                    var t = e.onButtonPressed;
                    this._content.addChild(new fr({
                        name: "visit",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: {
                            width: 160,
                            height: 85
                        }
                    },{
                        text: ce.VISIT,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })).position.set(280, 0),
                    this.interactive = !0,
                    this.buttonMode = !0,
                    this.on("pointerdown", t)
                }
                ,
                t
            }(Bs), od = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, vp.platform.loginStrategy.authenticatePromise];
                            case 1:
                                return e.sent(),
                                this._subscribeToDiscordEvents(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.navigation.currentSceneIndex === wr.MAIN && t._returnToMainSceneToastQueue.length > 0 && this._enteredMainScene(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._subscribeToDiscordEvents = function() {
                    var e = vp.platform;
                    e.loginStrategy.isUserLoggedIn() && e.discordSDK.subscribe("ACTIVITY_INSTANCE_PARTICIPANTS_UPDATE", this._onParticipantsUpdate.bind(this))
                }
                ,
                t.prototype._onParticipantsUpdate = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r, o, a, s, _, c;
                        return (0,
                        n.__generator)(this, (function(l) {
                            switch (l.label) {
                            case 0:
                                return i = (0,
                                n.__spreadArray)([], t._currentParticipants, !0),
                                r = [],
                                t._firstTimeParticipantsUpdateCalled ? (o = this._updateCurrentParticipants(e.participants, i, r),
                                a = o.newPlayerJoined,
                                s = o.latestJoinedParticipant,
                                this._handleLeftParticipants(i),
                                a ? [4, De.services.friends.fetchPlatformFriends()] : [3, 5]) : (t._firstTimeParticipantsUpdateCalled = !0,
                                t._currentParticipants = e.participants.map((function(e) {
                                    return e.id
                                }
                                )),
                                [2]);
                            case 1:
                                return l.sent(),
                                [4, De.services.friends.fetchProfile({
                                    platformuserid: s
                                })];
                            case 2:
                                return (_ = l.sent()) ? [4, _.getNakamaId()] : [2];
                            case 3:
                                return c = l.sent(),
                                [4, De.services.friends.fetchOwnProfile().getNakamaId()];
                            case 4:
                                if (l.sent() === c)
                                    return [2];
                                De.services.navigation.currentSceneIndex === wr.MAIN ? this._showToast(_) : t._returnToMainSceneToastQueue.includes(_) || t._returnToMainSceneToastQueue.push(_),
                                l.label = 5;
                            case 5:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._enteredMainScene = function() {
                    for (var e = 0, i = t._returnToMainSceneToastQueue; e < i.length; e++) {
                        var n = i[e];
                        this._showToast(n)
                    }
                    t._returnToMainSceneToastQueue = []
                }
                ,
                t.prototype._showToast = function(e) {
                    De.services.navigation.showToast(rd, {
                        playerAvatarSprite: e.getPhoto(),
                        playerName: e.name,
                        description: "Joined the activity",
                        onButtonPressed: this._onUserJoinedActivityPressed.bind(this, e)
                    })
                }
                ,
                t.prototype._onUserJoinedActivityPressed = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return De.services.onboardingGameService.model.isTrackCompleted(Lo.TRAIN_STATION_TRACK_1) ? ((t = this.services.gridFilter.getCellsWithBlueprint("trainstation")[0] || void 0) || this._logger.error("couldn't find the trainstation on the grid"),
                                [4, this.services.cameraService.animateCameraToCellPosition(t, 1)]) : [2];
                            case 1:
                                return i.sent(),
                                De.services.navigation.showPopup(Yl, {
                                    focusPlayer: e,
                                    incentivise: this.services.incentivise
                                }),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateCurrentParticipants = function(e, i, n) {
                    for (var r = !1, o = "", a = 0, s = e; a < s.length; a++) {
                        var _ = s[a];
                        if (i.includes(_.id)) {
                            n.push(_.id);
                            var c = i.indexOf(_.id);
                            i.splice(c, 1)
                        } else
                            n.push(_.id),
                            o = _.id,
                            r = !0
                    }
                    return t._currentParticipants = n,
                    {
                        newPlayerJoined: r,
                        latestJoinedParticipant: o
                    }
                }
                ,
                t.prototype._handleLeftParticipants = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r, o, a, s;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                i = 0,
                                r = e,
                                n.label = 1;
                            case 1:
                                return i < r.length ? (o = r[i],
                                [4, De.services.friends.fetchProfile({
                                    platformuserid: o
                                })]) : [3, 4];
                            case 2:
                                if (!(a = n.sent()))
                                    return [2];
                                (s = t._returnToMainSceneToastQueue.indexOf(a)) > -1 && t._returnToMainSceneToastQueue.splice(s, 1),
                                n.label = 3;
                            case 3:
                                return i++,
                                [3, 1];
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t._currentParticipants = [],
                t._firstTimeParticipantsUpdateCalled = !1,
                t._returnToMainSceneToastQueue = [],
                t
            }(Go), ad = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAskForHelpClicked = function(e, t, i, n) {
                    nc(this._requestFriends.bind(this, i, e.getBlueprintID(), t, String(n)))()
                }
                ,
                t.prototype.onHireHelpClicked = function(e, t) {
                    De.services.inventory.hasAmount(Cn.GEMS, t) ? (De.services.inventory.spendAmount(Cn.GEMS, t),
                    e.addBehavior(new ti({})),
                    De.services.navigation.closeAllPopups(),
                    this.createHeavyObjectAction(e, "complete")) : this.services.marketplaceService.openMarketplaceShop(Ua.GEMS)
                }
                ,
                t.prototype.createHeavyObjectAction = function(e, t) {
                    De.services.actions.emit("heavyObject.".concat(t, ".").concat(e.getBlueprintID()))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._requestFriends = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return De.services.analytics.design.heavyObjectInteraction(on.BUTTON_ASK_HELP, sn[t], r),
                                [4, De.services.token.getTokenForHeavyObject(e)];
                            case 1:
                                return o = n.sent(),
                                i ? (vp.platform.customShare.heavyObject({
                                    rewardToken: o,
                                    position: e,
                                    areaID: r,
                                    blueprintID: t,
                                    image: De.services.imageExtract.fromPixiToBase64(i)
                                }),
                                [2]) : (this._logger.error("There is no custom share image for ".concat(t)),
                                [2])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go);
            !function(e) {
                e.HeavyObject = "help_with_heavy_object",
                e.Crop = "water_crop",
                e.Animal = "pet_animal",
                e.Building = "boost_building",
                e.Nature = "hug_nature",
                e.Truck = "unload_truck"
            }(ju || (ju = {}));
            var sd, _d, cd, ld, ud, dd, hd, pd, vd, gd, fd, Ed = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i._createAvatar(t),
                    i._createDescription(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._createAvatar = function(e) {
                    var t = e.playerAvatarSprite;
                    this._content.addChild(rr(t, {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: -280,
                            y: 0
                        }
                    }))
                }
                ,
                t.prototype._createDescription = function(e) {
                    var t = e.playerName
                      , i = e.description
                      , n = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 70,
                        fitWidth: 400
                    });
                    n.style = vn.darkMedium,
                    this._content.addChild(rr(new v.Label(t,n), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -30
                        }
                    })),
                    n.style = vn.greySmall,
                    this._content.addChild(rr(new v.Label(i,n), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 30
                        }
                    }))
                }
                ,
                t
            }(Bs), md = "fakeID", yd = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._friendFarmActions = [],
                    t._actionsMap = new Map,
                    t._enabled = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.enable = function() {
                    this._enabled = !0
                }
                ,
                t.prototype.disable = function() {
                    this._enabled = !1
                }
                ,
                t.prototype.createFakeFriendFarmActions = function() {
                    var e;
                    this._friendFarmActions = [],
                    this._actionsMap.clear();
                    for (var t = this.services.gridFilter.getFilledCellsWithSomeBehaviors([Ke.Crop, Ke.Animal, Ke.Harvestable]), i = 0; i <= 5; i++) {
                        for (var n = [], o = 0; o < r.Random.int(1, De.services.visitorReward.maxActivities); o++) {
                            var a = r.ArrayUtility.getRandomItem(t);
                            n.push({
                                actiontype: ju.Crop,
                                column: a.column,
                                row: a.row,
                                id: "fakeID",
                                blueprint: (null === (e = a.content) || void 0 === e ? void 0 : e.getBlueprintID()) || "fakeID"
                            })
                        }
                        this._friendFarmActions.push({
                            actions: n,
                            friendid: "fakeID_" + i,
                            timestamp: 1e12
                        })
                    }
                    this._handleFriendFarmActions()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._enabled ? [4, this._fetchFriendFarmActions()] : [3, 2];
                            case 1:
                                e = i.sent(),
                                t = this._getHeavyObjectClaims(),
                                this._friendFarmActions = this._processActionsAndClaims(e, t),
                                this._handleFriendFarmActions(),
                                i.label = 2;
                            case 2:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._fetchFriendFarmActions = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.friends.getFriendFarmActions()];
                            case 1:
                                return [2, e.sent()]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showToast = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, De.services.friends.fetchProfile({
                                    userid: e
                                })];
                            case 1:
                                return t = i.sent(),
                                (0,
                                r.isUndefined)(t) ? (this._logger.warn("Cannot show toast. Player data for ".concat(e, " is undefined!")),
                                [2]) : (De.services.navigation.showToast(Ed, {
                                    playerAvatarSprite: t.getPhoto(),
                                    playerName: t.name,
                                    description: nr(sd || (sd = (0,
                                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.VISIT_BY_FRIEND_TOAST_DESCRIPTION)
                                }),
                                [2])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createRewardBehaviorForAction = function(e, t) {
                    var i = this.services.mapGrid.getCell(t.column, t.row);
                    if (i)
                        if (i.content) {
                            var n = []
                              , r = De.services.visitorReward.getRewardByType(t.actiontype);
                            if (r) {
                                n.unshift({
                                    friendid: e.friendid,
                                    reward: r.owner_reward,
                                    actionType: r.activityType
                                });
                                var o = new Ot({
                                    rewardData: n
                                })
                                  , a = this._actionsMap.get(e.friendid) || [];
                                a.push({
                                    cell: i,
                                    behavior: o
                                }),
                                this._actionsMap.set(e.friendid, a)
                            } else
                                this._logger.error("There is no reward for type ".concat(t.actiontype, ", probably the config was changed since your friend's visit!"))
                        } else
                            this._logger.error("There is no gameObject on ".concat(t.column, ":").concat(t.row, ", probably it was moved since the last friend's visit!"));
                    else
                        this._logger.error("There is no cell on ".concat(t.column, ":").concat(t.row, "!"))
                }
                ,
                t.prototype._getHeavyObjectClaims = function() {
                    return De.services.token.heavyObjectClaims.map((function(e) {
                        return e
                    }
                    ))
                }
                ,
                t.prototype._processActionsAndClaims = function(e, t) {
                    var i = [];
                    t.forEach((function(e) {
                        var t = e.claims
                          , r = e.cell
                          , o = e.token;
                        t.forEach((function(e) {
                            i.push((0,
                            n.__assign)({
                                token: o,
                                timestamp: 0,
                                userid: e
                            }, r))
                        }
                        ))
                    }
                    ));
                    var r = i.filter((function(t) {
                        var i = t.userid
                          , n = t.row
                          , r = t.column;
                        return e.some((function(e) {
                            return e.actions.some((function(t) {
                                return t.column === r && t.row === n && e.friendid === i
                            }
                            ))
                        }
                        ))
                    }
                    ))
                      , o = i.filter((function(e) {
                        return !r.includes(e)
                    }
                    )).map((function(e) {
                        var t = e.userid
                          , i = e.row
                          , n = e.column;
                        return {
                            friendid: t,
                            timestamp: e.timestamp,
                            actions: [{
                                column: n,
                                row: i,
                                id: md,
                                actiontype: ju.HeavyObject,
                                blueprint: "heavy_object"
                            }]
                        }
                    }
                    ));
                    return i.forEach((function(e) {
                        var t = e.userid
                          , i = e.token;
                        return De.services.token.removeUsedToken(t, i)
                    }
                    )),
                    (0,
                    n.__spreadArray)((0,
                    n.__spreadArray)([], e, !0), o, !0)
                }
                ,
                t.prototype._handleFriendFarmActions = function() {
                    var e = this
                      , t = new Map;
                    this._friendFarmActions.forEach((function(i) {
                        i.actions.forEach((function(t) {
                            return e._createRewardBehaviorForAction(i, t)
                        }
                        )),
                        e._showToast(i.friendid);
                        var n = i.actions.filter((function(e) {
                            return e.id !== md
                        }
                        ))
                          , r = t.get(i.friendid) || [];
                        r.push.apply(r, n.map((function(e) {
                            return e.id
                        }
                        ))),
                        t.set(i.friendid, r)
                    }
                    )),
                    this._divideFriendActions(),
                    t.forEach((function(e, t) {
                        0 !== e.length && De.services.friends.consumeFriendFarmActions(t, e)
                    }
                    ))
                }
                ,
                t.prototype._divideFriendActions = function() {
                    var e = this
                      , t = new Map
                      , i = {};
                    this._actionsMap.forEach((function(r, o) {
                        i[o] = i[o] || 0;
                        for (var a = 0; a < r.length; a++) {
                            var s = r[a];
                            if (s) {
                                var _ = s.cell.content;
                                if (_)
                                    if (_.hasBehavior(Ke.HeavyObject)) {
                                        var c = _.getBehavior(Ke.FriendReward);
                                        c ? _.replaceBehavior(new Ot({
                                            rewardData: (0,
                                            n.__spreadArray)((0,
                                            n.__spreadArray)([], c.rewardData, !0), s.behavior.rewardData, !0)
                                        })) : _.addBehavior(s.behavior)
                                    } else {
                                        var l = e._getOverlappingActions(s, o);
                                        0 !== l.length || (null == _ ? void 0 : _.hasBehavior(Ke.FriendReward)) ? (l.push({
                                            playerId: o,
                                            actionCellData: s
                                        }),
                                        t.set(s.cell, l)) : (_.addBehavior(s.behavior),
                                        i[o] += 1)
                                    }
                            }
                        }
                    }
                    )),
                    this._divideOverlappingActions(t, i)
                }
                ,
                t.prototype._divideOverlappingActions = function(e, t) {
                    e.forEach((function(e) {
                        for (var i, n, r = e.map((function(e) {
                            return e.playerId
                        }
                        )), o = r[0], a = 0; a < r.length; a++)
                            t[r[a]] < t[o] && (o = r[a]);
                        var s = e.find((function(e) {
                            return e.playerId === o
                        }
                        )).actionCellData;
                        (null === (i = s.cell.content) || void 0 === i ? void 0 : i.hasBehavior(Ke.FriendReward)) || (null === (n = s.cell.content) || void 0 === n || n.addBehavior(s.behavior),
                        t[o] += 1)
                    }
                    ))
                }
                ,
                t.prototype._getOverlappingActions = function(e, t) {
                    var i = [];
                    return this._actionsMap.forEach((function(n, r) {
                        if (r !== t)
                            for (var o = n, a = o.length - 1; a >= 0; a--)
                                o[a].cell === e.cell && i.push({
                                    playerId: r,
                                    actionCellData: o[a]
                                })
                    }
                    )),
                    i
                }
                ,
                t
            }(Go), Td = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._createVisuals(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onVisitButtonClick = function(e) {
                    this._inviteButton.onClick(e)
                }
                ,
                t.prototype._createVisuals = function() {
                    this._createBackground(),
                    this._createDestinationInfo(),
                    this._createVisitButton()
                }
                ,
                t.prototype._createBackground = function() {
                    var e = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE));
                    e.setSizes({
                        width: 800,
                        height: 170
                    }),
                    e.anchor.set(.5),
                    this.addChild(e)
                }
                ,
                t.prototype._createDestinationInfo = function() {
                    var e = rr(De.services.resource.getSprite(f.ICON_BTN_DISCORD), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: -this.width / 2 + 85,
                            y: 0
                        },
                        scale: {
                            x: 1.1,
                            y: 1.1
                        }
                    });
                    this.addChild(e);
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 70,
                        fitWidth: 450
                    });
                    t.style = vn.darkMedium;
                    var i = new v.Label(nr(_d || (_d = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.VISIT_INVITE_DISCORD_FRIENDS_HEADER),t);
                    i.anchor.set(0, .5),
                    i.position.set(e.x + 80, -22),
                    this.addChild(i),
                    t.style = vn.darkGreyExtraSmall;
                    var r = this.addChild(new v.Label(nr(cd || (cd = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.VISIT_INVITE_DISCORD_FRIENDS_BODY),t));
                    r.anchor.set(0, .5),
                    r.position.set(i.x, 32)
                }
                ,
                t.prototype._createVisitButton = function() {
                    this._inviteButton = this.addChild(new fr({
                        name: "incentiviseGroup",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 160,
                            height: 85
                        }
                    },{
                        text: ce.VISIT_INVITE_DISCORD_FRIENDS_BUTTON,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })),
                    this._inviteButton.position.set(300, 5)
                }
                ,
                t.prototype._createBonusIcon = function() {
                    var e = rr(De.services.resource.getSprite(f.OVERLAY_BONUS_FRIEND), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: this._inviteButton.x + this._inviteButton.width / 2,
                            y: this._inviteButton.y - this._inviteButton.height / 2
                        },
                        scale: {
                            x: .5,
                            y: .5
                        }
                    });
                    this.addChild(e);
                    var t = vn.getRegularTextStyle(vn.colorLight, 70)
                      , i = new Xe.Text("x2",t);
                    i.anchor.set(.5),
                    e.addChild(i)
                }
                ,
                t
            }(Xe.Container), Ad = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._hasPermissions = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getTrainStationIncentiviseButtons = function() {
                    return this._hasPermissions ? [this._createInviteToActivityButton()] : []
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return vp.platform.loginStrategy.isUserLoggedIn() ? [4, vp.platform.discordSDK.commands.getChannelPermissions()] : [2];
                            case 1:
                                return e = t.sent().permissions,
                                this._hasPermissions = o.Qs.can(o.Pl.CREATE_INSTANT_INVITE, e),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createInviteToActivityButton = function() {
                    var e = this
                      , t = new Td;
                    return t.onVisitButtonClick((function() {
                        De.services.navigation.closeAllPopups(),
                        e._pressedInviteButton()
                    }
                    )),
                    t
                }
                ,
                t.prototype._pressedInviteButton = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, vp.platform.discordSDK.commands.openInviteDialog()];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), Cd = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._createVisuals(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onVisitButtonClick = function(e) {
                    this._visitButton.onClick(e)
                }
                ,
                t.prototype._createVisuals = function() {
                    this._createBackground(),
                    this._createDestinationInfo(),
                    this._createVisitButton(),
                    this._createBonusIcon()
                }
                ,
                t.prototype._createBackground = function() {
                    var e = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE));
                    e.setSizes({
                        width: 800,
                        height: 170
                    }),
                    e.anchor.set(.5),
                    this.addChild(e)
                }
                ,
                t.prototype._createDestinationInfo = function() {
                    var e = rr(De.services.resource.getSprite(f.ICON_BTN_FACEBOOK), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: -this.width / 2 + 85,
                            y: 0
                        },
                        scale: {
                            x: 1.1,
                            y: 1.1
                        }
                    });
                    this.addChild(e);
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 70,
                        fitWidth: 450
                    });
                    t.style = vn.darkMedium;
                    var i = new v.Label(nr(ld || (ld = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TRAINSTATION_INCENTIVISE_GROUP_HEADER),t);
                    i.anchor.set(0, .5),
                    i.position.set(e.x + 80, -22),
                    this.addChild(i),
                    t.style = vn.darkGreyExtraSmall;
                    var r = this.addChild(new v.Label(nr(ud || (ud = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TRAINSTATION_INCENTIVISE_GROUP_SUBTEXT),t));
                    r.anchor.set(0, .5),
                    r.position.set(i.x, 32)
                }
                ,
                t.prototype._createVisitButton = function() {
                    this._visitButton = this.addChild(new fr({
                        name: "incentiviseGroup",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 160,
                            height: 85
                        }
                    },{
                        text: ce.TRAINSTATION_INCENTIVISE_GROUP_BUTTON,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })),
                    this._visitButton.position.set(300, 5)
                }
                ,
                t.prototype._createBonusIcon = function() {
                    var e = rr(De.services.resource.getSprite(f.OVERLAY_BONUS_FRIEND), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: this._visitButton.x + this._visitButton.width / 2,
                            y: this._visitButton.y - this._visitButton.height / 2
                        },
                        scale: {
                            x: .5,
                            y: .5
                        }
                    });
                    this.addChild(e);
                    var t = vn.getRegularTextStyle(vn.colorLight, 70)
                      , i = new Xe.Text("x2",t);
                    i.anchor.set(.5),
                    e.addChild(i)
                }
                ,
                t
            }(Xe.Container), Id = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "IncentiviseModel",
                    t._version = 0,
                    t._lastPressedMailboxVersion = "0.0.0",
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "lastPressedMailboxVersion", {
                    get: function() {
                        return this._lastPressedMailboxVersion
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.pressedMailbox = function() {
                    this._lastPressedMailboxVersion = "1.46.0-1",
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._lastPressedMailboxVersion = e.lastPressedMailboxVersion
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        lastPressedMailboxVersion: this._lastPressedMailboxVersion
                    }
                }
                ,
                t
            }($n), Sd = (function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._model = new Id,
                    t._openingPage = !1,
                    t._openingGroup = !1,
                    t
                }
                (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isFollowPageApiCallSupperted", {
                    get: function() {
                        return this._isFollowPageApiCallSupported
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isFollowOfficialGroupApiCallSupported", {
                    get: function() {
                        return this._isFollowOfficialGroupApiCallSupported
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.hasPressedMailboxThisVersion = function() {
                    var e = this._model.lastPressedMailboxVersion.split(".")[0]
                      , t = this._model.lastPressedMailboxVersion.split(".")[1]
                      , i = "1.46.0-1".split(".")[0]
                      , n = "1.46.0-1".split(".")[1];
                    return !(e < i || e === i && t < n)
                }
                ,
                t.prototype.getTrainStationIncentiviseButtons = function() {
                    return [this._createVisitGroupButton()]
                }
                ,
                t.prototype.pressedMailbox = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                if (this._openingPage)
                                    return [2];
                                this._openingPage = !0,
                                this._model.pressedMailbox(),
                                De.services.analytics.design.reportMailboxPressed(),
                                t.label = 1;
                            case 1:
                                return t.trys.push([1, 3, , 4]),
                                [4, vp.platform.facebookSDK.community.followOfficialPageAsync()];
                            case 2:
                                return t.sent(),
                                De.services.analytics.design.reportFollowedPageResult("resolved"),
                                [3, 4];
                            case 3:
                                return e = t.sent(),
                                this._logger.error(e),
                                De.services.analytics.design.reportFollowedPageResult("error"),
                                [3, 4];
                            case 4:
                                return [4, r.TimeDelay.after(500).promise];
                            case 5:
                                return t.sent(),
                                this._openingPage = !1,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.pressedOfficialGroupFacebookButton = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                if (this._openingGroup)
                                    return [2];
                                this._openingGroup = !0,
                                De.services.analytics.design.reportFindNeighboursButtonPressed(),
                                t.label = 1;
                            case 1:
                                return t.trys.push([1, 3, , 4]),
                                [4, vp.platform.facebookSDK.community.joinOfficialGroupAsync()];
                            case 2:
                                return t.sent(),
                                De.services.analytics.design.reportFollowOfficialGroupAyncResult("succes"),
                                [3, 4];
                            case 3:
                                return e = t.sent(),
                                this._logger.error(e),
                                De.services.analytics.design.reportFollowOfficialGroupAyncResult("error"),
                                [3, 4];
                            case 4:
                                return [4, r.TimeDelay.after(500).promise];
                            case 5:
                                return t.sent(),
                                this._openingGroup = !1,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return De.services.autosave.registerModel(this._model),
                                e = this,
                                [4, vp.platform.facebookSDK.community.canFollowOfficialPageAsync()];
                            case 1:
                                return e._isFollowPageApiCallSupported = i.sent(),
                                t = this,
                                [4, vp.platform.facebookSDK.community.canJoinOfficialGroupAsync()];
                            case 2:
                                return t._isFollowOfficialGroupApiCallSupported = i.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    this.isFollowPageApiCallSupperted || this.services.hudService.hideHudElement(Ns.MailboxButtonUI, !0),
                    this.isFollowOfficialGroupApiCallSupported || this.services.hudService.hideHudElement(Ns.FacebookButtonUI, !0)
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createVisitGroupButton = function() {
                    var e = this
                      , t = new Cd;
                    return t.onVisitButtonClick((function() {
                        De.services.navigation.closeAllPopups(),
                        e.pressedOfficialGroupFacebookButton()
                    }
                    )),
                    De.services.analytics.design.reportFindNeighboursButtonShown(),
                    t
                }
            }(Go),
            function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "ShortcutBonusPopup",
                    i._logger = r.Logger.Of("ShortcutBonusPopup"),
                    i._notification = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    i._options = {
                        popupHeader: ce.SHORTCUT_BONUS_INCENTIVE_HEADER,
                        infoImage: f.ICON_FREEBIE_OFFERS,
                        infoText: ce.SHORTCUT_BONUS_INCENTIVE_BODY
                    },
                    i.onClosed.listenOnce((function() {
                        return i._service.incentivePopupClosed()
                    }
                    ), i),
                    i._service = t.service,
                    i._rewards = t.productData.reward,
                    i._createBackground(),
                    i._createHeader(),
                    i._createInfo(),
                    i._createBonusVisual(),
                    i._createInstallShortcutButton(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype._createBackground = function() {
                    var e = this
                      , t = this._getBackgroundSize();
                    this._backGround = new Ar({
                        size: t,
                        headerSize: {
                            width: t.width / 1.5,
                            height: 75
                        },
                        headerStyle: vn.popupTitle,
                        showCloseButton: !0
                    }),
                    this._backGround.onCloseClick((function() {
                        e.close()
                    }
                    )),
                    this._content.addChild(this._backGround)
                }
                ,
                t.prototype._createHeader = function() {
                    var e = or({
                        labelText: nr(dd || (dd = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), this._options.popupHeader),
                        spriteModifiers: {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: 0,
                                y: -this._getBackgroundSize().height / 2 + 37.5 + 10
                            }
                        },
                        labelSettings: {
                            fitToBox: !1,
                            style: vn.lightBoldMedium
                        }
                    });
                    this._content.addChild(e)
                }
                ,
                t.prototype._getBackgroundSize = function() {
                    var e = De.services.resource.getSprite(this._options.infoImage).width + 40
                      , t = De.services.resource.getSprite(this._options.infoImage).height + 75 + 100;
                    return {
                        width: Math.max(e, 1100),
                        height: Math.max(t, 850)
                    }
                }
                ,
                t.prototype._createInfo = function() {
                    var e = -this._getBackgroundSize().height / 2 + 75
                      , t = rr(De.services.resource.getSprite(this._options.infoImage), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: e + 130
                        }
                    })
                      , i = or({
                        labelText: nr(hd || (hd = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), this._options.infoText),
                        labelSettings: {
                            fitToBox: !0,
                            fitHeight: 75,
                            fitWidth: this._getBackgroundSize().width - 40,
                            style: vn.darkMedium
                        },
                        spriteModifiers: {
                            anchor: {
                                x: .5,
                                y: 0
                            },
                            position: {
                                x: 0,
                                y: e + 40
                            }
                        }
                    });
                    this._content.addChild(t, i)
                }
                ,
                t.prototype._createBonusVisual = function() {
                    var e = De.services.resource.getSprite(f.ICON_FREEBIE_OFFERS).width
                      , t = De.services.resource.getSprite(f.ICON_FREEBIE_OFFERS).height
                      , i = new Xe.Container;
                    i.position.set(0, -this._getBackgroundSize().height / 2 + 150 + t + 5);
                    for (var n = 1; n <= 3; n++) {
                        var r = 10 * (2 - n)
                          , o = or({
                            labelText: this._rewards[n - 1].amount.toString(),
                            labelSettings: {
                                fitHeight: 135,
                                fitWidth: 300,
                                fitToBox: !0,
                                style: vn.darkMedium
                            },
                            spriteModifiers: {
                                anchor: {
                                    x: .5,
                                    y: .5
                                },
                                position: {
                                    x: -e / 3 + (n - 1) * e / 3 - r,
                                    y: 0
                                }
                            }
                        });
                        i.addChild(o)
                    }
                    this._content.addChild(i)
                }
                ,
                t.prototype._createInstallShortcutButton = function() {
                    var e = this
                      , t = new fr({
                        name: "Add Shortcut",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: {
                            width: 450,
                            height: 90
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: ce.SHORTCUT_BONUS_INCENTIVE_BUTTON,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    t.position.set(0, this._getBackgroundSize().height / 2 - 90 - 25),
                    t.onClick((function() {
                        return e._onButtonClicked()
                    }
                    )),
                    this._content.addChild(t)
                }
                ,
                t.prototype._createNotificationIcon = function(e) {
                    var t = e.x
                      , i = void 0 === t ? 0 : t
                      , n = e.y
                      , r = void 0 === n ? 0 : n
                      , o = e.visible
                      , a = void 0 !== o && o
                      , s = e.parent;
                    this._notification.position.set(i, r),
                    this._notification.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                    this._notification.visible = a,
                    s.addChild(this._notification)
                }
                ,
                t.prototype._onButtonClicked = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._service.shortcutButtonClicked(),
                            this.onClosed.listenOnce((function() {
                                e._service.installButtonClicked()
                            }
                            ), this),
                            this.close(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr)), Od = 75, bd = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "ShortcutBonusRewardsPopup",
                    i._logger = r.Logger.Of("ShortcutBonusRewardsPopup"),
                    i._itemPositions = new Map,
                    i._options = {
                        popupHeader: ce.SHORTCUT_BONUS_SUCCESSFUL_HEADER,
                        infoImage: f.ICON_FREEBIE_OFFERS,
                        infoText: ce.SHORTCUT_BONUS_SUCCESSFUL_BODY
                    },
                    i._productData = t.productData,
                    i._service = t.service,
                    i.onClosed.listenOnce((function() {
                        i._service.shortcutRewardsPopupClosed()
                    }
                    ), i),
                    i._createBackground(),
                    i._createHeader(),
                    i._createGiftVisual(),
                    i._createInfo(),
                    i._createRewardsVisual(),
                    i._createColllectRewardsButton(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1
                }
                ,
                t.prototype.close = function() {
                    return this._animateRewards(),
                    e.prototype.close.call(this)
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype._createBackground = function() {
                    var e = this
                      , t = this._getBackgroundSize();
                    this._backGround = new Ar({
                        size: t,
                        headerSize: {
                            width: t.width / 1.5,
                            height: Od
                        },
                        headerStyle: vn.popupTitle,
                        showCloseButton: !0
                    }),
                    this._content.addChild(this._backGround),
                    this._backGround.onCloseClick((function() {
                        return e.close()
                    }
                    ))
                }
                ,
                t.prototype._getBackgroundSize = function() {
                    var e = De.services.resource.getSprite(this._options.infoImage).width + 100
                      , t = this._getRewardsVisualHeight() + Od + 440 + 190;
                    return {
                        width: Math.max(e, 1e3),
                        height: Math.max(t, 1e3)
                    }
                }
                ,
                t.prototype._createHeader = function() {
                    var e = or({
                        labelText: nr(pd || (pd = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), this._options.popupHeader),
                        labelSettings: {
                            fitToBox: !1,
                            style: vn.lightBoldMedium
                        },
                        spriteModifiers: {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: 0,
                                y: -this._getBackgroundSize().height / 2 + 37.5 + 10
                            }
                        }
                    });
                    this._content.addChild(e)
                }
                ,
                t.prototype._createGiftVisual = function() {
                    this._content.addChild(rr(De.services.resource.getSprite(f.ICON_REWARDSHORTCUT_GIFT), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -this._getBackgroundSize().height / 2 + Od + 220 - 20
                        }
                    }))
                }
                ,
                t.prototype._createInfo = function() {
                    var e = or({
                        labelText: nr(vd || (vd = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), this._options.infoText),
                        labelSettings: {
                            fitToBox: !0,
                            fitHeight: 75,
                            fitWidth: this._getBackgroundSize().width - 100,
                            style: vn.darkLarge
                        },
                        spriteModifiers: {
                            anchor: {
                                x: .5,
                                y: 0
                            },
                            position: {
                                x: 0,
                                y: -this._getBackgroundSize().height / 2 + Od + 440 - 80
                            }
                        }
                    });
                    this._content.addChild(e)
                }
                ,
                t.prototype._getRewardsVisualHeight = function() {
                    return De.services.resource.getSprite(f.ICON_FREEBIE_OFFERS).height + Od
                }
                ,
                t.prototype._createRewardsVisual = function() {
                    var e = new Xe.Container;
                    e.position.set(0, -this._getBackgroundSize().height / 2 + Od + 440);
                    var t = De.services.resource.getSprite(f.ICON_FREEBIE_OFFERS).width
                      , i = this._getRewardsVisualHeight()
                      , r = or({
                        labelText: nr(gd || (gd = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.SHORTCUT_BONUS_SUCCESSFUL_REWARDS),
                        labelSettings: {
                            fitToBox: !0,
                            fitHeight: 60,
                            fitWidth: this._getBackgroundSize().width - 100,
                            style: vn.greyMedium
                        },
                        spriteModifiers: {
                            anchor: {
                                x: .5,
                                y: 0
                            },
                            position: {
                                x: 0,
                                y: 0
                            }
                        }
                    });
                    e.addChild(r),
                    e.addChild(rr(De.services.resource.getSprite(this._options.infoImage), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: 90
                        }
                    }));
                    for (var o = 1; o <= 3; o++) {
                        var a = 10 * (2 - o)
                          , s = or({
                            labelText: this._productData.reward[o - 1].amount.toString(),
                            labelSettings: {
                                fitHeight: 135,
                                fitWidth: 300,
                                fitToBox: !0,
                                style: vn.darkMedium
                            },
                            spriteModifiers: {
                                anchor: {
                                    x: .5,
                                    y: .5
                                },
                                position: {
                                    x: -t / 3 + (o - 1) * t / 3 - a,
                                    y: i - 35
                                }
                            }
                        });
                        this._itemPositions.set(this._productData.reward[o - 1].key, s.position),
                        e.addChild(s)
                    }
                    this._content.addChild(e)
                }
                ,
                t.prototype._createColllectRewardsButton = function() {
                    var e = this
                      , t = new fr({
                        name: "collect rewards",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: {
                            width: 460,
                            height: 90
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: ce.SHORTCUT_BONUS_SUCCESSFUL_BUTTON,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    t.position.set(0, this._getBackgroundSize().height / 2 - 90),
                    t.onClick((function() {
                        return e.close()
                    }
                    )),
                    this._content.addChild(t)
                }
                ,
                t.prototype._animateRewards = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._productData.reward.forEach((function(t) {
                                return (0,
                                n.__awaiter)(e, void 0, void 0, (function() {
                                    var e, i, r, o, a, s, _;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        return e = this._itemPositions.get(t.key),
                                        i = De.services.navigation.layers.popup.container,
                                        r = i.toGlobal(e ? {
                                            x: e.x,
                                            y: e.y - 200
                                        } : new Xe.Point(0,0)),
                                        o = De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter({
                                            amount: t.amount,
                                            key: t.key
                                        }),
                                        a = o.target,
                                        s = o.icon,
                                        _ = a.toGlobal(new Xe.Point(0,0)),
                                        new Lr(De.services.resource.getSprite(s),i.toLocal(r),i.toLocal(_),t.amount,i).animate(),
                                        [2]
                                    }
                                    ))
                                }
                                ))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr);
            !function(e) {
                e.NOT_RECEIVED = "not_received",
                e.RECEIVED = "received"
            }(fd || (fd = {}));
            var Rd = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._state = fd.NOT_RECEIVED,
                    t._name = "ShortcutBonusModel",
                    t._version = 1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "receivedBonus", {
                    get: function() {
                        return this._state === fd.RECEIVED
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.claimBonus = function() {
                    var e = this;
                    return new Promise((function(t) {
                        e.onSavableDataChange.listenOnce((function(e) {
                            return t()
                        }
                        ), e),
                        e._state = fd.RECEIVED,
                        e.saveData()
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._state = e.state
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        state: this._state
                    }
                }
                ,
                t
            }($n);
            function wd() {
                return {
                    friendReward: new yd,
                    discordEventService: new od,
                    heavyObjectService: new ad,
                    incentivise: new Ad
                }
            }
            !function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onClaimed = new r.Event,
                    t._model = new Rd,
                    t
                }
                (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "bonusAvailable", {
                    get: function() {
                        return vp.platform.installShortcutStrategy.isGameInstalled()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.SPECIAL_OFFER)];
                            case 1:
                                return t.sent(),
                                [4, De.services.autosave.registerModel(this._model)];
                            case 2:
                                return t.sent(),
                                this._currentShortcutBonusData = this._getShortcutBonusData(),
                                r.TimeDelay.after(1e3).promise.then((function() {
                                    e.openShortcutBonusRewardsPopup()
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openShortcutBonusPopup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.SPECIAL_OFFER)];
                            case 1:
                                return t.sent(),
                                De.services.navigation.showPopup(Sd, {
                                    service: this,
                                    productData: this._currentShortcutBonusData
                                }),
                                De.services.analytics.design.reportIncentivePopupOpened("shortcut", e),
                                [2, !0]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openShortcutBonusRewardsPopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this.canReceiveBonus() && this.bonusAvailable ? [4, De.services.lazyLoad.prioritizeGroup(hn.SPECIAL_OFFER)] : [3, 2];
                            case 1:
                                e.sent(),
                                De.services.navigation.showPopup(bd, {
                                    service: this,
                                    productData: this._currentShortcutBonusData
                                }),
                                e.label = 2;
                            case 2:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.incentivePopupClosed = function() {
                    De.services.analytics.design.reportIncentivePopupClosed("shortcut")
                }
                ,
                t.prototype.shortcutRewardsPopupClosed = function() {
                    this._claimBonus()
                }
                ,
                t.prototype.shortcutButtonClicked = function() {
                    De.services.analytics.design.reportShortcutButtonPressed()
                }
                ,
                t.prototype.canReceiveBonus = function() {
                    return !this._model.receivedBonus
                }
                ,
                t.prototype.installButtonClicked = function() {
                    var e = this;
                    vp.platform.installShortcutStrategy.installGamePrompt().then((function() {
                        e.openShortcutBonusRewardsPopup()
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return Promise.resolve()
                }
                ,
                t.prototype._claimBonus = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this.canReceiveBonus() ? [4, this._model.claimBonus()] : [2];
                            case 1:
                                return e.sent(),
                                this.onClaimed.fire(),
                                this._currentShortcutBonusData.reward.forEach((function(e) {
                                    return De.services.inventory.addAmount(e.key, e.amount)
                                }
                                )),
                                [4, De.services.autosave.forceSave()];
                            case 2:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getShortcutBonusData = function() {
                    return {
                        reward: [{
                            key: Cn.GEMS,
                            amount: 45
                        }, {
                            key: Cn.CRATES,
                            amount: 15
                        }, {
                            key: Cn.ENERGY,
                            amount: 15
                        }]
                    }
                }
            }(Go);
            var Dd, Nd, Ld, Bd, Pd = function() {
                function e() {
                    this._logger = Ie.Of("BaseSystem"),
                    this._isActive = !1,
                    this._families = []
                }
                return e.prototype.initialize = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._worldService = t,
                                this._services = e,
                                this._isActive = !0,
                                [4, this.onInitialize()];
                            case 1:
                                return i.sent(),
                                [2, Promise.resolve()]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.onDestroy()];
                            case 1:
                                return e.sent(),
                                this._families.forEach((function(e) {
                                    return e.destroy()
                                }
                                )),
                                this._families.length = 0,
                                this._isActive = !1,
                                [2, Promise.resolve()]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.activate = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._isActive = !0,
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.dectivate = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._isActive = !1,
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                Object.defineProperty(e.prototype, "isActive", {
                    get: function() {
                        return this._isActive
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "services", {
                    get: function() {
                        return this._services
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.addFamily = function(e, t, i, n) {
                    var r = this;
                    void 0 === n && (n = !1);
                    var o = this._worldService;
                    if (!o)
                        throw new Error("Family cannot be created as there is no worldGrid service provided!");
                    var a = new __(o,new c_(e),n);
                    return i && a.onGameObjectRemoved.addListener(this._onFamilyEventCallback(i), this),
                    t && (a.onGameObjectAdded.addListener(this._onFamilyEventCallback(t), this),
                    this.isActive && a.forEach((function(e) {
                        return t.call(r, e)
                    }
                    ))),
                    this._families.push(a),
                    a
                }
                ,
                e.prototype._onFamilyEventCallback = function(e) {
                    var t = this;
                    return function() {
                        for (var i = [], n = 0; n < arguments.length; n++)
                            i[n] = arguments[n];
                        t._isActive && e.apply(t, i)
                    }
                }
                ,
                e
            }(), kd = [{
                name: "popout_hover",
                duration: 4.5,
                repeat: -1,
                keyframes: {
                    ballon: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            position: {
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .3333,
                        event: "hover_bottom",
                        ease: "sine.inOut",
                        params: {
                            position: {
                                y: "-=25"
                            }
                        }
                    }, {
                        time: .33,
                        duration: .6666,
                        event: "hover_top",
                        ease: "sine.inOut",
                        params: {
                            position: {
                                y: "+=25"
                            }
                        }
                    }]
                }
            }, {
                name: "popout_click",
                duration: .2,
                repeat: 0,
                keyframes: {
                    ballon: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: 0,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1.2,
                                y: 1.2
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }]
                }
            }, {
                name: "popout_hide",
                duration: .5,
                repeat: 0,
                keyframes: {
                    ballon: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 1,
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "back.in",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }]
                }
            }, {
                name: "popout_show",
                duration: .5,
                repeat: 0,
                keyframes: {
                    ballon: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "back.out",
                        params: {
                            alpha: 1,
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }]
                }
            }];
            !function(e) {
                e[e.VISIBLE = 0] = "VISIBLE",
                e[e.HIDDEN = 1] = "HIDDEN"
            }(Dd || (Dd = {})),
            function(e) {
                e[e.NONE = 0] = "NONE",
                e[e.OPEN = 1] = "OPEN",
                e[e.CLOSE = 2] = "CLOSE"
            }(Nd || (Nd = {})),
            function(e) {
                e[e.IDLE = 0] = "IDLE",
                e[e.ANIMATION = 1] = "ANIMATION"
            }(Ld || (Ld = {})),
            function(e) {
                e[e.FULL = 0] = "FULL",
                e[e.CLOSED_ONLY = 1] = "CLOSED_ONLY",
                e[e.OPEN_ONLY = 2] = "OPEN_ONLY"
            }(Bd || (Bd = {}));
            var xd, Gd = function(e) {
                function t(t) {
                    var i, n, o, a, s, _, c, l, u, d, h = this;
                    return (h = e.call(this) || this).onCloseComplete = new r.Event,
                    h.onOpenComplete = new r.Event,
                    h.onShow = new r.Event,
                    h.onHide = new r.Event,
                    h.onClick = new r.Event,
                    h._id = "NO_ID",
                    h._top = 0,
                    h._bottom = 0,
                    h._left = 0,
                    h._right = 0,
                    h._closeContainer = new Xe.Container,
                    h._openContainer = new Xe.Container,
                    h._idleAnimation = null,
                    h._spawnAnimation = null,
                    h._popoutType = Bd.FULL,
                    h._isPressed = !1,
                    h._state = Nd.NONE,
                    h._persistentHiding = !1,
                    h._visualState = Dd.HIDDEN,
                    h._animationState = Ld.IDLE,
                    h._defaultOptions = {
                        retractionWidth: 118,
                        retractionHeight: 118,
                        expansionWidth: 400,
                        expansionHeight: 500,
                        canHide: !0,
                        basePopoutType: Bd.FULL,
                        hasIdleAnimation: !0,
                        hasSpawnAnimation: !0,
                        backgroundNineSliceSettings: {
                            asset: f.POPOUT_BALLOON_9SLICE,
                            bottomHeight: 100,
                            leftWidth: 100,
                            rightWidth: 100,
                            topHeight: 100
                        },
                        backgroundTailSettings: {
                            asset: f.POPOUT_BALLOON_TAIL,
                            widthIncrease: 10,
                            yPosition: -15
                        }
                    },
                    h._DURATION_ANIMATION_OPEN = .2,
                    h._DURATION_ANIMATION_CLOSE = .2,
                    h._retractionWidth = null !== (i = t.retractionWidth) && void 0 !== i ? i : h._defaultOptions.retractionWidth,
                    h._retractionHeight = null !== (n = t.retractionHeight) && void 0 !== n ? n : h._defaultOptions.retractionHeight,
                    h._expansionWidth = null !== (o = t.expansionWidth) && void 0 !== o ? o : h._defaultOptions.expansionWidth,
                    h._expansionHeight = null !== (a = t.expansionHeight) && void 0 !== a ? a : h._defaultOptions.expansionHeight,
                    h._canHide = null !== (s = t.canHide) && void 0 !== s ? s : h._defaultOptions.canHide,
                    h._popoutType = null !== (_ = t.basePopoutType) && void 0 !== _ ? _ : h._defaultOptions.basePopoutType,
                    h._hasIdleAnimation = null !== (c = t.hasIdleAnimation) && void 0 !== c ? c : h._defaultOptions.hasIdleAnimation,
                    h._hasSpawnAnimation = null !== (l = t.hasSpawnAnimation) && void 0 !== l ? l : h._defaultOptions.hasSpawnAnimation,
                    h._backgroundNineSliceSettings = null !== (u = t.backgroundNineSliceSettings) && void 0 !== u ? u : h._defaultOptions.backgroundNineSliceSettings,
                    h._backgroundTailSettings = null !== (d = t.backgroundTailSettings) && void 0 !== d ? d : h._defaultOptions.backgroundTailSettings,
                    h._resourcesService = De.services.resource,
                    h._popoutFrame = new Xe.Container,
                    h._popoutFrame.visible = h._visualState === Dd.VISIBLE,
                    h._background = h._createBackground(h._retractionWidth, h._retractionHeight),
                    h._backgroundTail = h._createBackgroundTail(),
                    h._popoutType !== Bd.CLOSED_ONLY && (h._expansionBackground = h._createExpansionBackground(h._expansionWidth, h._expansionHeight)),
                    h._popoutFrame.position.y = -h._backgroundTail.height,
                    h._popoutFrame.addChild(h._background),
                    h._popoutFrame.addChild(h._backgroundTail),
                    h._popoutFrame.addChild(h._expansionBackground ? h._expansionBackground : new Xe.Container),
                    h._popoutFrame.addChild(h._closeContainer),
                    h._popoutFrame.addChild(h._openContainer),
                    h.addChild(h._popoutFrame),
                    h._hasIdleAnimation && (h._idleAnimation = new ur(kd),
                    h._idleAnimation.setTargets({
                        ballon: h._popoutFrame
                    }),
                    h._idleAnimation.play("popout_hover")),
                    h._hasSpawnAnimation && (h._spawnAnimation = new ur(kd),
                    h._spawnAnimation.setTargets({
                        ballon: h._popoutFrame
                    }),
                    h._spawnAnimation.onEnd.addListener((function(e) {
                        "popout_show" === e ? (h._animationState = Ld.IDLE,
                        h.onShow.fire()) : "popout_hide" === e && (h._animationState = Ld.IDLE,
                        h.onHide.fire())
                    }
                    ), h)),
                    h._animationOpen = h._createPopoutAnimation(h._background, h._expansionWidth, h._expansionHeight, h._DURATION_ANIMATION_OPEN, (function() {
                        return h.onOpenComplete.fire()
                    }
                    )),
                    h._animationClose = h._createPopoutAnimation(h._background, h._retractionWidth, h._retractionHeight, h._DURATION_ANIMATION_CLOSE, (function() {
                        return h.onCloseComplete.fire()
                    }
                    )),
                    h.onOpenComplete.addListener(h._onOpenAnimationComplete, h),
                    h.onCloseComplete.addListener(h._onCloseAnimationComplete, h),
                    h._background.interactive = !0,
                    h._background.on("pointerdown", h._onPointerDown, h),
                    h._background.on("pointerup", h._onPointerUp, h),
                    h._background.on("pointerupoutside", (function() {
                        h._isPressed = !1
                    }
                    )),
                    h.close(!1),
                    h
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isOpen", {
                    get: function() {
                        return this._state === Nd.OPEN
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isVisible", {
                    get: function() {
                        return this._visualState === Dd.VISIBLE
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "BasePopoutType", {
                    get: function() {
                        return this._popoutType
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "id", {
                    get: function() {
                        return this._id
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.open = function(e) {
                    return void 0 === e && (e = !0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._state === Nd.OPEN || this._animationState === Ld.ANIMATION ? [2] : this._popoutType === Bd.CLOSED_ONLY ? (this.close(e),
                            [2]) : (this._closeContainer.visible = !1,
                            e ? (this._animationClose.invalidate(),
                            this._playAnimation(this._animationOpen),
                            [2]) : (this._background.width = this._expansionWidth,
                            this._background.height = this._expansionHeight,
                            this._onAnimationUpdate(this._background),
                            this._setupOpenState(),
                            [2]))
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.close = function(e) {
                    return void 0 === e && (e = !0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._state === Nd.CLOSE || this._animationState === Ld.ANIMATION ? [2] : this._popoutType === Bd.OPEN_ONLY ? (this.open(e),
                            [2]) : (this._openContainer.visible = !1,
                            this._expansionBackground && (this._expansionBackground.visible = !1),
                            e ? (this._animationOpen.invalidate(),
                            this._playAnimation(this._animationClose),
                            [2]) : (this._background.width = this._retractionWidth,
                            this._background.height = this._retractionHeight,
                            this._onAnimationUpdate(this._background),
                            this._setupCloseState(),
                            [2]))
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.show = function(e, t) {
                    var i;
                    if (void 0 === e && (e = !0),
                    void 0 === t && (t = 0),
                    this._visualState !== Dd.VISIBLE && this._animationState !== Ld.ANIMATION) {
                        if (this._visualState = Dd.VISIBLE,
                        this._animationState = Ld.ANIMATION,
                        this._popoutFrame.visible = !0,
                        this.onShow.fire(),
                        !e)
                            return this._popoutFrame.alpha = 1,
                            void (this._animationState = Ld.IDLE);
                        this._popoutFrame.alpha = 0,
                        null === (i = this._spawnAnimation) || void 0 === i || i.play("popout_show", t)
                    }
                }
                ,
                t.prototype.hide = function(e, t) {
                    var i, n, r = this;
                    if (void 0 === e && (e = !0),
                    void 0 === t && (t = !1),
                    this._canHide)
                        if (this._visualState !== Dd.HIDDEN && this._animationState !== Ld.ANIMATION) {
                            if (this._visualState = Dd.HIDDEN,
                            this._animationState = Ld.ANIMATION,
                            this.onHide.fire(),
                            !e)
                                return this._popoutFrame.alpha = 0,
                                this._popoutFrame.visible = !1,
                                void (this._animationState = Ld.IDLE);
                            t && (null === (i = this._spawnAnimation) || void 0 === i || i.onEnd.listenOnce((function() {
                                r.destroy()
                            }
                            ), this),
                            e || this.destroy()),
                            null === (n = this._spawnAnimation) || void 0 === n || n.play("popout_hide")
                        } else
                            t && !this._persistentHiding && (this._persistentHiding = !0,
                            this.onShow.listenOnce((function() {
                                r.hide(!0, !0)
                            }
                            ), this))
                }
                ,
                t.prototype.destroy = function(t) {
                    var i;
                    this.onOpenComplete.removeAllListeners(),
                    this.onCloseComplete.removeAllListeners(),
                    this.onHide.removeAllListeners(),
                    this.onShow.removeAllListeners(),
                    this.onClick.removeAllListeners(),
                    null === (i = this._idleAnimation) || void 0 === i || i.dispose(),
                    e.prototype.destroy.call(this, t)
                }
                ,
                t.prototype._onPointerDown = function(e) {
                    e.stopPropagation(),
                    this._isPressed = !0
                }
                ,
                t.prototype._onPointerUp = function() {
                    var e;
                    this._isPressed && (this.open(),
                    null === (e = this._idleAnimation) || void 0 === e || e.restart("popout_click"),
                    this.onClick.fire()),
                    this._isPressed = !1
                }
                ,
                t.prototype._playAnimation = function(e) {
                    this._animationState = Ld.ANIMATION,
                    e.restart()
                }
                ,
                t.prototype._createBackground = function(e, t) {
                    var i = new Xe.NineSlicePlane(this._resourcesService.getTexture(this._backgroundNineSliceSettings.asset),this._backgroundNineSliceSettings.leftWidth,this._backgroundNineSliceSettings.topHeight,this._backgroundNineSliceSettings.rightWidth,this._backgroundNineSliceSettings.bottomHeight);
                    return i.width = e,
                    i.height = t,
                    i.pivot.set(.5 * e, t),
                    i
                }
                ,
                t.prototype._createExpansionBackground = function(e, t) {
                    var i = new Xe.NineSlicePlane(this._resourcesService.getTexture(f.POPUP_9SLICE),10,100,10,15);
                    return i.width = e,
                    i.height = t,
                    i.pivot.set(.5 * e, t),
                    i
                }
                ,
                t.prototype._createBackgroundTail = function() {
                    var e = this._resourcesService.getSprite(this._backgroundTailSettings.asset);
                    return e.position.y = this._backgroundTailSettings.yPosition,
                    e.width += this._backgroundTailSettings.widthIncrease,
                    e.anchor.set(.5, 0),
                    e
                }
                ,
                t.prototype._createPopoutAnimation = function(e, t, i, n, r) {
                    var o = new lr.gsap.core.Timeline({
                        onUpdateParams: [e],
                        onUpdate: this._onAnimationUpdate,
                        onComplete: r,
                        callbackScope: this,
                        paused: !0
                    })
                      , a = lr.gsap.to(e, {
                        width: t,
                        duration: .7 * n,
                        ease: as.Yv.easeOut
                    })
                      , s = lr.gsap.to(e, {
                        height: i,
                        duration: n,
                        ease: as.eJ.easeOut
                    });
                    return o.add(a),
                    o.add(s, .5 * n),
                    o
                }
                ,
                t.prototype._onAnimationUpdate = function(e) {
                    e.pivot.set(.5 * e.width, e.height),
                    this._top = -e.height,
                    this._left = .5 * e.width,
                    this._right = -this._left,
                    this._bottom = 0
                }
                ,
                t.prototype._onCloseAnimationComplete = function() {
                    this._animationState = Ld.IDLE,
                    this._setupCloseState()
                }
                ,
                t.prototype._onOpenAnimationComplete = function() {
                    this._animationState = Ld.IDLE,
                    this._setupOpenState()
                }
                ,
                t.prototype._setupOpenState = function() {
                    this._state = Nd.OPEN,
                    this._openContainer.position.set(0, this._top),
                    this._openContainer.visible = !0,
                    this._expansionBackground && (this._expansionBackground.visible = !0)
                }
                ,
                t.prototype._setupCloseState = function() {
                    this._state = Nd.CLOSE,
                    this._closeContainer.position.set(0, this._top),
                    this._closeContainer.visible = !0,
                    this._expansionBackground && (this._expansionBackground.visible = !1)
                }
                ,
                t
            }(Xe.Container), Ud = [{
                name: "fade_in",
                duration: .3,
                repeat: 0,
                keyframes: {
                    icon: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0,
                            scale: {
                                x: "-=0.3",
                                y: "-=0.3"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.out",
                        params: {
                            alpha: 1,
                            scale: {
                                x: "+=0.3",
                                y: "+=0.3"
                            }
                        }
                    }]
                }
            }, {
                name: "fade_out",
                duration: .3,
                repeat: 0,
                keyframes: {
                    icon: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 1,
                            scale: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.out",
                        params: {
                            alpha: 0,
                            scale: {
                                x: "-=0.3",
                                y: "-=0.3"
                            }
                        }
                    }]
                }
            }];
            !function(e) {
                e[e.SHOW = 0] = "SHOW",
                e[e.HIDE = 1] = "HIDE"
            }(xd || (xd = {}));
            var Fd, Md = function(e) {
                function t(t, i, n) {
                    var r, o, a = this;
                    return (a = e.call(this, {
                        basePopoutType: Bd.CLOSED_ONLY,
                        canHide: !1,
                        retractionHeight: 150,
                        retractionWidth: 150
                    }) || this)._recipeService = De.services.recipes,
                    a._recipeIconSprite = null,
                    a._animationTimeline = null,
                    a._currentNotification = 0,
                    a._notificationState = xd.SHOW,
                    a._timeline = lr.gsap.timeline(),
                    a._currentOrder = t,
                    a._startPosition = i,
                    a._gridCellToWatch = n,
                    a._notificationAlertSpine = a._resourcesService.getSpine(se.NOTIFICATION_ATTENTION),
                    a._regenerationIconSprite = a._resourcesService.getSprite(f.ICON_TIMER_REGENERATING),
                    a._buildVisuals(),
                    a._updateVisuals(),
                    a.position.copyFrom(a._getNewPosition()),
                    null === (r = a._gridCellToWatch) || void 0 === r || r.onContentAdded.addListener(a._animatePreviewToPosition, a),
                    null === (o = a._gridCellToWatch) || void 0 === o || o.onContentRemoved.addListener(a._animatePreviewToPosition, a),
                    a
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "currentOrder", {
                    get: function() {
                        return this._currentOrder
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function(t) {
                    var i, n, r;
                    e.prototype.destroy.call(this, t),
                    null === (i = this._animationTimeline) || void 0 === i || i.dispose(),
                    null === (n = this._gridCellToWatch) || void 0 === n || n.onContentAdded.removeListener(this._animatePreviewToPosition, this),
                    null === (r = this._gridCellToWatch) || void 0 === r || r.onContentRemoved.removeListener(this._animatePreviewToPosition, this)
                }
                ,
                t.prototype.onStateChanged = function(e) {
                    var t, i;
                    this._currentOrder !== e && (this._currentOrder = e,
                    null === (t = this._animationTimeline) || void 0 === t || t.dispose(),
                    null === (i = this._recipeIconSprite) || void 0 === i || i.destroy(),
                    this._createRecipeIconPreview(),
                    this._updateVisuals())
                }
                ,
                t.prototype._buildVisuals = function() {
                    var e;
                    this._createRecipeIconPreview(),
                    this._closeContainer.addChild(this._regenerationIconSprite),
                    this._regenerationIconSprite.visible = !1,
                    this._regenerationIconSprite.anchor.set(.5),
                    this._regenerationIconSprite.scale.set(1.35),
                    this._regenerationIconSprite.position.set(0, .5 * this._retractionHeight),
                    this._closeContainer.addChild(this._notificationAlertSpine),
                    this._notificationAlertSpine.visible = !1,
                    this._notificationAlertSpine.position.set(.5 * this._retractionHeight - 15, 35),
                    null === (e = this._idleAnimation) || void 0 === e || e.onCustomEvent.addListener(this._onPopoutAnimationEvent, this)
                }
                ,
                t.prototype._updateVisuals = function() {
                    var e, t, i, n;
                    if (this._recipeIconSprite)
                        switch (this._currentOrder.state) {
                        case ps.STARTABLE:
                            this._notificationAlertSpine.visible = !0,
                            this._notificationAlertSpine.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !1),
                            this._notificationAlertSpine.state.timeScale = 0,
                            null === (e = this._animationTimeline) || void 0 === e || e.play("fade_in");
                            break;
                        case ps.AVAILABLE:
                            this._regenerationIconSprite.visible = !1,
                            this._notificationAlertSpine.visible = !1,
                            null === (t = this._animationTimeline) || void 0 === t || t.play("fade_in");
                            break;
                        case ps.IN_PROGRESS:
                            this._regenerationIconSprite.visible = !0,
                            this._notificationAlertSpine.visible = !1,
                            null === (i = this._animationTimeline) || void 0 === i || i.play("fade_out");
                            break;
                        case ps.COMPLETE:
                            this._notificationAlertSpine.visible = !0,
                            this._notificationAlertSpine.state.setAnimation(0, V.NOTIFICATION_CHECKMARK, !1),
                            this._notificationAlertSpine.state.timeScale = 0,
                            null === (n = this._animationTimeline) || void 0 === n || n.play("fade_in")
                        }
                }
                ,
                t.prototype._createRecipeIconPreview = function() {
                    var e = this._recipeService.getRecipe(this._currentOrder.recipe);
                    this._recipeIconSprite = this._resourcesService.getSprite(e.image),
                    this._closeContainer.addChild(this._recipeIconSprite),
                    this._recipeIconSprite.scale.set(.66),
                    this._recipeIconSprite.position.set(0, .5 * this._retractionHeight),
                    this._recipeIconSprite.anchor.set(.5, .5),
                    this._regenerationIconSprite.visible = !1,
                    this._animationTimeline = new ur(Ud),
                    this._animationTimeline.setTargets({
                        icon: this._recipeIconSprite
                    })
                }
                ,
                t.prototype._onPopoutAnimationEvent = function(e) {
                    var t = this._currentOrder.state;
                    "hover_top" === e.event && (this._currentNotification++,
                    this._notificationState === xd.SHOW ? (t === ps.COMPLETE ? this._notificationAlertSpine.state.setAnimation(0, V.NOTIFICATION_CHECKMARK, !1) : t === ps.STARTABLE && this._notificationAlertSpine.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !1),
                    this._notificationAlertSpine.state.timeScale = 1,
                    this._currentNotification > 2 && (this._notificationState = xd.HIDE,
                    this._currentNotification = 0)) : this._currentNotification > 8 && (this._notificationState = xd.SHOW,
                    this._currentNotification = 0))
                }
                ,
                t.prototype._getNewPosition = function() {
                    var e, t = -120;
                    return (null === (e = this._gridCellToWatch) || void 0 === e ? void 0 : e.content) && !this._gridCellToWatch.content.getBlueprintID().includes("cloud") && (this._gridCellToWatch.content.hasBehavior(Ke.ExtendedTile) || this._gridCellToWatch.content.hasBehavior(Ke.ExtendedTileChild) || (t = -30)),
                    new Xe.Point(this._startPosition.x,this._startPosition.y + t)
                }
                ,
                t.prototype._animatePreviewToPosition = function() {
                    var e = this._getNewPosition();
                    this._timeline.kill(),
                    this._timeline = lr.gsap.timeline(),
                    this._timeline.add(lr.gsap.to(this, {
                        x: e.x,
                        y: e.y,
                        duration: .25,
                        ease: "sine.in"
                    }))
                }
                ,
                t
            }(Gd), Vd = function(e) {
                function t() {
                    var t, i = this;
                    return (i = e.call(this, {
                        basePopoutType: Bd.CLOSED_ONLY,
                        hasIdleAnimation: !0
                    }) || this)._currentNotification = 0,
                    i._notificationState = xd.SHOW,
                    i._defaultAsset = f.ICON_BALLOON_TRAINTICKET,
                    i._setCloseContainerAsset(i._defaultAsset),
                    i._notificationAlertSpine = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    i._notificationAlertSpine.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !1),
                    i._notificationAlertSpine.position.set(60, 15),
                    null === (t = i._idleAnimation) || void 0 === t || t.onCustomEvent.addListener(i._onPopoutAnimationEvent, i),
                    i._closeContainer.addChild(i._notificationAlertSpine),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function(t) {
                    e.prototype.show.call(this, t),
                    De.services.audio.playSoundEffect(m.POPOUT_APPEARS)
                }
                ,
                t.prototype.resetPopoutImage = function() {
                    this._setCloseContainerAsset(this._defaultAsset)
                }
                ,
                t.prototype.setCustomPopoutImage = function(e) {
                    this._setCloseContainerAsset(e)
                }
                ,
                t.prototype._setCloseContainerAsset = function(e) {
                    this._closeContainer.removeChildren(),
                    this._closeContainer.addChild(rr(De.services.resource.getSprite(e), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 60
                        }
                    }))
                }
                ,
                t.prototype._onPopoutAnimationEvent = function(e) {
                    "hover_top" === e.event && (this._currentNotification++,
                    this._notificationState === xd.SHOW ? (this._notificationAlertSpine.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !1),
                    this._notificationAlertSpine.state.timeScale = 1,
                    this._currentNotification > 2 && (this._notificationState = xd.HIDE,
                    this._currentNotification = 0)) : this._currentNotification > 8 && (this._notificationState = xd.SHOW,
                    this._currentNotification = 0))
                }
                ,
                t
            }(Gd);
            !function(e) {
                e[e.FRIEND_REWARD = 0] = "FRIEND_REWARD",
                e[e.LOOT = 1] = "LOOT",
                e[e.UPGRADE_BUILDING = 2] = "UPGRADE_BUILDING",
                e[e.DISCOVER_BUILDING = 3] = "DISCOVER_BUILDING",
                e[e.ORDER = 4] = "ORDER",
                e[e.COLLECT = 5] = "COLLECT",
                e[e.RESOURCE_GATE = 6] = "RESOURCE_GATE",
                e[e.TRAINSTATION = 7] = "TRAINSTATION",
                e[e.COOLDOWN = 8] = "COOLDOWN",
                e[e.HEAVY_OBJECT = 9] = "HEAVY_OBJECT"
            }(Fd || (Fd = {}));
            var Hd, jd = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._behaviorPriorities = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            for (e in this._behaviorPriorities)
                                t = this._behaviorPriorities[e],
                                this.addFamily([t], this._onPrioritizedBehaviorAdded, this._onPrioritizedBehaviorRemoved);
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onPrioritizedBehaviorAdded = function(e) {
                    this._performPriorityCheck(e)
                }
                ,
                t.prototype._onPrioritizedBehaviorRemoved = function(e) {
                    if (e.hasBehavior(Ke.InteractionPriorityTurn)) {
                        var t = e.getBehavior(Ke.InteractionPriorityTurn);
                        this._logger.info("Interaction priority has been removed: ".concat(Fd[t.group])),
                        this._performPriorityCheck(e)
                    }
                }
                ,
                t.prototype._performPriorityCheck = function(e) {
                    var t = this._getTopPriorityOnGameObject(e);
                    t ? (this._logger.info("Resulting interaction priority: ".concat(Fd[t.group])),
                    e.replaceBehavior(new Gt({
                        group: t.group
                    }))) : e.hasBehavior(Ke.InteractionPriorityTurn) && e.removeBehaviorByType(Ke.InteractionPriorityTurn)
                }
                ,
                t.prototype._getTopPriorityOnGameObject = function(e) {
                    var t = Object.keys(this._behaviorPriorities).map((function(e) {
                        return parseInt(e)
                    }
                    ));
                    t.sort();
                    for (var i = 0, n = t; i < n.length; i++) {
                        var r = n[i];
                        if (e.hasBehavior(this._behaviorPriorities[r])) {
                            var o = e.getBehavior(this._behaviorPriorities[r]);
                            if (o.parent)
                                return {
                                    group: r,
                                    behavior: o
                                }
                        }
                    }
                    return null
                }
                ,
                t
            }(Pd), Kd = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._preview = new Vd,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._trainFamily = this.addFamily([Ke.Trainstation, Ke.GridPosition], this._onTrainstationAdded),
                            this.addFamily([Ke.Trainstation, Ke.InteractionTap, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onInteractionAdded),
                            De.services.inventory.getInventoryItem(Cn.TICKETS).onChanged.addListener(this._onInventoryChange, this),
                            this._trainFamily.getGameObjects().length > 1 && this._logger.error("found more than 1 object with a trainstation behavior"),
                            this._openTrainstationPopup = nc((function() {
                                e._logger.info("TrainstationSystem: Trying Opening TrainstationPopup"),
                                e.services.onboarding.isTrackCompleted(Lo.TRAIN_STATION_TRACK_1) ? (e._logger.info("TrainstationSystem: Opening TrainstationPopup"),
                                De.services.navigation.showPopup(Yl, {
                                    incentivise: e.services.incentivise
                                })) : e._logger.info("TrainstationSystem: Onboarding track not completed, not opening TrainstationPopup"),
                                e.services.onboarding.isTrackCompleted(Lo.TRAIN_STATION_TRACK_2) && De.services.analytics.design.trainStationSteps(en.CLICKED)
                            }
                            )),
                            this._preview.hide(!1),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.inventory.getInventoryItem(Cn.TICKETS).onChanged.removeListener(this._onInventoryChange, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._setCustomPopoutImage = function(e) {
                    this._preview.setCustomPopoutImage(e)
                }
                ,
                t.prototype._onTrainstationAdded = function(e) {
                    var t = e.getBehavior(Ke.GridPosition);
                    this._preview.onClick.addListener(this._simulateClick.bind(this, e), this),
                    this.services.mapGridView.getLayer(Yo.POPOUTS).addChild(this._preview);
                    var i = {
                        column: t.column,
                        row: t.row
                    }
                      , n = this.services.axonometricProjection.getWorldPosition(i.column, i.row)
                      , r = n.x
                      , o = n.y;
                    this._preview.position.set(r - 40, o - 180),
                    De.services.inventory.hasAmount(Cn.TICKETS, 1) && (this._preview.show(!0),
                    De.services.analytics.design.ticketAvailable())
                }
                ,
                t.prototype._onInteractionAdded = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._logger.info("TrainstationSystem: Interaction added"),
                            e.getBehavior(Ke.InteractionPriorityTurn).group !== Fd.TRAINSTATION || (this._openTrainstationPopup(),
                            this._preview.resetPopoutImage()),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onInventoryChange = function(e) {
                    e.current > 0 ? (De.services.friends.fetchPlatformFriends(),
                    this._preview.show(!0)) : this._preview.hide(!0)
                }
                ,
                t.prototype._simulateClick = function(e) {
                    this.services.interactionHelper.simulateClick.fire(e)
                }
                ,
                t
            }(Pd), Wd = [ko.TAP, ko.OBJECT_PICK], zd = function() {
                function e() {
                    this._store = new Map
                }
                return e.prototype.add = function(e, t) {
                    var i = e.column
                      , n = e.row;
                    return this._store.set("".concat(i, ":").concat(n), t),
                    t
                }
                ,
                e.prototype.get = function(e) {
                    var t = e.column
                      , i = e.row;
                    return this._store.get("".concat(t, ":").concat(i))
                }
                ,
                e.prototype.getAllPopouts = function() {
                    var e = this
                      , t = [];
                    return Array.from(this._store.keys()).forEach((function(i) {
                        var n = e._store.get(i);
                        n && t.push(n)
                    }
                    )),
                    t
                }
                ,
                e.prototype.remove = function(e) {
                    var t = e.column
                      , i = e.row
                      , n = this._store.get("".concat(t, ":").concat(i));
                    if (n)
                        return this._store.delete("".concat(t, ":").concat(i)),
                        n
                }
                ,
                e
            }(), Yd = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.onPopoutClosed = new r.Event,
                    i.onPopupOpened = new r.Event,
                    i._popouts = [],
                    i._hudElementClicked = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.registerPopout = function(e) {
                    this._popouts.includes(e) || (this._popouts.push(e),
                    this._targetContainer.addChild(e),
                    e.onShow.addListener(this._hideOtherPopouts.bind(this, e), this))
                }
                ,
                t.prototype.openPopout = function(e) {
                    e.open(),
                    De.services.audio.playSoundEffect(m.POPOUT_OPEN)
                }
                ,
                t.prototype.closePopout = function(e) {
                    e.close()
                }
                ,
                t.prototype.hidePopout = function(e) {
                    e.hide(),
                    this.onPopoutClosed.fire(e)
                }
                ,
                t.prototype.showPopout = function(e) {
                    e.show(),
                    this.onPopupOpened.fire(e),
                    De.services.audio.playSoundEffect(m.POPOUT_OPEN)
                }
                ,
                t.prototype.unregisterPopout = function(e) {
                    var t = this._popouts.indexOf(e);
                    -1 !== t && (this._targetContainer.removeChild(e),
                    e.removeAllListeners(),
                    this._popouts.splice(t, 1))
                }
                ,
                t.prototype.getPopoutById = function(e) {
                    return this._popouts.find((function(t) {
                        return t.id === e
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.interactionService.onGestureConfirm.addListener(this._onGestureConfirmed, this),
                            this._hudElementClicked.addListener(this._hideAllPopouts, this),
                            this._targetContainer = this.services.mapGridView.getLayer(Yo.POPOUTS),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.interactionService.onGestureConfirm.removeListener(this._onGestureConfirmed, this),
                            this._hudElementClicked.removeListener(this._hideAllPopouts, this),
                            this._popouts.forEach((function(e) {
                                e.destroy()
                            }
                            )),
                            this._popouts = [],
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onGestureConfirmed = function(e) {
                    -1 !== Wd.indexOf(e) && (this._popouts.some((function(e) {
                        return e.isOpen
                    }
                    )) && De.services.audio.playSoundEffect(m.POPOUT_CLOSE),
                    this._hideAllPopouts())
                }
                ,
                t.prototype._hideOtherPopouts = function(e) {
                    var t = this;
                    this._popouts.forEach((function(i) {
                        i !== e && i.isOpen && (t.closePopout(e),
                        t.hidePopout(i))
                    }
                    ))
                }
                ,
                t.prototype._hideAllPopouts = function() {
                    var e = this;
                    this._popouts.forEach((function(t) {
                        t.isOpen && (e.closePopout(t),
                        e.hidePopout(t))
                    }
                    ))
                }
                ,
                t
            }(Go), Jd = [{
                name: "blink",
                duration: 1,
                repeat: -1,
                keyframes: {
                    chunk: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: 0,
                        duration: .5,
                        ease: "none",
                        params: {
                            alpha: 0
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "none",
                        params: {
                            alpha: 1
                        }
                    }]
                }
            }];
            !function(e) {
                e[e.LEFT_BACKGROUND = 0] = "LEFT_BACKGROUND",
                e[e.LEFT_FOREGROUND = 1] = "LEFT_FOREGROUND",
                e[e.RIGHT_BACKGROUND = 2] = "RIGHT_BACKGROUND",
                e[e.RIGHT_FOREGROUND = 3] = "RIGHT_FOREGROUND",
                e[e.CENTER_BACKGROUND = 4] = "CENTER_BACKGROUND",
                e[e.CENTER_FOREGROUND = 5] = "CENTER_FOREGROUND"
            }(Hd || (Hd = {}));
            var Xd, qd, Qd, Zd, $d, eh, th = function(e) {
                function t(t, i, n) {
                    void 0 === i && (i = 280),
                    void 0 === n && (n = 60);
                    var r = e.call(this) || this;
                    return r._animationChunks = [],
                    r._currentValue = t,
                    r._maxValue = t,
                    r._barWidth = i,
                    r._barHeight = n,
                    r._isSingleBar = t > 0 && t <= 1,
                    r._chunkBar = r._createChunkProgressBar(r._maxValue),
                    r._prepareChunkAnimation(),
                    r._playChunkAnimation(),
                    r.addChild(r._chunkBar.container),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.updateHealth = function(e) {
                    if (this._currentValue = r.NumberUtility.clamp(0, e, this._maxValue),
                    this._isSingleBar)
                        for (var t = 0 === this._currentValue, i = 0; i < 2; i++)
                            this._chunkBar.chunks[i].visible = !t;
                    else
                        for (i = 0; i < this._maxValue; i++)
                            this._chunkBar.chunks[i].visible = i + 1 <= this._currentValue;
                    this._animationChunks.forEach((function(e) {
                        return e.dispose()
                    }
                    )),
                    this._prepareChunkAnimation(),
                    this._playChunkAnimation()
                }
                ,
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    this._animationChunks.forEach((function(e) {
                        return e.dispose()
                    }
                    ))
                }
                ,
                t.prototype._prepareChunkAnimation = function() {
                    if (this._animationChunks = [],
                    this._isSingleBar)
                        for (var e = 0; e < 2; e++) {
                            var t;
                            (t = new ur(Jd)).setTargets({
                                chunk: this._chunkBar.chunks[e]
                            }),
                            this._animationChunks.push(t)
                        }
                    else
                        (t = new ur(Jd)).setTargets({
                            chunk: this._chunkBar.chunks[this._currentValue - 1]
                        }),
                        this._animationChunks.push(t)
                }
                ,
                t.prototype._playChunkAnimation = function() {
                    this._animationChunks.forEach((function(e) {
                        return e.play("blink")
                    }
                    ))
                }
                ,
                t.prototype._createChunkProgressBar = function(e) {
                    return this._isSingleBar ? this._createSingleChunkBar(this._barWidth, this._barHeight, 5, 5) : this._createMultiChunkBar(e, this._barWidth, this._barHeight, 5, 5)
                }
                ,
                t.prototype._createSingleChunkBar = function(e, t, i, n) {
                    var r = new Xe.Container
                      , o = Math.floor(.5 * e) - i
                      , a = Math.floor(t) - 2 * n
                      , s = De.services.resource.getTexture(f.PROGRESS_BAR_PANEL_2_SLICE)
                      , _ = new Xe.NineSlicePlane(s,9,9,9,9);
                    _.width = e - 5,
                    _.height = t;
                    var c = this._createChunkByType(Hd.LEFT_BACKGROUND, o, a);
                    c.position.set(i, n);
                    var l = this._createChunkByType(Hd.LEFT_FOREGROUND, o, a);
                    l.position.set(i, n),
                    l.width = o,
                    l.height = a;
                    var u = this._createChunkByType(Hd.RIGHT_BACKGROUND, o, a);
                    u.position.set(c.x + c.width - 5, c.y);
                    var d = this._createChunkByType(Hd.RIGHT_FOREGROUND, o, a);
                    return d.position.set(l.x + l.width - 5, l.y),
                    r.addChild(_),
                    r.addChild(c),
                    r.addChild(l),
                    r.addChild(u),
                    r.addChild(d),
                    r.pivot.set(.5 * _.width, .5 * _.height),
                    {
                        container: r,
                        chunks: [l, d]
                    }
                }
                ,
                t.prototype._createMultiChunkBar = function(e, t, i, r, o) {
                    var a = e
                      , s = t - 2 * o
                      , _ = Math.floor(s - 4 * (a - 1))
                      , c = Math.floor(_ / a)
                      , l = i - 2 * r
                      , u = o
                      , d = r
                      , h = new Xe.Container
                      , p = De.services.resource.getTexture(f.PROGRESS_BAR_PANEL_2_SLICE)
                      , v = new Xe.NineSlicePlane(p,9,9,9,9);
                    v.width = t,
                    v.height = i;
                    var g = this._createChunkByType(Hd.LEFT_BACKGROUND, c, l);
                    g.position.set(u, d);
                    var E = this._createChunkByType(Hd.LEFT_FOREGROUND, c, l);
                    E.position.set(u, d),
                    h.addChild(v),
                    h.addChild(g),
                    h.addChild(E);
                    for (var m = [], y = 0; y < a - 2; y++) {
                        var T = (c + 4) * (y + 1)
                          , A = this._createChunkByType(Hd.CENTER_BACKGROUND, c, l);
                        A.position.set(u + T, d);
                        var C = this._createChunkByType(Hd.CENTER_FOREGROUND, c, l);
                        C.position.set(u + T, d),
                        h.addChild(A),
                        h.addChild(C),
                        m.push(C)
                    }
                    var I = (c + 4) * (a - 1)
                      , S = this._createChunkByType(Hd.RIGHT_BACKGROUND, c, l);
                    S.position.set(u + I, d);
                    var O = this._createChunkByType(Hd.RIGHT_FOREGROUND, c, l);
                    return O.position.set(u + I, d),
                    h.addChild(S),
                    h.addChild(O),
                    h.pivot.set(.5 * h.width, .5 * h.height),
                    {
                        container: h,
                        chunks: (0,
                        n.__spreadArray)((0,
                        n.__spreadArray)([E], m, !0), [O], !1)
                    }
                }
                ,
                t.prototype._createChunkByType = function(e, t, i) {
                    var n;
                    switch (e) {
                    case Hd.LEFT_BACKGROUND:
                        n = new Xe.NineSlicePlane(De.services.resource.getTexture(f.PROGRESS_BAR_FILL_DYNAMIC_LEFT_GRAY),8,8,1,8);
                        break;
                    case Hd.LEFT_FOREGROUND:
                        n = new Xe.NineSlicePlane(De.services.resource.getTexture(f.PROGRESS_BAR_FILL_DYNAMIC_LEFT),8,8,1,8);
                        break;
                    case Hd.RIGHT_BACKGROUND:
                        n = new Xe.NineSlicePlane(De.services.resource.getTexture(f.PROGRESS_BAR_FILL_DYNAMIC_RIGHT_GRAY),1,8,8,8);
                        break;
                    case Hd.RIGHT_FOREGROUND:
                        n = new Xe.NineSlicePlane(De.services.resource.getTexture(f.PROGRESS_BAR_FILL_DYNAMIC_RIGHT),1,8,8,8);
                        break;
                    case Hd.CENTER_BACKGROUND:
                        n = new Xe.NineSlicePlane(De.services.resource.getTexture(f.PROGRESS_BAR_FILL_DYNAMIC_MIDDLE_GRAY),1,1,1,1);
                        break;
                    case Hd.CENTER_FOREGROUND:
                        n = new Xe.NineSlicePlane(De.services.resource.getTexture(f.PROGRESS_BAR_FILL_DYNAMIC_MIDDLE),1,1,1,1)
                    }
                    return n.width = t,
                    n.height = i,
                    n
                }
                ,
                t
            }(Xe.Container), ih = function(e) {
                function t(t) {
                    var i = this
                      , o = t.hitPoints
                      , a = (0,
                    n.__rest)(t, ["hitPoints"]);
                    (i = e.call(this, a) || this).onButtonClick = new r.Event,
                    i._id = "HO" + ql(a.position);
                    var s = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 70,
                        fitWidth: i._expansionWidth - 50
                    });
                    s.style = vn.popoutTitle,
                    i._titleText = rr(new v.Label(nr(Xd || (Xd = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.HEAVY_OBJECT_TITLE),s), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 50
                        }
                    }),
                    i._depletionBar = i.addChild(new th(o.max)),
                    i.updateHitpoints(o.current),
                    i._depletionBar.position.set(0, 150);
                    var _ = {
                        width: i._expansionWidth - 30,
                        height: 90
                    };
                    return i.button = i.addChild(new uc({
                        name: "heavyObjectRemove",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: _
                    },{
                        text: nr(qd || (qd = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.REMOVE_POPOUT_BUTTON),
                        textStyle: vn.buttonLabel,
                        position: {
                            x: -35,
                            y: -5
                        },
                        alignment: "center",
                        fitBoxSizes: {
                            width: _.width - 130,
                            height: 75
                        }
                    },{
                        iconImage: f.ICON_BTN_FRIEND,
                        iconPosition: {
                            x: _.width / 2 - 30,
                            y: -2
                        },
                        iconAlignment: "right"
                    })),
                    i.button.position.set(0, 245),
                    i.button.onClick(i._onShareButtonClicked.bind(i)),
                    i._openContainer.addChild(i._depletionBar, i.button, i._titleText),
                    De.services.localization.onLanguageChanged.addListener(i._updateTexts, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    De.services.localization.onLanguageChanged.removeListener(this._updateTexts, this)
                }
                ,
                t.prototype.updateHitpoints = function(e) {
                    this._depletionBar.updateHealth(e)
                }
                ,
                t.prototype._onShareButtonClicked = function() {
                    this.onButtonClick.fire()
                }
                ,
                t.prototype._updateTexts = function() {
                    this._titleText.text = nr(Qd || (Qd = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.HEAVY_OBJECT_TITLE),
                    this._titleText.style.fontFamily = vn.currentFontFamily,
                    this.button.updateText(nr(Zd || (Zd = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.REMOVE_POPOUT_BUTTON)),
                    this.button.updateTextStyle({
                        fontFamily: vn.currentFontFamily
                    })
                }
                ,
                t
            }(Gd), nh = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._popoutStore = new zd,
                    t._shareImages = {},
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.HeavyObject, Ke.InteractionTap, Ke.Hitpoints, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onHeavyObjectInteractionAdded),
                            this.addFamily([Ke.HeavyObject, Ke.Hitpoints, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onHeavyObjectAdded),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onHeavyObjectAdded = function(e) {
                    if (e.getBehavior(Ke.InteractionPriorityTurn).group === Fd.HEAVY_OBJECT) {
                        var t = e.getBehavior(Ke.HeavyObject)
                          , i = t.tokenKey
                          , n = t.customShareImage
                          , r = t.friendsHelpedIds
                          , o = e.getBehavior(Ke.Hitpoints)
                          , a = e.getBehavior(Ke.GridPosition)
                          , s = this._popoutStore.get(a);
                        s ? s.updateHitpoints(o.current) : (e.hasBehavior(Ke.HitpointsPreview) || e.addBehavior(new kt({})),
                        this._addCustomShareImage(e.getBlueprintID(), n),
                        this._clampHitpoints(e),
                        "" === i && De.services.token.getTokenForHeavyObject({
                            column: a.column,
                            row: a.row
                        }, o.max).then((function(t) {
                            e.replaceBehavior(new Bt({
                                tokenKey: t,
                                customShareImage: n,
                                friendsHelpedIds: r
                            }))
                        }
                        )))
                    }
                }
                ,
                t.prototype._onHeavyObjectInteractionAdded = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a, s;
                        return (0,
                        n.__generator)(this, (function(_) {
                            return e.getBehavior(Ke.InteractionPriorityTurn).group !== Fd.HEAVY_OBJECT ? [2] : (t = e.getBehavior(Ke.Hitpoints),
                            i = e.getBehavior(Ke.GridPosition),
                            r = {
                                row: i.row,
                                column: i.column
                            },
                            o = (this.services.mapAreaService.getMapAreaThatHasCell(i) || {
                                id: -1
                            }).id,
                            De.services.analytics.design.heavyObjectInteraction(on.OPEN_POPOUT, sn[e.getBlueprintID()], String(o)),
                            (a = this._popoutStore.get(i)) ? (this._delayedUpdatePopoutHitpoints(a, e),
                            this.services.popout.showPopout(a),
                            [2]) : ((s = new ih({
                                expansionHeight: 300,
                                expansionWidth: 400,
                                hitPoints: t,
                                basePopoutType: Bd.OPEN_ONLY,
                                position: (0,
                                n.__assign)({}, r)
                            })).onButtonClick.addListener(this._onPopoutClicked.bind(this, s, e, (0,
                            n.__assign)({}, r), o), this),
                            s.position.copyFrom(e.position),
                            this.services.popout.registerPopout(s),
                            this.services.popout.showPopout(s),
                            this._popoutStore.add(i, s),
                            this._delayedUpdatePopoutHitpoints(s, e),
                            [2]))
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._delayedUpdatePopoutHitpoints = function(e, t) {
                    r.TimeDelay.nextFrame().then((function() {
                        var i = t.getBehavior(Ke.Hitpoints);
                        e.updateHitpoints(i.current)
                    }
                    ))
                }
                ,
                t.prototype._addCustomShareImage = function(e, t) {
                    var i = this;
                    De.services.lazyLoad.getLoadingPromise(hn.CUSTOM_SHARE).then((function() {
                        var n = De.services.resource.getSprite({
                            alias: t
                        })
                          , r = n.addChild(De.services.friends.fetchOwnProfile().getPhoto());
                        r.width = 168,
                        r.height = 168,
                        r.position.set(120, 122),
                        i._shareImages[e] = n
                    }
                    ))
                }
                ,
                t.prototype._onPopoutClicked = function(e, t, i, n) {
                    var r = {
                        heavyObjectService: this.services.heavyObjectService,
                        object: t,
                        cellPosition: i,
                        id: n,
                        image: this._shareImages[t.getBlueprintID()]
                    };
                    this.services.popout.hidePopout(e),
                    De.services.navigation.closeAllPopups(),
                    De.services.lazyLoad.prioritizeGroup(hn.SHOVEL_POPUP).then((function() {
                        return De.services.navigation.showPopup(uu, r)
                    }
                    ))
                }
                ,
                t.prototype._clampHitpoints = function(e) {
                    var t = e.getBehavior(Ke.Hitpoints);
                    if (t && !(t.current <= t.max)) {
                        var i = new Pt({
                            current: Math.min(t.current, t.max),
                            max: t.max
                        });
                        e.replaceBehavior(i)
                    }
                }
                ,
                t
            }(Pd), rh = {
                x: .666,
                y: .666
            }, oh = function(e) {
                function t(t) {
                    var i, r = this;
                    return (r = e.call(this, {
                        basePopoutType: Bd.CLOSED_ONLY,
                        hasIdleAnimation: !0,
                        retractionHeight: 150,
                        retractionWidth: 150
                    }) || this)._currentNotification = 0,
                    r._notificationState = xd.SHOW,
                    r._notification = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    r._closeContainer.addChild(rr(t.iconSprite, {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: t.iconScale || (0,
                        n.__assign)({}, rh),
                        position: {
                            x: 0,
                            y: .5 * r._retractionHeight - 5
                        }
                    })),
                    t.isNature && (r._notification.position.set(r._closeContainer.width / 2 + 15, r._closeContainer.height / 2 + 10),
                    r._closeContainer.addChild(r._notification),
                    null === (i = r._idleAnimation) || void 0 === i || i.onCustomEvent.addListener(r._onPopoutAnimationEvent, r)),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onPopoutAnimationEvent = function(e) {
                    "hover_top" === e.event && (this._currentNotification++,
                    this._notificationState === xd.SHOW ? (this._notification.state.setAnimation(0, V.NOTIFICATION_CHECKMARK, !1),
                    this._notification.state.timeScale = 1,
                    this._currentNotification > 2 && (this._notificationState = xd.HIDE,
                    this._currentNotification = 0)) : this._currentNotification > 8 && (this._notificationState = xd.SHOW,
                    this._currentNotification = 0))
                }
                ,
                t
            }(Gd), ah = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._activePreviews = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.FriendReward, Ke.InteractionPick, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onInteractionPick),
                            this.addFamily([Ke.FriendReward, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onFriendRewardAdded, this._onFriendRewardRemoved),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showPreview = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o, a, s, _;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return o = t.rewardData[t.rewardData.length - 1].friendid,
                                [4, De.services.friends.fetchProfile({
                                    userid: o
                                })];
                            case 1:
                                return a = n.sent(),
                                (0,
                                r.isUndefined)(a) ? (this._logger.warn("Player data is undefined, cannot show preview."),
                                e.removeBehavior(t),
                                [2]) : (this._activePreviews.has(e) || ((s = new oh({
                                    iconSprite: a.getPhoto(),
                                    iconScale: {
                                        x: .4,
                                        y: .4
                                    }
                                })).onClick.addListener(this._simulateClick.bind(this, e), this),
                                _ = this.services.axonometricProjection.getWorldPosition(i.column, i.row),
                                s.position.copyFrom(_),
                                e.hasBehavior(Ke.Building) && s.position.set(_.x, _.y - 120),
                                this.services.mapGridView.getLayer(Yo.POPOUTS).addChild(s),
                                s.show(!0),
                                this._activePreviews.set(e, s)),
                                [2])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._hidePreview = function(e) {
                    var t = this._activePreviews.get(e);
                    t && (t.hide(!0, !0),
                    this._activePreviews.delete(e))
                }
                ,
                t.prototype._onInteractionPick = function(e) {
                    e.getBehavior(Ke.InteractionPriorityTurn).group === Fd.FRIEND_REWARD && this._hidePreview(e)
                }
                ,
                t.prototype._onFriendRewardAdded = function(e) {
                    if (e.getBehavior(Ke.InteractionPriorityTurn).group === Fd.FRIEND_REWARD) {
                        var t = e.getBehavior(Ke.GridPosition)
                          , i = e.getBehavior(Ke.FriendReward);
                        this._showPreview(e, i, {
                            column: t.column,
                            row: t.row
                        })
                    }
                }
                ,
                t.prototype._onFriendRewardRemoved = function(e) {
                    this._hidePreview(e)
                }
                ,
                t.prototype._simulateClick = function(e) {
                    this.services.interactionHelper.simulateClick.fire(e)
                }
                ,
                t
            }(Pd);
            !function(e) {
                e.INGREDIENTS = "ingredients"
            }($d || ($d = {})),
            function(e) {
                e.INGREDIENTS = "ingredients",
                e.HEAVY_OBJECT = "heavyObject"
            }(eh || (eh = {}));
            var sh = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.FriendReward, Ke.InteractionPriorityTurn, Ke.InteractionTap], this._onInteractionTap),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onInteractionTap = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return t = e.getBehavior(Ke.FriendReward),
                            e.getBehavior(Ke.InteractionPriorityTurn).group !== Fd.FRIEND_REWARD ? [2] : (i = t.rewardData.pop()) ? (0 === t.rewardData.length ? e.removeBehaviorByType(Ke.FriendReward) : e.replaceBehavior(t),
                            this._processReward(e, i),
                            this._sendAnalytics(),
                            [2]) : (this._logger.error("There is a FriendRewardBehavior without any data, fix it!"),
                            e.removeBehaviorByType(Ke.FriendReward),
                            [2])
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._processReward = function(e, t) {
                    if (t.reward.key !== eh.HEAVY_OBJECT) {
                        var i = {
                            key: t.reward.key,
                            amount: t.reward.amount
                        };
                        if (t.reward.key === eh.INGREDIENTS) {
                            var n = De.services.blueprintGraphService.getCollectItemFromBlueprint(e.getBlueprintID());
                            i.key = n
                        }
                        De.services.inventory.addAmount(i.key, i.amount),
                        this._logger.info("".concat(i.amount, " ").concat(i.key, " were added to your inventory!"));
                        var r = za[i.key] || Ja[i.key];
                        if (e.addBehavior(new ui({
                            floaterType: ci.RewardFloater,
                            amount: i.amount,
                            styles: vn.darkSmall,
                            icon: r
                        })),
                        e.hasBehavior(Ke.Order)) {
                            var o = e.getBehavior(Ke.Order).order;
                            this.services.ordersService.onOrderStateChange.fire(o)
                        }
                        this._showFloaterAnimation(e, t)
                    } else
                        this._depleteHeavyObjectHealth(e, t)
                }
                ,
                t.prototype._depleteHeavyObjectHealth = function(e, t) {
                    var i = e.getBehavior(Ke.HeavyObject);
                    if (i) {
                        var r = e.getBehavior(Ke.Hitpoints);
                        if (r) {
                            var o = r.current - 1;
                            this._showFloaterAnimation(e, t),
                            0 !== o ? (e.replaceBehavior(new Bt({
                                tokenKey: i.tokenKey,
                                customShareImage: i.customShareImage,
                                friendsHelpedIds: (0,
                                n.__spreadArray)([t.friendid], i.friendsHelpedIds, !0)
                            })),
                            e.replaceBehavior(new Pt({
                                max: r.max,
                                current: o
                            })),
                            this.services.heavyObjectService.createHeavyObjectAction(e, "progress")) : (e.addBehavior(new ti({})),
                            this.services.heavyObjectService.createHeavyObjectAction(e, "complete"))
                        } else
                            this._logger.error("Heavy object should have a hitpoints behavior!")
                    } else
                        this._logger.error("_depleteHeavyObjectHealth should only be called on heavy objects!")
                }
                ,
                t.prototype._showFloaterAnimation = function(e, t) {
                    r.TimeDelay.nextFrame().then((function() {
                        e.addBehavior(new ui({
                            floaterType: ci.VisitorActionFloater,
                            actionSpine: se.VISIT_FARM_PARTICLE,
                            animationName: oe.PARTICLE,
                            actionTexture: De.services.resource.getTexture(De.services.visitorReward.getRewardAsset(t.actionType))
                        }))
                    }
                    ))
                }
                ,
                t.prototype._sendAnalytics = function() {
                    De.services.analytics.design.friendReward()
                }
                ,
                t
            }(Pd);
            function _h() {
                return [new Kd, new nh, new ah, new sh]
            }
            (function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this.services.hudService.hideHudElement(Ns.SignInBonusButtonUI, !0),
                                [4, De.services.assetLoader.loadJsons(_e.SIGN_IN_BONUS_CONFIG)];
                            case 1:
                                return t.sent(),
                                this._config = De.services.resource.getJsonCopy(_e.SIGN_IN_BONUS_CONFIG),
                                this._family = this.addFamily([Ke.SignInBonusGiftBox, Ke.GridPosition], this._updateButtonVisual, this._giftBoxedRemovedFromGrid),
                                this.addFamily([Ke.SignInBonusGiftBox, Ke.GridPosition, Ke.InteractionTap], this._giftBoxTapped),
                                De.services.signInBonus.onClaimed.addListener(this._onSignInBonusClaimed, this),
                                (null === (e = this.services.mapAreaService.getMapArea(this._config.targetArea)) || void 0 === e ? void 0 : e.state) === Cc.UNLOCKED ? this._targetAreaUnlocked() : this.services.mapAreaService.onAreaStateChange.addListener(this._onAreaStateChange, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateButtonVisual = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return e.sent(),
                                De.services.signInBonus.bonusAvailable && this._family.getGameObjects().length > 0 ? this.services.hudService.showHudElement(Ns.SignInBonusButtonUI) : this.services.hudService.hideHudElement(Ns.SignInBonusButtonUI, !0),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onAreaStateChange = function(e) {
                    e.area.id === this._config.targetArea && e.area.state === Cc.UNLOCKED && (this.services.mapAreaService.onAreaStateChange.removeListener(this._onAreaStateChange, this),
                    this._targetAreaUnlocked())
                }
                ,
                t.prototype._targetAreaUnlocked = function() {
                    var e = this;
                    !De.services.signInBonus.bonusAvailable && this._family.getGameObjects().length > 0 ? this._removeGiftBox() : De.services.signInBonus.bonusAvailable && 0 === this._family.getGameObjects().length && r.TimeDelay.after(2e3).promise.then((function() {
                        return e._addGiftBox()
                    }
                    ))
                }
                ,
                t.prototype._giftBoxTapped = function() {
                    De.services.signInBonus.openSignInBonusPopup("giftbox")
                }
                ,
                t.prototype._addGiftBox = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return i.sent(),
                                e = De.services.gameObjectFactory.createById("login_giftbox"),
                                0 === this.services.gridFilter.getEmptyCells().length && 0 === this.services.storageBubble.getBubblesWithBlueprints(["login_giftbox"]).length ? this.services.storageBubble.createBubbleAndShowContent([e.serialize({})]) : (t = this.services.gridFilter.getClosestAvailableCell(this._config.targetCellPosition, !1),
                                e.addBehavior(new Rt({
                                    column: t.column,
                                    row: t.row
                                })),
                                this.services.world.addGameObject(e)),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._removeGiftBox = function() {
                    var e = this._family.getGameObjects()[0];
                    null == e || e.addBehavior(new ti({})),
                    this.services.storageBubble.getBubblesWithBlueprints(["login_giftbox"]).forEach((function(e) {
                        return e.replaceBehavior(new Bi({
                            content: []
                        }))
                    }
                    ))
                }
                ,
                t.prototype._giftBoxedRemovedFromGrid = function(e) {
                    e.hasBehavior(Ke.InteractionDrag) || this._updateButtonVisual()
                }
                ,
                t.prototype._onSignInBonusClaimed = function() {
                    this._removeGiftBox(),
                    this._updateButtonVisual()
                }
            }
            )(Pd),
            function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons(_e.SHORTCUT_BONUS_CONFIG)];
                            case 1:
                                return e.sent(),
                                this._config = De.services.resource.getJsonCopy(_e.SHORTCUT_BONUS_CONFIG),
                                this._giftboxFamily = this.addFamily([Ke.ShortcutBonusGiftBox, Ke.GridPosition]),
                                this.addFamily([Ke.ShortcutBonusGiftBox, Ke.GridPosition, Ke.InteractionTap], this._giftBoxTapped),
                                this.services.shortcutBonusService.onClaimed.addListener(this._shortcutBonusClaimed, this),
                                this._isMapAreaUnlocked() ? this._targetAreaUnlocked() : this.services.mapAreaService.onAreaStateChange.addListener(this._onAreaStateChange, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onAreaStateChange = function(e) {
                    e.area.id === this._config.targetArea && e.area.state === Cc.UNLOCKED && (this.services.mapAreaService.onAreaStateChange.removeListener(this._onAreaStateChange, this),
                    this._targetAreaUnlocked())
                }
                ,
                t.prototype._targetAreaUnlocked = function() {
                    var e = this;
                    this._isShortcutBonusConditionMet() ? this._removeGiftBox() : this._isGiftBoxReadyToAdd() && r.TimeDelay.after(3e3).promise.then((function() {
                        return e._addGiftBox()
                    }
                    ))
                }
                ,
                t.prototype._addGiftBox = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return i.sent(),
                                e = De.services.gameObjectFactory.createById("shortcut_giftbox"),
                                0 === this.services.gridFilter.getEmptyCells().length && 0 === this.services.storageBubble.getBubblesWithBlueprints(["shortcut_giftbox"]).length ? this.services.storageBubble.createBubbleAndShowContent([e.serialize({})]) : (t = this.services.gridFilter.getClosestAvailableCell(this._config.targetCellPosition, !1),
                                e.addBehavior(new Rt({
                                    column: t.column,
                                    row: t.row
                                })),
                                this.services.world.addGameObject(e),
                                this.services.cameraService.animateCameraToCell(t)),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._removeGiftBox = function() {
                    var e = this._giftboxFamily.getGameObjects()[0];
                    null == e || e.addBehavior(new ti({})),
                    this.services.storageBubble.getBubblesWithBlueprints(["shortcut_giftbox"]).forEach((function(e) {
                        return e.replaceBehavior(new Bi({
                            content: []
                        }))
                    }
                    ))
                }
                ,
                t.prototype._shortcutBonusClaimed = function() {
                    this._removeGiftBox()
                }
                ,
                t.prototype._isMapAreaUnlocked = function() {
                    var e;
                    return (null === (e = this.services.mapAreaService.getMapArea(this._config.targetArea)) || void 0 === e ? void 0 : e.state) === Cc.UNLOCKED
                }
                ,
                t.prototype._isShortcutBonusConditionMet = function() {
                    return !this.services.shortcutBonusService.canReceiveBonus() && this._giftboxFamily.getGameObjects().length > 0
                }
                ,
                t.prototype._isGiftBoxReadyToAdd = function() {
                    return this.services.shortcutBonusService.canReceiveBonus() && 0 === this._giftboxFamily.getGameObjects().length
                }
                ,
                t.prototype._giftBoxTapped = function() {
                    this.services.shortcutBonusService.openShortcutBonusPopup("giftbox")
                }
            }(Pd);
            var ch, lh, uh, dh, hh, ph, vh, gh, fh, Eh, mh, yh, Th, Ah, Ch, Ih, Sh, Oh, bh, Rh, wh, Dh, Nh, Lh, Bh = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.priority = _r.IMMEDIATE,
                    t._name = "AdBlockDetectedPopup",
                    t._createBackground(),
                    t._createContent(),
                    t._inputBlocker.interactive = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBackground = function() {
                    this._backGround = new Ar({
                        size: {
                            width: 850,
                            height: 1200
                        },
                        headerSize: {
                            width: 566.6666666666666,
                            height: 75
                        },
                        headerText: ce.ADBLOCKER_TITLE,
                        headerStyle: vn.popupTitle,
                        showCloseButton: !1
                    }),
                    this._content.addChild(this._backGround)
                }
                ,
                t.prototype._createContent = function() {
                    var e = this._createAdBlockImage(new Xe.Point(0,-250))
                      , t = this._createBodyText(new Xe.Point(e.x,e.y + e.height / 2 + 150))
                      , i = this._createButton(new Xe.Point(t.x,t.y + t.height / 2 + 45 + 50));
                    this._createTapToContinue(new Xe.Point(i.x,750))
                }
                ,
                t.prototype._createAdBlockImage = function(e) {
                    var t = this._content.addChild(De.services.resource.getSprite(f.ICON_ADBLOCKER));
                    return t.anchor.set(.5),
                    t.position.copyFrom(e),
                    t
                }
                ,
                t.prototype._createBodyText = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 400,
                        fitWidth: 750
                    });
                    t.style = vn.darkMedium;
                    var i = this._content.addChild(new v.Label(nr(ch || (ch = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.ADBLOCKER_BODY),t));
                    return i.anchor.set(.5),
                    i.position.copyFrom(e),
                    i
                }
                ,
                t.prototype._createButton = function(e) {
                    var t = this._content.addChild(new fr({
                        name: "adBlockDetectedButton",
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE
                    },{
                        buttonSizes: {
                            width: 750,
                            height: 90
                        }
                    },{
                        text: ce.ADBLOCKER_BUTTON,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    }));
                    return t.position.copyFrom(e),
                    t.interactive = !0,
                    t.onClick((function() {
                        t.interactive = !1,
                        IO()
                    }
                    )),
                    t
                }
                ,
                t.prototype._createTapToContinue = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, r.TimeDelay.after(1e3).promise];
                            case 1:
                                return i.sent(),
                                (t = new fl(ce.EXTRAWORKER_ITEM_BUTTON_NOTNOW)).position.copyFrom(e),
                                this._content.addChild(t),
                                t.interactive = !0,
                                t.on("pointerup", this.close, this),
                                this._inputBlocker.interactive = !0,
                                this._inputBlocker.on("pointerup", this._tryToClose, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr), Ph = 1150, kh = 1e3, xh = {
                width: 500,
                height: 130
            }, Gh = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.priority = _r.HIGH,
                    t._name = "AdsNoConsentPopup",
                    t._inputBlocker.removeAllListeners(),
                    t._createBackground(),
                    t._createHeader(new Xe.Point(0,-425)),
                    t._createText(),
                    t._createButton(),
                    t._createNoThankYou(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createHeader = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 125,
                        fitWidth: 862.5
                    });
                    t.style = vn.lightBoldLarge;
                    var i = new v.Label(De.services.localization.getText(ce.CONSENT_POPUP_HEADER),t);
                    i.anchor.set(.5),
                    i.position.set(e.x, e.y),
                    this._content.addChild(i)
                }
                ,
                t.prototype._createBackground = function() {
                    this._background = new cr(De.services.resource.getTexture(f.POPUP_BG_CONSENT_9SLICE),150,150,150,150),
                    this._background.setSizes({
                        width: Ph,
                        height: kh
                    }),
                    this._background.position.set(-575, -500),
                    this._content.addChild(this._background)
                }
                ,
                t.prototype._createText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 950,
                        fitHeight: 425
                    });
                    e.style = vn.darkMedium,
                    this._mainText = rr(new v.Label(nr(lh || (lh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.CONSENT_POPUP_TEXT),e), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -75
                        }
                    }),
                    this._content.addChild(this._mainText)
                }
                ,
                t.prototype._createButton = function() {
                    var e = this
                      , t = new fr({
                        name: "ConsentButton",
                        buttonIdle: f.BTN_EVENT_GREEN_IDLE,
                        buttonActive: f.BTN_EVENT_GREEN_DOWN,
                        buttonInactive: f.BTN_EVENT_GREEN_IDLE
                    },{
                        buttonSizes: xh,
                        buttonCorners: {
                            leftWidth: 75,
                            topHeight: 70,
                            rightWidth: 75,
                            bottomHeight: 70
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: nr(uh || (uh = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.CONSENT_POPUP_BUTTON),
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    t.position.set(0, this._background.height + this._background.position.y - t.height / 2 - 150),
                    this._content.addChild(t),
                    t.onClick((function() {
                        return e.answerConsent()
                    }
                    ))
                }
                ,
                t.prototype._createNoThankYou = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return (e = new v.LabelSettings({
                                fitHeight: 210,
                                fitWidth: 730,
                                fitToBox: !0
                            })).style = vn.getRegularTextWithOutline({
                                color: vn.colorLight,
                                stroke: vn.colorDark
                            }),
                            (t = rr(new v.Label(nr(dh || (dh = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.CONSENT_REJECT_BUTTON),e), {
                                anchor: {
                                    x: .5,
                                    y: .5
                                }
                            })).position.set(0, 600),
                            this._content.addChild(t),
                            t.interactive = !0,
                            t.once("pointerup", this.close.bind(this), this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.answerConsent = function() {
                    this.close(),
                    this.onClosed.listenOnce((function() {
                        De.services.adsService.showConsentScreen()
                    }
                    ), this)
                }
                ,
                t
            }(yr), Uh = function(e) {
                function t(t, i) {
                    var n = e.call(this, t) || this;
                    return n._placement = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this.dependencies.adsService.onAdStart.listenOnce((function() {
                                    r._onAdStart(r._placement)
                                }
                                ), this),
                                this.dependencies.adsService.onAdFinish.listenOnce((function() {
                                    r._onAdHide(r._placement)
                                }
                                ), this),
                                [4, this.dependencies.adsService.showRewardedAd(this._placement)];
                            case 1:
                                switch (e = n.sent(),
                                t = e.status,
                                i = e.reason,
                                t) {
                                case Fn.VALID:
                                    return [3, 2];
                                case Fn.AD_SKIPPED:
                                    return [3, 3];
                                case Fn.INVALID:
                                    return [3, 4];
                                case Fn.NO_CONSENT:
                                    return [3, 5];
                                case Fn.AD_ERROR:
                                    return [3, 7];
                                case Fn.AD_BLOCK_DETECTED:
                                    return [3, 8];
                                case Fn.FAKE_AD:
                                    return [3, 10]
                                }
                                return [3, 11];
                            case 2:
                                return this.dependencies.adsService.countWatchedAd(),
                                [2, {
                                    result: $_.SUCCESS,
                                    reason: i
                                }];
                            case 3:
                                return [2, {
                                    result: $_.FAIL,
                                    reason: "AD SKIPPED"
                                }];
                            case 4:
                            case 11:
                                return [2, {
                                    result: $_.FAIL,
                                    reason: i
                                }];
                            case 5:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.CONSENT)];
                            case 6:
                                return n.sent(),
                                De.services.navigation.closeTopPopup(),
                                De.services.navigation.showPopup(Gh, {}, !1),
                                [2, {
                                    result: $_.ERROR,
                                    reason: i
                                }];
                            case 7:
                                return De.services.adsService.handleAdError(),
                                [2, {
                                    result: $_.ERROR,
                                    reason: i
                                }];
                            case 8:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.AD_BLOCK)];
                            case 9:
                                return n.sent(),
                                De.services.navigation.showPopup(Bh, {}, !1),
                                [2, {
                                    result: $_.ERROR,
                                    reason: i
                                }];
                            case 10:
                                return [2, new Promise((function(e) {
                                    De.services.navigation.showFakeAdScreen(!1, (function() {
                                        e({
                                            result: $_.SUCCESS,
                                            reason: "SUCCESS"
                                        })
                                    }
                                    ), (function() {
                                        e({
                                            result: $_.FAIL,
                                            reason: "FAKE_AD_CANCELLED"
                                        })
                                    }
                                    ))
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onAdStart = function(e) {
                    De.services.navigation.showSpinnerOverlay(),
                    De.services.analytics.design.rvStarted(e)
                }
                ,
                t.prototype._onAdHide = function(e) {
                    De.services.navigation.clearTransitionLayer()
                }
                ,
                t
            }(rc), Fh = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onClick = function() {
                    De.services.inventory.getInventoryItem(Cn.CRATES).amount <= 0 && this.stateMachine.marketplaceService.openMarketplaceShop(Ua.CRATES),
                    e.prototype._onClick.call(this)
                }
                ,
                t.prototype._cratesUnderLimit = function() {
                    var e = new Vs(this.stateMachine);
                    this.stateMachine.changeStateTo(e)
                }
                ,
                t
            }(Ms), Mh = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.enter = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.stateMachine.changeStateTo(new Fh(this.stateMachine)),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onClick = function() {
                    this.stateMachine.cratesButton.showSpawnCrateButton(),
                    this.stateMachine.cratesButton.onClick((function() {}
                    ))
                }
                ,
                t.prototype._onAmountChanged = function(t) {
                    e.prototype._onAmountChanged.call(this, t),
                    t.current > 0 && (this.stateMachine.changeStateTo(new Vs(this.stateMachine)),
                    De.services.audio.playSoundEffect(m.POPOUT_APPEARS))
                }
                ,
                t.prototype._showRewardVideo = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, new Uh({
                                    adsService: De.services.adsService
                                },"crateButton").execute()];
                            case 1:
                                return e.sent().result !== $_.SUCCESS || De.services.inventory.addAmount(Cn.CRATES, this.stateMachine.adsConfig.RV_REWARDS),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Us), Vh = function() {
                function e() {}
                return e.prototype.getOutOfCrateState = function(e) {
                    return new Ms(e)
                }
                ,
                e
            }(), Hh = function() {
                function e() {}
                return e.prototype.getOutOfCrateState = function(e) {
                    return new Fh(e)
                }
                ,
                e
            }(), jh = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "InviteFriendsPopup",
                    i._popupOptions = t,
                    i._createBackground(),
                    i._createContent(i._popupOptions.amount),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.hideContent = function() {
                    this._content.visible = !1
                }
                ,
                t.prototype.show = function(e) {
                    var t = this;
                    this._inviteButton.onClick((function() {
                        t._popupOptions.onInviteClick()
                    }
                    )),
                    this._background.onCloseClick((function() {
                        t._popupOptions.onCloseClick()
                    }
                    )),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1
                }
                ,
                t.prototype._tryToClose = function() {}
                ,
                t.prototype._createBackground = function() {
                    this._background = new Ar({
                        size: {
                            width: 1e3,
                            height: 1200
                        },
                        headerSize: {
                            width: 666.6666666666666,
                            height: 90
                        },
                        headerText: ce.CREATES_FOR_FRIENDS_HEADER,
                        headerStyle: vn.popupTitle
                    }),
                    this._content.addChild(this._background)
                }
                ,
                t.prototype._createContent = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 950
                    });
                    t.style = vn.darkMedium;
                    var i = rr(new v.Label(nr(hh || (hh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.CRATES_FOR_FRIENDS_SUBHEADER),t), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -425
                        }
                    })
                      , r = rr(De.services.resource.getSprite(f.ICON_INVITEFRIENDS_CRATES), {
                        position: {
                            x: 0,
                            y: -50
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })
                      , o = rr(De.services.resource.getSprite(f.OVERLAY_INVITEFRIENDS_CRATES), {
                        position: {
                            x: -285,
                            y: r.y + 210
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    });
                    o.addChild(rr(new Xe.Text("+" + e,vn.lightLarge), {
                        position: {
                            x: 0,
                            y: 0
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    this._inviteButton = new fr({
                        name: "cratesForFriends",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 375,
                            height: 125
                        }
                    },{
                        text: ce.CRATES_FOR_FRIENDS_BUTTON,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    }),
                    this._inviteButton.position.set(0, 400),
                    t.style = vn.darkTiny;
                    var a = rr(new v.Label(nr(ph || (ph = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.CRATES_FOR_FRIENDS_DESCRIPTION, "+" + e),t), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 525
                        }
                    });
                    this._content.addChild(i, r, o, this._inviteButton, a)
                }
                ,
                t
            }(yr), Kh = (function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                (0,
                n.__extends)(t, e),
                t.prototype.enter = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._getShareImage(),
                            e.prototype.enter.call(this),
                            this.stateMachine.cratesButton.showTimeIndicator(),
                            this.stateMachine.updateTimeIndicator(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onClick = function() {
                    this._openPopup()
                }
                ,
                t.prototype._onAmountChanged = function(t) {
                    e.prototype._onAmountChanged.call(this, t),
                    t.current > 0 && this.stateMachine.changeStateTo(new Vs(this.stateMachine))
                }
                ,
                t.prototype._openPopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.lazyLoad.getLoadingPromise(hn.FRIENDS_FOR_CRATES)];
                            case 1:
                                return t.sent(),
                                De.services.analytics.design.friendsForCratesPopupStatus("appear"),
                                e = this,
                                [4, De.services.navigation.showPopup(jh, {
                                    onInviteClick: nc(this._onInviteClicked.bind(this)),
                                    onCloseClick: this._onClosePopup.bind(this),
                                    amount: this.stateMachine.inviteFriendsConfig.INVITE_FRIENDS_REWARD
                                })];
                            case 2:
                                return e._inviteFriendsPopup = t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onInviteClicked = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return De.services.analytics.design.friendsForCratesPopupStatus("button_invite"),
                                this._inviteFriendsPopup.hideContent(),
                                [4, this.sendCustomShare()];
                            case 1:
                                return e.sent(),
                                this._onClosePopup(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onClosePopup = function() {
                    De.services.analytics.design.friendsForCratesPopupStatus("close"),
                    nc((function() {
                        return De.services.friends.countFriendInvitation(De.services.timer.currentTime)
                    }
                    ))(),
                    this._inviteFriendsPopup.close(),
                    this._checkAndGoToAState()
                }
                ,
                t.prototype._checkAndGoToAState = function() {
                    this.stateMachine.dependencies.crateInventory.amount > 0 ? this.stateMachine.changeStateTo(new Vs(this.stateMachine)) : this.stateMachine.changeStateTo(new Mh(this.stateMachine))
                }
                ,
                t.prototype.sendCustomShare = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.token.getTokenForInvitingFriends()];
                            case 1:
                                return e = t.sent(),
                                [4, vp.platform.customShare.cratesForFriends({
                                    rewardToken: e,
                                    image: De.services.imageExtract.fromPixiToBase64(this._shareImage)
                                })];
                            case 2:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getShareImage = function() {
                    var e = this;
                    De.services.lazyLoad.getLoadingPromise(hn.CUSTOM_SHARE).then((function() {
                        var t = De.services.resource.getSprite(f.CS_INVITATION)
                          , i = t.addChild(De.services.friends.fetchOwnProfile().getPhoto());
                        i.width = 168,
                        i.height = 168,
                        i.position.set(120, 122),
                        e._shareImage = t
                    }
                    ))
                }
            }(Us),
            function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "discovery",
                        buttonIdle: f.BTN_HUD_DEFAULT_IDLE,
                        buttonActive: f.BTN_HUD_DEFAULT_DOWN,
                        targetPressedScale: 1.316
                    }) || this;
                    return i.addContent(rr(De.services.resource.getSprite(f.ICON_BUTTON_HUD_COLLECTIONBOOK), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    i._discoveryService = De.services.discovery,
                    i._setNotificationIcon(),
                    i._discoveryService.newUnclaimedDiscoveryFound.addListener(i._updateNotificationState, i),
                    i._discoveryService.onDiscoveryClaimed.addListener(i._updateNotificationState, i),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    De.services.discovery.newUnclaimedDiscoveryFound.removeListener(this._updateNotificationState, this),
                    De.services.discovery.onDiscoveryClaimed.removeListener(this._updateNotificationState, this)
                }
                ,
                t.prototype._setNotificationIcon = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._notificationIcon = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                                this._notificationIcon.position.set(this.width / 3, -this.height / 3),
                                this.addChild(this._notificationIcon),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return e.sent(),
                                this._updateNotificationState(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateNotificationState = function() {
                    this._notificationIcon.visible = !1,
                    De.services.discovery.hasUnclaimedDiscoveries() && (this._notificationIcon.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                    this._notificationIcon.visible = !0,
                    De.services.analytics.design.reportDiscoveryDiaryExclamationMarkShown())
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    this.onClick((function() {
                        e.services.interactionService.canInteractWithHUD() && (De.services.discovery.openDiscoveryPopup(e.services.upgradeCard),
                        e.events.hudElementClicked.fire())
                    }
                    ))
                }
                ,
                t
            }(hr)), Wh = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._createVisuals(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.playAppear = function() {
                    var e = this;
                    return this.scale.set(0),
                    new Promise((function(t) {
                        lr.gsap.to(e.scale, {
                            x: 1,
                            y: 1,
                            ease: "back.out",
                            duration: .5,
                            onComplete: t
                        })
                    }
                    ))
                }
                ,
                t.prototype.playDisappear = function() {
                    var e = this;
                    return new Promise((function(t) {
                        lr.gsap.to(e, {
                            alpha: 0,
                            ease: "power1.in",
                            duration: .333,
                            onComplete: function() {
                                var i;
                                null === (i = e.parent) || void 0 === i || i.removeChild(e),
                                t()
                            }
                        })
                    }
                    ))
                }
                ,
                t.prototype._createVisuals = function(e) {
                    var t = new cr(De.services.resource.getTexture(f.POPUP_BALLOON_ORDERTRACKING_9SLICE),48,1,16,1);
                    t.anchor.set(0, .5),
                    this.addChild(t);
                    var i = new Xe.Text(nr(vh || (vh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), e.text),vn.darkSmall);
                    i.anchor.set(.5),
                    this.addChild(i);
                    var r = i.width + 60;
                    if (e.icon) {
                        var o = this.addChild(De.services.resource.getSprite(e.icon));
                        o.anchor.set(.5),
                        r += o.width + 30,
                        r = Math.max(400, r),
                        i.x = 32 + r / 2 + (o.width + 30) / 2,
                        o.x = 32 + r / 2 - (i.width + 30) / 2
                    } else
                        r = Math.max(400, r),
                        i.x = 32 + r / 2;
                    t.setSizes({
                        width: r + 32,
                        height: 112
                    })
                }
                ,
                t
            }(Xe.Container), zh = function(e) {
                function t(t) {
                    var i = this
                      , n = De.services.resource.getTexture(f.OVERLAY_LEFT_BUTTONBACKGROUND)
                      , r = new cr(n,1,n.height / 2,n.width - 1,n.height / 2);
                    return r.width = 200,
                    r.anchor.set(.5),
                    r.position.set(-15, 0),
                    (i = e.call(this, {
                        name: "extraWorker",
                        buttonIdle: f.BTN_HUD_DEFAULT_IDLE,
                        buttonActive: f.BTN_HUD_DEFAULT_DOWN,
                        targetPressedScale: 1.316,
                        backdropContent: [r],
                        uiHeight: 200
                    }) || this)._notification = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    i.addContent(rr(De.services.resource.getSprite(f.ICON_BUTTON_HUD_WORKER), {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    i._gameWorkersService = t.services.gameWorkers,
                    i._createPillbox(),
                    i._createFamilies(t.services.world),
                    i._notification.position.set(i.width / 4 - 7, -i.height / 4.5 + 10),
                    i.addChild(i._notification),
                    i._updateButtonVisuals(),
                    i._gameWorkersService.onWorkersStateChanged.addListener(i._updateButtonVisuals, i),
                    i._gameWorkersService.onWorkerRemoved.addListener(i._updateButtonVisuals, i),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    this._workerFamily.onGameObjectAdded.removeListener(this._updateButtonVisuals, this),
                    this._gameWorkersService.onWorkersStateChanged.removeListener(this._updateButtonVisuals, this),
                    this._gameWorkersService.onWorkerRemoved.removeListener(this._updateButtonVisuals, this),
                    this._lootableFamily.onGameObjectAdded.removeListener(this._updateButtonVisuals, this),
                    this._lootableFamily.onGameObjectRemoved.removeListener(this._updateButtonVisuals, this),
                    this._mapSourceFamily.onGameObjectAdded.removeListener(this._updateButtonVisuals, this)
                }
                ,
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.buttonClicked = function() {
                    if (this._gameWorkersService.hasEnoughWorkers(1))
                        return this._lootableFamily.getGameObjects().length <= 0 ? this._mapSourceFamily.getGameObjects().length > 0 && this._someMapSourceObjectsDontHaveWorkers() ? void this._animateToMapSourceAndShowArrows() : (this._gameWorkersService.showNoAvailableWorkFloater(),
                        void this._hideNotification()) : void this._gameWorkersService.animateToLootableSourceObject();
                    this._gameWorkersService.openExtraWorkerPopup()
                }
                ,
                t.prototype._animateToMapSourceAndShowArrows = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._gameWorkersService.animateToMapSourceAndShowArrows()];
                            case 1:
                                return e.sent(),
                                this._hideNotification(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._someMapSourceObjectsDontHaveWorkers = function() {
                    return this._mapSourceFamily.getGameObjects().some((function(e) {
                        return !e.hasBehavior(Ke.WorkerData)
                    }
                    ))
                }
                ,
                t.prototype._createFamilies = function(e) {
                    this._workerFamily = new __(e,new c_([Ke.WorkerData, Ke.CoolDown, Ke.GridPosition])),
                    this._lootableFamily = new __(e,new c_([Ke.Lootable, Ke.GridPosition, Ke.InteractionPriorityTurn, Ke.MapSource])),
                    this._mapSourceFamily = new __(e,new c_([Ke.MapSource])),
                    this._workerFamily.onGameObjectAdded.addListener(this._updateButtonVisuals, this),
                    this._lootableFamily.onGameObjectAdded.addListener(this._updateButtonVisuals, this),
                    this._lootableFamily.onGameObjectRemoved.addListener(this._updateButtonVisuals, this),
                    this._mapSourceFamily.onGameObjectAdded.addListener(this._updateButtonVisuals, this)
                }
                ,
                t.prototype._createPillbox = function() {
                    var e = this._gameWorkersService.getTotalFreeWorkers + "/" + this._gameWorkersService.workerAmount;
                    this._pillboxText = new Xe.Text(String(e),vn.darkSmall),
                    this._pillboxText.anchor.set(.5),
                    this._pillboxText.position.set(0, 0),
                    this._pillBox = De.services.resource.getSprite(f.BG_TASKS_PILL),
                    this._pillBox.position.set(0, 75),
                    this._pillBox.anchor.set(.5),
                    this.addContent(this._pillBox),
                    this._pillBox.addChild(this._pillboxText)
                }
                ,
                t.prototype._showTextFeedback = function(e, t) {
                    var i = this.addChild(new Wh({
                        text: e,
                        icon: t
                    }));
                    i.x = 100,
                    i.playAppear().then((function() {
                        return r.TimeDelay.after(1500).promise
                    }
                    )).then((function() {
                        return i.playDisappear()
                    }
                    ))
                }
                ,
                t.prototype._updateButtonVisuals = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return e.sent(),
                                this._lootableFamily.getGameObjects().length > 0 ? (this._showNotification(!0),
                                this._showTextFeedback(ce.WORKER_BUTTON_JOB_DONE, f.ICON_ORDERTRACKING_CHECKMARK)) : this._gameWorkersService.hasEnoughWorkers(1) && this._someMapSourceObjectsDontHaveWorkers() ? (this._showNotification(!1),
                                this._showTextFeedback(ce.WORKER_BUTTON_AVAILABLE)) : this._hideNotification(),
                                this._updatePillboxText(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._hideNotification = function() {
                    this._lootableFamily.getGameObjects().length > 0 || ge(this._notification) || (this._notification.visible = !1)
                }
                ,
                t.prototype._showNotification = function(e) {
                    this._notification.state.setAnimation(0, e ? V.NOTIFICATION_CHECKMARK : V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                    this._notification.visible = !0
                }
                ,
                t.prototype._updatePillboxText = function() {
                    this._pillboxText.text = this._gameWorkersService.getTotalFreeWorkers + "/" + this._gameWorkersService.workerAmount
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    var t = this;
                    this.onClick((function() {
                        e.services.interactionService.canInteractWithHUD() && (t.buttonClicked(),
                        e.events.hudElementClicked.fire())
                    }
                    ))
                }
                ,
                t
            }(hr), Yh = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "feedback",
                        buttonIdle: f.BTN_FEEDBACK,
                        buttonActive: f.BTN_HUD_SMALL_FEEDBACK_DOWN
                    }) || this;
                    if (i._notificationIcon = null,
                    !De.services.userFeedback.hasSeenFeedbackForm()) {
                        var n = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION);
                        n.position.set(-40, -14),
                        n.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !0),
                        i.addChild(n),
                        i._notificationIcon = n
                    }
                    return i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.dismissNotification = function() {
                    this._notificationIcon && (this._notificationIcon.visible = !1)
                }
                ,
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t)
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    var t = this;
                    this.onClick((function() {
                        De.services.userFeedback.openFeedbackDialog(),
                        t.dismissNotification(),
                        e.events.hudElementClicked.fire()
                    }
                    ))
                }
                ,
                t
            }(hr), Jh = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "marketplace",
                        buttonIdle: f.BTN_HUD_DEFAULT_IDLE,
                        buttonActive: f.BTN_HUD_DEFAULT_DOWN,
                        targetPressedScale: 1.316
                    }) || this;
                    return i._shopToFocus = Ua.CRATES,
                    i.addContent(rr(De.services.resource.getSprite(f.ICON_BUTTON_HUD_MARKETPLACE), {
                        position: {
                            x: 20,
                            y: -25
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.showBlackFridayVisuals = function() {
                    this._eventContainer = new Xe.Container,
                    this._eventContainer.addChild(rr(De.services.resource.getSprite(f.HUD_ICON_BANNER), {
                        position: {
                            x: 150,
                            y: 0
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    this._eventContainer.addChild(rr(De.services.resource.getSprite(f.ICON_BUTTON_HUD_MARKETPLACE), {
                        position: {
                            x: 20,
                            y: -25
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    this._eventContainer.addChild(rr(De.services.resource.getSprite(f.HUD_ICON_PERCENTAGE), {
                        position: {
                            x: 70,
                            y: -67.5
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    this.addContent(this._eventContainer)
                }
                ,
                t.prototype.hideEventVisuals = function() {
                    this._eventContainer && (this.removeContent(this._eventContainer),
                    this._eventContainer.destroy(),
                    this._eventContainer = void 0)
                }
                ,
                t.prototype.showChristmasDealsVisuals = function() {
                    this._eventContainer = new Xe.Container,
                    this._eventContainer.addChild(rr(De.services.resource.getSprite(f.CHRISTMAS_DEALS_HUD_ICON_BANNER), {
                        position: {
                            x: 150,
                            y: 0
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    this._eventContainer.addChild(rr(De.services.resource.getSprite(f.ICON_BUTTON_HUD_MARKETPLACE), {
                        position: {
                            x: 20,
                            y: -25
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    this._eventContainer.addChild(rr(De.services.resource.getSprite(f.CHRISTMAS_DEALS_HUD_ICON_PERCENTAGE), {
                        position: {
                            x: 70,
                            y: -67.5
                        },
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })),
                    this.addContent(this._eventContainer)
                }
                ,
                t.prototype.setShopToFocus = function(e) {
                    this._shopToFocus = e
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    var t = this;
                    this.onClick((function() {
                        e.services.interactionService.canInteractWithHUD() && (e.services.marketplaceService.openMarketplaceShop(t._shopToFocus),
                        e.events.hudElementClicked.fire())
                    }
                    ))
                }
                ,
                t
            }(hr), Xh = 90, qh = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "SettingsPopup",
                    i._localStorageTokenKey = "StandaloneNakamaUserToken",
                    i._soundIcons = [f.ICON_BTN_SOUND_ON, f.ICON_BTN_SOUND_OFF],
                    i._musicIcons = [f.ICON_BTN_MUSIC_ON, f.ICON_BTN_MUSIC_OFF],
                    i._flagsConfig = i._initializeFlagsConfig(),
                    De.services.localization.onLanguageChanged.addListener(i._onLanguageChanged, i),
                    i._addContent(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.lazyLoad.loadAllFonts(!0)];
                            case 1:
                                return t.sent(),
                                e(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerdown", this._tryToClose, this),
                    this._playerID.interactive = !1,
                    this._playerID.off("pointertap", this._copyPlayerID, this),
                    De.services.localization.onLanguageChanged.removeListener(this._onLanguageChanged, this)
                }
                ,
                t.prototype._addContent = function() {
                    var e = new Xe.Container
                      , t = 0
                      , i = this._createAudioSettings([0, t]);
                    e.addChild(i),
                    t += i.height + 25,
                    this._languageButton = this._createLanguageButton([0, t + 45]),
                    e.addChild(this._languageButton),
                    t += this._languageButton.height + 25,
                    this._policyButton = this._createPolicyButton([0, t + 45]),
                    e.addChild(this._policyButton),
                    t += this._policyButton.height + 25;
                    var n = this._createGameInfoLabels([0, t]);
                    e.addChild(n),
                    this._backGround = this._createBackground(e.height + 50),
                    e.position.set(0, -this._backGround.height / 2 + 100 + 25),
                    this._content.addChild(this._backGround, e)
                }
                ,
                t.prototype._createBackground = function(e) {
                    var t = new Ar({
                        size: {
                            width: 850,
                            height: e + 100
                        },
                        headerSize: {
                            width: 566.6666666666666,
                            height: 100
                        },
                        headerText: ce.SETTINGS_POPUP,
                        headerStyle: vn.popupTitle,
                        headerIcon: f.ICON_POPUP_HEADER_SETTINGS
                    });
                    return t.onCloseClick(this.close.bind(this)),
                    t
                }
                ,
                t.prototype._createAudioSettings = function(e) {
                    var t = e[0]
                      , i = e[1]
                      , r = new Xe.Container;
                    r.position.set(t, i);
                    var o = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: 300
                    });
                    o.style = vn.darkMedium;
                    var a = 0;
                    return this._soundTitle = new v.Label(nr(gh || (gh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.SETTINGS_SOUNDS),o),
                    this._soundTitle.anchor.set(.5, 0),
                    this._soundTitle.position.set(-200, a),
                    this._musicTitle = new v.Label(nr(fh || (fh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.SETTINGS_MUSIC),o),
                    this._musicTitle.anchor.set(.5, 0),
                    this._musicTitle.position.set(200, a),
                    a += this._soundTitle.height + 25 + 45,
                    this._soundButton = this._getIconButton("toggleSound", De.services.audio.isSoundEnabled, this._soundIcons),
                    this._soundButton.position.set(-200, a),
                    this._soundButton.onClick(this._onSoundFXButtonClicked.bind(this)),
                    this._musicButton = this._getIconButton("toggleMusic", De.services.audio.isMusicEnabled, this._musicIcons),
                    this._musicButton.position.set(200, a),
                    this._musicButton.onClick(this._onMusicButtonClicked.bind(this)),
                    r.addChild(this._soundTitle, this._musicTitle, this._soundButton, this._musicButton),
                    r
                }
                ,
                t.prototype._createLanguageButton = function(e) {
                    var t = e[0]
                      , i = e[1]
                      , n = this._getLanguageButton(this._getLanguageIcon());
                    return n.position.set(t, i),
                    n.onClick(this._onLanguageButtonClicked),
                    n
                }
                ,
                t.prototype._createAccountAccessButtons = function(e) {
                    var t = e[0]
                      , i = e[1];
                    return vp.platform.loginStrategy.isUserLoggedIn() ? this._createLogoutButton([t, i]) : this._createLoginButton([t, i])
                }
                ,
                t.prototype._createLogoutButton = function(e) {
                    var t = e[0]
                      , i = e[1]
                      , n = this._getRedTextButton("logout", ce.LOGOUT);
                    return n.position.set(t, i),
                    n.onClick(this._onLogoutButtonClicked.bind(this)),
                    n
                }
                ,
                t.prototype._createLoginButton = function(e) {
                    var t = e[0]
                      , i = e[1]
                      , n = this._getBlueTextButton("login", ce.LOGIN);
                    return n.position.set(t, i),
                    n.onClick(this._onLoginButtonClicked),
                    n
                }
                ,
                t.prototype._createServiceButton = function(e) {
                    var t = e[0]
                      , i = e[1]
                      , n = this._getBlueTextButton("ToS", ce.TERMS_OF_SERVICE);
                    return n.position.set(t, i),
                    n.onClick(this._onServiceButtonClicked),
                    n
                }
                ,
                t.prototype._createPolicyButton = function(e) {
                    var t = e[0]
                      , i = e[1]
                      , n = this._getBlueTextButton("policy", ce.PRIVACY_POLICY);
                    return n.position.set(t, i),
                    n.onClick(this._onPolicyButtonClicked),
                    n
                }
                ,
                t.prototype._createGameInfoLabels = function(e) {
                    var t = e[0]
                      , i = e[1]
                      , r = new Xe.Container;
                    r.position.set(t, i);
                    var o = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 90,
                        fitWidth: 700
                    });
                    o.style = vn.greySmall;
                    var a = De.services.friends.fetchOwnProfile();
                    return this._playerID = new v.Label(nr(Eh || (Eh = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.PLAYER_ID, "".concat(a.name, "#").concat(a.platformId)),o),
                    this._playerID.anchor.set(.5, 0),
                    this._playerID.interactive = !0,
                    this._playerID.on("pointertap", this._onPlayerIdTextClicked, this),
                    this._publisher = new v.Label(nr(mh || (mh = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.COOLGAMES, 2022),o),
                    this._publisher.anchor.set(.5, 0),
                    this._publisher.position.set(t, this._playerID.y + this._playerID.height + 10),
                    this._gameVersion = new v.Label(nr(yh || (yh = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.GAME_VERSION, " 1.46.0-1"),o),
                    this._gameVersion.anchor.set(.5, 0),
                    Un(),
                    this._gameVersion.position.set(t, this._publisher.y + this._publisher.height + 10),
                    r.addChild(this._playerID, this._publisher, this._gameVersion),
                    r
                }
                ,
                t.prototype._initializeFlagsConfig = function() {
                    var e = De.services.resource.getJsonCopy(_e.LOCALIZATION_FLAGS_CONFIG)
                      , t = {};
                    return Object.keys(e).forEach((function(i) {
                        t[i.toLocaleLowerCase()] = e[i]
                    }
                    )),
                    t
                }
                ,
                t.prototype._switchSoundIcon = function(e, t, i) {
                    var n = e ? De.services.audio.isSoundEnabled : De.services.audio.isMusicEnabled;
                    e ? De.services.analytics.design.reportSoundFxTriggered(n ? "on" : "off") : De.services.analytics.design.reportMusicFxTriggered(n ? "on" : "off");
                    var r = n ? f.BTN_DEFAULT_GREEN_IDLE : f.BTN_DEFAULT_ORANGE_IDLE
                      , o = n ? f.BTN_DEFAULT_GREEN_ACTIVE : f.BTN_DEFAULT_ORANGE_ACTIVE;
                    t.updateButtonTexture(r, o),
                    t.updateIcon(n ? i[0] : i[1]),
                    t.updateText(n ? ce.SOUND_ON : ce.SOUND_OFF)
                }
                ,
                t.prototype._getIconButton = function(e, t, i) {
                    return new uc({
                        name: e,
                        buttonIdle: t ? f.BTN_DEFAULT_GREEN_IDLE : f.BTN_DEFAULT_ORANGE_IDLE,
                        buttonActive: t ? f.BTN_DEFAULT_GREEN_ACTIVE : f.BTN_DEFAULT_ORANGE_ACTIVE
                    },{
                        buttonSizes: {
                            width: 350,
                            height: Xh
                        }
                    },{
                        text: t ? ce.SOUND_ON : ce.SOUND_OFF,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        },
                        fitBoxSizes: {
                            width: 175,
                            height: Xh
                        }
                    },{
                        iconImage: t ? i[0] : i[1],
                        iconPosition: {
                            x: -122.5,
                            y: -5
                        }
                    })
                }
                ,
                t.prototype._getLanguageButton = function(e) {
                    return new uc({
                        name: "toggleLanguage",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 750,
                            height: Xh
                        }
                    },{
                        text: ce.CURRENT_LANGUAGE,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        },
                        fitBoxSizes: {
                            width: 650,
                            height: Xh
                        }
                    },{
                        iconImage: e,
                        iconPosition: {
                            x: -325,
                            y: -5
                        }
                    })
                }
                ,
                t.prototype._getLanguageIcon = function() {
                    return {
                        alias: this._flagsConfig[De.services.localization.getLanguage().alias.toLocaleLowerCase()]
                    }
                }
                ,
                t.prototype._getBlueTextButton = function(e, t) {
                    return new fr({
                        name: e,
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE
                    },{
                        buttonSizes: {
                            width: 750,
                            height: Xh
                        }
                    },{
                        text: t,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })
                }
                ,
                t.prototype._getRedTextButton = function(e, t) {
                    return new fr({
                        name: e,
                        buttonIdle: f.BTN_DEFAULT_RED_IDLE,
                        buttonActive: f.BTN_DEFAULT_RED_ACTIVE
                    },{
                        buttonSizes: {
                            width: 750,
                            height: Xh
                        }
                    },{
                        text: t,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })
                }
                ,
                t.prototype._onMusicButtonClicked = function() {
                    De.services.audio.toggleMusic(),
                    this._switchSoundIcon(!1, this._musicButton, this._musicIcons)
                }
                ,
                t.prototype._onSoundFXButtonClicked = function() {
                    De.services.audio.toggleSounds(),
                    this._switchSoundIcon(!0, this._soundButton, this._soundIcons)
                }
                ,
                t.prototype._onLanguageButtonClicked = function() {
                    De.services.localization.switchToNextLanguage()
                }
                ,
                t.prototype._onLogoutButtonClicked = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return vp.platform.initializePlatform.clearLastLoggedInData(),
                            this._logger.warn("Logging out user!"),
                            s.dK.clear(),
                            location.reload(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onLoginButtonClicked = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return vp.platform.loginStrategy.attemptLogin().then((function(e) {
                                e === be.SUCCESS && IO()
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onPolicyButtonClicked = function() {
                    vp.platform.customShare.openExternalLink("https://www.coolgames.com/privacy-policy"),
                    De.services.audio.playSoundEffect(m.BUTTON_TAP)
                }
                ,
                t.prototype._onServiceButtonClicked = function() {
                    De.services.audio.playSoundEffect(m.BUTTON_TAP)
                }
                ,
                t.prototype._onPlayerIdTextClicked = function() {
                    this._copyPlayerID()
                }
                ,
                t.prototype._copyPlayerID = function() {
                    var e = document.createElement("input");
                    try {
                        e.setAttribute("value", De.services.friends.fetchOwnProfile().platformId),
                        document.body.appendChild(e),
                        e.select(),
                        document.execCommand("copy")
                    } catch (e) {
                        this._logger.warn(e),
                        this._logger.warn("your player id is ".concat(De.services.friends.fetchOwnProfile().platformId))
                    }
                    document.body.removeChild(e)
                }
                ,
                t.prototype._onLanguageChanged = function() {
                    this._soundTitle.text = nr(Th || (Th = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.SETTINGS_SOUNDS),
                    this._musicTitle.text = nr(Ah || (Ah = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.SETTINGS_MUSIC),
                    this._playerID.text = nr(Ch || (Ch = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.PLAYER_ID, De.services.friends.fetchOwnProfile().platformId),
                    this._gameVersion.text = nr(Ih || (Ih = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.GAME_VERSION, " 1.46.0-1"),
                    this._soundTitle.style.fontFamily = vn.currentFontFamily,
                    this._musicTitle.style.fontFamily = vn.currentFontFamily,
                    this._playerID.style.fontFamily = vn.currentFontFamily,
                    this._gameVersion.style.fontFamily = vn.currentFontFamily,
                    Un(),
                    this._soundButton.updateText(ce.SOUND_ON),
                    this._musicButton.updateText(ce.SOUND_ON),
                    this._languageButton.updateText(ce.CURRENT_LANGUAGE),
                    this._languageButton.updateIcon(this._getLanguageIcon()),
                    this._backGround.updateHeaderText(nr(Sh || (Sh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.SETTINGS_POPUP)),
                    this._soundButton.updateTextStyle({
                        fontFamily: vn.currentFontFamily
                    }),
                    this._musicButton.updateTextStyle({
                        fontFamily: vn.currentFontFamily
                    }),
                    this._languageButton.updateTextStyle({
                        fontFamily: vn.currentFontFamily
                    }),
                    this._backGround.updateHeaderTextStyle({
                        fontFamily: vn.currentFontFamily
                    })
                }
                ,
                t
            }(yr), Qh = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "settings",
                        buttonIdle: f.BTN_SETTINGS,
                        buttonActive: f.BTN_HUD_SMALL_SETTINGS_DOWN
                    }) || this;
                    return i._dependencies = t,
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype._addOnClickBehavior = function(e) {
                    var t = this;
                    this.onClick((function() {
                        t._dependencies.services.interactionService.canInteractWithHUD() && (De.services.lazyLoad.prioritizeGroup(hn.SETTINGS_POPUP).then((function() {
                            return De.services.navigation.showPopup(qh, {})
                        }
                        )),
                        e.events.hudElementClicked.fire())
                    }
                    ))
                }
                ,
                t
            }(hr), Zh = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "shovel",
                        buttonIdle: f.BTN_SHOVEL,
                        buttonActive: f.BTN_HUD_SMALL_SHOVEL_DOWN
                    }) || this;
                    return i.events = {
                        shovelStart: new r.Event,
                        shovelPress: new r.Event,
                        shovelEnd: new r.Event,
                        shovelMove: new r.Event
                    },
                    i._isPointerDown = !1,
                    i._isShovelActive = !1,
                    i._pointerOrigin = null,
                    i._activationRadius = 50,
                    i.onClick((function() {}
                    )),
                    i._shovelButtonClicked = t.events.hudElementClicked,
                    i._interactionService = t.services.interactionService,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function(t) {
                    for (var i in e.prototype.destroy.call(this, t),
                    this.events)
                        this.events[i].removeAllListeners()
                }
                ,
                t.prototype.onClick = function(t) {
                    e.prototype.onClick.call(this, t),
                    this.on("pointerdown", this._onShovelActivation, this),
                    this.on("pointerup", this._onInteractionCancel, this),
                    this.on("pointerupoutside", this._onInteractionCancel, this),
                    this.on("pointermove", this._onDrag, this)
                }
                ,
                t.prototype._reset = function() {
                    this._isShovelActive = !1,
                    this._isPointerDown = !1
                }
                ,
                t.prototype._onShovelActivation = function(e) {
                    e.target === this && this._interactionService.canInteractWithHUD() && (this._shovelButtonClicked.fire(),
                    this._isPointerDown = !0,
                    this._pointerOrigin = e.data.global.clone())
                }
                ,
                t.prototype._onDrag = function(e) {
                    this._isPointerDown && this._pointerOrigin && !this._isShovelActive && v.Vector2.fromPoint(e.data.global).distance(this._pointerOrigin) >= this._activationRadius && (this._isShovelActive = !0,
                    this.events.shovelStart.fire()),
                    this._isShovelActive && this.events.shovelMove.fire(e)
                }
                ,
                t.prototype._onInteractionCancel = function(e) {
                    this._isPointerDown && (e.target !== this || this._isShovelActive ? this.events.shovelEnd.fire() : this.events.shovelPress.fire(),
                    this._reset())
                }
                ,
                t
            }(hr), $h = function(e) {
                function t(t) {
                    var i = this
                      , n = De.services.resource.getTexture(f.OVERLAY_LEFT_BUTTONBACKGROUND)
                      , r = new cr(n,1,n.height / 2,n.width - 1,n.height / 2);
                    return r.width = 200,
                    r.scale.set(-1, 1),
                    r.anchor.set(.5),
                    r.position.set(11.5, 0),
                    (i = e.call(this, {
                        name: "storage",
                        buttonIdle: f.BTN_HUD_DEFAULT_IDLE,
                        buttonActive: f.BTN_HUD_DEFAULT_DOWN,
                        targetPressedScale: 1.316,
                        backdropContent: [r],
                        uiHeight: 200
                    }) || this).addContent(rr(De.services.resource.getSprite(f.ICON_BUTTON_HUD_STORAGE), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 7.5,
                            y: 0
                        }
                    })),
                    i._storageService = t.services.storage,
                    i._storageService.hasSeenOnboarding() || i._setNotificationIcon(),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return this._storageService.canShowButton()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype._addOnClickBehavior = function(e) {
                    var t = this;
                    this.onClick((function() {
                        var i;
                        e.services.interactionService.canInteractWithHUD() && (t._storageService.hasSeenOnboarding() ? t._storageService.openStoragePopup() : (t._storageService.openOnboardingPopup(!0),
                        null === (i = t._notificationIcon) || void 0 === i || i.destroy()),
                        e.events.hudElementClicked.fire())
                    }
                    ))
                }
                ,
                t.prototype._setNotificationIcon = function() {
                    this._notificationIcon = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    this._notificationIcon.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                    this._notificationIcon.position.set(this.width / 3, -this.height / 3),
                    this.addChild(this._notificationIcon)
                }
                ,
                t
            }(hr), ep = function(e) {
                function t(t) {
                    var i = this
                      , n = De.services.resource.getTexture(f.OVERLAY_LEFT_BUTTONBACKGROUND)
                      , r = new cr(n,1,n.height / 2,n.width - 1,n.height / 2);
                    return r.width = 200,
                    r.anchor.set(.5),
                    r.position.set(-15, 0),
                    (i = e.call(this, {
                        name: "task",
                        buttonIdle: f.BTN_HUD_TASKS_IDLE,
                        buttonActive: f.BTN_HUD_TASKS_DOWN,
                        targetPressedScale: 1.316,
                        backdropContent: [r],
                        uiHeight: 200
                    }) || this)._taskService = De.services.tasks,
                    i._createProgressLabel(),
                    i._taskService.trackedTask && (i._currentTask = i._taskService.trackedTask,
                    i._updateTaskIcon(i._currentTask),
                    i._updateProgressLabel(i._currentTask),
                    i._addTaskListeners()),
                    i._taskService.onNewTaskTracked.addListener(i._onNewTaskTracked, i),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !(0,
                        r.isUndefined)(this._taskService.trackedTask)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function(t) {
                    this._removeTaskListeners(),
                    this._taskService.onNewTaskTracked.removeListener(this._onNewTaskTracked, this),
                    e.prototype.destroy.call(this, t)
                }
                ,
                t.prototype._createProgressLabel = function() {
                    this._progressLabel = new Xe.Text(String("0/0"),vn.darkSmall),
                    this._progressLabel.anchor.set(.5),
                    this._progressLabel.position.set(0, 0),
                    this._pillBox = De.services.resource.getSprite(f.BG_TASKS_PILL),
                    this._pillBox.position.set(0, 75),
                    this._pillBox.anchor.set(.5),
                    this.addContent(this._pillBox),
                    this._pillBox.addChild(this._progressLabel)
                }
                ,
                t.prototype._onTrackedTaskCompleted = function(e) {
                    e.onUpdated.removeListener(this._updateProgressLabel, this),
                    e.onCompleted.removeListener(this._onTrackedTaskCompleted, this),
                    this._updateProgressLabel(e)
                }
                ,
                t.prototype._updateTaskIcon = function(e) {
                    this._taskIcon && this.removeContent(this._taskIcon),
                    this._taskIcon = e.getVisual();
                    var t = Math.min((this.buttonContainer.width - 60) / this._taskIcon.width, (this.buttonContainer.height - 60) / this._taskIcon.height);
                    this._taskIcon.scale.set(t),
                    this.addContent(this._taskIcon)
                }
                ,
                t.prototype._updateProgressLabel = function(e) {
                    this._progressLabel.text = "".concat(e.goal.currentValue, "/").concat(e.goal.targetValue)
                }
                ,
                t.prototype._onNewTaskTracked = function(e) {
                    this._currentTask && this._removeTaskListeners(),
                    this._currentTask = e,
                    this._currentTask && (this._updateTaskIcon(this._currentTask),
                    this._updateProgressLabel(this._currentTask),
                    this._addTaskListeners())
                }
                ,
                t.prototype._removeTaskListeners = function() {
                    this._currentTask && (this._currentTask.onUpdated.removeListener(this._updateProgressLabel, this),
                    this._currentTask.onCompleted.removeListener(this._onTrackedTaskCompleted, this))
                }
                ,
                t.prototype._addTaskListeners = function() {
                    this._currentTask && (this._currentTask.onUpdated.addListener(this._updateProgressLabel, this),
                    this._currentTask.onCompleted.addListener(this._onTrackedTaskCompleted, this))
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    this.onClick((function() {
                        De.services.tasks.openOverviewPopup(),
                        e.events.hudElementClicked.fire()
                    }
                    ))
                }
                ,
                t
            }(hr), tp = function() {
                function e() {
                    this.drawerOffsets = {
                        leftDrawer: 0,
                        rightDrawer: 0,
                        topDrawer: 0,
                        bottomDrawer: 0
                    },
                    this.leftDrawer = [],
                    this.rightDrawer = []
                }
                return e.prototype.initializeElements = function(e) {
                    var t = getComputedStyle(document.documentElement).getPropertyValue("--sail")
                      , i = getComputedStyle(document.documentElement).getPropertyValue("--sair")
                      , n = getComputedStyle(document.documentElement).getPropertyValue("--sait")
                      , r = getComputedStyle(document.documentElement).getPropertyValue("--saib")
                      , o = De.services.canvas.height / window.innerHeight
                      , a = De.services.canvas.currentOrientation === v.Orientation.Portrait;
                    this.drawerOffsets = {
                        topDrawer: (a ? parseFloat(n) : 0) * o,
                        bottomDrawer: (a ? parseFloat(r) : 0) * o,
                        leftDrawer: (a ? parseFloat(t) : 0) * o,
                        rightDrawer: (a ? parseFloat(i) : 0) * o
                    },
                    this.marketplaceButton = new Jh(e),
                    this.discoveryButton = new Kh(e),
                    this.storageButton = new $h(e),
                    this._initializeLeftDrawer(e),
                    this._initializeRightDrawer(e)
                }
                ,
                e.prototype._initializeLeftDrawer = function(e) {
                    this.taskButton = new ep(e),
                    this.extraWorkerButton = new zh(e),
                    this.leftDrawer = [this.extraWorkerButton, this.taskButton]
                }
                ,
                e.prototype._initializeRightDrawer = function(e) {
                    this.settingsButton = new Qh(e),
                    this.shovelButton = new Zh(e),
                    this.feedbackButton = new Yh(e),
                    this.rightDrawer = [this.settingsButton, this.shovelButton, this.feedbackButton]
                }
                ,
                e
            }(), ip = function() {
                function e() {
                    this.drawerOffsets = {
                        leftDrawer: 0,
                        rightDrawer: 0,
                        topDrawer: 0,
                        bottomDrawer: 0
                    },
                    this.friendDrawerOffsets = {
                        leftDrawer: 0,
                        rightDrawer: 0,
                        topDrawer: 0,
                        bottomDrawer: 0
                    },
                    this.leftDrawer = [],
                    this.rightDrawer = [],
                    this._logger = r.Logger.Of("DiscordHudStrategy")
                }
                return e.prototype.initializeElements = function(e) {
                    var t = getComputedStyle(document.documentElement).getPropertyValue("--sail")
                      , i = getComputedStyle(document.documentElement).getPropertyValue("--sair")
                      , n = getComputedStyle(document.documentElement).getPropertyValue("--sait")
                      , r = getComputedStyle(document.documentElement).getPropertyValue("--saib")
                      , o = De.services.canvas.height / window.innerHeight
                      , a = De.services.canvas.currentOrientation === v.Orientation.Portrait;
                    this.drawerOffsets = {
                        topDrawer: (a ? parseFloat(n) : 0) * o,
                        bottomDrawer: (a ? parseFloat(r) : 0) * o,
                        leftDrawer: (a ? parseFloat(t) : 0) * o,
                        rightDrawer: (a ? parseFloat(i) : 0) * o
                    },
                    this.friendDrawerOffsets = {
                        topDrawer: a ? 100 : 0,
                        bottomDrawer: 0,
                        leftDrawer: 0,
                        rightDrawer: 0
                    },
                    this.marketplaceButton = new Jh(e),
                    this.discoveryButton = new Kh(e),
                    this.storageButton = new $h(e),
                    this._initializeLeftDrawer(e),
                    this._initializeRightDrawer(e)
                }
                ,
                e.prototype._initializeLeftDrawer = function(e) {
                    this.taskButton = new ep(e),
                    this.extraWorkerButton = new zh(e),
                    this.leftDrawer = [this.extraWorkerButton, this.taskButton]
                }
                ,
                e.prototype._initializeRightDrawer = function(e) {
                    this.settingsButton = new Qh(e),
                    this.shovelButton = new Zh(e),
                    this.feedbackButton = new Yh(e),
                    this.rightDrawer = [this.settingsButton, this.shovelButton, this.feedbackButton]
                }
                ,
                e
            }(), np = function() {
                this.shareIcon = f.ICON_BTN_DISCORD_SHARE_PLACEHOLDER
            }, rp = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "incentiviseCommunity",
                        buttonIdle: f.BTN_HUD_SMALL_FACEBOOK_IDLE,
                        buttonActive: f.BTN_HUD_SMALL_FACEBOOK_DOWN
                    }) || this;
                    return i._notificationIcon = null,
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._addOnClickBehavior = function(e) {
                    this.onClick((function() {
                        e.services.incentivise.pressedOfficialGroupFacebookButton(),
                        e.events.hudElementClicked.fire()
                    }
                    ))
                }
                ,
                t
            }(hr), op = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "mailbox",
                        buttonIdle: f.BTN_HUD_SMALL_NEWS_IDLE,
                        buttonActive: f.BTN_HUD_SMALL_NEWS_DOWN
                    }) || this;
                    if (i._notificationIcon = null,
                    !t.services.incentivise.hasPressedMailboxThisVersion()) {
                        var n = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION);
                        n.position.set(-40, -14),
                        n.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !0),
                        i.addChild(n),
                        i._notificationIcon = n,
                        De.services.analytics.design.reportMailboxExclamationShown()
                    }
                    return i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.dismissNotification = function() {
                    this._notificationIcon && (this._notificationIcon.visible = !1)
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    var t = this;
                    this.onClick((function() {
                        e.services.incentivise.pressedMailbox(),
                        t.dismissNotification(),
                        e.events.hudElementClicked.fire()
                    }
                    ))
                }
                ,
                t
            }(hr), ap = function(e) {
                function t(t, i, r) {
                    void 0 === r && (r = !1);
                    var o, a, s, _, c = this;
                    (c = e.call(this) || this)._timer = De.services.timer.getTimerByID(t);
                    var l = c.addChild(new cr(De.services.resource.getTexture(i.background),null === (o = i.corners) || void 0 === o ? void 0 : o.leftWidth,null === (a = i.corners) || void 0 === a ? void 0 : a.topHeight,null === (s = i.corners) || void 0 === s ? void 0 : s.rightWidth,null === (_ = i.corners) || void 0 === _ ? void 0 : _.bottomHeight));
                    return l.anchor.set(.5, .5),
                    l.setSizes((0,
                    n.__assign)({}, i.sizes)),
                    c._text = c.addChild(new Xe.Text("",vn.lightExtraSmall)),
                    c._text.position.set(0, -5),
                    c._text.anchor.set(0, .5),
                    i.textOptions && c._setTextProps(i),
                    i.iconOptions && c._createIcon(i),
                    c._timer.onTimerFinished.addListener(c._onTimerFinished, c),
                    c._timer.onUpdate.addListener(c._onUpdate, c),
                    c._newFormat = r,
                    c
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function() {
                    this._timer.onTimerFinished.removeListener(this._onTimerFinished, this),
                    this._timer.onUpdate.removeListener(this._onUpdate, this)
                }
                ,
                t.prototype._onUpdate = function() {
                    var e;
                    e = this._newFormat ? Pn({
                        remainingTime: this._timer.remainingTime
                    }) : r.StringUtility.formatMilliseconds(this._timer.remainingTime, {
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        },
                        showSecondsBelowMilliseconds: 36e5
                    }),
                    this._text.text = e
                }
                ,
                t.prototype._onTimerFinished = function() {
                    this.destroy()
                }
                ,
                t.prototype._setTextProps = function(e) {
                    e.textOptions && (this._text.style = e.textOptions.textStyle,
                    this._text.position.set(e.textOptions.position.x, e.textOptions.position.y))
                }
                ,
                t.prototype._createIcon = function(e) {
                    e.iconOptions && this.addChild(rr(De.services.resource.getSprite(e.iconOptions.icon), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: e.iconOptions.position,
                        scale: e.iconOptions.scale ? e.iconOptions.scale : {
                            x: 1,
                            y: 1
                        }
                    }))
                }
                ,
                t
            }(Xe.Container), sp = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "SpecialOfferButton",
                        buttonIdle: f.BTN_HUD_DEFAULT_IDLE,
                        buttonActive: f.BTN_HUD_DEFAULT_DOWN,
                        targetPressedScale: 1.316
                    }) || this;
                    return i._specialOfferService = t.services.specialOfferService,
                    i._specialOfferService.specialOfferActive.addListener(i._updateButtonVisual, i),
                    i.addContent(rr(De.services.resource.getSprite(f.ICON_BUTTON_HUD_FREEBIE), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 3,
                            y: -35
                        }
                    })),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        return this._specialOfferService.hasActiveSpecialOffer()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function(t) {
                    var i;
                    this._specialOfferService.specialOfferActive.removeListener(this._updateButtonVisual, this),
                    null === (i = this._timerElement) || void 0 === i || i.destroy(),
                    e.prototype.destroy.call(this, t)
                }
                ,
                t.prototype._updateButtonVisual = function(e) {
                    e.timerId && (this._timerElement = new ap(e.timerId,{
                        background: f.BG_TIMER_NATURE,
                        sizes: {
                            width: 190,
                            height: 54
                        },
                        corners: {
                            leftWidth: 100,
                            rightWidth: 20,
                            topHeight: 20,
                            bottomHeight: 20
                        },
                        textOptions: {
                            textStyle: vn.lightExtraSmall,
                            position: {
                                x: -38,
                                y: -1
                            }
                        }
                    }),
                    this._timerElement.position.set(0, 70),
                    this.addContent(this._timerElement))
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    this.onClick((function() {
                        e.services.specialOfferService.openSpecialOfferPopup(),
                        e.events.hudElementClicked.fire(),
                        De.services.analytics.design.reportFreebieOfferPopupManuallyOpened()
                    }
                    ))
                }
                ,
                t
            }(hr), _p = (function() {
                function e() {
                    this.leftDrawer = [],
                    this.rightDrawer = []
                }
                e.prototype.initializeElements = function(e) {
                    this.marketplaceButton = new Jh(e),
                    this.discoveryButton = new Kh(e),
                    this.specialOfferButton = new sp(e),
                    this.storageButton = new $h(e),
                    this._initializeleftDrawer(e),
                    this._initializeRightDrawer(e)
                }
                ,
                e.prototype._initializeleftDrawer = function(e) {
                    this.taskButton = new ep(e),
                    this.extraWorkerButton = new zh(e),
                    this.leftDrawer = [this.extraWorkerButton, this.taskButton]
                }
                ,
                e.prototype._initializeRightDrawer = function(e) {
                    this.settingsButton = new Qh(e),
                    this.shovelButton = new Zh(e),
                    this.feedbackButton = new Yh(e),
                    this.mailboxButton = new op(e),
                    this.facebookButton = new rp(e),
                    this.rightDrawer = [this.settingsButton, this.shovelButton, this.feedbackButton, this.mailboxButton, this.facebookButton]
                }
            }(),
            function(e) {
                function t(t) {
                    var i = e.call(this, {
                        name: "SignInBonusButton",
                        buttonIdle: f.BTN_HUD_DEFAULT_IDLE,
                        buttonActive: f.BTN_HUD_DEFAULT_DOWN,
                        targetPressedScale: 1.316
                    }) || this;
                    return i._signInBonusService = De.services.signInBonus,
                    i._mapAreaStateService = t.services.mapAreaService,
                    i.addContent(rr(De.services.resource.getSprite(f.ICON_BUTTON_HUD_LOGINBONUS), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 3,
                            y: -35
                        }
                    })),
                    i._addFreeElement(),
                    i._setNotificationIcon(),
                    i._setConfig(),
                    i._addOnClickBehavior(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "canShow", {
                    get: function() {
                        var e;
                        return this._signInBonusService.bonusAvailable && (null === (e = this._mapAreaStateService.getMapArea(this._config.targetArea)) || void 0 === e ? void 0 : e.state) === Cc.UNLOCKED
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t)
                }
                ,
                t.prototype._addOnClickBehavior = function(e) {
                    this.onClick((function() {
                        De.services.signInBonus.openSignInBonusPopup("HUD"),
                        e.events.hudElementClicked.fire()
                    }
                    ))
                }
                ,
                t.prototype._addFreeElement = function() {
                    var e = new v.LabelSettings({
                        fitHeight: 45,
                        fitWidth: 200,
                        fitToBox: !0
                    });
                    e.style = vn.lightSmall;
                    var t = new v.Label(nr(Oh || (Oh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.CRATES_RV_TEXT).toLocaleUpperCase(),e);
                    t.position.set(0, 28),
                    t.anchor.set(.5, .5),
                    this.addContent(t)
                }
                ,
                t.prototype._setNotificationIcon = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._notificationIcon = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                                this._notificationIcon.position.set(this.width / 3, -this.height / 4),
                                this.addChild(this._notificationIcon),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return e.sent(),
                                this._notificationIcon.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                                this._notificationIcon.visible = !0,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._setConfig = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons(_e.SIGN_IN_BONUS_CONFIG)];
                            case 1:
                                return e.sent(),
                                this._config = De.services.resource.getJsonCopy(_e.SIGN_IN_BONUS_CONFIG),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(hr)), cp = (function() {
                function e() {
                    this.leftDrawer = [],
                    this.rightDrawer = []
                }
                e.prototype.initializeElements = function(e) {
                    this.marketplaceButton = new Jh(e),
                    this.discoveryButton = new Kh(e),
                    this.signInBonusButton = new _p(e),
                    this.storageButton = new $h(e),
                    this._initializeLeftDrawer(e),
                    this._initializeRightDrawer(e)
                }
                ,
                e.prototype._initializeLeftDrawer = function(e) {
                    this.taskButton = new ep(e),
                    this.extraWorkerButton = new zh(e),
                    this.leftDrawer = [this.extraWorkerButton, this.taskButton]
                }
                ,
                e.prototype._initializeRightDrawer = function(e) {
                    this.settingsButton = new Qh(e),
                    this.shovelButton = new Zh(e),
                    this.feedbackButton = new Yh(e),
                    this.rightDrawer = [this.settingsButton, this.shovelButton, this.feedbackButton]
                }
            }(),
            function() {
                function e() {
                    this.leftDrawer = [],
                    this.rightDrawer = []
                }
                e.prototype.initializeElements = function(e) {
                    this.marketplaceButton = new Jh(e),
                    this.discoveryButton = new Kh(e),
                    this.signInBonusButton = new _p(e),
                    this.storageButton = new $h(e),
                    this._initializeLeftDrawer(e),
                    this._initializeRightDrawer(e)
                }
                ,
                e.prototype._initializeLeftDrawer = function(e) {
                    this.taskButton = new ep(e),
                    this.extraWorkerButton = new zh(e),
                    this.leftDrawer = [this.extraWorkerButton, this.taskButton]
                }
                ,
                e.prototype._initializeRightDrawer = function(e) {
                    this.settingsButton = new Qh(e),
                    this.shovelButton = new Zh(e),
                    this.feedbackButton = new Yh(e),
                    this.rightDrawer = [this.settingsButton, this.shovelButton, this.feedbackButton]
                }
            }(),
            function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._options = t,
                    i._create(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._create = function() {
                    var e = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN02_9SLICE),10,10,10,10);
                    e.setSizes({
                        width: 250,
                        height: 290
                    }),
                    this.addChild(e);
                    var t = rr(De.services.resource.getSprite(Sa[this._options.key]), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: e.width / 2,
                            y: e.height / 2 - 25
                        },
                        scale: {
                            x: .85,
                            y: .85
                        }
                    });
                    e.addChild(t);
                    var i = new Xe.Text(String(this._options.amount),vn.darkMedium);
                    i.position.set(e.width / 2, e.height / 2 + 105),
                    i.anchor.set(.5),
                    e.addChild(i)
                }
                ,
                t
            }(Xe.Container)), lp = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "CommunityRewardPopup",
                    i._combinedRewards = new Map,
                    i._itemPositions = new Map,
                    i._onCloseCallback = t.onCloseCallback,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    this._combineRewards();
                    var t = new Xe.Container
                      , i = this._createTopContent();
                    i.y = t.height,
                    t.addChild(i);
                    var n = this._createReward();
                    n.y = t.height,
                    t.addChild(n);
                    var r = this._createCollectButton();
                    r.y = t.height + 100,
                    t.addChild(r);
                    var o = this._createBg(t.height + 40);
                    o.addChild(t),
                    t.position.set(0, 70 - t.height / 2),
                    this._content.addChild(o),
                    e()
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, e.prototype.close.call(this)];
                            case 1:
                                return t.sent(),
                                this._animateRewards(),
                                [4, r.TimeDelay.after(1e3).promise];
                            case 2:
                                return t.sent(),
                                this._onCloseCallback && this._onCloseCallback(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBg = function(e) {
                    var t = new Ar({
                        size: {
                            width: 920,
                            height: e + 140
                        },
                        headerSize: {
                            width: 920 / 1.5,
                            height: 120
                        },
                        headerText: ce.COMMUNITY_GIFT_HEADER,
                        headerStyle: vn.popupTitle
                    });
                    return t.position.set(0, -25),
                    t.onCloseClick(this.close.bind(this)),
                    t
                }
                ,
                t.prototype._createTopContent = function() {
                    var e = new Xe.Container
                      , t = De.services.resource.getSprite(f.ICON_REWARDEDLINK_GIFT);
                    t.anchor.set(.5),
                    t.position.set(0, t.height / 2 - 20),
                    e.addChild(t);
                    var i = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 100,
                        fitWidth: 800
                    });
                    i.style = vn.darkLarge;
                    var r = new v.Label(nr(bh || (bh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.COMMUNITY_GIFT_THANKS),i);
                    r.anchor.set(.5),
                    r.position.set(0, t.height + 30),
                    e.addChild(r);
                    var o = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 80,
                        fitWidth: 800
                    });
                    o.style = vn.greyMedium;
                    var a = new v.Label(nr(Rh || (Rh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.COMMUNITY_GIFT_REWARDS),o);
                    return a.anchor.set(.5),
                    a.position.set(0, t.height + r.height + 30),
                    e.addChild(a),
                    e
                }
                ,
                t.prototype._createReward = function() {
                    var e = this
                      , t = new Xe.Container
                      , i = 0
                      , n = 0;
                    return this._combinedRewards.forEach((function(r, o) {
                        var a = {
                            key: o,
                            amount: r
                        }
                          , s = t.addChild(new cp(a));
                        if (n % 3 == 0) {
                            var _ = (Math.min(e._combinedRewards.size - n, 3) - 1) / 2;
                            i = -(_ * s.width + 15 * _)
                        }
                        var c = new Xe.Point(i + n % 3 * (s.width + 15),Math.floor(n / 3) * (s.height + 15));
                        s.position.set(c.x, c.y),
                        s.pivot.set(s.width / 2, 0),
                        e._itemPositions.set(o, c),
                        n++
                    }
                    )),
                    t.position.set(3.75, 70),
                    t
                }
                ,
                t.prototype._combineRewards = function() {
                    var e = this;
                    this._options.reward.forEach((function(t) {
                        var i, n = null !== (i = e._combinedRewards.get(t.key)) && void 0 !== i ? i : 0;
                        e._combinedRewards.set(t.key, n + t.amount)
                    }
                    ))
                }
                ,
                t.prototype._createCollectButton = function() {
                    var e = new Xe.Container
                      , t = new fr({
                        name: "collect",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 420,
                            height: 95
                        }
                    },{
                        text: ce.VISIT_FRIENDS_SUMMARY_COLLECT_BUTTON,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    return t.onClick(this.close.bind(this)),
                    t.y = 0,
                    e.addChild(t),
                    e
                }
                ,
                t.prototype._animateRewards = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._combinedRewards.forEach((function(t, i) {
                                return (0,
                                n.__awaiter)(e, void 0, void 0, (function() {
                                    var e, r, o, a, s, _, c, l;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        return e = this._itemPositions.get(i),
                                        r = De.services.navigation.layers.popup.container,
                                        o = r.toGlobal(e || new Xe.Point(0,0)),
                                        a = De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter({
                                            amount: t,
                                            key: i
                                        }),
                                        s = a.target,
                                        _ = a.icon,
                                        c = s.toGlobal(new Xe.Point(0,0)),
                                        (l = new Lr(De.services.resource.getSprite(_),r.toLocal(o),r.toLocal(c),t,r)).onAnimationComplete.addListener((function() {
                                            De.services.inventory.getInventoryItem(i).updateVisuals()
                                        }
                                        ), null),
                                        l.animate(),
                                        [2]
                                    }
                                    ))
                                }
                                ))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr), up = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._createLabels(t.title, t.message),
                    i._layoutContent(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._createLabels = function(e, t) {
                    var i = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 480,
                        fitHeight: 54
                    });
                    i.style = vn.darkMedium,
                    this._titleLabel = new v.Label(e,i),
                    this._titleLabel.anchor.set(.5, .5);
                    var n = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 480,
                        fitHeight: 48
                    });
                    n.style = vn.greySmall,
                    this._bodyLabel = new v.Label(t,n),
                    this._bodyLabel.anchor.set(.5, .5),
                    this._content.addChild(this._titleLabel),
                    this._content.addChild(this._bodyLabel)
                }
                ,
                t.prototype._layoutContent = function() {
                    this._titleLabel.y = -this._titleLabel.height / 2,
                    this._bodyLabel.y = this._bodyLabel.height / 2
                }
                ,
                t
            }(Bs), dp = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._createLabels(t.name),
                    i._createProfilePicture(t.photo),
                    i._layoutContent(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._createLabels = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 480,
                        fitHeight: 54
                    });
                    t.style = vn.darkMedium,
                    this._titleLabel = new v.Label(nr(wh || (wh = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.HELP_HEAVY_OBJECT_TITLE, e),t),
                    this._titleLabel.anchor.set(.5, .5);
                    var i = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 480,
                        fitHeight: 48
                    });
                    i.style = vn.greySmall,
                    this._bodyLabel = new v.Label(nr(Dh || (Dh = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.HELP_HEAVY_OBJECT_BODY),i),
                    this._bodyLabel.anchor.set(.5, .5),
                    this._content.addChild(this._titleLabel),
                    this._content.addChild(this._bodyLabel)
                }
                ,
                t.prototype._createProfilePicture = function(e) {
                    this._profilePicture = e;
                    var t = (this._background.height - 36) / this._profilePicture.height;
                    this._profilePicture.scale.set(t),
                    this._profilePicture.anchor.set(.5, .5),
                    this._content.addChild(this._profilePicture)
                }
                ,
                t.prototype._layoutContent = function() {
                    var e = this._profilePicture.width
                      , t = Math.max(this._titleLabel.width, this._bodyLabel.width)
                      , i = e + t + 50;
                    this._profilePicture.x = -i / 2 + e / 2,
                    this._titleLabel.x = i / 2 - t / 2,
                    this._bodyLabel.x = i / 2 - t / 2,
                    this._titleLabel.y = -this._titleLabel.height / 2,
                    this._bodyLabel.y = this._bodyLabel.height / 2
                }
                ,
                t
            }(Bs), hp = ["admin_message", "feed", "notification", "score_share", "shareable_link", "story", "tournament_menu", "custom_share", "game_share", "group"], pp = (function() {
                function e() {
                    this._logger = r.Logger.Of("EntryPointHandler")
                }
                e.prototype.handleEntryPointPreload = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this._getEntryPoint()];
                            case 1:
                                return t = n.sent(),
                                this._logger.info("entry point name: ".concat(t.name)),
                                i = null,
                                [this._getAdUAEntryPoint, this._getCrossPromoUAEntryPoint, this._getViralUAEntryPoint, this._getOrganicUAEntryPoint].forEach((function(e) {
                                    i = null != i ? i : e(t)
                                }
                                )),
                                e.setUAEntryPoint(i),
                                r = t.type && t.type !== a.GamePayloadType.UNKNOWN ? t.type : "noMessageType",
                                e.design.enterTheGame(t.name, r),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.handleEntryPointPostLoad = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this._getEntryPoint()];
                            case 1:
                                return (t = n.sent()).data ? (t.type === a.GamePayloadType.SHARE && this._sendAnalyticsUserJoinedViaShare(t),
                                "shareable_link" === t.name && t.data.reward && this._handleRewardedLinkEntry(t.data, e),
                                i = Object.keys(t.data).length > 0,
                                t.type !== a.GamePayloadType.SHARE && t.type !== a.GamePayloadType.UNKNOWN || !i || (Wu(t.data) ? this._handleHeavyObjectEntry(t.data) : Ku(t.data) && this._handleCratesForFriendsEntry(t.data)),
                                [2]) : [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._getEntryPoint = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                this._entryPointPromise || (e = vp.platform.facebookSDK,
                                this._entryPointPromise = e.messagingPlatform.getEntryPointData()),
                                i.label = 1;
                            case 1:
                                return i.trys.push([1, 3, , 4]),
                                [4, this._entryPointPromise];
                            case 2:
                                return [2, i.sent()];
                            case 3:
                                return t = i.sent(),
                                Zn.error(t),
                                [2, {
                                    name: "unknown",
                                    type: a.GamePayloadType.UNKNOWN,
                                    data: {}
                                }];
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._sendAnalyticsUserJoinedViaShare = function(e) {
                    De.services.analytics.model.totalSessions > 0 || (Wu(e.data) ? De.services.analytics.design.newPlayerJoined("heavyObjects") : Ku(e.data) && De.services.analytics.design.newPlayerJoined("inviteForCrates"))
                }
                ,
                e.prototype._handleHeavyObjectEntry = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, De.services.friends.fetchProfile({
                                    platformuserid: e.senderID
                                })];
                            case 1:
                                return t = n.sent(),
                                (0,
                                r.isUndefined)(t) ? (this._logger.warn("Could not find profile for heavy object sender!"),
                                [2]) : (i = e.name,
                                o = e.areaID,
                                De.services.token.useToken(e.rewardToken).then((function() {
                                    De.services.analytics.design.heavyObjectInteraction(on.PLAYER_HELPED, sn[i], o),
                                    t && De.services.navigation.showToast(dp, {
                                        name: t.name,
                                        photo: t.getPhoto()
                                    })
                                }
                                )).catch((function() {
                                    a._logger.warn("Invalid token for farm help!")
                                }
                                )),
                                [2])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._handleCratesForFriendsEntry = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a, s = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, De.services.friends.fetchProfile({
                                    platformuserid: e.senderID
                                })];
                            case 1:
                                return t = n.sent(),
                                (0,
                                r.isUndefined)(t) ? (this._logger.warn("Could not find profile for crates for friends sender!"),
                                [2]) : (i = vp.platform,
                                o = i.facebookContext,
                                a = i.customUpdate,
                                De.services.token.useToken(e.rewardToken).then((function() {
                                    s._logger.info("Succesfully used token for Crates For Friends Invite"),
                                    o.createContext(t).then((function() {
                                        a.sendInviteAcceptedCustomUpdate().then((function() {
                                            s._logger.info("Succesfully send custom update for Crates For Friends Invite")
                                        }
                                        )).catch((function(e) {
                                            s._logger.error("failed to send custom update for Crates For Friends Invite: ".concat(e.message))
                                        }
                                        ))
                                    }
                                    )).catch((function(e) {
                                        s._logger.error("failed to create context for Crates For Friends Invite: ".concat(e.message))
                                    }
                                    ))
                                }
                                )).catch((function(e) {
                                    s._logger.error("Failed to use token for Crates For Friends Invite: ".concat(e.message))
                                }
                                )),
                                [2])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._handleRewardedLinkEntry = function(e, t) {
                    var i = t.configuration.getOrFetchConfigFile("rewarded_links")
                      , n = e.token;
                    if (n) {
                        var r = t.rewards.claimReward(n);
                        this._processClaimedReward(n, r, i)
                    } else
                        this._logger.warn("invalid reward link, no token is present!")
                }
                ,
                e.prototype._processClaimedReward = function(e, t, i) {
                    var r = this;
                    Promise.all([t, i]).then((function(t) {
                        var i = t[0]
                          , n = t[1];
                        if ("rewardedLink" !== i.rewardtype || !n || !n[e])
                            throw new Error("invalid link");
                        var o = n[e];
                        r._addRewardsToInventory(o),
                        r._showRewardsPopup(o)
                    }
                    )).catch((function(e) {
                        De.services.navigation.showToast(up, {
                            title: nr(Nh || (Nh = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.COMMUNITY_GIFT_ERROR_HEADER),
                            message: nr(Lh || (Lh = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.COMMUNITY_GIFT_INVALID_LINK)
                        })
                    }
                    ))
                }
                ,
                e.prototype._addRewardsToInventory = function(e) {
                    Object.keys(e).forEach((function(t) {
                        De.services.inventory.addAmount(t, e[t], !1)
                    }
                    ))
                }
                ,
                e.prototype._showRewardsPopup = function(e) {
                    Promise.all([De.services.lazyLoad.prioritizeGroup(hn.LEVEL_UP), r.TimeDelay.after(1e3).promise]).then((function() {
                        De.services.navigation.showPopup(lp, {
                            reward: Object.keys(e).map((function(t) {
                                return {
                                    key: t,
                                    amount: e[t]
                                }
                            }
                            ))
                        })
                    }
                    ))
                }
                ,
                e.prototype._getAdUAEntryPoint = function(e) {
                    var t;
                    return "ad" !== e.name ? null : (null === (t = e.data) || void 0 === t ? void 0 : t.fb_instant_game_adset_id) ? "UA-".concat(e.data.fb_instant_game_adset_id) : (this._logger.warn("entrypoint was UA campaign, but no adset_id is present"),
                    "UA-unknown")
                }
                ,
                e.prototype._getCrossPromoUAEntryPoint = function(e) {
                    var t, i;
                    if ("shareable_link" === e.name && (null === (t = e.data) || void 0 === t ? void 0 : t.zyngaCrossPromo))
                        return "crossPromo-Zynga";
                    if ("game_switch" === e.name) {
                        var n = (null === (i = e.data) || void 0 === i ? void 0 : i.sourceGame) || "unknown";
                        return "crossPromo-".concat(n)
                    }
                    return null
                }
                ,
                e.prototype._getViralUAEntryPoint = function(e) {
                    return hp.includes(e.name) ? "virality" : null
                }
                ,
                e.prototype._getOrganicUAEntryPoint = function(e) {
                    return "organic"
                }
            }(),
            function() {
                function e() {}
                return e.prototype.handleEntryPointPreload = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.handleEntryPointPostLoad = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }()), vp = (function() {
                function e() {}
                e.prototype.handleEntryPointPreload = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return t = $msstart.getEntryPointInfo(),
                            i = this._getOrganicUAEntryPoint(t),
                            e.setUAEntryPoint(i),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.handleEntryPointPostLoad = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._checkForNotificationPayload(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._getOrganicUAEntryPoint = function(e) {
                    return "organic"
                }
                ,
                e.prototype._checkForNotificationPayload = function() {
                    "pwanotif" === $msstart.getEntryPointInfo().entryPointId && De.services.analytics.design.reportMSNotificationEntryPoint()
                }
            }(),
            function() {
                function e() {}
                return Object.defineProperty(e, "platform", {
                    get: function() {
                        return this._dependencies || this._setupConfig(),
                        this._dependencies
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.gameMapServiceEnabled = function(e) {
                    return this._dependencies || this._setupConfig(),
                    Object.prototype.hasOwnProperty.call(this._dependencies.gameplayMapServices(), e)
                }
                ,
                e._setupConfig = function() {
                    var e;
                    this._dependencies = (e = new o.ho("1187013846746005515",{
                        disableConsoleLogOverride: !0
                    }),
                    (0,
                    n.__assign)((0,
                    n.__assign)({}, gp), {
                        gameServiceProvider: new Zr,
                        analyticsDimensions: [Su, Iu, Ou],
                        loginStrategy: new Qu,
                        initializePlatform: new Dn,
                        friendFetcher: new Yu,
                        hudStrategy: new ip,
                        gameplayMapSystems: _h,
                        gameplayMapServices: wd,
                        onboardingTracksStrategy: new pu,
                        cratesButtonStrategy: new Hh,
                        customShare: new Uu(e),
                        platformAssets: new np,
                        deviceStrategy: new ed,
                        discordSDK: e,
                        useABTests: !1
                    }))
                }
                ,
                e
            }()), gp = {
                initializePlatform: new h,
                gameServiceProvider: new mo,
                entryPointHandler: new pp,
                adStrategies: [new yu],
                localeStrategy: new Xu,
                deviceStrategy: new $u,
                onboardingTracksStrategy: new Ll,
                gameplayMapSystems: function() {
                    return []
                },
                gameplayMapServices: function() {
                    return {}
                },
                analyticsDimensions: [Cu, Cu, Cu],
                abTestDataStorage: {
                    writer: id,
                    provider: td
                },
                loginStrategy: new Zu,
                cratesButtonStrategy: new Vh,
                platformAssets: new function() {
                    this.shareIcon = f.ICON_HELP
                }
                ,
                hudStrategy: new tp,
                platformCheats: new Gu,
                installShortcutStrategy: new nd,
                friendFetcher: new Ju,
                customShare: new zu,
                useABTests: !1
            };
            function fp(e) {
                return (0,
                n.__awaiter)(this, void 0, void 0, (function() {
                    var t, i;
                    return (0,
                    n.__generator)(this, (function(n) {
                        switch (n.label) {
                        case 0:
                            return t = new v.CoolKitDependencyManager({
                                queryParams: e
                            }),
                            [4, Promise.all([t.getAssetManifest(), t.getQualitySetting()])];
                        case 1:
                            return [2, {
                                assetManifest: (i = n.sent())[0],
                                qualitySetting: i[1]
                            }]
                        }
                    }
                    ))
                }
                ))
            }
            var Ep, mp, yp = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "WorldToLifeModel",
                    t._version = 1,
                    t._activeAnimations = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "allActiveAnimations", {
                    get: function() {
                        return this._activeAnimations
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "intervalTimer", {
                    get: function() {
                        return this._intervalTimer
                    },
                    set: function(e) {
                        this._intervalTimer = e,
                        this.saveData()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.addAnimation = function(e) {
                    this._activeAnimations.find((function(t) {
                        return t.timerId === e.timerId
                    }
                    )) ? this._logger.warn("already have an active animation with timerId: ".concat(e.timerId)) : (this._activeAnimations.push(e),
                    this.saveData())
                }
                ,
                t.prototype.removeAnimation = function(e) {
                    var t = this._activeAnimations.find((function(t) {
                        return t.timerId === e
                    }
                    ));
                    t ? (this._activeAnimations.splice(this._activeAnimations.indexOf(t), 1),
                    this.saveData()) : this._logger.warn("couldn't find an active animation with timerId: ".concat(e))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._activeAnimations = (0,
                    n.__spreadArray)([], e.activeAnimations, !0),
                    this._intervalTimer = e.intervalTimer
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        activeAnimations: this._activeAnimations,
                        intervalTimer: this._intervalTimer
                    }
                }
                ,
                t
            }($n), Tp = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onAnimationStartRequested = new r.Event,
                    t._model = new yp,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "model", {
                    get: function() {
                        return this._model
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.autosave.unregisterModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.startAnimation = function(e) {
                    this.onAnimationStartRequested.fire(e)
                }
                ,
                t
            }(Se), Ap = /^(\w+|\*)(\.(\w+|(\*|\*\*(?=.))))*$/, Cp = /^(\w+)(\.(\w+))*$/, Ip = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._listeners = {
                        listeners: [],
                        subGroups: {}
                    },
                    t._wildCardListeners = {
                        listeners: [],
                        subGroups: {}
                    },
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.on = function(e, t, i) {
                    Ap.exec(e) ? this._getGroupForAction(e).listeners.push({
                        callback: t,
                        context: i,
                        action: e
                    }) : this._logger.error("invalid listener action: ".concat(e))
                }
                ,
                t.prototype.off = function(e, t, i) {
                    if (Ap.exec(e))
                        for (var n = this._getGroupForAction(e), r = n.listeners.length - 1; r >= 0; r--) {
                            var o = n.listeners[r];
                            o.callback === t && o.context === i && n.listeners.splice(r, 1)
                        }
                    else
                        this._logger.error("invalid listener action: ".concat(e))
                }
                ,
                t.prototype.emit = function(e) {
                    Cp.exec(e) ? (this._invokeRegularListeners(e),
                    this._invokeWildcardListeners(e)) : this._logger.error("invalid action: ".concat(e))
                }
                ,
                t.prototype._getGroupForAction = function(e) {
                    var t = this._listeners
                      , i = e.split(".");
                    if (i.includes("**") || i.includes("*") && i.indexOf("*") !== i.length - 1)
                        return this._wildCardListeners;
                    for (; i.length > 0; ) {
                        var n = i.shift();
                        if ("*" === n)
                            break;
                        t.subGroups[n] || (t.subGroups[n] = {
                            listeners: [],
                            subGroups: {}
                        }),
                        t = t.subGroups[n]
                    }
                    return t
                }
                ,
                t.prototype._invokeRegularListeners = function(e) {
                    for (var t = e.split("."), i = this._listeners; i; ) {
                        i.listeners.reverse().forEach((function(t) {
                            t.callback.apply(t.context, [e])
                        }
                        ));
                        var n = t.shift();
                        if (!n)
                            break;
                        i = i.subGroups[n]
                    }
                }
                ,
                t.prototype._invokeWildcardListeners = function(e) {
                    this._wildCardListeners.listeners.forEach((function(t) {
                        for (var i = e.split("."), n = t.action.split("."), r = !0; n.length > 0 && i.length > 0; ) {
                            var o = n.shift()
                              , a = i[0];
                            if ("*" === o)
                                i.shift();
                            else if ("**" === o) {
                                var s = n.shift();
                                for (r = !1; i.length > 0; )
                                    if (i.shift() === s) {
                                        r = !0;
                                        break
                                    }
                            } else {
                                if (o !== a) {
                                    r = !1;
                                    break
                                }
                                i.shift()
                            }
                        }
                        r && t.callback.apply(t.context, [e])
                    }
                    ))
                }
                ,
                t
            }(Se);
            !function(e) {
                e.MERGABLE_OBJECTS = "mergableObjects",
                e.PROGRESSION = "progression",
                e.GEM_SHOP = "gemShop",
                e.ENERGY = "energy",
                e.PURCHASE = "purchase",
                e.CRATES = "crates",
                e.TRAIN_TICKETS = "trainTickets",
                e.DISCOVERY_DIARY = "discoveryDiary"
            }(Ep || (Ep = {})),
            function(e) {
                e.EXPERIENCE = "experience",
                e.COINS = "coins",
                e.GEMS = "gems",
                e.CRATES = "crates",
                e.ENERGY = "energy",
                e.WOOD = "wood",
                e.STONE = "stone",
                e.TRAIN_TICKET = "trainTicket"
            }(mp || (mp = {}));
            var Sp = i(2321)
              , Op = function() {
                function e() {}
                return Object.defineProperty(e.prototype, "backendSDK", {
                    get: function() {
                        return this._backendSDK
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "nakamaProvider", {
                    get: function() {
                        return this._nakamaProvider
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "nakamaId", {
                    get: function() {
                        return this._nakamaId
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "analyticsId", {
                    get: function() {
                        return this._analyticsId
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initialize = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._nakamaProvider = new s.v8("mOdD10T72nPmC5e543kLhX0TRLpi64Pq",{
                                    host: "1187013846746005515.discordsays.com/nakama",
                                    publicHost: "1187013846746005515.discordsays.com/publicNakama",
                                    port: "",
                                    useSSL: !0,
                                    connectivity: {
                                        autoReconnect: !1
                                    }
                                }),
                                this._backendSDK = ze.USE_NAKAMA ? new _.Z(this._nakamaProvider) : new Sp.Z("mock-user",{},{}),
                                [4, this.authenticate()];
                            case 1:
                                return i.sent(),
                                [4, vp.platform.initializePlatform.setupBackendAccount(this._backendSDK, {
                                    analyticsId: this._analyticsId
                                })];
                            case 2:
                                return t = i.sent(),
                                e.setPlayerId(t.metadata.analyticsId || this._nakamaId),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.authenticate = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return ze.USE_NAKAMA ? (t = this,
                                [4, vp.platform.initializePlatform.authenticateBackend(this._nakamaProvider)]) : [3, 4];
                            case 1:
                                return t._nakamaId = n.sent(),
                                [4, this._nakamaProvider.connectivity.createSocket()];
                            case 2:
                                return n.sent(),
                                [4, this._backendSDK.playerprofile.getProfile(this._nakamaId)];
                            case 3:
                                return i = n.sent(),
                                (null === (e = i.metadata) || void 0 === e ? void 0 : e.analyticsId) ? this._analyticsId = i.metadata.analyticsId : this._analyticsId = this._retrieveAnalyticsId(),
                                [3, 5];
                            case 4:
                                this._nakamaId = this._backendSDK.userID,
                                this._analyticsId = this._retrieveAnalyticsId(),
                                n.label = 5;
                            case 5:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._retrieveAnalyticsId = function() {
                    return l("FAKE_PLAYER") || this._nakamaId
                }
                ,
                e
            }()
              , bp = new Op;
            function Rp(e) {
                return function(t, i) {
                    for (; t.version < i; )
                        t.data = e[t.version + 1](t.data),
                        t.version++;
                    return t.data
                }
            }
            var wp, Dp, Np = Rp({
                2: function(e) {
                    return (0,
                    n.__assign)({
                        userAcquisitionType: "organic"
                    }, e)
                },
                3: function(e) {
                    return (0,
                    n.__assign)({
                        totalSpent: 0
                    }, e)
                },
                4: function(e) {
                    return (0,
                    n.__assign)({
                        abTestData: void 0
                    }, e)
                },
                5: function(e) {
                    return (0,
                    n.__assign)({
                        totalGreenhousesCompleted: 0
                    }, e)
                }
            }), Lp = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "AnalyticsModel",
                    t._version = 5,
                    t._totalSessions = 0,
                    t._totalDays = 0,
                    t._enteredLastTime = 0,
                    t._userAcquisitonType = void 0,
                    t._totalSpent = 0,
                    t._abTestData = void 0,
                    t._totalGreenhousesCompleted = 0,
                    t._onboardingSteps = {},
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "onboardingSteps", {
                    get: function() {
                        return this._onboardingSteps
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "enteredLastTime", {
                    get: function() {
                        return this._enteredLastTime
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "totalSessions", {
                    get: function() {
                        return this._totalSessions
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "totalDays", {
                    get: function() {
                        return this._totalDays
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "totalSpent", {
                    get: function() {
                        return this._totalSpent
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "abTestData", {
                    get: function() {
                        return this._abTestData
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "totalGreenhousesCompleted", {
                    get: function() {
                        return this._totalGreenhousesCompleted
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.incrementSession = function() {
                    this._totalSessions += 1,
                    this.saveData()
                }
                ,
                t.prototype.addGreenhousesCompleted = function(e) {
                    this._totalGreenhousesCompleted += e,
                    this.saveData()
                }
                ,
                t.prototype.incrementDays = function(e) {
                    this._enteredLastTime = e,
                    this._totalDays += 1,
                    this.saveData()
                }
                ,
                t.prototype.addToTotalSpent = function(e) {
                    this._totalSpent += e,
                    this.saveData()
                }
                ,
                t.prototype.saveStepStartStatus = function(e) {
                    this._onboardingSteps[e] = !1,
                    this.saveData()
                }
                ,
                t.prototype.saveStepFinishStatus = function(e) {
                    (0,
                    r.isUndefined)(this._onboardingSteps[e]) ? this._logger.error("Can't send save finish status for ".concat(e, ", it wasn't started!")) : (this._onboardingSteps[e] = !0,
                    this.saveData())
                }
                ,
                t.prototype.setUserAcquisitionType = function(e) {
                    void 0 === this._userAcquisitonType && (this._userAcquisitonType = e,
                    this.saveData())
                }
                ,
                t.prototype.getUserAcquisitionType = function() {
                    return this._userAcquisitonType
                }
                ,
                t.prototype.setabTestData = function(e) {
                    this._abTestData = e,
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._onboardingSteps = e.onboardingSteps,
                    this._enteredLastTime = e.enteredLastTime,
                    this._totalSessions = e.totalSessions,
                    this._totalDays = e.totalDays,
                    this._userAcquisitonType = e.userAcquisitionType,
                    this._totalSpent = e.totalSpent,
                    this._abTestData = e.abTestData,
                    this._totalGreenhousesCompleted = e.totalGreenhousesCompleted
                }
                ,
                t.prototype.migrateData = function(e) {
                    return Np(e, 5)
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        onboardingSteps: this._onboardingSteps,
                        enteredLastTime: this._enteredLastTime,
                        totalSessions: this._totalSessions,
                        totalDays: this._totalDays,
                        userAcquisitionType: this._userAcquisitonType,
                        totalSpent: this._totalSpent,
                        abTestData: this._abTestData,
                        totalGreenhousesCompleted: this._totalGreenhousesCompleted
                    }
                }
                ,
                t
            }($n);
            !function(e) {
                e.GEM_PACK = "gemPack",
                e.FREEBIE_OFFER = "freebieOffer"
            }(wp || (wp = {})),
            function(e) {
                e.MARKETPLACE = "marketplace",
                e.SPECIAL_OFFERS = "specialOffers"
            }(Dp || (Dp = {}));
            var Bp, Pp = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.marketplaceGemPack = function(e) {
                    this._service.increaseTotalMoneySpent(e.payment.trackingValue);
                    var t = De.services.iap.catalog.find((function(t) {
                        return t.sku === e.payment.productId
                    }
                    ))
                      , i = Math.round(100 * t.price.amount);
                    this.processEvent({
                        currency: t.price.currency.toUpperCase(),
                        amount: i,
                        cartType: Dp.MARKETPLACE,
                        itemType: wp.GEM_PACK,
                        itemId: e.payment.productId
                    })
                }
                ,
                t.prototype.freebieOfferPurchased = function(e) {
                    this._service.increaseTotalMoneySpent(e.payment.trackingValue);
                    var t = De.services.iap.catalog.find((function(t) {
                        return t.sku === e.payment.productId
                    }
                    ))
                      , i = Math.round(100 * t.price.amount);
                    this.processEvent({
                        currency: t.price.currency.toUpperCase(),
                        amount: i,
                        cartType: Dp.SPECIAL_OFFERS,
                        itemType: wp.FREEBIE_OFFER,
                        itemId: e.payment.productId
                    })
                }
                ,
                t.prototype.sendEvent = function(e) {
                    var t = e.currency
                      , i = e.amount
                      , n = e.cartType
                      , r = e.itemType
                      , o = e.itemId;
                    this._service.reportBusinessEvent(null == t ? void 0 : t.toUpperCase(), i, r, o, n)
                }
                ,
                t
            }(dn), kp = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.sendEvent = function(e) {}
                ,
                t
            }(dn);
            !function(e) {
                e.MERGE = "merge",
                e.COLLECT = "collect",
                e.CLEAR_NATURE = "clearNature",
                e.CLEAR_HARVESTABLE = "clearHarvestable",
                e.LEVELUP = "levelup",
                e.EXPAND = "expand",
                e.REPAIR = "repair",
                e.FREE_GEMS = "freeGems",
                e.RV_GEMS = "RV_gems",
                e.REGENERATION = "regeneration",
                e.ENERGY_SHOP_RV = "energyShopRV",
                e.ENERGY_SHOP_GEMS = "energyShopGems",
                e.FAST_FORWARD_NATURE = "fastForwardNature",
                e.FAST_FORWARD_TOOLBOX = "fastForwardToolbox",
                e.FAST_FORWARD_HARVEST = "fastForwardHarvest",
                e.FAST_FORWARD_GREENHOUSE = "fastForwardGreenhouse",
                e.FAST_FORWARD_ORDER = "fastForwardOrder",
                e.BUY_MISSING_INGREDIENTS = "buyMissingIngredients",
                e.INVITE_FRIENDS_FOR_CRATES = "inviteFriendsForCrates",
                e.VISITOR_REWARD = "visitorReward",
                e.VISIT_REWARD = "visitReward",
                e.RV_CRATES = "RVCrates",
                e.OPEN_CRATE = "openCrate",
                e.VISIT_FRIEND = "visitFriend",
                e.PREMIUM_AREA = "premiumArea",
                e.CLAIM_REWARD = "claimReward",
                e.MARKETPLACE = "marketplace"
            }(Bp || (Bp = {})),
            new Map([[Cn.WOOD, mp.WOOD], [Cn.STONE, mp.STONE], [Cn.COINS, mp.COINS]]);
            var xp, Gp = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.gemsForEnergy = function(e) {
                    this.processEvent({
                        currency: mp.GEMS,
                        amount: e,
                        itemType: Ep.ENERGY,
                        itemId: Bp.ENERGY_SHOP_GEMS
                    })
                }
                ,
                t.prototype.gemsForFF = function(e, t) {
                    this.processEvent({
                        currency: mp.GEMS,
                        amount: e,
                        itemType: Ep.PURCHASE,
                        itemId: t
                    })
                }
                ,
                t.prototype.gemsForMarketplaceItem = function(e) {
                    this.processEvent({
                        currency: mp.GEMS,
                        amount: e,
                        itemType: Ep.PURCHASE,
                        itemId: Bp.MARKETPLACE
                    })
                }
                ,
                t.prototype.premiumLandPurchased = function(e) {
                    this.processEvent({
                        currency: mp.GEMS,
                        amount: e,
                        itemType: Ep.PURCHASE,
                        itemId: Bp.PREMIUM_AREA
                    })
                }
                ,
                t.prototype.sendEvent = function(e) {
                    var t = e.currency
                      , i = e.amount
                      , n = e.itemType
                      , r = e.itemId;
                    this._service.reportSinkEvent(t, i, n, r)
                }
                ,
                t
            }(dn), Up = new Map([[Cn.ENERGY, mp.ENERGY], [Cn.GEMS, mp.GEMS], [Cn.CRATES, mp.CRATES], [Cn.COINS, mp.COINS], [Cn.TICKETS, mp.TRAIN_TICKET]]), Fp = new Map([[Ma.FREE, Bp.FREE_GEMS], [Ma.AD, Bp.RV_GEMS]]), Mp = new Map([[Ma.Inventory, Bp.ENERGY_SHOP_GEMS], [Ma.AD, Bp.ENERGY_SHOP_RV]]), Vp = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.collect = function(e, t) {
                    var i = Ep.MERGABLE_OBJECTS;
                    if (t !== Cn.TICKETS) {
                        var n = Up.get(t);
                        n && this.processEvent({
                            currency: n,
                            amount: e,
                            itemType: i,
                            itemId: Bp.COLLECT
                        })
                    }
                }
                ,
                t.prototype.itemSpawn = function(e, t) {
                    t <= 0 || e.includes("upgrade_card") && De.services.analytics.design.reportUpgradeCardSpawned(e)
                }
                ,
                t.prototype.levelUPRewards = function(e, t) {
                    var i = Up.get(t);
                    i === mp.GEMS && this.processEvent({
                        currency: i,
                        amount: e,
                        itemType: Ep.PROGRESSION,
                        itemId: Bp.LEVELUP
                    })
                }
                ,
                t.prototype.gemsFromGameShop = function(e, t) {
                    var i = Fp.get(t);
                    this.processEvent({
                        currency: mp.GEMS,
                        amount: e,
                        itemType: Ep.GEM_SHOP,
                        itemId: i
                    })
                }
                ,
                t.prototype.purchaseFromMarketPlace = function(e, t) {
                    t !== mp.CRATES && this.processEvent({
                        currency: t,
                        amount: e,
                        itemType: Ep.PURCHASE,
                        itemId: Bp.MARKETPLACE
                    })
                }
                ,
                t.prototype.energyFromGameShop = function(e, t) {
                    var i = Mp.get(t);
                    i !== Bp.ENERGY_SHOP_RV && this.processEvent({
                        currency: mp.ENERGY,
                        amount: e,
                        itemType: Ep.ENERGY,
                        itemId: i
                    })
                }
                ,
                t.prototype.claimDiscoveryReward = function(e) {
                    this.processEvent({
                        currency: mp.GEMS,
                        amount: e,
                        itemType: Ep.DISCOVERY_DIARY,
                        itemId: Bp.CLAIM_REWARD
                    })
                }
                ,
                t.prototype.sendEvent = function(e) {
                    var t = e.currency
                      , i = e.amount
                      , n = e.itemType
                      , r = e.itemId;
                    this._service.reportSourceEvent(t, i, n, r)
                }
                ,
                t
            }(dn), Hp = 864e5, jp = function(e) {
                function t() {
                    var t, i = e.call(this) || this;
                    i.source = new Vp(i),
                    i.sink = new Gp(i),
                    i.progression = new kp(i),
                    i.design = new pn(i),
                    i.business = new Pp(i),
                    i.model = new Lp,
                    i.tests = new Kn(i.model),
                    i.startTime = Date.now(),
                    i.totalMoneySpentIncreased = new r.Event,
                    i._logger = Ie.Of("AnalyticsService", ((t = {})[r.LogLevel.INFO] = ["color: white", "background: #C80815", "display: block", "padding: 5px"],
                    t)),
                    i._allowLogs = !1,
                    i._playerId = null,
                    i._platform = "UNKNOWN",
                    i._customDimensions = [],
                    i._noConnectionOverlayShowAmount = 0;
                    var n = "1187013846746005515.discordsays.com/analytics";
                    return Tu.http.GAHTTPApi.instance.baseUrl = "https://".concat(n, "/v2"),
                    Tu.http.GAHTTPApi.instance.hostName = "".concat(n),
                    Tu.http.GAHTTPApi.instance.remoteConfigsBaseUrl = "https://".concat(n, "/remote_configs/v1"),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "allowLogs", {
                    set: function(e) {},
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "logger", {
                    get: function() {
                        return this._logger
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "noConnectionOverlayShowAmount", {
                    get: function() {
                        return this._noConnectionOverlayShowAmount
                    },
                    set: function(e) {
                        this._noConnectionOverlayShowAmount = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.update = function() {
                    Tu.state.GAState.isEventSubmissionEnabled() && Tu.state.GAState.isEnabled() && (v.GroupsCore.Updateables.remove(this),
                    [this.source, this.sink, this.progression, this.design, this.business].forEach((function(e) {
                        return e.start()
                    }
                    )))
                }
                ,
                t.prototype.initialize = function(t) {
                    e.prototype.initialize.call(this, t),
                    this.design.setQualitySettingsAlias(t.assetLoader.qualitySettingsAlias)
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this.services.autosave.registerModel(this.model)];
                            case 1:
                                return n.sent(),
                                [4, this.tests.initialize()];
                            case 2:
                                return n.sent(),
                                [4, vp.platform.deviceStrategy.getDevice()];
                            case 3:
                                return e = n.sent(),
                                t = bp.analyticsId,
                                Tu.GameAnalytics.setEnabledInfoLog(!1),
                                Tu.GameAnalytics.setEnabledVerboseLog(!1),
                                i = "1.46.0-1" + ((0,
                                r.isNull)(this.tests.group) ? "" : "~" + xn[this.tests.group]),
                                Tu.GameAnalytics.configureBuild(i),
                                Tu.GameAnalytics.configureUserId(t),
                                Tu.device.GADevice.deviceModel = e,
                                Tu.GameAnalytics.configureAvailableResourceCurrencies(Object.values(mp)),
                                Tu.GameAnalytics.configureAvailableResourceItemTypes(Object.values(Ep)),
                                [4, this._initiateCustomDimensions()];
                            case 4:
                                return n.sent(),
                                Tu.GameAnalytics.initialize("bc94da2219a0c03b1c3ac298bed49a2d", "83cc35aaa4c916b0561ffe0ca201f6e834250f0b"),
                                this.services.navigation.onSceneChanged.listenOnce(this._startFPSReporting, this),
                                v.GroupsCore.Updateables.add(this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.startSession = function() {
                    Tu.GameAnalytics.startSession()
                }
                ,
                t.prototype.setPlayerId = function(e) {
                    this._playerId = e
                }
                ,
                t.prototype.setPlatform = function(e) {
                    this._platform = e || this._platform
                }
                ,
                t.prototype.updateCustomDimensions = function() {
                    this._customDimensions.forEach((function(e) {
                        return e.update()
                    }
                    ))
                }
                ,
                t.prototype.incrementSession = function() {
                    this.model.incrementSession()
                }
                ,
                t.prototype.incrementDays = function(e) {
                    var t = 0 === this.model.totalDays
                      , i = Math.floor(this.model.enteredLastTime / Hp);
                    (Math.floor(e / Hp) > i || t) && this.model.incrementDays(e)
                }
                ,
                t.prototype.increaseTotalMoneySpent = function(e) {
                    this.model.addToTotalSpent(e),
                    this.updateCustomDimensions(),
                    this.totalMoneySpentIncreased.fire(this.model.totalSpent)
                }
                ,
                t.prototype.setUAEntryPoint = function(e) {
                    Lu.setValue(e)
                }
                ,
                t.prototype.saveStepStartStatus = function(e) {
                    this.model.saveStepStartStatus(e)
                }
                ,
                t.prototype.saveStepFinishStatus = function(e) {
                    this.model.saveStepFinishStatus(e)
                }
                ,
                t.prototype.wasStepStartEventSent = function(e) {
                    return !(0,
                    r.isUndefined)(this.model.onboardingSteps[e])
                }
                ,
                t.prototype.wasStepFinishEventSent = function(e) {
                    return this.wasStepStartEventSent(e) && !0 === this.model.onboardingSteps[e]
                }
                ,
                t.prototype.destroy = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return Tu.GameAnalytics.endSession(),
                            null === (e = this.services) || void 0 === e || e.autosave.unregisterModel(this.model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.reportDesignEvent = function(e, t) {
                    this._allowLogs && (t && e.push(t.toString()),
                    this.logger.info(e.join(":") + " ")),
                    Tu.GameAnalytics.addDesignEvent(e.join(":"), t)
                }
                ,
                t.prototype.reportSourceEvent = function(e, t, i, n) {
                    Tu.GameAnalytics.addResourceEvent(Tu.EGAResourceFlowType.Source, e, t, i, n)
                }
                ,
                t.prototype.reportSinkEvent = function(e, t, i, n) {
                    Tu.GameAnalytics.addResourceEvent(Tu.EGAResourceFlowType.Sink, e, t, i, n)
                }
                ,
                t.prototype.reportBusinessEvent = function(e, t, i, n, r) {
                    Tu.GameAnalytics.addBusinessEvent(e, t, i, n, r)
                }
                ,
                t.prototype._initiateCustomDimensions = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                e = 0,
                                n.label = 1;
                            case 1:
                                return e < vp.platform.analyticsDimensions.length ? (t = vp.platform.analyticsDimensions[e],
                                i = new t(e + 1),
                                this._customDimensions.push(i),
                                [4, i.initialize()]) : [3, 4];
                            case 2:
                                n.sent(),
                                n.label = 3;
                            case 3:
                                return e++,
                                [3, 1];
                            case 4:
                                return this._customDimensions.forEach((function(e) {
                                    return e.update()
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._startFPSReporting = function() {
                    var e = this;
                    setTimeout((function() {
                        if (e.services.pageVisibility.isFocused) {
                            var t = e.services.fps.getAverageFPS(60);
                            e.design.fps(t)
                        }
                    }
                    ), 6e4)
                }
                ,
                t
            }(Se), Kp = function(e) {
                function t(t, i) {
                    var n = e.call(this, t.assetManifest, t.qualitySetting, i) || this;
                    return n.qualitySettingsAlias = t.qualitySetting.alias,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e) {
                    this.services = e
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(v.AssetLoader), Wp = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e) {
                    this.services = e
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(v.LoadedResourceContainer), zp = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n._preAdMusicEnabled = !1,
                    n._preAdSoundEnabled = !1,
                    n._muteSounds = t,
                    n._unmuteSounds = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return this.services.adsService.onAdStart.addListener(this._onAdStart, this),
                    this.services.adsService.onAdFinish.addListener(this._onAdFinished, this),
                    Promise.resolve()
                }
                ,
                t.prototype.destroy = function() {
                    return this.services.adsService.onAdStart.removeListener(this._onAdStart, this),
                    this.services.adsService.onAdFinish.removeListener(this._onAdFinished, this),
                    Promise.resolve()
                }
                ,
                t.prototype._onAdStart = function() {
                    this._preAdSoundEnabled = this.services.settings.get("sfxEnabled"),
                    this._preAdMusicEnabled = this.services.settings.get("musicEnabled"),
                    this._muteSounds()
                }
                ,
                t.prototype._onAdFinished = function() {
                    this._unmuteSounds(this._preAdMusicEnabled, this._preAdSoundEnabled)
                }
                ,
                t
            }(Se), Yp = i(2213), Jp = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._playingMusic = new Map,
                    t._playingSoundEffects = new Map,
                    t._adsVisibilityService = new zp((function() {
                        t.services.settings.set("sfxEnabled", !1),
                        t.services.settings.set("musicEnabled", !1),
                        t._updateMusicVolume(!1),
                        t._updateSoundEffectsVolume(!1)
                    }
                    ),(function(e, i) {
                        t.services.settings.set("sfxEnabled", i),
                        t.services.settings.set("musicEnabled", e),
                        t._updateMusicVolume(e),
                        t._updateSoundEffectsVolume(i)
                    }
                    )),
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isSoundEnabled", {
                    get: function() {
                        return this.services.settings.get("sfxEnabled")
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isMusicEnabled", {
                    get: function() {
                        return this.services.settings.get("musicEnabled")
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.initialize = function(t) {
                    e.prototype.initialize.call(this, t),
                    this._adsVisibilityService.initialize(t),
                    Yp.sound.volumeAll = 0
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, Promise.all([this.services.assetLoader.loadJsons(_e.AUDIO_CONFIG)])];
                            case 1:
                                return i.sent(),
                                this._config = this.services.resource.getJson(_e.AUDIO_CONFIG),
                                this._adsVisibilityService.start(),
                                e = this._playSoundEffect.bind(this),
                                this._playSoundEffect = function() {}
                                ,
                                De.services.lazyLoad.getLoadingPromise(hn.SFX).then((function() {
                                    return t._playSoundEffect = e
                                }
                                )),
                                this.services.pageVisibility.onPageHidden.addListener(this._muteSoundsOnPageHidden, this),
                                this.services.pageVisibility.onPageFocused.addListener(this._unmuteSoundsOnPageFocused, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._playingSoundEffects.forEach((function(e) {
                                return e.stop()
                            }
                            )),
                            this._playingMusic.forEach((function(e) {
                                return e.stop()
                            }
                            )),
                            this._adsVisibilityService.destroy(),
                            this.services.pageVisibility.onPageHidden.removeListener(this._muteSoundsOnPageHidden, this),
                            this.services.pageVisibility.onPageFocused.removeListener(this._unmuteSoundsOnPageFocused, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.toggleSounds = function() {
                    this.services.settings.set("sfxEnabled", !this.services.settings.get("sfxEnabled")),
                    this._updateSoundEffectsVolume(this.isSoundEnabled)
                }
                ,
                t.prototype.toggleMusic = function() {
                    this.services.settings.set("musicEnabled", !this.services.settings.get("musicEnabled")),
                    this._updateMusicVolume(this.isMusicEnabled)
                }
                ,
                t.prototype.playBackgroundMusic = function() {
                    var e = this;
                    this._playingMusic.has(m.MAIN_MUSIC_LOOP.alias) || (De.services.lazyLoad.getLoadingPromise(hn.MUSIC).then((function() {
                        e._playMusic(m.MAIN_MUSIC_LOOP),
                        e._playMusic(m.AMBIENCE_FARM)
                    }
                    )),
                    this._fadeInAllMusic())
                }
                ,
                t.prototype.playSoundEffect = function(e) {
                    this._playSoundEffect(e)
                }
                ,
                t.prototype.stopSoundEffect = function(e) {
                    this._stopAndRemoveSoundEffect(e)
                }
                ,
                t.prototype._playMusic = function(e) {
                    var t = this._config.music[e.alias] || {
                        alias: "dummy",
                        volume: 1
                    }
                      , i = t.alias
                      , n = t.volume
                      , r = t.loop
                      , o = void 0 !== r && r;
                    if ("dummy" !== i) {
                        var a = v.AudioManager.play({
                            alias: i
                        }, void 0, o);
                        this._playingMusic.set(e.alias, a),
                        a.volume = this.isMusicEnabled ? n : 0
                    } else
                        this._logger.warn("There is no music with alias: ".concat(e.alias))
                }
                ,
                t.prototype._playSoundEffect = function(e) {
                    var t = this;
                    this._stopAndRemoveSoundEffect(e);
                    var i = this._config.soundEffects[e.alias] || {
                        alias: "dummy",
                        volume: 1
                    }
                      , n = i.alias
                      , r = i.volume
                      , o = i.loop
                      , a = void 0 !== o && o;
                    if ("dummy" !== n) {
                        var s = v.AudioManager.play({
                            alias: n
                        }, (function() {
                            return t._stopAndRemoveSoundEffect(e)
                        }
                        ), a);
                        s.volume = this.isSoundEnabled ? r : 0,
                        this._playingSoundEffects.set(e.alias, s)
                    } else
                        this._logger.warn("There is no sound effect with alias: ".concat(e.alias))
                }
                ,
                t.prototype._stopAndRemoveSoundEffect = function(e) {
                    var t = this._playingSoundEffects.get(e.alias);
                    t && (t.stop(),
                    this._playingSoundEffects.delete(e.alias))
                }
                ,
                t.prototype._updateMusicVolume = function(e) {
                    var t = this;
                    this._playingMusic.forEach((function(i, n) {
                        return i.volume = e ? t._config.music[n].volume : 0
                    }
                    ))
                }
                ,
                t.prototype._updateSoundEffectsVolume = function(e) {
                    var t = this;
                    this._playingSoundEffects.forEach((function(i, n) {
                        return i.volume = e ? t._config.soundEffects[n].volume : 0
                    }
                    ))
                }
                ,
                t.prototype._testSoundEffects = function() {
                    var e = (0,
                    n.__assign)((0,
                    n.__assign)({}, this._config.soundEffects), this._config.music);
                    Object.keys(m).forEach((function(t, i) {
                        var n = m[t]
                          , r = e[n.alias]
                          , o = r.alias
                          , a = r.volume
                          , s = r.loop
                          , _ = void 0 !== s && s;
                        setTimeout((function() {
                            v.AudioManager.play({
                                alias: o
                            }, void 0, _).volume = a
                        }
                        ), 1e3 * i)
                    }
                    ))
                }
                ,
                t.prototype._muteSoundsOnPageHidden = function() {
                    this._updateMusicVolume(!1),
                    this._updateSoundEffectsVolume(!1)
                }
                ,
                t.prototype._unmuteSoundsOnPageFocused = function() {
                    this._updateMusicVolume(this.isMusicEnabled),
                    this._updateSoundEffectsVolume(this.isSoundEnabled)
                }
                ,
                t.prototype._fadeInAllMusic = function() {
                    lr.gsap.to(Yp.sound, {
                        volumeAll: 1,
                        duration: this._config.settings.fadeInTime,
                        ease: as.Yv.easeIn
                    })
                }
                ,
                t
            }(Se), Xp = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.onPageHidden = new r.Event,
                    t.onPageFocused = new r.Event,
                    t._hidden = "",
                    t._visibilityChange = "",
                    t._onVisibilityChange = t._onVisibilityChange.bind(t),
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isFocused", {
                    get: function() {
                        return !document[this._hidden]
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return void 0 !== document.hidden ? (this._hidden = "hidden",
                            this._visibilityChange = "visibilitychange") : void 0 !== document.msHidden ? (this._hidden = "msHidden",
                            this._visibilityChange = "msvisibilitychange") : void 0 !== document.webkitHidden && (this._hidden = "webkitHidden",
                            this._visibilityChange = "webkitvisibilitychange"),
                            void 0 === document.addEventListener || void 0 === this._hidden ? this._logger.error("requires a browser, such as Google Chrome or Firefox, that supports the Page Visibility API.") : document.addEventListener(this._visibilityChange, this._onVisibilityChange, !1),
                            [2, Promise.resolve()]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return document.removeEventListener(this._visibilityChange, this._onVisibilityChange, !1),
                    Promise.resolve()
                }
                ,
                t.prototype._onVisibilityChange = function() {
                    document[this._hidden] ? this.onPageHidden.fire() : this.onPageFocused.fire()
                }
                ,
                t
            }(Se);
            !function(e) {
                e[e.SUCCESS = 0] = "SUCCESS",
                e[e.FAIL = 1] = "FAIL",
                e[e.NOT_INITIALIZED = 2] = "NOT_INITIALIZED",
                e[e.NO_CONNECTION = 3] = "NO_CONNECTION",
                e[e.ALREADY_SAVING = 4] = "ALREADY_SAVING"
            }(xp || (xp = {}));
            var qp = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._initialized = !1,
                    t._unsavedChanges = {},
                    t._changesBeingSaved = {},
                    t._intervalID = -1,
                    t._registeredModels = new Set,
                    t._forceSaveFlag = !1,
                    t._lastSaveTimeStamp = 0,
                    t._lastSuccessfulSaveTimeStamp = Date.now(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "timeSinceLastSave", {
                    get: function() {
                        return Date.now() - this._lastSuccessfulSaveTimeStamp
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._initializationPromise || (this._startInterval(),
                            this.services.canvas.ticker.add(this._onTick, this),
                            this._initialized = !0,
                            this._nextSaveSuccessPromise = new Promise((function(t, i) {
                                e._nextSaveSuccessPromiseResolve = t
                            }
                            ))),
                            this._initializationPromise = Promise.resolve(),
                            [2, this._initializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._registeredModels.forEach((function(t) {
                                return t.onSavableDataChange.removeListener(e._onSavableDataChangedHandler, e)
                            }
                            )),
                            this._registeredModels.clear(),
                            window.clearInterval(this._intervalID),
                            this._intervalID = -1,
                            this.services.canvas.ticker.remove(this._onTick, this),
                            this._initializationPromise = void 0,
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.registerModel = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return e.isSavable ? this._registeredModels.has(e) ? (this._logger.error("Model ".concat(e.name, " is already registered to autosave service")),
                                Zn.error(new Error("Model ".concat(e.name, " is already registered to autosave service"))),
                                [2]) : (this._registeredModels.add(e),
                                [4, e.initialize()]) : [2];
                            case 1:
                                return t.sent(),
                                e.onSavableDataChange.addListener(this._onSavableDataChangedHandler, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.unregisterModel = function(e) {
                    this._registeredModels.has(e) ? (this._registeredModels.delete(e),
                    e.onSavableDataChange.removeListener(this._onSavableDataChangedHandler, this),
                    this._logger.info("Model ".concat(e.name, " was unregistered from autosave service"))) : this._logger.warn("Model ".concat(e.name, " is not registered to autosave service"))
                }
                ,
                t.prototype.forceSave = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return De.services.cheats.allowSave ? (this._forceSaveFlag = !0,
                            e = this._nextSaveSuccessPromise,
                            this._flushUnsavedData(),
                            [2, e]) : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._flushUnsavedData = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return De.services.cheats.allowSave ? this._isEmpty(this._unsavedChanges) ? (this._logger.info("No changes to save"),
                            Zn.breadcrumbs.saveData("cancelled", ["no changes"]),
                            [2, xp.SUCCESS]) : this._initialized ? this.services.connection.isConnected ? this._isEmpty(this._changesBeingSaved) ? (this._changesBeingSaved = this._unsavedChanges,
                            this._unsavedChanges = {},
                            this._logger.debug("beginning data flush ..."),
                            this._logger.debug("saving ".concat(Object.keys(this._changesBeingSaved).length, " entries")),
                            Zn.breadcrumbs.saveData("begin", Object.keys(this._changesBeingSaved)),
                            this._currentSaveSuccessPromiseResolve = this._nextSaveSuccessPromiseResolve,
                            this._nextSaveSuccessPromise = new Promise((function(t, i) {
                                e._nextSaveSuccessPromiseResolve = t
                            }
                            )),
                            this._forceSaveFlag = !1,
                            [2, this.services.playerData.playerDataContainer.savePlayerData(this._changesBeingSaved).then((function() {
                                var t;
                                return e._logger.debug("save success"),
                                Zn.breadcrumbs.saveData("success", Object.keys(e._changesBeingSaved)),
                                e._changesBeingSaved = {},
                                null === (t = e._currentSaveSuccessPromiseResolve) || void 0 === t || t.call(e),
                                e._forceSaveFlag && e._flushUnsavedData(),
                                xp.SUCCESS
                            }
                            ), (function(t) {
                                return e._logger.debug("save failed,  ".concat(t)),
                                e._logger.warn("Player data was not saved ".concat((0,
                                r.isObject)(t) ? JSON.stringify(t) : t)),
                                Zn.breadcrumbs.saveData("failure", Object.keys(e._changesBeingSaved)),
                                Zn.error(t),
                                e._unsavedChanges = (0,
                                n.__assign)((0,
                                n.__assign)({}, e._changesBeingSaved), e._unsavedChanges),
                                e._changesBeingSaved = {},
                                xp.FAIL
                            }
                            ))]) : (this._logger.info("Already flushing data"),
                            Zn.breadcrumbs.saveData("cancelled", ["already saving"]),
                            [2, xp.ALREADY_SAVING]) : (this._logger.warn("Trying to autosave data when not connected"),
                            Zn.breadcrumbs.saveData("cancelled", ["not connected"]),
                            [2, xp.NO_CONNECTION]) : (this._logger.warn("Trying to autosave data before dataService is initialized"),
                            Zn.breadcrumbs.saveData("cancelled", ["not initialized"]),
                            [2, xp.NOT_INITIALIZED]) : [2, xp.FAIL]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onSavableDataChangedHandler = function(e) {
                    try {
                        JSON.stringify(e),
                        this._unsavedChanges = (0,
                        n.__assign)((0,
                        n.__assign)({}, this._unsavedChanges), e)
                    } catch (t) {
                        this._logger.error("Failed to save data for model", Object.keys(e)[0]),
                        Zn.error(t)
                    }
                }
                ,
                t.prototype._onTick = function() {
                    var e = Date.now();
                    e - this._lastSaveTimeStamp > 1e4 && (this._logger.error("AutoSaveService has not saved in ".concat(e - this._lastSaveTimeStamp, "ms")),
                    Zn.error(new Error("AutoSaveService has not saved in ".concat(e - this._lastSaveTimeStamp, "ms"))),
                    clearInterval(this._intervalID),
                    this._intervalID = -1,
                    this._attemptToSave(),
                    this._startInterval())
                }
                ,
                t.prototype._startInterval = function() {
                    var e = this;
                    this._lastSaveTimeStamp = Date.now(),
                    this._intervalID = window.setInterval((function() {
                        e._attemptToSave(),
                        e._lastSaveTimeStamp = Date.now()
                    }
                    ), 5e3)
                }
                ,
                t.prototype._attemptToSave = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return De.services.cheats.allowSave ? (this._logger.debug("save interval ..."),
                                this._isEmpty(this._unsavedChanges) ? [3, 2] : (this._logger.debug("... attempting to flush changed data"),
                                [4, this._flushUnsavedData()])) : [2];
                            case 1:
                                switch (e.sent()) {
                                case xp.FAIL:
                                    this._logger.debug("... failed to flush data, will try again next interval, warning user"),
                                    De.services.navigation.showSaveFailedOverlay();
                                    break;
                                case xp.SUCCESS:
                                    this._logger.debug("... successfully flushed data"),
                                    De.services.navigation.hideSaveFailedOverlay(),
                                    this._lastSuccessfulSaveTimeStamp = Date.now();
                                    break;
                                default:
                                    this._logger.debug("... data flush cancelled, will try again next interval")
                                }
                                return [3, 3];
                            case 2:
                                this._logger.debug("... nothing to save!"),
                                e.label = 3;
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._isEmpty = function(e) {
                    return 0 === Object.keys(e).length
                }
                ,
                t
            }(Se)
              , Qp = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._blueprints = new Map,
                    t._unresolvedBlueprints = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "allBlueprintsIDs", {
                    get: function() {
                        return Array.from(this._blueprints.keys())
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._initializationPromise || (this._initializationPromise = this._initialize()),
                            [2, this._initializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.addBlueprint = function(e) {
                    this._addBlueprint(e),
                    this._resolveExtensions()
                }
                ,
                t.prototype.addBlueprints = function(e) {
                    for (var t = [], i = 1; i < arguments.length; i++)
                        t[i - 1] = arguments[i];
                    (Array.isArray(e) ? e : (0,
                    n.__spreadArray)([e], t, !0)).forEach(this._addBlueprint, this),
                    this._resolveExtensions()
                }
                ,
                t.prototype.hasBlueprint = function(e) {
                    return e = e.toLowerCase(),
                    this._blueprints.has(e)
                }
                ,
                t.prototype.getBlueprint = function(e) {
                    e = e.toLowerCase();
                    var t = this._blueprints.get(e);
                    if (!t)
                        throw new Error("BlueprintLibrary.get:: no blueprint with id ".concat(e, "! run call hasBlueprint(").concat(e, "); first"));
                    return t
                }
                ,
                t.prototype._addBlueprint = function(e) {
                    var t = e.id.toLowerCase();
                    this._blueprints.has(t) && this._logger.warn("blueprint with id ".concat(e.id, " was already added to the collection")),
                    this._blueprints.set(t, e),
                    this._unresolvedBlueprints.push(t)
                }
                ,
                t.prototype._resolveExtensions = function() {
                    var e = this
                      , t = this._unresolvedBlueprints.concat([]);
                    this._unresolvedBlueprints.length = 0;
                    for (var i = {}, n = {}, o = 0; o < t.length; o++) {
                        var a = this._blueprints.get(t[o]);
                        if (!a)
                            throw new Error("Expected blueprint with id ".concat(t[o], " but it doesn't exist"));
                        if (a.extends) {
                            var s = a.extends;
                            if (this._blueprints.has(s)) {
                                var _ = n[s];
                                _ || (_ = {},
                                i[s] = _,
                                n[s] = _);
                                var c = n[a.id];
                                c ? (i[a.id] = null,
                                delete i[a.id]) : (c = {},
                                n[a.id] = c),
                                _[a.id] = c
                            } else
                                this._logger.warn("blueprint ".concat(a.id, " wants to extend from ").concat(s, ", but no such blueprint exists.")),
                                this._unresolvedBlueprints.push(a.id)
                        }
                    }
                    var l = function(t, i) {
                        var n = e._blueprints.get(i);
                        if (!n)
                            throw new Error("Expected blueprint with id ".concat(i, " but it doesn't exist"));
                        for (var o in t) {
                            var a = e._blueprints.get(o);
                            if (!a)
                                throw new Error("Expected blueprint with id ".concat(o, " but it doesn't exist"));
                            var s = {};
                            r.ObjectUtility.deepMerge(s, n.components, a.components),
                            a.components = s,
                            l(t[o], o)
                        }
                    };
                    for (var u in i)
                        l(i[u], u)
                }
                ,
                t.prototype._initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this.services.assetLoader.loadJsons(_e.BLUEPRINTS_INDEX)];
                            case 1:
                                return n.sent(),
                                e = this.services.resource.getJson(_e.BLUEPRINTS_INDEX).blueprints,
                                t = e.map((function(e) {
                                    return {
                                        alias: e
                                    }
                                }
                                )),
                                [4, this.services.assetLoader.loadJsons(t)];
                            case 2:
                                return n.sent(),
                                t.forEach((function(e) {
                                    i._addBlueprint(i.services.resource.getJsonCopy(e))
                                }
                                )),
                                this._resolveExtensions(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se)
              , Zp = (i(3819),
            "__UNIQUE__")
              , $p = 0
              , ev = function(e) {
                function t(t) {
                    var i;
                    void 0 === t && (t = Zp);
                    var n = e.call(this) || this;
                    return n.onBehaviorAdded = new r.Event,
                    n.onBehaviorRemoved = new r.Event,
                    n.id = $p++,
                    n._behaviors = new Map,
                    n._initialized = !1,
                    n._behaviorQueue = [],
                    n._isSleeping = !0,
                    n._blueprintID = t,
                    n._logger = Ie.Of("GameObject id '".concat(n.id, "', blueprint: ").concat(n._blueprintID), ((i = {})[Ae.INFO] = ["color:#6b0050"],
                    i[Ae.WARNING] = ["color:#b00084"],
                    i)),
                    n
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "behaviors", {
                    get: function() {
                        return Array.from(this._behaviors.values())
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isDestroyed", {
                    get: function() {
                        return this._destroyed
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.update = function(e, t) {
                    for (var i = 0; this._behaviorQueue.length > 0; ) {
                        var n = this._behaviorQueue.shift();
                        if (n) {
                            var r = n.behavior;
                            switch (n.operation) {
                            case "add":
                                this.hasBehavior(r.type) || this._updateAddedBehavior(r),
                                this.onBehaviorAdded.fire({
                                    gameObject: this,
                                    behavior: r
                                });
                                break;
                            case "remove":
                                this._updateRemovedBehavior(r)
                            }
                            i++
                        }
                    }
                    this._behaviorQueue.length <= 0 && (this._isSleeping = !0,
                    v.GroupsCore.Updateables.remove(this),
                    i >= 15 && this._logger.warn("Behavior workload has reached the threashold of ".concat(15, " actions per tick")))
                }
                ,
                t.prototype.destroy = function(t, i) {
                    void 0 === t && (t = {
                        children: !0
                    }),
                    void 0 === i && (i = !1),
                    i || this._logger.warn("gameObject.destroy should not be used directly in any systems!"),
                    this._behaviors.forEach((function(e) {
                        return e.onRemoved()
                    }
                    )),
                    v.GroupsCore.Updateables.remove(this),
                    e.prototype.destroy.call(this, t)
                }
                ,
                t.prototype.init = function() {
                    this._initialized ? this._logger.warn("GameObject was already initialized") : this._initialized = !0
                }
                ,
                t.prototype.getBlueprintID = function() {
                    return this._blueprintID
                }
                ,
                t.prototype.getTier = function() {
                    var e = this._blueprintID.split("_");
                    return parseFloat(e[e.length - 1]) || void 0
                }
                ,
                t.prototype.getObjectIdAndTier = function() {
                    var e = this._blueprintID.lastIndexOf("_");
                    return e ? {
                        id: this._blueprintID.substring(0, e),
                        tier: this._blueprintID.substring(e + 1)
                    } : {
                        id: this._blueprintID
                    }
                }
                ,
                t.prototype.addBehavior = function(e) {
                    this._behaviors.has(e.type) ? this._logger.warn("GameObject.addBehavior:: behavior ".concat(e.type, " already added")) : (this._updateAddedBehavior(e),
                    this._scheduleBehaviorAdd(e))
                }
                ,
                t.prototype.hasBehavior = function(e) {
                    return this._behaviors.has(e)
                }
                ,
                t.prototype.getBehavior = function(e) {
                    return this._behaviors.get(e) || null
                }
                ,
                t.prototype.replaceBehavior = function(e) {
                    var t = this.getBehavior(e.type);
                    if (t)
                        return this._scheduleBehaviorRemove(t),
                        this._scheduleBehaviorAdd(e),
                        void this._behaviors.set(e.type, e);
                    this.addBehavior(e)
                }
                ,
                t.prototype.removeBehavior = function(e) {
                    this._behaviors.has(e.type) ? this._scheduleBehaviorRemove(e) : this._logger.warn("GameObject.addBehavior:: behavior ".concat(e.type, " wasn't added"))
                }
                ,
                t.prototype.removeAllBehaviors = function() {
                    var e = this;
                    this._behaviors.forEach((function(t) {
                        e.removeBehavior(t)
                    }
                    ))
                }
                ,
                t.prototype.removeBehaviorByType = function(e) {
                    var t = this.getBehavior(e);
                    t && this.removeBehavior(t)
                }
                ,
                t.prototype.serialize = function(e) {
                    var t = {};
                    return this._behaviors.forEach((function(e) {
                        e.serializable && e.parent && (t[e.type] = e.serialize())
                    }
                    )),
                    {
                        blueprint: this._blueprintID,
                        data: t
                    }
                }
                ,
                t.prototype._attemptToAwake = function() {
                    this._behaviorQueue.length > 0 && this._isSleeping && (this._isSleeping = !1,
                    v.GroupsCore.Updateables.add(this))
                }
                ,
                t.prototype._scheduleBehaviorAdd = function(e) {
                    this._behaviorQueue.push({
                        operation: "add",
                        behavior: e
                    }),
                    this._attemptToAwake()
                }
                ,
                t.prototype._scheduleBehaviorRemove = function(e) {
                    this._behaviorQueue.push({
                        operation: "remove",
                        behavior: e
                    }),
                    this._attemptToAwake()
                }
                ,
                t.prototype._updateRemovedBehavior = function(e) {
                    e.onRemoved(),
                    this.onBehaviorRemoved.fire({
                        gameObject: this,
                        behavior: e
                    }),
                    this._behaviors.delete(e.type)
                }
                ,
                t.prototype._updateAddedBehavior = function(e) {
                    this._behaviors.set(e.type, e),
                    e.onAdded(this)
                }
                ,
                t
            }(Xe.Container)
              , tv = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.createById = function(e) {
                    if (!this.services.blueprintCollection.hasBlueprint(e))
                        throw new Error("no blueprint with id ".concat(e, " available in collection"));
                    var t = this.services.blueprintCollection.getBlueprint(e);
                    return this.createFromBlueprint(t)
                }
                ,
                t.prototype.createFromBlueprint = function(e) {
                    var t = new ev(e.id);
                    for (var i in e.components) {
                        var n = Je[i];
                        if (n) {
                            var r = new n(e.components[i]);
                            t.addBehavior(r)
                        }
                    }
                    return t.init(),
                    t
                }
                ,
                t.prototype.restoreFromBlueprint = function(e) {
                    var t = this.services.blueprintCollection.getBlueprint(e.blueprint)
                      , i = r.ObjectUtility.deepCopy(t.components)
                      , n = new ev(t.id);
                    for (var o in e.data && (i = Object.assign(i, e.data)),
                    i) {
                        var a = Je[o];
                        if (a) {
                            var s = new a(i[o]);
                            n.addBehavior(s)
                        }
                    }
                    return n.init(),
                    n
                }
                ,
                t.prototype.createFromSerializedData = function(e) {
                    if (!e.data)
                        return null;
                    if (e.blueprint === Zp)
                        return this.createFromBlueprint({
                            components: e.data,
                            id: Zp
                        });
                    if (!this.services.blueprintCollection.hasBlueprint(e.blueprint)) {
                        this._logger.warn("no blueprint id ".concat(e.blueprint, " available in library. Parsing as a unique gameobject instead"));
                        var t = {
                            components: e.data,
                            id: Zp
                        };
                        return this.createFromBlueprint(t)
                    }
                    return this.restoreFromBlueprint(e)
                }
                ,
                t.prototype.getMeaningfulCroppedName = function(e) {
                    return e.split("_").filter((function(e) {
                        return String(Number(e)) !== e
                    }
                    )).filter(Boolean).join("_")
                }
                ,
                t
            }(Se)
              , iv = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._graphs = [],
                    t._blueprintNodeMap = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._createGraphs(this.services.blueprintCollection.allBlueprintsIDs),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getNodeFromBlueprintID = function(e) {
                    return this._blueprintNodeMap.get(e)
                }
                ,
                t.prototype.getGraph = function(e) {
                    if (!this.hasGraph(e))
                        throw new Error("couldn't find graph with name ".concat(e, ", use hasGraph to check if it exists before trying to get it"));
                    return this._graphs.find((function(t) {
                        return t.name === e
                    }
                    ))
                }
                ,
                t.prototype.hasGraph = function(e) {
                    return this._graphs.some((function(t) {
                        return t.name === e
                    }
                    ))
                }
                ,
                t.prototype.getGraphNameFromBlueprintID = function(e) {
                    var t;
                    return null === (t = this.getNodeFromBlueprintID(e)) || void 0 === t ? void 0 : t.parent.name
                }
                ,
                t.prototype.getGraphFromBlueprintID = function(e) {
                    var t;
                    return null === (t = this.getNodeFromBlueprintID(e)) || void 0 === t ? void 0 : t.parent
                }
                ,
                t.prototype.getCollectItemFromBlueprint = function(e) {
                    var t = this.getGraphFromBlueprintID(e);
                    if (t) {
                        var i = this.getGraphNodesWithProperties(t, {
                            isHarvestable: !0
                        })[0];
                        return null == i ? void 0 : i.collectItem
                    }
                }
                ,
                t.prototype.getCollectableInventoryItemsFromBlueprint = function(e) {
                    var t = this.getCollectItemFromBlueprint(e);
                    if (!t)
                        return [];
                    var i = this.services.blueprintCollection.getBlueprint(t).components.collectable;
                    return i ? i.reward.map((function(e) {
                        return e.key
                    }
                    )) : []
                }
                ,
                t.prototype.getGraphNodesWithProperties = function(e, t) {
                    return e.nodes.filter((function(e) {
                        return ve(t.isMergeable) ? ve(t.isHarvestable) ? !!ve(t.isCollectable) || e.isCollectable === t.isCollectable : e.isHarvestable === t.isHarvestable : e.isMergeable === t.isMergeable
                    }
                    ))
                }
                ,
                t.prototype._createGraphs = function(e) {
                    var t = this
                      , i = [];
                    e.forEach((function(e) {
                        var n = De.services.blueprintCollection.getBlueprint(e);
                        !n.components.collectable || n.components.mergeable ? t._shouldBeAddedToGraph(n) && t._addMergeableBlueprintToGraph(n) : i.push(n)
                    }
                    )),
                    this._updateGraphsWithCollectables(i)
                }
                ,
                t.prototype._shouldBeAddedToGraph = function(e) {
                    return !ve(e.components.mergeable) || !ve(e.components.harvestable) && !ve(e.components.harvestable.harvestReward) || !ve(e.components.upgradeCard) || !ve(e.components.flower)
                }
                ,
                t.prototype._updateGraphsWithCollectables = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        var i = t._getGraphByCollectable(e.id);
                        i && t._insertGraphNode(i, t._createGraphNode(e, i))
                    }
                    ))
                }
                ,
                t.prototype._addMergeableBlueprintToGraph = function(e) {
                    var t = De.services.gameObjectFactory.getMeaningfulCroppedName(e.id);
                    if (this.hasGraph(t))
                        this._insertGraphNode(this.getGraph(t), this._createGraphNode(e, this.getGraph(t)));
                    else {
                        var i = this._createGraph(t);
                        this._insertGraphNode(i, this._createGraphNode(e, i)),
                        this._graphs.push(i)
                    }
                }
                ,
                t.prototype._createGraph = function(e) {
                    return {
                        name: e,
                        nodes: []
                    }
                }
                ,
                t.prototype._createGraphNode = function(e, t) {
                    var i = {
                        ID: e.id,
                        parent: t,
                        value: this._getTierValue(e.id),
                        tier: this._getTier(e.id),
                        isMergeable: Ke.Mergeable in e.components,
                        isHarvestable: Ke.Harvestable in e.components,
                        isCollectable: Ke.Collectable in e.components,
                        collectItem: Ke.Harvestable in e.components ? e.components.harvestable.harvestReward[0][0].items[0].key : void 0
                    };
                    return this._blueprintNodeMap.set(e.id, i),
                    i
                }
                ,
                t.prototype._insertGraphNode = function(e, t) {
                    0 !== e.nodes.length && (e.nodes[e.nodes.length - 1].next = t),
                    t.previous = e.nodes[e.nodes.length - 1],
                    e.nodes.push(t)
                }
                ,
                t.prototype._getGraphByCollectable = function(e) {
                    return this._graphs.find((function(t) {
                        return t.nodes[t.nodes.length - 1].collectItem === e
                    }
                    ))
                }
                ,
                t.prototype._getTierValue = function(e) {
                    var t = parseFloat(e.split("_")[1]);
                    return t ? Math.pow(3, t - 1) : void 0
                }
                ,
                t.prototype._getTier = function(e) {
                    var t = e.split("_");
                    return parseFloat(t[t.length - 1]) || void 0
                }
                ,
                t
            }(Se);
            function nv(e) {
                return !0 === e.isWorkshop
            }
            var rv, ov, av, sv, _v = [{
                name: "moveAndScale",
                duration: .3,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 1,
                        ease: "circ.in",
                        params: {
                            position: {
                                y: -150
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "none",
                        params: {
                            scale: {
                                x: .1,
                                y: .1
                            }
                        }
                    }]
                }
            }], cv = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.HIGH,
                    i._name = "BuildingUpgradePopup",
                    i._canClose = !1,
                    i._buildingID = t.buildingId,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a, s, _, c, l, u, d = this;
                        return (0,
                        n.__generator)(this, (function(h) {
                            switch (h.label) {
                            case 0:
                                if (e(),
                                !(t = De.services.buildings.getBuildingLevelConfig(this._buildingID).upgradeOverlay))
                                    throw new Error("missing discover overlay config for building ".concat(this._buildingID));
                                return i = De.services.resource.getTexture({
                                    alias: t.oldImageKey
                                }),
                                o = De.services.resource.getTexture({
                                    alias: t.newImageKey
                                }),
                                a = {
                                    alias: De.services.buildings.getBuildingConfigProperty(this._buildingID, "nameKey")
                                },
                                s = {
                                    alias: t.messageKey
                                },
                                (_ = new v.LabelSettings({
                                    fitToBox: !0,
                                    fitWidth: 877,
                                    fitHeight: 361
                                })).style = vn.buildingRepairedText,
                                (c = this.addChild(new v.Label(nr(ov || (ov = (0,
                                n.__makeTemplateObject)(["", "", ""], ["", "", ""])), s, nr(rv || (rv = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), a)),_))).scale.set(0),
                                c.anchor.set(.5),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return h.sent(),
                                this._beamsAnimation = this.addChild(De.services.resource.getSpine(se.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP)),
                                this._beamsAnimation.alpha = 0,
                                this._genericFadeAnimation = new ur(B_),
                                this._genericFadeAnimation.setTargets({
                                    container: this._beamsAnimation
                                }),
                                this._moveAndScaleAnimation = new ur(_v),
                                this._moveAndScaleAnimation.setTargets({
                                    container: this._beamsAnimation
                                }),
                                this._repairedAnimation = this.addChild(De.services.resource.getSpine(se.BUILDING_REPAIR)),
                                this._repairedAnimation.skeleton.findSlot("obj_building_broken").currentSprite.texture = i,
                                this._repairedAnimation.skeleton.findSlot("obj_building_broken_glow").currentSprite.texture = i,
                                this._repairedAnimation.skeleton.findSlot("obj_building").currentSprite.texture = o,
                                this._repairedAnimation.skeleton.findSlot("building_repair_txt").currentSprite.texture = c.texture,
                                this._repairedAnimation.state.setAnimation(0, C.BUILDING_APPEAR, !1),
                                l = De.services.canvas.top + this._repairedAnimation.height + 400,
                                this._repairedAnimation.y = l,
                                this._beamsAnimation.y = l,
                                this._repairedAnimation.state.addListener({
                                    event: function(e, t) {
                                        "light_beam_appear" === t.data.name && (d._genericFadeAnimation.play("fadeIn"),
                                        d._beamsAnimation.state.setAnimation(0, k.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP, !0))
                                    }
                                }),
                                (u = new v.LabelSettings({
                                    fitToBox: !1
                                })).style = vn.lvlUpContinueText,
                                this._tapToContinueText = new v.Label(nr(av || (av = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAP_TO_CONTINUE),u),
                                this._tapToContinueText.anchor.set(.5),
                                this._tapToContinueText.position.set(0, 400),
                                this._tapToContinueText.scale.set(0),
                                this.addChild(this._tapToContinueText),
                                this._tapToContinueAnimation = new ur(U_),
                                this._tapToContinueAnimation.setTargets({
                                    continueText: this._tapToContinueText
                                }),
                                [4, r.TimeDelay.after(3e3).promise];
                            case 2:
                                return h.sent(),
                                this._tapToContinueAnimation.play("appear"),
                                this._tapToContinueAnimation.onEnd.listenOnce((function(e) {
                                    d._canClose = !0,
                                    "appear" === e && d._tapToContinueAnimation.play("loop")
                                }
                                ), this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._options = {},
                    this._tapToContinueAnimation.dispose()
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._repairedAnimation.state.setAnimation(0, C.BUILDING_HIDE, !1),
                            this._moveAndScaleAnimation.play("moveAndScale"),
                            this._genericFadeAnimation.play("fadeOut"),
                            this._tapToContinueAnimation.stop("loop"),
                            this._tapToContinueAnimation.play("hide"),
                            e.prototype.close.call(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._tryToClose = function(t) {
                    this._canClose && e.prototype._tryToClose.call(this, t)
                }
                ,
                t
            }(yr), lv = Rp({
                2: function(e) {
                    var t = {};
                    return e.repaired.forEach((function(e) {
                        return t[e] = 2
                    }
                    )),
                    {
                        buildingsState: t,
                        cooldowns: e.cooldowns
                    }
                },
                3: function(e) {
                    var t, i = {}, n = function(n) {
                        var r = null === (t = e.cooldowns.find((function(e) {
                            return e.buildingID === n
                        }
                        ))) || void 0 === t ? void 0 : t.timerId;
                        i[n] = {
                            level: 1,
                            state: e.buildingsState[n],
                            cooldownTimerID: r
                        }
                    };
                    for (var r in e.buildingsState)
                        n(r);
                    return {
                        buildings: i
                    }
                }
            });
            !function(e) {
                e[e.UNDISCOVERED = 0] = "UNDISCOVERED",
                e[e.UPGRADING = 1] = "UPGRADING",
                e[e.ACTIVE = 2] = "ACTIVE"
            }(sv || (sv = {}));
            var uv, dv, hv, pv, vv, gv, fv, Ev, mv, yv, Tv = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._version = 3,
                    t._name = "BuildingsModel",
                    t._buildings = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "cooldowns", {
                    get: function() {
                        var e = [];
                        return this._buildings.forEach((function(t, i) {
                            t.cooldownTimerID && e.push({
                                building: i,
                                timer: t.cooldownTimerID
                            })
                        }
                        )),
                        e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.getBuildingsWithState = function(e) {
                    var t = this;
                    return Object.values(E_).filter((function(i) {
                        var n;
                        return (null === (n = t._buildings.get(i)) || void 0 === n ? void 0 : n.state) === e
                    }
                    ))
                }
                ,
                t.prototype.setBuildingState = function(e, t) {
                    var i = this._buildings.get(e);
                    i || (i = {
                        level: 0,
                        state: t
                    },
                    this._buildings.set(e, i)),
                    i.state = t,
                    this.saveData()
                }
                ,
                t.prototype.setBuildingLevel = function(e, t) {
                    var i = this._buildings.get(e);
                    i || (i = {
                        level: t,
                        state: sv.UNDISCOVERED
                    },
                    this._buildings.set(e, i)),
                    i.level = t,
                    this.saveData()
                }
                ,
                t.prototype.hasBuildingData = function(e) {
                    return this._buildings.has(e)
                }
                ,
                t.prototype.setBuildingData = function(e, t, i) {
                    void 0 === i && (i = !1),
                    !this._buildings.has(e) || i ? (this._buildings.set(e, t),
                    this.saveData()) : this._logger.warn("building data for ".concat(e, " already exists. Set force to true if this is intended to be overridden"))
                }
                ,
                t.prototype.getBuildingState = function(e) {
                    var t;
                    return null === (t = this._buildings.get(e)) || void 0 === t ? void 0 : t.state
                }
                ,
                t.prototype.getBuildingLevel = function(e) {
                    var t;
                    return null === (t = this._buildings.get(e)) || void 0 === t ? void 0 : t.level
                }
                ,
                t.prototype.isActive = function(e) {
                    return this.getBuildingState(e) === sv.ACTIVE
                }
                ,
                t.prototype.isUndiscovered = function(e) {
                    return this.getBuildingState(e) === sv.UNDISCOVERED
                }
                ,
                t.prototype.isUpgrading = function(e) {
                    return this.getBuildingState(e) === sv.UPGRADING
                }
                ,
                t.prototype.addBuildingCooldown = function(e, t) {
                    var i = this._buildings.get(e);
                    i ? (i.cooldownTimerID = t,
                    this.saveData()) : this._logger.warn("no data for building with id ".concat(e, ", can't store timer"))
                }
                ,
                t.prototype.removeBuildingCooldown = function(e) {
                    var t = this._buildings.get(e);
                    t ? (t.cooldownTimerID = void 0,
                    this.saveData()) : this._logger.warn("no data for building with id ".concat(e, ", can't store timer"))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    for (var t in e.buildings)
                        this._buildings.set(t, e.buildings[t])
                }
                ,
                t.prototype.onDataSave = function() {
                    var e = {};
                    return this._buildings.forEach((function(t, i) {
                        e[i] = t
                    }
                    )),
                    {
                        buildings: e
                    }
                }
                ,
                t.prototype.migrateData = function(e) {
                    return lv(e, 3)
                }
                ,
                t
            }($n), Av = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onBuildingStateChanged = new r.Event,
                    t.onBuildingLevelChanged = new r.Event,
                    t.onCooldownFinished = new r.Event,
                    t._buildingConfigs = new Map,
                    t._model = new Tv,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "activeBuildings", {
                    get: function() {
                        return this._model.getBuildingsWithState(sv.ACTIVE)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "inactiveBuildings", {
                    get: function() {
                        return this._model.getBuildingsWithState(sv.UPGRADING).concat(this._model.getBuildingsWithState(sv.UNDISCOVERED))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "allBuildingsWithRecipes", {
                    get: function() {
                        var e = this;
                        return Object.values(E_).filter((function(t) {
                            return e.isWorkshop(t)
                        }
                        ))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._initializationPromise || (this._initializationPromise = this._initialize()),
                            [2, this._initializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.setBuildingActive = function(e, t) {
                    void 0 === t && (t = !0),
                    this._model.isActive(e) || (this._model.setBuildingState(e, sv.ACTIVE),
                    t && this.onBuildingStateChanged.fire(e),
                    this.isDecorative(e) ? De.services.analytics.design.decorativeBuildingRepaired(e) : De.services.analytics.design.buildingRepaired(e),
                    this._createBuildingAction(e))
                }
                ,
                t.prototype.isDecorative = function(e) {
                    var t = this._buildingConfigs.get(e);
                    return !!t && "decorative" === t.nameKey.split("_")[0]
                }
                ,
                t.prototype.isWorkshop = function(e) {
                    return !!this._buildingConfigs.has(e) && nv(this._buildingConfigs.get(e))
                }
                ,
                t.prototype.isBuildingActive = function(e) {
                    return this._model.isActive(e)
                }
                ,
                t.prototype.setBuildingUndiscovered = function(e) {
                    this._model.isUndiscovered(e) || this._model.setBuildingState(e, sv.UNDISCOVERED)
                }
                ,
                t.prototype.isBuildingUndiscovered = function(e) {
                    return this._model.isUndiscovered(e)
                }
                ,
                t.prototype.setBuildingUpgrading = function(e) {
                    this._model.isUpgrading(e) || (this._model.setBuildingState(e, sv.UPGRADING),
                    this.onBuildingStateChanged.fire(e),
                    this._createBuildingAction(e),
                    this.isDecorative(e) && De.services.analytics.design.decorativeBuildingDiscovered(e))
                }
                ,
                t.prototype.getUpgradeCost = function(e, t) {
                    return this.getBuildingLevelConfig(e, t).upgradeCost
                }
                ,
                t.prototype.getBuildingImageAlias = function(e, t, i) {
                    var n = this.getBuildingLevelConfig(e, t);
                    switch (i) {
                    case sv.ACTIVE:
                    default:
                        return n.visualKeys.active;
                    case sv.UNDISCOVERED:
                    case sv.UPGRADING:
                        return n.visualKeys.upgrading || n.visualKeys.active
                    }
                }
                ,
                t.prototype.getBuildingConfigProperty = function(e, t) {
                    var i = this._buildingConfigs.get(e);
                    if (!i)
                        throw new Error("no config for building id ".concat(e));
                    return i[t]
                }
                ,
                t.prototype.getBuildingLevelConfig = function(e, t) {
                    t = null != t ? t : this.getBuildingLevel(e);
                    var i = this._buildingConfigs.get(e);
                    if (!i)
                        throw new Error("no config for building id ".concat(e));
                    i.levels.length < t && (this._logger.error("requesting sprite for undefined level config, ".concat(e, " level ").concat(t)),
                    t = 1);
                    var n = i.levels[t - 1];
                    if (!n)
                        throw new Error("no config for building id ".concat(e, " at level ").concat(t));
                    return n
                }
                ,
                t.prototype.isBuildingUpgrading = function(e) {
                    return this._model.isUpgrading(e)
                }
                ,
                t.prototype.getBuildingState = function(e) {
                    return this._model.getBuildingState(e) || (this._logger.warn("no data for building ".concat(e, " in model!")),
                    sv.UNDISCOVERED)
                }
                ,
                t.prototype.getBuildingLevel = function(e) {
                    var t = this._model.getBuildingLevel(e);
                    return void 0 === t ? (this._logger.warn("no data for building ".concat(e, " in model!")),
                    0) : t
                }
                ,
                t.prototype.getCoolDownDuration = function(e) {
                    var t = this._buildingConfigs.get(e);
                    if (!t || !nv(t))
                        throw new Error("BuildingsService: the config file doesn't exist for ".concat(e));
                    return t.cooldown
                }
                ,
                t.prototype.getAvailableRecipes = function(e) {
                    var t = this._buildingConfigs.get(e);
                    return t && nv(t) ? t.availableRecipes : []
                }
                ,
                t.prototype.startCooldown = function(e) {
                    var t = 1e3 * this.getCoolDownDuration(e)
                      , i = this.services.timer.addTimer(t, "Cooldown_".concat(e));
                    this._model.addBuildingCooldown(e, i.id),
                    i.onTimerFinished.addListener(this._onCooldownTimerCompleted, this)
                }
                ,
                t.prototype.areAllBuildingsInCoolDownState = function() {
                    var e = this;
                    return this._model.getBuildingsWithState(sv.ACTIVE).every((function(t) {
                        return e.isBuildingInCoolDownState(t)
                    }
                    ))
                }
                ,
                t.prototype.isBuildingInCoolDownState = function(e) {
                    return this._model.cooldowns.some((function(t) {
                        return t.building === e
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onCooldownTimerCompleted = function(e) {
                    var t;
                    e.onTimerFinished.removeListener(this._onCooldownTimerCompleted, this);
                    var i = null === (t = this._model.cooldowns.find((function(t) {
                        return t.timer = e.id
                    }
                    ))) || void 0 === t ? void 0 : t.building;
                    i && this._removeCooldown(i)
                }
                ,
                t.prototype._removeCooldown = function(e) {
                    this._model.removeBuildingCooldown(e),
                    this.onCooldownFinished.fire(e)
                }
                ,
                t.prototype._initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, this._intializeConfigs()];
                            case 1:
                                return t.sent(),
                                [4, this.services.autosave.registerModel(this._model)];
                            case 2:
                                return t.sent(),
                                this._buildingConfigs.forEach((function(t, i) {
                                    e._model.hasBuildingData(i) || e._model.setBuildingData(i, {
                                        level: t.defaultLevel || 1,
                                        state: t.defaultState || sv.UNDISCOVERED
                                    })
                                }
                                )),
                                this._model.cooldowns.forEach((function(t) {
                                    e.services.timer.getTimerByID(t.timer).onTimerFinished.addListener(e._onCooldownTimerCompleted, e)
                                }
                                )),
                                this.onBuildingStateChanged.addListener((function(t) {
                                    if (e._model.getBuildingState(t) === sv.ACTIVE) {
                                        var i = e.getBuildingLevel(t)
                                          , n = e.getBuildingLevelConfig(t, i).upgradeOverlay;
                                        if (n) {
                                            var r = n.atlasKey;
                                            Promise.all([e.services.assetLoader.loadAtlases({
                                                alias: r
                                            }), e.services.lazyLoad.prioritizeGroup(hn.BUILDING_REPAIRED_ANIMATION)]).then((function() {
                                                return e.services.navigation.showPopup(cv, {
                                                    buildingId: t
                                                })
                                            }
                                            ))
                                        } else
                                            e._logger.error("missing upgrade overlay config for building ".concat(t))
                                    }
                                }
                                ), this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._intializeConfigs = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o, a = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this.services.assetLoader.loadJsons(_e.BUILDINGS_INDEX)];
                            case 1:
                                for (n.sent(),
                                e = this.services.resource.getJson(_e.BUILDINGS_INDEX).buildings,
                                t = [],
                                i = function(i) {
                                    var n = {
                                        alias: e[i]
                                    }
                                      , o = r.services.assetLoader.loadJsons(n).then((function() {
                                        var e = a.services.resource.getJsonCopy(n);
                                        nv(e) && e.isWorkshop && !Object.values(E_).includes(e.ID) && a._logger.error("Found workshop config with invalid BuildingsID: ".concat(e.ID, ", update BuildingsID enum to include this building.")),
                                        a._buildingConfigs.set(e.ID, e)
                                    }
                                    ));
                                    t.push(o)
                                }
                                ,
                                r = this,
                                o = 0; o < e.length; o++)
                                    i(o);
                                return [4, Promise.all(t)];
                            case 2:
                                return n.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createBuildingAction = function(e) {
                    var t = Object.values(sv)[this.getBuildingState(e)].toString().toLowerCase();
                    De.services.actions.emit("improveBuilding.".concat(e, ".").concat(t))
                }
                ,
                t
            }(Se), Cv = function() {
                function e() {
                    this.allowSavingValueChanged = new r.Event,
                    this.services = {},
                    this.isRemoveButtonActivated = !1,
                    this.isBubbleButtonActivated = !1
                }
                return Object.defineProperty(e.prototype, "allowSave", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "allCheats", {
                    get: function() {
                        return []
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "selectedItemLeftPanel", {
                    get: function() {
                        return null
                    },
                    set: function(e) {},
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.showPopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.initialize = function(e) {}
                ,
                e.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), Iv = "GET_SERVER_TIME", Sv = function(e) {
                function t(t) {
                    var i, n = e.call(this) || this;
                    return n.onConnect = new r.Event,
                    n.onDisconnect = new r.Event,
                    n.onReconnectionFailed = new r.Event,
                    n.onUserDisconnectBySingleSocket = new r.Event,
                    n._logger = Ie.Of("ConnectionService", ((i = {})[Ae.INFO] = ["color: #e0e2ff", "background: #000769"],
                    i)),
                    n._serverTimeRequestTime = 0,
                    n._lastConnectivityState = s.wt.CONNECTED,
                    n._userDisconnectBySingleSocket = !1,
                    n._sentPingAnalytics = !1,
                    n._lastPings = [],
                    n._pingRollingAverage = 0,
                    n._consecutiveHangingPings = 0,
                    n._maxConsecutiveHangingPings = 3,
                    n._nakamaProvider = t,
                    n
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isConnected", {
                    get: function() {
                        return !ze.USE_NAKAMA || this.connectivityState === s.wt.CONNECTED
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "connectivityState", {
                    get: function() {
                        return this._nakamaProvider.connectivity.state
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "ping", {
                    get: function() {
                        return this._pingRollingAverage
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.initialize = function(t) {
                    e.prototype.initialize.call(this, t),
                    this._nakamaProvider.onRPC.addListener(this._onRPCSucces, this),
                    this._nakamaProvider.onRPCRequest.addListener(this._onRPCRequest, this),
                    this._nakamaProvider.connectivity.onConnectivityStateChanged.addListener(this._handleConnectivityStateChanged, this),
                    this._nakamaProvider.connectivity.onDisconnectBySingleSocket.addListener(this._handleDisconnectBySingleSocket, this)
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._nakamaProvider.onRPC.removeListener(this._onRPCSucces, this),
                            this._nakamaProvider.onRPCRequest.removeListener(this._onRPCRequest, this),
                            this._nakamaProvider.connectivity.onConnectivityStateChanged.removeListener(this._handleConnectivityStateChanged, this),
                            this._nakamaProvider.connectivity.onDisconnectBySingleSocket.removeListener(this._handleDisconnectBySingleSocket, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.attemptReconnection = function() {
                    this._attemptReconnect(0)
                }
                ,
                t.prototype._onRPCRequest = function(e) {
                    e.id === Iv && (this._serverTimeRequestTime = Date.now(),
                    this._consecutiveHangingPings += 1,
                    this._consecutiveHangingPings >= this._maxConsecutiveHangingPings && this._handleConnectivityStateChanged())
                }
                ,
                t.prototype._onRPCSucces = function(e) {
                    e.id === Iv && (this._completePingMeasurement(),
                    this._consecutiveHangingPings = 0)
                }
                ,
                t.prototype._handleConnectivityStateChanged = function() {
                    var e = this._nakamaProvider.connectivity.state;
                    switch (e) {
                    case s.wt.CONNECTED:
                        this._lastConnectivityState !== s.wt.CONNECTED && this.onConnect.fire();
                        break;
                    case s.wt.CONNECTING:
                    case s.wt.DISCONNECTED:
                        this._lastConnectivityState === s.wt.CONNECTED && this._attemptReconnect(0);
                    case s.wt.RECONNECTING:
                    case s.wt.UNINITIALIZED:
                        this._lastConnectivityState !== s.wt.CONNECTED || this._userDisconnectBySingleSocket || this.onDisconnect.fire()
                    }
                    this._lastConnectivityState = e
                }
                ,
                t.prototype._handleDisconnectBySingleSocket = function() {
                    this._logger.info("USER CONNECTED ON DIFFERENT DEVICE"),
                    this._userDisconnectBySingleSocket = !0,
                    this.onUserDisconnectBySingleSocket.fire()
                }
                ,
                t.prototype._completePingMeasurement = function() {
                    var e = Math.max(0, Date.now() - this._serverTimeRequestTime);
                    this._lastPings.length >= 5 && this._lastPings.shift(),
                    this._lastPings.push(e),
                    this._pingRollingAverage = this._lastPings.reduce((function(e, t) {
                        return e + t
                    }
                    ), 0) / this._lastPings.length
                }
                ,
                t.prototype._attemptReconnect = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._userDisconnectBySingleSocket ? (this._logger.info("USER WAS DISCONNECTED BY OTHER DEVICE, WILL NOT RECONNECT"),
                                [2]) : 5 === e ? (this._logger.warn("FAILED ".concat(e, " RECONNECTION ATTEMPTS, STOPPING NOW!")),
                                this.onReconnectionFailed.fire(),
                                [2]) : [4, r.TimeDelay.after(5e3).promise];
                            case 1:
                                return i.sent(),
                                e += 1,
                                this._logger.info("RECONNECTION ATTEMPT: ".concat(e)),
                                this._nakamaProvider.connectivity.reconnect().then((function() {
                                    t._logger.info("SUCCESFULLY RECONNECTED")
                                }
                                )).catch((function(i) {
                                    if (i.status && 401 === i.status)
                                        return t._logger.info("USER UNAUTHORIZED, ATTEMPTING TO REAUTHENTICATE"),
                                        void IO();
                                    var n = i.message ? i.message : JSON.stringify(i);
                                    t._logger.warn("FAILED TO RECONNECT ".concat(n)),
                                    t._attemptReconnect(e)
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se), Ov = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.consentResult = function() {
                    return Promise.resolve(!0)
                }
                ,
                t
            }(Xr), bv = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.CLOSE_OFFSET_X = -60,
                    i.CLOSE_OFFSET_Y = -80,
                    i._properties = (0,
                    n.__assign)({}, t),
                    i._createBackground(i._properties.size),
                    i._createHeader(i._properties.headerBackground, i._properties.headerText, i._properties.headerStyle),
                    i._createCloseButton(i._properties.showCloseButton),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.resize = function(e) {
                    this._background.setSizes(e)
                }
                ,
                t.prototype.onCloseClick = function(e) {
                    this._closeButton.onClick(e)
                }
                ,
                t.prototype.enableCloseButton = function() {
                    this._closeButton.interactive = !0
                }
                ,
                t.prototype.disableCloseButton = function() {
                    this._closeButton.interactive = !1
                }
                ,
                t.prototype._createHeader = function(e, t, i) {
                    var r = De.services.resource.getSprite(e);
                    this.addChild(rr(r, {
                        anchor: {
                            x: .5,
                            y: 1
                        },
                        position: {
                            x: 0,
                            y: -this._background.height / 2 + 200
                        }
                    }));
                    var o = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 125,
                        fitWidth: .7 * this._properties.size.width
                    });
                    o.style = i,
                    this._header = new v.Label(nr(uv || (uv = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), t),o),
                    this._header.anchor.set(.5),
                    this._header.position.set(0, -this._background.height / 2 + 100 - 26),
                    this.addChild(this._header)
                }
                ,
                t.prototype._createBackground = function(e) {
                    var t = this._properties.popupBackground ? this._properties.popupBackground : f.POPUP_BACKGROUND_EVENT_9SLICE
                      , i = De.services.resource.getTexture(t);
                    this._background = new cr(i,i.width / 2 - 10,i.height / 2 - 10,i.width / 2 + 10,i.height / 2 + 10),
                    this._background.setSizes({
                        width: e.width,
                        height: e.height
                    }),
                    this._background.position.set(-.5 * e.width, -.5 * e.height),
                    this.addChild(this._background)
                }
                ,
                t.prototype._createCloseButton = function(e) {
                    this._closeButton = new hr({
                        name: "close",
                        buttonIdle: f.BTN_CLOSE_BIG_IDLE,
                        buttonActive: f.BTN_CLOSE_BIG_DOWN
                    }),
                    this._closeButton.position.set(this.CLOSE_OFFSET_X + this._background.width / 2, this.CLOSE_OFFSET_Y - this._background.height / 2 + 200),
                    this._closeButton.visible = e,
                    this.addChild(this._closeButton)
                }
                ,
                t
            }(Xe.Container), Rv = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._createHeader = function(t, i, n) {
                    e.prototype._createHeader.call(this, t, i, n),
                    this.addChild(rr(De.services.resource.getSprite(f.POPUP_EVENTHEADER_DAILYBONUS_ORNAMENT), {
                        anchor: {
                            x: 1,
                            y: .5
                        },
                        position: {
                            x: this._header.position.x - this._header.width / 2,
                            y: this._header.position.y
                        }
                    })),
                    this.addChild(rr(De.services.resource.getSprite(f.POPUP_EVENTHEADER_DAILYBONUS_ORNAMENT), {
                        anchor: {
                            x: 1,
                            y: .5
                        },
                        scale: {
                            x: -1,
                            y: 1
                        },
                        position: {
                            x: this._header.position.x + this._header.width / 2,
                            y: this._header.position.y
                        }
                    }))
                }
                ,
                t
            }(bv), wv = {
                leftWidth: 60,
                topHeight: 60,
                rightWidth: 60,
                bottomHeight: 60
            }, Dv = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    i.priority = _r.NORMAL,
                    i._name = "TimedEventPopup",
                    i._popupPositionOffset = 80,
                    i._canClose = !1,
                    i._options = t,
                    i._createBackground(),
                    i._options.popupPositionOffset && (i._popupPositionOffset = i._options.popupPositionOffset);
                    var n = i._options.content;
                    return n.position.set(0 + (i._options.popupSizeOffsets ? -i._options.popupSizeOffsets.width / 2 : 0), -n.height / 2 + 30 + (i._options.popupSizeOffsets ? -i._options.popupSizeOffsets.height / 2 : 0)),
                    i._content.addChild(n),
                    i._resizePopupContent(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o = this;
                        return (0,
                        n.__generator)(this, (function(a) {
                            switch (a.label) {
                            case 0:
                                return e(),
                                this._options.tapToCloseAlternative ? ((t = new v.LabelSettings({
                                    fitToBox: !1
                                })).style = vn.lightBoldMedium,
                                (i = new v.Label(nr(dv || (dv = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), this._options.tapToCloseText),t)).anchor.set(.5),
                                i.position.set(0, this._getPopupSize().height / 2 + 40),
                                i.scale.set(0),
                                this.addChild(i),
                                this._tapToCloseAnimation = new ur(U_),
                                this._tapToCloseAnimation.setTargets({
                                    continueText: i
                                }),
                                [4, r.TimeDelay.after(3e3).promise]) : [3, 2];
                            case 1:
                                a.sent(),
                                this._tapToCloseAnimation.play("appear"),
                                this._tapToCloseAnimation.onEnd.listenOnce((function(e) {
                                    o._canClose = !0,
                                    o._options.tapToCloseAnimated && "appear" === e && o._tapToCloseAnimation.play("loop")
                                }
                                ), this),
                                a.label = 2;
                            case 2:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.enableCloseButton = function() {
                    this._backGround.enableCloseButton()
                }
                ,
                t.prototype.disableCloseButton = function() {
                    this._backGround.disableCloseButton()
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.onDestroy = function() {
                    var e;
                    this._inputBlocker.interactive = !1,
                    null === (e = this._tapToCloseAnimation) || void 0 === e || e.dispose()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.close = function() {
                    var t, i;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            return null === (t = this._tapToCloseAnimation) || void 0 === t || t.stop("loop"),
                            null === (i = this._tapToCloseAnimation) || void 0 === i || i.play("hide"),
                            e.prototype.close.call(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._tryToClose = function(t) {
                    this._canClose && e.prototype._tryToClose.call(this, t)
                }
                ,
                t.prototype._createBackground = function() {
                    var e = this;
                    this._backGround = new bv({
                        size: this._getPopupSize(),
                        headerText: this._options.headerText,
                        headerBackground: this._options.headerBackground,
                        headerStyle: this._options.headerStyle,
                        showCloseButton: this._options.showCloseButton,
                        popupBackground: this._options.popupBackground
                    }),
                    this._content.addChild(this._backGround),
                    this._backGround.onCloseClick((function() {
                        e._canClose = !0,
                        e._options.onClose && e._options.onClose(),
                        e.close()
                    }
                    ))
                }
                ,
                t.prototype._getPopupSize = function() {
                    var e = 380 + Math.max(this._options.content.height, 620) - 60;
                    return {
                        width: 1080 + (this._options.popupSizeOffsets ? this._options.popupSizeOffsets.width : 0),
                        height: e + (this._options.popupSizeOffsets ? this._options.popupSizeOffsets.height : 0)
                    }
                }
                ,
                t
            }(yr), Nv = [{
                past: f.BG_DB_DAY_START_PAST,
                current: f.BG_DB_DAY_START_CURRENT
            }, {
                past: f.BG_DB_DAY_MIDDLE_PAST,
                current: f.BG_DB_DAY_MIDDLE_CURRENT,
                upcoming: f.BG_DB_DAY_MIDDLE_UPCOMING
            }, {
                past: f.BG_DB_DAY_MIDDLE_PAST,
                current: f.BG_DB_DAY_MIDDLE_CURRENT,
                upcoming: f.BG_DB_DAY_MIDDLE_UPCOMING
            }, {
                past: f.BG_DB_DAY_MIDDLE_PAST,
                current: f.BG_DB_DAY_MIDDLE_CURRENT,
                upcoming: f.BG_DB_DAY_MIDDLE_UPCOMING
            }, {
                current: f.BG_DB_DAY_END_CURRENT,
                upcoming: f.BG_DB_DAY_END_UPCOMING
            }], Lv = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.NORMAL,
                    i._name = "DailyBonusPopup",
                    i._popupPositionOffset = 200,
                    i._rewardCollected = !1,
                    i._inputBlocker.off("pointerup", void 0, i),
                    i._options = t,
                    i._createPopupVisuals(),
                    i._resizePopupContent(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    De.services.analytics.design.dailyBonusPopupShown(),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._rewardCollected ? [2] : (this._rewardCollected = !0,
                                [4, this._claimReward()]);
                            case 1:
                                return t.sent(),
                                e.prototype.close.call(this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createPopupVisuals = function() {
                    this._createBackground();
                    var e = this._createHeaderText(new Xe.Point(0,-325))
                      , t = e.position.y + e.height
                      , i = this._createDailyContent(new Xe.Point(0,t + 50))
                      , n = i.position.y + i.height / 2;
                    this._createButton(new Xe.Point(0,n + 30))
                }
                ,
                t.prototype._createBackground = function() {
                    var e = new Rv({
                        size: {
                            width: 1110,
                            height: 1150
                        },
                        headerText: this._options.headerText,
                        headerBackground: this._options.headerBackground,
                        headerStyle: this._options.headerStyle,
                        showCloseButton: !1
                    });
                    this._content.addChild(e)
                }
                ,
                t.prototype._createHeaderText = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 888
                    });
                    return t.style = vn.darkBrownMedium,
                    this._content.addChild(rr(new v.Label(nr(hv || (hv = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_DAILYBONUS_BODY),t), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: e.x,
                            y: e.y
                        }
                    }))
                }
                ,
                t.prototype._createDailyContent = function(e) {
                    var t = this
                      , i = new Xe.Container
                      , n = -505;
                    return this._options.rewards.forEach((function(e, r) {
                        var o = t._createDayContent(e, r, i, n);
                        n += o.width - 20
                    }
                    )),
                    i.position.set(e.x, e.y + i.height / 2),
                    this._content.addChild(i),
                    i
                }
                ,
                t.prototype._createDayContent = function(e, t, i, r) {
                    var o = i.addChild(new Xe.Container);
                    o.position.set(r, 0);
                    var a = t > this._options.currentDay ? "upcoming" : t === this._options.currentDay ? "current" : "past"
                      , s = o.addChild(rr(this._getDayAssetBackgroundImage(t, a), {
                        anchor: {
                            x: 0,
                            y: .5
                        }
                    }))
                      , _ = 4 === t ? 0 : -15
                      , c = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: .7 * s.width
                    });
                    c.style = "past" === a ? vn.lightGreenMedium : "current" === a ? vn.lightMedium : vn.darkGreyMedium,
                    s.addChild(rr(new v.Label("current" === a ? nr(pv || (pv = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TODAY) : nr(vv || (vv = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.DAY) + " ".concat(t + 1),c), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: s.width / 2 + _,
                            y: -s.height / 2 + 50
                        }
                    }));
                    var l = 0 === t ? 0 : 20
                      , u = i.addChild(ds(rr("past" === a ? De.services.resource.getSprite(f.ICON_DB_CHECKMARK) : this._getDayAssetItemImage(e), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: o.position.x + s.width / 2 + l,
                            y: s.y
                        }
                    }), .8 * s.width));
                    return t === this._options.currentDay && (this._currentDailyReward = e,
                    this._currentDailyRewardImage = u),
                    o
                }
                ,
                t.prototype._createButton = function(e) {
                    var t = this
                      , i = new fr({
                        name: "extraWorkerLET'sGO",
                        buttonIdle: f.BTN_EVENT_GREEN_IDLE,
                        buttonActive: f.BTN_EVENT_GREEN_DOWN
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, wv),
                        buttonSizes: {
                            width: 480,
                            height: 142
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: ce.EVENT_DAILYBONUS_BUTTON_COLLECT,
                        position: {
                            x: 0,
                            y: -7
                        }
                    });
                    i.position.set(0, e.y + i.height / 2),
                    i.onClick((function() {
                        i.disable(),
                        t.close()
                    }
                    )),
                    this._content.addChild(i)
                }
                ,
                t.prototype._getDayAssetBackgroundImage = function(e, t) {
                    var i = Nv[e][t];
                    return De.services.resource.getSprite(i)
                }
                ,
                t.prototype._getDayAssetItemImage = function(e) {
                    return De.services.resource.getSprite(us(e))
                }
                ,
                t.prototype._claimReward = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return De.services.dailyBonusService.userClaimedReward(),
                                [4, this._showClaimRewardAnimation()];
                            case 1:
                                return e.sent(),
                                De.services.analytics.design.dailyBonusCollected(this._options.currentDay + 1),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showClaimRewardAnimation = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, this._options.rewardService.giveObjectRewardWithAnimation({
                                rewardBlueprintID: this._currentDailyReward,
                                blueprintComponents: {},
                                container: this,
                                animationEndEvent: this.onClosed,
                                bubble: void 0,
                                bubblePosition: new Xe.Point(0,-200),
                                image: this._currentDailyRewardImage
                            })]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr), Bv = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "DailyBonusModel",
                    t._version = 1,
                    t._rewards = [],
                    t._currentCycleDay = 0,
                    t._lastClaimedDay = 0,
                    t._lastClaimedTime = 0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "rewards", {
                    get: function() {
                        return this._rewards
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "currentCycleDay", {
                    get: function() {
                        return this._currentCycleDay
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.setRewards = function(e) {
                    this._rewards = e,
                    this._currentCycleDay = 0,
                    this._lastClaimedDay = 0,
                    this._lastClaimedTime = 0,
                    this.saveData()
                }
                ,
                t.prototype.userClaimedReward = function() {
                    this._lastClaimedDay = (new Date).getDay(),
                    this._lastClaimedTime = (new Date).getTime(),
                    this._currentCycleDay++,
                    this.saveData()
                }
                ,
                t.prototype.clearData = function() {
                    this._rewards = [],
                    this._currentCycleDay = 0,
                    this._lastClaimedDay = 0,
                    this._lastClaimedTime = 0,
                    this.saveData()
                }
                ,
                t.prototype.hasActiveCycle = function() {
                    return this._rewards.length > 0
                }
                ,
                t.prototype.cycleHasEnded = function() {
                    return this._currentCycleDay >= this._rewards.length
                }
                ,
                t.prototype.isRewardClaimedToday = function() {
                    return this._lastClaimedDay === (new Date).getDay()
                }
                ,
                t.prototype.isCycleBroken = function() {
                    if (0 === this._lastClaimedTime)
                        return !1;
                    var e = this._lastClaimedTime
                      , t = new Date
                      , i = new Date(e);
                    i.setHours(0, 0, 0, 0);
                    var n = new Date(i);
                    return n.setDate(n.getDate() + 2),
                    t >= n
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._rewards = e.rewards,
                    this._currentCycleDay = e.currentCycleDay,
                    this._lastClaimedDay = e.lastClaimedDay,
                    this._lastClaimedTime = e.lastClaimedTime
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        rewards: this._rewards,
                        currentCycleDay: this._currentCycleDay,
                        lastClaimedDay: this._lastClaimedDay,
                        lastClaimedTime: this._lastClaimedTime
                    }
                }
                ,
                t
            }($n), Pv = ["wheat_1", "wheat_1", "wheat_1", "wheat_1", "wheat_1"], kv = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.featureActive = vp.platform.loginStrategy.isUserLoggedIn(),
                    i.checkedThisSession = !1,
                    i._model = new Bv,
                    i._backendSDK = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this.featureActive ? [4, Promise.all([De.services.lazyLoad.getLoadingPromise([hn.EVENTS, hn.DAILY_BONUS], !0), De.services.autosave.registerModel(this._model)])] : [2];
                            case 1:
                                return t.sent(),
                                e = this,
                                [4, De.services.nakamaConfigurationLoadService.loadConfiguration(Eu.DAILY_BONUS)];
                            case 2:
                                return e._config = t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.userClaimedReward = function() {
                    this._model.userClaimedReward()
                }
                ,
                t.prototype.checkIfPopupShouldBeShown = function(e, t, i, n) {
                    void 0 === n && (n = !1),
                    this.featureActive && (this.checkedThisSession = !0,
                    n ? !this._model.hasActiveCycle() || this._model.cycleHasEnded() || this._model.isCycleBroken() ? this._createCycleAndShowPopup(e, t, i) : this._showDailyBonusPopup(e, t, i) : this._model.isRewardClaimedToday() || (!this._model.hasActiveCycle() || this._model.cycleHasEnded() || this._model.isCycleBroken() ? this._createCycleAndShowPopup(e, t, i) : this._showDailyBonusPopup(e, t, i)))
                }
                ,
                t.prototype._createCycleAndShowPopup = function(e, t, i) {
                    var n, r;
                    this._model.isCycleBroken() && De.services.analytics.design.dailyBonusStreakLost(this._model.currentCycleDay),
                    this._model.setRewards(null !== (r = null === (n = this._config) || void 0 === n ? void 0 : n.rewards) && void 0 !== r ? r : Pv),
                    this._showDailyBonusPopup(e, t, i)
                }
                ,
                t.prototype._showDailyBonusPopup = function(e, t, i) {
                    De.services.navigation.showPopup(Lv, {
                        storageBubbleService: e,
                        mapGridView: t,
                        rewardService: i,
                        headerBackground: f.POPUP_EVENTHEADER_DAILYBONUS,
                        headerText: ce.EVENT_DAILYBONUS_HEADER,
                        headerStyle: vn.dailyBonusHeader,
                        rewards: this._model.rewards,
                        currentDay: this._model.currentCycleDay
                    }, !1)
                }
                ,
                t
            }(Se), xv = {
                key: Cn.GEMS,
                amount: 3
            }, Gv = "mainsprite", Uv = "maincontainer", Fv = "debug", Mv = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.enableDebug = function() {}
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, i, r = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return this._tileSize = this.services.axonometricProjection.tileSize,
                            e = this.addFamily([Ke.Sprite], this._onSpriteAdded, this._onVisualRemoved),
                            i = this.addFamily([Ke.Spine], this._onSpineAdded, this._onVisualRemoved),
                            t._onDebugChange.addListener((function() {
                                e.forEach((function(e) {
                                    var t = e.getBehavior(Ke.Sprite).hitArea;
                                    r._createHitAreaVisual(e, !!(t && t.points.length >= 3))
                                }
                                )),
                                i.forEach((function(e) {
                                    var t = e.getBehavior(Ke.Spine).hitArea;
                                    r._createHitAreaVisual(e, !!(t && t.points.length >= 3))
                                }
                                ))
                            }
                            ), this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onSpriteAdded = function(e) {
                    var t = e.getBehavior(Ke.Sprite)
                      , i = t.asset
                      , n = t.anchor
                      , r = t.pivot
                      , o = t.offset
                      , a = t.hitArea
                      , s = this._createBaseContainer(e).addChild(De.services.resource.getSprite(i));
                    s.name = Gv,
                    s.pivot.copyFrom(r),
                    s.anchor.copyFrom(n),
                    s.position.copyFrom(o),
                    this._createHitArea(e, s, a),
                    this._addObjectToView(e)
                }
                ,
                t.prototype._onSpineAdded = function(e) {
                    var t = e.getBehavior(Ke.Spine)
                      , i = t.asset
                      , n = t.startingState
                      , r = t.pivot
                      , o = t.offset
                      , a = t.hitArea
                      , s = this._createBaseContainer(e).addChild(De.services.resource.getSpine(i));
                    s.name = Gv,
                    s.pivot.copyFrom(r),
                    s.position.copyFrom(o),
                    s.state.setAnimation(0, n, !0),
                    this._createHitArea(e, s.skeleton.slots[0].currentSprite, a),
                    this._addObjectToView(e)
                }
                ,
                t.prototype._onVisualRemoved = function(e) {
                    e.removeChildren()
                }
                ,
                t.prototype._createBaseContainer = function(e) {
                    var t = e.addChild(new Xe.Container);
                    return t.name = Uv,
                    t.position.set(0, .5 * this._tileSize.height),
                    t
                }
                ,
                t.prototype._addObjectToView = function(e) {
                    var t = e.getBehavior(Ke.GridPosition);
                    t && (this.services.mapGridView.getLayer(Yo.MAIN).addChild(e),
                    e.position = this.services.axonometricProjection.getWorldPosition(t.column, t.row))
                }
                ,
                t.prototype._createHitArea = function(e, i, n) {
                    var r, o = this, a = !1;
                    !n || n.points.length < 4 ? ((r = i.getLocalBounds()).y += .5 * this._tileSize.height,
                    r.y += i.position.y,
                    r.x += i.position.x) : (a = !0,
                    r = new Xe.Polygon(n.points.map((function(e) {
                        var t = new Xe.Point(e.x,e.y);
                        return t.y += .5 * o._tileSize.height,
                        t.y += i.position.y,
                        t.x += i.position.x,
                        t
                    }
                    )))),
                    e.hitArea = r,
                    (t._debug || n && n.debug) && this._createHitAreaVisual(e, a)
                }
                ,
                t.prototype._createHitAreaVisual = function(e, t) {
                    e.getChildByName(Fv) && e.removeChild(e.getChildByName(Fv));
                    var i = e.hitArea
                      , n = new Xe.Graphics;
                    if (n.beginFill(16711935, .5).lineStyle(4, 16711935, 1),
                    t)
                        n.drawPolygon(i);
                    else {
                        var r = i;
                        n.drawRect(r.x, r.y, r.width, r.height)
                    }
                    n.endFill(),
                    n.beginFill(255, .8).drawCircle(0, 0, 5).endFill(),
                    n.name = Fv,
                    e.addChild(n)
                }
                ,
                t._debug = !1,
                t._onDebugChange = new r.Event,
                t
            }(Pd), Vv = [{
                name: "disappear",
                duration: .35,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 1,
                            scale: {
                                x: "+=0",
                                y: "+=0"
                            },
                            position: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .2,
                        ease: "sine.out",
                        params: {
                            scale: {
                                x: 1.2,
                                y: .85
                            }
                        }
                    }, {
                        time: .2,
                        duration: .2,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: .85,
                                y: 1.2
                            }
                        }
                    }, {
                        time: .4,
                        duration: .2,
                        ease: "sine.in",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .2,
                        duration: .3,
                        event: "shine",
                        ease: "sine.inOut",
                        params: {
                            position: {
                                y: "-=30"
                            }
                        }
                    }, {
                        time: .6,
                        duration: .4,
                        ease: "linear.in",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }]
                }
            }], Hv = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "UpgradeCardModel",
                    t._version = 1,
                    t._itemData = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getItemTier = function(e) {
                    var t;
                    return null !== (t = this._itemData.get(e)) && void 0 !== t ? t : 0
                }
                ,
                t.prototype.setItemTier = function(e, t) {
                    t > 3 ? this._logger.error("Tier ".concat(t, " is higher than max tier ").concat(3, " for item ").concat(e)) : (this._itemData.set(e, t),
                    this.saveData())
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    for (var t in e.itemData)
                        this._itemData.set(t, e.itemData[t])
                }
                ,
                t.prototype.onDataSave = function() {
                    var e = {};
                    return this._itemData.forEach((function(t, i) {
                        e[i] = t
                    }
                    )),
                    {
                        itemData: e
                    }
                }
                ,
                t
            }($n), jv = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t) || this;
                    if (r._scrollContainers = new Map,
                    r._containerFields = new Map,
                    r._fieldObjects = new Map,
                    r._scrollbars = new Map,
                    r._notificationMap = new Map,
                    r._data = t.data,
                    r._hudContainer = i,
                    r._addTabContents(),
                    r._boundScrollCallback = r._onScroll.bind(r),
                    addEventListener("wheel", r._boundScrollCallback),
                    r.onTabSwitch.addListener(r._autoScrollToFirstNew, r),
                    n) {
                        var o = r._getTabByObjectID(n);
                        if (o)
                            return r.switchToTab(o.name, n),
                            r
                    }
                    var a = r._getTabWithUnclaimed() || r._data[0].name;
                    return r.switchToTab(a),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function() {
                    e.prototype.destroy.call(this),
                    removeEventListener("wheel", this._boundScrollCallback),
                    this._removeScrollablesFromUpdateables(),
                    this._scrollContainers.clear(),
                    this._containerFields.clear(),
                    this.onTabSwitch.removeListener(this._autoScrollToFirstNew, this)
                }
                ,
                t.prototype.switchToTab = function(t, i) {
                    e.prototype.switchToTab.call(this, t),
                    i && this._animateToObject(t, i)
                }
                ,
                t.prototype.onPopupOpened = function() {
                    var e = this._getTabWithUnclaimed() || this._data[0].name;
                    this._autoScrollToFirstNew({
                        header: {
                            key: e,
                            label: e
                        }
                    })
                }
                ,
                t.prototype._animateToObject = function(e, t, i) {
                    var r, o, a, s;
                    return void 0 === i && (i = !0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var _, c, l, u, d, h;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return _ = this._getFieldByObjectID(t),
                            c = this._scrollContainers.get(e),
                            ve(_) || ve(c) || ve(l = null === (o = null === (r = this._containerFields.get(c)) || void 0 === r ? void 0 : r.find((function(e) {
                                return e.ID === _.name
                            }
                            ))) || void 0 === o ? void 0 : o.container) || (u = l.position.clone(),
                            d = 0 === u.y ? 0 : 30,
                            u.y = -u.y - d + 102.5,
                            (h = null === (s = null === (a = this._fieldObjects.get(_.name)) || void 0 === a ? void 0 : a.find((function(e) {
                                return e.ID === t
                            }
                            ))) || void 0 === s ? void 0 : s.visual) && i && this._playArrowAnimation(h),
                            c.animateTo(u)),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._addTabContents = function() {
                    var e = this;
                    this._data.forEach((function(t) {
                        var i = t.fields;
                        if (0 !== i.length) {
                            var n = e._createScrollableContainer(t.name)
                              , r = 0;
                            if (i.forEach((function(i) {
                                var o = e._createField(i, t.name);
                                o.position.set(0, r);
                                var a = 30 + o.height;
                                r += a,
                                n.container.addContent(o);
                                var s = e._containerFields.get(n.container) || [];
                                s.push({
                                    ID: i.name,
                                    container: o
                                }),
                                e._containerFields.set(n.container, s)
                            }
                            )),
                            e._tabHasUnclaimed(t)) {
                                var o = e._getNotificationImage(100, -25);
                                e._notificationMap.set(t.name, o),
                                e.addTabHeaderIcon(t.name, o)
                            }
                            var a = De.services.resource.getTexture(f.UI_POPUP_SCROLLBAR)
                              , s = new Vl({
                                scrollableContainer: n.container,
                                inputAreaParent: n.container,
                                texture: a,
                                yOffset: -n.container.height / 2 - 30,
                                xOffset: -n.container.width / 2 + 10,
                                debug: !1
                            });
                            s.mask = n.container.mask,
                            e._scrollbars.set(t.name, s),
                            e._scrollContainers.set(t.name, n.container),
                            e.addTabContent(t.name, n.container),
                            e.addTabContent(t.name, n.mask),
                            e.addTabContent(t.name, s)
                        }
                    }
                    )),
                    this._addScrollablesToUpdateables()
                }
                ,
                t.prototype._createScrollableContainer = function(e) {
                    var t = new v.ScrollableContainer({
                        friction: .8,
                        autoFitContent: !0
                    });
                    t.position.set(15, 0),
                    t.setBounds(new Xe.Rectangle(0,20,this.contentSize.width,this.contentSize.height - 80));
                    var i = (new Xe.Graphics).beginFill(16777215).drawShape(new Xe.Rectangle(0,20,this.contentSize.width,this.contentSize.height - 20)).endFill();
                    return t.mask = i,
                    this._scrollContainers.set(e, t),
                    {
                        container: t,
                        mask: i
                    }
                }
                ,
                t.prototype._createField = function(e, t) {
                    var i = this
                      , n = new Xe.Container
                      , r = this._createHeader(e);
                    n.addChild(r);
                    var o = 205
                      , a = [];
                    e.objects.forEach((function(t, n) {
                        var s = i._createFieldObject(t, n, e.objects.length, r, o, e.name, e.connectingImage);
                        a.push(s),
                        o = Math.max(s.height, o)
                    }
                    ));
                    var s = (o += r.height / 3) * Math.ceil(e.objects.length / 5)
                      , _ = this._createBackground(s, r);
                    return n.addChild(_),
                    a.forEach((function(e, t) {
                        var i = Math.ceil((t + 1) / 5)
                          , r = _.position.y - 45 + o * i - 35;
                        e.position.set(e.position.x, r),
                        n.addChild(e)
                    }
                    )),
                    n
                }
                ,
                t.prototype._createHeader = function(e) {
                    var t = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN02_9SLICE),10,10,10,10);
                    t.setSizes({
                        width: 970,
                        height: 102.5
                    }),
                    t.anchor.set(.5, .5),
                    t.position.set(485, 0);
                    var i = new Xe.Text(e.name,vn.darkSmall);
                    if (i.position.set(15, 2),
                    t.addChild(i),
                    (0,
                    r.isNumber)(e.stars)) {
                        var n = this._createStarContainer(e.stars);
                        n.position.set(t.width - n.width - 10, t.height / 2 - n.height / 2),
                        t.addChild(n)
                    }
                    return t
                }
                ,
                t.prototype._createStarContainer = function(e) {
                    for (var t = new Xe.Container, i = 0; i < 3; i++) {
                        var n = rr(new Xe.Sprite(De.services.resource.getTexture(f.ICON_STAR_UPGRADED_01)), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            scale: {
                                x: 1.2,
                                y: 1.2
                            }
                        });
                        n.position.set(i * (n.width + 5), 10),
                        i >= e && (n.tint = 0,
                        n.alpha = .2),
                        t.addChild(n)
                    }
                    return t
                }
                ,
                t.prototype._createBackground = function(e, t) {
                    var i = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE),10,10,10,10);
                    return i.setSizes({
                        width: 970,
                        height: e
                    }),
                    i.anchor.set(.5, 0),
                    i.position.set(t.position.x, t.position.y + 20),
                    i
                }
                ,
                t.prototype._createFieldObject = function(e, t, i, n, r, o, a) {
                    var s = this
                      , _ = new Xe.Container
                      , c = 950
                      , l = (i >= 5 ? 95 : c / i - c / i / 2) + t % 5 * (i > 5 ? 190 : c / i)
                      , u = e.visual
                      , d = i >= 5 ? 138 : 230
                      , h = "greenhouse" === e.ID ? .4 : Math.min(d / u.width, d / u.height);
                    u.scale.set(h < 1 ? h : 1),
                    u.position.set("greenhouse" === e.ID ? l + 40 : l, 0),
                    _.addChild(u);
                    var p = this._fieldObjects.get(o) || [];
                    p.push({
                        ID: e.ID,
                        visual: u
                    }),
                    this._fieldObjects.set(o, p);
                    var v = e.subImageText;
                    if (v.anchor.set(.5),
                    v.position.set(u.position.x, u.position.y + 40),
                    _.addChild(v),
                    t % 5 > 0 && a) {
                        var g = rr(De.services.resource.getSprite(a), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: t % 5 * (i > 5 ? 190 : c / i),
                                y: u.position.y - 50
                            }
                        });
                        _.addChild(g)
                    }
                    if (e.state === yv.UNCLAIMED) {
                        u.alpha = 0;
                        var f = De.services.resource.getSpine(se.GIFT_DISCOVERYBOOK);
                        f.pivot.set(.5),
                        f.position.copyFrom(u.position),
                        f.position.y = f.position.y - 30,
                        f.state.setAnimation(0, B.GIFT_IDLE, !0),
                        _.addChild(f),
                        f.interactive = !0,
                        f.buttonMode = !0,
                        f.addListener("pointertap", (function() {
                            f.removeListener("pointertap"),
                            s._rewardClaimed(e, u, f)
                        }
                        ))
                    } else if (e.state === yv.UNDISCOVERED) {
                        if (e.undiscoveredVisual) {
                            u.alpha = 0;
                            var E = e.undiscoveredVisual;
                            E.scale.set(h < 1 ? h : 1),
                            E.position.set(l, 0),
                            _.addChild(E),
                            E.tint = 0,
                            E.alpha = .2
                        } else
                            u.tint = 0,
                            u.alpha = .2;
                        v.alpha = .4
                    }
                    return _
                }
                ,
                t.prototype._rewardClaimed = function(e, t, i) {
                    var o;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var a, s, _, c, l, u, d;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                if (De.services.discovery.discoveryClaimed(e),
                                De.services.analytics.source.claimDiscoveryReward(e.discoveryReward.amount),
                                e.state = yv.CLAIMED,
                                null === (o = this._notificationMap.get(e.ID)) || void 0 === o || o.destroy(),
                                !(a = this._getTabByObject(e)))
                                    return [2];
                                if (this._tabHasUnclaimed(a) || (_ = this._notificationMap.get(a.name)) && _.destroy(),
                                !(s = this._getFieldByObject(e, a.fields)))
                                    return [2];
                                this._fieldHasUnclaimed(s) || (_ = this._notificationMap.get(a.name + s.name)) && _.destroy(),
                                c = e.discoveryReward.amount,
                                l = Math.min(c, 9),
                                u = 0,
                                n.label = 1;
                            case 1:
                                return u < l ? (c--,
                                De.services.inventory.addAmount(e.discoveryReward.key, 1, !1),
                                [4, r.TimeDelay.after(175).promise]) : [3, 4];
                            case 2:
                                n.sent(),
                                n.label = 3;
                            case 3:
                                return u++,
                                [3, 1];
                            case 4:
                                return c > 0 && De.services.inventory.addAmount(e.discoveryReward.key, c, !1),
                                (d = lr.gsap.timeline()).add(lr.gsap.set(t, {
                                    alpha: 0
                                })),
                                d.add(lr.gsap.to(t, {
                                    alpha: 1,
                                    duration: .466,
                                    delay: .25
                                })),
                                d.eventCallback("onComplete", (function() {
                                    d.kill()
                                }
                                )),
                                i.state.setAnimation(0, B.GIFT_OPEN, !1),
                                i.state.addListener({
                                    complete: function() {
                                        r.TimeDelay.nextFrame().then((function() {
                                            i.destroy()
                                        }
                                        ))
                                    }
                                }),
                                De.services.audio.playSoundEffect(m.FRIEND_VISIT_ACTIVTY),
                                this._prepareAnimation(e, t),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._autoScrollToFirstNew = function(e) {
                    var t, i = this._data.find((function(t) {
                        return t.name === e.header.key
                    }
                    ));
                    if (i && this._tabHasUnclaimed(i)) {
                        var n = i.fields.find((function(e) {
                            return e.objects.some((function(e) {
                                return e.state === yv.UNCLAIMED
                            }
                            ))
                        }
                        ))
                          , r = null === (t = n.objects.find((function(e) {
                            return e.state === yv.UNCLAIMED
                        }
                        ))) || void 0 === t ? void 0 : t.ID;
                        ve(r) || this._animateToObject(i.name, r, !1)
                    }
                }
                ,
                t.prototype._prepareAnimation = function(e, t) {
                    var i, n, r = {
                        key: e.discoveryReward.key,
                        amount: e.discoveryReward.amount
                    };
                    switch (r.key) {
                    case Cn.COINS:
                        n = De.services.resource.getSprite(f.OBJ_VALUABLES_COINS_00),
                        i = this._hudContainer.getUIelement(Ns.CoinCounterUI);
                        break;
                    case Cn.GEMS:
                        n = De.services.resource.getSprite(f.OBJ_VALUABLES_GEMS_00),
                        i = this._hudContainer.getUIelement(Ns.GemCounterUI);
                        break;
                    default:
                        n = De.services.resource.getSprite(f.OBJ_VALUABLES_COINS_00),
                        i = this._hudContainer.getUIelement(Ns.OrderButtonUI)
                    }
                    this._playAnimation(n, t, r, i, this)
                }
                ,
                t.prototype._playAnimation = function(e, t, i, n, r) {
                    var o = t.parent.toGlobal(t)
                      , a = new Xe.Sprite(e.texture);
                    a.position = r.toLocal(o),
                    a.anchor = e.anchor.clone(),
                    r.addChild(a);
                    var s = De.services.resource.getSpine(se.CLAIM_CURRENCY);
                    s.visible = !1,
                    s.position = r.toLocal(o),
                    r.addChild(s);
                    var _ = new ur(Vv);
                    _.setTargets({
                        container: a
                    });
                    var c = n.parent.toGlobal(n)
                      , l = new Lr(a,r.toLocal(o),r.toLocal(c),i.amount,r);
                    l.onAnimationSpawn.addListener((function() {
                        s.visible = !0,
                        s.state.setAnimation(0, "disappear_effect", !1)
                    }
                    ), null),
                    l.onAnimationComplete.addListener((function() {
                        _.dispose(),
                        s.destroy(),
                        a.destroy(),
                        De.services.inventory.getInventoryItem(i.key).updateVisuals()
                    }
                    ), null),
                    l.animate(),
                    _.play("disappear"),
                    _.onEnd.addListener((function() {
                        _.dispose()
                    }
                    ), null)
                }
                ,
                t.prototype._playArrowAnimation = function(e) {
                    var t = De.services.resource.getSpine(se.DISCOVERY_BOOK_ARROW);
                    t.state.setAnimation(0, N.ANIMATION, !0),
                    e.parent.addChild(t),
                    t.position.copyFrom(e.position),
                    t.position.y -= 175
                }
                ,
                t.prototype._getTabWithUnclaimed = function() {
                    var e, t = this;
                    return null === (e = this._data.find((function(e) {
                        var i = e;
                        if (t._tabHasUnclaimed(i))
                            return e
                    }
                    ))) || void 0 === e ? void 0 : e.name
                }
                ,
                t.prototype._getTabByObjectID = function(e) {
                    var t = this;
                    return this._data.find((function(i) {
                        var n = i.fields;
                        if (0 !== n.length)
                            return t._tabHasObject(n, e) ? i : void 0
                    }
                    ))
                }
                ,
                t.prototype._tabHasObject = function(e, t) {
                    return e.some((function(e) {
                        return e.objects.some((function(e) {
                            return e.ID === t
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._tabHasUnclaimed = function(e) {
                    return e.fields.some((function(e) {
                        return e.objects.some((function(e) {
                            return e.state === yv.UNCLAIMED
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._fieldHasUnclaimed = function(e) {
                    return e.objects.some((function(e) {
                        return e.state === yv.UNCLAIMED
                    }
                    ))
                }
                ,
                t.prototype._getTabKeyByObject = function(e) {
                    var t, i = this;
                    return null === (t = this._data.find((function(t) {
                        if (i._getFieldByObject(e, t.fields))
                            return t.name
                    }
                    ))) || void 0 === t ? void 0 : t.name
                }
                ,
                t.prototype._getTabByObject = function(e) {
                    var t = this;
                    return this._data.find((function(i) {
                        if (t._getFieldByObject(e, i.fields))
                            return i.name
                    }
                    ))
                }
                ,
                t.prototype._getFieldByObject = function(e, t) {
                    return t.find((function(t) {
                        return t.objects.indexOf(e) > -1
                    }
                    ))
                }
                ,
                t.prototype._getFieldByObjectID = function(e) {
                    var t = this._getTabByObjectID(e);
                    if (!ve(t))
                        return t.fields.find((function(t) {
                            return t.objects.find((function(t) {
                                return t.ID === e
                            }
                            ))
                        }
                        ))
                }
                ,
                t.prototype._getNotificationImage = function(e, t) {
                    return void 0 === e && (e = 0),
                    void 0 === t && (t = 0),
                    rr(De.services.resource.getSprite(f.ICON_NOTIFICATION_ATTENTION), {
                        anchor: {
                            x: 1,
                            y: .5
                        },
                        scale: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: e,
                            y: t
                        }
                    })
                }
                ,
                t.prototype._addScrollablesToUpdateables = function() {
                    this._scrollbars.forEach((function(e) {
                        v.GroupsCore.Updateables.add(e)
                    }
                    )),
                    this._scrollContainers.forEach((function(e) {
                        v.GroupsCore.Updateables.add(e)
                    }
                    ))
                }
                ,
                t.prototype._removeScrollablesFromUpdateables = function() {
                    this._scrollbars.forEach((function(e) {
                        v.GroupsCore.Updateables.remove(e)
                    }
                    )),
                    this._scrollContainers.forEach((function(e) {
                        v.GroupsCore.Updateables.remove(e)
                    }
                    ))
                }
                ,
                t.prototype._onScroll = function(e) {
                    this._scrollContainers.forEach((function(t) {
                        t.parent.visible && (t.stopAnimation(),
                        t.setPosition(new Xe.Point(t.getPosition().x,t.getPosition().y - e.deltaY)))
                    }
                    ))
                }
                ,
                t
            }(tc), Kv = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    i.priority = _r.NORMAL,
                    i._name = "DiscoveryPopup",
                    i._headerSize = {
                        width: 666.6666666666666,
                        height: 75
                    },
                    i._popupSize = {
                        width: 1e3,
                        height: 1350
                    },
                    i._tabContentGroupSize = {
                        width: 1e3,
                        height: 1250
                    },
                    i._tabHeaders = [],
                    i._hudContainer = De.services.navigation.hudLayer.hudContainer,
                    i._upgradeCardService = t.upgradeCardService,
                    i._config = r.ObjectUtility.deepCopy(De.services.resource.getJson(_e.DISCOVERY_TAB_DATA)),
                    i._config.tabs.forEach((function(e) {
                        return i._tabHeaders.push({
                            key: nr(gv || (gv = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), e.tabName),
                            label: e.tabIcon
                        })
                    }
                    ));
                    var o = new Ar({
                        size: {
                            width: i._popupSize.width,
                            height: i._popupSize.height
                        },
                        headerSize: {
                            width: i._headerSize.width,
                            height: i._headerSize.height
                        },
                        headerText: ce.DISCOVERY_POPUP_HEADER,
                        headerStyle: vn.popupTitle,
                        headerIcon: f.ICON_POPUP_HEADER_DISCOVERYBOOK
                    });
                    o.onCloseClick((function() {
                        return i.close()
                    }
                    )),
                    i._content.addChild(o);
                    var a = new jv({
                        headers: i._tabHeaders,
                        width: i._tabContentGroupSize.width,
                        height: i._tabContentGroupSize.height,
                        tabHeight: 60,
                        tabSpacing: 2,
                        data: i._createDiscoveryData()
                    },i._hudContainer,t.targetObject);
                    return a.position.x = -.5 * i._popupSize.width,
                    a.position.y = -.5 * i._popupSize.height + 100,
                    i._content.addChild(a),
                    i.onOpened.listenOnce((function() {
                        a.onPopupOpened()
                    }
                    ), i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    De.services.analytics.design.reportDiscoveryDiaryOpened(),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createDiscoveryData = function() {
                    var e = this
                      , t = [];
                    return this._config.tabs.forEach((function(i) {
                        t.push(e._getDiscoveryFieldData(i))
                    }
                    )),
                    t
                }
                ,
                t.prototype._getDiscoveryFieldData = function(e) {
                    var t = this
                      , i = [];
                    return e.fields.forEach((function(e) {
                        var r = {
                            name: nr(fv || (fv = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), e.name),
                            objects: t._getFieldDataAssetsForObjects(e.objects),
                            connectingImage: e.connectingImage,
                            stars: e.stars ? t._upgradeCardService.model.getItemTier(e.objects[e.objects.length - 1].id) : void 0
                        };
                        i.push(r)
                    }
                    )),
                    {
                        name: nr(Ev || (Ev = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), e.tabName),
                        fields: i
                    }
                }
                ,
                t.prototype._getFieldDataAssetsForObjects = function(e) {
                    var t = this
                      , i = [];
                    return e.forEach((function(e) {
                        var r, o, a, s = De.services.discovery.getObjectState(e.id);
                        if (De.services.blueprintCollection.hasBlueprint(e.id)) {
                            r = De.services.blueprintCollection.getBlueprint(e.id);
                            var _ = t._getVisualFromBlueprint(r);
                            o = _.objectVisual,
                            a = _.objectUndiscoveredVisual
                        } else
                            De.services.recipes.hasRecipe(e.id) ? (r = De.services.recipes.getRecipe(e.id),
                            o = rr(De.services.resource.getSprite(r.image), {
                                anchor: {
                                    x: .5,
                                    y: 1
                                }
                            })) : (r = De.services.blueprintCollection.getBlueprint(e.id.split("_").slice(0, -1).join("_")),
                            o = t._getRepairedBuildingVisualFromBlueprint(r));
                        var c = new v.LabelSettings({
                            fitWidth: 180,
                            fitHeight: 80,
                            fitToBox: !0
                        });
                        c.style = vn.darkExtraSmall,
                        c.style.lineHeight = .8 * vn.sizeExtraSmall;
                        var l = {
                            ID: e.id,
                            visual: o,
                            undiscoveredVisual: a,
                            subImageText: fe(e.subText) ? new v.Label(e.subText,c) : new v.Label(nr(mv || (mv = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), e.subText),c),
                            state: s,
                            discoveryReward: e.discoveryReward || (0,
                            n.__assign)({}, xv)
                        };
                        i.push(l)
                    }
                    )),
                    i
                }
                ,
                t.prototype._getRepairedBuildingVisualFromBlueprint = function(e) {
                    var t = De.services.buildings.getBuildingLevelConfig(e.id);
                    return rr(De.services.resource.getSprite({
                        alias: t.visualKeys.active
                    }), {
                        anchor: {
                            x: .5,
                            y: 1
                        }
                    })
                }
                ,
                t.prototype._getVisualFromBlueprint = function(e) {
                    var t = e.components.sprite || {}
                      , i = e.components.spine || {};
                    if (t.alias)
                        return {
                            objectVisual: rr(De.services.resource.getSprite({
                                alias: t.alias
                            }), {
                                anchor: {
                                    x: .5,
                                    y: 1
                                }
                            })
                        };
                    if (i.alias && i.startingState && i.uiImage) {
                        var n = new Xe.Container
                          , r = n.addChild(De.services.resource.getSpine({
                            alias: i.alias
                        }));
                        return r.name = Gv,
                        r.state.setAnimation(0, i.startingState, !0),
                        r.position.set(0, -40),
                        {
                            objectVisual: n,
                            objectUndiscoveredVisual: rr(De.services.resource.getSprite({
                                alias: i.uiImage
                            }), {
                                anchor: {
                                    x: .5,
                                    y: 1
                                }
                            })
                        }
                    }
                    var o = f.OVERLAY_BONUS_FRIEND;
                    return {
                        objectVisual: rr(De.services.resource.getSprite(o), {
                            anchor: {
                                x: .5,
                                y: 1
                            }
                        })
                    }
                }
                ,
                t
            }(yr), Wv = Rp({
                2: function(e) {
                    return {
                        discovered: e.discoveredCrateContent,
                        unclaimed: []
                    }
                }
            }), zv = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._name = "DiscoveryModel",
                    i._version = 2,
                    i._discovered = [],
                    i._unclaimed = [],
                    i._discoveryWhiteList = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.isDiscoveryMade = function(e) {
                    return this._discovered.includes(e)
                }
                ,
                t.prototype.setDiscoveryAsClaimed = function(e) {
                    this.isDiscoveryMade(e) || (this.isUnclaimed(e) && this._unclaimed.splice(this._unclaimed.indexOf(e), 1),
                    this._discovered.push(e),
                    this.saveData())
                }
                ,
                t.prototype.getDiscoveredItems = function() {
                    return this._discovered
                }
                ,
                t.prototype.isUnclaimed = function(e) {
                    return this._unclaimed.includes(e)
                }
                ,
                t.prototype.addUnclaimed = function(e) {
                    this.isUnclaimed(e) || this.isDiscoveryMade(e) || (this._unclaimed.push(e),
                    this.saveData())
                }
                ,
                t.prototype.getUnclaimedItems = function() {
                    return this._unclaimed
                }
                ,
                t.prototype.onInitialize = function() {
                    return Promise.resolve()
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._discovered = e.discovered,
                    this._unclaimed = this._validateUnclaimedData(e.unclaimed)
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        discovered: this._discovered,
                        unclaimed: this._unclaimed
                    }
                }
                ,
                t.prototype.migrateData = function(e) {
                    return Wv(e, 2)
                }
                ,
                t.prototype._validateUnclaimedData = function(e) {
                    var t = this;
                    return e.filter((function(e) {
                        return t._discoveryWhiteList.includes(e)
                    }
                    ))
                }
                ,
                t
            }($n);
            !function(e) {
                e[e.UNDISCOVERED = 0] = "UNDISCOVERED",
                e[e.UNCLAIMED = 1] = "UNCLAIMED",
                e[e.CLAIMED = 2] = "CLAIMED"
            }(yv || (yv = {}));
            var Yv = "_repaired"
              , Jv = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.discoveryWhiteList = [],
                    t.newUnclaimedDiscoveryFound = new r.Event,
                    t.onDiscoveryClaimed = new r.Event,
                    t.onOrderRewarded = new r.Event,
                    t._model = new zv(t.discoveryWhiteList),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getDiscoveredItems = function() {
                    return this._model.getDiscoveredItems()
                }
                ,
                t.prototype.getUnclaimedItems = function() {
                    return this._model.getUnclaimedItems()
                }
                ,
                t.prototype.isDiscoveryMade = function(e) {
                    return this._model.isDiscoveryMade(e)
                }
                ,
                t.prototype.isDiscoveryUnclaimed = function(e) {
                    return this._model.isUnclaimed(e)
                }
                ,
                t.prototype.newUnclaimedDiscoveryMade = function(e) {
                    -1 !== this.discoveryWhiteList.indexOf(e) && (this._model.isUnclaimed(e) || this._model.isDiscoveryMade(e) || (this._model.addUnclaimed(e),
                    this.newUnclaimedDiscoveryFound.fire(e),
                    De.services.actions.emit("discovery.".concat(e))))
                }
                ,
                t.prototype.discoveryClaimed = function(e) {
                    this._model.setDiscoveryAsClaimed(e.ID),
                    this.onDiscoveryClaimed.fire(e.ID)
                }
                ,
                t.prototype.getObjectState = function(e) {
                    return this.isDiscoveryMade(e) ? yv.CLAIMED : this.isDiscoveryUnclaimed(e) ? yv.UNCLAIMED : yv.UNDISCOVERED
                }
                ,
                t.prototype.hasUnclaimedDiscoveries = function() {
                    return this._model.getUnclaimedItems().length > 0
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.DISCOVERY)];
                            case 1:
                                return t.sent(),
                                r.ObjectUtility.deepCopy(De.services.resource.getJson(_e.DISCOVERY_TAB_DATA)).tabs.forEach((function(t) {
                                    t.fields.forEach((function(t) {
                                        t.objects.forEach((function(t) {
                                            e.discoveryWhiteList.push(t.id)
                                        }
                                        ))
                                    }
                                    ))
                                }
                                )),
                                this.onOrderRewarded.addListener(this._onOrderRewarded, this),
                                [2, De.services.autosave.registerModel(this._model)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openDiscoveryPopup = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, De.services.navigation.closeAllPopups()];
                            case 1:
                                return i.sent(),
                                De.services.lazyLoad.prioritizeGroup(hn.DISCOVERY).then((function() {
                                    return De.services.navigation.showPopup(Kv, {
                                        upgradeCardService: e,
                                        targetObject: t
                                    })
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return this.onOrderRewarded.removeListener(this._onOrderRewarded, this),
                    De.services.autosave.unregisterModel(this._model),
                    Promise.resolve()
                }
                ,
                t.prototype._onOrderRewarded = function(e) {
                    this.newUnclaimedDiscoveryMade(e.recipe)
                }
                ,
                t
            }(Se)
              , Xv = 9e5
              , qv = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.eventStarted = new r.Event,
                    i.checkedForActiveEvents = !1,
                    i._logger = Ie.Of("EndpointTimedEventFetcherService"),
                    i._activeEvents = [],
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._fetchFromEndpoint(!0)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.fetchActiveTimedEvents = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.checkedForActiveEvents = !0,
                            [2, this._activeEvents]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._fetchFromEndpoint = function(e) {
                    return void 0 === e && (e = !1),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = "https://".concat("1187013846746005515.discordsays.com/publicNakama", "/"),
                                [4, fetch(t + "api/configurations/active", {
                                    headers: {
                                        "Content-Type": "application/json"
                                    }
                                })];
                            case 1:
                                return [4, n.sent().json()];
                            case 2:
                                return i = n.sent(),
                                r = [],
                                i.configurations ? (Object.values(i.configurations).forEach((function(e) {
                                    var t = JSON.parse(e.data);
                                    r.push({
                                        type: o._getEventTypeFromConfig(t),
                                        startTime: o._parseTimestamp(e.startTime),
                                        endTime: o._parseTimestamp(e.endTime),
                                        eventConfigurationData: t
                                    })
                                }
                                )),
                                r.forEach((function(t) {
                                    o._hasEventData(t) || e || o.eventStarted.fire(t)
                                }
                                )),
                                this._activeEvents = r,
                                setTimeout((function() {
                                    o._fetchFromEndpoint()
                                }
                                ), Xv),
                                [2, {}]) : (setTimeout((function() {
                                    o._fetchFromEndpoint()
                                }
                                ), Xv),
                                [2, {}])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getEventTypeFromConfig = function(e) {
                    return e.eventType
                }
                ,
                t.prototype._parseTimestamp = function(e) {
                    return Date.parse(e)
                }
                ,
                t.prototype._hasEventData = function(e) {
                    return this._activeEvents.some((function(t) {
                        return t.type === e.type && t.endTime === e.endTime && t.startTime === e.startTime
                    }
                    ))
                }
                ,
                t
            }(Se)
              , Qv = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.eventStarted = new r.Event,
                    i.checkedForActiveEvents = !1,
                    i._logger = Ie.Of("TimedEventFetcherService"),
                    i._activeEvents = [],
                    i._backendSDK = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, this._backendSDK.configuration.getActiveTimedConfigurations()];
                            case 1:
                                return e = i.sent(),
                                Object.keys(e).forEach((function(i) {
                                    var n = e[i];
                                    if (n) {
                                        if (!t._isValidConfig(n))
                                            return;
                                        if (n.endTime < Date.now())
                                            return void t._logger.warn("received a timed event that has already ended", n);
                                        t._activeEvents.push({
                                            type: t._getEventTypeFromConfig(n),
                                            startTime: n.startTime,
                                            endTime: n.endTime,
                                            eventConfigurationData: n.configuration
                                        })
                                    }
                                }
                                )),
                                this._backendSDK.configuration.onConfigurationStarted.addListener(this._handleConfigurationStarted, this),
                                this._backendSDK.configuration.onConfigurationFinished.addListener(this._handleConfigurationFinished, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._backendSDK.configuration.onConfigurationStarted.removeListener(this._handleConfigurationStarted, this),
                            this._backendSDK.configuration.onConfigurationFinished.removeListener(this._handleConfigurationFinished, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.fetchActiveTimedEvents = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.checkedForActiveEvents = !0,
                            [2, this._activeEvents]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._handleConfigurationStarted = function(e) {
                    if (this._isValidConfig(e))
                        if (e.endTime < Date.now())
                            this._logger.warn("received a timed event that has already ended", e);
                        else {
                            var t = {
                                type: this._getEventTypeFromConfig(e),
                                startTime: e.startTime,
                                endTime: e.endTime,
                                eventConfigurationData: e.configuration
                            };
                            this._activeEvents.push(t),
                            this.eventStarted.fire(t)
                        }
                }
                ,
                t.prototype._handleConfigurationFinished = function(e) {
                    if (this._isValidConfig(e))
                        for (var t = this._getEventTypeFromConfig(e), i = e.endTime, n = 0; n < this._activeEvents.length; n++)
                            if (this._activeEvents[n].type === t && this._activeEvents[n].endTime === i) {
                                this._activeEvents.splice(n, 1);
                                break
                            }
                }
                ,
                t.prototype._getEventTypeFromConfig = function(e) {
                    return e.configuration.eventType
                }
                ,
                t.prototype._isValidConfig = function(e) {
                    return !!e.configuration && e.configuration.eventType && !!e.startTime && !!e.endTime
                }
                ,
                t
            }(Se)
              , Zv = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onLevelUp = new r.Event,
                    t._maxDefinedLevel = -1,
                    t._availableCrateContents = [],
                    t._availableRecipes = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isMaxLevel", {
                    get: function() {
                        return this.getLevel() >= this._maxDefinedLevel
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "maxDefinedLevel", {
                    get: function() {
                        return this._maxDefinedLevel
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._initializationPromise || (this._experienceInventory = this.services.inventory.getInventoryItem(An.EXP),
                            this._levelInventory = this.services.inventory.getInventoryItem(An.LEVEL),
                            this._initializationPromise = this.services.assetLoader.loadJsons(_e.PROGRESSION_PER_LEVEL).then((function() {
                                e._config = e.services.resource.getJsonCopy(_e.PROGRESSION_PER_LEVEL),
                                e._findMaxDefinedLevel(),
                                e._findCurrentLevelConfig(),
                                e._updateAvailableItems(),
                                e._experienceInventory.onChanged.addListener(e._onExpChanged, e)
                            }
                            ))),
                            [2, this._initializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._experienceInventory.onChanged.removeListener(this._onExpChanged, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getLevel = function() {
                    return this._levelInventory.amount
                }
                ,
                t.prototype.getCurrentExp = function() {
                    return this._experienceInventory.amount
                }
                ,
                t.prototype.getNextLevelExp = function() {
                    return this._currentLevelConfig.exp_to_next_level
                }
                ,
                t.prototype.getLevelProgress = function() {
                    return this.getCurrentExp() / this.getNextLevelExp()
                }
                ,
                t.prototype.addExp = function(e) {
                    this.services.inventory.addAmount(An.EXP, e)
                }
                ,
                t.prototype.getAvailableCrateContents = function() {
                    return this._availableCrateContents
                }
                ,
                t.prototype.getAvailableRecipes = function() {
                    return this._availableRecipes
                }
                ,
                t.prototype.getNewCrateContents = function(e) {
                    var t = this._config.levels[e];
                    return t && t.items_unlocked || []
                }
                ,
                t.prototype.getNewRecipes = function(e) {
                    var t = this._config.levels[e];
                    return t && t.recipes_unlocked || []
                }
                ,
                t.prototype.isItemAvailableOnCurrentLevel = function(e) {
                    return this.getAvailableCrateContents().flatMap((function(e) {
                        return De.services.blueprintGraphService.getCollectableInventoryItemsFromBlueprint(e)
                    }
                    )).includes(e)
                }
                ,
                t.prototype._onExpChanged = function() {
                    if (this.isMaxLevel)
                        this.services.inventory.setAmount(An.EXP, 0);
                    else {
                        var e = this._currentLevelConfig.exp_to_next_level;
                        if (!(this._experienceInventory.amount < e)) {
                            this.services.inventory.addAmount(An.LEVEL, 1),
                            this._findCurrentLevelConfig(),
                            this._updateAvailableItems();
                            var t = this._currentLevelConfig.rewards || [];
                            this.onLevelUp.fire({
                                level: this.getLevel(),
                                rewards: t,
                                recipes: this.getNewRecipes(this.getLevel()),
                                crateContents: this.getNewCrateContents(this.getLevel())
                            }),
                            this.services.inventory.spendAmount(An.EXP, e),
                            this.isMaxLevel && this.services.inventory.setAmount(An.EXP, 0),
                            De.services.analytics.design.levelProgress(this.getLevel()),
                            De.services.analytics.updateCustomDimensions()
                        }
                    }
                }
                ,
                t.prototype._findMaxDefinedLevel = function() {
                    for (var e = 0; void 0 !== this._config.levels[e + 1]; )
                        e++;
                    for (var t in this._maxDefinedLevel = e,
                    this._config.levels)
                        parseInt(t) > e && this._logger.warn("config for level ".concat(t, " is defined while the highest sequential defined level is ").concat(e, ". Is a level config missing?"))
                }
                ,
                t.prototype._findCurrentLevelConfig = function() {
                    this._currentLevelConfig = this._config.levels[this.getLevel()]
                }
                ,
                t.prototype._updateAvailableItems = function() {
                    var e, t;
                    this._availableCrateContents.length = 0,
                    this._availableRecipes.length = 0;
                    for (var i = Math.min(this.getLevel(), this._maxDefinedLevel), n = 1; n <= i; n++)
                        (e = this._availableCrateContents).push.apply(e, this._config.levels[n].items_unlocked || []),
                        (t = this._availableRecipes).push.apply(t, this._config.levels[n].recipes_unlocked || [])
                }
                ,
                t
            }(Se)
              , $v = function() {
                function e(e) {
                    void 0 === e && (e = 60),
                    this._trackerIndex = 0,
                    this._frames = 0,
                    this._intervalID = -1,
                    this._logger = r.Logger.Of("FPSService"),
                    this._maxStoredSeconds = e,
                    this._fpsHistory = new Array(e).fill(-1)
                }
                return e.prototype.initialize = function(e) {
                    this.services = e
                }
                ,
                e.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return v.GroupsCore.Updateables.add(this),
                            this._startInterval(),
                            this.services.pageVisibility.onPageHidden.addListener(this._stopInterval, this),
                            this.services.pageVisibility.onPageFocused.addListener(this._startInterval, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return v.GroupsCore.Updateables.remove(this),
                            this._stopInterval(),
                            this.services.pageVisibility.onPageHidden.removeListener(this._stopInterval, this),
                            this.services.pageVisibility.onPageFocused.removeListener(this._startInterval, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.getFPS = function() {
                    return this._getFpsAt(1)
                }
                ,
                e.prototype.getAverageFPS = function(e) {
                    e > this._maxStoredSeconds && (this._logger.warn("Average FPS is capped at ".concat(this._maxStoredSeconds, " seconds")),
                    e = this._maxStoredSeconds);
                    for (var t = 0, i = 0, n = 0; n < e; n++) {
                        var r = this._getFpsAt(n + 1);
                        if (-1 === r)
                            break;
                        t++,
                        i += r
                    }
                    return i / t || 0
                }
                ,
                e.prototype.update = function() {
                    this._frames++
                }
                ,
                e.prototype._startInterval = function() {
                    var e = this;
                    this._frames = 0,
                    this._intervalID = setInterval((function() {
                        return e._onInterval()
                    }
                    ), 1e3)
                }
                ,
                e.prototype._stopInterval = function() {
                    clearInterval(this._intervalID)
                }
                ,
                e.prototype._onInterval = function() {
                    this._fpsHistory[this._trackerIndex] = this._frames,
                    this._trackerIndex = r.NumberUtility.remainder(this._trackerIndex + 1, this._maxStoredSeconds),
                    this._frames = 0
                }
                ,
                e.prototype._getFpsAt = function(e) {
                    return this._fpsHistory[r.NumberUtility.remainder(this._trackerIndex - e, this._maxStoredSeconds)]
                }
                ,
                e
            }()
              , eg = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._version = 1,
                    i._name = "InviteFriendsTrackerModel",
                    i._maxInvitations = 0,
                    i._invitationsSent = 0,
                    i._firstInviteAt = -1,
                    i._maxInvitations = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.canReset = function(e) {
                    return !(this._firstInviteAt < 0) && r.DateUtility.getDayDifference(new Date(e), new Date(this._firstInviteAt)) >= 1
                }
                ,
                t.prototype.canInviteFriends = function() {
                    return this._invitationsSent < this._maxInvitations
                }
                ,
                t.prototype.resetData = function() {
                    this._firstInviteAt = -1,
                    this._invitationsSent = 0,
                    this.saveData()
                }
                ,
                t.prototype.countInvitation = function(e) {
                    this._firstInviteAt < 0 && (this._firstInviteAt = e),
                    this._invitationsSent += 1,
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._firstInviteAt = e.firstInviteAt,
                    this._invitationsSent = e.invitationsSent
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        firstInviteAt: this._firstInviteAt,
                        invitationsSent: this._invitationsSent
                    }
                }
                ,
                t
            }($n)
              , tg = function() {
                function e() {
                    this._playerData = []
                }
                return Object.defineProperty(e.prototype, "allPlayers", {
                    get: function() {
                        return this._playerData
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.getPlayerByPlatformId = function(e) {
                    return this._playerData.find((function(t) {
                        return t.platformId === e
                    }
                    ))
                }
                ,
                e.prototype.getPlayerByNakamaId = function(e) {
                    return this._playerData.find((function(t) {
                        return t.nakamaId === e
                    }
                    ))
                }
                ,
                e.prototype.createPlayerProfile = function(e) {
                    var t = new wn(e);
                    return this._playerData.push(t),
                    t
                }
                ,
                e
            }()
              , ig = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.forceNpcDestination = !1,
                    i._profiles = [],
                    i._pendingFetchRequests = [],
                    i._visitedFriends = [],
                    i._visitingFriend = null,
                    i._fetchProfileBlockerPromise = Promise.resolve(),
                    i._playerModel = new tg,
                    i._nakamaSDK = t,
                    i._SDKfriendInteractions = t.friendInteractions,
                    i._initializationPromise = new Promise((function(e) {
                        return i._initializationResolve = e
                    }
                    )),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isVisitingFriend", {
                    get: function() {
                        return null !== this._visitingFriend
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "visitingFriend", {
                    get: function() {
                        return this._visitingFriend
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._profiles.push(new wn({
                                    nakamaId: bp.nakamaId,
                                    platformId: vp.platform.initializePlatform.player.id,
                                    name: vp.platform.initializePlatform.player.name,
                                    photoUrl: vp.platform.initializePlatform.player.photo,
                                    isRealPlayer: !0
                                })),
                                [4, this.services.assetLoader.loadJsons(_e.INVITE_FRIENDS_REWARDS_CONFIG)];
                            case 1:
                                return n.sent(),
                                e = this.services.resource.getJson(_e.INVITE_FRIENDS_REWARDS_CONFIG),
                                this._inviteFriendsTracker = new eg(e.INVITE_FRIENDS_PER_DAY),
                                [4, this.services.autosave.registerModel(this._inviteFriendsTracker)];
                            case 2:
                                return n.sent(),
                                t = this,
                                [4, this.getVisitedFriends()];
                            case 3:
                                return t._visitedFriends = n.sent(),
                                [4, vp.platform.friendFetcher.fetchFriends()];
                            case 4:
                                return n.sent().forEach((function(e) {
                                    i._pendingFetchRequests.push({
                                        userid: e.userid,
                                        isVisitable: e.isVisitable,
                                        lastVisitedTime: e.lastVisitedTime,
                                        platformuserid: e.platformuserid,
                                        platformDisplayName: e.platformDisplayName,
                                        photoUrl: e.photoUrl
                                    })
                                }
                                )),
                                [4, this._fetchProfiles(this._pendingFetchRequests)];
                            case 5:
                                return n.sent(),
                                this._pendingFetchRequests = [],
                                this._initializationResolve(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.autosave.unregisterModel(this._inviteFriendsTracker),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.fetchPlatformFriends = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, vp.platform.friendFetcher.fetchFriends()];
                            case 1:
                                return e = t.sent(),
                                [4, this.fetchProfiles(e)];
                            case 2:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.fetchProfile = function(e) {
                    var t;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e.platformuserid && !(null === (t = this._playerModel.getPlayerByPlatformId(e.platformuserid)) || void 0 === t ? void 0 : t.realPlayer) && (i = De.services.npcService.getPlayerDataByPlatformId(e.platformuserid)) ? [2, i] : [4, this.fetchProfiles([e])];
                            case 1:
                                return n.sent(),
                                [2, this._profiles.find((function(t) {
                                    return t.nakamaId === e.userid || t.platformId === e.platformuserid
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.fetchOwnProfile = function() {
                    return this._profiles.find((function(e) {
                        return e.nakamaId === bp.nakamaId
                    }
                    ))
                }
                ,
                t.prototype.fetchProfiles = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (i = this._pendingFetchRequests).push.apply(i, e),
                                [4, this._initializationPromise];
                            case 1:
                                return n.sent(),
                                [4, this._fetchProfiles(this._pendingFetchRequests)];
                            case 2:
                                return n.sent(),
                                this._pendingFetchRequests = [],
                                t = [],
                                e.forEach((function(e) {
                                    var i = r._profiles.find((function(t) {
                                        return t.nakamaId === e.userid || t.platformId === e.platformuserid
                                    }
                                    ));
                                    i && t.push(i)
                                }
                                )),
                                [2, t]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.deleteProfileFromList = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        var i = t._profiles.find((function(t) {
                            return t.nakamaId === e || t.platformId === e
                        }
                        ));
                        i && t._profiles.splice(t._profiles.indexOf(i), 1)
                    }
                    ))
                }
                ,
                t.prototype.canResetInvitationCounter = function(e) {
                    return this._inviteFriendsTracker.canReset(e)
                }
                ,
                t.prototype.resetInvitationCounter = function() {
                    return this._inviteFriendsTracker.resetData()
                }
                ,
                t.prototype.canInviteFriends = function() {
                    return this._inviteFriendsTracker.canInviteFriends()
                }
                ,
                t.prototype.countFriendInvitation = function(e) {
                    this._inviteFriendsTracker.countInvitation(e)
                }
                ,
                t.prototype.visitFriendFarm = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._visitingFriend ? [2, Promise.reject("Already visiting a friend!")] : e.realPlayer ? [4, e.getNakamaId()] : (this._visitingFriend = e,
                                [2, Promise.resolve()]);
                            case 1:
                                return (t = i.sent()) ? [4, this._SDKfriendInteractions.visitFriendFarm(t)] : [3, 3];
                            case 2:
                                return i.sent(),
                                this._visitingFriend = e,
                                [3, 4];
                            case 3:
                                this._logger.error("Friend ID was not found on BE which shouldn't have happened!"),
                                i.label = 4;
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.registerFriendFarmAction = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o, a;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._visitingFriend ? this._visitingFriend.realPlayer ? [4, this._visitingFriend.getNakamaId()] : [2, Promise.resolve()] : [2, Promise.reject("Not currently visiting a friend!")];
                            case 1:
                                return (o = n.sent()) ? (a = "".concat(e).concat("-").concat(t),
                                [2, this._SDKfriendInteractions.registerFriendFarmAction(o, a, i, r)]) : [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.completeVisitFriendFarm = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._visitingFriend ? this._visitingFriend.realPlayer ? [4, this._visitingFriend.getNakamaId()] : (De.services.npcService.visitedNpc(this._visitingFriend.platformId),
                                this._visitingFriend = null,
                                [2, Promise.resolve()]) : [2, Promise.reject("Not currently visiting a friend!")];
                            case 1:
                                if (!(e = i.sent()))
                                    return [3, 6];
                                this._visitingFriend.lastVisitedTime = De.services.timer.currentTime,
                                i.label = 2;
                            case 2:
                                return i.trys.push([2, 4, , 5]),
                                [4, this._SDKfriendInteractions.completeVisitFriendFarm(e)];
                            case 3:
                                return i.sent(),
                                [3, 5];
                            case 4:
                                return t = i.sent(),
                                this._logger.error(t),
                                [3, 5];
                            case 5:
                                this._visitingFriend = null,
                                i.label = 6;
                            case 6:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getVisitedFriends = function() {
                    return this._SDKfriendInteractions.getVisitedFriends()
                }
                ,
                t.prototype.getFriendFarmActions = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._SDKfriendInteractions.getFriendFarmActions()];
                            case 1:
                                return [2, e.sent().map((function(e) {
                                    return {
                                        friendid: e.friendID,
                                        timestamp: e.timestamp,
                                        actions: e.actionList.map((function(e) {
                                            return (0,
                                            n.__assign)((0,
                                            n.__assign)({}, e), {
                                                actiontype: e.actiontype.split("-")[0],
                                                blueprint: e.actiontype.split("-")[1]
                                            })
                                        }
                                        ))
                                    }
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.consumeFriendFarmActions = function(e, t) {
                    return this._SDKfriendInteractions.consumeFriendFarmActions(e, t)
                }
                ,
                t.prototype.hasVisitedToday = function(e) {
                    var t = De.services.timer.currentTime - e.lastVisitedTime;
                    return r.StringUtility.getTimeUnitsFromMilliseconds(t).hours < 24
                }
                ,
                t.prototype.getVisitableFriends = function() {
                    var e = De.services.npcService.getRepeatableNPCs();
                    if (this.forceNpcDestination)
                        return e;
                    var t = this._profiles.filter((function(e) {
                        return e.isVisitable
                    }
                    ));
                    return 0 === t.length ? e : t
                }
                ,
                t.prototype.toggleNpcDestination = function(e) {
                    this.forceNpcDestination = e
                }
                ,
                t.prototype._fetchProfiles = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this._fetchProfileBlockerPromise];
                            case 1:
                                return n.sent(),
                                this._fetchProfileBlockerPromise = new Promise((function(e) {
                                    return t = e
                                }
                                )),
                                i = e.map((function(e) {
                                    return e.userid
                                }
                                )).filter(r.isString),
                                o = e.map((function(e) {
                                    return e.platformuserid
                                }
                                )).filter(r.isString),
                                e.forEach((function(e) {
                                    var t = a._profiles.find((function(t) {
                                        return t.nakamaId === e.userid || t.platformId === e.platformuserid
                                    }
                                    ));
                                    t && (i = i.filter((function(t) {
                                        return t !== e.userid
                                    }
                                    )),
                                    o = o.filter((function(t) {
                                        return t !== e.platformuserid
                                    }
                                    )),
                                    e.isVisitable = t.isVisitable || e.isVisitable || !1)
                                }
                                )),
                                0 === i.length && 0 === o.length ? (t(),
                                [2]) : [4, this._nakamaSDK.playerprofile.getProfiles(i, o)];
                            case 2:
                                return n.sent().forEach((function(t) {
                                    var i, n, r, o = e.find((function(e) {
                                        return e.platformuserid === t.platformuserid
                                    }
                                    )), s = e.find((function(e) {
                                        return e.userid === t.userid
                                    }
                                    )), _ = (null == o ? void 0 : o.photoUrl) || (null == s ? void 0 : s.photoUrl) || t.avatarurl, c = (null == o ? void 0 : o.platformDisplayName) || t.displayname, l = new wn({
                                        platformId: t.platformuserid,
                                        name: c,
                                        photoUrl: _,
                                        nakamaId: t.userid,
                                        isRealPlayer: !0
                                    });
                                    l.isVisitable = (null == o ? void 0 : o.isVisitable) || (null == s ? void 0 : s.isVisitable) || !1;
                                    var u = (null === (i = a._visitedFriends.find((function(e) {
                                        return e.friendid === t.userid || e.friendid === t.platformuserid
                                    }
                                    ))) || void 0 === i ? void 0 : i.lastvisited) || 0;
                                    l.lastVisitedTime = Math.max(u, Math.max(null !== (n = null == o ? void 0 : o.lastVisitedTime) && void 0 !== n ? n : 0, null !== (r = null == s ? void 0 : s.lastVisitedTime) && void 0 !== r ? r : 0)),
                                    a._profiles.push(l)
                                }
                                )),
                                t(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se)
              , ng = function() {
                function e(e, t, i, n) {
                    var r;
                    this._targetOrientation = i,
                    e = (r = this._modifyDimensionsForOrientation(e, t, i)).qualitySetting,
                    t = r.designDimensions,
                    this.gameCanvas = new v.GameCanvas(e,t,n),
                    this.ticker.add(this._update, this)
                }
                return Object.defineProperty(e.prototype, "renderer", {
                    get: function() {
                        return this.gameCanvas.renderer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "ticker", {
                    get: function() {
                        return this.gameCanvas.ticker
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "view", {
                    get: function() {
                        return this.gameCanvas.view
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "stage", {
                    get: function() {
                        return this.gameCanvas.stage
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "bounds", {
                    get: function() {
                        return this.gameCanvas.bounds
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "width", {
                    get: function() {
                        return this.gameCanvas.width
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "height", {
                    get: function() {
                        return this.gameCanvas.height
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "top", {
                    get: function() {
                        return this.gameCanvas.top
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "bottom", {
                    get: function() {
                        return this.gameCanvas.bottom
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "left", {
                    get: function() {
                        return this.gameCanvas.left
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "right", {
                    get: function() {
                        return this.gameCanvas.right
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "bottomLeft", {
                    get: function() {
                        return this.gameCanvas.bottomLeft
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "bottomRight", {
                    get: function() {
                        return this.gameCanvas.bottomRight
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "topLeft", {
                    get: function() {
                        return this.gameCanvas.topLeft
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "topRight", {
                    get: function() {
                        return this.gameCanvas.topRight
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "currentOrientation", {
                    get: function() {
                        return this.gameCanvas.orientation
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "targetOrientation", {
                    get: function() {
                        return this._targetOrientation
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.initialize = function(e) {
                    this.services = e
                }
                ,
                e.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.gameCanvas.start(),
                            [2, Promise.resolve()]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.destroy = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this.gameCanvas.destroy(e),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._update = function(e, t) {
                    void 0 === t && (t = this.ticker.elapsedMS),
                    v.GroupsCore.Updateables.update(e, t),
                    r.TimeDelay.update(e, t)
                }
                ,
                e.prototype._modifyDimensionsForOrientation = function(e, t, i) {
                    if (i === v.Orientation.Portrait)
                        return {
                            qualitySetting: e,
                            designDimensions: t
                        };
                    var r = (0,
                    n.__assign)({}, e);
                    return r.targetCanvasDimensions = {
                        width: 1.25 * e.targetCanvasDimensions.height,
                        height: 1.25 * e.targetCanvasDimensions.width
                    },
                    {
                        qualitySetting: r,
                        designDimensions: {
                            width: 1.5 * t.height,
                            height: 1.5 * t.width
                        }
                    }
                }
                ,
                e
            }()
              , rg = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.convertToTexture = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return [2, new Promise((function(i, n) {
                                var r = Xe.BaseTexture.from(e, {
                                    resolution: 1
                                });
                                r.valid ? i(new Xe.Texture(r)) : r.once("loaded", (function(e) {
                                    return i(new Xe.Texture(e))
                                }
                                )).once("error", (function() {
                                    t._logger.error("Can't convert image to a texture for imageUrl ".concat(e)),
                                    n(Xe.Texture.EMPTY)
                                }
                                ))
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.fromPixiToBase64 = function(e, t, i) {
                    return this._pixiExtract.base64(e, t, i)
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._pixiExtract = new Xe.Extract(this.services.canvas.renderer),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._pixiExtract = null,
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se)
              , og = function() {
                function e(e) {
                    this.onChanged = new r.Event,
                    this.onAnimateChanges = new r.Event,
                    this.isSpendable = !0,
                    this._amount = 0,
                    this._visibleAmount = null,
                    this._key = e
                }
                return e.prototype.setSpendable = function(e) {
                    this.isSpendable = e
                }
                ,
                Object.defineProperty(e.prototype, "key", {
                    get: function() {
                        return this._key
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "amount", {
                    get: function() {
                        return this._amount
                    },
                    set: function(e) {
                        var t = this._amount;
                        t !== e && (this._amount = Math.max(0, e),
                        Zn.breadcrumbs.inventoryChange(this._key, t, e),
                        this.onChanged.fire({
                            current: e,
                            old: t,
                            key: this._key
                        }),
                        (0,
                        r.isNull)(this._visibleAmount) && (this._visibleAmount = this._amount))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.updateVisuals = function() {
                    (0,
                    r.isNull)(this._visibleAmount) && (this._visibleAmount = this._amount),
                    this.onAnimateChanges.fire({
                        current: this._amount,
                        old: this._visibleAmount,
                        key: this._key
                    }),
                    this._visibleAmount = this._amount
                }
                ,
                e
            }()
              , ag = function(e) {
                function t(t, i, n) {
                    void 0 === n && (n = {});
                    var o = e.call(this) || this;
                    return o.onItemAmountChange = new r.Event,
                    o._version = 1,
                    o._inventoryItems = new Map,
                    o._keys = [],
                    o._name = t,
                    o._initialInventoryConfig = n,
                    o._keys = i,
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.hasItem = function(e) {
                    return this._inventoryItems.has(e)
                }
                ,
                t.prototype.getItem = function(e) {
                    var t = this._inventoryItems.get(e);
                    if (!t)
                        throw new Error("Invalid inventoryItem key ".concat(e));
                    return t
                }
                ,
                t.prototype.getAmount = function(e) {
                    return this.getItem(e).amount
                }
                ,
                t.prototype.setAmount = function(e, t, i) {
                    void 0 === i && (i = !0);
                    var n = this.getItem(e);
                    n.amount = t,
                    i && n.updateVisuals()
                }
                ,
                Object.defineProperty(t.prototype, "dataContainer", {
                    get: function() {
                        return De.services.playerData.playerDataContainer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._keys.forEach((function(t) {
                                var i = new og(t);
                                Gn[t] && i.setSpendable(!1),
                                e._inventoryItems.set(t, i)
                            }
                            )),
                            this._inventoryItems.forEach((function(t) {
                                t.onChanged.addListener(e._handleItemAmountChange, e)
                            }
                            )),
                            Object.entries(this._initialInventoryConfig).forEach((function(t) {
                                var i = t[0]
                                  , n = t[1];
                                e.setAmount(i, n)
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    var t = this;
                    Object.entries(e).forEach((function(e) {
                        var i = e[0]
                          , n = e[1];
                        t.setAmount(i, n)
                    }
                    ))
                }
                ,
                t.prototype.onDataSave = function() {
                    var e = {};
                    return this._inventoryItems.forEach((function(t, i) {
                        return e[i] = t.amount
                    }
                    )),
                    e
                }
                ,
                t.prototype._handleItemAmountChange = function(e) {
                    this.saveData(),
                    this.onItemAmountChange.fire(e)
                }
                ,
                t
            }($n)
              , sg = function(e) {
                function t(t, i, n) {
                    void 0 === n && (n = {});
                    var o = e.call(this) || this;
                    return o.onItemAmountChange = new r.Event,
                    o.onRunOutOfResources = new r.Event,
                    o._model = new ag(t,i,n),
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._initializationPromise || (this._initializationPromise = this._initialize()),
                            [2, this._initializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.setAmount = function(e, t, i) {
                    void 0 === i && (i = !0),
                    this._model.setAmount(e, t, i)
                }
                ,
                t.prototype.addAmount = function(e, t, i) {
                    void 0 === i && (i = !0),
                    this.setAmount(e, this.getInventoryItem(e).amount + t, i),
                    this._createInventoryAction("gain", e, t)
                }
                ,
                t.prototype.getAmount = function(e) {
                    return this.getInventoryItem(e).amount
                }
                ,
                t.prototype.hasAmount = function(e, t) {
                    return this.getInventoryItem(e).amount >= t
                }
                ,
                t.prototype.spendAmount = function(e, t, i, n) {
                    return void 0 === i && (i = !0),
                    this.getInventoryItem(e).isSpendable ? this.hasAmount(e, t) ? (this._model.setAmount(e, this.getAmount(e) - t, i),
                    this._createInventoryAction("spend", e, t, n),
                    Promise.resolve()) : (this._logger.warn("Cannot spend '".concat(t, "' of '").concat(e, "', you have only ").concat(this.getAmount(e))),
                    Promise.reject()) : (this._logger.info("Cannot spend non-spendable resource: ".concat(e)),
                    Promise.resolve())
                }
                ,
                t.prototype.hasInventoryItem = function(e) {
                    return this._model.hasItem(e)
                }
                ,
                t.prototype.getInventoryItem = function(e) {
                    var t = this._model.getItem(e);
                    return t || this._logger.info("Unknown inventory key '".concat(e, "'")),
                    t
                }
                ,
                t.prototype.hasEnoughItems = function(e) {
                    var t = this;
                    return e.every((function(e) {
                        // fmc
                        if (document.querySelector('#fmcNoConsume').checked){
                            if (e.key == 'gems' || e.key == 'energy') {
                                e.amount = 0;
                            }
                        }
                        var i = e.key
                          , n = e.amount;
                        return t.hasAmount(i, n)
                    }
                    ))
                }
                ,
                t.prototype.deductItems = function(e, t, i) {
                    var n = this;
                    void 0 === t && (t = !0),
                    e.every((function(e) {
                        var r = e.key
                          , o = e.amount;
                        return n.spendAmount(r, o, t, i)
                    }
                    ))
                }
                ,
                t.prototype.getItemAmountDifference = function(e) {
                    var t = this;
                    return e.reduce((function(e, i) {
                        var n = i.key
                          , r = i.amount;
                        if (!t.hasAmount(n, r)) {
                            var o = r - t.getAmount(n);
                            e.push({
                                key: n,
                                amount: o
                            })
                        }
                        return e
                    }
                    ), [])
                }
                ,
                t.prototype._initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._model.onItemAmountChange.addListener(this._fireOnItemAmountChange, this),
                                [4, this.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._fireOnItemAmountChange = function(e) {
                    this.onItemAmountChange.fire(e),
                    e.key !== Cn.CRATES && e.key !== Cn.ENERGY || 0 !== e.current || this.onRunOutOfResources.fire()
                }
                ,
                t.prototype._createInventoryAction = function(e, t, i, n) {
                    var r = "".concat(e, ".").concat(t, ".").concat(i);
                    if (n && n.hasBehavior(Ke.GridPosition)) {
                        var o = n.getBehavior(Ke.GridPosition);
                        r += ".".concat(o.column, ".").concat(o.row)
                    }
                    De.services.actions.emit(r)
                }
                ,
                t
            }(Se)
              , _g = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onClaimed = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "bonusAvailable", {
                    get: function() {
                        return !1
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.getState = function() {
                    return {}
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openSignInBonusPopup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, Promise.resolve(!1)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openSignInBonusRewardsPopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, Promise.resolve()]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se)
              , cg = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._div = document.createElement("div"),
                    t._frame = document.createElement("iframe"),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return this._div.style.textAlign = "right",
                            (e = document.createElement("a")).text = "close",
                            e.onclick = function() {
                                t.hidePopup({
                                    code: "USER_INPUT"
                                })
                            }
                            ,
                            this._div.appendChild(e),
                            this._div.style.width = "90%",
                            this._div.style.height = "95%",
                            this._div.style.top = "0%",
                            this._div.style.left = "5%",
                            this._div.style.position = "absolute",
                            this._frame.style.width = "100%",
                            this._frame.style.height = "95%",
                            this._frame.style.top = "5%",
                            this._frame.style.left = "0%",
                            this._frame.style.position = "absolute",
                            this._div.appendChild(this._frame),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.hidePopup(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showPopup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return De.services.navigation.showSpinnerOverlay(),
                            this._frame.src = e,
                            document.body.appendChild(this._div),
                            [2, new Promise((function(e, i) {
                                t._resolveClosePromise = e,
                                t._rejectClosePromise = i
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hidePopup = function(e) {
                    var t, i;
                    document.body.contains(this._div) && (De.services.navigation.clearTransitionLayer(),
                    document.body.removeChild(this._div),
                    e ? null === (t = this._rejectClosePromise) || void 0 === t || t.call(this, e) : null === (i = this._resolveClosePromise) || void 0 === i || i.call(this))
                }
                ,
                t
            }(Se)
              , lg = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.useSandboxPurchases = !1,
                    t.onUnhandledPurchase = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isSupported", {
                    get: function() {
                        return !0
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "catalog", {
                    get: function() {
                        return []
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.consumePurchase = function(e) {
                    return Promise.resolve()
                }
                ,
                t.prototype.purchaseItem = function(e) {
                    return Promise.resolve({
                        id: "test",
                        isConsumed: !1,
                        status: 0,
                        items: []
                    })
                }
                ,
                t.prototype.getUnconsumedPurchases = function() {
                    return Promise.resolve([])
                }
                ,
                t.prototype.start = function() {
                    return Promise.resolve()
                }
                ,
                t.prototype.destroy = function() {
                    return Promise.resolve()
                }
                ,
                t
            }(Se)
              , ug = {
                SPLASH: new v.LayerName("splash"),
                MAIN: new v.LayerName("main"),
                HUD: new v.LayerName("hud"),
                DISCONNECTION: new v.LayerName("disconnection"),
                POPUP: new v.LayerName("popup"),
                ONBOARDING: new v.LayerName("onboarding"),
                TRANSITION: new v.LayerName("transition"),
                FAKE_AD: new v.LayerName("fake_ad")
            }
              , dg = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.showView = function(e, t, i, n) {
                    void 0 === n && (n = !1);
                    var r = this._layerManager.getLayer(i);
                    if (!r)
                        throw new Error("ViewManager.showView -> Layer with name: " + i + " does not exist!");
                    return !n && r.hasViewType(e) ? (console.warn("same view type not allowed"),
                    null) : r.instantiateView(e, t)
                }
                ,
                t
            }(v.ViewManager)
              , hg = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._animation = De.services.resource.getSpine(se.THROBBER_LOOP),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e) {
                    var t = De.services.canvas.bounds;
                    this._inputBlocker = this.addChild((new Xe.Graphics).beginFill(0, .6).drawRect(-1, -1, 2, 2).endFill()),
                    this._inputBlocker.width = t.width,
                    this._inputBlocker.height = t.height,
                    this._inputBlocker.interactive = !0,
                    this._inputBlocker.on("pointerdown", (function(e) {
                        return e.stopPropagation()
                    }
                    )),
                    this._createSpinnerAnimation(),
                    e()
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.resize = function() {}
                ,
                t.prototype.onDestroy = function() {
                    this._animation.destroy(),
                    this._inputBlocker.interactive = !1
                }
                ,
                t.prototype._createSpinnerAnimation = function() {
                    this.addChild(this._animation),
                    this._animation.state.setAnimation(0, ne.THROBBER_LOOP, !0)
                }
                ,
                t
            }(v.View);
            function pg(e) {
                var t = {
                    background: f.BG_POPUP_EVENT_TIMER,
                    sizes: {
                        width: 300,
                        height: 66
                    },
                    corners: {
                        leftWidth: 36,
                        topHeight: 30,
                        rightWidth: 36,
                        bottomHeight: 30
                    },
                    textOptions: {
                        textStyle: vn.lightSmall,
                        position: {
                            x: -42,
                            y: -1
                        }
                    },
                    iconOptions: {
                        icon: f.ICON_EVENT_TIMER,
                        position: {
                            x: -114,
                            y: -14
                        }
                    }
                };
                return null === e ? (t.textOptions.position.x = -70,
                function(e) {
                    var t, i, r, o, a = new Xe.Container, s = a.addChild(new cr(De.services.resource.getTexture(e.background),null === (t = e.corners) || void 0 === t ? void 0 : t.leftWidth,null === (i = e.corners) || void 0 === i ? void 0 : i.topHeight,null === (r = e.corners) || void 0 === r ? void 0 : r.rightWidth,null === (o = e.corners) || void 0 === o ? void 0 : o.bottomHeight));
                    s.anchor.set(.5, .5),
                    s.setSizes((0,
                    n.__assign)({}, e.sizes));
                    var _ = a.addChild(new Xe.Text("Event Ended",vn.lightExtraSmall));
                    return _.position.set(0, -5),
                    _.anchor.set(0, .5),
                    e.textOptions && (_.style = e.textOptions.textStyle,
                    _.position.set(e.textOptions.position.x, e.textOptions.position.y)),
                    e.iconOptions && a.addChild(rr(De.services.resource.getSprite(e.iconOptions.icon), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: e.iconOptions.position.x,
                            y: e.iconOptions.position.y
                        }
                    })),
                    a
                }(t)) : new ap(e,t,!0)
            }
            function vg(e, t, i, n, r, o, a, s, _, c) {
                void 0 === _ && (_ = 0),
                i.kill(),
                i = lr.gsap.timeline();
                var l = parseInt(o.text);
                n && (n.kill(),
                i.add(lr.gsap.fromTo(r, {
                    number: l
                }, {
                    number: e - (e - t),
                    duration: _,
                    onUpdateParams: [r]
                }))),
                n = lr.gsap.fromTo(r, {
                    number: t
                }, {
                    number: e,
                    snap: "text",
                    duration: .366,
                    onUpdateParams: [r]
                }),
                i.add(lr.gsap.to(o.scale, {
                    x: 1.5,
                    y: 1.5,
                    duration: .166,
                    ease: as.Yv.easeIn
                }), _),
                i.add(lr.gsap.to(o.scale, {
                    x: 1,
                    y: 1,
                    duration: .166,
                    ease: as.Yv.easeOut
                })),
                s && (i.add(lr.gsap.to(s.scale, {
                    x: 1.3,
                    y: 1.3,
                    duration: .166,
                    ease: as.Yv.easeIn
                }), _),
                i.add(lr.gsap.to(s.scale, {
                    x: a,
                    y: a,
                    duration: .166,
                    ease: as.Yv.easeOut
                }))),
                i.add(n, _),
                i.eventCallback("onUpdate", (function() {
                    l !== r.number && (o.text = c ? "".concat(Math.floor(r.number), "/").concat(c) : "".concat(Math.floor(r.number)))
                }
                )),
                i.eventCallback("onComplete", (function() {
                    i.kill()
                }
                ))
            }
            function gg(e) {
                var t = this
                  , i = De.services.resource.getSpine(se.STAREFFECT);
                i.position.set(26, 0),
                e.addChild(i),
                i.state.setAnimation(0, "animation", !1),
                i.state.addListener({
                    complete: function() {
                        return (0,
                        n.__awaiter)(t, void 0, void 0, (function() {
                            return (0,
                            n.__generator)(this, (function(e) {
                                switch (e.label) {
                                case 0:
                                    return [4, r.TimeDelay.nextFrame()];
                                case 1:
                                    return e.sent(),
                                    i.destroy(),
                                    [2]
                                }
                            }
                            ))
                        }
                        ))
                    }
                })
            }
            var fg, Eg, mg, yg, Tg, Ag, Cg, Ig, Sg, Og, bg = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.NORMAL,
                    i._name = "DailyChallengePopup",
                    i._challengeData = t.challengeData,
                    i._createVisuals(),
                    v.GroupsCore.Updateables.add(i._scrollContainer),
                    v.GroupsCore.Updateables.add(i._scrollbar),
                    i._boundScrollCallback = i._onScroll.bind(i),
                    addEventListener("wheel", i._boundScrollCallback),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    removeEventListener("wheel", this._boundScrollCallback),
                    v.GroupsCore.Updateables.remove(this._scrollContainer),
                    v.GroupsCore.Updateables.remove(this._scrollbar),
                    this._timer.onTimerFinished.removeListener(this.close, this)
                }
                ,
                t.prototype._createVisuals = function() {
                    if ((0,
                    r.isUndefined)(this._challengeData.timerID))
                        this._logger.error("No timerID found in model data, cannot add listeners.");
                    else {
                        var e = this._createBackground({
                            width: 1120,
                            height: 1700
                        });
                        this._createHeader(new Xe.Point(0,-e.height / 2 + 125)),
                        this._createCloseButton(new Xe.Point(e.width / 2 - 80,140 - e.height / 2)),
                        this._addCharacter(new Xe.Point(-360,-460));
                        var t = this._createTimerVisual(new Xe.Point(5,-608));
                        this._createMainText(new Xe.Point(185,t.y + t.height / 2 - 15));
                        var i = this._createMainChallenge(new Xe.Point(-65,-265));
                        this._createScrollableContainer(new Xe.Point(0,i.y + i.height / 2 + 30)),
                        this._createSubChallenges(),
                        this._createScrollbar()
                    }
                }
                ,
                t.prototype._createBackground = function(e) {
                    var t = f.POPUP_BACKGROUND_EVENT_9SLICE
                      , i = De.services.resource.getTexture(t)
                      , n = new cr(i,i.width / 2 - 10,i.height / 2 - 10,i.width / 2 + 10,i.height / 2 + 10);
                    return n.setSizes({
                        width: e.width,
                        height: e.height
                    }),
                    n.position.set(-.5 * e.width, -.5 * e.height),
                    this._content.addChild(n),
                    n
                }
                ,
                t.prototype._createCloseButton = function(e) {
                    var t = this
                      , i = new hr({
                        name: "close",
                        buttonIdle: f.BTN_CLOSE_BIG_IDLE,
                        buttonActive: f.BTN_CLOSE_BIG_DOWN
                    });
                    i.position.copyFrom(e),
                    this._content.addChild(i),
                    i.onClick((function() {
                        return t.close()
                    }
                    ))
                }
                ,
                t.prototype._addCharacter = function(e) {
                    var t = this._content.addChild(De.services.resource.getSprite(f.ICON_MARYJANE));
                    t.anchor.set(.5),
                    t.position.copyFrom(e)
                }
                ,
                t.prototype._createHeader = function(e) {
                    var t = this._content.addChild(De.services.resource.getSprite(f.POPUP_EVENTHEADER_DAILYCHALLENGES));
                    t.anchor.set(.5),
                    t.position.copyFrom(e);
                    var i = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 125,
                        fitWidth: 616
                    });
                    i.style = vn.dailyChallengeHeader;
                    var n = new v.Label(De.services.localization.getText(ce.DAILY_CHALLENGE_POPUP_HEADER),i);
                    n.anchor.set(.5),
                    n.position.set(0, -28),
                    t.addChild(n)
                }
                ,
                t.prototype._createTimerVisual = function(e) {
                    this._timer = De.services.timer.getTimerByID(this._challengeData.timerID);
                    var t = this._content.addChild(pg(this._timer.id));
                    return t.position.copyFrom(e),
                    this._timer.onTimerFinished.addListener(this.close, this),
                    t
                }
                ,
                t.prototype._createMainText = function(e) {
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 175,
                        fitWidth: 616
                    });
                    t.style = vn.yellowBrownLarge;
                    var i = new v.Label(De.services.localization.getText(ce.DAILY_CHALLENGE_POPUP_TEXT),t);
                    i.anchor.set(.5, 0),
                    i.position.copyFrom(e),
                    i.position.y += i.height - 128.5,
                    this._content.addChild(i)
                }
                ,
                t.prototype._createMainChallenge = function(e) {
                    var t = this
                      , i = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 110
                    });
                    i.style = vn.lightSmallWithOutline;
                    var n = this._challengeData.targets.reduce((function(e, i) {
                        return t._challengeData.currentAmount >= i.amount ? e += 1 : e += 0
                    }
                    ), 0)
                      , r = new ls({
                        meterBackground: f.UI_PROGRESSBAR_EVENTS_BACKGROUND,
                        backgroundSize: {
                            width: 770,
                            height: 114
                        },
                        backgroundSliceParams: {
                            leftWidth: 54,
                            topHeight: 51,
                            rightWidth: 54,
                            bottomHeight: 61
                        },
                        meterFill: f.UI_PROGRESSBAR_EVENTS_FILL,
                        fillSize: {
                            width: 728,
                            height: 66
                        },
                        meterFillSliceParams: {
                            leftWidth: 35,
                            topHeight: 33,
                            rightWidth: 35,
                            bottomHeight: 33
                        },
                        targetAmount: this._challengeData.targets.length,
                        progressAmount: n,
                        targetCounterLabelSettings: i,
                        backgroundPivotOffset: {
                            x: 0,
                            y: -6
                        }
                    });
                    r.position.copyFrom(e),
                    this._content.addChild(r);
                    var o = De.services.resource.getSprite(f.ICON_GIFT_DAILYCHALLENGES);
                    this._content.addChild(o),
                    o.anchor.set(.5),
                    o.position.set(r.x + r.width / 2 + o.width / 2 - 59.5, r.y - 34.5);
                    var a = this._content.addChild(new cr(De.services.resource.getTexture(f.ICON_TASKS_CHECKMARK),0,0,0,0));
                    return a.position.set(r.width / 2 - 50, r.position.y),
                    a.scale.set(.5),
                    a.anchor.set(.5),
                    a.visible = !1,
                    r
                }
                ,
                t.prototype._createScrollableContainer = function(e) {
                    var t = this._content.addChild(new cr(De.services.resource.getTexture(f.BG_DAILYTASKS),176,174,176,219));
                    t.anchor.set(.5, 0),
                    t.setSizes({
                        width: 1020,
                        height: 1010
                    }),
                    t.position.copyFrom(e),
                    t.name = "scrollcontainer background",
                    this._scrollContainer = this._content.addChild(new v.ScrollableContainer({
                        friction: .8,
                        autoFitContent: !0
                    })),
                    this._scrollContainer.position.set(-467, -158),
                    this._scrollContainer.setBounds(new Xe.Rectangle(0,0,940,t.height - 50)),
                    this._scrollContainer.name = "scrollcontainer";
                    var i = new cr(De.services.resource.getTexture(f.BG_DAILYTASKS_MASK),176,174,176,219);
                    i.setSizes({
                        width: t.width,
                        height: t.height
                    });
                    var n = Xe.RenderTexture.create({
                        width: i.width,
                        height: i.height
                    });
                    De.services.canvas.renderer.render(i, n);
                    var r = new Xe.Sprite(n);
                    r.anchor.set(.5, 0),
                    r.position.set(t.position.x, t.position.y),
                    r.name = "scrollcontainer mask",
                    this._content.addChild(r),
                    this._scrollContainer.mask = r;
                    var o = this._content.addChild(new cr(De.services.resource.getTexture(f.BG_DAILYTASKS_OVERLAY),142,157,142,157));
                    return o.anchor.set(.5, 0),
                    o.setSizes({
                        width: 954,
                        height: t.height - 81
                    }),
                    o.position.set(0, t.position.y + 16),
                    o.name = "scrollcontainer overlay",
                    this._scrollContainer
                }
                ,
                t.prototype._createScrollbar = function() {
                    var e = De.services.resource.getTexture(f.UI_SCROLLBAR_DAILYCHALLENGES);
                    this._scrollbar = this._content.addChild(new Vl({
                        inputAreaParent: this._content,
                        scrollableContainer: this._scrollContainer,
                        texture: e,
                        yOffset: -310,
                        xOffset: 5,
                        scrollableContainerHeightOffset: -80
                    }))
                }
                ,
                t.prototype._createSubChallenges = function() {
                    var e = this
                      , t = (new Xe.Graphics).beginFill(0, 0).drawShape(new Xe.Rectangle(0,0,50,50)).endFill();
                    this._scrollContainer.addContent(t);
                    var i = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 110
                    });
                    i.style = vn.lightSmallWithOutline;
                    var r = this._challengeData.targets.filter((function(t) {
                        return e._challengeData.currentAmount >= t.amount
                    }
                    ))
                      , o = this._challengeData.targets.filter((function(t) {
                        return e._challengeData.currentAmount < t.amount
                    }
                    ));
                    (0,
                    n.__spreadArray)((0,
                    n.__spreadArray)([], o, !0), r, !0).forEach((function(t, n) {
                        var r = e._challengeData.currentAmount >= t.amount ? e._createFinishedChallenge(t, i) : e._createOngoingChallenge(t, i);
                        r.position.set(450, 250 * n + r.height / 2 + 20),
                        e._scrollContainer.addContent(r)
                    }
                    ));
                    var a = (new Xe.Graphics).beginFill(0, 0).drawShape(new Xe.Rectangle(0,this._scrollContainer.getContentBounds().height,50,50)).endFill();
                    this._scrollContainer.addContent(a)
                }
                ,
                t.prototype._createOngoingChallenge = function(e, t) {
                    var i = De.services.resource.getSprite(f.UI_BG_DAILYCHALLENGES_TASK_ACTIVE);
                    i.anchor.set(.5);
                    var r = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 125,
                        fitWidth: 784
                    });
                    r.style = vn.yellowBrownMedium;
                    var o = new v.Label(nr(fg || (fg = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), {
                        alias: this._challengeData.localizedTask
                    }, e.amount),r);
                    o.anchor.set(0, .5),
                    o.position.set(-i.width / 2 + 50, -o.height),
                    i.addChild(o);
                    var a = new ls({
                        meterBackground: f.UI_PROGRESSBAR_DAILYCHALLENGES_BACKGROUND,
                        backgroundSize: {
                            width: 770,
                            height: 74
                        },
                        backgroundSliceParams: {
                            leftWidth: 38,
                            topHeight: 37,
                            rightWidth: 38,
                            bottomHeight: 37
                        },
                        meterFill: f.UI_PROGRESSBAR_EVENTS_FILL,
                        fillSize: {
                            width: 761,
                            height: 66
                        },
                        meterFillSliceParams: {
                            leftWidth: 35,
                            topHeight: 33,
                            rightWidth: 35,
                            bottomHeight: 33
                        },
                        targetAmount: e.amount,
                        progressAmount: Math.min(this._challengeData.currentAmount, e.amount),
                        targetCounterLabelSettings: t,
                        backgroundPivotOffset: {
                            x: 0,
                            y: 0
                        }
                    });
                    a.position.set(-40, 22),
                    i.addChild(a);
                    var s = ds(this._getRewardImage(e.reward), 80);
                    return s.anchor.set(.5, 1),
                    s.position.set(a.x + a.width / 2 + 50, a.y - 5),
                    i.addChild(s),
                    i.addChild(rr(new v.Label(ns(e.reward) ? e.reward.data.amount.toString() : "1",t), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: s.x,
                            y: s.y + 5
                        }
                    })),
                    i
                }
                ,
                t.prototype._createFinishedChallenge = function(e, t) {
                    var i = De.services.resource.getSprite(f.UI_BG_DAILYCHALLENGES_TASK_DONE);
                    i.anchor.set(.5);
                    var r = De.services.resource.getSprite(f.ICON_CHECKMARK_DAILYCHALLENGES);
                    r.anchor.set(.5),
                    r.position.set(-i.width / 2 + r.width / 2 + 50, 0),
                    i.addChild(r);
                    var o = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 125,
                        fitWidth: 784
                    });
                    o.style = vn.yellowBrownMedium;
                    var a = new v.Label(nr(Eg || (Eg = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), {
                        alias: this._challengeData.localizedTask
                    }, e.amount),o);
                    a.anchor.set(0, .5),
                    a.position.set(r.position.x + r.width / 2 + 25, r.position.y),
                    i.addChild(a);
                    var s = ds(this._getRewardImage(e.reward), 80);
                    return s.anchor.set(.5, 1),
                    s.position.set(i.x + i.width / 2 - s.width / 2 - 20, i.y + 17),
                    i.addChild(s),
                    i.addChild(rr(new v.Label(ns(e.reward) ? e.reward.data.amount.toString() : "1",t), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: s.x,
                            y: s.y + 5
                        }
                    })),
                    i
                }
                ,
                t.prototype._getRewardImage = function(e) {
                    switch (e.type) {
                    case Va.INVENTORY:
                        return this._getInventoryRewardImage(e.data.key);
                    case Va.OBJECT:
                        return De.services.resource.getSprite(us(e.data[0]));
                    default:
                        return De.services.resource.getSprite(f.OVERLAY_BONUS_FRIEND)
                    }
                }
                ,
                t.prototype._getInventoryRewardImage = function(e) {
                    return e === Cn.ENERGY ? De.services.resource.getSprite(f.OBJ_ENERGY_03) : De.services.resource.getSprite(za[e])
                }
                ,
                t.prototype._onScroll = function(e) {
                    this._scrollContainer.stopAnimation();
                    var t = new Xe.Point(this._scrollContainer.getPosition().x,this._scrollContainer.getPosition().y - e.deltaY);
                    this._scrollContainer.setPosition(t)
                }
                ,
                t
            }(yr), Rg = function() {
                function e(e, t) {
                    this.onPopupOpenend = new r.Event,
                    this.onPopupClosed = new r.Event,
                    this._logger = Ie.Of("PopupLayer"),
                    this._views = [],
                    this._queue = [],
                    this.name = e,
                    this.container = t
                }
                return Object.defineProperty(e.prototype, "currentView", {
                    get: function() {
                        return this._views[this._views.length - 1] || null
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.instantiateView = function(e, t) {
                    var i = this._createView(e, t);
                    return this._queue.push(i),
                    this._processQueue(),
                    i
                }
                ,
                e.prototype.hasViewType = function(e) {
                    return this._doesViewExist(e)
                }
                ,
                e.prototype.remove = function() {
                    this._logger.warn("PopupLayer.remove should not be used. Use closeTopPopup instead")
                }
                ,
                e.prototype.clear = function() {
                    this._logger.warn("PopupLayer.clear should not be used. Use closeTopPopup instead")
                }
                ,
                e.prototype.closeTopPopup = function() {
                    var e = this._views[this._views.length - 1];
                    e && e.close()
                }
                ,
                e.prototype.closeAllPopups = function() {
                    this._views.forEach((function(e) {
                        e.close()
                    }
                    ))
                }
                ,
                e.prototype.back = function() {}
                ,
                e.prototype.onFilled = function() {}
                ,
                e.prototype.onEmptied = function() {}
                ,
                e.prototype._processQueue = function() {
                    if (0 !== this._queue.length) {
                        this._queue.sort((function(e, t) {
                            return e.priority - t.priority
                        }
                        ));
                        var e = this._queue[0];
                        if (this._views.length > 0 && e.priority !== _r.IMMEDIATE) {
                            var t = this._views[this._views.length - 1];
                            if (e.priority === _r.TOAST || t.priority !== _r.TOAST)
                                return t.keepBackground = !0,
                                void this._queue.forEach((function(e, t, i) {
                                    e.startWithBlackBackground = !0,
                                    e.keepBackground = t !== i.length - 1
                                }
                                ))
                        }
                        this._queue.shift(),
                        this._views.push(e),
                        e.onClosed.addListener(this._handlePopupClosed, this),
                        this._tryShowView(e)
                    }
                }
                ,
                e.prototype._createView = function(e, t) {
                    var i = new e(t);
                    if (!this._isPopup(i))
                        throw new Error("Only views implementing IPopup can be added to the Popup Layer");
                    return i.init(this),
                    this.container.addChild(i),
                    i.onAddedToLayer(),
                    i
                }
                ,
                e.prototype._tryShowView = function(e) {
                    e.canShow() ? e.beforeShow() : e.autoShow(!0),
                    this.onPopupOpenend.fire(e)
                }
                ,
                e.prototype._handlePopupClosed = function(e) {
                    var t = this._views.indexOf(e);
                    -1 !== t && (e.onClosed.removeListener(this._handlePopupClosed, this),
                    this._views.splice(t, 1),
                    this._destroy(e),
                    this._processQueue(),
                    this.onPopupClosed.fire(e))
                }
                ,
                e.prototype._destroy = function(e) {
                    e && (e.destroy(),
                    this.container.removeChild(e))
                }
                ,
                e.prototype._doesViewExist = function(e) {
                    for (var t = 0; t < this._views.length; t++)
                        if (e === this._views[t].constructor)
                            return !0;
                    return !1
                }
                ,
                e.prototype._isPopup = function(e) {
                    return e.onClosed && void 0 !== e.close && void 0 !== e.priority
                }
                ,
                e
            }(), wg = function(e) {
                function t(t, i) {
                    var n = e.call(this, {}) || this;
                    n._mainTextString = t,
                    n._subTextString = i,
                    n.priority = _r.IMMEDIATE,
                    n._name = "WarningOverlay";
                    var r = De.services.canvas.bounds;
                    return n._inputBlocker = (new Xe.Graphics).beginFill(0, .6).drawRect(r.width + 1, r.height + 1, 1, 1).endFill(),
                    n._inputBlocker.interactive = !1,
                    n._createBackground(),
                    n._createMainText(),
                    n._createSubText(),
                    n._createThrobber(),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    De.services.analytics.noConnectionOverlayShowAmount = De.services.analytics.noConnectionOverlayShowAmount + 1,
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._resizeInputBlocker = function() {}
                ,
                t.prototype._createBackground = function() {
                    var e = De.services.canvas.bounds;
                    this._background = new cr(De.services.resource.getTexture(f.POPUP_BG_BLACK_9SLICE)),
                    this._background.setSizes({
                        width: 800,
                        height: 165
                    }),
                    this._background.pivot.set(400, 82.5),
                    this._background.position.set(0, -e.height / 4),
                    this._content.addChild(this._background)
                }
                ,
                t.prototype._createMainText = function() {
                    var e = vn.lightMedium;
                    e.align = "left";
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 70,
                        fitWidth: 600
                    });
                    t.style = e,
                    this._mainText = new v.Label(this._mainTextString,t),
                    this._mainText.anchor.set(0, .5),
                    this._mainText.position.set(-230, this._background.position.y - 35),
                    this._content.addChild(this._mainText)
                }
                ,
                t.prototype._createSubText = function() {
                    var e = vn.lightSmall;
                    e.align = "left";
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 70,
                        fitWidth: 600
                    });
                    t.style = e,
                    this._subText = new v.Label(this._subTextString,t),
                    this._subText.anchor.set(0, .5),
                    this._subText.position.set(-230, this._background.position.y + 35),
                    this._content.addChild(this._subText)
                }
                ,
                t.prototype._createThrobber = function() {
                    this._throbberAnimation = De.services.resource.getSpine(se.THROBBER_LOOP),
                    this._throbberAnimation.state.setAnimation(0, "throbber_loop", !0),
                    this._throbberAnimation.position.set(this._mainText.x - 85, this._background.position.y),
                    this._throbberAnimation.pivot.set(.5, .5),
                    this._content.addChild(this._throbberAnimation)
                }
                ,
                t
            }(yr), Dg = function(e) {
                function t() {
                    return e.call(this, nr(mg || (mg = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.DISCONNECTION_OVERLAY_TEXT), nr(yg || (yg = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.DISCONNECTION_OVERLAY_SUBTEXT)) || this
                }
                return (0,
                n.__extends)(t, e),
                t
            }(wg), Ng = function(e) {
                function t() {
                    var t = this;
                    function i() {
                        var e = r.StringUtility.formatMilliseconds(De.services.autosave.timeSinceLastSave, {
                            appendTimeUnits: {
                                hours: "H",
                                minutes: "M",
                                seconds: "S"
                            },
                            showSecondsBelowMilliseconds: 36e5
                        });
                        return nr(Ag || (Ag = (0,
                        n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.SAVE_FAILED_SUBTEXT, e)
                    }
                    return (t = e.call(this, nr(Tg || (Tg = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.SAVE_FAILED_TITLE), i()) || this)._getSubText = i,
                    De.services.timer.tick.addListener(t._onTick, t),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onDestroy = function() {
                    e.prototype.onDestroy.call(this),
                    De.services.timer.tick.removeListener(this._onTick, this)
                }
                ,
                t.prototype._onTick = function() {
                    this._subText.text = this._getSubText()
                }
                ,
                t
            }(wg), Lg = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._createHeader = function(e, t, i) {
                    this._header = De.services.resource.getSprite(f.ICON_PREMIUMLAND_HEADER),
                    this._header.anchor.set(.5),
                    this._header.position.set(0, this.HEADER_OFFSET - this._background.height / 2 - 18),
                    this.addChild(this._header);
                    var r = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: .66 * e.width
                    });
                    r.style = vn.lightBoldMedium;
                    var o = new v.Label(nr(Cg || (Cg = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.PREMIUM_LAND_HEADER_TEXT),r);
                    o.anchor.set(.5),
                    o.position.set(0, -15),
                    this._header.addChild(o)
                }
                ,
                t
            }(Ar), Bg = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "PurchasePremiumLandPopup",
                    i._premiumAreaStateService = t.premiumAreaStateService,
                    i._marketplaceService = t.marketplaceService,
                    i._areaData = t.area,
                    i._gemCost = i._areaData.requirements.buy.find((function(e) {
                        return e.key === Cn.GEMS
                    }
                    )),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    var t = this._createBackground();
                    this._content.addChild(t);
                    var i = this._createText();
                    t.addChild(this._createImage()),
                    t.addChild(i),
                    t.addChild(this._createPurchaseBanner()),
                    t.addChild(this._createSpecialOffeImage()),
                    t.addChild(this._createPurchaseText()),
                    t.addChild(this._createPurchaseButton()),
                    this._button.onClick(this._purchaseButtonClicked.bind(this)),
                    De.services.analytics.design.reportPremiumLandPopupOpened(this._areaData.id),
                    e()
                }
                ,
                t.prototype.hide = function(e) {}
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBackground = function() {
                    var e = new Lg({
                        size: {
                            width: 1e3,
                            height: 965
                        },
                        headerSize: {
                            width: 666.6666666666666,
                            height: 90
                        },
                        headerText: ce.MARKET_PLACE_POPUP_HEADER,
                        headerStyle: vn.popupTitle
                    });
                    return e.onCloseClick(this.close.bind(this)),
                    e
                }
                ,
                t.prototype._createText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 850,
                        fitHeight: 200
                    });
                    return e.style = vn.darkMedium,
                    this._text = new v.Label(nr(Ig || (Ig = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.PREMIUM_LAND_TEXT, this._areaData.cells.length),e),
                    this._text.anchor.set(.5),
                    this._text.position.set(0, -295),
                    this._text
                }
                ,
                t.prototype._createImage = function() {
                    return this._promoPic = De.services.resource.getSprite(f.ICON_PREMIUMLAND_PROMOPIC),
                    this._promoPic.anchor.set(.5),
                    this._promoPic.position.set(0, this._text.position.y + this._promoPic.height / 2 + 85),
                    this._promoPic
                }
                ,
                t.prototype._createPurchaseBanner = function() {
                    return this._purchaseBanner = (new Xe.Graphics).beginFill(13114978, 1).drawRect(0, this._promoPic.y + this._promoPic.height / 2 + 50, 1e3, 100).endFill(),
                    this._purchaseBanner.pivot.x = 500,
                    this._purchaseBanner.pivot.y = 50,
                    this._purchaseBanner
                }
                ,
                t.prototype._createSpecialOffeImage = function() {
                    this._specialOfferImage = new Xe.Container;
                    var e = De.services.resource.getSprite(f.ICON_PREMIUMLAND_SPECIALOFFER_RAYS);
                    e.anchor.set(.5);
                    var t = De.services.resource.getSprite(f.ICON_PREMIUMLAND_SPECIALOFFER);
                    t.anchor.set(.5),
                    e.addChild(t);
                    var i = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: t.width - 50,
                        fitHeight: t.height - 50
                    });
                    i.style = vn.brightRedMedium;
                    var r = nr(Sg || (Sg = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.PREMIUM_LAND_SPECIAL_OFFER);
                    if (r.length > 12 && !r.includes(" ")) {
                        var o = r.length / 2
                          , a = Array.from(r);
                        a.splice(o, 0, "-\n"),
                        r = a.join("")
                    }
                    var s = new v.Label(r,i);
                    return s.anchor.set(.5),
                    s.position.set(0, 3),
                    s.angle = 30,
                    t.addChild(s),
                    this._specialOfferImage.addChild(e),
                    this._specialOfferImage.position.set(400, this._purchaseBanner.y + 300),
                    this._specialOfferImage
                }
                ,
                t.prototype._createPurchaseText = function() {
                    var e = new Xe.Container
                      , t = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 850
                    });
                    t.style = vn.lightMedium;
                    var i = De.services.resource.getSprite(f.ICON_COUNTER_GEM);
                    i.anchor.set(.5),
                    i.position.set(-i.width / 2, 0),
                    e.addChild(i);
                    var n = new v.Label(this._gemCost.amount.toString(),t);
                    return n.anchor.set(.5),
                    n.position.set(i.position.x + i.width, 0),
                    e.addChild(n),
                    e.position.set(0, this._purchaseBanner.y + 300),
                    e
                }
                ,
                t.prototype._createPurchaseButton = function() {
                    return this._button = new fr({
                        name: "purchasePremiumArea",
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE
                    },{
                        buttonSizes: {
                            width: 325,
                            height: 85
                        }
                    },{
                        text: ce.PREMIUM_LAND_BUTTON_TEXT,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -7
                        }
                    }),
                    this._button.position.set(0, this._purchaseBanner.y + 415),
                    this._button
                }
                ,
                t.prototype._purchaseButtonClicked = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._premiumAreaStateService.canUnlockArea(this._areaData) ? this.onClosed.listenOnce((function() {
                                e._premiumAreaStateService.unlockArea(e._areaData),
                                De.services.analytics.design.reportPremiumLandPurchased(e._areaData.id),
                                De.services.analytics.sink.premiumLandPurchased(e._gemCost.amount)
                            }
                            ), this) : this.onClosed.listenOnce((function() {
                                return e._marketplaceService.openMarketplaceShop(Ua.GEMS)
                            }
                            ), this),
                            this.close(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr);
            !function(e) {
                e[e.OWN_FARM = -1] = "OWN_FARM",
                e[e.FRIEND_FARM = 1] = "FRIEND_FARM"
            }(Og || (Og = {}));
            var Pg, kg = function(e) {
                function t(t, i, n) {
                    var r = e.call(this) || this;
                    return r._playerData = t,
                    r._friendsData = i,
                    r._direction = n,
                    r.createBackground(),
                    r._createPlayerInfo(),
                    r._createTrain(),
                    r._showTrainAnimation(),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(t) {
                    this._trainAnimation.destroy(),
                    e.prototype.destroy.call(this, t)
                }
                ,
                t.prototype.createBackground = function() {
                    this._background = new Ar({
                        size: {
                            width: 1100,
                            height: 620
                        },
                        headerSize: {
                            width: 500,
                            height: 100
                        },
                        headerText: ce.TRAVELING_TO_HEADER,
                        headerStyle: vn.popupTitle,
                        showCloseButton: !1
                    }),
                    this.addChild(this._background)
                }
                ,
                t.prototype._createPlayerInfo = function() {
                    var e = this._playerData.getPhoto();
                    e.position.set(this._background.x - this._background.width / 2 + 170, this._background.y - 40),
                    e.anchor.set(.5),
                    this.addChild(e);
                    var t = this._friendsData.getPhoto();
                    t.position.set(this._background.x + this._background.width / 2 - 170, this._background.y - 40),
                    t.anchor.set(.5),
                    this.addChild(t);
                    var i = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 70,
                        fitWidth: 500
                    });
                    i.style = vn.darkMedium;
                    var n = this._direction === Og.FRIEND_FARM ? this._friendsData.name : this._playerData.name
                      , r = new v.Label(n,i);
                    r.anchor.set(.5),
                    r.position.set(0, e.y),
                    this.addChild(r)
                }
                ,
                t.prototype._createTrain = function() {
                    this._trainAnimation = De.services.resource.getSpine(se.VISITFRIENDS_LOADING_INDICATOR),
                    this._trainAnimation.position.set(0, 260),
                    this._trainAnimation.scale.set(this._direction, 1),
                    this.addChild(this._trainAnimation)
                }
                ,
                t.prototype._showTrainAnimation = function() {
                    this._trainAnimation.state.setAnimation(0, "visitfriends_loading_indicator", !0)
                }
                ,
                t
            }(Xe.Container), xg = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._showInterstitial = !0,
                    i._logger = Ie.Of("TransitionScreen"),
                    i._playerData = t.playerData,
                    i._friendsData = t.friendsData,
                    i._timeDelay = t.timeDelay,
                    i._direction = t.direction,
                    i._direction === Og.FRIEND_FARM && (i._showInterstitial = !1),
                    i._interstitialConfig = De.services.resource.getJson(_e.TRANSITION_SCREEN_ADS_CONFIG),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._setupScreen(),
                            e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._background.visible = !0,
                            De.services.timer.tick.addListener(this._onTimerTick, this),
                            e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._background.visible = !1,
                            De.services.timer.tick.addListener(this._onTimerTick, this),
                            e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.resize = function() {}
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype._setupScreen = function() {
                    var e, t = De.services.canvas.currentOrientation === v.Orientation.Landscape ? f.BG_TRANSITION_FRIENDVISIT_LANDSCAPE : f.BG_TRANSITION_FRIENDVISIT_PORTRAIT;
                    this._background = new Xe.Sprite(De.services.resource.getTexture(t));
                    var i = Math.max(De.services.canvas.width / this._background.width, De.services.canvas.height / this._background.height);
                    this._background.scale.set(i),
                    this._background.anchor.set(.5),
                    this.addChild(this._background);
                    var n = De.services.canvas.currentOrientation === v.Orientation.Landscape ? -200 : -(De.services.canvas.height / 2 - (400 + ((null === (e = vp.platform.hudStrategy.drawerOffsets) || void 0 === e ? void 0 : e.topDrawer) || 0)));
                    this._toast = new kg(this._playerData,this._friendsData,this._direction),
                    this._toast.position.set(0, n),
                    this.addChild(this._toast)
                }
                ,
                t.prototype._onTimerTick = function() {
                    var e = this
                      , t = this._timeDelay.remaining;
                    this._canShowInterstitial(t) && (this._timeDelay.timeScale = 0,
                    this._showInterstitialAd().finally((function() {
                        return e._timeDelay.timeScale = 1
                    }
                    )))
                }
                ,
                t.prototype._canShowInterstitial = function(e) {
                    var t = 1e3 * this._interstitialConfig.TRANSITION_TIME - e;
                    return this._showInterstitial && t >= 1e3 * this._interstitialConfig.SHOW_INTERSTITIAL_IN
                }
                ,
                t.prototype._showInterstitialAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._showInterstitial = !1,
                                De.services.analytics.design.transitionADShown(),
                                [4, De.services.adsService.showInterstitialAd("transitionScreen")];
                            case 1:
                                return e.sent(),
                                this._logger.info("Interstitial Ads HAS BEEN SHOWN"),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(v.View);
            !function(e) {
                e.INTERSTITIAL = "interstitial",
                e.REWARD = "reward"
            }(Pg || (Pg = {}));
            var Gg, Ug, Fg, Mg, Vg, Hg, jg, Kg = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._buttonActive = !1,
                    i._logger = Ie.Of("FakeAdScreen"),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons(_e.FAKE_AD_CONFIG)];
                            case 1:
                                return i.sent(),
                                this._fakeAdConfig = De.services.resource.getJson(_e.FAKE_AD_CONFIG),
                                (t = (new Xe.Graphics).beginFill(0, .6).drawRect(-1, -1, 2, 2).endFill()).interactive = !0,
                                t.on("pointerdown", (function(e) {
                                    return e.stopPropagation()
                                }
                                )),
                                t.width = De.services.canvas.width,
                                t.height = De.services.canvas.height,
                                this.addChild(t),
                                this._setupScreen(),
                                e(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return De.services.analytics.design.reportFakeAd(this._options.isInterstitialAd ? _n.INTERSTITIAL : _n.RV, cn.SHOW),
                            e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return De.services.timer.tick.removeListener(this._onTimerUpdate, this),
                            this._timeDelay.remaining >= 0 && r.TimeDelay.clear(this._timeDelay),
                            e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.resize = function() {}
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype._setupScreen = function() {
                    this._background = new Xe.Sprite(De.services.resource.getTexture(f.ADS_FALL_BACK_BG));
                    var e = Math.max(De.services.canvas.width / this._background.width, De.services.canvas.height / this._background.height);
                    this._background.scale.set(e),
                    this._background.anchor.set(.5, .5),
                    this._titleImage = De.services.resource.getSprite(f.ADS_FALL_BACK_TILE),
                    this._titleImage.anchor.set(.5);
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: this._titleImage.width - 50
                    });
                    t.style = vn.lightMedium,
                    this._type = this._options.isInterstitialAd ? this._fakeAdConfig.interstitial.TYPE : this._fakeAdConfig.reward.TYPE,
                    this._messageKey = this._options.isInterstitialAd ? {
                        alias: this._fakeAdConfig.interstitial.LOCALIZATIONKEY
                    } : {
                        alias: this._fakeAdConfig.reward.LOCALIZATIONKEY
                    },
                    this._duration = this._options.isInterstitialAd ? this._fakeAdConfig.interstitial.DURATION : this._fakeAdConfig.reward.DURATION,
                    this._text = new v.Label(nr(Gg || (Gg = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), this._messageKey, this._duration),t),
                    this._text.anchor.set(.5, 1),
                    this._text.position.set(0, 0 - this._titleImage.width / 2 - 50),
                    this.addChild(this._background, this._titleImage, this._text),
                    this._addTimer(this._duration)
                }
                ,
                t.prototype._addTimer = function(e) {
                    var t = this;
                    this._timeDelay = r.TimeDelay.after(1e3 * e),
                    this._timeDelay.promise.then((function() {
                        return t._onTimerFinished()
                    }
                    )),
                    De.services.timer.tick.addListener(this._onTimerUpdate, this),
                    this._logger.info("Timer for fake ad ".concat(this._type, " has just started!"))
                }
                ,
                t.prototype._createButton = function() {
                    var e = this
                      , t = new fr({
                        name: "cancel",
                        buttonIdle: f.BTN_OUTLINE_FALLBACK_AD
                    },{
                        buttonSizes: {
                            width: 350,
                            height: 90
                        }
                    },{
                        text: ce.CANCEL,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    t.position.set(0, 0 + this._titleImage.width / 2 + t.height),
                    t.onClick((function() {
                        De.services.analytics.design.reportFakeAd(_n.RV, cn.CANCELLED),
                        e._options.failCallback(),
                        e._onClose()
                    }
                    )),
                    this.addChild(t)
                }
                ,
                t.prototype._onTimerUpdate = function() {
                    var e = r.StringUtility.formatMilliseconds(this._timeDelay.remaining, {
                        forceDoubleDigits: !1,
                        alwaysShowMinutes: !1
                    });
                    this._text.text = nr(Ug || (Ug = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), this._messageKey, e),
                    this._duration - Math.ceil(this._timeDelay.remaining / 1e3) >= 5 && !this._buttonActive && (this._buttonActive = !0,
                    this._createButton())
                }
                ,
                t.prototype._onTimerFinished = function() {
                    De.services.analytics.design.reportFakeAd(this._options.isInterstitialAd ? _n.INTERSTITIAL : _n.RV, this._options.isInterstitialAd ? cn.CLOSED : cn.COMPLETE),
                    this._options.succesCallback(),
                    this._onClose()
                }
                ,
                t.prototype._onClose = function() {
                    De.services.navigation.clearFakeAdScreen()
                }
                ,
                t
            }(v.View), Wg = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._currentObject = null,
                    t._originCell = null,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._grid = this.services.mapGrid,
                            this.services.interactionService.onGestureTapStart.addListener(this._onGestureTapStart, this),
                            this.services.interactionService.onGestureTap.addListener(this._onGestureTap, this),
                            this.services.interactionService.onGesturePick.addListener(this._onGesturePick, this),
                            this.services.interactionService.onGestureDrag.addListener(this._onGestureDrag, this),
                            this.services.interactionService.onGestureDrop.addListener(this._onGestureDrop, this),
                            this.services.interactionHelper.simulateClick.addListener(this._simulateClick, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.interactionService.onGestureTapStart.removeListener(this._onGestureTapStart, this),
                            this.services.interactionService.onGestureTap.removeListener(this._onGestureTap, this),
                            this.services.interactionService.onGesturePick.removeListener(this._onGesturePick, this),
                            this.services.interactionService.onGestureDrag.removeListener(this._onGestureDrag, this),
                            this.services.interactionService.onGestureDrop.removeListener(this._onGestureDrop, this),
                            this.services.interactionHelper.simulateClick.removeListener(this._simulateClick, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._simulateClick = function(e) {
                    var t = e.getBehavior(Ke.GridPosition);
                    if (t) {
                        if (this.services.interactionWhitelistService.isTapValid({
                            column: t.column,
                            row: t.row
                        })) {
                            var i = this.services.mapGrid.getCell(t.column, t.row);
                            if (i) {
                                var n = new Ni({
                                    hoverSelection: void 0,
                                    pointerPosition: e.position.clone(),
                                    originCell: i
                                });
                                e.addBehavior(n),
                                e.removeBehavior(n)
                            } else
                                this._logger.error("simulating click on invalid cell position")
                        }
                    } else
                        this._logger.error("simulating click on object that has no grid position")
                }
                ,
                t.prototype._onGestureTap = function(e) {
                    var t = this._getGestureTargetData(e);
                    if (t.position && t.gameObject) {
                        var i = t.position
                          , n = t.gameObject
                          , r = t.worldPosition;
                        if (this.services.interactionWhitelistService.isTapValid({
                            column: i.column,
                            row: i.row
                        })) {
                            var o = this.services.mapGrid.getCell(i.column, i.row);
                            if (o) {
                                if (n && n.getBehavior(Ke.PickupBuildingStart) && (n.removeBehaviorByType(Ke.PickupBuildingStart),
                                n.getBehavior(Ke.PickupBuildingSucces) && n.removeBehaviorByType(Ke.PickupBuildingSucces)),
                                n.hasBehavior(Ke.Clickable)) {
                                    var a = new Ni({
                                        originCell: o,
                                        hoverSelection: o,
                                        pointerPosition: r
                                    });
                                    Zn.breadcrumbs.objectInteraction(n.getBlueprintID(), "tap", i),
                                    n.addBehavior(a),
                                    n.removeBehavior(a)
                                }
                            } else
                                this._logger.error("invalid cell position (".concat(i.column, ";").concat(i.row, ")"))
                        }
                    }
                }
                ,
                t.prototype._onGestureTapStart = function(e) {
                    var t = this._getGestureTargetData(e);
                    if (t.position && t.gameObject && this.services.interactionWhitelistService.isTapValid({
                        column: t.position.column,
                        row: t.position.row
                    })) {
                        var i = t.gameObject;
                        if (this.services.interactionService.gestureConfirm(ko.TAPPING),
                        i.hasBehavior(Ke.ExtendedTileChild)) {
                            var n = i.getBehavior(Ke.ExtendedTileChild);
                            i = n.parentTile
                        }
                        var r = i.getBehavior(Ke.Building)
                          , o = i.getBehavior(Ke.Movable);
                        r && o && this._onLongpressStart(e)
                    }
                }
                ,
                t.prototype._onGesturePick = function(e) {
                    var t = this._getGestureTargetData(e);
                    if (t.position && t.gameObject) {
                        var i = t.gameObject
                          , n = t.worldPosition
                          , r = i.getBehavior(Ke.GridPosition);
                        if (this.services.interactionWhitelistService.isDragStartValid({
                            column: r.column,
                            row: r.row
                        })) {
                            var o = this.services.mapGrid.getCell(r.column, r.row);
                            if (o) {
                                if (i.getBehavior(Ke.PickupBuildingStart)) {
                                    if (i.removeBehaviorByType(Ke.PickupBuildingStart),
                                    !i.getBehavior(Ke.PickupBuildingSucces))
                                        return;
                                    i.removeBehaviorByType(Ke.PickupBuildingSucces)
                                }
                                if (i.hasBehavior(Ke.Clickable) && i.hasBehavior(Ke.Movable)) {
                                    var a = new Di({
                                        originCell: o,
                                        hoverSelection: o,
                                        pointerPosition: n
                                    });
                                    Zn.breadcrumbs.objectInteraction(i.getBlueprintID(), "pick", r),
                                    i.addBehavior(a),
                                    i.removeBehaviorByType(Ke.GridPosition),
                                    i.addBehavior(new oi(r)),
                                    this._currentObject = i,
                                    this._originCell = o,
                                    this.services.interactionService.gestureConfirm(e.gesture)
                                }
                            } else
                                this._logger.error("invalid cell position (".concat(r.column, ";").concat(r.row, ")"))
                        }
                    }
                }
                ,
                t.prototype._onGestureDrag = function(e) {
                    var t, i = this.services.cameraService.getScreenToWorldPosition(e.position), n = this.services.axonometricProjection.getProjectedIndices(i), r = this._grid.getCell(n.column, n.row);
                    if (this._originCell) {
                        var o = new Mt({
                            originCell: this._originCell,
                            hoverSelection: r,
                            pointerPosition: i,
                            dragType: e.dragType
                        });
                        null === (t = this._currentObject) || void 0 === t || t.replaceBehavior(o)
                    }
                }
                ,
                t.prototype._onGestureDrop = function(e) {
                    var t = this.services.cameraService.getScreenToWorldPosition(e.position)
                      , i = this.services.axonometricProjection.getProjectedIndices(t);
                    if (this._originCell && this._currentObject) {
                        this._currentObject.removeBehaviorByType(Ke.InteractionPick),
                        this._currentObject.removeBehaviorByType(Ke.InteractionDrag);
                        var r = this._grid.getCell(i.column, i.row);
                        if (r && !this.services.interactionWhitelistService.isDragValid({
                            start: this._originCell,
                            end: r
                        }))
                            return this._handleInvalidInteraction(this._currentObject, {
                                originCell: this._originCell,
                                hoverSelection: r,
                                pointerPosition: t,
                                dragType: void 0
                            }),
                            this._currentObject = null,
                            void (this._originCell = null);
                        var o = new wi({
                            originCell: this._originCell,
                            hoverSelection: r,
                            pointerPosition: t
                        });
                        Zn.breadcrumbs.objectInteraction(this._currentObject.getBlueprintID(), "drop", i),
                        this._currentObject.addBehavior(o);
                        var a = new Ri((0,
                        n.__assign)({}, o.data));
                        this._currentObject.addBehavior(a),
                        this._currentObject.removeBehaviorByType(Ke.InteractionDropStart),
                        this._currentObject.removeBehaviorByType(Ke.InteractionDropEnd),
                        this._currentObject = null,
                        this._originCell = null
                    }
                }
                ,
                t.prototype._handleInvalidInteraction = function(e, t) {
                    e.addBehavior(new bi({
                        originCell: t.originCell,
                        hoverSelection: t.hoverSelection,
                        pointerPosition: t.pointerPosition,
                        dragType: t.dragType
                    }))
                }
                ,
                t.prototype._getGestureTargetData = function(e) {
                    var t, i, n, r = this, o = this.services.cameraService.getScreenToWorldPosition(e.startPosition), a = this.services.axonometricProjection.getProjectedIndices(o), s = [0, 1], _ = s[0], c = s[1], l = this._getGameObjectAtOffsetCoordinates(a, 0, 0), u = [];
                    l && u.push({
                        gameObject: l,
                        position: a
                    });
                    for (var d = _; d <= c; d++)
                        for (var h = _; h <= c; h++)
                            if (0 !== d || 0 !== h) {
                                var p = this._getGameObjectAtOffsetCoordinates(a, d, h);
                                p && u.push({
                                    gameObject: p,
                                    position: {
                                        column: a.column + d,
                                        row: a.row + h
                                    }
                                })
                            }
                    return (u = u.filter((function(t) {
                        if (!t.gameObject.hitArea)
                            return !1;
                        var i = t.gameObject.toLocal(e.startPosition, r.services.cameraService.cameraView);
                        return t.gameObject.hitArea.contains(i.x, i.y)
                    }
                    ))).length > 0 ? u.sort((function(e, t) {
                        return t.gameObject.zIndex - e.gameObject.zIndex
                    }
                    )) : l && u.push({
                        gameObject: l,
                        position: a
                    }),
                    {
                        position: null === (t = u[0]) || void 0 === t ? void 0 : t.position,
                        worldPosition: o,
                        gameObject: null !== (n = null === (i = u[0]) || void 0 === i ? void 0 : i.gameObject) && void 0 !== n ? n : void 0
                    }
                }
                ,
                t.prototype._getGameObjectAtOffsetCoordinates = function(e, t, i) {
                    var n = this._grid.getCell(e.column + t, e.row + i);
                    if (!n)
                        return null;
                    var r = n.content;
                    if (!r)
                        return null;
                    if (r.hasBehavior(Ke.ExtendedTileChild)) {
                        var o = r.getBehavior(Ke.ExtendedTileChild);
                        r = o.parentTile
                    }
                    return r
                }
                ,
                t.prototype._onLongpressStart = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return (t = this._getGestureTargetData(e)).position && t.gameObject ? (i = t.gameObject,
                            r = this.services.interactionService.longpressTime,
                            i.addBehavior(new ni({
                                pickupTime: r
                            })),
                            [2]) : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Pd), zg = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._grid = this.services.mapGrid,
                            this.services.interactionService.onGestureTap.addListener(this._onGestureTap, this),
                            this.services.interactionHelper.simulateClick.addListener(this._simulateClick, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.interactionService.onGestureTap.removeListener(this._onGestureTap, this),
                            this.services.interactionHelper.simulateClick.removeListener(this._simulateClick, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Wg), Yg = function(e, t) {
                return e.position.y - t.position.y
            }, Jg = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.mapGridView.getLayer(Yo.PREVIEW_UI).addListener("childAdded", this._onUIAdded, this),
                            this.services.mapGridView.getLayer(Yo.POPOUTS).addListener("childAdded", this._onPopoutAdded, this),
                            this.services.mapGridView.getLayer(Yo.MAIN).sortableChildren = !0,
                            this.addFamily([Ke.Sprite, Ke.GridPosition], this._onObjectAdded),
                            this.addFamily([Ke.Spine, Ke.GridPosition], this._onObjectAdded),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.mapGridView.getLayer(Yo.PREVIEW_UI).removeListener("childAdded", this._onUIAdded, this),
                            this.services.mapGridView.getLayer(Yo.POPOUTS).removeListener("childAdded", this._onPopoutAdded, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onUIAdded = function() {
                    this.services.mapGridView.getLayer(Yo.PREVIEW_UI).children.sort(Yg)
                }
                ,
                t.prototype._onPopoutAdded = function() {
                    this.services.mapGridView.getLayer(Yo.POPOUTS).children.sort(Yg)
                }
                ,
                t.prototype._onObjectAdded = function(e) {
                    var t = e.getBehavior(Ke.GridPosition);
                    if (e.zIndex = t.column + t.row,
                    e.hasBehavior(Ke.ExtendedTile)) {
                        var i = e.getBehavior(Ke.ExtendedTile);
                        i.height > 1 && (e.zIndex -= i.width - 1)
                    }
                }
                ,
                t
            }(Pd), Xg = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.mapGrid.disableSaving(),
                            this.addFamily([Ke.GridPosition], this._onGridPositionAdded, this._onGridPositionRemoved),
                            this.addFamily([Ke.RestorePosition], this._onRestorePositionAdded, this._onRestorePositionRemoved),
                            this.services.mapGrid.enableSaving(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onGridPositionAdded = function(e) {
                    var t = e.getBehavior(Ke.GridPosition);
                    this.services.mapGrid.setContent(t.column, t.row, e),
                    e.hasBehavior(Ke.RestorePosition) && e.removeBehaviorByType(Ke.RestorePosition)
                }
                ,
                t.prototype._onGridPositionRemoved = function(e) {
                    var t, i = e.getBehavior(Ke.GridPosition);
                    (null === (t = this.services.mapGrid.getCell(i.column, i.row)) || void 0 === t ? void 0 : t.content) === e && this.services.mapGrid.setContent(i.column, i.row, null)
                }
                ,
                t.prototype._onRestorePositionAdded = function(e) {
                    var t = e.getBehavior(Ke.RestorePosition);
                    this.services.detachedObjects.addGameObject(e, t.position)
                }
                ,
                t.prototype._onRestorePositionRemoved = function(e) {
                    this.services.detachedObjects.removeDetachedGameObject(e)
                }
                ,
                t
            }(Pd), qg = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._buildingMap = new Map,
                    i._buildingStateProvider = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Building], this._onBuildingBehaviorAttached, this._onBuildingBehaviorRemoved),
                            this._buildingStateProvider.onBuildingStateChanged.addListener(this._handleBuildingChanged, this),
                            this._buildingStateProvider.onBuildingLevelChanged.addListener(this._handleBuildingChanged, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._buildingStateProvider.onBuildingStateChanged.removeListener(this._handleBuildingChanged, this),
                            this._buildingStateProvider.onBuildingLevelChanged.removeListener(this._handleBuildingChanged, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onBuildingBehaviorAttached = function(e) {
                    var t = e.getBehavior(Ke.Building).ID;
                    this._buildingMap.has(t) && t !== E_.GREENHOUSE ? this._logger.error("multiple object with the same building id ".concat(t, " are present on the grid!")) : (this._buildingMap.set(t, e),
                    this._handleBuildingChanged(t))
                }
                ,
                t.prototype._onBuildingBehaviorRemoved = function(e) {
                    var t = e.getBehavior(Ke.Building).ID;
                    this._buildingMap.has(t) ? this._buildingMap.delete(t) : this._logger.error("cannot remove building with building id ".concat(t, " as I have no data of it"))
                }
                ,
                t.prototype._handleBuildingChanged = function(e) {
                    var t = this._buildingMap.get(e);
                    if (t) {
                        var i = this._buildingStateProvider.getBuildingState(e);
                        if (void 0 !== i) {
                            this._updateBuildingSprite(t, e);
                            var n = this._buildingStateProvider.getBuildingLevel(e);
                            if (i !== sv.UNDISCOVERED || t.hasBehavior(Ke.UndiscoveredBuilding) || t.addBehavior(new yi),
                            i === sv.UPGRADING && !t.hasBehavior(Ke.Upgrade)) {
                                var o = De.services.buildings.getUpgradeCost(e, n);
                                (0,
                                r.isUndefined)(o) ? this._logger.error("no upgradecost defined in config for building ".concat(e, " with level ").concat(n)) : t.addBehavior(new ut({
                                    gameObjectCost: o
                                }))
                            }
                            i === sv.ACTIVE && !t.hasBehavior(Ke.Movable) && De.services.buildings.getBuildingConfigProperty(e, "movable") && t.addBehavior(new Zt),
                            De.services.navigation.currentSceneIndex === wr.MAIN && this._handleDiscovery(t, e)
                        } else
                            this._logger.warn("invalid building state for building ".concat(e))
                    }
                }
                ,
                t.prototype._updateBuildingSprite = function(e, t) {
                    var i = this._buildingStateProvider.getBuildingLevel(t)
                      , n = this._buildingStateProvider.getBuildingState(t)
                      , o = De.services.buildings.getBuildingImageAlias(t, i, n);
                    if ((0,
                    r.isUndefined)(o))
                        this._logger.error("invalid sprite alias for building ".concat(t, " with level ").concat(i, " and state ").concat(n));
                    else {
                        var a = e.getBehavior(Ke.Sprite);
                        if (a) {
                            var s = new vi({
                                alias: o,
                                pivot: a.pivot,
                                anchor: a.anchor,
                                offset: a.offset,
                                hitArea: a.hitArea
                            });
                            e.replaceBehavior(s)
                        }
                    }
                }
                ,
                t.prototype._handleDiscovery = function(e, t) {
                    switch (this._buildingStateProvider.getBuildingState(t)) {
                    case sv.ACTIVE:
                        De.services.discovery.newUnclaimedDiscoveryMade(e.getBlueprintID() + Yv);
                    case sv.UPGRADING:
                        De.services.discovery.newUnclaimedDiscoveryMade(e.getBlueprintID())
                    }
                }
                ,
                t
            }(Pd), Qg = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._iconsStore = new zd,
                    t._actionIconMap = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return De.services.visitorReward.activitiesListConfig.forEach((function(t) {
                                e._actionIconMap.set(t.activityType, {
                                    alias: t.icon
                                })
                            }
                            )),
                            this.addFamily([Ke.VisitorAction, Ke.GridPosition], this._showAction, this._hideAction),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showAction = function(e) {
                    var t = e.getBehavior(Ke.VisitorAction)
                      , i = e.getBehavior(Ke.GridPosition)
                      , n = this._actionIconMap.get(t.actionType) || f.ICON_NOTIFICATION_ATTENTION
                      , r = new oh({
                        iconSprite: De.services.resource.getSprite(n)
                    });
                    r.onClick.addListener(this._simulateClick.bind(this, e), this),
                    r.position.copyFrom(e.position),
                    r.show(!0),
                    this._iconsStore.add(i, r),
                    this.services.mapGridView.getLayer(Yo.POPOUTS).addChild(r)
                }
                ,
                t.prototype._hideAction = function(e) {
                    var t = e.getBehavior(Ke.GridPosition)
                      , i = this._iconsStore.remove(t);
                    i && (i.hide(!0),
                    this.services.mapGridView.getLayer(Yo.POPOUTS).removeChild(i))
                }
                ,
                t.prototype._simulateClick = function(e) {
                    this.services.interactionHelper.simulateClick.fire(e)
                }
                ,
                t
            }(Pd), Zg = {
                key: Cn.COINS,
                amount: 3
            }, $g = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._notificationEvent = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._visitorActionsFamily = this.addFamily([Ke.VisitorAction], void 0, this._onActivityRemoved),
                            this.addFamily([Ke.VisitorAction, Ke.InteractionTap, Ke.GridPosition], this._onActivityTapped),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onActivityTapped = function(e) {
                    var t = e.getBehavior(Ke.VisitorAction)
                      , i = e.getBehavior(Ke.GridPosition)
                      , n = De.services.visitorReward.getRewardByType(t.actionType);
                    if (n) {
                        this._sendOwnerReward(e, {
                            column: i.column,
                            row: i.row
                        }, n);
                        var o = this._createVisitorReward(e, n);
                        De.services.visitorReward.addReward(o),
                        e.addBehavior(new ui({
                            floaterType: ci.RewardFloater,
                            amount: o.amount,
                            styles: vn.lightBoldSmall,
                            icon: za[o.key] || Ja[o.key]
                        })),
                        r.TimeDelay.nextFrame().then((function() {
                            e.addBehavior(new ui({
                                floaterType: ci.VisitorActionFloater,
                                actionSpine: se.VISIT_FARM_PARTICLE,
                                animationName: oe.PARTICLE,
                                actionTexture: De.services.resource.getTexture(De.services.visitorReward.getRewardAsset(t.actionType))
                            }))
                        }
                        ))
                    }
                    e.removeBehaviorByType(Ke.VisitorAction),
                    this._performAnimation(t)
                }
                ,
                t.prototype._onActivityRemoved = function() {
                    0 === this._visitorActionsFamily.getGameObjects().length && this._notificationEvent.fire()
                }
                ,
                t.prototype._performAnimation = function(e) {
                    this._logger.info('Helping the friend with "'.concat(e.actionType, '"'))
                }
                ,
                t.prototype._sendOwnerReward = function(e, t, i) {
                    if (De.services.friends.registerFriendFarmAction(i.activityType, e.getBlueprintID(), t.column, t.row),
                    i.owner_reward.key === eh.HEAVY_OBJECT) {
                        var n = e.getBehavior(Ke.HeavyObject);
                        if (n) {
                            var r = n.tokenKey;
                            "" !== r ? De.services.token.useToken(r) : this._logger.error("Heavy object tokenkey is not set. Cannot reward action for owner!")
                        } else
                            this._logger.error("Heavy object visitor action performed on object without heavy object behavior")
                    }
                }
                ,
                t.prototype._createVisitorReward = function(e, t) {
                    var i = [];
                    (me(t.visitor_reward) ? t.visitor_reward : [t.visitor_reward]).forEach((function(t) {
                        if (t.key === $d.INGREDIENTS) {
                            var n = De.services.blueprintGraphService.getCollectableInventoryItemsFromBlueprint(e.getBlueprintID())[0];
                            De.services.experience.isItemAvailableOnCurrentLevel(n) && i.push({
                                key: n,
                                amount: t.amount
                            })
                        } else
                            i.push(t)
                    }
                    ));
                    var r = i[0]
                      , o = De.services.friends.visitingFriend;
                    if (o && !De.services.friends.hasVisitedToday(o)) {
                        var a = (0,
                        n.__assign)({}, r);
                        return a.amount *= 2,
                        a
                    }
                    return r || (this._logger.error("There is no default reward defined for ".concat(t.activityType, ", check config! Default reward will be given instead.")),
                    r = Zg),
                    r
                }
                ,
                t
            }(Pd), ef = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._buildingStateProvider = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, o, a, s, _, c;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e = [],
                                [4, this._getAllAvailableActions()];
                            case 1:
                                return t = n.sent(),
                                i = r.ArrayUtility.shuffleArray(t),
                                [4, this._getActionForHeavyObject()];
                            case 2:
                                return o = n.sent(),
                                a = r.ArrayUtility.shuffleArray(o).pop(),
                                s = Math.min(i.length, De.services.visitorReward.maxActivities),
                                _ = s,
                                c = this._pickRandomActivities(i, _),
                                a && (e.push(a),
                                _ >= De.services.visitorReward.maxActivities && c.pop()),
                                e.push.apply(e, c),
                                this._populateActivities(e),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getAllAvailableActions = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return e = [],
                            this._getActionFor([Ke.Crop, Ke.Harvestable], ju.Crop, e),
                            this._getActionFor([Ke.Animal, Ke.Harvestable], ju.Animal, e),
                            t = De.services.inventory.getAmount(Cn.ENERGY),
                            i = De.services.resourceRegeneration.getGenerator(rs).maxAmount,
                            t < i && this._getActionFor([Ke.MapSource, Ke.Clickable], ju.Nature, e),
                            this._getActionFor([Ke.DeliveryTruck], ju.Truck, e),
                            this._getActionForBuildings(e),
                            [2, e]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getActionForHeavyObject = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o, a, s;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e = [],
                                [4, De.services.friends.fetchOwnProfile().getNakamaId()];
                            case 1:
                                if (!(t = n.sent()))
                                    return this._logger.info("Can't collect the actions for Heavy  Objects, because visitorNakamaId is undefined "),
                                    [2, e];
                                i = [],
                                this._getActionFor([Ke.HeavyObject], ju.HeavyObject, i, !0),
                                r = 0,
                                n.label = 2;
                            case 2:
                                return r < i.length ? (o = i[r],
                                a = o.gameObject.getBehavior(Ke.HeavyObject),
                                [4, De.services.token.getRewardData(a.tokenKey)]) : [3, 5];
                            case 3:
                                if (!(s = n.sent()) || Object.keys(s.claimedbyusers).some((function(e) {
                                    return e === t
                                }
                                )))
                                    return [3, 4];
                                e.push(o),
                                n.label = 4;
                            case 4:
                                return r++,
                                [3, 2];
                            case 5:
                                return [2, e]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getActionForBuildings = function(e) {
                    var t = this
                      , i = this.services.gridFilter.getFilledCellsWithBehaviors([Ke.Building]).filter((function(e) {
                        var i = e.content;
                        if (!i)
                            return !1;
                        var n = i.getBehavior(Ke.Building);
                        return t._buildingStateProvider.isBuildingActive(n.ID)
                    }
                    )).map((function(e) {
                        return {
                            type: ju.Building,
                            gameObject: e.content
                        }
                    }
                    ));
                    i.length > 0 && e.push(i[0])
                }
                ,
                t.prototype._getActionFor = function(e, t, i, n) {
                    void 0 === n && (n = !1);
                    var r = this.services.gridFilter.getFilledCellsWithBehaviors(e).filter((function(e) {
                        return Boolean(e.content)
                    }
                    )).map((function(e) {
                        return {
                            type: t,
                            gameObject: e.content
                        }
                    }
                    ));
                    if (r.length > 0) {
                        var o = n ? r : [r[0]];
                        i.push.apply(i, o)
                    }
                }
                ,
                t.prototype._populateActivities = function(e) {
                    e.forEach((function(e) {
                        var t = e.gameObject
                          , i = e.type;
                        t.addBehavior(new Ai({
                            actionType: i
                        }))
                    }
                    ))
                }
                ,
                t.prototype._pickRandomActivities = function(e, t) {
                    var i = this
                      , n = []
                      , o = r.ArrayUtility.shuffleArray(e)
                      , a = o.reduce((function(e, t) {
                        return e.includes(t.type) || e.push(t.type),
                        e
                    }
                    ), []);
                    if (a.length > t && (a = a.splice(0, t)),
                    a.forEach((function(e) {
                        var t = o.find((function(t) {
                            return t.type === e
                        }
                        ));
                        t ? (o.splice(o.indexOf(t), 1),
                        n.push(t)) : i._logger.warn("For some reasons the VisitorActionType has't been found for ".concat(e))
                    }
                    )),
                    a.length < t)
                        for (var s = t - a.length, _ = 0; _ < s; _++)
                            n.push(o[_]);
                    return n
                }
                ,
                t
            }(Pd), tf = [{
                name: "appear",
                duration: 2,
                repeat: 0,
                keyframes: {
                    floater: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: 0,
                        duration: .1666,
                        ease: "none",
                        params: {
                            position: {
                                y: "-=122"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .33,
                        ease: "sine.in",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: 0,
                        duration: .25,
                        ease: "sine.out",
                        params: {
                            scale: {
                                x: 1.05,
                                y: 1.05
                            }
                        }
                    }, {
                        time: .25,
                        duration: .08,
                        ease: "sine.inout",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .66,
                        duration: .33,
                        ease: "quad.in",
                        params: {
                            position: {
                                y: "-=150"
                            }
                        }
                    }, {
                        time: .66,
                        duration: .33,
                        ease: "none",
                        params: {
                            alpha: 0
                        }
                    }]
                }
            }], nf = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    n.alpha = 0,
                    n.position.copyFrom(i);
                    var r = new ur(tf);
                    return r.setTargets({
                        floater: n
                    }),
                    r.onEnd.addListener((function() {
                        t.removeChild(n),
                        r.dispose()
                    }
                    ), n),
                    r.play("appear"),
                    t.addChild(n),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Xe.Container), rf = function(e) {
                function t(t, i, n) {
                    var r = this
                      , o = n.positionOffset ? new Xe.Point(i.x + n.positionOffset.x,i.y + n.positionOffset.y) : i;
                    r = e.call(this, t, o) || this;
                    var a = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: De.services.canvas.width / 3
                    });
                    a.style = n.styles;
                    var s = new v.Label(n.text,a);
                    return s.anchor.set(.5, .5),
                    r.addChild(s),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t
            }(nf), of = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t, i) || this
                      , o = new Xe.Text("+",n.styles);
                    o.anchor.set(1, .5);
                    var a = new Xe.Text(n.amount.toString(),n.styles);
                    a.anchor.set(0, .5);
                    var s = rr(De.services.resource.getSprite(n.icon));
                    s.scale.set(a.height / s.height, a.height / s.height),
                    s.anchor.set(.5, .5);
                    var _ = s.width / 1.7;
                    return o.position.set(-_, 0),
                    a.position.set(_, 0),
                    r.addChild(o, s, a),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t
            }(nf), af = function(e, t, i) {
                var n = De.services.resource.getSpine(i.actionSpine);
                e.addChild(n),
                ["Particle_1", "Particle_2", "Particle_3"].forEach((function(e) {
                    n.skeleton.findSlot(e).currentSprite.texture = i.actionTexture
                }
                )),
                n.position.set(t.x, t.y - 100),
                n.state.setAnimation(0, i.animationName, !1),
                n.state.addListener({
                    complete: function() {
                        return r.TimeDelay.nextFrame().then((function() {
                            return n.destroy()
                        }
                        ))
                    }
                })
            }, sf = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.ShowFloater], this._onShowFloaterAdded),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onShowFloaterAdded = function(e) {
                    var t = e.getBehavior(Ke.ShowFloater);
                    if (t) {
                        var i = this.services.mapGridView.getLayer(Yo.FLOATERS);
                        ui.isTextFloater(t.data) ? new rf(i,e.position.clone(),t.data) : ui.isRewardFloater(t.data) ? new of(i,e.position.clone(),t.data) : ui.isSpineFloater(t.data) ? new af(i,e.position.clone(),t.data) : this._logger.error("unexpected floater type: " + t.floaterType),
                        e.removeBehavior(t)
                    }
                }
                ,
                t
            }(Pd), _f = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.VisitorAction, Ke.InteractionTap], this._onVisitorRelatedAction),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onVisitorRelatedAction = function() {
                    De.services.audio.playSoundEffect(m.FRIEND_VISIT_ACTIVTY)
                }
                ,
                t
            }(Pd), cf = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.priority = _r.IMMEDIATE,
                    t._name = "AreYouStillTherePopup",
                    t._createBackground(),
                    t._createContent(),
                    t._inputBlocker.removeAllListeners(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    var t = this;
                    this._button.onClick((function() {
                        De.services.connection.attemptReconnection(),
                        t.close()
                    }
                    )),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBackground = function() {
                    this._background = new Ar({
                        size: {
                            width: 800,
                            height: 400
                        },
                        headerSize: {
                            width: 800 / 1.5,
                            height: 75
                        },
                        headerText: ce.ARE_YOU_STILL_THERE_HEADER,
                        headerStyle: vn.popupTitle,
                        showCloseButton: !1
                    }),
                    this._content.addChild(this._background)
                }
                ,
                t.prototype._createContent = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 150,
                        fitWidth: 700
                    });
                    e.style = vn.darkMedium;
                    var t = new v.Label(nr(Fg || (Fg = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.ARE_YOU_STILL_THERE_TEXT),e);
                    t.anchor.set(.5),
                    t.position.set(0, -20),
                    this._content.addChild(t),
                    this._button = new fr({
                        name: "AreYouStillTherePopupButton",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 350,
                            height: 80
                        }
                    },{
                        text: ce.BUTTON_YES,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    }),
                    this._button.position.set(0, 200 - this._button.height),
                    this._content.addChild(this._button)
                }
                ,
                t
            }(yr), lf = function(e) {
                function t() {
                    var t = e.call(this, {}) || this;
                    return t.priority = _r.IMMEDIATE,
                    t._name = "ConnectedOnDifferentDevicePopup",
                    t._createBackground(),
                    t._createContent(),
                    t._inputBlocker.removeAllListeners(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBackground = function() {
                    this._background = new Ar({
                        size: {
                            width: 800,
                            height: 350
                        },
                        headerSize: {
                            width: 800 / 1.5,
                            height: 75
                        },
                        headerText: ce.DISCONNECTION_DEVICE_HEADER,
                        headerStyle: vn.popupTitle,
                        showCloseButton: !1
                    }),
                    this._content.addChild(this._background)
                }
                ,
                t.prototype._createContent = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 150,
                        fitWidth: 700
                    });
                    e.style = vn.darkMedium;
                    var t = new v.Label(nr(Mg || (Mg = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.DISCONNECTION_DEVICE_TEXT),e);
                    t.anchor.set(.5),
                    t.position.set(0, 175 - t.height + 15),
                    this._content.addChild(t)
                }
                ,
                t
            }(yr), uf = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.connection.onConnect.addListener(this._onConnected, this),
                            De.services.connection.onDisconnect.addListener(this._onDisconnected, this),
                            De.services.connection.onReconnectionFailed.addListener(this._onReconnectionFailed, this),
                            De.services.connection.onUserDisconnectBySingleSocket.addListener(this._onDisconnectBySingleSocket, this),
                            De.services.connection.isConnected || this._onDisconnected(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.connection.onConnect.removeListener(this._onConnected, this),
                            De.services.connection.onDisconnect.removeListener(this._onDisconnected, this),
                            De.services.connection.onReconnectionFailed.removeListener(this._onReconnectionFailed, this),
                            De.services.connection.onUserDisconnectBySingleSocket.removeListener(this._onDisconnectBySingleSocket, this),
                            De.services.navigation.hideNoConnectionOverlay(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onConnected = function() {
                    De.services.navigation.hideNoConnectionOverlay(),
                    De.services.navigation.closeAllPopups()
                }
                ,
                t.prototype._onDisconnected = function() {
                    De.services.lazyLoad.prioritizeGroup(hn.DISCONNECTION).then((function() {
                        return De.services.navigation.showNoConnectionOverlay()
                    }
                    ))
                }
                ,
                t.prototype._onReconnectionFailed = function() {
                    De.services.navigation.showPopup(cf, {}, !1)
                }
                ,
                t.prototype._onDisconnectBySingleSocket = function() {
                    De.services.navigation.closeAllPopups(),
                    De.services.navigation.showPopup(lf, {}, !1)
                }
                ,
                t
            }(Pd), df = ((Vg = {})[Sn.WHEAT] = f.OBJ_UPGRADECARD_CROPS_WHEAT_03,
            Vg[Sn.EGG] = f.OBJ_UPGRADECARD_OBJ_ANIMAL_CHICKEN_03,
            Vg[Sn.SUNFLOWER] = f.OBJ_UPGRADECARD_CROPS_SUNFLOWER_03,
            Vg[Sn.MILK] = f.OBJ_UPGRADECARD_OBJ_ANIMAL_COW_03,
            Vg[Sn.SUGARCANE] = f.OBJ_UPGRADECARD_CROPS_SUGARCANE_03,
            Vg[Sn.BACON] = f.OBJ_UPGRADECARD_OBJ_ANIMAL_PIG_03,
            Vg[Sn.CARROT] = f.OBJ_UPGRADECARD_CROPS_CARROT_03,
            Vg[Sn.GOATMILK] = f.OBJ_UPGRADECARD_OBJ_ANIMAL_GOAT_03,
            Vg[Sn.SOYBEANS] = f.OBJ_UPGRADECARD_CROPS_SOYBEAN_03,
            Vg[Sn.WOOL] = f.OBJ_UPGRADECARD_OBJ_ANIMAL_SHEEP_03,
            Vg[Sn.CORN] = f.OBJ_UPGRADECARD_CROPS_CORN_03,
            Vg[Sn.FUR] = f.OBJ_UPGRADECARD_OBJ_ANIMAL_DEER_03,
            Vg[Sn.COFFEEBEANS] = f.OBJ_UPGRADECARD_CROPS_COFFEE_03,
            Vg[Sn.TOMATO] = f.OBJ_UPGRADECARD_CROPS_TOMATO_03,
            Vg[Sn.AVOCADO] = f.OBJ_UPGRADECARD_CROPS_AVOCADO_03,
            Vg[Sn.TRUFFLE] = f.OBJ_UPGRADECARD_OBJ_ANIMAL_TRUFFLEPIG_03,
            Vg), hf = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.UpgradeCard], this._updateVisuals),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateVisuals = function(e) {
                    var t = e.getBehavior(Ke.UpgradeCard);
                    if (!(0,
                    r.isUndefined)(t.targetObjectTreeIngredient)) {
                        var i = e.getChildByName(Uv);
                        if (i) {
                            var n = i.getChildByName(Gv, !0)
                              , o = rr(De.services.resource.getSprite(df[t.targetObjectTreeIngredient]), {
                                anchor: {
                                    x: .5,
                                    y: .5
                                }
                            });
                            n.addChild(o)
                        }
                    }
                }
                ,
                t
            }(Pd), pf = [f.OBJ_PLACEHOLDER, f.ICON_STAR_UPGRADED_01, f.ICON_STAR_UPGRADED_02, f.ICON_STAR_UPGRADED_03], vf = "stars_sprite", gf = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._harvestableStarsContainer = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Harvestable, Ke.Sprite], this._onHarvestableAdded, this._onHarvestableRemoved),
                            this.services.upgradeCard.itemGradeUpgraded.addListener(this._onItemGradeUpgraded, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.upgradeCard.itemGradeUpgraded.removeListener(this._onItemGradeUpgraded, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onHarvestableAdded = function(e) {
                    var t = De.services.blueprintGraphService.getCollectItemFromBlueprint(e.getBlueprintID());
                    if (!(0,
                    r.isUndefined)(t) && !this._harvestableHasStarsVisual(t, e)) {
                        var i = e.getBehavior(Ke.Hitpoints);
                        if (!i || 1 !== i.current) {
                            var n = this.services.upgradeCard.model.getItemTier(t);
                            this._addStarsToHarvestable(e, n, t)
                        }
                    }
                }
                ,
                t.prototype._onItemGradeUpgraded = function(e) {
                    var t = this
                      , i = this.services.upgradeCard.model.getItemTier(e);
                    if (0 !== i) {
                        var r = (0,
                        n.__spreadArray)([], this._harvestableStarsContainer.get(e) || [], !0);
                        this._harvestableStarsContainer.delete(e),
                        r.forEach((function(n) {
                            t._removeExtistingStarsVisual(n),
                            t._addStarsToHarvestable(n, i, e)
                        }
                        ))
                    }
                }
                ,
                t.prototype._onHarvestableRemoved = function(e) {
                    var t = De.services.blueprintGraphService.getCollectItemFromBlueprint(e.getBlueprintID());
                    if (!(0,
                    r.isUndefined)(t) && this._harvestableHasStarsVisual(t, e)) {
                        var i = this._harvestableStarsContainer.get(t) || []
                          , n = i.indexOf(e);
                        n > -1 && i.splice(n, 1),
                        this._harvestableStarsContainer.set(t, i),
                        this._removeExtistingStarsVisual(e)
                    }
                }
                ,
                t.prototype._addStarsToHarvestable = function(e, t, i) {
                    if (t > 3)
                        this._logger.error("Object tier ".concat(t, " is not supported. Only 3 tiers are supported. Object: ").concat(e.getBlueprintID()));
                    else {
                        if (0 !== t) {
                            var n = e.getChildByName(Uv);
                            if (n) {
                                var r = n.getChildByName(Gv, !0)
                                  , o = rr(De.services.resource.getSprite(pf[t]), {
                                    anchor: {
                                        x: .5,
                                        y: .5
                                    },
                                    position: {
                                        x: 0,
                                        y: 70
                                    }
                                });
                                o.name = vf,
                                r.addChild(o)
                            }
                        }
                        var a = this._harvestableStarsContainer.get(i) || [];
                        a.push(e),
                        this._harvestableStarsContainer.set(i, a)
                    }
                }
                ,
                t.prototype._removeExtistingStarsVisual = function(e) {
                    var t = e.getChildByName(Uv);
                    if (t) {
                        var i = t.getChildByName(Gv, !0)
                          , n = i.getChildByName(vf);
                        n && i.removeChild(n)
                    }
                }
                ,
                t.prototype._harvestableHasStarsVisual = function(e, t) {
                    return (this._harvestableStarsContainer.get(e) || []).includes(t)
                }
                ,
                t
            }(Pd), ff = function(e, t, i, n) {
                return e >= 0 && e <= i && t >= 0 && t <= n
            }, Ef = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._emptyCells = [],
                    t._blueprintMap = new Map,
                    t._isGridUpdatedAfterUnavailable2by2Search = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getClosestAvailableCell = function(e, t) {
                    var i, n = [{
                        row: e.row,
                        column: e.column
                    }], r = this.services.mapGrid.getCell(e.column, e.row);
                    if (r && !r.content && !t)
                        return r;
                    for (; !i; ) {
                        var o = n.shift();
                        if (o)
                            for (var a = this._getNeighbors(o), s = function(e, t) {
                                var r = _.services.mapGrid.getCell(e, t);
                                if (r && !r.content)
                                    return i = r,
                                    "break";
                                n.findIndex((function(i) {
                                    return i.column === e && i.row === t
                                }
                                )) < 0 && n.push({
                                    column: e,
                                    row: t
                                })
                            }, _ = this, c = 0, l = a; c < l.length; c++) {
                                var u = l[c];
                                if ("break" === s(u.column, u.row))
                                    break
                            }
                    }
                    return i
                }
                ,
                t.prototype.getClosestAvailable2x2CellSquare = function(e) {
                    for (var t, i = this, n = [{
                        row: e.row,
                        column: e.column
                    }], o = []; (0,
                    r.isUndefined)(t) && n.length > 0 && this._isGridUpdatedAfterUnavailable2by2Search; ) {
                        var a = n.shift();
                        if (a) {
                            o.push(a);
                            for (var s = this._getNeighbors(a), _ = function(e, i) {
                                var r = c.services.mapGrid.getCell(e, i)
                                  , a = c.services.mapGrid.getCell(e + 1, i)
                                  , s = c.services.mapGrid.getCell(e + 1, i + 1)
                                  , _ = c.services.mapGrid.getCell(e, i + 1);
                                if (r && !r.content && a && !a.content && s && !s.content && _ && !_.content)
                                    return t = {
                                        top: r,
                                        left: _,
                                        right: a,
                                        bottom: s
                                    },
                                    "break";
                                var l = n.findIndex((function(t) {
                                    return t.column === e && t.row === i
                                }
                                ))
                                  , u = o.findIndex((function(t) {
                                    return t.column === e && t.row === i
                                }
                                ));
                                l < 0 && u < 0 && n.push({
                                    column: e,
                                    row: i
                                })
                            }, c = this, l = 0, u = s; l < u.length; l++) {
                                var d = u[l];
                                if ("break" === _(d.column, d.row))
                                    break
                            }
                        }
                    }
                    return (0,
                    r.isUndefined)(t) && (this._isGridUpdatedAfterUnavailable2by2Search = !1,
                    this.services.mapGrid.onContentRemoved.listenOnce((function() {
                        i._isGridUpdatedAfterUnavailable2by2Search = !0
                    }
                    ), this)),
                    t
                }
                ,
                t.prototype.getCellsInRange = function(e, t, i) {
                    var n = this._getExistingHashesInRange(e, t, i);
                    return this._filterCells((function(e) {
                        return -1 !== n.indexOf(e)
                    }
                    ))
                }
                ,
                t.prototype.getCellsInArea = function(e, t, i, n) {
                    var r = this._getExistingHashesInArea(e, t, i, n);
                    return this._filterCells((function(e) {
                        return -1 !== r.indexOf(e)
                    }
                    ))
                }
                ,
                t.prototype.getFilledCells = function() {
                    var e = this;
                    return this._filterCells((function(t) {
                        return -1 === e._emptyCells.indexOf(t)
                    }
                    ))
                }
                ,
                t.prototype.getFilledCellsWithBehaviors = function(e) {
                    return this.getFilledCells().filter((function(t) {
                        return e.every((function(e) {
                            var i;
                            return null === (i = t.content) || void 0 === i ? void 0 : i.hasBehavior(e)
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getFilledCellsWithSomeBehaviors = function(e) {
                    return this.getFilledCells().filter((function(t) {
                        return e.some((function(e) {
                            var i;
                            return null === (i = t.content) || void 0 === i ? void 0 : i.hasBehavior(e)
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getCellPositionsWithBehaviors = function(e) {
                    return this.getFilledCellsWithBehaviors(e).map((function(e) {
                        return {
                            column: e.column,
                            row: e.row
                        }
                    }
                    ))
                }
                ,
                t.prototype.getFilledCellsInRange = function(e, t, i) {
                    var n = this
                      , r = this._getExistingHashesInRange(e, t, i).filter((function(e) {
                        return -1 === n._emptyCells.indexOf(e)
                    }
                    ));
                    return this._filterCells((function(e) {
                        return -1 !== r.indexOf(e)
                    }
                    ))
                }
                ,
                t.prototype.getFilledCellsInArea = function(e, t, i, n) {
                    var r = this
                      , o = this._getExistingHashesInArea(e, t, i, n).filter((function(e) {
                        return -1 === r._emptyCells.indexOf(e)
                    }
                    ));
                    return this._filterCells((function(e) {
                        return -1 !== o.indexOf(e)
                    }
                    ))
                }
                ,
                t.prototype.getEmptyCells = function() {
                    var e = this;
                    return this._filterCells((function(t) {
                        return -1 !== e._emptyCells.indexOf(t)
                    }
                    ))
                }
                ,
                t.prototype.getEmptyCellsInRange = function(e, t, i) {
                    var n = this
                      , r = this._getExistingHashesInRange(e, t, i).filter((function(e) {
                        return -1 !== n._emptyCells.indexOf(e)
                    }
                    ));
                    return this._filterCells((function(e) {
                        return -1 !== r.indexOf(e)
                    }
                    ))
                }
                ,
                t.prototype.getEmptyCellsInArea = function(e, t, i, n) {
                    var r = this
                      , o = this._getExistingHashesInArea(e, t, i, n).filter((function(e) {
                        return -1 !== r._emptyCells.indexOf(e)
                    }
                    ));
                    return this._filterCells((function(e) {
                        return -1 !== o.indexOf(e)
                    }
                    ))
                }
                ,
                t.prototype.getCellsWithBlueprint = function(e) {
                    var t = this._blueprintMap.get(e);
                    return t || (t = []),
                    (0,
                    n.__spreadArray)([], t, !0)
                }
                ,
                t.prototype.getBlueprintCount = function(e) {
                    return this.getCellsWithBlueprint(e).length
                }
                ,
                t.prototype.hasEnoughItems = function(e) {
                    var t = this;
                    return e.every((function(e) {
                        var i = e.blueprintID
                          , n = e.amount;
                        return t.getBlueprintCount(i) >= n
                    }
                    ))
                }
                ,
                t.prototype.findClosestSourceOf = function(e, t) {
                    var i = this.getFilledCellsWithBehaviors([Ke.Source]).filter((function(t) {
                        var i, n;
                        return null === (n = null === (i = t.content) || void 0 === i ? void 0 : i.getBehavior(Ke.Source)) || void 0 === n ? void 0 : n.sourceFor.includes(e)
                    }
                    ));
                    return i.length ? this._getClosesHarvestableResourceCell(i, t) : null
                }
                ,
                t.prototype.getClosestCellWithBehaviors = function(e, t) {
                    return this._getClosesHarvestableResourceCell(this.getFilledCellsWithSomeBehaviors(e), t)
                }
                ,
                t.prototype.getObjectsWithSameID = function(e) {
                    var t = this;
                    return this.getCellsWithBlueprint(e).map((function(e) {
                        return t.services.mapGrid.getCell(e.column, e.row)
                    }
                    )).filter((function(e) {
                        return void 0 !== e
                    }
                    ))
                }
                ,
                t.prototype.getAdjacentObjectsWithSameID = function(e, t, i) {
                    if (!e.content)
                        return [];
                    for (var n = t || e.content.getBlueprintID(), r = [e], o = new Map, a = []; r.length > 0; ) {
                        var s = r.shift();
                        if (s) {
                            for (var _ = s.getNeighbors(), c = function(e) {
                                var t = _[e];
                                if (o.has("".concat(t.column).concat(t.row)))
                                    return "continue";
                                if (t.content) {
                                    var i = t.content.getBehavior(Ke.Mergeable)
                                      , a = (null == i ? void 0 : i.targetSpecification) || t.content.getBlueprintID();
                                    n === a && r.findIndex((function(e) {
                                        return e === t
                                    }
                                    )) < 0 && r.push(t)
                                }
                            }, l = 0; l < _.length; l++)
                                c(l);
                            a.push(s),
                            o.set("".concat(s.column).concat(s.row), s)
                        }
                        if (i && i > 0 && a.length >= i)
                            break
                    }
                    return a
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.mapGrid.onCellAdded.addListener(this._onCellAdded, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.mapGrid.onCellAdded.removeListener(this._onCellAdded, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getNeighbors = function(e) {
                    for (var t = e.column, i = e.row, n = r.ArrayUtility.shuffleArray([[1, 0], [-1, 0], [0, 1], [0, -1]]), o = [], a = 0; a < n.length; a++) {
                        var s = n[a]
                          , _ = s[0]
                          , c = i + s[1]
                          , l = t + _;
                        ff(c, l, this.services.tiledMap.height, this.services.tiledMap.width) && o.push({
                            column: l,
                            row: c
                        })
                    }
                    return o
                }
                ,
                t.prototype._getClosesHarvestableResourceCell = function(e, t) {
                    var i = this
                      , n = 1 / 0
                      , r = e[0];
                    return e.forEach((function(e) {
                        var o = i.services.axonometricProjection.getWorldPosition(e.column, e.row)
                          , a = i.services.axonometricProjection.getWorldPosition(t.column, t.row)
                          , s = v.Vector2.substract(new v.Vector2(a.x,a.y), new v.Vector2(o.x,o.y)).length();
                        s < n && (n = s,
                        r = e)
                    }
                    )),
                    r
                }
                ,
                t.prototype._getExistingHashesInRange = function(e, t, i) {
                    for (var n = [], r = -i; r <= i; r++)
                        for (var o = -i; o <= i; o++)
                            if (!(Math.abs(r) + Math.abs(o) > i)) {
                                var a = ql(e + r, t + o);
                                this.services.mapGrid.cells.has(a) && n.push(a)
                            }
                    return n
                }
                ,
                t.prototype._getExistingHashesInArea = function(e, t, i, n) {
                    var r, o, a = [];
                    i < e && (e = (r = [i, e])[0],
                    i = r[1]),
                    n < t && (t = (o = [n, t])[0],
                    n = o[1]);
                    for (var s = e; s <= i; s++)
                        for (var _ = t; _ <= n; _++) {
                            var c = ql(s, _);
                            this.services.mapGrid.cells.has(c) && a.push(c)
                        }
                    return a
                }
                ,
                t.prototype._filterCells = function(e) {
                    var t = [];
                    return this.services.mapGrid.cells.forEach((function(i, n) {
                        e(n) && t.push(i)
                    }
                    )),
                    t
                }
                ,
                t.prototype._onCellAdded = function(e) {
                    var t;
                    if (e.content) {
                        var i = null !== (t = this._blueprintMap.get(e.content.getBlueprintID())) && void 0 !== t ? t : [];
                        i.push({
                            column: e.column,
                            row: e.row
                        }),
                        this._blueprintMap.set(e.content.getBlueprintID(), i)
                    } else
                        this._emptyCells.push(ql(e.column, e.row));
                    e.onContentAdded.addListener(this._onCellContentAdded, this),
                    e.onContentRemoved.addListener(this._onCellContentRemoved, this)
                }
                ,
                t.prototype._onCellContentAdded = function(e) {
                    var t, i = e.cell, n = e.content, r = ql(i.column, i.row), o = this._emptyCells.indexOf(r);
                    if (-1 !== o && this._emptyCells.splice(o, 1),
                    n) {
                        var a = null !== (t = this._blueprintMap.get(n.getBlueprintID())) && void 0 !== t ? t : [];
                        a.push({
                            column: i.column,
                            row: i.row
                        }),
                        this._blueprintMap.set(n.getBlueprintID(), a)
                    }
                }
                ,
                t.prototype._onCellContentRemoved = function(e) {
                    var t = e.cell
                      , i = e.content
                      , n = ql(t.column, t.row);
                    if (-1 === this._emptyCells.indexOf(n) && this._emptyCells.push(n),
                    i) {
                        var r = this._blueprintMap.get(i.getBlueprintID());
                        if (r) {
                            var o = r.findIndex((function(e) {
                                return e.column === t.column && e.row === t.row
                            }
                            ));
                            r.splice(o, 1)
                        }
                    }
                }
                ,
                t
            }(Go), mf = "empty", yf = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n._version = 1,
                    n._tiles = new Map,
                    n._modifiedTiles = new Map,
                    n._savingEnabled = !0,
                    n._services = i,
                    n._name = t,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.enableSaving = function() {
                    this._savingEnabled = !0
                }
                ,
                t.prototype.disableSaving = function() {
                    this._savingEnabled = !1
                }
                ,
                Object.defineProperty(t.prototype, "tiles", {
                    get: function() {
                        return this._tiles
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.setTileData = function(e, t) {
                    var i, n = ca(e) ? ql(e) : e;
                    Zl(n) ? this._savingEnabled && ((null === (i = t.state) || void 0 === i ? void 0 : i.blueprint) === mf && (t.state = null),
                    this._modifiedTiles.set(n, t),
                    this.saveData()) : this._logger.error("TilesStateModel.setTileData :: invalid tile format ".concat(n, "!"))
                }
                ,
                t.prototype.hasTileData = function(e) {
                    var t = ql(e);
                    return this._tiles.has(t)
                }
                ,
                t.prototype.cellPosFromString = function(e) {
                    return Zl(e) ? Ql(e) : (this._logger.error("TilesStateModel.cellPosFromString :: invalid tile format ".concat(e, "!")),
                    {
                        row: 0,
                        column: 0
                    })
                }
                ,
                t.prototype.getTileSaveKeys = function() {
                    var e = this
                      , t = this._services.tiledMap.getAllAreas()
                      , i = [];
                    return Object.values(t).forEach((function(t) {
                        t.tiles.forEach((function(t) {
                            return i.push("".concat(e._name).concat("_").concat(ql(t)))
                        }
                        ))
                    }
                    )),
                    i
                }
                ,
                t.prototype.parseTileSaveKeyToPos = function(e) {
                    return this.cellPosFromString(this._getCellFromSavedKey(e))
                }
                ,
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e = this.getTileSaveKeys(),
                                t = e.map((function(e) {
                                    return i.dataContainer.getPlayerData(e).then((function(t) {
                                        return {
                                            id: e,
                                            payload: t
                                        }
                                    }
                                    ))
                                }
                                )),
                                [4, Promise.all(t)];
                            case 1:
                                return n.sent().forEach((function(e) {
                                    var t, n = e.id, r = e.payload, o = null == r ? void 0 : r.data;
                                    o && ((null === (t = o.state) || void 0 === t ? void 0 : t.blueprint) === mf && (o.state = null),
                                    i._tiles.set(i._getCellFromSavedKey(n), o))
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getDataToSave = function() {
                    var e = this
                      , t = {};
                    return this._modifiedTiles.forEach((function(i, n) {
                        t[e._getSavedKeyFromCell(n)] = {
                            data: i,
                            version: e._version
                        }
                    }
                    )),
                    De.services.connection.isConnected && this._modifiedTiles.clear(),
                    t
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {}
                ,
                t.prototype.onDataSave = function() {}
                ,
                t.prototype._getCellFromSavedKey = function(e) {
                    return e.split("_")[1]
                }
                ,
                t.prototype._getSavedKeyFromCell = function(e) {
                    return "".concat(this._name).concat("_").concat(e)
                }
                ,
                t
            }($n), Tf = function() {
                function e(e, t, i, n) {
                    void 0 === n && (n = !0),
                    this.onContentAdded = new r.Event,
                    this.onContentRemoved = new r.Event,
                    this.onContentBehaviorsChanged = new r.Event,
                    this._neighbors = [],
                    this.column = e,
                    this.row = t,
                    this._content = i,
                    this.isSerializable = n
                }
                return e.prototype.isSameCell = function(e) {
                    return this.column === e.column && this.row === e.row
                }
                ,
                e.prototype.addNeighbor = function(e) {
                    -1 === this._neighbors.indexOf(e) && this._neighbors.push(e)
                }
                ,
                e.prototype.getNeighbors = function() {
                    return this._neighbors
                }
                ,
                e.prototype.isNeighbor = function(e) {
                    return -1 !== this._neighbors.indexOf(e)
                }
                ,
                Object.defineProperty(e.prototype, "position", {
                    get: function() {
                        return {
                            column: this.column,
                            row: this.row
                        }
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "content", {
                    get: function() {
                        return this._content
                    },
                    set: function(e) {
                        var t = this._content;
                        this._content = e,
                        t && (this.onContentRemoved.fire({
                            cell: this,
                            content: t
                        }),
                        t.onBehaviorAdded.removeListener(this._onBehaviorAdded, this),
                        t.onBehaviorRemoved.removeListener(this._onBehaviorRemoved, this)),
                        e && (e.onBehaviorAdded.addListener(this._onBehaviorAdded, this),
                        e.onBehaviorRemoved.addListener(this._onBehaviorRemoved, this),
                        this.onContentAdded.fire({
                            cell: this,
                            content: e
                        }))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype._onBehaviorAdded = function(e) {
                    var t = e.gameObject
                      , i = e.behavior;
                    this.onContentBehaviorsChanged.fire({
                        cell: this,
                        content: t,
                        behavior: i
                    })
                }
                ,
                e.prototype._onBehaviorRemoved = function(e) {
                    var t = e.gameObject
                      , i = e.behavior;
                    this.onContentBehaviorsChanged.fire({
                        cell: this,
                        content: t,
                        behavior: i
                    })
                }
                ,
                e
            }(), Af = [[1, 0], [-1, 0], [0, 1], [0, -1]], Cf = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n.onCellAdded = new r.Event,
                    n.onContentAdded = new r.Event,
                    n.onContentRemoved = new r.Event,
                    n._cells = new Map,
                    n._layer = t,
                    n._isSavable = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "cells", {
                    get: function() {
                        return this._cells
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "tiles", {
                    get: function() {
                        return this._tilesStateModel.tiles
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.addCell = function(e, t, i) {
                    void 0 === i && (i = !0);
                    var n = ql(e, t);
                    if (this._cells.has(n))
                        this._logger.warn("cell at (".concat(e, ", ").concat(t, ") already exists"));
                    else {
                        var r = new Tf(e,t,null,i);
                        this._cells.set(n, r),
                        r.onContentAdded.addListener(this._onCellContentAdded, this),
                        r.onContentRemoved.addListener(this._onCellContentRemoved, this),
                        r.onContentBehaviorsChanged.addListener(this._onCellContentBehaviorsChanged, this),
                        this.onCellAdded.fire(r)
                    }
                }
                ,
                t.prototype.setCellAsSerializable = function(e, t) {
                    var i = ql(e, t)
                      , n = this._cells.get(i);
                    n ? n.isSerializable = !0 : this._logger.warn("cell at (".concat(e, ", ").concat(t, ") doesn't exists"))
                }
                ,
                t.prototype.hasCell = function(e, t) {
                    var i = ql(e, t);
                    return this._cells.has(i)
                }
                ,
                t.prototype.getCell = function(e, t) {
                    if (Ee(e))
                        return i = ql(e, t),
                        this._cells.get(i);
                    var i = ql(e.column, e.row);
                    return this._cells.get(i)
                }
                ,
                t.prototype.setContent = function(e, t, i) {
                    var n = this.getCell(e, t);
                    n && (n.content = i)
                }
                ,
                t.prototype.getContent = function(e, t) {
                    var i = this.getCell(e, t);
                    return i ? i.content : null
                }
                ,
                t.prototype.connectCellToNeighbours = function(e, t) {
                    var i = this.getCell(e, t);
                    if (i)
                        for (var n = 0; n < Af.length; n++) {
                            var r = Af[n]
                              , o = ql(e + r[0], t + r[1])
                              , a = this._cells.get(o);
                            a && (i.addNeighbor(a),
                            a.addNeighbor(i))
                        }
                }
                ,
                t.prototype.getNeighbors = function(e, t) {
                    var i, n = this.getCell(e, t);
                    return n && (i = n.getNeighbors()),
                    i
                }
                ,
                t.prototype.enableSaving = function() {
                    this._tilesStateModel.enableSaving()
                }
                ,
                t.prototype.disableSaving = function() {
                    this._tilesStateModel.disableSaving()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._tilesStateModel = new yf("TilesStateModel",this.services),
                                this._isSavable ? (this._logger.info("onInitialize register models"),
                                [4, De.services.autosave.registerModel(this._tilesStateModel)]) : [3, 2];
                            case 1:
                                return e.sent(),
                                [3, 4];
                            case 2:
                                return [4, this._tilesStateModel.initialize()];
                            case 3:
                                e.sent(),
                                e.label = 4;
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._isSavable && De.services.autosave.unregisterModel(this._tilesStateModel),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onCellContentBehaviorsChanged = function(e) {
                    var t = e.cell
                      , i = e.content;
                    e.behavior.serializable && this._serializeCellData(t, i)
                }
                ,
                t.prototype._serializeCellData = function(e, t) {
                    if (e.isSerializable) {
                        var i = null;
                        if (t) {
                            var n = {}
                              , r = t.getBlueprintID();
                            De.services.blueprintCollection.hasBlueprint(r) && (n = De.services.blueprintCollection.getBlueprint(r).components),
                            i = t.serialize(n)
                        }
                        this._tilesStateModel.setTileData({
                            column: e.column,
                            row: e.row
                        }, {
                            state: i
                        })
                    }
                }
                ,
                t.prototype._onCellContentAdded = function(e) {
                    var t = e.cell
                      , i = e.content;
                    this._serializeCellData(t, i),
                    this.onContentAdded.fire(i)
                }
                ,
                t.prototype._onCellContentRemoved = function(e) {
                    var t = e.cell
                      , i = e.content;
                    this._serializeCellData(t),
                    this.onContentRemoved.fire(i)
                }
                ,
                t
            }(Go), If = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    var e = this;
                    return new Promise((function(t, i) {
                        e._dependencies.friendHudService.hudContainer.returnButtonClickedEvent.listenOnce(t, e)
                    }
                    ))
                }
                ,
                t
            }(Vo), Sf = function(e) {
                function t() {
                    return e.call(this, Lo.FRIEND_ACTIVITIES_FINAL, [new ll(Lo.FRIEND_ACTIVITIES_TRACK_5)]) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = this._dependencies.friendHudService.hudContainer.returnButton
                      , t = {
                        x: e.x + 200,
                        y: e.y - e.height / 2
                    };
                    this._steps.push(new _a(ln.VISIT_FRIENDS_ACTIVITIES,!0), new _a(ln.VISIT_FRIENDS_RETURN_HOME), new Da("ShowConversationStep","friend_activities_2"), new fa("ShowClickStep",{
                        animations: [{
                            layer: ea.HUD,
                            animationName: ta.CLICK,
                            points: {
                                startPosition: t
                            },
                            duration: 1250
                        }, {
                            animationName: ta.DELAY,
                            duration: 200
                        }],
                        loop: !0
                    }), new If("AwaitReturnFromFriendStep"), new ra("HideAnimatedHandStep"), new _a(ln.VISIT_FRIENDS_RETURN_HOME,!0), new sa("LogStep","End of Friend Activites Track"))
                }
                ,
                t.prototype._onDestroy = function() {
                    throw new Error("Method not implemented.")
                }
                ,
                t
            }(Wa), Of = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    this._dependencies = e,
                    this._visitorActionFamily = new __(this._dependencies.world,new c_([Ke.VisitorAction])),
                    this._visitorActionFamily.onGameObjectAdded.addListener(this._checkForCompletion, this),
                    this._checkForCompletion()
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._checkForCompletion = function() {
                    this._visitorActionFamily.getGameObjects().length <= 1 || (this.status = !0,
                    this.onStatusChanged.fire(),
                    this._visitorActionFamily.onGameObjectAdded.removeListener(this._checkForCompletion, this))
                }
                ,
                e
            }(), bf = function(e) {
                function t() {
                    var t = e.call(this, Lo.FRIEND_ACTIVITIES_TRACK, [new Of]) || this;
                    return t._cameraPanDuration = .8,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = this._dependencies.visibleCells.getCenterCellPosition()
                      , t = this._getObjectPositionWithVisitorAction(e)
                      , i = t[0]
                      , n = (t[1],
                    this._dependencies.friendHudService.hudContainer.returnButton);
                    n.x,
                    n.y,
                    n.x,
                    n.y,
                    n.height,
                    this._steps.push(new _a(ln.VISIT_FRIENDS_ACTIVITIES), new sa("LogStep","Start of Friend Activities Track"), new u_("MarkTrackAsCompletedStep",[Lo.FRIEND_ACTIVITIES_TRACK, Lo.FRIEND_ACTIVITIES_TRACK_2, Lo.FRIEND_ACTIVITIES_TRACK_3, Lo.FRIEND_ACTIVITIES_TRACK_4, Lo.FRIEND_ACTIVITIES_TRACK_5, Lo.FRIEND_ACTIVITIES_FINAL]), new y_("MoveCameraToTheFirstAction",i,this._cameraPanDuration), new Da("ShowConversationStep","friend_activities_1"), new l_("AwaitObjectWithBehaviorRemoveStep",[Ke.VisitorAction],1), new oa("HideConversationStep"), new sa("LogStep","End of Friend Activites Track"))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t.prototype._getObjectPositionWithVisitorAction = function(e) {
                    var t = this
                      , i = this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.VisitorAction]);
                    return i.sort((function(i, n) {
                        return t._getDistanceBetweenCellPosition(i, e) - t._getDistanceBetweenCellPosition(n, e)
                    }
                    )),
                    [i[0], i[1]]
                }
                ,
                t.prototype._getDistanceBetweenCellPosition = function(e, t) {
                    var i = this._dependencies.axonometricProjection.getWorldPosition(e.column, e.row)
                      , n = this._dependencies.axonometricProjection.getWorldPosition(t.column, t.row);
                    return v.Vector2.substract(new v.Vector2(n.x,n.y), new v.Vector2(i.x,i.y)).length()
                }
                ,
                t
            }(Wa), Rf = function() {
                function e() {
                    this.status = !1,
                    this.onStatusChanged = new r.Event
                }
                return e.prototype.initialize = function(e) {
                    this._dependencies = e,
                    this._setup()
                }
                ,
                e.prototype.destroy = function() {}
                ,
                e.prototype._setup = function() {
                    this._family = new __(this._dependencies.world,new c_([Ke.VisitorAction])),
                    this._family.onGameObjectAdded.addListener(this._checkForCompletion, this),
                    this._checkForCompletion()
                }
                ,
                e.prototype._checkForCompletion = function() {
                    var e = this;
                    return 0 === this._family.getGameObjects().length ? void 0 : (r.TimeDelay.nextFrame().then((function() {
                        e.status = !0,
                        e.onStatusChanged.fire()
                    }
                    )),
                    void this._family.onGameObjectAdded.removeListener(this._checkForCompletion, this))
                }
                ,
                e
            }(), wf = function(e) {
                function t(t) {
                    var i = e.call(this, t, [new Rf]) || this;
                    return i._onboardingTrack = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype._onInitialize = function(e) {}
                ,
                t.prototype._onExecute = function() {
                    var e = this._dependencies.visibleCells.getCenterCellPosition()
                      , t = this._getObjectPositionWithVisitorAction(e);
                    ve(t) || this._steps.push(new sa("LogStep","Start of " + this._onboardingTrack), new y_("MoveCameraToTheFirstAction",t,.8), new l_("AwaitObjectWithBehaviorRemoveStep",[Ke.VisitorAction],1), new sa("LogStep","End of " + this._onboardingTrack))
                }
                ,
                t.prototype._onDestroy = function() {}
                ,
                t.prototype._getObjectPositionWithVisitorAction = function(e) {
                    var t = this
                      , i = this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.VisitorAction]);
                    if (0 !== i.length)
                        return i.sort((function(i, n) {
                            return t._getDistanceBetweenCellPosition(i, e) - t._getDistanceBetweenCellPosition(n, e)
                        }
                        )),
                        i[0]
                }
                ,
                t.prototype._getDistanceBetweenCellPosition = function(e, t) {
                    var i = this._dependencies.axonometricProjection.getWorldPosition(e.column, e.row)
                      , n = this._dependencies.axonometricProjection.getWorldPosition(t.column, t.row);
                    return v.Vector2.substract(new v.Vector2(n.x,n.y), new v.Vector2(i.x,i.y)).length()
                }
                ,
                t
            }(Wa), Df = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._friendData = De.services.navigation.getChosenFriendDestination(),
                    t._createBackground(),
                    t._createFriendInfo(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function() {
                    this._background.visible = !0,
                    this._friendInfoContainer.visible = !0
                }
                ,
                t.prototype.hide = function() {
                    this._background.visible = !1,
                    this._friendInfoContainer.visible = !1
                }
                ,
                t.prototype._createBackground = function() {
                    this._background = this.addChild(new cr(De.services.resource.getTexture(f.POPUP_NOTIFICATION_9SLICE))),
                    this._background.setSizes({
                        width: 800,
                        height: 175
                    }),
                    this._background.anchor.set(.5)
                }
                ,
                t.prototype._createFriendInfo = function() {
                    this._friendInfoContainer = new Xe.Container;
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: 400
                    });
                    e.style = vn.darkGreyExtraSmall;
                    var t = new v.Label(nr(Hg || (Hg = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.VISITING_FRIEND_HEADER_TEXT),e);
                    t.anchor.set(.5),
                    t.position.set(0, this._background.y - 35);
                    var i = rr(De.services.resource.getSprite(f.AVATAR_248), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: this._background.width / 2 - 80,
                            y: this._background.y
                        }
                    });
                    if (this._friendData) {
                        e.style = vn.darkMedium;
                        var r = new v.Label(this._friendData.name,e);
                        r.anchor.set(.5),
                        r.position.set(0, this._background.y + 20);
                        var o = rr(this._friendData.getPhoto(fn.SMALL), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: i.x,
                                y: i.y
                            }
                        });
                        i.visible = !1,
                        this._friendInfoContainer.addChild(t, i, r, o),
                        this.addChild(this._friendInfoContainer)
                    }
                }
                ,
                t
            }(Xe.Container), Nf = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.returnButtonClickedEvent = new r.Event,
                    i.addServices({}),
                    i._dependencies = t,
                    i._visitFriendHeader = i.addChild(new Df),
                    i._returnButton = i.addChild(new hr({
                        name: "home",
                        buttonIdle: f.BTN_HOME
                    })),
                    i._returnButton.onClick(nc(i._returnButtonClicked.bind(i))),
                    i.returnButtonClickedEvent.listenOnce((function() {
                        return De.services.transition.goToOwnFarm()
                    }
                    ), i),
                    i._dependencies.events.notificationEvent.addListener(i._showHomeButtonNotification, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "returnButton", {
                    get: function() {
                        return this._returnButton
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.onDestroy = function() {
                    this._dependencies.events.notificationEvent.removeListener(this._showHomeButtonNotification, this)
                }
                ,
                t.prototype.show = function(e) {
                    this._visitFriendHeader.show(),
                    this._returnButton.show(),
                    this.resize({
                        bounds: De.services.canvas.bounds,
                        orientation: De.services.canvas.currentOrientation
                    }),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    this._visitFriendHeader.hide(),
                    this._returnButton.hide(),
                    this._returnButton.onClick((function() {}
                    )),
                    e()
                }
                ,
                t.prototype.resize = function(e) {
                    var t, i, n = null !== (i = null === (t = vp.platform.hudStrategy.friendDrawerOffsets) || void 0 === t ? void 0 : t.topDrawer) && void 0 !== i ? i : 0;
                    this._visitFriendHeader.position.set(0, -e.bounds.height / 2 + 200),
                    this._returnButton.position.set(-(e.bounds.width / 2 - 100), -(e.bounds.height / 2 - (100 + n)))
                }
                ,
                t.prototype._showHomeButtonNotification = function() {
                    var e = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION);
                    e.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !0),
                    e.position.set(40, -30),
                    this._returnButton.addChild(e)
                }
                ,
                t.prototype._returnButtonClicked = function() {
                    this.returnButtonClickedEvent.fire()
                }
                ,
                t
            }(Er), Lf = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._commonFriendEvents = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "hudContainer", {
                    get: function() {
                        return this._hudContainer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._hudContainer = De.services.navigation.showHUD(Nf, {
                                events: this._commonFriendEvents
                            }),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), Bf = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._interactionWhitelist = new Map,
                    t._blockAllDrags = !1,
                    t._blockAllTaps = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "dragWhitelist", {
                    get: function() {
                        return this._interactionWhitelist.get(ko.OBJECT_DRAG) || []
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "tapWhitelist", {
                    get: function() {
                        return this._interactionWhitelist.get(ko.TAP) || []
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.isDragValid = function(e) {
                    var t = !1;
                    if (!this._blockAllDrags) {
                        var i = this._interactionWhitelist.get(ko.OBJECT_DRAG) || [];
                        t = 0 === i.length || this._arrayContainsDrag(i, e)
                    }
                    return !t && this.services.onboarding.activeTrackKey && De.services.analytics.design.reportInvalidInteraction(this.services.onboarding.activeTrackKey, "dragEnd"),
                    t
                }
                ,
                t.prototype.isDragStartValid = function(e) {
                    var t = !1;
                    if (!this._blockAllDrags) {
                        var i = this._interactionWhitelist.get(ko.OBJECT_DRAG) || [];
                        t = 0 === i.length || i.some((function(t) {
                            return t.start.column === e.column && t.start.row === e.row
                        }
                        ))
                    }
                    return !t && this.services.onboarding.activeTrackKey && De.services.analytics.design.reportInvalidInteraction(this.services.onboarding.activeTrackKey, "dragStart"),
                    t
                }
                ,
                t.prototype.isTapValid = function(e) {
                    var t = !1;
                    if (!this._blockAllTaps) {
                        var i = this._interactionWhitelist.get(ko.TAP) || [];
                        t = 0 === i.length || this._arrayContainsPosition(i, e)
                    }
                    return !t && this.services.onboarding.activeTrackKey && De.services.analytics.design.reportInvalidInteraction(this.services.onboarding.activeTrackKey, "tap"),
                    t
                }
                ,
                t.prototype.allowAllDrags = function() {
                    this._interactionWhitelist.delete(ko.OBJECT_DRAG),
                    this._blockAllDrags = !1
                }
                ,
                t.prototype.allowAllTaps = function() {
                    this._interactionWhitelist.delete(ko.TAP),
                    this._blockAllTaps = !1
                }
                ,
                t.prototype.blockAllDrags = function() {
                    this._blockAllDrags = !0
                }
                ,
                t.prototype.blockAllTaps = function() {
                    this._blockAllTaps = !0
                }
                ,
                t.prototype.allowDrag = function(e) {
                    var t = this;
                    me(e) ? e.forEach((function(e) {
                        t._updateDragData(e, !0)
                    }
                    )) : this._updateDragData(e, !0),
                    this._blockAllDrags = !1
                }
                ,
                t.prototype.removeDrag = function(e) {
                    var t = this;
                    me(e) ? e.forEach((function(e) {
                        t._updateDragData(e, !1)
                    }
                    )) : this._updateDragData(e, !0)
                }
                ,
                t.prototype.allowTap = function(e) {
                    var t = this;
                    me(e) ? e.forEach((function(e) {
                        return t._updateTapData(e, !0)
                    }
                    )) : this._updateTapData(e, !0),
                    this._blockAllTaps = !1
                }
                ,
                t.prototype.removeTapWhitelist = function(e) {
                    var t = this;
                    me(e) ? e.forEach((function(e) {
                        return t._updateTapData(e, !1)
                    }
                    )) : this._updateTapData(e, !1)
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateDragData = function(e, t) {
                    var i = this._interactionWhitelist.get(ko.OBJECT_DRAG) || [];
                    t ? this._arrayContainsDrag(i, e) || i.push(e) : this._arrayContainsDrag(i, e) && i.splice(i.indexOf(e), 1),
                    this._interactionWhitelist.set(ko.OBJECT_DRAG, i)
                }
                ,
                t.prototype._updateTapData = function(e, t) {
                    var i = this._interactionWhitelist.get(ko.TAP) || [];
                    t ? this._arrayContainsPosition(i, e) || i.push(e) : this._arrayContainsPosition(i, e) && i.splice(i.indexOf(e), 1),
                    this._interactionWhitelist.set(ko.TAP, i)
                }
                ,
                t.prototype._arrayContainsPosition = function(e, t) {
                    return e.some((function(e) {
                        return e.column === t.column && e.row === t.row
                    }
                    ))
                }
                ,
                t.prototype._arrayContainsDrag = function(e, t) {
                    return e.some((function(e) {
                        return e.start.column === t.start.column && e.start.row === t.start.row && e.end.column === t.end.column && e.end.row === t.end.row
                    }
                    ))
                }
                ,
                t
            }(Go), Pf = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onSkipButtonPressed = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "dialogs", {
                    get: function() {
                        return this._dialogs
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.setCurrentDialogData = function(e) {
                    this._dialogPopup.setCurrentDialogData(e)
                }
                ,
                t.prototype.showDialog = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._dialogPopup.showDialog(this.services.onboarding.shouldShowSkipButton())];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hideDialog = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._dialogPopup.hideDialog()];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onClick = function(e) {
                    this._dialogPopup.onClick(e)
                }
                ,
                t.prototype.removeOnClick = function() {
                    this._dialogPopup.removeOnClick()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons(_e.ONBOARDING_DIALOGS)];
                            case 1:
                                return e.sent(),
                                this._dialogs = De.services.resource.getJson(_e.ONBOARDING_DIALOGS),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    var e = De.services.navigation.showConversation(this.onSkipButtonPressed);
                    if (!e)
                        throw new Error("OnboardingDialogService: the navigation service returned null instead of DialogSequencePopup");
                    this._dialogPopup = e
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.navigation.hideConversation(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), kf = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.onBuildingStateChanged = new r.Event,
                    t.onBuildingLevelChanged = new r.Event,
                    t._model = new Tv,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "activeBuildings", {
                    get: function() {
                        return this._model.getBuildingsWithState(sv.ACTIVE)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "inactiveBuildings", {
                    get: function() {
                        return this._model.getBuildingsWithState(sv.UPGRADING).concat(this._model.getBuildingsWithState(sv.UNDISCOVERED))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.isBuildingActive = function(e) {
                    return this._model.isActive(e)
                }
                ,
                t.prototype.isBuildingUndiscovered = function(e) {
                    return this._model.isUndiscovered(e)
                }
                ,
                t.prototype.isBuildingUpgrading = function(e) {
                    return this._model.isUpgrading(e)
                }
                ,
                t.prototype.getBuildingState = function(e) {
                    var t;
                    return null !== (t = this._model.getBuildingState(e)) && void 0 !== t ? t : sv.UNDISCOVERED
                }
                ,
                t.prototype.getBuildingLevel = function(e) {
                    var t;
                    return null !== (t = this._model.getBuildingLevel(e)) && void 0 !== t ? t : 1
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._model.initialize()];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.onBuildingStateChanged.removeAllListeners(),
                            this.onBuildingLevelChanged.removeAllListeners(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go);
            !function(e) {
                e.standalone = "map_short_-_no_social_features",
                e.facebook = "map_facebook",
                e.ms_start = "map_short_-_no_social_features",
                e.crazygames = "map_short_-_no_social_features",
                e.discord = "map_facebook",
                e.premium = "map-premium",
                e.local_dev = "map_playground"
            }(jg || (jg = {}));
            var xf, Gf, Uf, Ff, Mf, Vf, Hf, jf, Kf, Wf, zf, Yf = function() {
                function e() {
                    this._currentGSapAnimation = null,
                    this._currentSpineAnimation = null
                }
                return e.prototype.showHandAnimation = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._showNextAnimationStep = this._showNextAnimationStep.bind(this),
                            this._handAnimationData = e,
                            this._currentAnimationStep = -1,
                            this._createSpineAnimation(),
                            this._showNextAnimationStep(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.removeHandAnimation = function() {
                    De.services.actions.emit("onboarding.removeAnimations"),
                    this._removeTweenHandAnimation(),
                    this._removeSpineAnimation()
                }
                ,
                e.prototype._createSpineAnimation = function() {
                    this._currentSpineAnimation = De.services.resource.getSpine(se.HOW_TO_PLAY_ACTION),
                    this._handAnimationData.mirror && (this._currentSpineAnimation.scale.x = -this._currentSpineAnimation.scale.x),
                    this._currentSpineAnimation.pivot.set(130, -180),
                    this._currentSpineAnimation.state.addListener({
                        complete: this._showNextAnimationStep
                    }),
                    this._setSpineToStartPosition(),
                    this._handAnimationData.layer.addChild(this._currentSpineAnimation)
                }
                ,
                e.prototype._setSpineToStartPosition = function() {
                    var e;
                    null === (e = this._currentSpineAnimation) || void 0 === e || e.position.copyFrom(this._handAnimationData.startPosition)
                }
                ,
                e.prototype._showNextAnimationStep = function() {
                    var e;
                    if (null === (e = this._currentSpineAnimation) || void 0 === e || e.state.clearTracks(),
                    this._currentAnimationStep += 1,
                    void 0 === this._handAnimationData.handAnimationSpineData[this._currentAnimationStep]) {
                        if (!this._handAnimationData.loop)
                            return;
                        this._currentAnimationStep = 0,
                        this._setSpineToStartPosition()
                    }
                    this._handAnimationData.handAnimationSpineData[this._currentAnimationStep].effectAnimationName ? this._updateSpineAnimationState() : ve(this._handAnimationData.handAnimationSpineData[this._currentAnimationStep].idle) ? this._handAnimationData.handAnimationSpineData[this._currentAnimationStep].points && (this._removeTweenHandAnimation(),
                    this._updateTweenAnimation()) : this._awaitIdleTime(this._handAnimationData.handAnimationSpineData[this._currentAnimationStep].idle)
                }
                ,
                e.prototype._awaitIdleTime = function(e) {
                    var t = this;
                    r.TimeDelay.after(e).promise.then((function() {
                        t._showNextAnimationStep()
                    }
                    ))
                }
                ,
                e.prototype._updateSpineAnimationState = function() {
                    var e = this._handAnimationData.handAnimationSpineData[this._currentAnimationStep].effectAnimationName;
                    void 0 !== e && null !== this._currentSpineAnimation && this._currentSpineAnimation.state.setAnimation(this._currentAnimationStep, e, !1)
                }
                ,
                e.prototype._updateTweenAnimation = function() {
                    var e = this._handAnimationData.handAnimationSpineData[this._currentAnimationStep].points;
                    if (void 0 !== e && null !== this._currentSpineAnimation) {
                        this._currentGSapAnimation = lr.gsap.timeline();
                        var t = e[0]
                          , i = e.slice(1);
                        this._currentSpineAnimation.position.copyFrom(t);
                        for (var n = 0; n < i.length; n++) {
                            var r = this._calculateDuration(this._handAnimationData.velocity, 0 === n ? t : i[n - 1], i[n]);
                            this._currentGSapAnimation.add(lr.gsap.to(this._currentSpineAnimation.position, {
                                x: i[n].x,
                                y: i[n].y,
                                duration: r
                            }))
                        }
                        this._currentGSapAnimation.play(),
                        this._currentGSapAnimation.eventCallback("onComplete", this._showNextAnimationStep)
                    }
                }
                ,
                e.prototype._calculateDuration = function(e, t, i) {
                    var n = t.x - i.x
                      , r = t.y - i.y;
                    return Math.sqrt(n * n + r * r) / e
                }
                ,
                e.prototype._removeTweenHandAnimation = function() {
                    var e;
                    null === (e = this._currentGSapAnimation) || void 0 === e || e.kill(),
                    this._currentGSapAnimation = null
                }
                ,
                e.prototype._removeSpineAnimation = function() {
                    null !== this._currentSpineAnimation && (this._handAnimationData.layer.removeChild(this._currentSpineAnimation),
                    this._currentSpineAnimation.state.removeListener({
                        complete: this._showNextAnimationStep
                    }),
                    this._currentSpineAnimation.destroy(),
                    this._currentSpineAnimation = null)
                }
                ,
                e
            }(), Jf = [jg.facebook, jg.crazygames, jg.ms_start, jg.standalone], Xf = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.onTrackStarted = new r.Event,
                    t.onTrackCompleted = new r.Event,
                    t.onTrackCanceled = new r.Event,
                    t._tracks = [],
                    t._startableTracks = [],
                    t._interactionReadyTracks = vp.platform.onboardingTracksStrategy.getInteractionReadyTracks(),
                    t._activeTrack = null,
                    t._isInitialized = !1,
                    t._isOnboardingEnabled = Jf.includes("map_facebook"),
                    t.handHelper = new Yf,
                    t.inputBlocker = new zo,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "activeTrackKey", {
                    get: function() {
                        var e;
                        return null === (e = this._activeTrack) || void 0 === e ? void 0 : e.key
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "isOnboardingEnabled", {
                    get: function() {
                        return this._isOnboardingEnabled
                    },
                    set: function(e) {
                        Jf.includes("map_facebook") && (this._isOnboardingEnabled = e,
                        this._tryToStartNextTrack())
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.addTrack = function(e) {
                    this._tracks.includes(e) ? this._logger.warn("Onboarding track has been added twice: ".concat(e.key)) : this._model.isTrackCompleted(e.key) || (this._tracks.push(e),
                    this._isInitialized && (this._subscribeToTrack(e),
                    e.initialize(this.services)))
                }
                ,
                t.prototype.addTracks = function(e) {
                    for (var t = 0; t < e.length; t++)
                        this.addTrack(e[t])
                }
                ,
                t.prototype.addSequenceTracks = function(e) {
                    for (var t = 0; t < e.length; t++) {
                        var i = e[t];
                        this._tracks.length > 0 && i.addTrigger(new ll(e[t - 1].key)),
                        this.addTrack(i)
                    }
                }
                ,
                t.prototype.isTrackCompleted = function(e) {
                    return this._model.isTrackCompleted(e)
                }
                ,
                t.prototype.markTrackAsComplete = function(e) {
                    this._model.completeTrack(e),
                    this.onTrackCompleted.fire(e)
                }
                ,
                t.prototype.setHudElementVisibilityFlag = function(e, t) {
                    this._model.setHudElementFlag(e, t)
                }
                ,
                t.prototype.hideHudElement = function(e, t, i) {
                    this._model.isHudHidden(e) || (this.services.hudService.hideHudElement(e, t),
                    i && this._model.setHudElementFlag(e, !0))
                }
                ,
                t.prototype.showHudElement = function(e, t) {
                    void 0 === t && (t = !0),
                    !this._model.isHudHidden(e) && t || (this.services.hudService.showHudElement(e),
                    this._model.setHudElementFlag(e, !1))
                }
                ,
                t.prototype.pauseBuilding = function(e) {
                    this._model.flagBuildingAsPaused(e, !0)
                }
                ,
                t.prototype.unpauseBuilding = function(e) {
                    this._model.flagBuildingAsPaused(e, !1)
                }
                ,
                t.prototype.isBuildingPaused = function(e) {
                    return this._model.isBuildingPaused(e)
                }
                ,
                t.prototype.isCameraDisabled = function() {
                    return this._model.getCameraState() === Ca.DISABLED
                }
                ,
                t.prototype.updateCameraState = function(e) {
                    switch (this._model.setCameraState(e),
                    e) {
                    case Ca.ENABLED:
                        this.services.cameraService.enable();
                        break;
                    case Ca.DISABLED:
                        this.services.cameraService.disable()
                    }
                }
                ,
                t.prototype.cancelActiveTrack = function() {
                    this._activeTrack && (this._activeTrack.cancel(),
                    this.services.interactionWhitelistService.allowAllDrags(),
                    this.services.interactionWhitelistService.allowAllTaps(),
                    this.updateCameraState(Ca.ENABLED))
                }
                ,
                t.prototype.removeTrack = function(e) {
                    var t = this._tracks.find((function(t) {
                        return t.key === e
                    }
                    ));
                    t && this._removeTrack(t)
                }
                ,
                t.prototype.shouldShowSkipButton = function() {
                    return !1
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._initializationPromise || (this._initializationPromise = new Promise((function(t) {
                                0 !== e._tracks.length && e._tracks.every((function(t) {
                                    return e._model.isTrackCompleted(t.key)
                                }
                                )) ? (e._isInitialized = !0,
                                t()) : De.services.lazyLoad.prioritizeGroup(hn.ONBOARDING).then((function() {
                                    for (var i = 0; i < e._tracks.length; i++) {
                                        var n = e._tracks[i];
                                        e._subscribeToTrack(n),
                                        n.initialize(e.services)
                                    }
                                    e._isInitialized = !0,
                                    t()
                                }
                                ))
                            }
                            )),
                            this._model.isTrackCompleted(Lo.TRAIN_STATION_TRACK_2),
                            (0,
                            r.isNull)(this._activeTrack) && De.services.navigation.currentSceneIndex === wr.MAIN && this._showAllHud(),
                            this.onTrackCompleted.addListener(this._checkInteractionReady, this)),
                            [2, this._initializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    var e = this;
                    this.services.hudService && this._model.getHiddenHud().forEach((function(t) {
                        e.services.hudService.hideHudElement(t, !0)
                    }
                    )),
                    this._model.getCameraState() === Ca.DISABLED && this.services.cameraService.disable(),
                    this.services.dialogService.onSkipButtonPressed.listenOnce(this._skipOnboarding, this),
                    this._getOnboardingRunningAtStartOfSession(),
                    this._tryToStartNextTrack()
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._tracks.forEach((function(t) {
                                return e._unsubcribeFromTrack(t)
                            }
                            )),
                            this.handHelper.removeHandAnimation(),
                            this.inputBlocker.removeInputBlocker(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getOnboardingRunningAtStartOfSession = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e = new Promise((function(e) {
                                    setTimeout((function() {
                                        e(!1)
                                    }
                                    ), 500)
                                }
                                )),
                                t = new Promise((function(e) {
                                    r.onTrackStarted.listenOnce((function() {
                                        e(!0)
                                    }
                                    ), r)
                                }
                                )),
                                [4, Promise.race([e, t])];
                            case 1:
                                return i = n.sent(),
                                De.services.onboardingGameService.onboardingRunningAtStartSessionResolve(i),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._skipOnboarding = function() {
                    var e = this;
                    this.activeTrackKey && (De.services.analytics.design.reportOnboardingSkipped(this.activeTrackKey),
                    De.services.actions.emit("skip.".concat(this.activeTrackKey.toLowerCase()))),
                    this.cancelActiveTrack(),
                    xo.forEach((function(t) {
                        e.markTrackAsComplete(t),
                        e.removeTrack(t),
                        e.isBuildingPaused(E_.MARKET) && (e.unpauseBuilding(E_.MARKET),
                        e.services.ordersService.onBuildingUnpaused(E_.MARKET))
                    }
                    )),
                    this._showAllHud()
                }
                ,
                t.prototype._tryToStartNextTrack = function() {
                    if (!this._activeTrack && this._isOnboardingEnabled && this._isInitialized) {
                        var e = this._startableTracks.shift();
                        e ? this._startTrack(e) : this.services.cameraService.enable()
                    } else
                        this.services.cameraService.enable()
                }
                ,
                t.prototype._startTrack = function(e) {
                    var t = this;
                    De.services.adsService.hideBannerAd(),
                    this._activeTrack = e,
                    this._removeTrack(e),
                    e.onTrackCanceled.listenOnce(this._onTrackCanceled.bind(this, e), this),
                    this.onTrackStarted.fire(e.key),
                    e.execute().then((function() {
                        t._onTrackCompleted(e),
                        t._removeTrack(e),
                        t._activeTrack = null,
                        t._tryToStartNextTrack()
                    }
                    )).catch((function() {
                        t._logger.info("canceled track: ".concat(e.key))
                    }
                    ))
                }
                ,
                t.prototype._onTrackCanceled = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this.services.dialogService.removeOnClick(),
                                this.handHelper.removeHandAnimation(),
                                [4, this.services.dialogService.hideDialog()];
                            case 1:
                                return i.sent(),
                                this._unsubcribeFromTrack(e),
                                this._activeTrack = null,
                                this.addTrack(e),
                                this.onTrackCanceled.fire(e.key),
                                this.services.interactionWhitelistService.allowAllDrags(),
                                this.services.interactionWhitelistService.allowAllTaps(),
                                this.updateCameraState(Ca.ENABLED),
                                r.TimeDelay.after(500).promise.then((function() {
                                    t.services.hudService.hudContainer.setDefaultCratesButtonController(),
                                    De.services.navigation.onDialogClosed.fire()
                                }
                                )),
                                De.services.adsService.setBannerInterval(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showAllHud = function() {
                    var e = this;
                    Object.keys(Ns).filter((function(e) {
                        return isNaN(Number(e))
                    }
                    )).forEach((function(t) {
                        e.showHudElement(Ns[t])
                    }
                    ))
                }
                ,
                t.prototype._onTrackStartable = function(e) {
                    this._startableTracks.includes(e) ? this._logger.warn("Onboarding track has become startable twice: ".concat(e.key)) : (this._startableTracks.push(e),
                    this._tryToStartNextTrack())
                }
                ,
                t.prototype._onTrackUnavailable = function(e) {
                    var t = this._startableTracks.indexOf(e);
                    -1 !== t && this._startableTracks.splice(t, 1)
                }
                ,
                t.prototype._subscribeToTrack = function(e) {
                    e.onTrackStartable.addListener(this._onTrackStartable, this),
                    e.onTrackUnavailable.addListener(this._onTrackUnavailable, this)
                }
                ,
                t.prototype._unsubcribeFromTrack = function(e) {
                    this._tracks.includes(e) && (e.onTrackStartable.removeListener(this._onTrackStartable, this),
                    e.onTrackUnavailable.removeListener(this._onTrackUnavailable, this))
                }
                ,
                t.prototype._removeTrack = function(e) {
                    var t = this._tracks.indexOf(e);
                    if (-1 !== t) {
                        this._unsubcribeFromTrack(e),
                        e.destroy(),
                        this._tracks.splice(t, 1);
                        var i = this._startableTracks.indexOf(e);
                        i >= 0 && this._startableTracks.splice(i, 1)
                    }
                }
                ,
                t.prototype._onTrackCompleted = function(e) {
                    this._model.completeTrack(e.key),
                    this.onTrackCompleted.fire(e.key),
                    De.services.actions.emit("completeTrack.".concat(e.key.toLowerCase())),
                    De.services.adsService.setBannerInterval()
                }
                ,
                t.prototype._checkInteractionReady = function(e) {
                    this._interactionReadyTracks.includes(e) && De.services.onboardingGameService.onInteractionReadyEvent.fire()
                }
                ,
                Object.defineProperty(t.prototype, "_model", {
                    get: function() {
                        return De.services.onboardingGameService.model
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }(Go), qf = [{
                name: "pop",
                duration: 1,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: .6333,
                        duration: .1,
                        ease: "none",
                        params: {
                            scale: {
                                x: "+=0.3",
                                y: "+=0.3"
                            }
                        }
                    }, {
                        time: .7333,
                        duration: 0,
                        ease: "none",
                        params: {},
                        event: "confetti_appear"
                    }, {
                        time: .7333,
                        duration: .25,
                        ease: "back.out",
                        params: {
                            scale: {
                                x: "-=0.3",
                                y: "-=0.3"
                            }
                        }
                    }]
                }
            }], Qf = ((xf = {})[Sn.WHEAT] = f.BG_UPGRADECARD_CROPS_WHEAT_03,
            xf[Sn.EGG] = f.BG_UPGRADECARD_ANIMAL_CHICKEN_03,
            xf[Sn.SUNFLOWER] = f.BG_UPGRADECARD_CROPS_SUNFLOWER_03,
            xf[Sn.MILK] = f.BG_UPGRADECARD_ANIMAL_COW_03,
            xf[Sn.SUGARCANE] = f.BG_UPGRADECARD_CROPS_SUGARCANE_03,
            xf[Sn.BACON] = f.BG_UPGRADECARD_ANIMAL_PIG_03,
            xf[Sn.CARROT] = f.BG_UPGRADECARD_CROPS_CARROT_03,
            xf[Sn.GOATMILK] = f.BG_UPGRADECARD_ANIMAL_GOAT_03,
            xf[Sn.SOYBEANS] = f.BG_UPGRADECARD_CROPS_SOYBEANS_03,
            xf[Sn.WOOL] = f.BG_UPGRADECARD_ANIMAL_SHEEP_03,
            xf[Sn.CORN] = f.BG_UPGRADECARD_CROPS_CORN_03,
            xf[Sn.FUR] = f.BG_UPGRADECARD_ANIMAL_DEER_03,
            xf[Sn.COFFEEBEANS] = f.BG_UPGRADECARD_CROPS_COFFEE_03,
            xf[Sn.TOMATO] = f.BG_UPGRADECARD_CROPS_TOMATO_03,
            xf[Sn.AVOCADO] = f.BG_UPGRADECARD_CROPS_AVOCADO_03,
            xf[Sn.TRUFFLE] = f.BG_UPGRADECARD_ANIMAL_TRUFFLEPIG_03,
            xf), Zf = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    i.priority = _r.IMMEDIATE,
                    i._name = "UpgradeCardOverlay",
                    i._owned = !1,
                    i._canClose = !0,
                    i._inputBlocker.off("pointerup", void 0, i),
                    i._options = t,
                    i._owned = t.currentTier >= t.value,
                    i.onOpened.listenOnce((function() {
                        i._inputBlocker.on("pointerup", i._tryToClose, i),
                        i._content.on("pointerup", i._tryToClose, i)
                    }
                    ), i);
                    var r = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 150,
                        fitWidth: De.services.canvas.width - 100
                    });
                    r.style = vn.lightBoldExtraLarge,
                    i._title = new v.Label(nr(Gf || (Gf = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.UPGRADE_FOUND),r);
                    var o = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 250,
                        fitWidth: De.services.canvas.width - 100
                    });
                    return o.style = vn.lightBoldLarge,
                    i._explanation = new v.Label(i._owned ? nr(Uf || (Uf = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.UPGRADE, i._options.value + 1) : nr(Ff || (Ff = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.UPGRADE_FOR_MORE_INGREDIENTS),o),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._addHeaderText(),
                            this._createObjectCardBackground(),
                            this._createObjectImage(),
                            this._createExplanationText(),
                            this._createButton(),
                            e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    De.services.adsService.setBannerInterval(),
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerup", this._tryToClose, this),
                    this._content.off("pointerup", this._tryToClose, this)
                }
                ,
                t.prototype.close = function() {
                    var t, i;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            return null === (t = this._moveAndScaleAnimation) || void 0 === t || t.play("moveAndScale"),
                            null === (i = this._genericFadeAnimation) || void 0 === i || i.play("fadeOut"),
                            e.prototype.close.call(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._tryToClose = function(t) {
                    this._canClose && e.prototype.close.call(this)
                }
                ,
                t.prototype._addHeaderText = function() {
                    this._title.anchor.set(.5),
                    this._title.position.set(0, -De.services.canvas.height / 3),
                    this._content.addChild(this._title)
                }
                ,
                t.prototype._updateHeaderText = function() {
                    this._title.text = nr(Mf || (Mf = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.UPGRADE_SUCCESFUL),
                    this._title.alpha = 1
                }
                ,
                t.prototype._updateExplanationText = function() {
                    this._explanation.text = nr(Vf || (Vf = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.UPGRADE_SUCCESFUL_BODY),
                    this._explanation.alpha = 1
                }
                ,
                t.prototype._createObjectCardBackground = function() {
                    this._upgradeCardBackground = rr(De.services.resource.getSprite(f["BG_UPGRADECARD_0".concat(this._options.value)]), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: .8,
                            y: .8
                        },
                        position: {
                            x: 0,
                            y: -De.services.canvas.height / 10
                        }
                    }),
                    this._content.addChild(this._upgradeCardBackground)
                }
                ,
                t.prototype._createObjectImage = function() {
                    var e = De.services.resource.getSprite(Qf[this._options.targetObject]);
                    e.anchor.set(.5),
                    this._upgradeCardBackground.addChild(e)
                }
                ,
                t.prototype._createExplanationText = function() {
                    this._explanation.anchor.set(.5),
                    this._explanation.position.set(0, De.services.canvas.height / 7);
                    var e = this._explanation.settings;
                    this._tapToContinueText = new v.Label(nr(Hf || (Hf = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAP_TO_CONTINUE),e),
                    this._tapToContinueText.anchor.set(.5),
                    this._tapToContinueText.position.set(0, De.services.canvas.height / 3),
                    this._content.addChild(this._explanation, this._tapToContinueText)
                }
                ,
                t.prototype._createButton = function() {
                    var e = this
                      , t = new fr({
                        name: "upgrade",
                        buttonIdle: this._owned ? f.BTN_DEFAULT_GREY_INACTIVE : f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 600,
                            height: 120
                        }
                    },{
                        text: nr(jf || (jf = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), this._owned ? ce.UPGRADE_BUTTON_OWNED : ce.UPGRADE_BUTTON_ACTIVATE),
                        textStyle: vn.lightBoldLarge,
                        position: {
                            x: 0,
                            y: -10
                        },
                        fitBoxSizes: {
                            width: 600,
                            height: 120
                        },
                        alignment: "center"
                    });
                    t.position.set(0, De.services.canvas.height / 4),
                    t.onClick((function() {
                        t.visible = !1,
                        e._onUpgradeClicked()
                    }
                    )),
                    t.interactive = !this._owned,
                    this._content.addChild(t)
                }
                ,
                t.prototype._onUpgradeClicked = function() {
                    var e = this;
                    this._canClose = !1,
                    this._options.onUpgrade(),
                    this.onClosed.listenOnce((function() {
                        return e._playStarsToDiaryAnimation()
                    }
                    ), this),
                    this._startAnimation()
                }
                ,
                t.prototype._playStarsToDiaryAnimation = function() {
                    var e = De.services.navigation.layers.popup.container
                      , t = e.toGlobal(new Xe.Point(0,0))
                      , i = De.services.navigation.hudLayer.hudContainer.getUIelement(Ns.DiscoveryButtonUI).position
                      , n = this._options.value - this._options.currentTier;
                    new Lr(De.services.resource.getSprite(f.ICON_STAR_UPGRADED_01),e.toLocal(t),e.toLocal(i),n,e).animate()
                }
                ,
                t.prototype._startAnimation = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e = this._upgradeCardBackground.position.y + 590,
                                this._beamsAnimation = De.services.resource.getSpine(se.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP),
                                this._beamsAnimation.zIndex = this._upgradeCardBackground.zIndex - 1,
                                this._beamsAnimation.alpha = 0,
                                this._beamsAnimation.y = e,
                                this._content.addChild(this._beamsAnimation),
                                this._content.sortChildren(),
                                this._genericFadeAnimation = new ur(B_),
                                this._genericFadeAnimation.setTargets({
                                    container: this._beamsAnimation
                                }),
                                this._moveAndScaleAnimation = new ur(_v),
                                this._moveAndScaleAnimation.setTargets({
                                    container: this._beamsAnimation
                                }),
                                (t = new ur(qf)).setTargets({
                                    container: this._upgradeCardBackground
                                }),
                                this._upgradeAnimation = this.addChild(De.services.resource.getSpine(se.BUILDING_REPAIR)),
                                this._upgradeAnimation.skeleton.findSlot("obj_building_broken").currentSprite.alpha = 0,
                                this._upgradeAnimation.skeleton.findSlot("obj_building_broken_glow").currentSprite.alpha = 0,
                                this._upgradeAnimation.skeleton.findSlot("obj_building").currentSprite.alpha = 0,
                                this._upgradeAnimation.skeleton.findSlot("obj_building_glow").currentSprite.alpha = 0,
                                this._upgradeAnimation.skeleton.findSlot("btn_rank_level_circle").currentSprite.alpha = 0,
                                this._upgradeAnimation.skeleton.findSlot("building_repair_txt").currentSprite.alpha = 0,
                                this._upgradeAnimation.state.setAnimation(0, C.BUILDING_APPEAR, !1),
                                this._upgradeAnimation.y = e,
                                lr.gsap.to(this._explanation, {
                                    alpha: 0,
                                    duration: .1
                                }),
                                lr.gsap.to(this._title, {
                                    alpha: 0,
                                    duration: .1
                                }),
                                t.play("pop"),
                                t.onCustomEvent.addListener((function(e) {
                                    "confetti_appear" === e.event && (i._updateHeaderText(),
                                    i._updateExplanationText())
                                }
                                ), this),
                                this._upgradeAnimation.state.addListener({
                                    event: function(e, t) {
                                        "light_beam_appear" === t.data.name && (i._genericFadeAnimation.play("fadeIn"),
                                        i._beamsAnimation.state.setAnimation(0, k.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP, !0))
                                    }
                                }),
                                this._tapToContinueText.scale.set(0),
                                this._tapToContinueAnimation = new ur(U_),
                                this._tapToContinueAnimation.setTargets({
                                    continueText: this._tapToContinueText
                                }),
                                [4, r.TimeDelay.after(3e3).promise];
                            case 1:
                                return n.sent(),
                                this._tapToContinueAnimation.play("appear"),
                                this._tapToContinueAnimation.onEnd.listenOnce((function(e) {
                                    i._canClose = !0,
                                    "appear" === e && i._tapToContinueAnimation.play("loop")
                                }
                                ), this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr), $f = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.itemGradeUpgraded = new r.Event,
                    t.onUpgradeCardIntroClosed = new r.Event,
                    t._model = new Hv,
                    t._cellWithCard = {
                        column: 0,
                        row: 0
                    },
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "model", {
                    get: function() {
                        return this._model
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.upgradeItemGrade = function(e, t) {
                    t <= this._model.getItemTier(e) ? this._logger.error("not a valid upgrade card value") : (this._model.setItemTier(e, t),
                    this.itemGradeUpgraded.fire(e),
                    this._replaceUsedUpgradeCardWithUpgradedItem(),
                    3 === t && this._putNotUsedUpgradeCardsForSale(e))
                }
                ,
                t.prototype.onUpgradeCardClicked = function(e, t) {
                    var i, n = e.getBehavior(Ke.UpgradeCard);
                    if (!ve(n.targetObjectTreeIngredient)) {
                        var r = null === (i = De.services.blueprintGraphService.getNodeFromBlueprintID(e.getBlueprintID())) || void 0 === i ? void 0 : i.tier;
                        ve(r) || (this._cellWithCard = t,
                        this._openUpgradeCardPopup(n.targetObjectTreeIngredient, r))
                    }
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._replaceUsedUpgradeCardWithUpgradedItem = function() {
                    var e, t, i, n, r = this._getCell(), o = r.column, a = r.row, s = this.services.mapGrid.getCell(o, a);
                    if (s) {
                        var _ = null === (e = s.content) || void 0 === e ? void 0 : e.getBehavior(Ke.UpgradeCard);
                        if (!ve(_.targetObjectTreeIngredient)) {
                            null === (t = s.content) || void 0 === t || t.addBehavior(new ti({}));
                            var c = null === (n = null === (i = De.services.blueprintGraphService.getNodeFromBlueprintID(_.targetObjectTreeIngredient)) || void 0 === i ? void 0 : i.previous) || void 0 === n ? void 0 : n.ID;
                            if (!ve(c))
                                if (De.services.blueprintCollection.hasBlueprint(c)) {
                                    var l = De.services.gameObjectFactory.createById(c);
                                    l.addBehavior(new Rt({
                                        column: o,
                                        row: a
                                    })),
                                    this.services.world.addGameObject(l),
                                    s.content = l
                                } else
                                    this._logger.error("not a valid blueprint id")
                        }
                    } else
                        this._logger.error("not a valid position")
                }
                ,
                t.prototype._putNotUsedUpgradeCardsForSale = function(e) {
                    this.services.world.getAllGameObjects().filter((function(t) {
                        if (t.hasBehavior(Ke.UpgradeCard))
                            return t.getBehavior(Ke.UpgradeCard).targetObjectTreeIngredient === e
                    }
                    )).forEach((function(e) {
                        var t = e.getBehavior(Ke.UpgradeCard);
                        e.addBehavior(new jt({
                            loot: t.sellForLoot
                        }))
                    }
                    ))
                }
                ,
                t.prototype._openUpgradeCardPopup = function(e, t) {
                    var i = this
                      , n = {
                        targetObject: e,
                        currentTier: this._model.getItemTier(e),
                        value: t,
                        onUpgrade: function() {
                            return i.upgradeItemGrade(e, t)
                        }
                    };
                    this._logger.info("Opening upgrade card popup for ".concat(e)),
                    De.services.lazyLoad.prioritizeGroup(hn.UPGRADE_CARD_OVERLAY).then((function() {
                        De.services.navigation.showPopup(Zf, n)
                    }
                    ))
                }
                ,
                t.prototype._getCell = function() {
                    return this._cellWithCard
                }
                ,
                t
            }(Go), eE = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.worldView = new Xe.Container,
                    t.cameraView = new Xe.Container,
                    t._cameraLimits = {
                        minX: 0,
                        maxX: 0,
                        minY: 0,
                        maxY: 0
                    },
                    t._isCameraBlocked = !1,
                    t._flickSpeed = 0,
                    t._elapsedZoom = 0,
                    t._pinchData = {
                        originalDistance: 0,
                        originalZoom: 1
                    },
                    t._config = {
                        FACTOR_DEACCELERATION: .1,
                        ZOOM_MIN: .5,
                        ZOOM_MAX: 1.5,
                        ZOOM_DEFAULT: 1,
                        ZOOM_ANIMATION_DURATION_DEFAULT: 1,
                        SCROLL_SENSITIVITY: .001,
                        EDGE_PAN_DELAY: 500,
                        PAN_ACCELERATION_SENSITIVITY: .5,
                        PAN_MAX_SPEED: 50,
                        ANIMATE_MIN_DURATION: .1,
                        ANIMATE_PIXELS_PER_SECOND: 800,
                        ANIMATE_EASE: "sine.inOut",
                        MINIMUM_ANIMATE_DISTANCE: 275
                    },
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.addViewToParent = function(e) {
                    e.addChild(this.cameraView)
                }
                ,
                t.prototype.getScreenBounds = function() {
                    return new Xe.Rectangle(0,0,De.services.canvas.width,De.services.canvas.height)
                }
                ,
                t.prototype.getCameraBounds = function() {
                    var e = this.getCameraCorners()
                      , t = e.topLeft
                      , i = e.bottomRight;
                    return new Xe.Rectangle(t.x,t.y,i.x - t.x,i.y - t.y)
                }
                ,
                t.prototype.getCameraMaxBounds = function() {
                    return this._originalCameraLimits
                }
                ,
                t.prototype.getCameraCorners = function() {
                    var e = this.getCameraPosition()
                      , t = this.getCameraScale()
                      , i = {
                        topLeft: De.services.canvas.topLeft,
                        topRight: De.services.canvas.topRight,
                        bottomRight: De.services.canvas.bottomRight,
                        bottomLeft: De.services.canvas.bottomLeft
                    };
                    return Object.values(i).forEach((function(i) {
                        i.x += e.x,
                        i.y += e.y,
                        i.x /= t.x,
                        i.y /= t.y
                    }
                    )),
                    i
                }
                ,
                t.prototype.getScreenToWorldPosition = function(e) {
                    var t = this.getCameraPosition();
                    return new Xe.Point((t.x + e.x) / this.worldView.scale.x,(t.y + e.y) / this.worldView.scale.y)
                }
                ,
                t.prototype.getWorldToScreenPosition = function(e) {
                    var t = this.getCameraPosition();
                    return new Xe.Point(e.x * this.worldView.scale.x - t.x,e.y * this.worldView.scale.y - t.y)
                }
                ,
                t.prototype.getCameraFocusPosition = function() {
                    return new Xe.Point(this.worldView.position.x,this.worldView.position.y)
                }
                ,
                t.prototype.getCameraPosition = function() {
                    return new Xe.Point(-this.worldView.position.x,-this.worldView.position.y)
                }
                ,
                t.prototype.getCameraScale = function() {
                    return new Xe.Point(this.worldView.scale.x,this.worldView.scale.y)
                }
                ,
                t.prototype.moveBy = function(e) {
                    this._processCommand(this._moveBy, [e])
                }
                ,
                t.prototype.resize = function() {
                    var e = De.services.canvas.right
                      , t = De.services.canvas.bottom
                      , i = new Xe.Rectangle(-e,-t,2 * De.services.canvas.right,2 * De.services.canvas.bottom);
                    this.cameraView.hitArea = i,
                    this._updateZoom(!0)
                }
                ,
                t.prototype.teleportCameraToCell = function(e) {
                    var t = this.services.axonometricProjection.getWorldPosition(e.column, e.row);
                    t.x = -t.x,
                    t.y = -t.y,
                    this._processCommand(this._teleportCamera, [t])
                }
                ,
                t.prototype.teleportCameraToPosition = function(e) {
                    this._processCommand(this._teleportCamera, [new Xe.Point(-e.x,-e.y)])
                }
                ,
                t.prototype.animateCameraToCell = function(e, t, i, n) {
                    void 0 === t && (t = 0),
                    void 0 === i && (i = !1),
                    void 0 === n && (n = this._config.MINIMUM_ANIMATE_DISTANCE);
                    var r = this.services.axonometricProjection.getWorldPosition(e.column, e.row);
                    return r.x = -r.x,
                    r.y = -r.y,
                    this._processAsyncCommand(this._animateCameraTo, [r, t, n], i)
                }
                ,
                t.prototype.animateCameraToCellPosition = function(e, t, i, n) {
                    void 0 === t && (t = 0),
                    void 0 === i && (i = !1),
                    void 0 === n && (n = this._config.MINIMUM_ANIMATE_DISTANCE);
                    var r = this.services.axonometricProjection.getWorldPosition(e.column, e.row);
                    return r.x = -r.x,
                    r.y = -r.y,
                    this._processAsyncCommand(this._animateCameraTo, [r, t, n], i)
                }
                ,
                t.prototype.animateCameraZoom = function(e, t) {
                    return void 0 === t && (t = 0),
                    e = r.NumberUtility.clamp(this._config.ZOOM_MIN, e, this._config.ZOOM_MAX),
                    this._processAsyncCommand(this._animateCameraZoomTo, [e, t])
                }
                ,
                t.prototype.animateCameraZoomAndMoveToCell = function(e, t, i, n) {
                    void 0 === i && (i = 0),
                    void 0 === n && (n = !1),
                    e = r.NumberUtility.clamp(this._config.ZOOM_MIN, e, this._config.ZOOM_MAX);
                    var o = this.services.axonometricProjection.getWorldPosition(t.column, t.row);
                    return o.x = -o.x,
                    o.y = -o.y,
                    this._processAsyncCommand(this._animateCameraZoomToPosition, [e, o, i], n)
                }
                ,
                t.prototype.update = function(e) {
                    this._isCameraBlocked || (this._flickSpeed > 0 && this._flickDirection && (this._flickSpeed -= e * this._config.FACTOR_DEACCELERATION,
                    this.moveBy(new Xe.Point(this._flickDirection.x * this._flickSpeed,this._flickDirection.y * this._flickSpeed))),
                    this._updateZoom())
                }
                ,
                Object.defineProperty(t.prototype, "zoom", {
                    get: function() {
                        return this.worldView.scale.x
                    },
                    set: function(e) {
                        var t = this.worldView.position.x / this.worldView.scale.x
                          , i = this.worldView.position.y / this.worldView.scale.y;
                        this.worldView.scale.set(e, e),
                        this.worldView.position.x = t * e,
                        this.worldView.position.y = i * e,
                        this._updateCameraLimits(e)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.disable = function() {
                    this._isCameraBlocked = !0
                }
                ,
                t.prototype.enable = function() {
                    this._isCameraBlocked = !1
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons(_e.CAMERA_CONFIG)];
                            case 1:
                                return t.sent(),
                                e = De.services.resource.getJson(_e.CAMERA_CONFIG),
                                r.ObjectUtility.deepMerge(this._config, e),
                                this._originalCameraLimits = this._getCameraLimitsFromPolygon(),
                                this.zoom = this._config.ZOOM_DEFAULT,
                                this._elapsedZoom = this.zoom,
                                this.services.interactionService.onScroll.addListener(this._onScroll, this),
                                this.services.interactionService.onPinchStart.addListener(this._onPinchStart, this),
                                this.services.interactionService.onPinchUpdate.addListener(this._onPinchUpdate, this),
                                this.services.interactionService.onPan.addListener(this._onPan, this),
                                this.services.interactionService.onGestureFlick.addListener(this._onFlick, this),
                                v.EventManager.resizeScreen.addListener(this.resize, this),
                                this.cameraView.interactive = !0,
                                this.cameraView.addChild(this.worldView),
                                this.teleportCameraToPosition(this._getCameraInitialPosition()),
                                this.resize(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    v.GroupsCore.Updateables.add(this)
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.interactionService.onScroll.removeListener(this._onScroll, this),
                            this.services.interactionService.onPan.removeListener(this._onPan, this),
                            this.services.interactionService.onGestureFlick.removeListener(this._onFlick, this),
                            v.GroupsCore.Updateables.remove(this),
                            v.EventManager.resizeScreen.removeListener(this.resize, this),
                            this.worldView.removeAllListeners(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateCameraLimits = function(e) {
                    var t = this.getCameraBounds();
                    this._cameraLimits.minX = (this._originalCameraLimits.minX + t.width / 2) * e,
                    this._cameraLimits.maxX = (this._originalCameraLimits.maxX - t.width / 2) * e,
                    this._cameraLimits.minY = (this._originalCameraLimits.minY + t.height / 2) * e,
                    this._cameraLimits.maxY = (this._originalCameraLimits.maxY - t.height / 2) * e
                }
                ,
                t.prototype._updateZoom = function(e) {
                    if (void 0 === e && (e = !1),
                    this._elapsedZoom !== this.zoom || e) {
                        var t = Math.max(this._config.ZOOM_MIN, De.services.canvas.width / (this._originalCameraLimits.maxX - this._originalCameraLimits.minX));
                        this._elapsedZoom = r.NumberUtility.clamp(t, this._elapsedZoom, this._config.ZOOM_MAX),
                        this.zoom = this._elapsedZoom,
                        this._clampCamera()
                    }
                }
                ,
                t.prototype._onPan = function(e) {
                    this._processCommand(this.moveBy, [new Xe.Point(e.deltaPosition.x,e.deltaPosition.y)])
                }
                ,
                t.prototype._onFlick = function(e) {
                    this._isCameraBlocked || (e.isCancelled ? this._flickSpeed = 0 : (this._flickSpeed = Math.sqrt(Math.pow(e.deltaPosition.x, 2) + Math.pow(e.deltaPosition.y, 2)),
                    this._flickDirection = new Xe.Point(e.deltaPosition.x / this._flickSpeed,e.deltaPosition.y / this._flickSpeed)))
                }
                ,
                t.prototype._onScroll = function(e) {
                    var t = this;
                    De.services.navigation.isAnyPopupOpen() || this._cameraZoomToPositionAnimation || this._processCommand((function(e) {
                        return t._elapsedZoom += e.delta * t._config.SCROLL_SENSITIVITY
                    }
                    ), [e])
                }
                ,
                t.prototype._onPinchStart = function(e) {
                    this._pinchData.originalDistance = v.Vector2.substract(e.firstPosition, e.secondPosition).length(),
                    this._pinchData.originalZoom = this.zoom
                }
                ,
                t.prototype._onPinchUpdate = function(e) {
                    var t = this
                      , i = v.Vector2.substract(e.firstPosition, e.secondPosition).length() / this._pinchData.originalDistance;
                    Number.isNaN(i) || this._processCommand((function() {
                        return t._elapsedZoom = i * t._pinchData.originalZoom
                    }
                    ), [])
                }
                ,
                t.prototype._teleportCamera = function(e) {
                    var t = this.getCameraScale();
                    e.x *= t.x,
                    e.y *= t.y,
                    this.worldView.position.x = e.x,
                    this.worldView.position.y = e.y,
                    this._clampCamera()
                }
                ,
                t.prototype._animateCameraTo = function(e, t, i) {
                    return void 0 === t && (t = 0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r, o, a, s;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._flickSpeed = 0,
                                r = this.getCameraFocusPosition(),
                                o = this.getCameraScale(),
                                e.x *= o.x,
                                e.y *= o.y,
                                a = this._getSafeZoneCameraPosition(e),
                                v.Vector2.substract(a, r).length() <= i ? [2, Promise.resolve()] : (0 === t && (s = v.Vector2.substract(a, r).length(),
                                t = this._config.ANIMATE_MIN_DURATION + s / this._config.ANIMATE_PIXELS_PER_SECOND),
                                this._cameraAnimationSetup(r, a, o, t),
                                this._cameraAnimation ? [4, this._cameraAnimation.play()] : [3, 2]);
                            case 1:
                                return n.sent(),
                                [3, 3];
                            case 2:
                                return [2, Promise.reject()];
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._animateCameraZoomTo = function(e, t) {
                    return void 0 === t && (t = 0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return t = 0 === t ? this._config.ZOOM_ANIMATION_DURATION_DEFAULT : t,
                                this._cameraZoomAnimationSetup(e, t),
                                this._cameraZoomAnimation ? [4, this._cameraZoomAnimation.play()] : [3, 2];
                            case 1:
                                return i.sent(),
                                [3, 3];
                            case 2:
                                return [2, Promise.reject()];
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getSafeZoneCameraPosition = function(e) {
                    var t = new Xe.Point;
                    return t.x = r.NumberUtility.clamp(this._cameraLimits.minX, e.x, this._cameraLimits.maxX),
                    t.y = r.NumberUtility.clamp(this._cameraLimits.minY, e.y, this._cameraLimits.maxY),
                    t
                }
                ,
                t.prototype._moveBy = function(e) {
                    this.worldView.position.set(this.worldView.position.x + e.x, this.worldView.position.y + e.y),
                    this._clampCamera()
                }
                ,
                t.prototype._clampCamera = function() {
                    var e = this._getSafeZoneCameraPosition(this.worldView.position);
                    this.worldView.position.x = e.x,
                    this.worldView.position.y = e.y
                }
                ,
                t.prototype._processCommand = function(e, t) {
                    this._isCameraBlocked || e.apply(this, t)
                }
                ,
                t.prototype._processAsyncCommand = function(e, t, i) {
                    return void 0 === i && (i = !1),
                    this._isCameraBlocked && !i ? Promise.resolve() : e.apply(this, t)
                }
                ,
                t.prototype._getCameraLimitsFromPolygon = function() {
                    var e = this
                      , t = this.services.tiledMap.getCameraPolygonBounds().map((function(t) {
                        var i = e.services.axonometricProjection.getEditorRemappedPosition(t);
                        return e.services.axonometricProjection.projection.projectIntoPlane(i)
                    }
                    ))
                      , i = []
                      , n = [];
                    return t.forEach((function(e) {
                        var t = e.x
                          , r = e.y;
                        i.push(-1 * t),
                        n.push(-1 * r)
                    }
                    )),
                    {
                        minX: Math.min.apply(Math, i),
                        maxX: Math.max.apply(Math, i),
                        minY: Math.min.apply(Math, n),
                        maxY: Math.max.apply(Math, n)
                    }
                }
                ,
                t.prototype._getCameraInitialPosition = function() {
                    var e = this.services.tiledMap.getFirstMarker()
                      , t = this.services.axonometricProjection.getEditorRemappedPosition(e.position);
                    return this.services.axonometricProjection.projection.projectIntoPlane(t)
                }
                ,
                t.prototype._animateCameraZoomToPosition = function(e, t, i) {
                    return void 0 === i && (i = 0),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r, o, a, s = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._cameraZoomToPositionAnimation && (this._cameraZoomToPositionAnimation.kill(),
                                this._cameraZoomToPositionAnimation = void 0),
                                this._flickSpeed = 0,
                                r = this.getCameraFocusPosition(),
                                o = this.getCameraScale(),
                                t.x *= o.x,
                                t.y *= o.y,
                                0 === i && (a = v.Vector2.substract(t, r).length(),
                                i = this._config.ANIMATE_MIN_DURATION + a / this._config.ANIMATE_PIXELS_PER_SECOND),
                                this._cameraAnimationSetup(r, t, o, i),
                                this._cameraZoomAnimationSetup(e, i),
                                this._cameraAnimation && this._cameraZoomAnimation ? (this._cameraZoomToPositionAnimation = lr.gsap.timeline({
                                    onComplete: function() {
                                        s._cameraZoomToPositionAnimation && (s._cameraZoomToPositionAnimation.kill(),
                                        s._cameraZoomToPositionAnimation = void 0)
                                    }
                                }),
                                this._cameraZoomToPositionAnimation.add([this._cameraZoomAnimation, this._cameraAnimation]),
                                [4, this._cameraZoomToPositionAnimation.play()]) : [3, 2];
                            case 1:
                                return n.sent(),
                                [3, 3];
                            case 2:
                                return [2, Promise.reject()];
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._cameraAnimationSetup = function(e, t, i, n) {
                    var r = this;
                    void 0 === n && (n = 0),
                    this._cameraAnimation && (this._cameraAnimation.kill(),
                    this._cameraAnimation = void 0),
                    this._cameraAnimation = lr.gsap.timeline({
                        onUpdate: function() {
                            r.worldView.position.x = e.x / i.x * r.worldView.scale.x,
                            r.worldView.position.y = e.y / i.y * r.worldView.scale.y,
                            r._clampCamera()
                        }
                    }),
                    this._cameraAnimation.to(e, {
                        x: t.x,
                        y: t.y,
                        duration: n,
                        ease: this._config.ANIMATE_EASE
                    }),
                    this._cameraAnimation.eventCallback("onComplete", (function() {
                        r._cameraAnimation && r._cameraAnimation.kill(),
                        r._cameraAnimation = void 0
                    }
                    ))
                }
                ,
                t.prototype._cameraZoomAnimationSetup = function(e, t) {
                    var i = this;
                    void 0 === t && (t = 0),
                    this._cameraZoomAnimation && (this._cameraZoomAnimation.kill(),
                    this._cameraZoomAnimation = void 0),
                    this._cameraZoomAnimation = lr.gsap.timeline({
                        onUpdate: function() {
                            i._updateZoom()
                        },
                        onComplete: function() {
                            i._cameraZoomAnimation && (i._cameraZoomAnimation.kill(),
                            i._cameraZoomAnimation = void 0)
                        }
                    }),
                    this._cameraZoomAnimation.to(this, {
                        _elapsedZoom: e,
                        duration: t,
                        ease: this._config.ANIMATE_EASE
                    })
                }
                ,
                t
            }(Go), tE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._view = new Zo,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.addViewToParent = function(e) {
                    e.addChild(this._view)
                }
                ,
                t.prototype.getLayer = function(e) {
                    return this._view.layers[e]
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._view.initialize(this.services),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), iE = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n.defaultAnchor = {
                        x: .5,
                        y: 0
                    },
                    n._editorFactor = 1,
                    n.tileSize = {
                        width: t,
                        height: i
                    },
                    n._tileProjectionDiagonal = n._calculateProjectionDiagonal(t, i),
                    n.projection = new r.AxonometricProjection({
                        rotation: n._calculateProjectionAngleRotation(t, i)
                    }),
                    n._editorFactor = n._tileProjectionDiagonal / i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getEditorRemappedPosition = function(e) {
                    var t = (new Xe.Point).copyFrom(e);
                    return t.x *= this._editorFactor,
                    t.y *= this._editorFactor,
                    t
                }
                ,
                t.prototype.getWorldPosition = function(e, t) {
                    var i = this.projection.projectIntoPlane({
                        x: e * this._tileProjectionDiagonal,
                        y: t * this._tileProjectionDiagonal
                    });
                    return new Xe.Point(i.x,i.y)
                }
                ,
                t.prototype.getProjectedIndices = function(e) {
                    var t = this.projection.reverseProjectFromPlane(e);
                    return {
                        column: Math.floor(t.x / this._tileProjectionDiagonal),
                        row: Math.floor(t.y / this._tileProjectionDiagonal)
                    }
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._calculateProjectionDiagonal = function(e, t) {
                    return Math.floor(Math.sqrt(Math.pow(e, 2) + Math.pow(t, 2)) / 2) + -2
                }
                ,
                t.prototype._calculateProjectionAngleRotation = function(e, t) {
                    var i = Math.atan(t / e);
                    return new Xe.Point(i,.5 * Math.PI - i)
                }
                ,
                t
            }(Go), nE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.simulateClick = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return Promise.resolve()
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return Promise.resolve()
                }
                ,
                t
            }(Go), rE = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._version = 1,
                    i._areaData = new Map,
                    i._name = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            for (t in e)
                                this._areaData.set(t, e[t]);
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.setMapAreaState = function(e, t) {
                    this._areaData.set(e, t),
                    this.saveData()
                }
                ,
                t.prototype.getMapAreaState = function(e) {
                    return this._areaData.get(e)
                }
                ,
                t.prototype.onDataSave = function() {
                    var e = {};
                    return this._areaData.forEach((function(t, i) {
                        e[i] = t
                    }
                    )),
                    e
                }
                ,
                t
            }($n), oE = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.onAreaStateChange = new r.Event,
                    i._areaDescriptionMapData = new Map,
                    i._isAllowedToBuy = De.services.navigation.currentSceneIndex === wr.MAIN,
                    i._mapAreaModel = new rE(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.canUnlockArea = function(e) {
                    if (e.state !== Cc.UNLOCKED) {
                        var t = e.requirements.buy;
                        return De.services.inventory.hasEnoughItems(t)
                    }
                    return !1
                }
                ,
                t.prototype.unlockArea = function(e) {
                    if (e.state !== Cc.UNLOCKED) {
                        var t = e.requirements.buy;
                        De.services.inventory.deductItems(t),
                        this._setAreaState(e, Cc.UNLOCKED),
                        De.services.audio.playSoundEffect(m.EXPANSION_SUCCESFUL),
                        De.services.actions.emit("unlockArea.".concat(e.id))
                    }
                }
                ,
                t.prototype.getMapAreaThatHasCell = function(e) {
                    var t = ql(e.column, e.row);
                    return this.getMapAreas().find((function(e) {
                        return e.cellsHashes.has(t)
                    }
                    ))
                }
                ,
                t.prototype.getMapAreas = function() {
                    return Array.from(this._areaDescriptionMapData.values())
                }
                ,
                t.prototype.getMapArea = function(e) {
                    return this._areaDescriptionMapData.get(e)
                }
                ,
                t.prototype.getMapAreasByState = function(e) {
                    var t = [];
                    return this._areaDescriptionMapData.forEach((function(i) {
                        i.state === e && t.push(i)
                    }
                    )),
                    t
                }
                ,
                t.prototype.getAreaMarker = function(e) {
                    return this.services.tiledMap.getMarker(e)
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return De.services.tasks.requestAreaToUnlock.addListener(this._tryFillTaskRequest, this),
                                [4, Promise.all([De.services.autosave.registerModel(this._mapAreaModel)])];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.unregisterModel(this._mapAreaModel),
                            De.services.tasks.requestAreaToUnlock.removeListener(this._tryFillTaskRequest, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getSavedTileData = function(e) {
                    var t = ql(e);
                    return this.services.mapGrid.tiles.get(t)
                }
                ,
                t.prototype._getStaticTileData = function(e) {
                    var t = {
                        state: null
                    }
                      , i = this.services.tiledMap.getTileDataAt(Wo.main, e.column, e.row);
                    return i && i.blueprint && (t.state = {
                        blueprint: i.blueprint,
                        uniqueObject: i.uniqueObject,
                        data: i.blueprintOverrides
                    }),
                    t
                }
                ,
                t.prototype._setAreaState = function(e, t) {
                    e.previousState = e.state,
                    e.state = t,
                    t === Cc.UNLOCKED && this._unlockArea(e),
                    this.onAreaStateChange.fire({
                        area: e
                    }),
                    this._mapAreaModel.setMapAreaState(e.id.toString(), t)
                }
                ,
                t.prototype._createAllGridAreas = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return e = new Map,
                                this._areaDescriptionMapData.forEach((function(i) {
                                    i.state === Cc.UNLOCKED ? t._populateUnlockedArea(i, e) : t._populateLockedArea(i)
                                }
                                )),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return i.sent(),
                                this._handleMissingUniqueObjects(e),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._populateUnlockedArea = function(e, t) {
                    var i = this;
                    e.cells.forEach((function(e) {
                        var n = e.column
                          , r = e.row
                          , o = i._getStaticTileData({
                            column: n,
                            row: r
                        })
                          , a = i._getSavedTileData({
                            column: n,
                            row: r
                        });
                        null !== o.state && o.state.uniqueObject && t.set(o.state.blueprint, {
                            originalPosition: {
                                column: n,
                                row: r
                            },
                            tileData: o
                        }),
                        a || (a = o),
                        i._populateCell({
                            column: n,
                            row: r
                        }, a)
                    }
                    ))
                }
                ,
                t.prototype._calculateAreaState = function(e, t, i) {
                    var n, r, o = De.services.inventory.getAmount(An.LEVEL), a = De.services.inventory.getAmount(Cn.COINS), s = null === (n = t.find((function(e) {
                        return e.key === An.LEVEL
                    }
                    ))) || void 0 === n ? void 0 : n.amount, _ = null === (r = t.find((function(e) {
                        return e.key === Cn.COINS
                    }
                    ))) || void 0 === r ? void 0 : r.amount, c = !1;
                    if (i) {
                        var l = this.getMapArea(i);
                        c = (null == l ? void 0 : l.state) === Cc.UNLOCKED
                    } else
                        c = !0;
                    if (!s || !_)
                        return "A1" === e ? Cc.UNLOCKED : Cc.LOCK;
                    switch (!0) {
                    case o < s || !c:
                        return Cc.LOCK;
                    case o >= s && a >= _:
                        return Cc.UNLOCKABLE;
                    case o >= s && a < _:
                        return Cc.BUY;
                    default:
                        return Cc.LOCK
                    }
                }
                ,
                t.prototype._handleMissingUniqueObjects = function(e) {
                    var t = this
                      , i = new Map;
                    e.forEach((function(e, n) {
                        0 !== t.services.gridFilter.getBlueprintCount(n) || t.services.storage.isStored(n) || 0 !== t.services.storageBubble.getBubblesWithBlueprints([n]).length || i.set(e.originalPosition, e.tileData)
                    }
                    ));
                    var n = [];
                    i.forEach((function(i, r) {
                        t._restoreContent(i, r, e, n)
                    }
                    )),
                    n.length > 0 && this.services.storageBubble.createBubbleAndShowContent(n)
                }
                ,
                t.prototype._restoreContent = function(e, t, i, n) {
                    var r, o = this;
                    if (null === (r = e.state) || void 0 === r ? void 0 : r.blueprint) {
                        var a = De.services.blueprintCollection.getBlueprint(e.state.blueprint)
                          , s = []
                          , _ = this.services.mapGrid.getContent(t.column, t.row);
                        this._checkOccupyingContent(_, s);
                        var c = a.components.extendedTile || {};
                        if (c.width && c.height)
                            for (var l = 0; l < c.width; l++)
                                for (var u = 0; u < c.width; u++)
                                    if (0 !== l || 0 !== u) {
                                        var d = this.services.mapGrid.getContent(t.column - l, t.row - u);
                                        this._checkOccupyingContent(d, s)
                                    }
                        s.forEach((function(e) {
                            if (e.hasBehavior(Ke.ExtendedTile)) {
                                var t = i.get(e.getBlueprintID());
                                t ? (o.services.world.removeGameObject(e),
                                o._restoreContent(t.tileData, t.originalPosition, i, n)) : o._logger.error("Cannot restore ".concat(e.getBlueprintID(), " as it isn't added to the uniqueObjectData map"))
                            } else {
                                var r = e.getBlueprintID()
                                  , a = De.services.blueprintCollection.getBlueprint(r).components
                                  , s = e.serialize(a);
                                n.push(s),
                                o.services.world.removeGameObject(e)
                            }
                        }
                        )),
                        this._populateCell(t, e)
                    }
                }
                ,
                t.prototype._checkOccupyingContent = function(e, t) {
                    if (e) {
                        if (e.hasBehavior(Ke.ExtendedTileChild)) {
                            var i = e.getBehavior(Ke.ExtendedTileChild);
                            i && i.parentTile && (e = i.parentTile)
                        }
                        -1 === t.indexOf(e) && t.push(e)
                    }
                }
                ,
                t.prototype._populateCell = function(e, t) {
                    var i = e.column
                      , n = e.row;
                    if (this.services.mapGrid.addCell(i, n),
                    t.state && De.services.blueprintCollection.hasBlueprint(t.state.blueprint)) {
                        var r = De.services.gameObjectFactory.restoreFromBlueprint(t.state);
                        r.addBehavior(new Rt({
                            column: i,
                            row: n
                        })),
                        this.services.world.addGameObject(r)
                    }
                    this.services.mapGrid.connectCellToNeighbours(i, n)
                }
                ,
                t.prototype._unlockArea = function(e) {
                    var t = this;
                    e.cells.sort((function(e, t) {
                        return t.column - e.column
                    }
                    ));
                    var i = e.cells[e.cells.length - 1].column;
                    e.cells.forEach((function(e) {
                        var n = e.column
                          , r = e.row
                          , o = t.services.mapGrid.getCell(n, r)
                          , a = n - i;
                        o && o.content && (o.content.addBehavior(new Ze({
                            column: a
                        })),
                        o.content.addBehavior(new ti({})))
                    }
                    ));
                    var n = [];
                    e.cells.forEach((function(e) {
                        var i = e.column
                          , r = e.row
                          , o = t._getStaticTileData({
                            column: i,
                            row: r
                        })
                          , a = o.state ? De.services.gameObjectFactory.restoreFromBlueprint(o.state) : null;
                        t.services.mapGrid.setCellAsSerializable(i, r),
                        a && n.push({
                            position: {
                                column: i,
                                row: r
                            },
                            content: a
                        })
                    }
                    )),
                    n.forEach((function(e) {
                        var n = e.position
                          , r = e.content;
                        r.addBehavior(new Rt(n)),
                        r.addBehavior(new $e({
                            column: n.column - i
                        })),
                        r.addBehavior(new Hi),
                        t.services.world.addGameObject(r)
                    }
                    ))
                }
                ,
                t.prototype._tryFillTaskRequest = function(e) {
                    var t = this.getMapAreasByState(Cc.BUY);
                    0 !== t.length && (e.id = t[t.length - 1].id)
                }
                ,
                t
            }(Go), aE = function(e) {
                function t() {
                    var t = e.call(this, "MapAreaModel") || this;
                    return t._inventoryItemsToTrack = new Set,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, e.prototype.onInitialize.call(this)];
                            case 1:
                                return t.sent(),
                                [4, Promise.all([De.services.assetLoader.loadJsons(_e.MAP_AREAS)])];
                            case 2:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    var e = this;
                    this._populateAreaInfo(),
                    this._inventoryItemsToTrack.forEach((function(t) {
                        De.services.inventory.getInventoryItem(t).onChanged.addListener(e._checkForAreaStates, e)
                    }
                    )),
                    De.services.actions.on("unlockArea.*", this._checkForAreaStates, this),
                    this._createAllGridAreas(),
                    this._checkForAreaStates()
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return e.prototype.onDestroy.call(this),
                            this._inventoryItemsToTrack.forEach((function(e) {
                                De.services.inventory.getInventoryItem(e).onChanged.removeListener(t._checkForAreaStates, t)
                            }
                            )),
                            De.services.actions.off("unlockArea.*", this._checkForAreaStates, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._populateLockedArea = function(e) {
                    var t = this;
                    e.cells.forEach((function(i) {
                        var n = i.column
                          , o = i.row
                          , a = De.services.gameObjectFactory.createById("area_cloud");
                        t.services.mapGrid.addCell(n, o, !1),
                        a.addBehavior(new Rt({
                            column: n,
                            row: o
                        })),
                        t.services.world.addGameObject(a),
                        t.services.mapGrid.connectCellToNeighbours(n, o),
                        e.state === Cc.DISABLED && r.TimeDelay.nextFrame().then((function() {
                            a.getChildByName("mainsprite", !0).tint = 14737632
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._populateAreaInfo = function() {
                    var e = this.services.tiledMap.getLockedAreas()
                      , t = De.services.resource.getJson(_e.MAP_AREAS);
                    for (var i in e) {
                        var n = void 0 !== t[i]
                          , r = e[i].tiles
                          , o = new Set(r.map((function(e) {
                            return ql(e.column, e.row)
                        }
                        )))
                          , a = void 0
                          , s = void 0
                          , _ = void 0
                          , c = void 0
                          , l = void 0;
                        if (n) {
                            var u = t[i];
                            a = u.state,
                            s = u.areaId,
                            _ = u.buy,
                            c = u.previousAreaId,
                            (l = this._mapAreaModel.getMapAreaState(s)) !== Cc.UNLOCKED && (l = this._calculateAreaState(s, _, c)),
                            this._addItemsToTracker(_)
                        } else
                            a = Cc.DISABLED,
                            s = i,
                            _ = [];
                        this._areaDescriptionMapData.set(s, {
                            id: s,
                            cells: r,
                            cellsHashes: o,
                            state: ve(l) ? a : l,
                            previousState: ve(l) ? a : l,
                            requirements: {
                                buy: _,
                                previousAreaId: c
                            }
                        })
                    }
                }
                ,
                t.prototype._checkForAreaStates = function() {
                    var e = this;
                    if (this._isAllowedToBuy) {
                        var t = 0;
                        this._areaDescriptionMapData.forEach((function(i) {
                            if (i.state !== Cc.UNLOCKED) {
                                if (i.state !== Cc.DISABLED) {
                                    var n = e._calculateAreaState(i.id, i.requirements.buy, i.requirements.previousAreaId);
                                    e._setAreaState(i, n)
                                }
                            } else
                                t++
                        }
                        )),
                        this._checkForUnlockedAreaDiscrepancies(t)
                    }
                }
                ,
                t.prototype._checkForUnlockedAreaDiscrepancies = function(e) {
                    var t = De.services.inventory.getAmount(An.LEVEL);
                    (t > 10 && e < 5 || t > e + 10) && (this._logger.error("big difference between player level and unlocked area count detected!"),
                    De.services.analytics.reportDesignEvent(["issue", "areaUnlockDifference", "".concat(t - e)]))
                }
                ,
                t.prototype._addItemsToTracker = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        var i = e.key;
                        return t._inventoryItemsToTrack.add(i)
                    }
                    ))
                }
                ,
                t
            }(oE), sE = (i(6206),
            i(2213)), _E = function(e) {
                function t() {
                    var t = e.call(this, "PremiumAreaModel") || this;
                    return t._useHeavenSprites = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "useHeavenSprites", {
                    get: function() {
                        return this._useHeavenSprites
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.toggleHeavenSprites = function() {
                    var e = this;
                    this._useHeavenSprites = !this._useHeavenSprites,
                    this._areaDescriptionMapData.forEach((function(t) {
                        t.cells.forEach((function(t) {
                            var i = t.column
                              , n = t.row
                              , r = e._getStaticTileData({
                                column: i,
                                row: n
                            })
                              , o = r.state ? De.services.gameObjectFactory.restoreFromBlueprint(r.state) : null
                              , a = e.services.mapGrid.getCell(i, n).content;
                            o && e._addPremiumAreaObject(a, o)
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, e.prototype.onInitialize.call(this)];
                            case 1:
                                return t.sent(),
                                [4, Promise.all([De.services.assetLoader.loadJsons(_e.PREMIUM_AREAS)])];
                            case 2:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    this._populateAreaInfo(),
                    this._createAllGridAreas(),
                    this._checkForAreaStates()
                }
                ,
                t.prototype._populateLockedArea = function(e) {
                    var t = this;
                    e.cells.forEach((function(e) {
                        var i = e.column
                          , n = e.row
                          , r = t._getStaticTileData({
                            column: i,
                            row: n
                        })
                          , o = r.state ? De.services.gameObjectFactory.restoreFromBlueprint(r.state) : null
                          , a = De.services.gameObjectFactory.createById("premium_cloud");
                        t.services.mapGrid.addCell(i, n, !1),
                        a.addBehavior(new Rt({
                            column: i,
                            row: n
                        })),
                        t.services.world.addGameObject(a),
                        t.services.mapGrid.connectCellToNeighbours(i, n),
                        o && t._addPremiumAreaObject(a, o)
                    }
                    ))
                }
                ,
                t.prototype._populateAreaInfo = function() {
                    var e = this.services.tiledMap.getPremiumAreas()
                      , t = De.services.resource.getJson(_e.PREMIUM_AREAS);
                    for (var i in e) {
                        var n = t[i]
                          , r = n.state
                          , o = n.areaId
                          , a = n.buy
                          , s = e[i].tiles
                          , _ = new Set(s.map((function(e) {
                            return ql(e.column, e.row)
                        }
                        )))
                          , c = this._mapAreaModel.getMapAreaState(o);
                        this._areaDescriptionMapData.set(o, {
                            id: o,
                            cells: s,
                            cellsHashes: _,
                            state: ve(c) ? r : c,
                            previousState: ve(c) ? r : c,
                            requirements: {
                                buy: a
                            }
                        })
                    }
                }
                ,
                t.prototype._addPremiumAreaObject = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, o, a, s, _, c;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (i = e.getChildByName("premium_object")) && e.removeChild(i),
                                o = t.getBehavior(Ke.Sprite),
                                this.services.world.addGameObject(t),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return n.sent(),
                                a = t.getChildByName(Uv),
                                (s = a.getChildByName(Gv)).anchor.copyFrom(o.anchor),
                                s.position.set(o.offset.x, o.offset.y),
                                this._useHeavenSprites ? (_ = e.getChildByName(Uv),
                                (c = new sE.heaven.Sprite(s.texture)).color.setLight(.96078, .7372, .8823),
                                c.color.setDark(.8274, .3607, .9019),
                                c.anchor.copyFrom(o.anchor),
                                c.position.set(_.position.x + o.offset.x, _.position.y + o.offset.y - 20),
                                c.name = "premium_object",
                                e.addChild(c)) : (s.blendMode = sE.BLEND_MODES.OVERLAY,
                                s.alpha = .3,
                                e.addChild(s)),
                                this.services.world.removeGameObject(t),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._checkForAreaStates = function() {
                    var e = this;
                    this._isAllowedToBuy && this._areaDescriptionMapData.forEach((function(t) {
                        if (t.state !== Cc.UNLOCKED) {
                            var i = t.requirements.buy.find((function(e) {
                                return e.key === Cn.GEMS
                            }
                            ));
                            if (i) {
                                var n = De.services.inventory.hasEnoughItems([i])
                                  , r = t.state;
                                n ? r = Cc.UNLOCKABLE : n || (r = Cc.BUY),
                                e._setAreaState(t, r)
                            }
                        }
                    }
                    ))
                }
                ,
                t
            }(oE), cE = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._tileDataMap = new Map,
                    i._config = t,
                    i._layers = i._config.layers,
                    i._tileDataMap = i._createTileDataMap(i._config.tiles),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getCameraPolygonBounds = function() {
                    return this._config.cameraBounds
                }
                ,
                t.prototype.getTileDataByID = function(e) {
                    return this._tileDataMap.get(e)
                }
                ,
                t.prototype.getTileDataAt = function(e, t, i) {
                    var n = t + i * this.width
                      , r = this._layers[e].data[n] || -1;
                    return this._tileDataMap.get(r)
                }
                ,
                t.prototype.forEachTileInLayer = function(e, t) {
                    for (var i = 0; i < this.width; i++)
                        for (var n = 0; n < this.height; n++)
                            t(i, n, this.getTileDataAt(e, i, n))
                }
                ,
                t.prototype.getFirstMarker = function() {
                    return Object.values(this._config.markers)[0]
                }
                ,
                t.prototype.getMarker = function(e) {
                    return this._config.markers[e] || this._logger.warn("Marker with id: ".concat(e, " has not been found.")),
                    this._config.markers[e]
                }
                ,
                t.prototype.getDecals = function() {
                    return this._config.decals
                }
                ,
                t.prototype.getLockedAreas = function() {
                    return this._config.lockedAreas
                }
                ,
                t.prototype.getPremiumAreas = function() {
                    return this._config.premiumAreas
                }
                ,
                t.prototype.getAllAreas = function() {
                    return Object.assign({}, this.getLockedAreas(), this.getPremiumAreas())
                }
                ,
                Object.defineProperty(t.prototype, "width", {
                    get: function() {
                        return this._config.width
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "height", {
                    get: function() {
                        return this._config.height
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "tilewidth", {
                    get: function() {
                        return this._config.tilewidth
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "tileheight", {
                    get: function() {
                        return this._config.tileheight
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._tileDataMap.clear(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createTileDataMap = function(e) {
                    for (var t = new Map, i = 0, n = e; i < n.length; i++) {
                        var r = n[i];
                        t.set(r.id, r)
                    }
                    return t
                }
                ,
                t
            }(Go), lE = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getClosestEmptyToTheCenter = function(e) {
                    var t = this._getCenterCellPosition();
                    return this.getClosestEmptyToTargetPosition(t, e)
                }
                ,
                t.prototype.getClosestEmptyToTargetPosition = function(e, t) {
                    var i = this
                      , n = t ? this.services.gridFilter.getEmptyCells() : this.getEmptyCells()
                      , r = 1 / 0
                      , o = {
                        row: 0,
                        column: 0
                    };
                    return n.forEach((function(t) {
                        var n = i.services.axonometricProjection.getWorldPosition(t.column, t.row)
                          , a = i.services.axonometricProjection.getWorldPosition(e.column, e.row)
                          , s = v.Vector2.substract(new v.Vector2(a.x,a.y), new v.Vector2(n.x,n.y)).length();
                        s < r && (o = {
                            column: t.column,
                            row: t.row
                        },
                        r = s)
                    }
                    )),
                    o
                }
                ,
                t.prototype.getCenterCellPosition = function() {
                    return this._getCenterCellPosition()
                }
                ,
                t.prototype.getCells = function() {
                    var e = this.services.cameraService.getCameraBounds()
                      , t = []
                      , i = new Map
                      , n = this._getCenterCellPosition();
                    return this._collectCells(t, e, n.row, n.column, i),
                    t
                }
                ,
                t.prototype.getEmptyCells = function() {
                    return this.getCells().filter((function(e) {
                        return e && null === e.content
                    }
                    ))
                }
                ,
                t.prototype.getFilledCells = function() {
                    return this.getCells().filter((function(e) {
                        return e && null !== e.content
                    }
                    ))
                }
                ,
                t.prototype.isCellVisible = function(e, t, i) {
                    var n = this.services.axonometricProjection.getWorldPosition(e, t)
                      , r = n.x
                      , o = n.y;
                    return i.contains(r, o)
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._collectCells = function(e, t, i, n, o) {
                    var a = this;
                    if (this.isCellVisible(n, i, t) && !o.has("".concat(i).concat(n))) {
                        if (ff(i, n, this.services.tiledMap.height, this.services.tiledMap.width) && this.services.mapGrid.hasCell(n, i)) {
                            var s = this.services.mapGrid.getCell(n, i);
                            if (!s)
                                throw new Error("CameraViewBounds: no GridCell found! P.S that should never happen because hasCell is used above!");
                            e.push(s)
                        }
                        o.set("".concat(i).concat(n), !0),
                        r.ArrayUtility.shuffleArray([[1, 0], [-1, 0], [0, 1], [0, -1]]).forEach((function(r) {
                            var s = r[0]
                              , _ = r[1]
                              , c = i + s
                              , l = n + _;
                            a._collectCells(e, t, c, l, o)
                        }
                        ))
                    }
                }
                ,
                t.prototype._getCenterCellPosition = function() {
                    var e = this.services.cameraService.getCameraScale()
                      , t = this.services.cameraService.getCameraPosition();
                    return this.services.axonometricProjection.getProjectedIndices(new Xe.Point(t.x / e.x,t.y / e.y))
                }
                ,
                t
            }(Go), uE = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.onGameObjectAdded = new r.Event,
                    t.onGameObjectAvailable = new r.Event,
                    t.onGameObjectRemoved = new r.Event,
                    t._gameObjects = new Set,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.addGameObject = function(e) {
                    this._gameObjects.has(e) ? this._logger.error("gameobject ".concat(e.getBlueprintID(), " has already been added to the world")) : (this._gameObjects.add(e),
                    this.onGameObjectAdded.fire(e))
                }
                ,
                t.prototype.removeGameObject = function(e) {
                    this._gameObjects.has(e) ? (this._gameObjects.delete(e),
                    this.onGameObjectRemoved.fire(e),
                    e.destroy(void 0, !0)) : this._logger.error("can't remove gameobject ".concat(e.getBlueprintID(), ", because it hasn't been added to the world"))
                }
                ,
                t.prototype.hasGameObject = function(e) {
                    return this._gameObjects.has(e)
                }
                ,
                t.prototype.getAllGameObjects = function() {
                    return Array.from(this._gameObjects)
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), dE = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this
                      , n = t.mapConfig;
                    return i._commonFriendEvents = {
                        notificationEvent: new r.Event
                    },
                    i.addServices({
                        tiledMap: new cE(n),
                        axonometricProjection: new iE(n.tilewidth,n.tileheight),
                        mapAreaService: new aE,
                        mapGrid: new Cf(Wo.main,!1),
                        world: new uE,
                        mapGridView: new tE,
                        cameraService: new eE,
                        interactionService: new Mo,
                        interactionHelper: new nE,
                        gridFilter: new Ef,
                        visibleCells: new lE,
                        onboarding: new Xf,
                        friendHudService: new Lf(i._commonFriendEvents),
                        dialogService: new Pf,
                        interactionWhitelistService: new Bf,
                        friendBuildingStateProvider: new kf,
                        premiumAreaService: new _E,
                        upgradeCard: new $f
                    }),
                    i._systems = [new zg, new Jg, new Mv, new Xg, new qg(i.services.friendBuildingStateProvider), new Qg, new $g(i._commonFriendEvents.notificationEvent), new ef(i.services.friendBuildingStateProvider), new sf, new _f, new uf, new hf, new gf],
                    i.services.onboarding.addTracks([new bf, new wf(Lo.FRIEND_ACTIVITIES_TRACK_2), new wf(Lo.FRIEND_ACTIVITIES_TRACK_3), new wf(Lo.FRIEND_ACTIVITIES_TRACK_4), new wf(Lo.FRIEND_ACTIVITIES_TRACK_5), new Sf]),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, e.prototype.initialize.call(this)];
                            case 1:
                                return n.sent(),
                                [4, Promise.all(this._systems.map((function(e) {
                                    return e.initialize(i.services, i.services.world)
                                }
                                )))];
                            case 2:
                                return n.sent(),
                                t(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    if (this._systems.forEach((function(e) {
                        return e.activate()
                    }
                    )),
                    this.services.cameraService.addViewToParent(this),
                    this.services.mapGridView.addViewToParent(this.services.cameraService.worldView),
                    this._options.startOnTrainStation) {
                        var t = this.services.gridFilter.getCellPositionsWithBehaviors([Ke.Trainstation])[0];
                        t && this.services.cameraService.teleportCameraToCell(t)
                    }
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    Object.values(this._systems).forEach((function(e) {
                        return e.dectivate()
                    }
                    )),
                    e()
                }
                ,
                t.prototype.resize = function(e) {}
                ,
                t.prototype.onDestroy = function() {
                    Object.values(this._systems).forEach((function(e) {
                        return e.destroy()
                    }
                    ))
                }
                ,
                t
            }(Er), hE = 150, pE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._currentDraggedObject = null,
                    t._canPan = !1,
                    t._startDragTime = 0,
                    t._currentDragAcceleration = 0,
                    t._EDGE_PAN_DELAY = 500,
                    t._PAN_ACCELERATION_SENSITIVITY = .5,
                    t._PAN_MAX_SPEED = 50,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.update = function(e, t) {
                    if (this._lastDragPosition && this._currentDraggedObject) {
                        if (this._isPositionOnPanningZone(this._lastDragPosition)) {
                            var i = Date.now();
                            if (this._canPan = i - this._startDragTime > this._EDGE_PAN_DELAY,
                            !this._canPan)
                                return
                        } else
                            this._currentDragAcceleration = 0,
                            this._canPan = !1;
                        if (this._canPan) {
                            var n = this._getMoveTranslation(this._currentDraggedObject);
                            this.services.cameraService.moveBy(n.scale(this._currentDragAcceleration)),
                            this._currentDragAcceleration = Math.min(this._currentDragAcceleration + e * this._PAN_ACCELERATION_SENSITIVITY, this._PAN_MAX_SPEED);
                            var r = this.services.cameraService.getScreenToWorldPosition(this._lastDragPosition);
                            this._currentInterpolationBehavior.startPosition.set(this._currentDraggedObject.position.x, this._currentDraggedObject.y),
                            this._currentInterpolationBehavior.endPosition.set(r.x, r.y)
                        }
                    }
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return (e = De.services.resource.getJson(_e.CAMERA_CONFIG)) && Ee(e.EDGE_PAN_DELAY) ? (this._EDGE_PAN_DELAY = e.EDGE_PAN_DELAY,
                            this._PAN_ACCELERATION_SENSITIVITY = e.PAN_ACCELERATION_SENSITIVITY,
                            this._PAN_MAX_SPEED = e.PAN_MAX_SPEED) : this._logger.error("invalid camera config, missing EDGE_PAN_DELAY"),
                            this.addFamily([Ke.InteractionDrag, Ke.Interpolation], this._onInteractionDragAdded),
                            this.addFamily([Ke.InteractionDropStart], this._onInteractionDropAdded),
                            this.addFamily([Ke.InteractionCancel], this._onInteractionDropAdded),
                            this.services.interactionService.onGestureDrag.addListener(this._onGestureDrag, this),
                            v.GroupsCore.Updateables.add(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.interactionService.onGestureDrag.removeListener(this._onGestureDrag, this),
                            v.GroupsCore.Updateables.remove(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onGestureDrag = function(e) {
                    this._currentDraggedObject && (this._lastDragPosition = e.position)
                }
                ,
                t.prototype._onInteractionDragAdded = function(e) {
                    this._currentDraggedObject || (this._currentInterpolationBehavior = e.getBehavior(Ke.Interpolation),
                    this._currentDraggedObject = e,
                    this._canPan = !1,
                    this._startDragTime = Date.now())
                }
                ,
                t.prototype._onInteractionDropAdded = function(e) {
                    this._currentDraggedObject = null
                }
                ,
                t.prototype._isPositionOnPanningZone = function(e) {
                    var t = this.services.cameraService.getScreenBounds()
                      , i = -.5 * t.width
                      , n = .5 * t.width
                      , r = -.5 * t.height
                      , o = .5 * t.height;
                    return e.x <= i + hE || e.y <= r + hE || e.x >= n - hE || e.y >= o - hE
                }
                ,
                t.prototype._getMoveTranslation = function(e) {
                    var t = this.services.cameraService.getWorldToScreenPosition(e.position);
                    return v.Vector2.fromPoint(t).normalize().scale(-1)
                }
                ,
                t
            }(Pd), vE = new Xe.Point(0,-64), gE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._lastInteractedCellPosition = null,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.InteractionPick, Ke.Movable], this._onFamilyInteractionAdd),
                            this.addFamily([Ke.InteractionDrag, Ke.Movable], this._onFamilyInteractionAdd),
                            this.addFamily([Ke.InteractionDropStart], this._onFamilyDropStartAdd),
                            this.addFamily([Ke.InteractionCancel], this._onFamilyInteractionCancel),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onFamilyInteractionAdd = function(e) {
                    var t = e.getBehavior(Ke.InteractionPick)
                      , i = e.getBehavior(Ke.InteractionDrag) || t;
                    if (i && void 0 !== i.data.dragType) {
                        var n = e.getBehavior(Ke.Interpolation);
                        n || (n = new Vt,
                        e.addBehavior(n)),
                        n.startPosition.copyFrom(e.position),
                        n.dragType = i.data.dragType;
                        var r = this.services.axonometricProjection.getProjectedIndices(i.data.pointerPosition);
                        if (!this._lastInteractedCellPosition || this._lastInteractedCellPosition.row !== r.row || this._lastInteractedCellPosition.column !== r.column)
                            if (i.data.dragType === Ut.SLOW) {
                                var o = this.services.axonometricProjection.getWorldPosition(r.column, r.row);
                                n.endPosition.copyFrom(o),
                                this._lastInteractedCellPosition = r
                            } else
                                n.endPosition.copyFrom(i.data.pointerPosition).add(vE)
                    }
                }
                ,
                t.prototype._onFamilyDropStartAdd = function(e) {
                    e.hasBehavior(Ke.Interpolation) && (this._lastInteractedCellPosition = null,
                    e.removeBehaviorByType(Ke.Interpolation))
                }
                ,
                t.prototype._onFamilyInteractionCancel = function() {
                    this._lastInteractedCellPosition = null
                }
                ,
                t
            }(Pd), fE = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.InteractionPick, Ke.Movable], this._executeOnPick),
                            this.addFamily([Ke.InteractionDropStart, Ke.Movable], this._executeOnDropStart),
                            this.addFamily([Ke.InteractionDropEnd, Ke.Movable], this._executeOnDropEnd),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._executeOnPick = function(e) {
                    e.getBehavior(Ke.InteractionPick) && this.services.mapGridView.getLayer(Yo.LAYER_SELECTION).addChild(e)
                }
                ,
                t.prototype._executeOnDropStart = function(e) {
                    e.getBehavior(Ke.InteractionDropStart) && this.services.mapGridView.getLayer(Yo.LAYER_SELECTION).removeChild(e)
                }
                ,
                t.prototype._executeOnDropEnd = function(e) {
                    e.getBehavior(Ke.InteractionDropEnd) && this.services.mapGridView.getLayer(Yo.MAIN).addChild(e)
                }
                ,
                t
            }(Pd), EE = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "ShovelInfoPopup",
                    i._createBackground(),
                    i._createInfo(),
                    i._createButton(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    this._backGround.onCloseClick(this.close.bind(this)),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerdown", this._tryToClose, this)
                }
                ,
                t.prototype._createBackground = function() {
                    this._backGround = new Ar({
                        size: {
                            width: 1e3,
                            height: 700
                        },
                        headerSize: {
                            width: 666.6666666666666,
                            height: 75
                        },
                        headerText: ce.SHOVEL_POPUP_HEADER,
                        headerStyle: vn.popupTitle
                    }),
                    this._content.addChild(this._backGround)
                }
                ,
                t.prototype._createInfo = function() {
                    this._content.addChild(rr(De.services.resource.getSprite(f.ICON_POPUP_SHOVEL_EXPLANATION), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 40,
                            y: -90
                        }
                    }));
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 180,
                        fitWidth: 769.2307692307692
                    });
                    e.style = vn.darkMedium,
                    this._content.addChild(rr(new v.Label(nr(Kf || (Kf = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.SHOVEL_POPUP_INFO),e), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 120
                        }
                    }))
                }
                ,
                t.prototype._createButton = function() {
                    var e = new fr({
                        name: "ok",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 350,
                            height: 80
                        }
                    },{
                        text: ce.BUTTON_OK,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    e.position.set(0, 250),
                    e.onClick(this.close.bind(this)),
                    this._content.addChild(e)
                }
                ,
                t
            }(yr), mE = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "ShovelRemovePopup",
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    this._createBackground(),
                    this._createInfo(),
                    this._createButtons(),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype._tryToClose = function(e) {
                    e.stopPropagation()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBackground = function() {
                    this._backGround = new Ar({
                        size: {
                            width: 1e3,
                            height: 450
                        },
                        headerSize: {
                            width: 666.6666666666666,
                            height: 75
                        },
                        headerText: ce.SHOVEL_POPUP_REMOVE_HEADER,
                        headerStyle: vn.popupTitle,
                        showCloseButton: !1
                    }),
                    this._content.addChild(this._backGround)
                }
                ,
                t.prototype._createInfo = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 180,
                        fitWidth: 769.2307692307692
                    });
                    e.style = vn.darkMedium,
                    this._content.addChild(rr(new v.Label(nr(Wf || (Wf = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.SHOVEL_POPUP_REMOVE),e), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -30
                        }
                    }))
                }
                ,
                t.prototype._createButtons = function() {
                    var e = this
                      , t = new fr({
                        name: "yes",
                        buttonIdle: f.BTN_DEFAULT_RED_IDLE,
                        buttonActive: f.BTN_DEFAULT_RED_ACTIVE
                    },{
                        buttonSizes: {
                            width: 350,
                            height: 80
                        }
                    },{
                        text: ce.BUTTON_YES,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    t.position.set(-200, 125),
                    t.onClick((function() {
                        e._options.onConfirm(),
                        e.close()
                    }
                    ));
                    var i = new fr({
                        name: "no",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 350,
                            height: 80
                        }
                    },{
                        text: ce.BUTTON_NO,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    i.position.set(200, 125),
                    i.onClick((function() {
                        e._options.onReject(),
                        e.close()
                    }
                    )),
                    this._content.addChild(t, i)
                }
                ,
                t
            }(yr), yE = [{
                name: "wobble",
                duration: .332,
                repeat: 0,
                keyframes: {
                    image: [{
                        time: 0,
                        duration: .5,
                        ease: "none",
                        params: {
                            scale: {
                                x: .9,
                                y: 1.1
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }]
                }
            }], TE = [{
                name: "highlight",
                duration: 1.4,
                repeat: -1,
                keyframes: {
                    highlighter: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0
                        }
                    }, {
                        time: 0,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0
                        }
                    }]
                }
            }], AE = function(e) {
                function t() {
                    var t = e.call(this, Xe.Texture.EMPTY) || this;
                    return t._texturesMap = {
                        green: De.services.resource.getTexture(f.HIGHLIGHTER_GREEN),
                        red: De.services.resource.getTexture(f.HIGHLIGHTER_RED)
                    },
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.turnRed = function() {
                    this.texture = this._texturesMap.red,
                    this.blendMode = Xe.BLEND_MODES.MULTIPLY
                }
                ,
                t.prototype.turnWhite = function() {
                    this.texture = this._texturesMap.green,
                    this.blendMode = Xe.BLEND_MODES.SCREEN
                }
                ,
                t
            }(Xe.Sprite);
            !function(e) {
                e[e.ONE_BY_ONE = 0] = "ONE_BY_ONE",
                e[e.TWO_BY_TWO = 1] = "TWO_BY_TWO"
            }(zf || (zf = {}));
            var CE, IE, SE, OE = new Xe.Sprite(Xe.Texture.EMPTY), bE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._currentHighlighterType = null,
                    t._highlighter = new AE,
                    t._tween = new ur(TE),
                    t._target = OE,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "currentHighlighterType", {
                    get: function() {
                        return this._currentHighlighterType
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.addHighlighter = function(e, t) {
                    var i = e === zf.ONE_BY_ONE ? 1 : 2
                      , n = e === zf.ONE_BY_ONE ? this.services.axonometricProjection.defaultAnchor : {
                        x: .5,
                        y: .5
                    };
                    this._currentHighlighterType = e,
                    this._highlighter.scale.set(i),
                    this._highlighter.anchor.copyFrom(n),
                    this._background.addChild(this._highlighter),
                    this._target = t || OE
                }
                ,
                t.prototype.removeHighlighter = function() {
                    this._highlighter.position.set(0, 0),
                    this._background.removeChild(this._highlighter),
                    this._currentHighlighterType = null,
                    this._target.tint = 16777215,
                    this._target = OE
                }
                ,
                t.prototype.updateHighlighterPosition = function(e) {
                    ca(e) ? this._highlighter.position.copyFrom(this.services.axonometricProjection.getWorldPosition(e.column, e.row)) : this._highlighter.position.copyFrom(e)
                }
                ,
                t.prototype.swapToRedHighlighter = function() {
                    this._highlighter.turnRed(),
                    this._target.tint = 15757712
                }
                ,
                t.prototype.swapToWhiteHighlighter = function() {
                    this._highlighter.turnWhite(),
                    this._target.tint = 16777215
                }
                ,
                t.prototype.hideHighlighter = function() {
                    this._highlighter.visible = !1
                }
                ,
                t.prototype.showHighlighter = function() {
                    this._highlighter.visible = !0
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._background = this.services.mapGridView.getLayer(Yo.BACKGROUD),
                            this._tween.setTargets({
                                highlighter: this._highlighter
                            }),
                            this._tween.play("highlight"),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._background = null,
                            this._tween.dispose(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), RE = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._shovelSprite = De.services.resource.getSprite(f.SHOVEL),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._shovelSprite.anchor.set(.1, .8),
                            this._shovelButton = this.services.hudService.hudContainer.getUIelement(Ns.ShovelButtonUI),
                            this._shovelButton.events.shovelStart.addListener(this._onShovelStart, this),
                            this._shovelButton.events.shovelEnd.addListener(this._onShovelEnd, this),
                            this._shovelButton.events.shovelMove.addListener(this._onShovelMove, this),
                            this._shovelButton.events.shovelPress.addListener(this._showInfo, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showInfo = function() {
                    De.services.lazyLoad.prioritizeGroup(hn.SHOVEL_POPUP).then((function() {
                        return De.services.navigation.showPopup(EE, {})
                    }
                    ))
                }
                ,
                t.prototype._onShovelStart = function() {
                    this.services.interactionWhitelistService.blockAllDrags(),
                    this.services.mapGridView.getLayer(Yo.POPOUTS).addChild(this._shovelSprite),
                    this.services.shovelService.highlightRemovableTiles(),
                    this.services.highlightTileService.addHighlighter(zf.ONE_BY_ONE)
                }
                ,
                t.prototype._onShovelEnd = function() {
                    var e = this;
                    this.services.interactionWhitelistService.allowAllDrags(),
                    this._currentCell && this._currentCell.content && (this._runWobbleAnimation(this._currentCell.content),
                    this.services.shovelService.shovelableCells.includes(this._currentCell) && (this._contentToRemove = this._currentCell.content,
                    De.services.lazyLoad.prioritizeGroup(hn.SHOVEL_ANIMATION).then((function() {
                        De.services.navigation.showPopup(mE, {
                            onConfirm: function() {
                                return e._onContentRemove()
                            },
                            onReject: function() {
                                return e._resetShovelSystem()
                            }
                        })
                    }
                    )))),
                    this._resetShovelSystem()
                }
                ,
                t.prototype._onShovelMove = function(e) {
                    var t = e.data.getLocalPosition(this.services.mapGridView.getLayer(Yo.PREVIEW_UI));
                    this._shovelSprite.position.set(t.x, t.y);
                    var i = this.services.axonometricProjection.getProjectedIndices(t)
                      , n = i.column
                      , r = i.row;
                    this._currentCell = this.services.mapGrid.getCell(n, r),
                    this._currentCell && (this.services.highlightTileService.updateHighlighterPosition(this._currentCell),
                    this.services.shovelService.nonShovelableCells.includes(this._currentCell) ? this._currentCell.content && this.services.highlightTileService.swapToRedHighlighter() : this.services.highlightTileService.swapToWhiteHighlighter())
                }
                ,
                t.prototype._resetShovelSystem = function() {
                    this.services.mapGridView.getLayer(Yo.POPOUTS).removeChild(this._shovelSprite),
                    this.services.highlightTileService.swapToWhiteHighlighter(),
                    this.services.highlightTileService.removeHighlighter(),
                    this.services.shovelService.resetAllTiles()
                }
                ,
                t.prototype._onContentRemove = function() {
                    De.services.analytics.design.shovelUsed();
                    var e = this._contentToRemove.getObjectIdAndTier()
                      , t = e.id
                      , i = e.tier;
                    "flower" !== t || (0,
                    r.isUndefined)(i) || De.services.analytics.design.reportFlowerShoveled(i),
                    this._contentToRemove.addBehavior(new Si),
                    this._contentToRemove.addBehavior(new ti({}))
                }
                ,
                t.prototype._runWobbleAnimation = function(e) {
                    var t = new ur(yE);
                    t.setTargets({
                        image: e
                    }),
                    t.onEnd.addListener((function() {
                        t.dispose()
                    }
                    ), null),
                    t.play("wobble")
                }
                ,
                t
            }(Pd), wE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._areasData = [],
                    t._premiumData = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.InteractionPick, Ke.Movable], this._onObjectPick),
                            this.addFamily([Ke.InteractionDrag, Ke.Movable], this._onObjectDrag),
                            this.addFamily([Ke.InteractionDropEnd, Ke.Movable], this._removeHighlighter),
                            this.addFamily([Ke.InteractionCancel], null, this._removeHighlighter),
                            this.addFamily([Ke.MergeTrigger], this._removeHighlighter),
                            this._areasData = this.services.mapAreaService.getMapAreas(),
                            this._premiumData = this.services.premiumAreaService.getMapAreas(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._areasData = [],
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onObjectPick = function(e) {
                    var t = e.getChildAt(0).getChildAt(0)
                      , i = e.getBehavior(Ke.ExtendedTile)
                      , n = !0;
                    i && (n = 1 === i.width && 1 === i.height),
                    this.services.highlightTileService.addHighlighter(n ? zf.ONE_BY_ONE : zf.TWO_BY_TWO, t)
                }
                ,
                t.prototype._onObjectDrag = function(e) {
                    var t = e.getBehavior(Ke.InteractionDrag).data
                      , i = t.hoverSelection
                      , n = t.pointerPosition
                      , o = this.services.axonometricProjection.getProjectedIndices(n);
                    this.services.highlightTileService.updateHighlighterPosition(o);
                    var a = this.services.highlightTileService.currentHighlighterType;
                    if (!(0,
                    r.isNull)(a)) {
                        var s = a === zf.ONE_BY_ONE
                          , _ = s ? this._isInUnlockedArea(o) : this._isExtendedTileInUnlockedArea(this._getExtendedTileCoordinates(o, e.getBehavior(Ke.ExtendedTile)))
                          , c = s ? this._isValidTargetForSingleTile(i) : this._isValidTargetForExtendedTile(this._getExtendedTileCoordinates(o, e.getBehavior(Ke.ExtendedTile)));
                        _ && c ? this.services.highlightTileService.swapToWhiteHighlighter() : this.services.highlightTileService.swapToRedHighlighter()
                    }
                }
                ,
                t.prototype._removeHighlighter = function() {
                    this.services.highlightTileService.removeHighlighter()
                }
                ,
                t.prototype._isInUnlockedArea = function(e) {
                    var t = e.column
                      , i = e.row
                      , n = this._areasData.find((function(e) {
                        return e.cellsHashes.has(ql(t, i))
                    }
                    ));
                    return n || (n = this._premiumData.find((function(e) {
                        return e.cellsHashes.has(ql(t, i))
                    }
                    ))),
                    Boolean(n && n.state === Cc.UNLOCKED)
                }
                ,
                t.prototype._isValidTargetForSingleTile = function(e) {
                    return !!e && (!e.content || e.content.hasBehavior(Ke.Displaceable))
                }
                ,
                t.prototype._getExtendedTileCoordinates = function(e, t) {
                    for (var i = t.width, n = t.height, r = [e], o = e.column; o > e.column - i; o--)
                        for (var a = e.row; a > e.row - n; a--)
                            o === e.column && a === e.row || r.push({
                                column: o,
                                row: a
                            });
                    return r
                }
                ,
                t.prototype._isExtendedTileInUnlockedArea = function(e) {
                    var t = this._areasData.filter((function(e) {
                        return e.state === Cc.UNLOCKED
                    }
                    ))
                      , i = this._premiumData.filter((function(e) {
                        return e.state === Cc.UNLOCKED
                    }
                    ))
                      , n = t.concat(i)
                      , r = e.reduce((function(e, t) {
                        var i = ql(t.column, t.row)
                          , r = n.find((function(e) {
                            return e.cellsHashes.has(i)
                        }
                        ));
                        return r && (e.cells.push(t),
                        e.areas.push(r)),
                        e
                    }
                    ), {
                        cells: [],
                        areas: []
                    });
                    return r.cells.length === e.length && r.areas.every((function(e) {
                        return e.state === Cc.UNLOCKED
                    }
                    ))
                }
                ,
                t.prototype._isValidTargetForExtendedTile = function(e) {
                    var t = this;
                    return e.every((function(e) {
                        var i = e.column
                          , n = e.row
                          , r = t.services.mapGrid.getCell(i, n);
                        return Boolean(r && (!r.content || r.content.getBehavior(Ke.Displaceable)))
                    }
                    ))
                }
                ,
                t
            }(Pd), DE = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._family = this.addFamily([Ke.WorldPosition], this._onWorldPositionBehaviorAttached),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onWorldPositionBehaviorAttached = function(e) {
                    var t = e.getBehavior(Ke.WorldPosition);
                    e.position.copyFrom(t)
                }
                ,
                t
            }(Pd), NE = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.InteractionDropStart, Ke.Dropable], this._onFamilyInteractionAdd),
                            this.addFamily([Ke.InteractionCancel], this._onInteractionCancelAdded),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._performDrop = function(e) {
                    var t = e.parent;
                    if (!t)
                        throw new Error("Interaction Behavior is somehow detached, can't execute Drop logic. Find and slap your nearest engineer!");
                    var i = e.data.originCell
                      , n = e.data.hoverSelection;
                    if (n) {
                        if (!t.getBehavior(Ke.ExtendedTile))
                            switch (!0) {
                            case this._performDropSameCell(t, n, i):
                            case this._performDropEmptyCell(t, n):
                            case this._performDropMerge(t):
                            case this._performDropDisplaceable(t, n):
                            case this._performDropInvalid(t, i, e):
                            }
                    } else
                        this._performDropInvalid(t, i, e)
                }
                ,
                t.prototype._onFamilyInteractionAdd = function(e) {
                    var t = e.getBehavior(Ke.InteractionDropStart);
                    t && this._performDrop(t)
                }
                ,
                t.prototype._performDropSameCell = function(e, t, i) {
                    var n = !1;
                    if (t === i) {
                        this._logger.info("[Drop System]: Dropping into the same cell");
                        var r = new $t({
                            targetPosition: i
                        });
                        e.addBehavior(r),
                        n = !0
                    }
                    return n
                }
                ,
                t.prototype._performDropMerge = function(e) {
                    var t = e.getBehavior(Ke.MergeDetection);
                    if (!t)
                        return !1;
                    var i = this.services.mapGrid.getCell(t.cell.column, t.cell.row);
                    if (!i || !i.content)
                        return this._logger.error("merge detection behavior pointing to invalid cell position!"),
                        e.removeBehavior(t),
                        !1;
                    this._logger.info("[Drop System]: Merge available: ".concat(i.column, ", ").concat(i.row)),
                    e.removeBehavior(t);
                    var n = new Xt({
                        cell: t.cell,
                        chain: t.chain
                    });
                    return i.content.addBehavior(n),
                    this._worldService.removeGameObject(e),
                    this._reportAnalytics(e),
                    !0
                }
                ,
                t.prototype._performDropDisplaceable = function(e, t) {
                    var i = !1;
                    if (t.content && (t.content.getBlueprintID() === e.getBlueprintID() && e.hasBehavior(Ke.Mergeable) && e.addBehavior(new ui({
                        floaterType: ci.TextFloater,
                        text: nr(CE || (CE = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.MERGE_2_TOOLTIP),
                        styles: vn.warningText
                    })),
                    t.content.hasBehavior(Ke.Displaceable))) {
                        this._logger.info("[Drop System]: Object will be displaced: ".concat(t.column, ", ").concat(t.row));
                        var r = new $t({
                            targetPosition: t
                        });
                        e.addBehavior(r),
                        i = !0
                    }
                    return i
                }
                ,
                t.prototype._performDropInvalid = function(e, t, i) {
                    var n = t;
                    if (i && (0,
                    r.isUndefined)(this.services.onboarding.activeTrackKey)) {
                        var o = this.services.axonometricProjection.getProjectedIndices(i.data.pointerPosition);
                        n = this.services.gridFilter.getClosestAvailableCell(o, !1) || n
                    }
                    this._logger.info("[Drop System]: Cannot drop on location, moving to new position: ".concat(n.column, ", ").concat(n.row));
                    var a = new $t({
                        targetPosition: n
                    });
                    return e.addBehavior(a),
                    !0
                }
                ,
                t.prototype._performDropEmptyCell = function(e, t) {
                    var i = !1;
                    if (!t.content) {
                        this._logger.info("[Drop System]: Dropping cell into: column:".concat(t.column, ", row:").concat(t.row));
                        var n = new $t({
                            targetPosition: t
                        });
                        e.addBehavior(n),
                        i = !0
                    }
                    return i
                }
                ,
                t.prototype._onInteractionCancelAdded = function(e) {
                    var t = e.getBehavior(Ke.InteractionCancel);
                    this._performDropInvalid(e, t.data.originCell),
                    e.removeBehaviorByType(Ke.InteractionCancel)
                }
                ,
                t.prototype._reportAnalytics = function(e) {
                    "tool" === e.getBlueprintID().split("_")[0] && De.services.analytics.design.reportToolMerged()
                }
                ,
                t
            }(Pd), LE = [{
                name: "animate_content",
                duration: .7,
                repeat: 0,
                keyframes: {
                    spawnable: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            position: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: .188,
                        duration: .249,
                        ease: "circ.out",
                        params: {
                            alpha: 1,
                            position: {
                                y: "$topPoint"
                            }
                        }
                    }, {
                        time: .188,
                        duration: .45,
                        ease: "none",
                        params: {
                            position: {
                                x: "$arrivalPoint"
                            }
                        }
                    }, {
                        time: .437,
                        duration: .249,
                        ease: "circ.in",
                        params: {
                            position: {
                                y: "$arrivalPoint"
                            }
                        },
                        event: "updateLayer"
                    }, {
                        time: 0,
                        duration: .45,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1.5,
                                y: 1.5
                            }
                        }
                    }, {
                        time: .45,
                        duration: .25,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }],
                    topPoint: [],
                    arrivalPoint: []
                }
            }], BE = function() {
                function e(e, t, i, n) {
                    this.onAnimationComplete = new r.Event,
                    this._content = new Xe.Sprite(e.texture),
                    this._content.anchor.copyFrom(e.anchor),
                    this._startPosition = e.position,
                    this._startContainer = t,
                    this._targetPosition = i,
                    this._targetContainer = n,
                    this._setupAnimation()
                }
                return e.prototype._setupAnimation = function() {
                    var e = this;
                    this._targetContainer.addChild(this._content);
                    var t = this._startContainer.toGlobal(this._startPosition);
                    this._content.position = this._targetContainer.toLocal(t);
                    var i = new ur(LE);
                    i.setTargets({
                        spawnable: this._content,
                        topPoint: {
                            position: {
                                x: this._content.position.x,
                                y: Math.min(this._content.position.y - (this._content.height / 2 + 100), this._targetPosition.y - 100)
                            }
                        },
                        arrivalPoint: {
                            position: {
                                x: this._targetPosition.x,
                                y: this._targetPosition.y + 70
                            }
                        }
                    }),
                    i.onEnd.addListener((function() {
                        e._targetContainer.removeChild(e._content),
                        e._content.destroy(),
                        e.onAnimationComplete.fire()
                    }
                    ), null),
                    i.play("animate_content")
                }
                ,
                e
            }(), PE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._autoplaceServiceStorageBubble = null,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.AutoPlace], this._execute),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._execute = function(e) {
                    var t = e.getBehavior(Ke.AutoPlace);
                    if (!t)
                        throw new Error("The variable `autoPlaceBehavior` should not be null here. Check if the family is observing the correct behavior (BehaviorTypes.AutoPlace)");
                    var i, n = this.services.mapGrid.getCell(t.rootPosition.column, t.rootPosition.row), r = e.getBehavior(Ke.ExtendedTile);
                    if (r && (r.width > 1 || r.height > 1)) {
                        var o = this.services.gridFilter.getClosestAvailable2x2CellSquare(t.rootPosition);
                        o && (o.top.content = new ev,
                        o.right.content = new ev,
                        o.left.content = new ev,
                        o.bottom.content = new ev,
                        i = o.bottom)
                    } else
                        this.services.gridFilter.getEmptyCells().length > 0 && (i = this.services.gridFilter.getClosestAvailableCell(t.rootPosition, t.neighborsOnly));
                    if (e.removeBehavior(t),
                    i) {
                        var a = new $t({
                            originPosition: n,
                            targetPosition: i
                        });
                        e.addBehavior(a)
                    } else {
                        if (this._autoplaceServiceStorageBubble) {
                            var s = this._autoplaceServiceStorageBubble.getBehavior(Ke.StorageBubble)
                              , _ = e.getBlueprintID()
                              , c = De.services.blueprintCollection.getBlueprint(_).components
                              , l = e.serialize(c);
                            s.content.length < 1 ? this._autoplaceServiceStorageBubble = this.services.storageBubble.createBubble([l]) : this._autoplaceServiceStorageBubble.replaceBehavior(new Bi({
                                content: s.content.concat(l)
                            }))
                        } else
                            this._autoplaceServiceStorageBubble = this.services.storageBubble.createBubble([{
                                blueprint: e.getBlueprintID(),
                                data: {}
                            }]);
                        this._animateContentToBubble(n),
                        this._worldService.removeGameObject(e)
                    }
                }
                ,
                t.prototype._animateContentToBubble = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (0,
                                r.isUndefined)(e) ? [4, r.TimeDelay.after(100).promise] : (this._autoplaceServiceStorageBubble.addBehavior(new Ui({
                                    enableInteraction: !0
                                })),
                                [2]);
                            case 1:
                                return n.sent(),
                                t = this.services.storageBubble.getBubbleContainers(this._autoplaceServiceStorageBubble).contentContainer,
                                i = e.content.getChildByName("maincontainer"),
                                o = i.getChildByName("mainsprite"),
                                new BE(o,i,t.position,t.parent).onAnimationComplete.addListener((function() {
                                    a._autoplaceServiceStorageBubble && !a._autoplaceServiceStorageBubble.hasBehavior(Ke.StorageBubbleShowContent) && a._autoplaceServiceStorageBubble.addBehavior(new Ui({
                                        enableInteraction: !0
                                    }))
                                }
                                ), this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Pd), kE = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.MoveContentToCell], this._execute),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._execute = function(e) {
                    var t = e.getBehavior(Ke.MoveContentToCell)
                      , i = (t.originPosition,
                    t.targetPosition)
                      , n = this.services.mapGrid.getCell(i.column, i.row);
                    if (n) {
                        var r = n.content;
                        if (r) {
                            var o = new et({
                                rootPosition: i
                            });
                            r.addBehavior(o),
                            r.removeBehaviorByType(Ke.GridPosition)
                        }
                        this._attachObjectToGrid(e, i),
                        this._handleAnimation(e, i)
                    } else
                        this._logger.error("invalid placement location (".concat(i.column, ";").concat(i.row, ")"))
                }
                ,
                t.prototype._attachObjectToGrid = function(e, t) {
                    e.addBehavior(new Rt(t)),
                    e.removeBehaviorByType(Ke.MoveContentToCell)
                }
                ,
                t.prototype._handleAnimation = function(e, t) {
                    var i = v.Vector2.fromPoint(e.position)
                      , n = e.getBehavior(Ke.Interpolation);
                    e.hasBehavior(Ke.SpawnAnimation) || e.hasBehavior(Ke.BubbleSpawnContent) ? (n && e.removeBehavior(n),
                    e.removeBehaviorByType(Ke.SpawnAnimation),
                    e.removeBehaviorByType(Ke.BubbleSpawnContent)) : (n || (n = new Vt,
                    e.addBehavior(n)),
                    n.startPosition.copyFrom(i),
                    n.endPosition.copyFrom(this.services.axonometricProjection.getWorldPosition(t.column, t.row)))
                }
                ,
                t
            }(Pd), xE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._placedExtendTiles = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.ExtendedTile, Ke.GridPosition], this._onExtendedTileAdded, this._onExtendedTileRemoved),
                            this.addFamily([Ke.ExtendedTile, Ke.Upgrade], this._tryToAddInteractivity),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onExtendedTileAdded = function(e) {
                    for (var t = e.getBehavior(Ke.ExtendedTile), i = e.getBehavior(Ke.GridPosition), n = i.column; n > i.column - t.width; n--)
                        for (var r = i.row; r > i.row - t.height; r--)
                            if (n !== i.column || r !== i.row) {
                                var o = new ev(mf);
                                o.addBehavior(new nt),
                                o.addBehavior(new Ct({
                                    parentTile: e
                                })),
                                o.addBehavior(new Rt({
                                    column: n,
                                    row: r
                                })),
                                this._worldService.addGameObject(o),
                                t.addChild(o)
                            }
                    this._tryToAddInteractivity(e),
                    this._placedExtendTiles.push({
                        gameObject: e
                    })
                }
                ,
                t.prototype._onExtendedTileRemoved = function(e) {
                    var t = this
                      , i = e.getBehavior(Ke.ExtendedTile);
                    if (i) {
                        var n = this._placedExtendTiles.find((function(t) {
                            return t.gameObject === e
                        }
                        ));
                        if (!n)
                            throw new Error("ExtendedTileBlockingSystem: this shouldn't happen anymore!");
                        i.getChildren().forEach((function(e) {
                            return t._worldService.removeGameObject(e)
                        }
                        )),
                        i.removeChildren(),
                        this._placedExtendTiles.splice(this._placedExtendTiles.indexOf(n), 1)
                    }
                }
                ,
                t.prototype._tryToAddInteractivity = function(e) {
                    e.hasBehavior(Ke.Movable) && e.getBehavior(Ke.ExtendedTile).getChildren().forEach((function(e) {
                        return e.addBehavior(new Zt)
                    }
                    ))
                }
                ,
                t
            }(Pd), GE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._handling = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.InteractionDropStart, Ke.ExtendedTile], this._execute),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._execute = function(e) {
                    var t, i = e.getBehavior(Ke.InteractionDropStart), n = e.getBehavior(Ke.ExtendedTile);
                    if (-1 !== this._handling.indexOf(e))
                        throw new Error("ExtendedTileDropSystem, this issue shouldn't happen anymore!");
                    this._handling.push(e);
                    var r = i.data.originCell
                      , o = i.data.hoverSelection;
                    if (o) {
                        var a = this._checkAreaValidAndEmpty(o, n);
                        if (a) {
                            for (var s = 0, _ = a; s < _.length; s++) {
                                var c = _[s];
                                if (c.content) {
                                    var l = new et({
                                        rootPosition: o
                                    })
                                      , u = c.content;
                                    u.addBehavior(l),
                                    u.removeBehaviorByType(Ke.GridPosition)
                                }
                                c.content = new ev(mf)
                            }
                            this._forceObjectToPosition(o, e)
                        } else
                            this._moveObjectTo(r, e)
                    } else {
                        var d = this.services.axonometricProjection.getProjectedIndices(i.data.pointerPosition)
                          , h = (null === (t = this.services.gridFilter.getClosestAvailable2x2CellSquare(d)) || void 0 === t ? void 0 : t.bottom) || r;
                        this._moveObjectTo(h, e)
                    }
                    this._handling.splice(this._handling.indexOf(e))
                }
                ,
                t.prototype._checkAreaValidAndEmpty = function(e, t) {
                    for (var i = [], n = e.column; n > e.column - t.width; n--)
                        for (var r = e.row; r > e.row - t.height; r--) {
                            var o = this.services.mapGrid.getCell(n, r);
                            if (!o)
                                return null;
                            if (o.content) {
                                if (!o.content.getBehavior(Ke.Displaceable))
                                    return null;
                                if (o.content.getBehavior(Ke.Building))
                                    return null
                            }
                            i.push(o)
                        }
                    return i
                }
                ,
                t.prototype._moveObjectTo = function(e, t) {
                    t.addBehavior(new $t({
                        targetPosition: e
                    }))
                }
                ,
                t.prototype._forceObjectToPosition = function(e, t) {
                    t.addBehavior(new Rt({
                        column: e.column,
                        row: e.row
                    })),
                    t.removeBehaviorByType(Ke.MoveContentToCell)
                }
                ,
                t
            }(Pd);
            function UE(e) {
                for (var t = (0,
                n.__spreadArray)([], e, !0), i = e.reduce((function(e, t) {
                    return e + t.weight
                }
                ), 0), r = Math.random() * i; r > t[0].weight; )
                    r -= t[0].weight,
                    t.shift();
                return t[0].key
            }
            !function(e) {
                e.OBJECT = "object",
                e.COIN = "coin",
                e.GEM = "gem",
                e.REWARD_CRATE_KEY = "reward_crate_key",
                e.REWARD_CRATE = "reward_crate"
            }(IE || (IE = {})),
            function(e) {
                e.GEM = "gem",
                e.COIN = "coin",
                e.TOOLBOX = "toolbox",
                e.CRATE = "crate",
                e.ENERGY = "energy",
                e.OBJECT = "object"
            }(SE || (SE = {}));
            var FE, ME = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "PseudoRandomnessModel",
                    t._version = 1,
                    t._items = [],
                    t._itemss = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getItemByContextAndKey = function(e, t) {
                    var i = this.getContextData(e);
                    return this.getItemByKey(i, t)
                }
                ,
                t.prototype.getContextData = function(e) {
                    var t = this._itemss.find((function(t) {
                        return t.context === e
                    }
                    ));
                    return t || (t = {
                        context: e,
                        items: []
                    },
                    this._itemss.push(t),
                    this.saveData()),
                    t
                }
                ,
                t.prototype.getItemByKey = function(e, t) {
                    var i = e.items.find((function(e) {
                        return e.key === t
                    }
                    ));
                    return i || (i = this._createNewItemWithKey(t),
                    e.items.push(i),
                    this.saveData()),
                    i
                }
                ,
                t.prototype.updateItem = function(e, t) {
                    var i = this.getItemByContextAndKey(e, t.key);
                    i.unsuccesfulAttempts = t.unsuccesfulAttempts,
                    i.weightIncrease = t.weightIncrease,
                    i.cooldownAmount = t.cooldownAmount,
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._itemss = e.data
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        data: this._itemss
                    }
                }
                ,
                t.prototype._createNewItemWithKey = function(e) {
                    var t = {
                        key: e,
                        unsuccesfulAttempts: 0,
                        weightIncrease: 0,
                        cooldownAmount: 0
                    };
                    return this._items.push(t),
                    this.saveData(),
                    t
                }
                ,
                t
            }($n);
            !function(e) {
                e.ANIMAL = "animal",
                e.CROP = "crop",
                e.CRATE = "crate",
                e.MAPSOURCE = "mapSource",
                e.REWARD_CRATE = "rewardCrate",
                e.MERGE = "merge",
                e.DAILY_CHALLENGE = "dailyChallenge"
            }(FE || (FE = {}));
            var VE, HE, jE, KE, WE, zE, YE, JE, XE, qE, QE, ZE = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._model = new ME,
                    t._crateWeightedArray = [],
                    t._coinWeightedArray = [],
                    t._gemWeightedArray = [],
                    t._rewardCrateKeyWeightedArray = [],
                    t._rewardCrateWeightedArray = [],
                    t._crateSpawnItemTierConfig = [],
                    t._temporaryLootContextItems = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "model", {
                    get: function() {
                        return this._model
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.addTemporaryLootContextItems = function(e, t) {
                    if (this._temporaryLootContextItems.has(e)) {
                        var i = this._temporaryLootContextItems.get(e);
                        this._temporaryLootContextItems.set(e, (0,
                        n.__spreadArray)((0,
                        n.__spreadArray)([], i, !0), t, !0))
                    } else
                        this._temporaryLootContextItems.set(e, t)
                }
                ,
                t.prototype.removeTemporaryLootContextItems = function(e, t) {
                    if (this._temporaryLootContextItems.has(e)) {
                        var i = this._temporaryLootContextItems.get(e).filter((function(e) {
                            return !t.includes(e)
                        }
                        ));
                        this._temporaryLootContextItems.set(e, i)
                    }
                }
                ,
                t.prototype.getRandomLoot = function(e, t, i) {
                    var n = this
                      , r = [];
                    return t.forEach((function(t) {
                        100 * Math.random() <= t.chance && (1 === t.items.length ? r.push(t.items[0].key) : r.push(n._processWeightedChanceResult(e, t.items, i)))
                    }
                    )),
                    r
                }
                ,
                t.prototype.getRandomItemFromWeightedArray = function(e, t, i) {
                    return this._processWeightedChanceResult(e, t, i)
                }
                ,
                t.prototype.getRandomContentForCrate = function() {
                    switch (this._processWeightedChanceResult("crateItemContent", this._crateWeightedArray)) {
                    case IE.OBJECT:
                        return this._processWeightedChanceResult("crateItemContentObject", this._getRandomObjectTier(), FE.CRATE);
                    case IE.REWARD_CRATE_KEY:
                        return this._processWeightedChanceResult("crateItemContentCrateKey", this._rewardCrateKeyWeightedArray);
                    case IE.REWARD_CRATE:
                        return this._processWeightedChanceResult("crateItemContentRewardCrate", this._rewardCrateWeightedArray);
                    default:
                        return "wheat_1"
                    }
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [4, De.services.lazyLoad.prioritizeGroup(hn.CONTROLLED_RANDOMNESS)];
                            case 2:
                                return e.sent(),
                                this._crateSpawnItemTierConfig = De.services.resource.getJson(_e.CONTROLLED_RANDOMNESS_ITEM_TIER_CONFIG),
                                this._getConfigs(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._crateWeightedArray = [],
                            this._coinWeightedArray = [],
                            this._gemWeightedArray = [],
                            this._rewardCrateKeyWeightedArray = [],
                            this._rewardCrateWeightedArray = [],
                            De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._processWeightedItemArray = function(e, t, i) {
                    if (this._logger.info("processing weighted array for ".concat(e)),
                    !(0,
                    r.isUndefined)(i) && this._temporaryLootContextItems.has(i)) {
                        var o = this._temporaryLootContextItems.get(i);
                        t = (0,
                        n.__spreadArray)((0,
                        n.__spreadArray)([], t, !0), o, !0)
                    }
                    for (var a = [], s = 0; s < t.length; s++) {
                        var _ = t[s];
                        if ((0,
                        r.isNumber)(_.spawnFromLevel) && De.services.experience.getLevel() < _.spawnFromLevel)
                            this._logger.info("skipping ".concat(_.key, " because the user is not at the required level"));
                        else if ((0,
                        r.isNumber)(_.unsuccessfulAttemptsThreshhold) && (0,
                        r.isNumber)(_.increaseWeightAmount)) {
                            var c = (0,
                            n.__assign)({}, this.model.getItemByContextAndKey(e, _.key));
                            c.cooldownAmount > 0 ? (a.push((0,
                            n.__assign)((0,
                            n.__assign)({}, _), {
                                weight: 0
                            })),
                            c.cooldownAmount--,
                            this._logger.info("decreasing cooldown for ".concat(_.key, " to ").concat(c.cooldownAmount))) : c.unsuccesfulAttempts < _.unsuccessfulAttemptsThreshhold - 1 ? (a.push((0,
                            n.__assign)((0,
                            n.__assign)({}, _), {
                                weight: _.weight + c.weightIncrease
                            })),
                            c.unsuccesfulAttempts++,
                            this._logger.info("increasing unsuccesful attempts for ".concat(_.key, " to ").concat(c.unsuccesfulAttempts))) : c.unsuccesfulAttempts >= _.unsuccessfulAttemptsThreshhold - 1 && (a.push((0,
                            n.__assign)((0,
                            n.__assign)({}, _), {
                                weight: _.weight + _.increaseWeightAmount + c.weightIncrease
                            })),
                            c.weightIncrease += _.increaseWeightAmount,
                            c.unsuccesfulAttempts = 0,
                            _.increaseWeightAmount > 0 && this._logger.info("increasing weight increase for ".concat(_.key, " to ").concat(c.weightIncrease, ", bringing the total weight to ").concat(_.weight + c.weightIncrease))),
                            this.model.updateItem(e, c)
                        } else
                            a.push(_)
                    }
                    return a
                }
                ,
                t.prototype._processWeightedChanceResult = function(e, t, i) {
                    var n = this._processWeightedItemArray(e, t, i)
                      , r = UE(n)
                      , o = n.find((function(e) {
                        return e.key === r
                    }
                    ));
                    return o && this._startCooldown(e, o),
                    r
                }
                ,
                t.prototype._startCooldown = function(e, t) {
                    var i = (0,
                    n.__assign)({}, this.model.getItemByContextAndKey(e, t.key))
                      , o = (0,
                    r.isNumber)(t.cooldownDuration) ? t.cooldownDuration : 0;
                    o > 0 && (this._logger.info("spawned ".concat(t.key)),
                    this._logger.info("starting cooldown for ".concat(t.key))),
                    i.cooldownAmount = o,
                    i.unsuccesfulAttempts = 0,
                    i.weightIncrease = 0,
                    this.model.updateItem(e, i)
                }
                ,
                t.prototype._getRandomObjectTier = function() {
                    var e = this
                      , t = r.ArrayUtility.getRandomItem(De.services.experience.getAvailableCrateContents().slice())
                      , i = [{
                        weight: this._crateSpawnItemTierConfig[0].weight,
                        key: t
                    }]
                      , o = De.services.blueprintGraphService.getGraphFromBlueprintID(t);
                    return o ? (o.nodes.forEach((function(o) {
                        var a;
                        if (o.ID !== t && !(0,
                        r.isUndefined)(o.tier) && (De.services.discovery.isDiscoveryMade(o.ID) || De.services.discovery.isDiscoveryUnclaimed(o.ID))) {
                            var s = null === (a = (0,
                            n.__spreadArray)([], e._crateSpawnItemTierConfig, !0).find((function(e) {
                                return e.key === "tier_" + o.tier
                            }
                            ))) || void 0 === a ? void 0 : a.weight;
                            s && i.push({
                                weight: s,
                                key: o.ID
                            })
                        }
                    }
                    )),
                    i) : (this._logger.error("couldn't get graph data"),
                    [{
                        key: "wheat_1",
                        weight: 1
                    }])
                }
                ,
                t.prototype._getConfigs = function() {
                    this._crateWeightedArray = De.services.resource.getJson(_e.CONTROLLED_RANDOMNESS_CRATE_CONFIG),
                    this._gemWeightedArray = De.services.resource.getJson(_e.CONTROLLED_RANDOMNESS_GEMS_CONFIG),
                    this._coinWeightedArray = De.services.resource.getJson(_e.CONTROLLED_RANDOMNESS_COINS_CONFIG),
                    this._rewardCrateKeyWeightedArray = De.services.resource.getJson(_e.CONTROLLED_RANDOMNESS_REWARD_CRATE_KEY_CONFIG),
                    this._rewardCrateWeightedArray = De.services.resource.getJson(_e.CONTROLLED_RANDOMNESS_REWARD_CRATE_CONFIG)
                }
                ,
                t
            }(Go), $E = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onMerge = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e = De.services.resource.getJsonCopy(_e.LUCKY_MERGE_CONFIG),
                            this._luckyMergeChance = e.CHANCE,
                            this.addFamily([Ke.MergeTrigger, Ke.Mergeable], this._onMergeTriggerAdded),
                            this.addFamily([Ke.MergeTrigger, Ke.Mergeable, Ke.ObjectDestruction], null, this._onMergeTriggerAndDestructionRemoved),
                            this.addFamily([Ke.MergeResult], this._onMergeResult),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onMergeTriggerAdded = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return t = e.getBehavior(Ke.MergeTrigger),
                            (i = this.services.mapGrid.getCell(t.cell)) && i.content ? (i.content.addBehavior(new ti({})),
                            [2]) : (e.removeBehavior(t),
                            [2])
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onMergeTriggerAndDestructionRemoved = function(e) {
                    var t = e.getBehavior(Ke.MergeTrigger)
                      , i = e.getBehavior(Ke.Mergeable)
                      , n = this.services.mapGrid.getCell(t.cell);
                    if (n && n.content && n.content === e) {
                        var r = this._getMergeableCells(t);
                        this._removeAllGameObjectsFromMergeChain(r, e);
                        var o = function(e) {
                            for (var t = Math.floor(e / 5), i = 0; i < t; i++) {
                                var n = 5 * (t - i)
                                  , r = e - n;
                                if (r % 3 == 0)
                                    return {
                                        mergeResult: n / 5 * 2 + r / 3,
                                        leftover: r % 3,
                                        bonusMerges: n / 5,
                                        normalMerges: r / 3,
                                        luckyMerges: 0
                                    }
                            }
                            return {
                                mergeResult: Math.floor(e / 3),
                                leftover: e % 3,
                                normalMerges: Math.floor(e / 3),
                                bonusMerges: 0,
                                luckyMerges: 0
                            }
                        }(r.length + 1)
                          , a = this._createGameObjectsToSpawn(o, e.getBlueprintID(), i);
                        this._handleNewGameObjects(a, n, r, e, o, i)
                    } else
                        this._logger.error("unexpected targetCell in mergeTriggerBehavior!")
                }
                ,
                t.prototype._getMergeableCells = function(e) {
                    var t = this;
                    return e.chain.map((function(e) {
                        return t.services.mapGrid.getCell(e)
                    }
                    )).filter((function(e) {
                        return void 0 !== e
                    }
                    ))
                }
                ,
                t.prototype._removeAllGameObjectsFromMergeChain = function(e, t) {
                    for (var i = 0, n = e; i < n.length; i++) {
                        var r = n[i];
                        r.content && r.content !== t && (r.content.addBehavior(new Qt({})),
                        r.content.addBehavior(new ti({})),
                        r.content.removeBehaviorByType(Ke.GridPosition))
                    }
                }
                ,
                t.prototype._handleNewGameObjects = function(e, t, i, n, r, o) {
                    var a, s = r.bonusMerges > 0, _ = r.luckyMerges > 0, c = null !== (a = o.expReward) && void 0 !== a ? a : 0, l = e[0], u = this._getObjectsIncreasedInTier(e);
                    this._handleObjectsToSpawn(e, t, r.luckyMerges, s),
                    this._addExperienceForMerge(u, o),
                    this._addSoundBehavior(l, n.getBlueprintID(), r),
                    this._reportAnalyticsGreenhouse(n, r, e),
                    this._addMergeResultBehavior(c, t, i, e, s, _, n),
                    this._emitMergeEvents(t, s),
                    this.onMerge.fire({
                        blueprintId: "string" == typeof o.target ? o.target : o.target[0].key,
                        experience: o.expReward,
                        mergeResult: r
                    }),
                    this._addSpawnedObjectsToMainView(e)
                }
                ,
                t.prototype._reportAnalyticsGreenhouse = function(e, t, i) {
                    var n = e.getObjectIdAndTier()
                      , o = n.id
                      , a = n.tier;
                    (0,
                    r.isUndefined)(a) || ("greenhouse" === o && (De.services.analytics.design.reportGreenhousePieceMerged(a),
                    "11" === a && (De.services.analytics.model.addGreenhousesCompleted(t.mergeResult),
                    De.services.analytics.design.reportGreenhouseCompleted(De.services.analytics.model.totalGreenhousesCompleted))),
                    "sapling" === o && (De.services.analytics.design.reportSaplingMerged(a),
                    "3" === a && i.forEach((function(e) {
                        var t = e.getObjectIdAndTier()
                          , i = t.id
                          , n = t.tier;
                        (0,
                        r.isUndefined)(n) || "flower" === i && De.services.analytics.design.reportFlowerSpawned(n)
                    }
                    ))))
                }
                ,
                t.prototype._emitMergeEvents = function(e, t) {
                    var i, n = null === (i = e.content) || void 0 === i ? void 0 : i.getBlueprintID(), r = De.services.blueprintGraphService.getGraphNameFromBlueprintID(n);
                    De.services.actions.emit("merge.".concat(t ? "bonus" : "normal", ".").concat(r, ".").concat(n))
                }
                ,
                t.prototype._handleObjectsToSpawn = function(e, t, i, n) {
                    // fmc
                    if (document.querySelector('#dropdown').value == 'empty') {
                        return;
                    }
                    this._handlePrimaryObjectToSpawn(e, t),
                    this._handleRemainingObjectsToSpawn(e, t, i, n)
                }
                ,
                t.prototype._handlePrimaryObjectToSpawn = function(e, t) {
                    var i = e[0];
                    i.position = this.services.axonometricProjection.getWorldPosition(t.column, t.row);
                    var n = new et({
                        rootPosition: t
                    });
                    this._worldService.addGameObject(i),
                    i.addBehavior(n)
                }
                ,
                t.prototype._handleRemainingObjectsToSpawn = function(e, t, i, n) {
                    for (var o = function(o) {
                        var s = new et({
                            rootPosition: t
                        });
                        if (i > 0 && o >= e.length - i) {
                            var _ = 0;
                            n && (_ += 1750),
                            e[o].position = a.services.axonometricProjection.getWorldPosition(t.column, t.row),
                            r.TimeDelay.after(_).promise.then((function() {
                                e[o].addBehavior(s)
                            }
                            ))
                        } else
                            e[o].addBehavior(s);
                        a._worldService.addGameObject(e[o])
                    }, a = this, s = 1; s < e.length; s++)
                        o(s)
                }
                ,
                t.prototype._getObjectsIncreasedInTier = function(e) {
                    var t = e[0];
                    return e.filter((function(e) {
                        if (e.getBlueprintID() === t.getBlueprintID())
                            return e
                    }
                    ))
                }
                ,
                t.prototype._addExperienceForMerge = function(e, t) {
                    if (t.expReward && e.length) {
                        var i = t.expReward * e.length;
                        De.services.experience.addExp(i),
                        this._logger.debug("Experience gained from merge: ".concat(i))
                    }
                }
                ,
                t.prototype._addMergeResultBehavior = function(e, t, i, n, r, o, a) {
                    var s = {
                        experience: e,
                        rootResultCell: t,
                        extraResults: i,
                        objectsToSpawn: n,
                        isBonusMerge: r,
                        isLuckyMerge: o,
                        originalContent: a
                    };
                    n[0].addBehavior(new Jt(s))
                }
                ,
                t.prototype._addSpawnedObjectsToMainView = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        De.services.discovery.isDiscoveryMade(e.getBlueprintID()) || e.addBehavior(new Hi),
                        t.services.mapGridView.getLayer(Yo.MAIN).addChild(e)
                    }
                    ))
                }
                ,
                t.prototype._onMergeResult = function(e) {
                    e.removeBehaviorByType(Ke.MergeResult)
                }
                ,
                t.prototype._createGameObjectsToSpawn = function(e, t, i) {
                    for (var n = [], o = 0; o < e.mergeResult; o++) {
                        var a = 1;
                        var s = 1;
                        // FMC
                        if (document.querySelector('#fmcAlways').checked) {
                            var s = 1;
                        } else {
                            var s = 100 * Math.random();
                        }
                        this._logger.info("LuckyRoll: ".concat(s, " \nCurrentLevelBlueprintID:").concat(t, " \nLuckyChance: ").concat(i.zeroLuckyChance)),
                        s <= this._luckyMergeChance && ((0,
                        r.isUndefined)(i.zeroLuckyChance) || !i.zeroLuckyChance) && (a++,
                        e.luckyMerges++);
                        for (var _ = 0; _ < a; _++)
                            n.push(this._getNextLevelObjectToSpawn(i))
                    }
                    for (o = 0; o < e.leftover; o++)
                        n.push(De.services.gameObjectFactory.createById(t));
                    return n
                }
                ,
                t.prototype._getNextLevelObjectToSpawn = function(e) {
                    // fmc
                    var prefixesToReplace = [
                      'wheat', 'sugarcane', 'carrot', 'soybeans', 'sunflower', 'corn', 
                      'coffee', 'tomato', 'avocado', 'chicken', 'cow', 'goat', 'pig', 
                      'sheep', 'deer', 'trufflepig'
                    ];
                    switch (document.querySelector('#dropdown').value) {
                        case 'coin_8':
                            e._data.target = 'coin_8';
                            break;
                        case 'gem_6':
                            e._data.target = 'gem_6';
                            break;
                        case 'lv4':
                            var match = e._data.target.match(/^([a-zA-Z]+)_(\d)$/);
                            if (match) {
                                const [ , prefix, number] = match;
                                if (prefixesToReplace.includes(prefix)) {
                                    e._data.target = `${prefix}_4`;
                                }
                            }
                            break;
                        case 'toolbox':
                            e._data.target = 'toolbox_large'
                            break;
                    }
                    var t = "string" == typeof e.target ? e.target : this.services.randomLoot.getRandomItemFromWeightedArray("randomMergeResultContent", e.target, FE.MERGE);
                    var i = De.services.gameObjectFactory.createById(t);
                    var n = De.services.blueprintGraphService.getGraphNameFromBlueprintID(t);
                    return De.services.actions.emit("make.".concat(n, ".").concat(t)),
                    i
                }
                ,
                t.prototype._addSoundBehavior = function(e, t, i) {
                    var n = De.services.blueprintGraphService.getNodeFromBlueprintID(t);
                    n && e.addBehavior(new Wi({
                        mergeData: {
                            isBonus: i.bonusMerges > 0,
                            tier: (null == n ? void 0 : n.tier) || -1
                        }
                    }))
                }
                ,
                t
            }(Pd), em = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._currentCell = null,
                    t._temporaryMergeTarget = null,
                    t._tooltipThreshold = 2,
                    t._tooltipCounter = 2,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.InteractionDrag, Ke.Mergeable], this._onInteractionBehaviorAdded),
                            this.addFamily([Ke.InteractionDropEnd], this._onInteractionDrop),
                            this.addFamily([Ke.InteractionTap, Ke.Mergeable], this._onInteractionTap),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._resetTooltipCounter = function() {
                    this._tooltipCounter = this._tooltipThreshold
                }
                ,
                t.prototype._showFloater = function(e) {
                    this._tooltipCounter--,
                    this._tooltipCounter > 0 || (this._resetTooltipCounter(),
                    e.addBehavior(new ui({
                        floaterType: ci.TextFloater,
                        text: nr(VE || (VE = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.MERGABLE_OBJECT_TOOLTIP_1),
                        styles: vn.warningText
                    })))
                }
                ,
                t.prototype._onInteractionTap = function(e) {
                    e.hasBehavior(Ke.Collectable) ? this._resetTooltipCounter() : this._showFloater(e)
                }
                ,
                t.prototype._onInteractionDrop = function(e) {
                    var t = e.getBehavior(Ke.InteractionDropEnd)
                      , i = null == t ? void 0 : t.data.hoverSelection;
                    (0,
                    r.isUndefined)(i) || ((null == t ? void 0 : t.data.originCell.isSameCell(i)) ? this._showFloater(e) : this._resetTooltipCounter()),
                    this._currentCell = null
                }
                ,
                t.prototype._onInteractionBehaviorAdded = function(e) {
                    var t = e.getBehavior(Ke.Mergeable)
                      , i = e.getBehavior(Ke.InteractionDrag);
                    if (null == i ? void 0 : i.data.hoverSelection) {
                        var n = i.data.hoverSelection;
                        if (this._currentCell === n)
                            return;
                        if (this._currentCell = n,
                        i.data.originCell === n)
                            this._temporaryMergeTarget && (this._removeMergeDetectionBehavior(e),
                            this._temporaryMergeTarget = null);
                        else {
                            this._removeMergeDetectionBehavior(e);
                            var r = n.content;
                            if (r) {
                                var o = r.getBehavior(Ke.Mergeable);
                                (t.targetSpecification || e.getBlueprintID()) === ((null == o ? void 0 : o.targetSpecification) || r.getBlueprintID()) && this._prepareMerge(e, n)
                            }
                        }
                    } else
                        this._removeMergeDetectionBehavior(e),
                        this._currentCell = null
                }
                ,
                t.prototype._prepareMerge = function(e, t) {
                    var i = this._getMergeChain(t);
                    if (i.length >= 2) {
                        var n = new Yt({
                            cell: t.position,
                            chain: i
                        });
                        e.replaceBehavior(n),
                        this._temporaryMergeTarget = e
                    }
                }
                ,
                t.prototype._removeMergeDetectionBehavior = function(e) {
                    var t = e.getBehavior(Ke.MergeDetection);
                    t && e.removeBehavior(t)
                }
                ,
                t.prototype._getMergeChain = function(e) {
                    if (e.content) {
                        var t = e.content.getBehavior(Ke.Mergeable);
                        if (t)
                            return this.services.gridFilter.getAdjacentObjectsWithSameID(e, t.targetSpecification)
                    }
                    return []
                }
                ,
                t
            }(Pd), tm = [{
                name: "merge_glow",
                duration: 1.4,
                repeat: -1,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0
                        }
                    }, {
                        time: 0,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0
                        }
                    }]
                }
            }], im = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._currentPreviewChain = [],
                    t._movingTweens = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._background = this.services.mapGridView.getLayer(Yo.BACKGROUD),
                            this._highlighters = new Map(Array.from({
                                length: 20
                            }, (function(t, i) {
                                return [i, e._createHighlighter()]
                            }
                            ))),
                            this._glowSprites = new Map(Array.from({
                                length: 20
                            }, (function(t, i) {
                                return [i, e._createGlow()]
                            }
                            ))),
                            this.addFamily([Ke.MergeDetection], this._onMergeDetectionAdded, this._onMergeDetectionRemoved),
                            this.addFamily([Ke.InteractionCancel], null, this._onMergeDetectionRemoved),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._highlighters.forEach((function(t) {
                                var i = t.sprite
                                  , n = t.tween;
                                e._background.removeChild(i),
                                n.dispose()
                            }
                            )),
                            this._highlighters = new Map,
                            this._glowSprites.forEach((function(e) {
                                var t = e.sprite
                                  , i = e.tween;
                                t.destroy(),
                                i.dispose()
                            }
                            )),
                            this._glowSprites = new Map,
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onMergeDetectionAdded = function(e) {
                    var t = this
                      , i = e.getBehavior(Ke.MergeDetection)
                      , n = this.services.mapGrid.getCell(i.cell)
                      , r = i.chain.map((function(e) {
                        return t.services.mapGrid.getCell(e)
                    }
                    )).filter((function(e) {
                        return void 0 !== e
                    }
                    ));
                    this.services.highlightTileService.hideHighlighter(),
                    n && this._highlightPreviewChain(n, r)
                }
                ,
                t.prototype._onMergeDetectionRemoved = function() {
                    this._highlighters.forEach((function(e) {
                        var t = e.sprite
                          , i = e.tween;
                        t.visible = !1,
                        i.pause("highlight")
                    }
                    )),
                    this._glowSprites.forEach((function(e) {
                        var t, i = e.sprite, n = e.tween;
                        null === (t = i.parent) || void 0 === t || t.removeChild(i),
                        i.texture = Xe.Texture.EMPTY,
                        n.pause("merge_glow")
                    }
                    )),
                    this._movingTweens.forEach((function(e) {
                        e.kill()
                    }
                    )),
                    this._movingTweens = [],
                    this._currentPreviewChain = [],
                    this.services.highlightTileService.showHighlighter()
                }
                ,
                t.prototype._highlightPreviewChain = function(e, t) {
                    var i = this
                      , n = e.content
                      , r = [];
                    t.forEach((function(t, o) {
                        if (t.content && (i._animateHighlighter(t.content, o),
                        i._animateGlow(t.content, o),
                        t !== e)) {
                            var a = i._animateObjectPosition(n, t.content);
                            r.push(a)
                        }
                    }
                    )),
                    this._currentPreviewChain = t,
                    this._movingTweens = r
                }
                ,
                t.prototype._createHighlighter = function() {
                    var e = this._background.addChild(rr(new AE, {
                        anchor: this.services.axonometricProjection.defaultAnchor
                    }));
                    e.visible = !1,
                    e.turnWhite();
                    var t = new ur(TE);
                    return t.setTargets({
                        highlighter: e
                    }),
                    {
                        sprite: e,
                        tween: t
                    }
                }
                ,
                t.prototype._getHighlighter = function(e) {
                    var t = this._highlighters.get(e);
                    return t || (t = this._createHighlighter(),
                    this._highlighters.set(e, t)),
                    t
                }
                ,
                t.prototype._animateHighlighter = function(e, t) {
                    var i = this._getHighlighter(t);
                    i.sprite.position.copyFrom(e.position),
                    i.sprite.visible = !0,
                    i.tween.restart("highlight")
                }
                ,
                t.prototype._animateObjectPosition = function(e, t) {
                    var i = t.getChildByName(Uv)
                      , n = {
                        originalPivot: i.pivot.clone(),
                        pivot: i.pivot,
                        angle: Math.atan2(e.y - t.y, e.x - t.x),
                        value: -1
                    };
                    return lr.gsap.to(n, {
                        value: 0,
                        duration: .4,
                        yoyo: !0,
                        repeat: 1 / 0,
                        onUpdate: function() {
                            var e = Math.cos(n.angle)
                              , t = Math.sin(n.angle);
                            n.pivot.set(e * n.value * 64, t * n.value * 64)
                        },
                        onInterrupt: function() {
                            n.pivot.set(n.originalPivot.x, n.originalPivot.y)
                        }
                    })
                }
                ,
                t.prototype._animateGlow = function(e, t) {
                    var i = e.getChildByName(Uv, !0)
                      , n = e.getChildByName(Gv, !0)
                      , r = this._getGlow(t);
                    r.sprite.blendMode = Xe.BLEND_MODES.SCREEN,
                    r.sprite.texture = n.texture,
                    r.sprite.position.copyFrom(n.position),
                    r.sprite.anchor.copyFrom(n.anchor),
                    r.sprite.pivot.copyFrom(n.pivot),
                    r.tween.restart("merge_glow"),
                    i.addChild(r.sprite)
                }
                ,
                t.prototype._getGlow = function(e) {
                    var t = this._glowSprites.get(e);
                    return t || (t = this._createGlow(),
                    this._glowSprites.set(e, t)),
                    t
                }
                ,
                t.prototype._createGlow = function() {
                    var e = new Xe.Sprite(Xe.Texture.EMPTY)
                      , t = new ur(tm);
                    return t.setTargets({
                        container: e
                    }),
                    {
                        sprite: e,
                        tween: t
                    }
                }
                ,
                t
            }(Pd), nm = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._executing = !1,
                    i._cratesSpawned = 0,
                    i._spawnCratesEvent = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._spawnCratesEvent.addListener(this._execute, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._spawnCratesEvent.removeListener(this._execute, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._execute = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return this._executing ? [2] : (t = e.position ? e.position : this.services.visibleCells.getClosestEmptyToTheCenter(!0),
                            !(i = this.services.mapGrid.getCell(t.column, t.row)) || this.services.interactionService.isHoldingObject ? (this._showNotEnoughSpaceFloater(),
                            De.services.analytics.design.cratesStatus(Zi.NO_SPACE_SHOWN),
                            [2]) : null !== i.content ? (e.position ? this._logger.warn("forcing crate spawn on non-empty cell") : this._logger.error("trying to spawn crate on non-empty cell"),
                            [2]) : (this._executing = !0,
                            this.services.visibleCells.isCellVisible(i.column, i.row, this.services.cameraService.getCameraBounds()) || this.services.cameraService.animateCameraToCell(i, 1),
                            (r = De.services.gameObjectFactory.createById("crate")).addBehavior(new Rt(t)),
                            this.services.world.addGameObject(r),
                            i.content = r,
                            De.services.inventory.spendAmount(Cn.CRATES, 1),
                            this._cratesSpawned++,
                            this._fireCrateSpawnedAnalyticsEvent(),
                            De.services.audio.playSoundEffect(m.CRATE_SPAWN),
                            this._executing = !1,
                            [2]))
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showNotEnoughSpaceFloater = function() {
                    var e = v.Vector2.fromPoint(this.services.cameraService.getCameraPosition())
                      , t = this.services.cameraService.getCameraScale();
                    e.x /= t.x,
                    e.y /= t.y,
                    new rf(this.services.mapGridView.getLayer(Yo.FLOATERS),e,{
                        text: De.services.localization.getText(ce.NOT_ENOUGH_SPACE),
                        styles: vn.warningText
                    })
                }
                ,
                t.prototype._fireCrateSpawnedAnalyticsEvent = function() {
                    this._cratesSpawned >= 10 && (this._cratesSpawned = 0,
                    De.services.analytics.design.cratesStatus(Zi.SPAWNED_10))
                }
                ,
                t
            }(Pd), rm = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Crate, Ke.GridPosition], this._onObjectSpawned),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onObjectSpawned = function(e) {
                    var t = e.getBehavior(Ke.GridPosition)
                      , i = this.services.mapGrid.getCell(t);
                    if (i) {
                        this._worldService.removeGameObject(e);
                        var n = this._generateCrateContent({
                            column: t.column,
                            row: t.row
                        });
                        i.content = n
                    } else
                        this._logger.error("could not open crate, gameobject was placed on an invalid cell!")
                }
                ,
                t.prototype._generateCrateContent = function(e) {
                    var t = this.services.crateContent.getGameObject();
                    t.addBehavior(new Rt(e)),
                    t.addBehavior(new Hi);
                    var i = new vt;
                    return t.addBehavior(i),
                    t.removeBehavior(i),
                    this.services.world.addGameObject(t),
                    this._reportAnalytics(t),
                    t
                }
                ,
                t.prototype._reportAnalytics = function(e) {
                    var t = e.getBehavior(Ke.CrateReward);
                    t && De.services.analytics.design.reportRewardedChestSpawned(t.crateRewardLevel),
                    this._reportKeySpawned(e);
                    var i = e.getBehavior(Ke.GoldenItem);
                    i && De.services.analytics.design.reportGoldenItemSpawned(i.keyType)
                }
                ,
                t.prototype._reportKeySpawned = function(e) {
                    var t = e.getBehavior(Ke.CrateRewardKey);
                    t && De.services.analytics.design.reportKeyTypeSpawned(t.keyTier)
                }
                ,
                t
            }(Pd), om = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._isListeningForOrderRewardAdded = !1,
                    i._openOrdersEvent = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.InteractionTap, Ke.Building, Ke.Workshop, Ke.InteractionPriorityTurn], this._onFamilyInteraction),
                            this._familyWorkshop = this.addFamily([Ke.Building, Ke.Workshop], this._initializeOrder),
                            this.services.ordersService.onOrderStateChange.addListener(this._onOrderChange, this),
                            this.services.ordersService.onOrderRewarded.addListener(this._onOrderRewarded, this),
                            this.services.ordersService.onNewOrder.addListener(this._onOrderChange, this),
                            this._openOrdersEvent.addListener(this._onOrderButtonClick, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.ordersService.onOrderStateChange.removeListener(this._onOrderChange, this),
                            this.services.ordersService.onOrderRewarded.removeListener(this._onOrderRewarded, this),
                            this.services.ordersService.onNewOrder.removeListener(this._onOrderChange, this),
                            this._openOrdersEvent.removeListener(this._onOrderButtonClick, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._initializeOrder = function(e) {
                    var t = e.getBehavior(Ke.Building)
                      , i = this.services.ordersService.getOrderByBuilding(t.ID);
                    i && e.addBehavior(new ii({
                        order: i
                    }))
                }
                ,
                t.prototype._onFamilyInteraction = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            if (e.getBehavior(Ke.InteractionPriorityTurn).group !== Fd.ORDER)
                                return [2];
                            if (t = e.getBehavior(Ke.Building),
                            i = e.hasBehavior(Ke.Upgrade),
                            t && !i && (r = t.ID)) {
                                if (!(o = e.getBehavior(Ke.Order)))
                                    return [2];
                                o.order.state === ps.COMPLETE ? this.services.ordersService.rewardOrder(r) : De.services.buildings.isBuildingInCoolDownState(r) || this.services.ordersService.openOrdersPopup(r)
                            }
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onOrderRewarded = function(e) {
                    var t = this
                      , i = this._familyWorkshop.getGameObjects()
                      , n = De.services.recipes.getRecipe(e.recipe).reward
                      , r = i.find((function(t) {
                        return t.getBehavior(Ke.Building).ID === e.buildingID
                    }
                    ));
                    if (!r)
                        throw new Error("BuildingOrdersSystem: can't give rewards because building ".concat(e.buildingID, " doesn't exist"));
                    var o = r.getBehavior(Ke.GridPosition);
                    if (!o)
                        throw new Error("BuildingOrdersSystem: can't give rewards because building has no grid position");
                    De.services.navigation.isPopupTypeOpen(Ic) ? this._isListeningForOrderRewardAdded || (De.services.navigation.onPopupClosed.listenOnce((function() {
                        t._spawnOrderReward(r, n, o, e),
                        t._isListeningForOrderRewardAdded = !1
                    }
                    ), this),
                    this._isListeningForOrderRewardAdded = !0) : this._spawnOrderReward(r, n, o, e)
                }
                ,
                t.prototype._spawnOrderReward = function(e, t, i, r) {
                    var o = this;
                    this.services.gridFilter.getEmptyCells().length < t.length ? e.addBehavior(new ui({
                        floaterType: ci.TextFloater,
                        text: nr(HE || (HE = (0,
                        n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.NOT_ENOUGH_SPACE_REWARDS, t.length),
                        styles: vn.warningText
                    })) : (t.forEach((function(e) {
                        var t = De.services.gameObjectFactory.createById(e)
                          , n = new et({
                            rootPosition: i
                        });
                        t.addBehavior(n),
                        t.addBehavior(new Oi),
                        t.addBehavior(new Hi),
                        o._worldService.addGameObject(t),
                        o.services.mapGridView.getLayer(Yo.MAIN).addChild(t)
                    }
                    )),
                    this.services.ordersService.consumeOrder(r.buildingID),
                    e.removeBehaviorByType(Ke.Order),
                    this._callInterstitialAd())
                }
                ,
                t.prototype._onOrderChange = function(e) {
                    for (var t = 0, i = this._familyWorkshop.getGameObjects(); t < i.length; t++) {
                        var n = i[t]
                          , r = n.getBehavior(Ke.Building);
                        r && r.ID === e.buildingID && n.replaceBehavior(new ii({
                            order: e
                        }))
                    }
                }
                ,
                t.prototype._callInterstitialAd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return Un() && De.services.analytics.tests.group === xn.TestGroupB ? (this._logger.warn("Interstitial ad not shown because of A/B test group B"),
                                [2]) : [4, r.TimeDelay.after(1e3).promise];
                            case 1:
                                return e.sent(),
                                De.services.adsService.showInterstitialAd("orders"),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onOrderButtonClick = function() {
                    De.services.buildings.areAllBuildingsInCoolDownState() || this.services.ordersService.openOrdersPopup()
                }
                ,
                t
            }(Pd), am = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._activePreviews = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Workshop, Ke.Building, Ke.GridPosition, Ke.Order], this._onOrderStateChange, this._hidePreview),
                            this.addFamily([Ke.FriendReward], this._onFriendRewardAdded, this._onFriendRewardRemoved),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onOrderStateChange = function(e) {
                    var t, i = e.getBehavior(Ke.Order);
                    if (i) {
                        var r = (0,
                        n.__assign)({}, i.order)
                          , o = e.getBehavior(Ke.GridPosition);
                        o ? this._activePreviews.get(r.buildingID) ? null === (t = this._activePreviews.get(r.buildingID)) || void 0 === t || t.onStateChanged(r) : this._createNewPreview(e, o, r.buildingID, r) : this._hidePreview(e)
                    }
                }
                ,
                t.prototype._createNewPreview = function(e, t, i, n) {
                    var r = this;
                    if (!e.hasBehavior(Ke.FriendReward)) {
                        var o = this.services.mapGrid.getCell(t.column - 2, t.row - 2)
                          , a = new Md(n,this.services.axonometricProjection.getWorldPosition(t.column, t.row),o);
                        a.show(),
                        this.services.mapGridView.getLayer(Yo.POPOUTS).addChild(a),
                        a.onClick.addListener((function() {
                            r.services.onboarding.activeTrackKey && r.services.onboarding.activeTrackKey !== Lo.ORDER_TRACK_1 && r.services.onboarding.activeTrackKey !== Lo.ORDER_TRACK_2 && r.services.onboarding.activeTrackKey !== Lo.ORDER_TRACK_3 || (n.state === ps.COMPLETE ? r.services.ordersService.rewardOrder(i) : r.services.ordersService.openOrdersPopup(i))
                        }
                        ), this),
                        this._activePreviews.set(i, a)
                    }
                }
                ,
                t.prototype._hidePreview = function(e) {
                    var t = e.getBehavior(Ke.Building);
                    if (t && !e.hasBehavior(Ke.Upgrade)) {
                        var i = this._activePreviews.get(t.ID);
                        i && (i.destroy(),
                        this._activePreviews.delete(t.ID))
                    }
                }
                ,
                t.prototype._onFriendRewardAdded = function(e) {
                    var t = e.getBehavior(Ke.Building);
                    if (t) {
                        if (!this._activePreviews.get(t.ID))
                            return;
                        this._hidePreview(e)
                    }
                }
                ,
                t.prototype._onFriendRewardRemoved = function(e) {
                    this._onOrderStateChange(e)
                }
                ,
                t
            }(Pd), sm = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n._enoughResources = !1,
                    n.data = t,
                    n._helpIconPressed = i,
                    n._prepare(),
                    n
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "data", {
                    get: function() {
                        return this._data
                    },
                    set: function(e) {
                        this._data = e,
                        this._enoughResources = e.currentAmount >= e.totalRequired,
                        this._updateVisuals()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype._prepare = function() {
                    var e = this
                      , t = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN02_9SLICE),10,10,10,10);
                    t.setSizes({
                        width: 168,
                        height: 168
                    }),
                    t.anchor.set(.5),
                    this.addChild(t);
                    var i = rr(De.services.resource.getSprite(this._data.image), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: t.width / 2,
                            y: t.height / 2
                        }
                    })
                      , n = 1
                      , r = i.width + 20;
                    r > t.width ? n = t.width / r : r < 125 && (n = 125 / r),
                    i.scale.set(n),
                    t.addChild(i);
                    var o = this._data.currentAmount + "/" + this._data.totalRequired;
                    if (this._text = new Xe.Text(String(o),this._enoughResources ? vn.lightSmall : vn.darkSmall),
                    this._text.position.set(t.position.x, t.position.y + (t.height / 2 + this._text.height / 2 + 10)),
                    this._text.anchor.set(.5),
                    this._pillBox = new cr(De.services.resource.getTexture(f.BG_COUNTER_ORDERTRACKING),30,0,30,0),
                    this._pillBox.setSizes({
                        width: this._text.width + 50,
                        height: this._pillBox.height
                    }),
                    this._pillBox.position.set(this._text.position.x, this._text.position.y),
                    this._pillBox.anchor.set(.5),
                    this.addChild(this._pillBox),
                    this._enoughResources ? this._pillBox.visible = !0 : this._pillBox.visible = !1,
                    this.addChild(this._text),
                    this._helpIconPressed) {
                        var a = rr(De.services.resource.getSprite(f.ICON_HELP), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: t.width - 10,
                                y: 0
                            }
                        });
                        t.addChild(a),
                        a.interactive = !0,
                        a.addListener("pointertap", (function() {
                            var t;
                            null === (t = e._helpIconPressed) || void 0 === t || t.fire(e._data.objectName)
                        }
                        ))
                    }
                }
                ,
                t.prototype._updateVisuals = function() {
                    if (this._text) {
                        var e = this._data.currentAmount + "/" + this._data.totalRequired;
                        this._text.text = e,
                        this._text.style = this._enoughResources ? vn.lightSmall : vn.darkSmall,
                        this._enoughResources ? this._pillBox.visible = !0 : this._pillBox.visible = !1
                    }
                }
                ,
                t
            }(Xe.Container), _m = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    i.onButtonAction = new r.Event,
                    i.onHelpIconPressed = new r.Event,
                    i._requirementUICards = [],
                    i._options = t,
                    i._requirements = i._options.requirements;
                    var n = i._createOpenContainer();
                    return n.position.y += 50,
                    i._openContainer.addChild(n),
                    De.services.localization.onLanguageChanged.addListener(i._updateTexts, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "requirements", {
                    get: function() {
                        return this._requirements
                    },
                    set: function(e) {
                        this._requirements = e,
                        this._updateVisuals()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    De.services.localization.onLanguageChanged.removeListener(this._updateTexts, this)
                }
                ,
                t.prototype._createOpenContainer = function() {
                    var e = this
                      , t = new Xe.Container;
                    return this._title = new Xe.Text(De.services.localization.getText(this._options.titleText),vn.lightMedium),
                    this._title.anchor.set(.5, .5),
                    t.addChild(this._title),
                    this._button = new fr({
                        name: "requirements_".concat(this._options.buttonCTA),
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 345,
                            height: 85
                        }
                    },{
                        text: this._options.buttonCTA,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    }),
                    this._button.position.set(0, this._background.height - (this._button.height + 25)),
                    this._button.onClick((function() {
                        e.onButtonAction.fire()
                    }
                    )),
                    t.addChild(this._button),
                    this._requirements.forEach((function(i, n) {
                        var r = new sm(i,e.onHelpIconPressed)
                          , o = -e._requirements.length / 2 * 188 + 94 + 188 * n;
                        r.position.set(o, e._button.position.y - 200),
                        t.addChild(r),
                        e._requirementUICards.push(r)
                    }
                    )),
                    t
                }
                ,
                t.prototype._updateVisuals = function() {
                    var e = this;
                    0 !== this._requirementUICards.length && this._requirements.forEach((function(t) {
                        var i = e._requirementUICards.find((function(e) {
                            return e.data.objectName === t.objectName
                        }
                        ));
                        i && (i.data = t)
                    }
                    ))
                }
                ,
                t.prototype._updateTexts = function() {
                    this._title.text = De.services.localization.getText(this._options.titleText),
                    this._title.style.fontFamily = vn.currentFontFamily,
                    this._button.updateText(De.services.localization.getText(this._options.buttonCTA)),
                    this._button.updateTextStyle({
                        fontFamily: vn.currentFontFamily
                    })
                }
                ,
                t
            }(Gd), cm = function(e) {
                function t(t) {
                    return e.call(this, t) || this
                }
                return (0,
                n.__extends)(t, e),
                t
            }(_m), lm = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._popoutStore = new zd,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._buildingsService = De.services.buildings,
                            this.addFamily([Ke.Upgrade, Ke.InteractionTap, Ke.Building, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onInteractionAdded),
                            this._buildingFamily = this.addFamily([Ke.Upgrade, Ke.Building, Ke.GridPosition], this._createPopout, this._removePopout),
                            this.services.mapGrid.onContentAdded.addListener(this._updatePopouts, this),
                            this.services.mapGrid.onContentRemoved.addListener(this._updatePopouts, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.mapGrid.onContentAdded.removeListener(this._updatePopouts, this),
                            this.services.mapGrid.onContentRemoved.removeListener(this._updatePopouts, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onInteractionAdded = function(e) {
                    if (e.getBehavior(Ke.InteractionPriorityTurn).group === Fd.UPGRADE_BUILDING) {
                        var t = e.getBehavior(Ke.GridPosition)
                          , i = this._popoutStore.get(t);
                        i ? this.services.popout.showPopout(i) : this._createPopout(e)
                    }
                }
                ,
                t.prototype._onRepairPopoutPressed = function(e, t) {
                    var i = e.getBehavior(Ke.Upgrade)
                      , n = e.getBehavior(Ke.Building);
                    i && n && this._checkItemsOnTheField(e) ? (t.onButtonAction.removeAllListeners(),
                    this._removeItemsFromGrid(i.objectCost),
                    this._buildingsService.setBuildingActive(n.ID),
                    e.removeBehaviorByType(Ke.Upgrade)) : this.services.popout.hidePopout(t)
                }
                ,
                t.prototype._checkItemsOnTheField = function(e) {
                    var t = this
                      , i = e.getBehavior(Ke.Upgrade)
                      , r = e.getBehavior(Ke.GridPosition);
                    if (!this.services.gridFilter.hasEnoughItems(i.objectCost)) {
                        var o = i.objectCost.find((function(e) {
                            var i = e.blueprintID
                              , n = e.amount;
                            return t.services.gridFilter.getBlueprintCount(i) < n
                        }
                        ))
                          , a = void 0
                          , s = void 0;
                        switch (De.services.blueprintGraphService.getGraphNameFromBlueprintID(o.blueprintID)) {
                        case "wood":
                            a = Cn.WOOD,
                            s = ce.RESOURCE_WOOD;
                            break;
                        case "stone":
                        default:
                            a = Cn.STONE,
                            s = ce.RESOURCE_STONE;
                            break;
                        case "tool":
                            a = In.TOOLS,
                            s = ce.RESOURCE_TOOLS
                        }
                        var _ = this.services.gridFilter.findClosestSourceOf(a, r);
                        if (_ && _.content) {
                            var c = new Li({});
                            _.content.hasBehavior(Ke.ArrowPointer) || _.content.addBehavior(c),
                            this.services.cameraService.animateCameraToCell(_)
                        } else {
                            var l = nr(jE || (jE = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), s);
                            new rf(this.services.mapGridView.getLayer(Yo.PREVIEW_UI),e.position.clone(),{
                                text: nr(KE || (KE = (0,
                                n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.INSUFFICIENT_RESOURCES, l),
                                styles: vn.warningText
                            })
                        }
                        return !1
                    }
                    return !0
                }
                ,
                t.prototype._removeItemsFromGrid = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        for (var i = e.blueprintID, n = e.amount, r = t.services.gridFilter.getCellsWithBlueprint(i), o = 0; o < n; o++) {
                            var a = r[o]
                              , s = t.services.mapGrid.getCell(a.column, a.row);
                            (null == s ? void 0 : s.content) && t._worldService.removeGameObject(s.content)
                        }
                    }
                    ))
                }
                ,
                t.prototype._createPopout = function(e) {
                    var t = this
                      , i = e.getBehavior(Ke.Upgrade)
                      , n = [];
                    i.objectCost.forEach((function(e) {
                        var i = e.blueprintID
                          , r = e.amount;
                        n.push({
                            objectName: i,
                            image: us(i),
                            totalRequired: r,
                            currentAmount: t.services.gridFilter.getBlueprintCount(i)
                        })
                    }
                    ));
                    var r = new cm({
                        basePopoutType: Bd.OPEN_ONLY,
                        expansionWidth: 590,
                        expansionHeight: 476,
                        requirements: n,
                        titleText: ce.REQUIREMENTS,
                        buttonCTA: ce.REPAIR_BUTTON_TEXT
                    });
                    r.onClick.addListener(this._simulateClick.bind(this, e), this),
                    r.onButtonAction.addListener((function() {
                        return t._onRepairPopoutPressed(e, r)
                    }
                    ), this),
                    r.onHelpIconPressed.addListener((function(i) {
                        return t._openDiscoveryPopup(i, e)
                    }
                    ), this);
                    var o = e.getBehavior(Ke.GridPosition);
                    return r.position.copyFrom(this.services.axonometricProjection.getWorldPosition(o.column, o.row)),
                    r.position.y -= 120,
                    this.services.popout.registerPopout(r),
                    r.requirements.every((function(e) {
                        return e.currentAmount >= e.totalRequired
                    }
                    )) && this.services.popout.showPopout(r),
                    this._popoutStore.add(o, r)
                }
                ,
                t.prototype._updatePopouts = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return t.sent(),
                                this._buildingFamily.forEach((function(t) {
                                    var i = t.getBehavior(Ke.GridPosition)
                                      , r = e._popoutStore.get(i);
                                    if (r) {
                                        var o = r.requirements.every((function(e) {
                                            return e.currentAmount >= e.totalRequired
                                        }
                                        ));
                                        r.requirements = e._updateRequirements((0,
                                        n.__spreadArray)([], r.requirements, !0));
                                        var a = r.requirements.every((function(e) {
                                            return e.currentAmount >= e.totalRequired
                                        }
                                        ));
                                        !o && a && (e.services.popout.showPopout(r),
                                        e.services.cameraService.animateCameraToCell(e.services.mapGrid.getCell(i))),
                                        !a && o && e.services.popout.hidePopout(r)
                                    }
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateRequirements = function(e) {
                    var t = this;
                    return e.forEach((function(e) {
                        e.currentAmount = t.services.gridFilter.getBlueprintCount(e.objectName)
                    }
                    )),
                    e
                }
                ,
                t.prototype._removePopout = function(e) {
                    var t = e.getBehavior(Ke.GridPosition)
                      , i = this._popoutStore.remove(t);
                    i && (this.services.popout.unregisterPopout(i),
                    i.destroy())
                }
                ,
                t.prototype._simulateClick = function(e) {
                    this.services.interactionHelper.simulateClick.fire(e)
                }
                ,
                t.prototype._openDiscoveryPopup = function(e, t) {
                    this._removePopout(t),
                    De.services.discovery.openDiscoveryPopup(this.services.upgradeCard, e)
                }
                ,
                t
            }(Pd), um = function(e, t, i) {
                void 0 === i && (i = !0);
                for (var n = [], r = e.column; r > e.column - t.width; r--)
                    for (var o = e.row; o > e.row - t.height; o--)
                        r === e.column && o === e.row && i || n.push({
                            row: o,
                            column: r
                        });
                return n
            }, dm = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._activePreviews = new Map,
                    t._activeAnimations = new Map,
                    t._previouslyAssignedObjects = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Lootable, Ke.GridPosition, Ke.InteractionPriorityTurn], this._showPreview),
                            this.addFamily([Ke.Lootable, Ke.GridPosition, Ke.InteractionPick], this._hidePreview),
                            this.addFamily([Ke.LootTrigger, Ke.GridPosition], this._showPreview),
                            this.addFamily([Ke.Lootable, Ke.GridPosition], void 0, this._hidePreview),
                            this.addFamily([Ke.Lootable, Ke.AutoPlace], this._hidePreview),
                            this.addFamily([Ke.Lootable, Ke.InteractionPriorityTurn, Ke.NotEnoughSpace], this._onNotEnoughSpace),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showPreview = function(e) {
                    var t = this
                      , i = e.getBehavior(Ke.Lootable)
                      , n = 0;
                    if (e.getBehavior(Ke.InteractionPriorityTurn).group === Fd.LOOT && !this._activePreviews.has(e)) {
                        this._previouslyAssignedObjects.includes(e) || e.getBehavior(Ke.MapSource) || (n = 1.5,
                        this._previouslyAssignedObjects.push(e));
                        var r = e.hasBehavior(Ke.Source)
                          , o = new oh({
                            iconSprite: this._getPreviewImage(i),
                            isNature: r
                        });
                        o.onClick.addListener((function() {
                            t._onPreviewTapped(e),
                            t._sendAnalytics(e)
                        }
                        ), this),
                        this.services.mapGridView.getLayer(Yo.POPOUTS).addChild(o);
                        var a = this._getPreviewPosition(e);
                        o.position.copyFrom(a),
                        o.show(!0, n),
                        this._activePreviews.set(e, o)
                    }
                }
                ,
                t.prototype._getPreviewPosition = function(e) {
                    var t, i = e.getBehavior(Ke.GridPosition), n = e.getBehavior(Ke.ExtendedTile);
                    if (n) {
                        var r = um(i, n, !0)
                          , o = r[r.length - 1];
                        (t = this.services.axonometricProjection.getWorldPosition(o.column, o.row)).x += n.popoutXOffset,
                        t.y -= n.popoutYOffset
                    } else
                        t = this.services.axonometricProjection.getWorldPosition(i.column, i.row);
                    return t
                }
                ,
                t.prototype._hidePreview = function(e) {
                    var t = this._activePreviews.get(e);
                    t && (t.hide(!0, !0),
                    this._activePreviews.delete(e))
                }
                ,
                t.prototype._getPreviewImage = function(e) {
                    var t, i = f.OVERLAY_BONUS_FRIEND, n = e.loot[0];
                    if (!n)
                        throw new Error("LootablePreviewSystem: lootable has no loot!");
                    return "crate" === n.split("_")[0] ? i = f.ICON_TASKS_OPEN_SUPPLIES : (t = De.services.blueprintCollection.getBlueprint(n).components.sprite || {}).alias && (i = {
                        alias: t.alias
                    }),
                    De.services.resource.getSprite(i)
                }
                ,
                t.prototype._onPreviewTapped = function(e) {
                    this.services.interactionHelper.simulateClick.fire(e)
                }
                ,
                t.prototype._onNotEnoughSpace = function(e) {
                    var t = this._activePreviews.get(e);
                    t && function(e, t, i) {
                        t.interactive = !1;
                        var n = i.get(e);
                        n && (n.dispose(),
                        i.delete(e)),
                        n = new ur(B_),
                        i.set(e, n),
                        n.setTargets({
                            container: t
                        }),
                        n && (n.onEnd.addListener((function(e) {
                            "fadeIn" === e && (n && n.dispose(),
                            t.interactive = !0)
                        }
                        ), null),
                        n.play("halfFadeOut"),
                        n.play("fadeIn", 5))
                    }(e, t, this._activeAnimations)
                }
                ,
                t.prototype._sendAnalytics = function(e) {
                    e.hasBehavior(Ke.MapSource) && De.services.analytics.design.workOnNature(Qi.COLLECT)
                }
                ,
                t
            }(Pd), hm = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onItemLoot = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Lootable, Ke.InteractionTap, Ke.InteractionPriorityTurn], this._onInteractionAdded),
                            this.addFamily([Ke.Lootable, Ke.LootTrigger, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onLootTriggerAdded),
                            this.addFamily([Ke.NotEnoughSpace, Ke.InteractionPriorityTurn], this._onNotEnoughSpace),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onInteractionAdded = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e.getBehavior(Ke.InteractionPriorityTurn).group !== Fd.LOOT || (e.addBehavior(new ji({})),
                            this._reportAnalyticsLootableClicked(e)),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onLootTriggerAdded = function(e) {
                    var t = e.getBehavior(Ke.Lootable)
                      , i = e.getBehavior(Ke.GridPosition)
                      , n = this.services.gridFilter.getEmptyCells().length
                      , r = t.loot.concat([]);
                    if (e.removeBehaviorByType(Ke.LootTrigger),
                    e.getBlueprintID().includes("upgrade_card")) {
                        var o = e.getTier();
                        o && De.services.analytics.design.reportUpgradeCardSold(o)
                    }
                    if (0 !== n) {
                        for (var a = []; n > 0 && r.length > 0; ) {
                            this._spawnLootObject(r[0], {
                                column: i.column,
                                row: i.row
                            });
                            var s = r.shift();
                            a.push(s),
                            n--
                        }
                        if (0 === r.length) {
                            var _ = new Ht;
                            e.addBehavior(_),
                            e.removeBehavior(t),
                            De.services.actions.emit("lootObject.".concat(e.getBlueprintID()))
                        } else {
                            var c = new jt({
                                loot: r
                            });
                            e.replaceBehavior(c),
                            e.addBehavior(new ei({
                                spaceNeeded: r.length
                            }))
                        }
                        this.onItemLoot.fire({
                            loot: a
                        })
                    } else
                        e.addBehavior(new ei({
                            spaceNeeded: r.length
                        }))
                }
                ,
                t.prototype._spawnLootObject = function(e, t) {
                    var i = De.services.gameObjectFactory.createById(e);
                    this._worldService.addGameObject(i),
                    i.addBehavior(new Oi);
                    var n = new et({
                        rootPosition: t
                    });
                    i.addBehavior(n),
                    i.addBehavior(new Hi),
                    this.services.mapGridView.getLayer(Yo.MAIN).addChild(i)
                }
                ,
                t.prototype._onNotEnoughSpace = function(e) {
                    var t = e.getBehavior(Ke.NotEnoughSpace);
                    t && (e.addBehavior(new ui({
                        floaterType: ci.TextFloater,
                        text: nr(WE || (WE = (0,
                        n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.NOT_ENOUGH_SPACE_REWARDS, t.spaceNeeded),
                        styles: vn.warningText,
                        positionOffset: new Xe.Point(0,-80)
                    })),
                    e.removeBehavior(t))
                }
                ,
                t.prototype._reportAnalyticsLootableClicked = function(e) {
                    De.services.analytics.design.harvestTap(),
                    "greenhouse" === e.getBlueprintID() && De.services.analytics.design.reportGreenhouseHarvest();
                    var t = e.getBehavior(Ke.MapSource);
                    t && t.sourceType === Kt.TOOLBOX && De.services.analytics.design.reportToolSpawned()
                }
                ,
                t
            }(Pd), pm = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onItemHarvest = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._harvestFamily = this.addFamily([Ke.Harvestable], this._onHarvestAdded),
                            this.addFamily([Ke.Harvestable, Ke.CooldownFinishedTrigger, Ke.GridPosition], this._onCooldownRemoved),
                            this.addFamily([Ke.Harvestable, Ke.LootReceived, Ke.GridPosition], this._onLootReceived),
                            this.addFamily([Ke.Harvestable, Ke.ResourceGatePaid, Ke.GridPosition], this._resourceGateRemoved),
                            this.services.upgradeCard.itemGradeUpgraded.addListener(this._onItemGradeUpgraded, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.upgradeCard.itemGradeUpgraded.removeListener(this._onItemGradeUpgraded, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onLootReceived = function(e) {
                    var t = e.getBehavior(Ke.Harvestable)
                      , i = e.getBehavior(Ke.LootReceived)
                      , n = e.getBehavior(Ke.GridPosition)
                      , r = e.getBehavior(Ke.Hitpoints);
                    r && (r.current > 1 ? this._handleHarvest(e, t, r, n) : this._removeObject(e),
                    e.removeBehavior(i))
                }
                ,
                t.prototype._handleHarvest = function(e, t, i, n) {
                    var r = e.hasBehavior(Ke.Animal)
                      , o = e.hasBehavior(Ke.Crop)
                      , a = new Pt({
                        startAsVisible: !(o || r) && i.current - 1 == 1,
                        current: i.current - 1,
                        max: 1
                    });
                    if (e.replaceBehavior(t.isUnlimited ? i : a),
                    1 === a.current)
                        this._switchSprite(e, t.sprite.dead),
                        e.addBehavior(new mt),
                        this._addLootable(e, t.removeReward);
                    else {
                        var s = {
                            column: n.column,
                            row: n.row
                        };
                        this._switchSprite(e, t.sprite.regeneration),
                        this._addCooldown(e, t.duration, s),
                        this._scheduleGamebotMessage(e, 1e3 * t.duration, s)
                    }
                    this.onItemHarvest.fire({
                        blueprintId: e.getBlueprintID(),
                        hitpoints: a.current
                    }),
                    De.services.actions.emit("harvest.".concat(e.getBlueprintID()))
                }
                ,
                t.prototype._serializeGameObjectDataForGamebot = function(e, t) {
                    return "".concat(t.column, "-").concat(t.row)
                }
                ,
                t.prototype._onHarvestAdded = function(e) {
                    var t = e.getBehavior(Ke.Harvestable)
                      , i = e.getBehavior(Ke.Hitpoints);
                    if (e.hasBehavior(Ke.CoolDown))
                        i ? (e.addBehavior(new _t),
                        1 === i.current ? this._switchSprite(e, t.sprite.dead) : this._switchSprite(e, t.sprite.regeneration)) : this._logger.error("Harvestable object is on cooldown but has no hitpoints");
                    else if (e.hasBehavior(Ke.Lootable))
                        i && 1 === i.current && this._switchSprite(e, t.sprite.dead);
                    else if (i || (i = new Pt({
                        current: t.harvests + 1,
                        max: 1
                    }),
                    e.addBehavior(i)),
                    e.addBehavior(new kt({})),
                    i.current > 1) {
                        var n = De.services.blueprintGraphService.getCollectItemFromBlueprint(e.getBlueprintID())
                          , r = n ? this.services.upgradeCard.model.getItemTier(n) : 0;
                        this._addLootable(e, this.services.randomLoot.getRandomLoot(e.getBlueprintID(), t.harvestReward[r], this._getLootContext(e)))
                    } else
                        this._switchSprite(e, t.sprite.dead)
                }
                ,
                t.prototype._onItemGradeUpgraded = function(e) {
                    var t = this;
                    this._harvestFamily.getGameObjects().forEach((function(e) {
                        var i = e.getBehavior(Ke.Harvestable)
                          , n = e.getBehavior(Ke.Hitpoints);
                        if (e.hasBehavior(Ke.Lootable)) {
                            if (n && 1 === n.current)
                                return;
                            var r = De.services.blueprintGraphService.getCollectItemFromBlueprint(e.getBlueprintID())
                              , o = r ? t.services.upgradeCard.model.getItemTier(r) : 0;
                            t._addLootable(e, t.services.randomLoot.getRandomLoot(e.getBlueprintID(), i.harvestReward[o], t._getLootContext(e)))
                        }
                    }
                    ))
                }
                ,
                t.prototype._onCooldownRemoved = function(e) {
                    e.removeBehaviorByType(Ke.CooldownFinishedTrigger);
                    var t = e.getBehavior(Ke.Harvestable)
                      , i = e.getBehavior(Ke.Hitpoints)
                      , n = e.getBehavior(Ke.GridPosition);
                    if (i.current > 1) {
                        var r = De.services.blueprintGraphService.getCollectItemFromBlueprint(e.getBlueprintID())
                          , o = r ? this.services.upgradeCard.model.getItemTier(r) : 0;
                        this._addLootable(e, this.services.randomLoot.getRandomLoot(e.getBlueprintID(), t.harvestReward[o], this._getLootContext(e))),
                        this._switchSprite(e, t.sprite.normal),
                        this._logger.info("".concat(e.getBlueprintID(), " is ready for harvest!"))
                    } else
                        this._addLootable(e, t.removeReward);
                    De.services.notifications.cancelMessage(Vr.RESOURCE_READY_FOR_HARVEST, this._serializeGameObjectDataForGamebot(e, {
                        column: n.column,
                        row: n.row
                    }))
                }
                ,
                t.prototype._resourceGateRemoved = function(e) {
                    e.removeBehaviorByType(Ke.ResourceGatePaid);
                    var t = e.getBehavior(Ke.GridPosition);
                    e.removeBehaviorByType(Ke.HitpointsPreview);
                    var i = e.getBehavior(Ke.Harvestable);
                    this._addCooldown(e, i.removalCost.duration, {
                        column: t.column,
                        row: t.row
                    })
                }
                ,
                t.prototype._addCooldown = function(e, t, i) {
                    var n = De.services.timer.addTimer(1e3 * t, "Cooldown:".concat(i.column, ",").concat(i.row));
                    e.replaceBehavior(new at({
                        timerId: n.id
                    })),
                    e.replaceBehavior(new _t)
                }
                ,
                t.prototype._switchSprite = function(e, t) {
                    var i = e.getBehavior(Ke.Sprite);
                    if (i && i.asset.alias !== t.alias) {
                        var n = new vi({
                            alias: t.alias,
                            pivot: i.pivot,
                            anchor: i.anchor,
                            offset: t.offset,
                            hitArea: i.hitArea
                        });
                        e.replaceBehavior(n)
                    }
                }
                ,
                t.prototype._addLootable = function(e, t) {
                    var i = new jt({
                        loot: t
                    });
                    e.replaceBehavior(i),
                    De.services.audio.playSoundEffect(m.POPOUT_APPEARS)
                }
                ,
                t.prototype._removeObject = function(e) {
                    e.addBehavior(new ti({}))
                }
                ,
                t.prototype._scheduleGamebotMessage = function(e, t, i) {
                    if (e.getBehavior(Ke.Sprite)) {
                        var r = De.services.gameObjectFactory.getMeaningfulCroppedName(e.getBlueprintID());
                        if (nr(zE || (zE = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), {
                            alias: r
                        })) {
                            var o = this._serializeGameObjectDataForGamebot(e, i);
                            De.services.notifications.createMessageForResourceHarvest(r, t, o)
                        } else
                            this._logger.error('Unable to localize the product "'.concat(r, '" with blueprint "').concat(e.getBlueprintID(), '". Gamebot message cannot be sent!'))
                    } else
                        this._logger.error("no sprite behavior to use fo scheduling gamebot mesage")
                }
                ,
                t.prototype._getLootContext = function(e) {
                    return e.hasBehavior(Ke.Crop) ? FE.CROP : FE.ANIMAL
                }
                ,
                t
            }(Pd), vm = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onItemCollect = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Collectable, Ke.InteractionTap], this._onObjectClicked),
                            this.addFamily([Ke.Collectable, Ke.InteractionTap, Ke.InteractionPriorityTurn], this._collectObject),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onObjectClicked = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return t = e.getBehavior(Ke.Collectable),
                            Object.values(Sn).includes(t.reward[0].key) ? (i = e.getBehavior(Ke.GridPosition),
                            (null == (r = this.services.mapGrid.getCell(i.column, i.row)) ? void 0 : r.content) ? (this.services.gridFilter.getObjectsWithSameID(r.content.getBlueprintID()).forEach((function(e) {
                                var t;
                                return e.content && !(null === (t = e.content) || void 0 === t ? void 0 : t.hasBehavior(Ke.InteractionTap)) ? o.services.interactionHelper.simulateClick.fire(e.content) : {}
                            }
                            )),
                            [2]) : [2]) : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._collectObject = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return e.getBehavior(Ke.InteractionPriorityTurn).group !== Fd.COLLECT || (t = e.getBehavior(Ke.Collectable)) && (t.reward.forEach((function(t) {
                                De.services.inventory.addAmount(t.key, t.amount, !1),
                                e.addBehavior(new ui({
                                    floaterType: ci.RewardFloater,
                                    amount: t.amount,
                                    styles: vn.lightMedium,
                                    icon: za[t.key] || Ja[t.key]
                                })),
                                De.services.actions.emit("collect.".concat(t.key, ".").concat(e.getBlueprintID()))
                            }
                            )),
                            e.addBehavior(new ti({})),
                            this.onItemCollect.fire({
                                blueprintId: e.getBlueprintID(),
                                rewards: t.reward
                            })),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Pd), gm = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this.addFamily([Ke.WorkerData, Ke.CoolDown, Ke.GridPosition], null, this._removeWorker),
                            this.addFamily([Ke.MapSource, Ke.CoolDown, Ke.GridPosition], this._addWorker),
                            this.services.gridFilter.getFilledCellsWithBehaviors([Ke.WorkerData]).forEach((function(t) {
                                var i = t.content;
                                return i && e._tryRemoveExpiredWorker(i)
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._addWorker = function(e) {
                    if (!e.hasBehavior(Ke.WorkerData)) {
                        var t = e.getBehavior(Ke.GridPosition)
                          , i = t.column
                          , n = t.row
                          , r = this.services.gameWorkers.getFreeWorker();
                        if (!r)
                            throw new Error("NatureSystem: there is no free workers! The ResourceGateBehavior should have been used to check it!");
                        r.setAsBusy({
                            column: i,
                            row: n
                        }),
                        e.addBehavior(new qi({
                            id: r.id
                        }));
                        var o = e.getBehavior(Ke.MapSource).sourceType;
                        e.addBehavior(new Wi({
                            workersData: {
                                sourceType: o
                            }
                        }))
                    }
                }
                ,
                t.prototype._removeWorker = function(e) {
                    var t = e.getBehavior(Ke.WorkerData);
                    if (t) {
                        var i = this.services.gameWorkers.getWorkerByID(t.workerID);
                        e.removeBehaviorByType(Ke.WorkerData),
                        null == i || i.setAsFree()
                    }
                }
                ,
                t.prototype._tryRemoveExpiredWorker = function(e) {
                    e.hasBehavior(Ke.CoolDown) || this._removeWorker(e)
                }
                ,
                t
            }(Pd), fm = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._family = this.addFamily([Ke.CoolDown], this._onCooldownAdded),
                            De.services.timer.onTimerFinished.addListener(this._onTimerTaskFinished, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.timer.onTimerFinished.removeListener(this._onTimerTaskFinished, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onTimerTaskFinished = function(e) {
                    var t = this._getContentByTimerID(e.id);
                    if (t) {
                        var i = t.getBehavior(Ke.CoolDown);
                        i && (t.removeBehavior(i),
                        this._triggerCompletion(t))
                    }
                }
                ,
                t.prototype._triggerCompletion = function(e) {
                    var t = new Vi;
                    e.addBehavior(t)
                }
                ,
                t.prototype._getContentByTimerID = function(e) {
                    for (var t = this._family.getGameObjects(), i = 0; i < t.length; i++) {
                        var n = t[i]
                          , r = n.getBehavior(Ke.CoolDown);
                        if (r && r.timerId === e)
                            return n
                    }
                    return null
                }
                ,
                t.prototype._onCooldownAdded = function(e) {
                    var t = e.getBehavior(Ke.CoolDown);
                    t && De.services.timer.getTimerByID(t.timerId)
                }
                ,
                t
            }(Pd), Em = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._activeTimers = new Map,
                    t._activeButtons = new Map,
                    t._activetrackers = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.CoolDown, Ke.CooldownPreview, Ke.GridPosition], this._onCooldownAdded, this._destroyTimer),
                            this.addFamily([Ke.CoolDown, Ke.CooldownPreview, Ke.InteractionTap, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onInteractionPickAdded),
                            De.services.localization.onLanguageChanged.addListener(this._updateTexts, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.localization.onLanguageChanged.removeListener(this._updateTexts, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onCooldownAdded = function(e) {
                    var t = e.getBehavior(Ke.CoolDown)
                      , i = e.getBehavior(Ke.GridPosition);
                    if (e.hasBehavior(Ke.MapSource) && !e.hasBehavior(Ke.Harvestable)) {
                        this._createTimerElement(e, t, i),
                        this._createFreeButton(e, t);
                        var n = De.services.fastForward.createTrackerForNatureObjects(t.timerId);
                        this._activetrackers.set(e, n),
                        this._updateFreeButtons(),
                        n.strategyChanged.addListener(this._updateFreeButtons, this)
                    }
                }
                ,
                t.prototype._onInteractionPickAdded = function(e) {
                    e.getBehavior(Ke.InteractionPriorityTurn).group,
                    Fd.COOLDOWN
                }
                ,
                t.prototype._destroyTimer = function(e) {
                    var t = this._activeTimers.get(e);
                    t && (this.services.mapGridView.getLayer(Yo.PREVIEW_UI).removeChild(t.timerUI),
                    t.timerUI.destroy(),
                    this._activetrackers.get(e).destroy(),
                    this._activetrackers.delete(e),
                    this._activeTimers.delete(e),
                    this._activeButtons.delete(e))
                }
                ,
                t.prototype._hideTimer = function(e) {
                    var t = this._activeTimers.get(e);
                    t && (t.timerUI.visible = !1,
                    t.timerUI.interactiveChildren = !1)
                }
                ,
                t.prototype._showTimer = function(e) {
                    var t = this._activeTimers.get(e);
                    t && (t.timerUI.visible = !0,
                    t.timerUI.interactiveChildren = !0)
                }
                ,
                t.prototype._createTimerElement = function(e, t, i) {
                    var n = new ap(t.timerId,{
                        background: f.BG_TIMER_NATURE,
                        iconOptions: {
                            icon: f.ICON_TIMER_REGENERATING,
                            position: {
                                x: -85,
                                y: 0
                            },
                            scale: {
                                x: .75,
                                y: .75
                            }
                        },
                        sizes: {
                            width: 220,
                            height: 54
                        },
                        corners: {
                            leftWidth: 100,
                            rightWidth: 20,
                            topHeight: 20,
                            bottomHeight: 20
                        },
                        textOptions: {
                            textStyle: vn.lightSmall,
                            position: {
                                x: -47,
                                y: -1
                            }
                        }
                    });
                    this.services.mapGridView.getLayer(Yo.PREVIEW_UI).addChild(n);
                    var r = this.services.axonometricProjection.getWorldPosition(i.column, i.row);
                    n.position.set(r.x, r.y + 100);
                    var o = {
                        timerUI: n,
                        cooldownBehavior: t,
                        gridPositionBehavior: i
                    };
                    this._activeTimers.set(e, o)
                }
                ,
                t.prototype._createFreeButton = function(e, t) {
                    var i = new fr({
                        name: "cooldownFree",
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE
                    },{
                        buttonSizes: {
                            width: 140,
                            height: 60
                        }
                    },{
                        textStyle: vn.lightSmall,
                        text: ce.NATURE_TIMER_BUTTON,
                        position: {
                            x: 0,
                            y: -7
                        }
                    })
                      , n = De.services.timer.getTimerByID(t.timerId);
                    i.onClick((function() {
                        n.forceComplete()
                    }
                    ));
                    var r = this._activeTimers.get(e);
                    i.position.set(0, i.height + 2),
                    r.timerUI.addChild(i),
                    this._activeButtons.set(e, i)
                }
                ,
                t.prototype._updateFreeButtons = function() {
                    var e = this;
                    this._activeButtons.forEach((function(t, i) {
                        var n = e._activetrackers.get(i);
                        n && (n.type === O_.FREE ? t.visible = !0 : t.visible = !1)
                    }
                    ))
                }
                ,
                t.prototype._updateTexts = function() {
                    this._activeButtons.forEach((function(e) {
                        e.updateText(nr(YE || (YE = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.NATURE_TIMER_BUTTON)),
                        e.updateTextStyle({
                            fontFamily: vn.currentFontFamily
                        })
                    }
                    ))
                }
                ,
                t
            }(Pd), mm = function(e) {
                function t() {
                    var t = e.call(this, {
                        basePopoutType: Bd.CLOSED_ONLY,
                        hasIdleAnimation: !0
                    }) || this;
                    return t._currentNotification = 0,
                    t._notificationState = xd.SHOW,
                    t._notification = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    t._closeContainer.addChild(rr(De.services.resource.getSprite(f.ICON_BALLOON_REWARDEDVIDEO), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: 1,
                            y: 1
                        },
                        position: {
                            x: 0,
                            y: 60
                        }
                    })),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function(t) {
                    var i;
                    e.prototype.show.call(this, t),
                    De.services.audio.playSoundEffect(m.POPOUT_APPEARS),
                    this._notification.position.set(60, 20),
                    this._notification.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !1),
                    this._closeContainer.addChild(this._notification),
                    null === (i = this._idleAnimation) || void 0 === i || i.onCustomEvent.addListener(this._onPopoutAnimationEvent, this)
                }
                ,
                t.prototype._onPopoutAnimationEvent = function(e) {
                    "hover_top" === e.event && (this._currentNotification++,
                    this._notificationState === xd.SHOW ? (this._notification.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !1),
                    this._notification.state.timeScale = 1,
                    this._currentNotification > 2 && (this._notificationState = xd.HIDE,
                    this._currentNotification = 0)) : this._currentNotification > 8 && (this._notificationState = xd.SHOW,
                    this._currentNotification = 0))
                }
                ,
                t
            }(Gd), ym = new v.LabelSettings({
                fitToBox: !0,
                fitHeight: 75,
                fitWidth: 350
            }), Tm = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    i._logger = Ie.Of("ResourceGateWithHealthPopout"),
                    i._resourceCost = t.resourceCost,
                    i._maxHealth = t.maxHealth || 0,
                    i._titleTextAsset = t.titleTextAsset,
                    i._buttonTextAsset = t.buttonTextAsset;
                    var n = i._createOpenPopoutContents(i._resourceCost[0], i._maxHealth);
                    return n.position.y += 50,
                    i._createTimerContainer(t.duration),
                    i._openContainer.addChild(n),
                    De.services.localization.onLanguageChanged.addListener(i._updateTexts, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    De.services.localization.onLanguageChanged.removeListener(this._updateTexts, this)
                }
                ,
                t.prototype.updateHealth = function(e) {
                    this._depletionBar.updateHealth(e)
                }
                ,
                t.prototype._createOpenPopoutContents = function(e, t) {
                    var i = new Xe.Container;
                    ym.style = vn.lightMedium,
                    this._title = new v.Label(De.services.localization.getText(this._titleTextAsset),ym),
                    this._title.anchor.set(.5, .5),
                    i.addChild(this._title);
                    var n = null;
                    (n = new th(t)).position.set(0, 180),
                    i.addChild(n);
                    var r = e.amount
                      , o = new Xe.Text(String(r),vn.buttonLabel);
                    return this.removeButton = i.addChild(new uc({
                        name: "remove",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: this._expansionWidth - 30,
                            height: 90
                        }
                    },{
                        text: this._buttonTextAsset,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: -60,
                            y: -5
                        }
                    },{
                        iconImage: za[e.key],
                        iconPosition: {
                            x: this._expansionWidth / 3 - (o.width + 10),
                            y: -4
                        }
                    },o)),
                    o.position.set(this._expansionWidth / 2 - 50, -5),
                    o.anchor.set(1, .5),
                    this.removeButton.position.set(0, this._expansionHeight - 105),
                    this._depletionBar = n,
                    i
                }
                ,
                t.prototype._createTimerContainer = function(e) {
                    var t = new Xe.Container
                      , i = t.addChild(rr(De.services.resource.getSprite(f.ICON_TIMER_REGENERATING), {
                        anchor: {
                            x: 0,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 0
                        }
                    }));
                    this.durationText = t.addChild(rr(new Xe.Text("",vn.darkMedium), {
                        anchor: {
                            x: 0,
                            y: .5
                        },
                        position: {
                            x: 1.5 * i.width,
                            y: 0
                        }
                    }));
                    var n = 1e3 * e;
                    this.durationText.text = r.StringUtility.formatMilliseconds(n, {
                        showSecondsBelowMilliseconds: 36e5,
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        }
                    }),
                    t.position.set(-t.width / 2, 150),
                    this._openContainer.addChild(t)
                }
                ,
                t.prototype._updateTexts = function() {
                    this._title.text = De.services.localization.getText(ce.REMOVE_POPOUT_HEADER),
                    this._title.style.fontFamily = vn.currentFontFamily,
                    this.removeButton.updateText(De.services.localization.getText(ce.REMOVE_POPOUT_BUTTON)),
                    this.removeButton.updateTextStyle({
                        fontFamily: vn.currentFontFamily
                    })
                }
                ,
                t
            }(Gd), Am = {
                buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
            }, Cm = {
                text: "",
                fitBoxSizes: {
                    width: 300,
                    height: 85
                },
                textStyle: vn.buttonLabel
            }, Im = function(e) {
                function t(t) {
                    var i = t.isForMapSource
                      , n = t.timer
                      , r = e.call(this, {
                        expansionHeight: 300,
                        expansionWidth: 375,
                        canHide: !0,
                        basePopoutType: Bd.OPEN_ONLY
                    }) || this;
                    return r._notification = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    r._localizationText = i ? ce.CD_POPOUT_NATURE_TITLE : ce.CD_POPOUT_REGENERATION_TITLE,
                    ym.style = vn.lightMedium,
                    r._title = new v.Label(De.services.localization.getText(r._localizationText),ym),
                    r._title.anchor.set(.5, .5),
                    r._title.position.set(0, 45),
                    r._openContainer.addChild(r._title),
                    r._timer = n,
                    r._timer.onUpdate.addListener(r._updateTimerText, r),
                    r._createTimerContainer(n),
                    r._createPurchaseButton(),
                    r._createFreeButton(),
                    r._createRVButton(),
                    r._notification.position.set(r._rvButton.x + r._rvButton.width / 2.1, r._rvButton.y - r._rvButton.height / 5),
                    r._purchaseButton.visible = r._freeButton.visible = r._rvButton.visible = !1,
                    De.services.localization.onLanguageChanged.addListener(r._updateTexts, r),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function() {
                    var t;
                    null === (t = this._timer) || void 0 === t || t.onUpdate.removeListener(this._updateTimerText, this),
                    this._timer = null,
                    De.services.localization.onLanguageChanged.removeListener(this._updateTexts, this),
                    e.prototype.destroy.call(this)
                }
                ,
                t.prototype.showRVButton = function(e) {
                    this._rvButton.visible = !0,
                    this._purchaseButton.visible = this._freeButton.visible = !1,
                    this._rvButton.onClick(e),
                    this._showNotification()
                }
                ,
                t.prototype.showFreeButton = function(e) {
                    this._freeButton.visible = !0,
                    this._purchaseButton.visible = this._rvButton.visible = !1,
                    this._freeButton.onClick(e),
                    this._showNotification()
                }
                ,
                t.prototype.showPurchaseButton = function(e, t) {
                    this._purchaseButton.visible = !0,
                    this._freeButton.visible = this._rvButton.visible = !1,
                    this._purchaseButton.onClick(t),
                    this._purchaseButton.updateText(e.toString()),
                    this._hideNotification()
                }
                ,
                t.prototype._createTimerContainer = function(e) {
                    var t = new Xe.Container
                      , i = t.addChild(rr(De.services.resource.getSprite(f.ICON_TIMER_REGENERATING), {
                        anchor: {
                            x: 0,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 0
                        }
                    }));
                    this._timerText = t.addChild(rr(new Xe.Text("",vn.darkMedium), {
                        anchor: {
                            x: 0,
                            y: .5
                        },
                        position: {
                            x: 1.5 * i.width,
                            y: 0
                        }
                    })),
                    this._timerText.text = r.StringUtility.formatMilliseconds(e.remainingTime, {
                        showSecondsBelowMilliseconds: 36e5,
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        }
                    }),
                    t.position.set(-t.width / 2, 150),
                    this._openContainer.addChild(t)
                }
                ,
                t.prototype._updateTimerText = function(e) {
                    this._timerText.text = r.StringUtility.formatMilliseconds(e.remainingTime, {
                        showSecondsBelowMilliseconds: 36e5,
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        }
                    })
                }
                ,
                t.prototype._createPurchaseButton = function() {
                    var e = new uc((0,
                    n.__assign)({
                        name: "cooldownPurchase"
                    }, Am),{
                        buttonSizes: {
                            width: this._expansionWidth - 30,
                            height: 90
                        }
                    },(0,
                    n.__assign)((0,
                    n.__assign)({}, Cm), {
                        fitBoxSizes: {
                            width: 100,
                            height: 60
                        },
                        position: {
                            x: 5,
                            y: -5
                        },
                        alignment: "left"
                    }),{
                        iconImage: f.ICON_BTN_GEM,
                        iconPosition: {
                            x: -36,
                            y: -5
                        }
                    });
                    e.position.set(0, 245),
                    this._purchaseButton = this._openContainer.addChild(e)
                }
                ,
                t.prototype._createFreeButton = function() {
                    var e = new fr((0,
                    n.__assign)({
                        name: "cooldownFree"
                    }, Am),{
                        buttonSizes: {
                            width: this._expansionWidth - 30,
                            height: 90
                        }
                    },(0,
                    n.__assign)((0,
                    n.__assign)({}, Cm), {
                        text: ce.CD_POPOUT_BUTTON_COMPLETE,
                        position: {
                            x: 0,
                            y: -5
                        }
                    }));
                    e.position.set(0, 245),
                    this._freeButton = this._openContainer.addChild(e)
                }
                ,
                t.prototype._createRVButton = function() {
                    var e = new uc((0,
                    n.__assign)({
                        name: "cooldownRV"
                    }, Am),{
                        buttonSizes: {
                            width: this._expansionWidth - 30,
                            height: 90
                        }
                    },(0,
                    n.__assign)((0,
                    n.__assign)({}, Cm), {
                        text: ce.CD_POPOUT_BUTTON_COMPLETE,
                        position: {
                            x: 38,
                            y: -5
                        }
                    }),{
                        iconImage: f.ICON_BTN_VIDEO_WHITE,
                        iconPosition: {
                            x: -120,
                            y: -2
                        }
                    });
                    e.position.set(0, 245),
                    this._rvButton = this._openContainer.addChild(e)
                }
                ,
                t.prototype._showNotification = function() {
                    this._notification.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !0),
                    this._openContainer.addChild(this._notification)
                }
                ,
                t.prototype._hideNotification = function() {
                    this._notification.state.clearTracks(),
                    this._openContainer.removeChild(this._notification)
                }
                ,
                t.prototype._updateTexts = function() {
                    this._title.text = De.services.localization.getText(this._localizationText),
                    this._title.style.fontFamily = vn.currentFontFamily
                }
                ,
                t
            }(Gd), Sm = function() {
                function e(e) {
                    var t = e.isForMapSource
                      , i = e.timer
                      , n = e.marketplaceService
                      , r = e.sourceType
                      , o = e.harvestableType;
                    switch (this._activeFFType = O_.NONE,
                    this._popout = new Im({
                        isForMapSource: t,
                        timer: i
                    }),
                    this._thumbnail = new mm,
                    this._marketplaceService = n,
                    this._sourceType = r,
                    this._harvestableType = o,
                    this._isForMapSource = t,
                    this._rvType = this._getRvPlacement(),
                    this._timer = i,
                    this._rvType) {
                    case "fastForwardEquipment":
                        this._tracker = De.services.fastForward.createTrackerForToolboxObjects(i.id);
                        break;
                    case "fastForwardHarvest":
                        this._tracker = De.services.fastForward.createTrackerForRegeneration(i.id);
                        break;
                    case "fastForwardNature":
                        this._tracker = De.services.fastForward.createTrackerForNatureObjects(i.id);
                        break;
                    case "fastForwardGreenhouse":
                        this._tracker = De.services.fastForward.createTrackerForGreenhouse(i.id)
                    }
                    this._popout.onHide.addListener(this._onPopupHide, this),
                    this._popout.onShow.addListener(this._onPopupShow, this),
                    this._tracker.strategyChanged.addListener(this._updateFFButton, this),
                    this._updateFFButton(this._tracker.type),
                    this._fastForwardProcess = this._fastForwardProcess.bind(this),
                    this._thumbnail.onClick.addListener(nc(this._fastForwardProcess), this)
                }
                return Object.defineProperty(e.prototype, "popout", {
                    get: function() {
                        return this._popout
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "thumbnail", {
                    get: function() {
                        return this._thumbnail
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.updateViewPosition = function(e) {
                    this._thumbnail.position.copyFrom(e),
                    this._popout.position.copyFrom(e)
                }
                ,
                e.prototype.destroy = function() {
                    this._popout.destroy(),
                    this._popout = null,
                    this._thumbnail.destroy(),
                    this._thumbnail = null,
                    this._tracker.destroy(),
                    this._tracker = null,
                    this._timer = null
                }
                ,
                e.prototype._updateFFButton = function(e) {
                    var t = this;
                    if (e !== this._activeFFType || e === O_.BUY) {
                        switch (e) {
                        case O_.FREE:
                            this._tracker.destroy(),
                            this._popout.showFreeButton((function() {
                                return t._timer.forceComplete()
                            }
                            )),
                            this._thumbnail.hide(!0);
                            break;
                        case O_.RV:
                            De.services.analytics.design.rvAppear(this._rvType),
                            this._popout.showRVButton(nc(this._fastForwardProcess.bind(this))),
                            this._popout.isVisible || this._thumbnail.show(!0);
                            break;
                        case O_.BUY:
                            this._popout.showPurchaseButton(String(this._tracker.cost.amount), nc(this._fastForwardProcess.bind(this)))
                        }
                        this._activeFFType = e
                    }
                }
                ,
                e.prototype._fastForwardProcess = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                if (!this._tracker)
                                    throw new Error("CoolDownPopoutController: you can't use the FFTracker because it has been destroyed!");
                                return [4, this._tracker.strategy.execute()];
                            case 1:
                                return (e = t.sent().result) === $_.SUCCESS && this._timer.forceComplete(),
                                e === $_.FAIL && this._tracker.cost.key === Cn.GEMS && this._marketplaceService.openMarketplaceShop(Ua.GEMS),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._onPopupShow = function() {
                    this._thumbnail.hide(!0)
                }
                ,
                e.prototype._onPopupHide = function() {
                    this._activeFFType === O_.RV && this._thumbnail.show(!0)
                }
                ,
                e.prototype._getRvPlacement = function() {
                    return this._isForMapSource && this._sourceType ? this._sourceType === Kt.TOOLBOX ? "fastForwardEquipment" : "fastForwardNature" : this._harvestableType && this._harvestableType === wt.GREENHOUSE ? "fastForwardGreenhouse" : "fastForwardHarvest"
                }
                ,
                e
            }(), Om = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._controllersStore = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.CoolDown, Ke.CooldownPreview, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onTimerAdded, this._removePopout),
                            this.addFamily([Ke.CoolDown, Ke.CooldownPreview, Ke.InteractionTap, Ke.InteractionPriorityTurn], this._onTapInteractionAdded),
                            this.addFamily([Ke.CoolDown, Ke.CooldownPreview, Ke.InteractionDrag, Ke.InteractionPriorityTurn], this._onDragInteractionAdded),
                            this.addFamily([Ke.CoolDown, Ke.CooldownPreview, Ke.GridPosition], void 0, this._onRemovedBehaviors),
                            this.addFamily([Ke.CooldownFinishedTrigger], this._removePopout),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onTimerAdded = function(e) {
                    if (!this._controllersStore.has(e)) {
                        var t = e.getBehavior(Ke.MapSource)
                          , i = e.getBehavior(Ke.Harvestable)
                          , n = e.hasBehavior(Ke.MapSource) && !e.hasBehavior(Ke.Harvestable)
                          , r = t ? t.sourceType : void 0
                          , o = i ? i.harvestableType : void 0
                          , a = e.getBehavior(Ke.CoolDown)
                          , s = De.services.timer.getTimerByID(a.timerId)
                          , _ = new Sm({
                            isForMapSource: n,
                            timer: s,
                            marketplaceService: this.services.marketplaceService,
                            sourceType: r,
                            harvestableType: o
                        });
                        _.updateViewPosition(this._getPopoutPosition(e)),
                        this._controllersStore.set(e, _),
                        this.services.mapGridView.getLayer(Yo.PREVIEW_UI).addChild(_.thumbnail),
                        this.services.popout.registerPopout(_.popout)
                    }
                }
                ,
                t.prototype._getPopoutPosition = function(e) {
                    var t, i = e.getBehavior(Ke.GridPosition), n = e.getBehavior(Ke.ExtendedTile);
                    if (n) {
                        var r = um(i, n, !0)
                          , o = r[r.length - 1];
                        (t = this.services.axonometricProjection.getWorldPosition(o.column, o.row)).x += n.popoutXOffset,
                        t.y -= n.popoutYOffset
                    } else
                        t = this.services.axonometricProjection.getWorldPosition(i.column, i.row);
                    return t
                }
                ,
                t.prototype._onTapInteractionAdded = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return e.getBehavior(Ke.InteractionPriorityTurn).group !== Fd.COOLDOWN || ((t = this._controllersStore.get(e)) && (t.updateViewPosition(this._getPopoutPosition(e)),
                            this.services.popout.registerPopout(t.popout)),
                            this._openCoolDownProgressPopout(e)),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onDragInteractionAdded = function(e) {
                    if (e.getBehavior(Ke.InteractionPriorityTurn).group === Fd.COOLDOWN) {
                        var t = this._controllersStore.get(e);
                        t && (this.services.mapGridView.getLayer(Yo.PREVIEW_UI).removeChild(t.thumbnail),
                        this.services.popout.unregisterPopout(t.popout))
                    }
                }
                ,
                t.prototype._onRemovedBehaviors = function(e) {
                    var t = this._controllersStore.get(e);
                    t && (t.updateViewPosition(this._getPopoutPosition(e)),
                    this.services.mapGridView.getLayer(Yo.PREVIEW_UI).addChild(t.thumbnail),
                    this.services.popout.registerPopout(t.popout))
                }
                ,
                t.prototype._openCoolDownProgressPopout = function(e) {
                    var t = this._controllersStore.get(e);
                    t && this.services.popout.showPopout(t.popout)
                }
                ,
                t.prototype._removePopout = function(e) {
                    var t = this._controllersStore.get(e);
                    t && (this.services.popout.unregisterPopout(t.popout),
                    this._controllersStore.delete(e),
                    t.destroy())
                }
                ,
                t
            }(Pd), bm = function(e) {
                function t(t) {
                    var i = e.call(this) || this
                      , n = new th(t);
                    return n.scale.set(.5),
                    i.addChild(n),
                    i.depletionBar = n,
                    i.visible = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onClick = function(e) {}
                ,
                t.prototype.open = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.visible = !0,
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.destroy({
                                children: !0
                            }),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Xe.Container), Rm = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._activePreviews = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Hitpoints, Ke.HitpointsPreview, Ke.GridPosition], this._showPreview, this._hidePreview),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showPreview = function(e) {
                    var t, i = e.getBehavior(Ke.Hitpoints);
                    if (i && e.hasBehavior(Ke.HitpointsPreview) && i.isVisible)
                        if (this._activePreviews.has(e))
                            null === (t = this._activePreviews.get(e)) || void 0 === t || t.depletionBar.updateHealth(i.current);
                        else {
                            var n = e.getBehavior(Ke.GridPosition)
                              , r = new bm(i.max);
                            r.depletionBar.updateHealth(i.current),
                            this.services.mapGridView.getLayer(Yo.PREVIEW_UI).addChild(r);
                            var o = this.services.axonometricProjection.getWorldPosition(n.column, n.row);
                            r.position.copyFrom(o),
                            r.open(),
                            this._activePreviews.set(e, r)
                        }
                }
                ,
                t.prototype._hidePreview = function(e) {
                    var t = this._activePreviews.get(e);
                    t && (t.close(),
                    this._activePreviews.delete(e))
                }
                ,
                t
            }(Pd), wm = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._popoutStore = new zd,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.ResourceGate, Ke.InteractionTap, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onInteractionAdded),
                            this.addFamily([Ke.GridPosition, Ke.ResourceGate], null, this._removePopout),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onInteractionAdded = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a;
                        return (0,
                        n.__generator)(this, (function(n) {
                            if (e.getBehavior(Ke.InteractionPriorityTurn).group !== Fd.RESOURCE_GATE)
                                return [2];
                            if (!e.hasBehavior(Ke.MapSource) && !e.hasBehavior(Ke.Harvestable))
                                return [2];
                            if (t = e.getBehavior(Ke.GridPosition),
                            e.hasBehavior(Ke.Hitpoints)) {
                                if (i = this._popoutStore.get(t),
                                a = e.getBehavior(Ke.ResourceGate),
                                i)
                                    return r = e.getBehavior(Ke.Hitpoints),
                                    i.updateHealth(r.current),
                                    this.services.popout.showPopout(i),
                                    [2];
                                o = e.getBehavior(Ke.Hitpoints),
                                this._createPopout(e, t, a, o)
                            } else
                                this._removePopout(e, t),
                                a = e.getBehavior(Ke.ResourceGate),
                                this._createPopout(e, t, a, {
                                    max: 0,
                                    current: 0
                                });
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._attemptPayment = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o, a, s = this;
                        return (0,
                        n.__generator)(this, (function(_) {
                            switch (_.label) {
                            case 0:
                                return this.services.gameWorkers.hasEnoughWorkers(i.workers) ? [3, 3] : (this._onNotEnoughWorkers(e),
                                (o = this._popoutStore.get(t)) ? (o.hide(),
                                o.onCloseComplete.addListener((function() {
                                    s._removePopout(e, t)
                                }
                                ), this),
                                [4, r.TimeDelay.after(1e3).promise]) : [3, 2]);
                            case 1:
                                _.sent(),
                                this._openActiveWorkerPopout(),
                                _.label = 2;
                            case 2:
                                return [2];
                            case 3:
                                return De.services.inventory.hasEnoughItems(i.cost) ? (this._sendSyncAnalytics(e, i.cost),
                                this._sendDesignAnalytics(e, Qi.START),
                                De.services.inventory.deductItems(i.cost, !0, e),
                                e.removeBehavior(i),
                                e.addBehavior(new Yi)) : (i.cost.some((function(e) {
                                    return e.key === Cn.ENERGY
                                }
                                )) && (this.services.marketplaceService.openMarketplaceShop(Ua.ENERGY),
                                this._sendDesignAnalytics(e, Qi.OUT_OF_ENERGY)),
                                i.cost.some((function(e) {
                                    return e.key === Cn.GEMS
                                }
                                )) ? this.services.marketplaceService.openMarketplaceShop(Ua.GEMS) : e.addBehavior(new ui({
                                    floaterType: ci.TextFloater,
                                    text: nr(JE || (JE = (0,
                                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.NOT_ENOUGH_RESOURCES),
                                    styles: vn.lightMedium
                                }))),
                                (a = this._popoutStore.get(t)) && this.services.popout.showPopout(a),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._removePopout = function(e, t) {
                    if (void 0 === t && (t = null),
                    t || (t = e.getBehavior(Ke.GridPosition)),
                    t) {
                        var i = this._popoutStore.remove(t);
                        i && (this.services.popout.hidePopout(i),
                        this.services.popout.unregisterPopout(i))
                    } else
                        this._logger.error("Can't remove popup for object that has no gridposition")
                }
                ,
                t.prototype._createPopout = function(e, t, i, n) {
                    var r = this
                      , o = e.getBehavior(Ke.MapSource)
                      , a = new Tm({
                        expansionWidth: 400,
                        expansionHeight: n.max > 1 ? 375 : 300,
                        resourceCost: i.cost,
                        duration: i.duration,
                        maxHealth: n.max,
                        basePopoutType: Bd.OPEN_ONLY,
                        titleTextAsset: (null == o ? void 0 : o.sourceType) === Kt.TOOLBOX ? ce.TOOLBOX_POPOUT_HEADER_TEXT : ce.REMOVE_POPOUT_HEADER,
                        buttonTextAsset: (null == o ? void 0 : o.sourceType) === Kt.TOOLBOX ? ce.TOOLBOX_POPOUT_BUTTON_TEXT : ce.REMOVE_POPOUT_BUTTON
                    });
                    a.removeButton.onClick((function() {
                        return r._attemptPayment(e, t, i)
                    }
                    )),
                    a.position.copyFrom(e.position),
                    a.updateHealth(n.current),
                    a.open(!1),
                    this.services.popout.registerPopout(a),
                    this.services.popout.showPopout(a),
                    this._popoutStore.add(t, a)
                }
                ,
                t.prototype._onNotEnoughWorkers = function(e) {
                    this._sendDesignAnalytics(e, Qi.WORK_PROGRESS_SHOW),
                    this.services.gameWorkers.openExtraWorkerPopup()
                }
                ,
                t.prototype._openActiveWorkerPopout = function() {
                    var e = this
                      , t = this.services.gridFilter.getFilledCellsWithBehaviors([Ke.MapSource, Ke.CooldownPreview, Ke.GridPosition]);
                    if (0 !== t.length) {
                        var i = t[0];
                        this.services.cameraService.animateCameraToCell(i, 1).then((function() {
                            var t = e.services.mapGrid.getContent(i.column, i.row);
                            if (t) {
                                var n = e.services.cameraService.getScreenToWorldPosition(t.position)
                                  , r = new Ni({
                                    originCell: i,
                                    hoverSelection: i,
                                    pointerPosition: n
                                });
                                t.addBehavior(r),
                                t.removeBehavior(r)
                            }
                        }
                        ))
                    }
                }
                ,
                t.prototype._sendSyncAnalytics = function(e, t) {
                    0 !== t.filter((function(e) {
                        return e.key === Cn.ENERGY
                    }
                    )).length && (e.hasBehavior(Ke.MapSource),
                    e.hasBehavior(Ke.Harvestable))
                }
                ,
                t.prototype._sendDesignAnalytics = function(e, t) {
                    var i = e.getBehavior(Ke.MapSource);
                    i && i.sourceType !== Kt.TOOLBOX ? De.services.analytics.design.workOnNature(t) : De.services.analytics.design.reportToolboxUsed()
                }
                ,
                t
            }(Pd), Dm = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onSourceDepleted = new r.Event,
                    t.onSourceMined = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.MapSource], this._executeInit),
                            this.addFamily([Ke.MapSource, Ke.ResourceGate], null, this._executeResourceComplete),
                            this.addFamily([Ke.MapSource, Ke.CooldownFinishedTrigger], this._executeCooldownComplete),
                            this.addFamily([Ke.MapSource, Ke.LootReceived], this._executeLootComplete),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._executeInit = function(e) {
                    var t = e.getBehavior(Ke.MapSource);
                    if (e.hasBehavior(Ke.Hitpoints) || this._addHitpoints(e, t.stepCount, t.stepCount),
                    e.hasBehavior(Ke.Lootable))
                        e.removeBehaviorByType(Ke.HitpointsPreview);
                    else {
                        if (e.hasBehavior(Ke.CoolDown))
                            return e.removeBehaviorByType(Ke.HitpointsPreview),
                            void e.addBehavior(new _t);
                        if (!e.hasBehavior(Ke.ResourceGate)) {
                            var i = this._getCurrentStep(t, e);
                            this._addResourceGate(e, i.cost, i.duration),
                            e.addBehavior(new kt({}))
                        }
                    }
                }
                ,
                t.prototype._executeResourceComplete = function(e) {
                    var t = e.getBehavior(Ke.MapSource)
                      , i = e.getBehavior(Ke.GridPosition)
                      , n = this._getCurrentStep(t, e);
                    i && this._addCooldown(e, {
                        column: i.column,
                        row: i.row
                    }, n.duration),
                    e.removeBehaviorByType(Ke.HitpointsPreview)
                }
                ,
                t.prototype._executeCooldownComplete = function(e) {
                    var t = e.getBehavior(Ke.MapSource)
                      , i = this._getCurrentStep(t, e)
                      , r = (0,
                    n.__spreadArray)((0,
                    n.__spreadArray)([], i.rewards, !0), this.services.randomLoot.getRandomLoot(e.getBlueprintID(), [], FE.MAPSOURCE), !0);
                    this._cleanCooldown(e),
                    this._addLoot(e, r)
                }
                ,
                t.prototype._executeLootComplete = function(e) {
                    var t = e.getBehavior(Ke.MapSource);
                    if (e.removeBehaviorByType(Ke.LootReceived),
                    this._decreaseHitpoints(e),
                    this._hasHitpointsLeft(e)) {
                        var i = this._getCurrentStep(t, e);
                        this._addResourceGate(e, i.cost, i.duration),
                        e.addBehavior(new kt({})),
                        this.onSourceMined.fire({
                            blueprintId: e.getBlueprintID()
                        })
                    } else
                        e.addBehavior(new ti({})),
                        this.onSourceDepleted.fire({
                            blueprintId: e.getBlueprintID()
                        });
                    var n = this._hasHitpointsLeft(e) ? "progress" : "complete";
                    De.services.actions.emit("removeNature.".concat(n, ".").concat(t.sourceType, ".").concat(e.getBlueprintID()))
                }
                ,
                t.prototype._getCurrentStep = function(e, t) {
                    var i = t.getBehavior(Ke.Hitpoints);
                    if (!i)
                        throw new Error("Error retreiving current map source object step!");
                    var n = i.max - i.current + 1;
                    return e.steps[n] ? e.steps[n] : (this._logger.error("gameObject ".concat(t.getBlueprintID(), " has ").concat(i.current, " hp, no step is defined!")),
                    this._setHitpointsToClosestDefinedStep(e, t, i),
                    this._getCurrentStep(e, t))
                }
                ,
                t.prototype._addHitpoints = function(e, t, i) {
                    var n = new Pt({
                        current: t,
                        max: i
                    });
                    e.addBehavior(n)
                }
                ,
                t.prototype._decreaseHitpoints = function(e) {
                    var t = e.getBehavior(Ke.Hitpoints);
                    if (!t)
                        throw new Error("Can't decrease hitpoints on non-existing hitpoints behavior");
                    e.replaceBehavior(new Pt({
                        max: t.max,
                        current: t.current - 1
                    }))
                }
                ,
                t.prototype._hasHitpointsLeft = function(e) {
                    var t = e.getBehavior(Ke.Hitpoints);
                    return !!t && t.current > 0
                }
                ,
                t.prototype._addResourceGate = function(e, t, i) {
                    e.addBehavior(new Dt({
                        cost: [{
                            amount: t,
                            key: Cn.ENERGY
                        }],
                        duration: i,
                        workers: 1
                    }))
                }
                ,
                t.prototype._addCooldown = function(e, t, i) {
                    var n = De.services.timer.addTimer(1e3 * i, "MapSourceCooldown:".concat(t.column, ",").concat(t.row));
                    e.addBehavior(new at({
                        timerId: n.id
                    })),
                    e.addBehavior(new _t)
                }
                ,
                t.prototype._cleanCooldown = function(e) {
                    e.removeBehaviorByType(Ke.CooldownPreview),
                    e.removeBehaviorByType(Ke.CooldownFinishedTrigger)
                }
                ,
                t.prototype._addLoot = function(e, t) {
                    var i = new jt({
                        loot: t
                    });
                    e.addBehavior(i),
                    De.services.audio.playSoundEffect(m.POPOUT_APPEARS)
                }
                ,
                t.prototype._setHitpointsToClosestDefinedStep = function(e, t, i) {
                    var n = [];
                    for (var r in e.steps)
                        n.push(r);
                    var o = i.current;
                    n.sort((function(e, t) {
                        return Math.abs(e - o) - Math.abs(t - o)
                    }
                    ));
                    var a = n[0];
                    t.replaceBehavior(new Pt({
                        max: i.max,
                        current: a
                    }))
                }
                ,
                t
            }(Pd), Nm = [{
                name: "alert",
                duration: 1.5,
                repeat: 0,
                keyframes: {
                    popout: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .2,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: "+=0.25",
                                y: "+=0.25"
                            }
                        }
                    }, {
                        time: .75,
                        duration: .2,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: "-=0.25",
                                y: "-=0.25"
                            }
                        }
                    }, {
                        time: .95,
                        duration: .05,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: "+=0.05",
                                y: "+=0.05"
                            }
                        }
                    }]
                }
            }], Lm = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        basePopoutType: Bd.CLOSED_ONLY,
                        hasIdleAnimation: !1,
                        retractionWidth: 220,
                        retractionHeight: 150
                    }) || this;
                    return i._lockIcon = null,
                    i._levelIcon = null,
                    i._levelLabel = null,
                    i._contentsContainer = null,
                    i._areaDescription = t,
                    i._contentsContainer = i._createVisuals(),
                    i._contentsContainer.y = .5 * i._retractionHeight,
                    i._closeContainer.addChild(i._contentsContainer),
                    i._animationAlert = new ur(Nm),
                    i._animationAlert.setTargets({
                        popout: i
                    }),
                    i.show(!1),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.playAlertAnimation = function() {
                    this._animationAlert.isAnimationPlaying("alert") || (this._animationAlert.stop("alert"),
                    this._animationAlert.play("alert"))
                }
                ,
                t.prototype.destroy = function() {
                    e.prototype.destroy.call(this),
                    this._animationAlert.dispose()
                }
                ,
                t.prototype._createVisuals = function() {
                    var e = new Xe.Container;
                    this._lockIcon = this._resourcesService.getSprite(f.ICON_LAND_LEVEL_LOCK),
                    this._lockIcon.x = -.2 * this._retractionWidth,
                    this._lockIcon.scale.set(.66),
                    this._lockIcon.anchor.set(.5),
                    this._levelIcon = this._resourcesService.getSprite(f.ICON_LAND_LEVEL_BG),
                    this._levelIcon.x = .2 * this._retractionWidth,
                    this._levelIcon.scale.set(.66),
                    this._levelIcon.anchor.set(.5);
                    var t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 50,
                        fitWidth: 50
                    });
                    t.style = vn.lightBoldMedium;
                    var i = this._areaDescription.requirements.buy.find((function(e) {
                        return e.key === An.LEVEL
                    }
                    ));
                    return this._levelLabel = new v.Label(i.amount.toString(),t),
                    this._levelLabel.anchor.set(.5),
                    this._levelLabel.position.set(this._levelIcon.x + 3, this._levelIcon.y + 15),
                    e.addChild(this._lockIcon),
                    e.addChild(this._levelIcon),
                    e.addChild(this._levelLabel),
                    e
                }
                ,
                t
            }(Gd), Bm = [{
                name: "area_purchase",
                duration: 1,
                repeat: 0,
                keyframes: {
                    popout: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .3,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: "+=0.2",
                                y: "+=0.2"
                            }
                        }
                    }, {
                        time: .6,
                        duration: .4,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }]
                }
            }], Pm = function(e) {
                function t(t) {
                    var i = e.call(this, {
                        basePopoutType: Bd.CLOSED_ONLY,
                        hasIdleAnimation: !1,
                        retractionWidth: 325,
                        retractionHeight: 180
                    }) || this;
                    return i.onPurchaseInteraction = new r.Event,
                    i._areaDescription = t,
                    i._coinCost = i._areaDescription.requirements.buy.find((function(e) {
                        return e.key === Cn.COINS
                    }
                    )),
                    i._activeContainer = i._createVisualForBuyState(),
                    i._closeContainer.addChild(i._activeContainer),
                    i._purchaseButton.onClick(i._onButtonPurchaseClick.bind(i)),
                    i._animationPurchase = new ur(Bm),
                    i._animationPurchase.setTargets({
                        popout: i
                    }),
                    i._animationPurchase.onEnd.addListener(i._onAnimationPurchaseEnd, i),
                    De.services.localization.onLanguageChanged.addListener(i._updateTexts, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function() {
                    this._animationPurchase.play("area_purchase"),
                    De.services.localization.onLanguageChanged.removeListener(this._updateTexts, this)
                }
                ,
                t.prototype._onAnimationPurchaseEnd = function(t) {
                    "area_purchase" === t && e.prototype.destroy.call(this)
                }
                ,
                t.prototype._onButtonPurchaseClick = function() {
                    this.onPurchaseInteraction.fire({
                        area: this._areaDescription
                    })
                }
                ,
                t.prototype._createVisualForBuyState = function() {
                    var e = new Xe.Container
                      , t = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: this._retractionWidth - 20,
                        fitHeight: 50
                    });
                    t.style = vn.darkSmall,
                    this._purchaseLandLabel = new v.Label(De.services.localization.getText(ce.BUY_LAND_POPOUT),t),
                    this._purchaseLandLabel.position.set(0, 40),
                    this._purchaseLandLabel.anchor.set(.5);
                    var i = new fr({
                        name: "purchaseArea",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: this._retractionWidth - 75,
                            height: 75
                        }
                    },{
                        text: ce.BUY_LAND_BUTTON_TEXT,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -7
                        },
                        alignment: "center",
                        fitBoxSizes: {
                            width: this._retractionWidth - 85,
                            height: 70
                        }
                    });
                    return i.position.set(this._purchaseLandLabel.x, this._purchaseLandLabel.y + 80),
                    e.addChild(this._purchaseLandLabel),
                    e.addChild(i),
                    this._purchaseButton = i,
                    e
                }
                ,
                t.prototype._updateTexts = function() {
                    this._purchaseLandLabel.text = De.services.localization.getText(ce.BUY_LAND_POPOUT),
                    this._purchaseLandLabel.style.fontFamily = vn.currentFontFamily
                }
                ,
                t
            }(Gd), km = [{
                name: "hide",
                duration: .5,
                repeat: 0,
                keyframes: {
                    barElement: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 1,
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }],
                    completedFill: []
                }
            }, {
                name: "show",
                duration: .5,
                repeat: 0,
                keyframes: {
                    barElement: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.inOut",
                        params: {
                            alpha: 1,
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }],
                    completedFill: []
                }
            }, {
                name: "wobble",
                duration: .5,
                repeat: 0,
                keyframes: {
                    barElement: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: .2,
                        duration: .4,
                        ease: "sine.Out",
                        params: {
                            scale: {
                                x: 1.12,
                                y: 1.12
                            }
                        }
                    }, {
                        time: .6,
                        duration: .4,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }],
                    completedFill: []
                }
            }, {
                name: "shine",
                duration: 2,
                repeat: -1,
                keyframes: {
                    completedFill: [{
                        time: 0,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0
                        }
                    }],
                    barElement: []
                }
            }, {
                name: "destroy",
                duration: 1,
                repeat: 0,
                keyframes: {
                    barElement: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 1,
                            scale: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .2,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: "+=0.2",
                                y: "+=0.2"
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }],
                    completedFill: []
                }
            }], xm = function(e) {
                function t(t) {
                    var i, n = this;
                    return (n = e.call(this) || this)._barFill = t.barFill,
                    n._barBackground = t.barBackground,
                    n._barCompletedFill = t.barCompletedFill || new Xe.Sprite(Xe.Texture.EMPTY),
                    n._iconAsset = t.iconAsset,
                    n._currentValue = null !== (i = t.currentValue) && void 0 !== i ? i : 0,
                    n._maxValue = t.maxValue,
                    n._barElements = n._createBar(),
                    n._barTotalWidth = n._barElements.barFillMask.width,
                    n.addChild(n._barElements.container),
                    n.updateValue(n._currentValue),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.updateValue = function(e) {
                    this._currentValue = r.NumberUtility.clamp(0, e, this._maxValue);
                    var t = this._currentValue / this._maxValue;
                    this._barElements.barFillMask.width = this._barTotalWidth * t,
                    this._barElements.textLabel.text = this._currentValue === this._maxValue ? "".concat(this._currentValue) : "".concat(this._currentValue, "/").concat(this._maxValue)
                }
                ,
                t.prototype._createBar = function() {
                    var e = new Xe.Container
                      , t = this._barFill;
                    t.anchor.set(.5);
                    var i = this._barBackground
                      , n = new Xe.NineSlicePlane(i);
                    n.width = 1.03 * t.width,
                    n.height = 1.3 * t.height,
                    n.pivot.set(.5 * n.width, .5 * n.height);
                    var r = new Xe.Sprite(Xe.Texture.WHITE);
                    r.width = n.width,
                    r.height = n.height,
                    r.anchor.set(0, .5),
                    r.position.set(-.5 * n.width, 0),
                    t.mask = r;
                    var o = this._barCompletedFill;
                    o.anchor.set(.5),
                    o.alpha = 0;
                    var a = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: n.width,
                        fitHeight: .9 * n.height
                    });
                    a.style = vn.lightSmall;
                    var s = new v.Label("0/0",a);
                    if (s.anchor.set(.5),
                    e.addChild(n),
                    e.addChild(t),
                    e.addChild(o),
                    e.addChild(r),
                    e.addChild(s),
                    this._iconAsset) {
                        var _ = De.services.resource.getSprite(this._iconAsset);
                        _.scale.set(.66),
                        _.position.set(-.4 * t.width, 0),
                        _.anchor.set(1, .5),
                        e.addChild(_)
                    }
                    return {
                        container: e,
                        barBackground: n,
                        barFillMask: r,
                        barFill: t,
                        textLabel: s
                    }
                }
                ,
                t
            }(Xe.Container), Gm = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._isOpen = !1,
                    i._completedFill = t.barCompletedFill || new Xe.Sprite(Xe.Texture.EMPTY),
                    i.alpha = i._isOpen ? 1 : 0,
                    i._animationProgressBar = new ur(km),
                    i._animationProgressBar.setTargets({
                        barElement: i,
                        completedFill: i._completedFill
                    }),
                    i._animationProgressBar.onEnd.addListener(i._onAnimationDestroyEnd, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.updateValue = function(t) {
                    e.prototype.updateValue.call(this, t)
                }
                ,
                t.prototype.shine = function() {
                    this._animationProgressBar.isAnimationPlaying("shine") || this._animationProgressBar.play("shine")
                }
                ,
                t.prototype.stopShineAnimation = function() {
                    this._animationProgressBar.stop("shine")
                }
                ,
                t.prototype.wobble = function() {
                    this._animationProgressBar.isAnimationPlaying("wobble") || (this._animationProgressBar.stop("wobble"),
                    this._animationProgressBar.play("wobble"))
                }
                ,
                t.prototype.open = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._isOpen || (this._animationProgressBar.play("show"),
                            this._isOpen = !0),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._isOpen && (this._animationProgressBar.play("hide"),
                            this._isOpen = !1),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function(e) {
                    this._animationProgressBar.play("destroy", .4)
                }
                ,
                t.prototype.onClick = function(e) {}
                ,
                t.prototype._onAnimationDestroyEnd = function(t) {
                    "destroy" === t && e.prototype.destroy.call(this)
                }
                ,
                t
            }(xm), Um = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._activePopoutMap = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this.addFamily([Ke.InteractionTap], this._onInteractionTap),
                            this._coinItem = De.services.inventory.getInventoryItem(Cn.COINS),
                            this.services.mapAreaService.getMapAreas().forEach((function(t) {
                                t.state !== Cc.DISABLED && (e._prepareAreaPopouts(t),
                                e._onAreaStateChange({
                                    area: t
                                }))
                            }
                            )),
                            this._coinItem.onChanged.addListener(this._onCoinAmountChanged, this),
                            this.services.mapAreaService.onAreaStateChange.addListener(this._onAreaStateChange, this),
                            this.services.onboarding.onTrackStarted.addListener(this._onOnboardingTrackStarted, this),
                            this.services.onboarding.onTrackCompleted.addListener(this._onOnboardingTrackCompleted, this),
                            this.services.onboarding.onTrackCanceled.addListener(this._checkAllAreaStates, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._coinItem.onChanged.removeListener(this._onCoinAmountChanged, this),
                            this.services.mapAreaService.onAreaStateChange.removeListener(this._onAreaStateChange, this),
                            this.services.onboarding.onTrackStarted.removeListener(this._onOnboardingTrackStarted, this),
                            this.services.onboarding.onTrackCompleted.removeListener(this._onOnboardingTrackCompleted, this),
                            this.services.onboarding.onTrackCanceled.removeListener(this._checkAllAreaStates, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._checkAllAreaStates = function() {
                    var e = this;
                    this.services.mapAreaService.getMapAreas().forEach((function(t) {
                        e._checkSingleAreaState(t)
                    }
                    ))
                }
                ,
                t.prototype._checkSingleAreaState = function(e) {
                    var t = this._activePopoutMap.get(e.id);
                    if (t) {
                        var i = this.services.onboarding.activeTrackKey;
                        if (!(i && xo.indexOf(i) > -1 && i !== Lo.EXPAND_LAND_TRACK && i !== Lo.REGAIN_CONTROL_TRACK))
                            switch (e.state) {
                            case Cc.LOCK:
                                t.lock.show(),
                                t.purchase.hide(),
                                t.progressBar.close();
                                break;
                            case Cc.BUY:
                                t.progressBar.open(),
                                t.progressBar.stopShineAnimation(),
                                t.progressBar.updateValue(this._coinItem.amount),
                                t.purchase.hide(),
                                t.lock.hide();
                                break;
                            case Cc.UNLOCKABLE:
                                t.purchase.show(),
                                t.progressBar.open(),
                                t.progressBar.shine(),
                                t.progressBar.updateValue(this._coinItem.amount)
                            }
                    }
                }
                ,
                t.prototype._onInteractionTap = function(e) {
                    var t = e.getBehavior(Ke.InteractionTap)
                      , i = {
                        column: t.data.originCell.column,
                        row: t.data.originCell.row
                    }
                      , n = this.services.mapAreaService.getMapAreaThatHasCell(i)
                      , r = this.services.premiumAreaService.getMapAreaThatHasCell(i);
                    n ? this._onAreaTap(n) : r && this._onPremiumAreaTap(r)
                }
                ,
                t.prototype._onAreaTap = function(e) {
                    var t = this._activePopoutMap.get(e.id);
                    t && (e.state === Cc.LOCK && t.lock && (t.lock.playAlertAnimation(),
                    new rf(this.services.mapGridView.getLayer(Yo.FLOATERS),t.progressBar.position,{
                        text: nr(XE || (XE = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.LOCKED_LAND_TOOLTIP_1),
                        styles: vn.warningText
                    })),
                    e.state === Cc.BUY && t.purchase && (t.progressBar.wobble(),
                    this.services.mapAreaService.canUnlockArea(e) || new rf(this.services.mapGridView.getLayer(Yo.FLOATERS),t.progressBar.position,{
                        text: nr(qE || (qE = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.LOCKED_LAND_TOOLTIP_2),
                        styles: vn.warningText
                    })))
                }
                ,
                t.prototype._onPremiumAreaTap = function(e) {
                    e.state !== Cc.UNLOCKED && De.services.navigation.showPremiumPopup(e, this.services.premiumAreaService, this.services.marketplaceService)
                }
                ,
                t.prototype._onOnboardingTrackStarted = function(e) {
                    if (e === Lo.EXPAND_LAND_TRACK) {
                        var t = this.services.mapAreaService.getMapArea("A2");
                        t && this._checkSingleAreaState(t)
                    } else
                        xo.indexOf(e) > -1 && this._hideActivePopouts()
                }
                ,
                t.prototype._onOnboardingTrackCompleted = function(e) {
                    (e === Lo.REGAIN_CONTROL_TRACK || -1 === xo.indexOf(e) || ve(this.services.onboarding.activeTrackKey)) && this._checkAllAreaStates()
                }
                ,
                t.prototype._hideActivePopouts = function() {
                    this._activePopoutMap.forEach((function(e) {
                        e.purchase && e.purchase.hide(),
                        e.lock && e.lock.hide(),
                        e.progressBar && e.progressBar.close()
                    }
                    ))
                }
                ,
                t.prototype._prepareAreaPopouts = function(e) {
                    var t = this._activePopoutMap.get(e.id);
                    if (e.state !== Cc.UNLOCKED && e.state !== Cc.DISABLED && !t) {
                        var i = this.services.mapAreaService.getAreaMarker(e.id)
                          , n = this._createAreaPopoutList(e);
                        this._activePopoutMap.set(e.id, n),
                        this._updatePopoutPosition(n, i),
                        t = n
                    }
                }
                ,
                t.prototype._onAreaStateChange = function(e) {
                    var t = this.services.onboarding.activeTrackKey;
                    if (!t || "A2" === e.area.id || xo.indexOf(t) > -1 && t !== Lo.EXPAND_LAND_TRACK && t !== Lo.REGAIN_CONTROL_TRACK) {
                        var i = e.area;
                        i.state !== Cc.UNLOCKED && (this._checkSingleAreaState(i),
                        i.state === Cc.UNLOCKABLE && i.previousState !== Cc.UNLOCKABLE && this._animateCameraToUnlockableArea(i.id))
                    }
                }
                ,
                t.prototype._onCoinAmountChanged = function() {
                    var e = this;
                    this._activePopoutMap.forEach((function(t) {
                        t.progressBar.updateValue(e._coinItem.amount)
                    }
                    ))
                }
                ,
                t.prototype._updatePopoutPosition = function(e, t) {
                    for (var i in e) {
                        var n = e[i]
                          , r = new Xe.Point;
                        if (t) {
                            var o = this.services.axonometricProjection.getEditorRemappedPosition(t.position)
                              , a = this.services.axonometricProjection.projection.projectIntoPlane(o);
                            r.set(a.x, a.y)
                        }
                        n.position = r
                    }
                    e.progressBar.position.y += 30,
                    e.progressBar.position.x += 10
                }
                ,
                t.prototype._createAreaPopoutList = function(e) {
                    var t = new Pm(e);
                    t.onPurchaseInteraction.addListener(this._onPopoutPurchase, this),
                    t.onClick.addListener(this._simulateClick.bind(this, e.cells[0]), this);
                    var i = new Lm(e);
                    i.onClick.addListener(this._simulateClick.bind(this, e.cells[0]), this);
                    var n = e.requirements.buy.find((function(e) {
                        return e.key === Cn.COINS
                    }
                    ))
                      , r = De.services.resource.getSprite(f.PROGRESS_BAR_FILL)
                      , o = De.services.resource.getSprite(f.PROGRESS_BAR_FILL_HIGHLIGHT)
                      , a = De.services.resource.getTexture(f.PROGRESS_BAR_LAND_BG)
                      , s = new Gm({
                        iconAsset: f.ICON_COUNTER_COIN,
                        barFill: r,
                        barBackground: a,
                        barCompletedFill: o,
                        maxValue: n.amount,
                        currentValue: 0
                    });
                    return this.services.mapGridView.getLayer(Yo.PREVIEW_UI).addChild(i, t, s),
                    {
                        lock: i,
                        purchase: t,
                        progressBar: s
                    }
                }
                ,
                t.prototype._onPopoutPurchase = function(e) {
                    var t = this._activePopoutMap.get(e.area.id);
                    t && this.services.mapAreaService.canUnlockArea(e.area) && (t.purchase.destroy(),
                    t.lock.destroy(),
                    t.progressBar.destroy(),
                    this.services.mapAreaService.unlockArea(e.area),
                    this._activePopoutMap.delete(e.area.id))
                }
                ,
                t.prototype._animateCameraToUnlockableArea = function(e) {
                    var t = this._activePopoutMap.get(e);
                    if (t) {
                        var i = this.services.axonometricProjection.getProjectedIndices(t.progressBar.position)
                          , n = this.services.mapGrid.getCell(i.column, i.row);
                        n && this.services.cameraService.animateCameraToCell(n)
                    }
                }
                ,
                t.prototype._simulateClick = function(e) {
                    var t = e.column
                      , i = e.row
                      , n = this.services.mapGrid.getContent(t, i);
                    n && this.services.interactionHelper.simulateClick.fire(n)
                }
                ,
                t
            }(Pd), Fm = {
                energy: 50,
                crates: 60
            }, Mm = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.experience.onLevelUp.addListener(this._onLevelUp, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.experience.onLevelUp.removeListener(this._onLevelUp, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onLevelUp = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i = this;
                        return (0,
                        n.__generator)(this, (function(r) {
                            switch (r.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.LEVEL_UP)];
                            case 1:
                                return r.sent(),
                                t = this.services.hudService,
                                De.services.navigation.showPopup(F_, {
                                    levelUpData: e,
                                    hudService: t
                                }),
                                e.rewards.map((function(e) {
                                    return (0,
                                    n.__awaiter)(i, void 0, void 0, (function() {
                                        var t;
                                        return (0,
                                        n.__generator)(this, (function(i) {
                                            return t = e.amount ? e.amount : Fm[e.key],
                                            De.services.inventory.addAmount(e.key, t, !1),
                                            [2]
                                        }
                                        ))
                                    }
                                    ))
                                }
                                )),
                                De.services.actions.emit("levelUp.".concat(e.level)),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Pd), Vm = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._arrows = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.ArrowPointer], this._onArrowAdded, this._onArrowRemoved),
                            this.addFamily([Ke.ArrowPointer, Ke.InteractionTap], this._onInteractionTap),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onArrowAdded = function(e) {
                    var t = e.position
                      , i = e.getBehavior(Ke.GridPosition);
                    i && (t = this.services.axonometricProjection.getWorldPosition(i.column, i.row));
                    var n = De.services.resource.getSpine(se.ONBOARDING_ARROW);
                    n.position.set(t.x, t.y - 120),
                    n.scale.set(1.65, 1.5),
                    n.stateData.setMix(j.ONBOARDING_ARROW_ANIMATION_APEAR, j.ONBOARDING_ARROW_ANIMATION_IDLE, .2),
                    n.stateData.setMix(j.ONBOARDING_ARROW_ANIMATION_IDLE, j.ONBOARDING_ARROW_ANIMATION_DISAPPEAR, .2),
                    n.state.setAnimation(0, j.ONBOARDING_ARROW_ANIMATION_APEAR, !1),
                    n.state.addListener({
                        complete: function() {
                            return n.state.setAnimation(0, j.ONBOARDING_ARROW_ANIMATION_IDLE, !0)
                        }
                    }),
                    this._arrows.set(e, n),
                    this.services.mapGridView.getLayer(Yo.PREVIEW_UI).addChild(n)
                }
                ,
                t.prototype._onArrowRemoved = function(e) {
                    var t = this
                      , i = this._arrows.get(e);
                    i && (this._arrows.delete(e),
                    i.state.setAnimation(0, j.ONBOARDING_ARROW_ANIMATION_DISAPPEAR, !1),
                    i.state.addListener({
                        complete: function() {
                            i.alpha = 0,
                            r.TimeDelay.nextFrame().then((function() {
                                return t.services.mapGridView.getLayer(Yo.PREVIEW_UI).removeChild(i)
                            }
                            ))
                        }
                    }))
                }
                ,
                t.prototype._onInteractionTap = function(e) {
                    e.removeBehaviorByType(Ke.ArrowPointer)
                }
                ,
                t
            }(Pd);
            !function(e) {
                e[e.OBJECT_TAP = 0] = "OBJECT_TAP",
                e[e.OBJECT_AREA_TAP = 1] = "OBJECT_AREA_TAP",
                e[e.OBJECT_SPAWN = 2] = "OBJECT_SPAWN",
                e[e.OBJECT_AREA_SPAWN = 3] = "OBJECT_AREA_SPAWN",
                e[e.OBJECT_AREA_VANISH = 4] = "OBJECT_AREA_VANISH",
                e[e.OBJECT_COLLECT_LOOT = 5] = "OBJECT_COLLECT_LOOT",
                e[e.OBJECT_PRE_MERGE = 6] = "OBJECT_PRE_MERGE",
                e[e.OBJECT_MERGE = 7] = "OBJECT_MERGE",
                e[e.OBJECT_MERGE_CHAIN = 8] = "OBJECT_MERGE_CHAIN",
                e[e.OBJECT_PICK = 9] = "OBJECT_PICK",
                e[e.COLLECTABLE_SHINE = 10] = "COLLECTABLE_SHINE",
                e[e.NATURE_OBJECT_CHOP = 11] = "NATURE_OBJECT_CHOP",
                e[e.NATURE_OBJECT_REMOVE = 12] = "NATURE_OBJECT_REMOVE",
                e[e.OBJECT_REGENERATION = 13] = "OBJECT_REGENERATION",
                e[e.DELIVERY_TRUCK = 14] = "DELIVERY_TRUCK",
                e[e.SHOVEL = 15] = "SHOVEL",
                e[e.READY_TO_HARVEST = 16] = "READY_TO_HARVEST",
                e[e.BUILDING_REPAIRED = 17] = "BUILDING_REPAIRED",
                e[e.CRATE_SPAWN = 18] = "CRATE_SPAWN",
                e[e.PREMIUM_LAND = 19] = "PREMIUM_LAND"
            }(QE || (QE = {}));
            var Hm = function() {
                function e(e) {
                    this._log = Ie.Of("Animation Tasks"),
                    this._currentTask = null,
                    this._currentTaskPhase = 0,
                    this._queue = [],
                    this._gameObject = e,
                    this._log.info("Setting up new Animation queue for => ".concat(this._gameObject.getBlueprintID()))
                }
                return Object.defineProperty(e.prototype, "currentTask", {
                    get: function() {
                        return this._currentTask
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.addToQueue = function(e) {
                    this._addToQueue(e)
                }
                ,
                e.prototype.play = function() {
                    if (!this._currentTask) {
                        var e = this._queue.shift();
                        e && (this._currentTask = e,
                        this._currentTask.phases[this._currentTaskPhase](this))
                    }
                }
                ,
                e.prototype.goToEndPhase = function() {
                    if (this._currentTask)
                        for (var e = this._currentTask.phases.length - 1 - this._currentTaskPhase, t = 0; t < e; t++)
                            this.goToNextPhase()
                }
                ,
                e.prototype.goToNextPhase = function() {
                    if (this._currentTask) {
                        var e = this._currentTask.phases.length - 1;
                        this._currentTaskPhase < e ? (this._currentTaskPhase++,
                        this._currentTask.phases[this._currentTaskPhase](this)) : this._readyToPlayNextTask()
                    }
                }
                ,
                e.prototype.hasTask = function(e) {
                    return !!this._currentTask && this._currentTask.id === e || !!this._queue.find((function(t) {
                        return t.id === e
                    }
                    ))
                }
                ,
                e.prototype._addToQueue = function(e) {
                    this._queue.some((function(t) {
                        return t.id === e.id
                    }
                    )) || this._queue.push(e)
                }
                ,
                e.prototype._readyToPlayNextTask = function() {
                    this._currentTask = null,
                    this._currentTaskPhase = 0,
                    this.play()
                }
                ,
                e
            }()
              , jm = [{
                name: "spawn",
                duration: .5,
                repeat: 0,
                keyframes: {
                    object: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "back.out",
                        params: {
                            alpha: 1,
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }]
                }
            }]
              , Km = [{
                name: "cloud_shine",
                duration: 2,
                repeat: 0,
                keyframes: {
                    cloud: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0
                        }
                    }, {
                        time: 0,
                        duration: .33,
                        ease: "sine.inOut",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: .33,
                        duration: .33,
                        ease: "sine.inOut",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: .66,
                        duration: .33,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0
                        }
                    }]
                }
            }, {
                name: "cloud_vanish",
                duration: .5,
                repeat: 0,
                keyframes: {
                    cloud: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 1,
                            position: {
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .8,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0,
                            position: {
                                y: "-=30"
                            }
                        }
                    }]
                }
            }];
            function Wm(e) {
                var t = e.getChildByName("maincontainer")
                  , i = t.getChildByName("mainsprite")
                  , n = new Xe.Sprite(i.texture);
                n.alpha = 0,
                n.blendMode = Xe.BLEND_MODES.SCREEN,
                n.anchor.copyFrom(i.anchor),
                t.addChild(i),
                t.addChild(n);
                var r = new ur(Km);
                return {
                    id: QE.OBJECT_AREA_TAP,
                    phases: [function(e) {
                        r.onEnd.addListener((function() {
                            r.dispose(),
                            n.destroy(),
                            e.goToNextPhase()
                        }
                        ), null),
                        r.setTargets({
                            cloud: n
                        }),
                        r.play("cloud_shine")
                    }
                    ]
                }
            }
            function zm(e, t, i, r, o, a, s, _) {
                var c = this
                  , l = r.parent
                  , u = e.getChildByName("maincontainer")
                  , d = u.getChildByName("mainsprite")
                  , h = u.toGlobal(d.position)
                  , p = new Xe.Sprite(d.texture);
                p.position = l.toLocal(h),
                p.anchor = d.anchor.clone(),
                l.addChild(p);
                var v = De.services.resource.getSpine(se.CLAIM_CURRENCY);
                v.visible = !1,
                v.position = l.toLocal(h),
                l.addChild(v);
                var g = l.toGlobal(r.position)
                  , f = o.toLocal(g)
                  , E = new ur(Vv);
                E.setTargets({
                    container: p
                });
                var m = a.getWorldToScreenPosition(e.position)
                  , y = new Lr(t,m,f,i,o);
                return {
                    id: QE.OBJECT_COLLECT_LOOT,
                    phases: [function(e) {
                        return (0,
                        n.__awaiter)(c, void 0, void 0, (function() {
                            return (0,
                            n.__generator)(this, (function(t) {
                                return y.onAnimationSpawn.addListener((function() {
                                    v.visible = !0,
                                    v.state.setAnimation(0, "disappear_effect", !1)
                                }
                                ), null),
                                y.onAnimationComplete.addListener((function() {
                                    var e;
                                    E.dispose(),
                                    v.destroy(),
                                    p.destroy(),
                                    s && (null === (e = De.services.inventory.getInventoryItem(s)) || void 0 === e || e.updateVisuals()),
                                    _ && _()
                                }
                                ), null),
                                y.animate(),
                                E.play("disappear"),
                                e.goToNextPhase(),
                                [2]
                            }
                            ))
                        }
                        ))
                    }
                    ]
                }
            }
            var Ym = [{
                name: "collectable_shine",
                duration: 2,
                repeat: 2,
                keyframes: {
                    collectable: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 1,
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: 0,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1.1,
                                y: 1.1
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }],
                    collectableClone: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: 0,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 1,
                            scale: {
                                x: 1.1,
                                y: 1.1
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }],
                    glow: [{
                        time: 0,
                        duration: 0,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0,
                            scale: {
                                x: .5,
                                y: .5
                            }
                        }
                    }, {
                        time: 0,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 1,
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            alpha: 0,
                            scale: {
                                x: .5,
                                y: .5
                            }
                        }
                    }]
                }
            }];
            function Jm(e) {
                var t = e.getChildByName("maincontainer")
                  , i = t.getChildByName("mainsprite")
                  , r = (0,
                n.__spreadArray)([], Ym, !0)
                  , o = new Xe.Sprite(i.texture);
                o.blendMode = Xe.BLEND_MODES.SCREEN,
                o.position.copyFrom(i.position),
                o.anchor.copyFrom(i.anchor);
                var a = De.services.resource.getSprite(f.COLLECT_GLOW);
                a.position.copyFrom(i.position),
                a.anchor.copyFrom(i.anchor),
                o.alpha = 0,
                a.alpha = 0,
                t.addChild(a),
                t.addChild(i),
                t.addChild(o),
                r[0].repeat = e.hasBehavior(Ke.Movable) ? 2 : -1;
                var s = new ur(Ym);
                return t.on("removed", (function() {
                    s.dispose()
                }
                )),
                {
                    id: QE.COLLECTABLE_SHINE,
                    phases: [function(e) {
                        s.onEnd.addListener((function() {
                            o.destroy(),
                            a.destroy(),
                            s.dispose()
                        }
                        ), null),
                        s.setTargets({
                            collectable: i,
                            collectableClone: o,
                            glow: a
                        }),
                        s.play("collectable_shine"),
                        e.goToNextPhase()
                    }
                    ]
                }
            }
            var Xm = [{
                name: "position",
                duration: .4,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: "+=0",
                            position: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .8,
                        ease: "back.in",
                        params: {
                            position: "$target"
                        }
                    }, {
                        time: .8,
                        duration: .2,
                        ease: "none",
                        params: {
                            alpha: 0
                        }
                    }],
                    target: []
                }
            }];
            function qm(e, t, i) {
                var n = i.getLayer(Yo.MAIN)
                  , r = t.getChildByName("maincontainer")
                  , o = null == r ? void 0 : r.getChildByName("mainsprite");
                if (!r || !o)
                    return null;
                var a = r.toGlobal(o.position)
                  , s = e.getChildByName("maincontainer")
                  , _ = null == s ? void 0 : s.getChildByName("mainsprite");
                if (!s || !_)
                    return null;
                var c = s.toGlobal(_.position)
                  , l = new Xe.Sprite(_.texture);
                l.position = n.toLocal(c),
                l.anchor.copyFrom(_.anchor),
                n.addChild(l),
                l.zIndex = e.zIndex,
                _.children.forEach((function(e) {
                    if (e.isSprite) {
                        var t = new Xe.Sprite(e.texture);
                        t.anchor.copyFrom(e.anchor),
                        l.addChild(t)
                    }
                }
                ));
                var u = n.toLocal(a)
                  , d = new ur(Xm);
                return d.setTargets({
                    container: l,
                    target: {
                        position: u
                    }
                }),
                {
                    id: QE.OBJECT_MERGE_CHAIN,
                    phases: [function(e) {
                        d.onEnd.listenOnce((function() {
                            d.dispose(),
                            l.destroy(),
                            e.goToNextPhase()
                        }
                        ), null),
                        d.play("position")
                    }
                    ]
                }
            }
            var Qm, Zm, $m = [{
                name: "move",
                duration: .3,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: .75,
                            position: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.out",
                        params: {
                            alpha: 1,
                            position: {
                                x: "$targetPosition",
                                y: "$targetPosition"
                            }
                        }
                    }],
                    targetPosition: []
                }
            }], ey = [{
                name: "scaledown",
                duration: .3,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: "+=0",
                            scale: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "back.in",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }, {
                        time: 0,
                        duration: 1,
                        ease: "sine.in",
                        params: {
                            alpha: 0
                        }
                    }]
                }
            }, {
                name: "scaleup",
                duration: .65,
                repeat: 0,
                keyframes: {
                    container: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            alpha: "+=0",
                            scale: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: 0,
                        duration: .75,
                        ease: "back.out",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .25,
                        duration: .75,
                        ease: "sine.out",
                        params: {
                            alpha: 1
                        }
                    }]
                }
            }], ty = -200;
            function iy(e) {
                var t = e.effectSpine
                  , i = e.bonusText
                  , n = e.text01SlotName
                  , r = e.text02SlotName
                  , o = e.layerTargetPosition
                  , a = e.bonusTextStyle;
                t.position.set(o.x, o.y + ty),
                t.alpha = 0,
                t.scale.set(3),
                t.skeleton.findSlot(r).currentSprite.parent.removeChildren();
                var s = t.skeleton.findSlot(n).currentSprite
                  , _ = s.parent;
                _.removeChildren();
                var c = new v.LabelSettings({
                    fitToBox: !0,
                    fitHeight: 400,
                    fitWidth: De.services.canvas.width - 200,
                    style: a
                })
                  , l = new v.Label(i,c);
                return l.anchor = s.anchor.clone(),
                l.scale = s.scale.clone(),
                _.addChild(l),
                t
            }
            var ny = [{
                name: "chop_hit",
                duration: .2,
                repeat: 0,
                keyframes: {
                    object: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: "$scale"
                        }
                    }, {
                        time: 0,
                        duration: .5,
                        event: "hover_bottom",
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: "+=0.05",
                                y: "+=0.05"
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        event: "hover_top",
                        ease: "sine.inOut",
                        params: {
                            scale: "$scale"
                        }
                    }],
                    scale: []
                }
            }]
              , ry = [{
                name: "pickup",
                duration: .15,
                repeat: 0,
                keyframes: {
                    image: [{
                        time: 0,
                        duration: .5,
                        ease: "sine.in",
                        params: {
                            position: {
                                x: "+=20",
                                y: "-=40"
                            }
                        }
                    }, {
                        time: .5,
                        duration: .5,
                        ease: "sine.out",
                        params: {
                            position: {
                                x: "$start",
                                y: "$start"
                            }
                        }
                    }],
                    start: []
                }
            }]
              , oy = [{
                name: "spawn_loot",
                duration: .7,
                repeat: 0,
                keyframes: {
                    spawnable: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            position: {
                                x: "+=0",
                                y: "+=0"
                            },
                            scale: {
                                x: 0,
                                y: 0
                            },
                            alpha: 0
                        }
                    }, {
                        time: 0,
                        duration: .188,
                        ease: "none",
                        params: {
                            alpha: 1
                        }
                    }, {
                        time: .188,
                        duration: .249,
                        ease: "circ.out",
                        params: {
                            alpha: 1,
                            position: {
                                y: "$topPoint"
                            }
                        }
                    }, {
                        time: .188,
                        duration: .45,
                        ease: "none",
                        params: {
                            position: {
                                x: "$arrivalPoint"
                            }
                        }
                    }, {
                        time: .437,
                        duration: .249,
                        ease: "circ.in",
                        params: {
                            position: {
                                y: "$arrivalPoint"
                            }
                        },
                        event: "updateLayer"
                    }, {
                        time: .1,
                        duration: .1,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .2,
                        duration: .25,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1.2,
                                y: 1.2
                            }
                        }
                    }, {
                        time: .45,
                        duration: .25,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: .7,
                        duration: .063,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: .8,
                                y: .8
                            }
                        }
                    }, {
                        time: .763,
                        duration: .236,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }],
                    topPoint: [],
                    arrivalPoint: []
                }
            }];
            function ay(e, t, i, n) {
                var r = new ur(oy);
                return r.setTargets({
                    spawnable: e,
                    topPoint: {
                        position: {
                            x: t.x,
                            y: Math.min(t.y - (e.height / 2 + 100), i.y - 100)
                        }
                    },
                    arrivalPoint: {
                        position: {
                            x: i.x,
                            y: i.y
                        }
                    }
                }),
                r.onCustomEvent.addListener((function(t) {
                    "updateLayer" !== t.event || e.isDestroyed || n.getLayer(Yo.MAIN).addChild(e)
                }
                ), void 0),
                {
                    id: QE.OBJECT_SPAWN,
                    phases: [function(e) {
                        r.onEnd.addListener((function() {
                            e.goToNextPhase()
                        }
                        ), null),
                        r.play("spawn_loot")
                    }
                    ]
                }
            }
            var sy = {
                MIN: .8,
                MAX: 1.3
            }
              , _y = {
                MIN: .75,
                MAX: 1.25
            }
              , cy = {
                MIN: 1,
                MAX: 3.5
            }
              , ly = {
                MIN: -100,
                MAX: 100
            }
              , uy = {
                MIN: -50,
                MAX: 50
            }
              , dy = .12
              , hy = .24
              , py = 3
              , vy = 5
              , gy = 0
              , fy = 80
              , Ey = 1;
            function my(e, t, i) {
                var n = e.getBehavior(Ke.GridPosition)
                  , o = De.services.resource.getSprite(f.STAR_PARTICLE);
                o.anchor.set(.5),
                i.getLayer(Yo.WORLD_ANIMATION).addChild(o);
                var a = r.Random.float(_y.MIN, _y.MAX)
                  , s = lr.gsap.timeline()
                  , _ = lr.gsap.timeline();
                return s.add(lr.gsap.set(o, {
                    alpha: 0
                })),
                _.add(lr.gsap.set(o.scale, {
                    x: 0,
                    y: 0
                })),
                s.eventCallback("onComplete", (function() {
                    var e = t.getWorldPosition(n.column, n.row);
                    e.x += r.Random.float(ly.MIN, ly.MAX),
                    e.y += r.Random.float(uy.MIN, uy.MAX),
                    o.position.copyFrom(e);
                    var i = r.Random.float(cy.MIN, cy.MAX)
                      , a = r.Random.float(sy.MIN, sy.MAX);
                    s.clear(),
                    s.add(lr.gsap.to(o, {
                        alpha: 1,
                        duration: i
                    })),
                    s.add(lr.gsap.to(o, {
                        alpha: 0,
                        duration: i
                    })),
                    _.clear(),
                    _.add(lr.gsap.to(o.scale, {
                        x: a,
                        y: a,
                        duration: i
                    })),
                    _.add(lr.gsap.to(o.scale, {
                        x: 0,
                        y: 0,
                        duration: i
                    }))
                }
                )),
                s.eventCallback("onUpdate", (function() {
                    o.angle += a
                }
                )),
                s.eventCallback("onInterrupt", (function() {
                    lr.gsap.to(o, {
                        alpha: 0,
                        duration: Ey
                    }),
                    lr.gsap.to(o.scale, {
                        x: 0,
                        y: 0,
                        duration: Ey
                    })
                }
                )),
                [s, _]
            }
            var yy = [{
                name: "scale",
                duration: .45,
                repeat: 0,
                keyframes: {
                    sprite: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            scale: {
                                x: 1,
                                y: 1
                            }
                        }
                    }, {
                        time: 0,
                        duration: .2,
                        ease: "sine.out",
                        params: {
                            scale: {
                                x: 1.095,
                                y: .55
                            }
                        }
                    }, {
                        time: .2,
                        duration: .4,
                        ease: "sine.inOut",
                        event: "startDust",
                        params: {
                            scale: {
                                x: .965,
                                y: 1.225
                            }
                        }
                    }, {
                        time: .6,
                        duration: .4,
                        ease: "sine.in",
                        params: {
                            alpha: 0,
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }]
                }
            }];
            function Ty(e, t) {
                var i = this
                  , o = e.getChildByName("maincontainer")
                  , a = o.getChildByName("mainsprite")
                  , s = a.anchor.x
                  , _ = e.toGlobal(o.position)
                  , c = o.toGlobal(a.position)
                  , l = De.services.resource.getSpine(se.DUST_CLOUD);
                l.visible = !1;
                var u = t.toLocal(c)
                  , d = new Xe.Point(u.x,u.y + a.height / 2);
                a.position.copyFrom(d),
                a.anchor.set(s, 1),
                t.addChild(a);
                var h = t.toLocal(_);
                l.position.copyFrom(h),
                t.addChild(l);
                var p = new ur(yy);
                return p.setTargets({
                    sprite: a
                }),
                {
                    id: QE.NATURE_OBJECT_REMOVE,
                    phases: [function() {
                        l.state.addListener({
                            complete: function() {
                                return (0,
                                n.__awaiter)(i, void 0, void 0, (function() {
                                    return (0,
                                    n.__generator)(this, (function(e) {
                                        switch (e.label) {
                                        case 0:
                                            return [4, r.TimeDelay.nextFrame()];
                                        case 1:
                                            return e.sent(),
                                            p.dispose(),
                                            l.destroy(),
                                            [2]
                                        }
                                    }
                                    ))
                                }
                                ))
                            }
                        }),
                        p.onCustomEvent.addListener((function(e) {
                            "startDust" === e.event && (l.state.setAnimation(0, "dust_cloud", !1),
                            l.visible = !0)
                        }
                        ), null),
                        p.play("scale")
                    }
                    ]
                }
            }
            var Ay, Cy, Iy = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._animationTracker = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.InteractionTap, Ke.GridPosition], this._onObjectTapped),
                            this.addFamily([Ke.MoveContentToCell, Ke.Sprite, Ke.SpawnAnimation, Ke.GridPosition], this._createCollectableAndContentMoveAnimation),
                            this.addFamily([Ke.MoveContentToCell, Ke.Spine, Ke.SpawnAnimation, Ke.GridPosition], this._createCollectableAndContentMoveAnimation),
                            this.addFamily([Ke.MoveContentToCell, Ke.BubbleSpawnContent, Ke.GridPosition], this._createBubbleStorageContentSpawnAnimation),
                            this.addFamily([Ke.Collectable, Ke.ObjectDestruction, Ke.GridPosition], this._onCollectibleClicked),
                            this.addFamily([Ke.Collectable, Ke.TicketAnimation, Ke.ObjectDestruction, Ke.GridPosition], this._onTicketClicked),
                            this.addFamily([Ke.MapSource, Ke.ObjectDestruction, Ke.GridPosition], this._onMapSourceAndDestructionBehaviorAdded),
                            this.addFamily([Ke.MapSource, Ke.CooldownPreview, Ke.GridPosition], this._onNatureWithCooldownsBehavior, this._onNatureWithCooldownRemoved),
                            this.addFamily([Ke.InteractionTap, Ke.AreaLock, Ke.Sprite], this._onAreaInteractionTap),
                            this.addFamily([Ke.AreaUnlock, Ke.Sprite], this._onAreaUnlockBehaviorAdded),
                            this.addFamily([Ke.AreaUnlockSpawn, Ke.Sprite], this._onAreaUnlockSpawnBehaviorAdded),
                            this.addFamily([Ke.Sprite, Ke.Harvestable], this._onObjectWithHarvestable),
                            this.addFamily([Ke.Harvestable, Ke.Sprite, Ke.CoolDown], this._onHarvestableWithCooldown),
                            this.addFamily([Ke.Harvestable, Ke.GridPosition, Ke.ObjectDestruction], this._onHarvestableDestructionAdded),
                            this.addFamily([Ke.DeliveryTruck], this._onDeliveryTruckAdded),
                            this.addFamily([Ke.MergeResult], this._onMergeHappen),
                            this.addFamily([Ke.MergeTrigger, Ke.ObjectDestruction], this._onMergeTriggerDestruction),
                            this.addFamily([Ke.ShovelAnimation], this._onShovelUsed),
                            this.addFamily([Ke.InteractionPick], this._onObjectPicked),
                            this.addFamily([Ke.Upgrade, Ke.Building, Ke.GridPosition], null, this._addBuildingRepairAnimation),
                            this.addFamily([Ke.Sprite, Ke.CreateSpawn, Ke.GridPosition], this._onCrateSpawn),
                            this.addFamily([Ke.Spine, Ke.CreateSpawn, Ke.GridPosition], this._onCrateSpawn),
                            this.addFamily([Ke.GoldenItem, Ke.GridPosition], this._onGoldenItemSpawned),
                            this.addFamily([Ke.AreaLock], this._lockedObjectAdded, this._lockedObjectRemoved),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._emptyAnimationTracker(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._emptyAnimationTracker = function() {
                    this._animationTracker.forEach((function(e) {
                        e.goToEndPhase()
                    }
                    ))
                }
                ,
                t.prototype._getAnimationTaskQueue = function(e) {
                    var t = this
                      , i = this._animationTracker.get(e);
                    return i || (i = new Hm(e),
                    this._animationTracker.set(e, i),
                    e.on("removed", (function() {
                        t._animationTracker.delete(e)
                    }
                    ))),
                    i
                }
                ,
                t.prototype._onNatureWithCooldownRemoved = function(e) {
                    this._getAnimationTaskQueue(e).goToNextPhase()
                }
                ,
                t.prototype._onNatureWithCooldownsBehavior = function(e) {
                    var t = e.getBehavior(Ke.MapSource);
                    if (t) {
                        var i = this._getAnimationTaskQueue(e)
                          , n = void 0;
                        switch (t.sourceType) {
                        case Kt.TREE:
                            n = function(e, t) {
                                var i = e.getChildByName("maincontainer")
                                  , n = i.getChildByName("mainsprite")
                                  , r = n.anchor.clone()
                                  , o = n.position.clone();
                                n.anchor.set(.5, 1),
                                n.position.set(o.x, o.y + .5 * n.height);
                                var a = De.services.resource.getSpine(se.AXE);
                                a.visible = !1,
                                a.position.set(n.position.x - .8 * n.width, n.position.y),
                                t && a.position.set(a.position.x + t.x, a.position.y + t.y),
                                i.addChild(a),
                                a.stateData.setMix("axe_appear", "axe_chop", .2),
                                a.stateData.setMix("axe_chop", "axe_disappear", .2);
                                var s = new ur(ny);
                                return s.setTargets({
                                    object: n,
                                    scale: {
                                        scale: {
                                            x: n.scale.x,
                                            y: n.scale.y
                                        }
                                    }
                                }),
                                a.state.addListener({
                                    event: function(e, t) {
                                        "axe-hit_element" === t.data.name && s.play("chop_hit")
                                    },
                                    complete: function(e) {
                                        "axe_disappear" === e.animation.name && a.destroy()
                                    }
                                }),
                                {
                                    id: QE.NATURE_OBJECT_CHOP,
                                    phases: [function() {
                                        a.visible = !0,
                                        a.state.addAnimation(0, "axe_appear", !1, 0),
                                        a.state.addAnimation(1, "axe_chop", !0, 0)
                                    }
                                    , function(e) {
                                        a.state.addAnimation(1, "axe_disappear", !1, 0),
                                        s.dispose(),
                                        n.anchor.copyFrom(r),
                                        n.position.copyFrom(o),
                                        e.goToNextPhase()
                                    }
                                    ]
                                }
                            }(e, t.animationOffset);
                            break;
                        case Kt.ROCK:
                            n = function(e) {
                                var t = e.getChildByName("maincontainer")
                                  , i = t.getChildByName("mainsprite")
                                  , n = i.anchor.clone()
                                  , r = i.position.clone();
                                i.anchor.set(.5, 1),
                                i.position.set(r.x, r.y + .5 * i.height);
                                var o = De.services.resource.getSpine(se.PICK_AXE);
                                o.visible = !1,
                                o.position.set(i.position.x - .8 * i.width, i.position.y),
                                t.addChild(o),
                                o.stateData.setMix("pick_axe_appear", "pick_axe_chop1", .2),
                                o.stateData.setMix("pick_axe_chop1", "pick_axe_disappear", .2),
                                o.stateData.setMix("pick_axe_chop2", "pick_axe_disappear", .2),
                                o.stateData.setMix("pick_axe_chop3", "pick_axe_disappear", .2);
                                var a = new ur(ny);
                                return a.setTargets({
                                    object: i,
                                    scale: {
                                        scale: {
                                            x: i.scale.x,
                                            y: i.scale.y
                                        }
                                    }
                                }),
                                o.state.addListener({
                                    event: function(e, t) {
                                        "axe-hit_element" === t.data.name && a.play("chop_hit")
                                    },
                                    complete: function(e) {
                                        "pick_axe_disappear" === e.animation.name && o.destroy(),
                                        "pick_axe_chop1" === e.animation.name && o.state.addAnimation(1, "pick_axe_chop2", !1, 0),
                                        "pick_axe_chop2" === e.animation.name && o.state.addAnimation(1, "pick_axe_chop3", !1, 0),
                                        "pick_axe_chop3" === e.animation.name && o.state.addAnimation(1, "pick_axe_chop1", !1, 0)
                                    }
                                }),
                                {
                                    id: QE.NATURE_OBJECT_CHOP,
                                    phases: [function() {
                                        o.visible = !0,
                                        o.state.addAnimation(0, "pick_axe_appear", !1, 0),
                                        o.state.addAnimation(1, "pick_axe_chop1", !1, 0)
                                    }
                                    , function(e) {
                                        o.state.addAnimation(1, "pick_axe_disappear", !1, 0),
                                        a.dispose(),
                                        i.anchor.copyFrom(n),
                                        i.position.copyFrom(r),
                                        e.goToNextPhase()
                                    }
                                    ]
                                }
                            }(e)
                        }
                        n && (i.addToQueue(n),
                        i.play())
                    }
                }
                ,
                t.prototype._onMapSourceAndDestructionBehaviorAdded = function(e) {
                    var t = this._getAnimationTaskQueue(e)
                      , i = Ty(e, this.services.mapGridView.getLayer(Yo.MAIN));
                    t.addToQueue(i),
                    t.play()
                }
                ,
                t.prototype._onCollectableAndContentMoveBehavior = function(e) {
                    e.getBehavior(Ke.Movable) || this._createCollectableAndContentMoveAnimation(e)
                }
                ,
                t.prototype._onGoldenItemSpawned = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e.hasBehavior(Ke.GoldenItem) ? [4, r.TimeDelay.after(1e3).promise] : [2];
                            case 1:
                                return n.sent(),
                                t = this._getAnimationTaskQueue(e),
                                i = Jm(e),
                                t.addToQueue(i),
                                t.play(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createCollectableAndContentMoveAnimation = function(e) {
                    var t = e.getBehavior(Ke.MoveContentToCell)
                      , i = e.getBehavior(Ke.Collectable)
                      , n = this._getAnimationTaskQueue(e)
                      , r = t.originPosition
                      , o = t.targetPosition;
                    if (r && o) {
                        var a = (new v.Vector2).copyFrom(this.services.axonometricProjection.getWorldPosition(r.column, r.row))
                          , s = (new v.Vector2).copyFrom(this.services.axonometricProjection.getWorldPosition(o.column, o.row));
                        e.position.copyFrom(a);
                        var _ = ay(e, a, s, this.services.mapGridView);
                        n.addToQueue(_)
                    }
                    if (i) {
                        var c = Jm(e);
                        n.addToQueue(c)
                    }
                    n.play()
                }
                ,
                t.prototype._createBubbleStorageContentSpawnAnimation = function(e) {
                    var t = e.getBehavior(Ke.MoveContentToCell)
                      , i = e.getBehavior(Ke.BubbleSpawnContent)
                      , n = this._getAnimationTaskQueue(e)
                      , r = t.targetPosition;
                    if (r) {
                        var o = i.startPosition
                          , a = (new v.Vector2).copyFrom(this.services.axonometricProjection.getWorldPosition(r.column, r.row));
                        e.position.copyFrom(o);
                        var s = ay(e, o, a, this.services.mapGridView);
                        n.addToQueue(s)
                    }
                    n.play()
                }
                ,
                t.prototype._onCollectibleClicked = function(e) {
                    if (!(e.hasBehavior(Ke.TicketAnimation) || e.hasBehavior(Ke.MergeTrigger) || e.hasBehavior(Ke.Merging))) {
                        var t = this._getAnimationTaskQueue(e)
                          , i = e.getBehavior(Ke.Collectable);
                        if (i) {
                            var n = void 0
                              , r = i.reward[0]
                              , o = this.services.hudService.hudContainer;
                            switch (i.reward[0].key) {
                            case "coins":
                                n = o.getUIelement(Ns.CoinCounterUI);
                                break;
                            case "gems":
                                n = o.getUIelement(Ns.GemCounterUI);
                                break;
                            case "crates":
                                n = o.getUIelement(Ns.CratesButtonUI);
                                break;
                            case "energy":
                                n = o.getUIelement(Ns.EnergyCounterUI);
                                break;
                            default:
                                n = o.getUIelement(Ns.OrderButtonUI)
                            }
                            var a = this.services.cameraService
                              , s = zm(e, De.services.resource.getSprite(qa[r.key]), r.amount, n, o, a, r.key);
                            t.addToQueue(s)
                        }
                        t.play()
                    }
                }
                ,
                t.prototype._onTicketClicked = function(e) {
                    var t = this._getAnimationTaskQueue(e);
                    if (e.getBehavior(Ke.Collectable)) {
                        var i = function(e, t) {
                            var i = this
                              , o = e.getChildByName("maincontainer")
                              , a = o.getChildByName("mainsprite")
                              , s = o.toGlobal(a.position)
                              , _ = new Xe.Sprite(a.texture);
                            _.position = t.toLocal(s),
                            _.anchor = a.anchor.clone(),
                            t.addChild(_);
                            var c = De.services.resource.getSpine(se.CLAIM_CURRENCY);
                            c.visible = !1,
                            c.position = t.toLocal(s),
                            t.addChild(c);
                            var l = new ur(Vv);
                            return l.setTargets({
                                container: _
                            }),
                            {
                                id: QE.OBJECT_COLLECT_LOOT,
                                phases: [function(e) {
                                    return (0,
                                    n.__awaiter)(i, void 0, void 0, (function() {
                                        var t = this;
                                        return (0,
                                        n.__generator)(this, (function(i) {
                                            return c.state.addListener({
                                                complete: function() {
                                                    return (0,
                                                    n.__awaiter)(t, void 0, void 0, (function() {
                                                        return (0,
                                                        n.__generator)(this, (function(e) {
                                                            switch (e.label) {
                                                            case 0:
                                                                return [4, r.TimeDelay.nextFrame()];
                                                            case 1:
                                                                return e.sent(),
                                                                l.dispose(),
                                                                c.destroy(),
                                                                _.destroy(),
                                                                [2]
                                                            }
                                                        }
                                                        ))
                                                    }
                                                    ))
                                                }
                                            }),
                                            l.onCustomEvent.addListener((function() {
                                                c.visible = !0,
                                                c.state.setAnimation(0, "disappear_effect", !1)
                                            }
                                            ), null),
                                            l.play("disappear"),
                                            e.goToNextPhase(),
                                            [2]
                                        }
                                        ))
                                    }
                                    ))
                                }
                                ]
                            }
                        }(e, this.services.hudService.hudContainer);
                        t.addToQueue(i)
                    }
                    t.play()
                }
                ,
                t.prototype._onObjectTapped = function(e) {
                    if (!e.hasBehavior(Ke.AreaLock)) {
                        var t = this._getAnimationTaskQueue(e)
                          , i = function(e) {
                            var t = e.getChildByName("mainsprite", !0)
                              , i = new ur(yE);
                            return i.setTargets({
                                image: t
                            }),
                            {
                                id: QE.OBJECT_TAP,
                                phases: [function(e) {
                                    i.onEnd.addListener((function() {
                                        i.dispose(),
                                        e.goToNextPhase()
                                    }
                                    ), null),
                                    i.play("wobble")
                                }
                                ]
                            }
                        }(e);
                        t.addToQueue(i),
                        t.play()
                    }
                }
                ,
                t.prototype._onAreaInteractionTap = function(e) {
                    var t = e.getBehavior(Ke.InteractionTap)
                      , i = ql(t.data.originCell.column, t.data.originCell.row)
                      , r = this.services.mapAreaService.getMapAreas().find((function(e) {
                        return e.cellsHashes.has(i)
                    }
                    ));
                    if (r) {
                        r.state === Cc.DISABLED && e.addBehavior(new ui({
                            floaterType: ci.TextFloater,
                            styles: vn.warningText,
                            text: nr(Ay || (Ay = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce.COMING_SOON)
                        }));
                        for (var o = 0, a = r.cells; o < a.length; o++) {
                            var s = a[o]
                              , _ = this.services.mapGrid.getCell(s.column, s.row).content
                              , c = _.getBehavior(Ke.Sprite)
                              , l = this._getAnimationTaskQueue(_);
                            if (!l.hasTask(QE.OBJECT_AREA_TAP) && c) {
                                var u = Wm(_);
                                l.addToQueue(u),
                                l.play()
                            }
                        }
                    }
                }
                ,
                t.prototype._onAreaUnlockBehaviorAdded = function(e) {
                    var t = e.getBehavior(Ke.AreaUnlock)
                      , i = this._getAnimationTaskQueue(e)
                      , n = function(e, t, i) {
                        var n = e.getChildByName("maincontainer")
                          , r = n.getChildByName("mainsprite")
                          , o = e.getChildByName("premium_object")
                          , a = e.position
                          , s = n.position;
                        r.setParent(i),
                        r.zIndex = e.zIndex,
                        r.position.x += a.x + s.x,
                        r.position.y += a.y + s.y,
                        o && (o.position.x -= s.x,
                        o.position.y -= s.y - 10,
                        r.addChild(o));
                        var _ = new ur(Km);
                        return _.setTargets({
                            cloud: r
                        }),
                        {
                            id: QE.OBJECT_AREA_VANISH,
                            phases: [function() {
                                _.onEnd.addListener((function() {
                                    r.destroy(),
                                    _.dispose()
                                }
                                ), null),
                                _.play("cloud_vanish", .5 * t)
                            }
                            ]
                        }
                    }(e, t.column, this.services.mapGridView.getLayer(Yo.MAIN));
                    i.addToQueue(n),
                    i.play()
                }
                ,
                t.prototype._onAreaUnlockSpawnBehaviorAdded = function(e) {
                    var t = e.getBehavior(Ke.AreaUnlockSpawn)
                      , i = this._getAnimationTaskQueue(e)
                      , n = function(e, t, i) {
                        var n = e.getChildByName("mainsprite", !0);
                        n.alpha = 0;
                        var r = new ur(jm);
                        return r.setTargets({
                            object: n
                        }),
                        {
                            id: QE.OBJECT_AREA_SPAWN,
                            phases: [function(e) {
                                r.onEnd.addListener((function() {
                                    i(),
                                    r.dispose(),
                                    e.goToNextPhase()
                                }
                                ), null),
                                r.play("spawn", .5 * (t + 3))
                            }
                            ]
                        }
                    }(e, t.column, (function() {
                        e.removeBehaviorByType(Ke.AreaUnlockSpawn)
                    }
                    ));
                    i.addToQueue(n),
                    i.play()
                }
                ,
                t.prototype._onHarvestableWithCooldown = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a, s;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (t = e.getBehavior(Ke.Hitpoints)) ? e.children.length <= 0 ? [4, r.TimeDelay.nextFrame()] : [3, 2] : [3, 4];
                            case 1:
                                if (n.sent(),
                                e.children.length <= 0)
                                    return [2];
                                n.label = 2;
                            case 2:
                                return 1 === t.current ? [3, 4] : [4, De.services.lazyLoad.getLoadingPromise(hn.OBJECT_REGENERATION, !0)];
                            case 3:
                                n.sent(),
                                i = this._getAnimationTaskQueue(e),
                                o = e.getBehavior(Ke.Animal),
                                a = o ? o.animation.offset : {
                                    x: 0,
                                    y: 0
                                },
                                s = function(e, t, i) {
                                    var n = e.getChildByName("maincontainer")
                                      , r = De.services.resource.getSpine(se.OBJECT_REGENERATION);
                                    r.visible = !1;
                                    var o = e.getBehavior(Ke.ExtendedTile);
                                    o && r.position.set(r.position.x, n.height / o.height * o.getVerticalOffset()),
                                    n.addChild(r);
                                    var a = null;
                                    t && ((a = De.services.resource.getSpine(se.SLEEP)).visible = !1,
                                    a.position.copyFrom(i),
                                    n.addChild(a));
                                    var s = De.services.resource.getSprite(f.ICON_TIMER_REGENERATING);
                                    return s.anchor.set(.5, .5),
                                    s.position.set(0, -25),
                                    n.addChild(s),
                                    {
                                        id: QE.OBJECT_REGENERATION,
                                        phases: [function(e) {
                                            r.visible = !0,
                                            r.state.setAnimation(0, "regenerating_state", !0),
                                            a && (a.visible = !0,
                                            a.state.setAnimation(0, "sleep", !0)),
                                            e.goToNextPhase()
                                        }
                                        ]
                                    }
                                }(e, Boolean(o), a),
                                i.addToQueue(s),
                                i.play(),
                                n.label = 4;
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onHarvestableDestructionAdded = function(e) {
                    if (!e.hasBehavior(Ke.ShovelAnimation)) {
                        var t = this._getAnimationTaskQueue(e)
                          , i = Ty(e, this.services.mapGridView.getLayer(Yo.MAIN));
                        t.addToQueue(i),
                        t.play()
                    }
                }
                ,
                t.prototype._onDeliveryTruckAdded = function(e) {
                    var t = this;
                    De.services.lazyLoad.getLoadingPromise(hn.TRAIN_STEAM).then((function() {
                        var i = e.getBehavior(Ke.DeliveryTruck)
                          , n = t._getAnimationTaskQueue(e)
                          , r = function(e, t) {
                            var i = e.getChildByName("maincontainer")
                              , n = e.getChildByName("mainsprite", !0)
                              , r = De.services.resource.getSpine(se.TRAIN_STEAM);
                            return r.position = (new v.Vector2).add(n.position).add((new Xe.Point).copyFrom(t)),
                            r.state.setAnimation(0, re.TRAIN_STEAM, !0),
                            i.addChild(r),
                            {
                                id: QE.DELIVERY_TRUCK,
                                phases: [function(e) {
                                    e.goToNextPhase()
                                }
                                ]
                            }
                        }(e, i.animation.offset);
                        n.addToQueue(r),
                        n.play()
                    }
                    ))
                }
                ,
                t.prototype._onMergeHappen = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a, s, _, c, l, u;
                        return (0,
                        n.__generator)(this, (function(d) {
                            switch (d.label) {
                            case 0:
                                return t = e.getBehavior(Ke.MergeResult),
                                i = this._getAnimationTaskQueue(e),
                                o = this.services.hudService.hudContainer,
                                a = o.getUIelement(Ns.RankBarUI),
                                s = this.services.cameraService,
                                _ = e.getChildByName(Uv),
                                (c = _.getChildByName(Gv, !0)).alpha = 0,
                                c.scale.set(0, 0),
                                [4, De.services.lazyLoad.getLoadingPromise([hn.MERGE_EFFECT, hn.MERGE_BONUS_EFFECT], !0)];
                            case 1:
                                return d.sent(),
                                l = function(e, t, i, o, a, s, _) {
                                    var c = e.getChildByName(Uv)
                                      , l = c.getChildByName(Gv, !0)
                                      , u = l.position.clone()
                                      , d = c.toGlobal(l.position)
                                      , h = De.services.resource.getSpine(se.MERGE_EFFECT)
                                      , p = De.services.resource.getSpine(se.MERGE_BONUS_EFFECT)
                                      , v = De.services.resource.getSpine(se.LUCKY_MERGE_EFFECT);
                                    l.alpha = 0,
                                    l.scale.set(0, 0);
                                    var g = new ur(ey);
                                    g.setTargets({
                                        container: l
                                    });
                                    for (var E = o.toLocal(d), m = 1; m < t.objectsToSpawn.length; m++)
                                        t.objectsToSpawn[m].alpha = 0;
                                    h.position.copyFrom(E),
                                    h.y += 15,
                                    o.addChild(h),
                                    s && (p = iy({
                                        effectSpine: p,
                                        bonusText: nr(Qm || (Qm = (0,
                                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.MERGE_BONUS),
                                        bonusTextStyle: vn.mergeBonusText,
                                        text01SlotName: "Merge_Bonus_text_01",
                                        text02SlotName: "Merge_Bonus_text_02",
                                        layerTargetPosition: E
                                    }),
                                    o.addChild(p)),
                                    _ && (v = iy({
                                        effectSpine: v,
                                        bonusText: nr(Zm || (Zm = (0,
                                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.LUCKY_MERGE),
                                        bonusTextStyle: vn.luckyBonusText,
                                        text01SlotName: "Merge_lucky_text_01",
                                        text02SlotName: "Merge_Lucky_text_02",
                                        layerTargetPosition: E
                                    }),
                                    o.addChild(v));
                                    var y = a.getWorldToScreenPosition(e.position)
                                      , T = new Lr(De.services.resource.getSprite(f.BTN_LEVELUP_CROWN),y,i,t.experience,o);
                                    return {
                                        id: QE.OBJECT_MERGE,
                                        phases: [function(e) {
                                            T.onAnimationComplete.listenOnce((function() {
                                                return function(e, t, i) {
                                                    e.destroy(),
                                                    t.dispose(),
                                                    i.goToNextPhase()
                                                }(h, g, e)
                                            }
                                            ), null),
                                            T.onAnimationObjectEnd.listenOnce(i.AnimateRankBar, i),
                                            v.state.addListener({
                                                complete: function() {
                                                    return function(e) {
                                                        r.TimeDelay.nextFrame().then((function() {
                                                            e.destroy()
                                                        }
                                                        ))
                                                    }(v)
                                                }
                                            }),
                                            p.state.addListener({
                                                complete: function() {
                                                    return function(e, t) {
                                                        r.TimeDelay.nextFrame().then((function() {
                                                            e.state.setAnimation(0, F.MERGE_EFFECT, !1),
                                                            e.alpha = 1,
                                                            t.destroy()
                                                        }
                                                        ))
                                                    }(v, p)
                                                }
                                            }),
                                            g.onStart.addListener((function() {
                                                return function(e, t, i, n, r) {
                                                    e.position.copyFrom(t),
                                                    e.y += 15;
                                                    var o = i ? n : r;
                                                    o.state.setAnimation(0, F.MERGE_EFFECT, !1),
                                                    o.alpha = 1
                                                }(h, E, s, p, v)
                                            }
                                            ), null),
                                            h.state.addListener({
                                                event: function() {
                                                    return function(e, t, i, n, r) {
                                                        for (var o = 1; o < e.objectsToSpawn.length; o++) {
                                                            var a = e.objectsToSpawn[o];
                                                            a.alpha = 1;
                                                            var s = a.getChildByName(Uv)
                                                              , _ = a.getBehavior(Ke.Sprite)
                                                              , c = a.getBehavior(Ke.Spine);
                                                            if (s) {
                                                                var l = s.getChildByName(Gv, !0)
                                                                  , u = s.toLocal(t)
                                                                  , d = new Xe.Container;
                                                                if (d.position.copyFrom(i),
                                                                _ || c) {
                                                                    var h = _ ? new Xe.Point(_.offset.x,_.offset.y) : new Xe.Point(c.offset.x,c.offset.y)
                                                                      , p = n.clone();
                                                                    d.position.set(d.position.x - p.x + h.x, d.position.y - p.y + h.y)
                                                                }
                                                                l.position.copyFrom(u);
                                                                var v = new ur($m);
                                                                v.setTargets({
                                                                    container: l,
                                                                    targetPosition: d
                                                                }),
                                                                v.play("move")
                                                            }
                                                        }
                                                        r.animate()
                                                    }(t, d, l, u, T)
                                                }
                                            }),
                                            h.state.setAnimation(0, M.MERGE_EFFECT, !1),
                                            g.play("scaleup", .6)
                                        }
                                        ]
                                    }
                                }(e, t, a, o, s, t.isBonusMerge, t.isLuckyMerge),
                                i.addToQueue(l),
                                e.hasBehavior(Ke.Currency) && !e.hasBehavior(Ke.Mergeable) && (u = Jm(e),
                                i.addToQueue(u)),
                                i.play(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onMergeTriggerDestruction = function(e) {
                    for (var t = this, i = e.getBehavior(Ke.MergeTrigger).chain.map((function(e) {
                        return t.services.mapGrid.getCell(e)
                    }
                    )).filter((function(e) {
                        return void 0 !== e
                    }
                    )), n = 0, r = i; n < r.length; n++) {
                        var o = r[n];
                        if (o.content) {
                            var a = this._getAnimationTaskQueue(o.content)
                              , s = qm(o.content, e, this.services.mapGridView);
                            s ? (a.addToQueue(s),
                            a.play()) : this._logger.error("Failed to create merge animation task for object", o.content)
                        }
                    }
                    var _ = this._getAnimationTaskQueue(e)
                      , c = function(e, t) {
                        var i = e.getChildByName("maincontainer")
                          , n = i.getChildByName("mainsprite")
                          , r = i.toGlobal(n.position)
                          , o = new Xe.Sprite(n.texture);
                        o.position.copyFrom(t.toLocal(r)),
                        o.anchor.copyFrom(n.anchor),
                        t.addChild(o),
                        o.zIndex = e.zIndex,
                        n.children.forEach((function(e) {
                            if (e.isSprite) {
                                var t = new Xe.Sprite(e.texture);
                                t.anchor.copyFrom(e.anchor),
                                o.addChild(t)
                            }
                        }
                        ));
                        var a = new ur(ey);
                        return a.setTargets({
                            container: o
                        }),
                        {
                            id: QE.OBJECT_PRE_MERGE,
                            phases: [function(e) {
                                a.onEnd.addListener((function() {
                                    o.destroy(),
                                    a.dispose()
                                }
                                ), null),
                                a.play("scaledown"),
                                e.goToNextPhase()
                            }
                            ]
                        }
                    }(e, this.services.mapGridView.getLayer(Yo.MAIN));
                    _.addToQueue(c),
                    _.play()
                }
                ,
                t.prototype._onShovelUsed = function(e) {
                    var t = this;
                    e.removeBehaviorByType(Ke.ShovelAnimation);
                    var i, o = this._getAnimationTaskQueue(e), a = e.getChildByName("maincontainer"), s = a.getChildByName("mainsprite"), _ = a.toGlobal(s.position), c = this.services.mapGridView.getLayer(Yo.LAYER_SELECTION).toLocal(_), l = e.getBehavior(Ke.Spine);
                    l ? (i = De.services.resource.getTexture(l.uiAsset),
                    c.x += l.uiAssetOffset.x,
                    c.y += l.uiAssetOffset.y) : i = s.texture.clone();
                    var u = new Xe.Container;
                    u.position.copyFrom(c),
                    this.services.mapGridView.getLayer(Yo.LAYER_SELECTION).addChild(u);
                    var d = function(e, t, i) {
                        var o = this
                          , a = De.services.resource.getSpine(se.SHOVEL);
                        return e.addChild(a),
                        a.skeleton.findSlot("item").currentSprite.texture = t,
                        a.state.addListener({
                            event: function() {
                                De.services.audio.playSoundEffect(m.SHOVEL_USE)
                            },
                            complete: function() {
                                return (0,
                                n.__awaiter)(o, void 0, void 0, (function() {
                                    return (0,
                                    n.__generator)(this, (function(e) {
                                        switch (e.label) {
                                        case 0:
                                            return [4, r.TimeDelay.nextFrame()];
                                        case 1:
                                            return e.sent(),
                                            a.destroy(),
                                            i(),
                                            [2]
                                        }
                                    }
                                    ))
                                }
                                ))
                            }
                        }),
                        {
                            id: QE.SHOVEL,
                            phases: [function(e) {
                                a.state.setAnimation(0, $.SHOVEL_ANIMATION, !1),
                                e.goToNextPhase()
                            }
                            ]
                        }
                    }(u, i, (function() {
                        t.services.mapGridView.getLayer(Yo.LAYER_SELECTION).removeChild(u)
                    }
                    ));
                    o.addToQueue(d),
                    o.play()
                }
                ,
                t.prototype._onObjectPicked = function(e) {
                    var t = this._getAnimationTaskQueue(e)
                      , i = function(e) {
                        var t = e.getChildByName("maincontainer")
                          , i = t.position
                          , n = new ur(ry);
                        return n.setTargets({
                            image: t,
                            start: {
                                position: {
                                    x: i.x,
                                    y: i.y
                                }
                            }
                        }),
                        n.onEnd.listenOnce((function() {
                            n.dispose()
                        }
                        ), null),
                        {
                            id: QE.OBJECT_PICK,
                            phases: [function(e) {
                                n.onEnd.listenOnce((function() {
                                    e.goToNextPhase()
                                }
                                ), null),
                                n.play("pickup")
                            }
                            ]
                        }
                    }(e);
                    t.addToQueue(i),
                    t.play()
                }
                ,
                t.prototype._onObjectWithHarvestable = function(e) {
                    if (!(e.hasBehavior(Ke.CoolDown) || e.hasBehavior(Ke.ResourceGate) || e.hasBehavior(Ke.Depleted))) {
                        var t = this._getAnimationTaskQueue(e)
                          , i = function(e) {
                            var t = e.getChildByName("maincontainer")
                              , i = t.getChildByName("mainsprite")
                              , n = t.toGlobal(i.position)
                              , r = t.toLocal(n)
                              , o = De.services.resource.getSpine(se.READY_TO_HARVEST);
                            return o.position.copyFrom(r),
                            t.addChild(o),
                            {
                                id: QE.READY_TO_HARVEST,
                                phases: [function(e) {
                                    o.state.setAnimation(0, J.ANIMATION, !0),
                                    e.goToNextPhase()
                                }
                                ]
                            }
                        }(e);
                        t.addToQueue(i),
                        t.play()
                    }
                }
                ,
                t.prototype._addBuildingRepairAnimation = function(e) {
                    var t = this;
                    if (!e.getBehavior(Ke.InteractionPick)) {
                        var i = e.getBehavior(Ke.GridPosition)
                          , n = e.getBehavior(Ke.ExtendedTile)
                          , o = this.services.mapGridView.getLayer(Yo.BACKGROUD)
                          , a = this.services.mapGridView.getLayer(Yo.PREVIEW_UI)
                          , s = um(i, n, !1);
                        r.TimeDelay.nextFrame().then((function() {
                            var n = t._getAnimationTaskQueue(e)
                              , _ = function(e, t, i, n) {
                                var o = e.getBehavior(Ke.ExtendedTile)
                                  , a = 1 === o.width && 1 === o.height
                                  , s = n.backgroundLayer.addChild(new AE);
                                s.turnWhite();
                                var _ = n.axonometric.getWorldPosition(t.column, t.row);
                                s.scale.set(a ? 1 : 2),
                                s.anchor.set(.5, a ? 0 : .5),
                                s.position.copyFrom(_);
                                var c = new ur(TE);
                                c.setTargets({
                                    highlighter: s
                                }),
                                c.play("highlight");
                                var l = e.getChildByName(Uv, !0)
                                  , u = e.getChildByName(Gv, !0)
                                  , d = l.addChild(new Xe.Sprite(u.texture.clone()));
                                d.blendMode = Xe.BLEND_MODES.SCREEN,
                                d.position.copyFrom(u.position),
                                d.anchor.copyFrom(u.anchor),
                                d.pivot.copyFrom(u.pivot);
                                var h = new ur(tm);
                                h.setTargets({
                                    container: d
                                }),
                                h.play("merge_glow");
                                var p = i.map((function(e) {
                                    var t = n.axonometric.getWorldPosition(e.column, e.row)
                                      , i = De.services.resource.getSpine(se.READY_TO_HARVEST);
                                    i.state.setAnimation(0, J.ANIMATION, !0),
                                    i.position.set(t.x, t.y + 80),
                                    n.previewLayer.addChild(i);
                                    var r = new ur(B_);
                                    return r.onEnd.listenOnce((function() {
                                        return i.destroy()
                                    }
                                    ), null),
                                    r.setTargets({
                                        container: i
                                    }),
                                    r
                                }
                                ));
                                return {
                                    id: QE.BUILDING_REPAIRED,
                                    phases: [function(e) {
                                        r.TimeDelay.after(1e4).promise.then((function() {
                                            h.dispose(),
                                            c.dispose(),
                                            d.destroy(),
                                            s.destroy(),
                                            p.forEach((function(e) {
                                                return e.play("fadeOut")
                                            }
                                            ))
                                        }
                                        )),
                                        e.goToNextPhase()
                                    }
                                    ]
                                }
                            }(e, i, s, {
                                backgroundLayer: o,
                                previewLayer: a,
                                axonometric: t.services.axonometricProjection
                            });
                            n.addToQueue(_),
                            n.play()
                        }
                        ))
                    }
                }
                ,
                t.prototype._onCrateSpawn = function(e) {
                    var t = this._getAnimationTaskQueue(e)
                      , i = function(e) {
                        var t = e.getChildByName(Uv).getChildByName(Gv);
                        t.alpha = 0;
                        var i = De.services.resource.getSpine(se.CRATE_SPAWN_ON_GRID);
                        i.pivot.set(0, -30),
                        e.addChild(i);
                        var n = lr.gsap.timeline();
                        return {
                            id: QE.CRATE_SPAWN,
                            phases: [function(o) {
                                o.goToNextPhase(),
                                i.state.setAnimation(0, "crate_spawn_on_grid", !1),
                                i.state.addListener({
                                    complete: function() {
                                        r.TimeDelay.nextFrame().then((function() {
                                            return i.destroy()
                                        }
                                        )),
                                        n.progress(1),
                                        n.kill()
                                    },
                                    event: function() {
                                        n.add(lr.gsap.to(t, {
                                            alpha: 1,
                                            duration: .466
                                        })),
                                        e.addBehavior(new Wi({
                                            spawnData: {
                                                blueprintID: e.getBlueprintID()
                                            }
                                        }))
                                    }
                                })
                            }
                            ]
                        }
                    }(e);
                    t.addToQueue(i),
                    t.play()
                }
                ,
                t.prototype._lockedObjectAdded = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return "premium_cloud" !== e.getBlueprintID() ? [2] : [4, De.services.lazyLoad.prioritizeGroup(hn.PREMIUM_LAND)];
                            case 1:
                                return n.sent(),
                                t = this._getAnimationTaskQueue(e),
                                i = function(e, t, i) {
                                    for (var n = function(e, t, i) {
                                        var n = e.getBehavior(Ke.GridPosition)
                                          , o = De.services.resource.getSprite(r.ArrayUtility.getRandomItem([f.DUST_PINK_01, f.DUST_PINK_02, f.DUST_PINK_03, f.DUST_PINK_04]));
                                        o.anchor.set(.5),
                                        i.getLayer(Yo.WORLD_ANIMATION).addChild(o);
                                        var a = r.Random.float(dy, hy)
                                          , s = lr.gsap.timeline();
                                        return s.add(lr.gsap.set(o, {
                                            alpha: 0
                                        })),
                                        s.eventCallback("onComplete", (function() {
                                            var e = t.getWorldPosition(n.column, n.row);
                                            e.y += r.Random.float(gy, fy),
                                            o.position.copyFrom(e);
                                            var i = r.Random.float(py, vy);
                                            a = r.Random.float(dy, hy),
                                            s.clear(),
                                            s.add(lr.gsap.to(o, {
                                                alpha: 1,
                                                duration: i
                                            })),
                                            s.add(lr.gsap.to(o, {
                                                alpha: 0,
                                                duration: i
                                            }))
                                        }
                                        )),
                                        s.eventCallback("onUpdate", (function() {
                                            o.position.set(o.position.x + a, o.position.y - a)
                                        }
                                        )),
                                        s.eventCallback("onInterrupt", (function() {
                                            lr.gsap.to(o, {
                                                alpha: 0,
                                                duration: Ey
                                            }),
                                            lr.gsap.to(o.scale, {
                                                x: 0,
                                                y: 0,
                                                duration: Ey
                                            })
                                        }
                                        )),
                                        s
                                    }(e, t, i), o = [], a = r.Random.int(1, 2), s = 0; s < a; s++)
                                        o = o.concat(my(e, t, i));
                                    return {
                                        id: QE.PREMIUM_LAND,
                                        phases: [function(e) {}
                                        , function(e) {
                                            n.kill(),
                                            o.forEach((function(e) {
                                                return e.kill()
                                            }
                                            )),
                                            e.goToNextPhase()
                                        }
                                        ]
                                    }
                                }(e, this.services.axonometricProjection, this.services.mapGridView),
                                t.addToQueue(i),
                                t.play(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._lockedObjectRemoved = function(e) {
                    this._getAnimationTaskQueue(e).goToNextPhase()
                }
                ,
                t
            }(Pd), Sy = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.ObjectDestruction], this._onObjectDestructionBehaviorAttached, this._onObjectDestructionBehaviorRemoved),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onObjectDestructionBehaviorAttached = function(e) {
                    var t = e.getBehavior(Ke.ObjectDestruction);
                    e.removeBehavior(t)
                }
                ,
                t.prototype._onObjectDestructionBehaviorRemoved = function(e) {
                    this._worldService.removeGameObject(e)
                }
                ,
                t
            }(Pd), Oy = {
                regular_1: m.MERGE_TIER1_01,
                regular_2: m.MERGE_TIER1_02,
                regular_3: m.MERGE_TIER1_03,
                regular_4: m.MERGE_TIER1_04,
                regular_5: m.MERGE_TIER1_05,
                regular_6: m.MERGE_TIER1_06,
                regular_7: m.MERGE_TIER1_06,
                bonus_1: m.MERGE_TIER2_01,
                bonus_2: m.MERGE_TIER2_02,
                bonus_3: m.MERGE_TIER2_03,
                bonus_4: m.MERGE_TIER2_04,
                bonus_5: m.MERGE_TIER2_05,
                bonus_6: m.MERGE_TIER2_06,
                bonus_7: m.MERGE_TIER2_06
            }, by = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.PlaySoundTrigger, Ke.Sounds], this._onCrateOpened),
                            this.addFamily([Ke.LootTrigger], this._onLootSpawned),
                            this.addFamily([Ke.PlaySoundTrigger, Ke.MergeResult], this._onMergeHappened),
                            this.addFamily([Ke.Trainstation, Ke.InteractionTap], this._onTrainStationTap),
                            this.addFamily([Ke.InteractionPick], this._onObjectClick),
                            this.addFamily([Ke.InteractionTap], this._onObjectClick),
                            this.addFamily([Ke.InteractionDropStart], this._onObjectDrop),
                            this.addFamily([Ke.Ingredient, Ke.InteractionTap], this._onIngredientCollected),
                            this.addFamily([Ke.Coin, Ke.InteractionTap], this._onCoinCollected),
                            this.addFamily([Ke.Building, Ke.Upgrade], null, this._onBuildingRepaired),
                            this.addFamily([Ke.FriendReward, Ke.InteractionTap], this._onFriendRewardCollect),
                            this.addFamily([Ke.MapSource, Ke.InteractionTap], this._onTreeClick),
                            this.addFamily([Ke.WorkerData, Ke.PlaySoundTrigger], this._onWorkerAdded),
                            this.services.ordersService.onOrderStateChange.addListener(this._onOrderStateChange, this),
                            this.services.ordersService.onOrderRewarded.addListener(this._onOrderRewarded, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.ordersService.onOrderStateChange.removeListener(this._onOrderStateChange, this),
                            this.services.ordersService.onOrderRewarded.removeListener(this._onOrderRewarded, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onOrderStateChange = function(e) {
                    e.state !== ps.STARTABLE && e.state !== ps.COMPLETE || De.services.audio.playSoundEffect(m.POPOUT_APPEARS)
                }
                ,
                t.prototype._onMergeHappened = function(e) {
                    var t = e.getBehavior(Ke.PlaySoundTrigger).mergeData;
                    if (t)
                        if (t.tier < 0)
                            this._logger.warn("There is no sounds for merge of tire: ".concat(t.tier));
                        else {
                            var i = Object.entries(Oy).length / 2
                              , n = Math.min(t.tier, i)
                              , r = "".concat(t.isBonus ? "bonus" : "regular", "_").concat(n);
                            De.services.audio.playSoundEffect(Oy[r])
                        }
                }
                ,
                t.prototype._onCrateOpened = function(e) {
                    var t, i = e.getBehavior(Ke.PlaySoundTrigger).spawnData;
                    i && De.services.blueprintGraphService.getGraphFromBlueprintID(i.blueprintID) && (t = e.getBehavior(Ke.Sounds).revealSound,
                    De.services.audio.playSoundEffect(t),
                    e.removeBehaviorByType(Ke.PlaySoundTrigger))
                }
                ,
                t.prototype._onLootSpawned = function() {
                    De.services.audio.playSoundEffect(m.SPAWN_OBJECT)
                }
                ,
                t.prototype._onTrainStationTap = function() {
                    De.services.audio.playSoundEffect(m.TRAINSTATION_INTERACTION)
                }
                ,
                t.prototype._onObjectClick = function(e) {
                    [Ke.Collectable, Ke.Trainstation, Ke.AreaLock, Ke.MapSource].some((function(t) {
                        return e.hasBehavior(t)
                    }
                    )) || De.services.audio.playSoundEffect(m.OBJECT_PICKUP)
                }
                ,
                t.prototype._onObjectDrop = function() {
                    De.services.audio.playSoundEffect(m.OBJECT_DROP)
                }
                ,
                t.prototype._onIngredientCollected = function() {
                    De.services.audio.playSoundEffect(m.COLLECT_INGREDIENT)
                }
                ,
                t.prototype._onCoinCollected = function() {
                    De.services.audio.playSoundEffect(m.COINS_TAPPED)
                }
                ,
                t.prototype._onBuildingRepaired = function() {
                    De.services.audio.playSoundEffect(m.BUILDING_REPAIRED)
                }
                ,
                t.prototype._onFriendRewardCollect = function() {
                    De.services.audio.playSoundEffect(m.FRIEND_VISIT_ACTIVTY)
                }
                ,
                t.prototype._onOrderRewarded = function() {
                    De.services.audio.playSoundEffect(m.PURCHASE_COMPLETE)
                }
                ,
                t.prototype._onTreeClick = function(e) {
                    var t = e.getBehavior(Ke.MapSource).sourceType === Kt.TREE ? m.SELECT_TREE : m.OBJECT_PICKUP;
                    De.services.audio.playSoundEffect(t)
                }
                ,
                t.prototype._onWorkerAdded = function(e) {
                    var t = e.getBehavior(Ke.PlaySoundTrigger).workersData;
                    if (t) {
                        var i = t.sourceType === Kt.TREE ? m.CHOP_WOOD : m.CHOP_ROCK;
                        De.services.audio.playSoundEffect(i),
                        e.removeBehaviorByType(Ke.PlaySoundTrigger)
                    }
                }
                ,
                t
            }(Pd);
            !function(e) {
                e.DECORATIVE_TOILET = "decorative_toilet",
                e.DECORATIVE_WINDMILL = "decorative_windmill",
                e.DECORATTIVE_CHICKENCOOP = "decorative_chickencoop"
            }(Cy || (Cy = {}));
            var Ry, wy = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Discovery], this._onDiscoveryAdded),
                            De.services.discovery.newUnclaimedDiscoveryMade(E_.MARKET + Yv),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onDiscoveryAdded = function(e) {
                    e.removeBehaviorByType(Ke.Discovery);
                    var t = e.getBlueprintID();
                    -1 === De.services.discovery.discoveryWhiteList.indexOf(t) || De.services.discovery.isDiscoveryMade(e.getBlueprintID()) || Object.values(E_).includes(t) || Object.values(Cy).includes(t) || De.services.discovery.newUnclaimedDiscoveryMade(e.getBlueprintID())
                }
                ,
                t
            }(Pd);
            !function(e) {
                e.TOP = "top",
                e.MIDDLE_BOTTOM = "middle_bottom",
                e.BOTTOM = "bottom",
                e.BOTTOM_RIGHT = "bottom_right"
            }(Ry || (Ry = {}));
            var Dy, Ny, Ly, By, Py, ky, xy = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.HIGH,
                    i._name = "BuildingCompletePopup",
                    i._canClose = !1,
                    i._dialogService = t.dialogService,
                    i._buildingID = t.buildingID,
                    i._inputBlocker.off("pointerup", void 0, i),
                    i.onOpened.listenOnce((function() {
                        i._inputBlocker.once("pointerup", i.close, i)
                    }
                    ), i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a, s, _, c, l, u = this;
                        return (0,
                        n.__generator)(this, (function(d) {
                            switch (d.label) {
                            case 0:
                                if (De.services.adsService.hideBannerAd(),
                                e(),
                                !(t = De.services.buildings.getBuildingLevelConfig(this._buildingID).discoverOverlay))
                                    throw new Error("missing discover overlay config for building ".concat(this._buildingID));
                                if (!t.titleKey)
                                    throw new Error("missing titleKey config for building ".concat(this._buildingID));
                                return (i = new v.LabelSettings({
                                    fitToBox: !0,
                                    fitWidth: 877,
                                    fitHeight: 200
                                })).style = vn.buildingRepairedText,
                                o = this.createReferenceLabel(nr(Dy || (Dy = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), {
                                    alias: t.titleKey
                                }), i),
                                a = De.services.resource.getTexture({
                                    alias: t.newImageKey
                                }),
                                this._beamsAnimation = this.addChild(De.services.resource.getSpine(se.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP)),
                                this._beamsAnimation.alpha = 0,
                                this._genericFadeAnimation = new ur(B_),
                                this._genericFadeAnimation.setTargets({
                                    container: this._beamsAnimation
                                }),
                                this._moveAndScaleAnimation = new ur(_v),
                                this._moveAndScaleAnimation.setTargets({
                                    container: this._beamsAnimation
                                }),
                                this._repairedAnimation = this.addChild(De.services.resource.getSpine(se.BUILDING_REPAIR)),
                                this._repairedAnimation.skeleton.findSlot("btn_rank_level_circle").currentSprite.alpha = 0,
                                this._repairedAnimation.skeleton.findBone("confetti total").data.scaleX = 1,
                                this._repairedAnimation.skeleton.findBone("confetti total").data.scaleY = 1,
                                (s = this._repairedAnimation.skeleton.findSlot("obj_building")).currentSprite.texture = a,
                                this._repairedAnimation.skeleton.findSlot("obj_building_glow").currentSprite.texture = a,
                                this._repairedAnimation.skeleton.findSlot("obj_building_broken").currentSprite.texture = a,
                                this._repairedAnimation.skeleton.findSlot("obj_building_broken_glow").currentSprite.texture = a,
                                (_ = this._repairedAnimation.skeleton.findSlot("building_repair_txt")).currentSprite.texture = o.texture,
                                this._repairedAnimation.state.setAnimation(0, C.BUILDING_APPEAR, !1),
                                this._repairedAnimation.y = s.currentSprite.height / 2,
                                _.currentSprite.position.y = this._repairedAnimation.height + De.services.canvas.height / 4,
                                this._beamsAnimation.y = s.currentSprite.height / 2,
                                this._repairedAnimation.state.addListener({
                                    event: function(e, t) {
                                        "light_beam_appear" === t.data.name && (u._genericFadeAnimation.play("fadeIn"),
                                        u._beamsAnimation.state.setAnimation(0, k.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP, !0))
                                    }
                                }),
                                this._dialogService.setCurrentDialogData({
                                    npc: {
                                        image: De.services.buildings.getBuildingConfigProperty(this._buildingID, "npcIconKey"),
                                        line: t.messageKey,
                                        positionPortrait: Ry.MIDDLE_BOTTOM,
                                        positionLandscape: Ry.MIDDLE_BOTTOM
                                    }
                                }),
                                this._dialogService.showDialog(),
                                (c = new v.LabelSettings({
                                    fitToBox: !1
                                })).style = vn.lvlUpContinueText,
                                l = De.services.canvas.bottom,
                                this._tapToContinueText = new v.Label(nr(Ny || (Ny = (0,
                                n.__makeTemplateObject)(["", "$"], ["", "$"])), ce.TAP_TO_CONTINUE),c),
                                this._tapToContinueText.anchor.set(.5),
                                this._tapToContinueText.position.set(200, l - 300),
                                this._tapToContinueText.scale.set(0),
                                this.addChild(this._tapToContinueText),
                                this._tapToContinueAnimation = new ur(U_),
                                this._tapToContinueAnimation.setTargets({
                                    continueText: this._tapToContinueText
                                }),
                                [4, r.TimeDelay.after(3e3).promise];
                            case 1:
                                return d.sent(),
                                this._tapToContinueAnimation.play("appear"),
                                this._tapToContinueAnimation.onEnd.listenOnce((function(e) {
                                    u._canClose = !0,
                                    "appear" === e && u._tapToContinueAnimation.play("loop")
                                }
                                ), this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    De.services.adsService.setBannerInterval(),
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._options = {}
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._repairedAnimation.state.getCurrent(0).animation.name === C.BUILDING_HIDE ? [2] : (this._tapToContinueAnimation.stop("loop"),
                                this._tapToContinueAnimation.play("hide"),
                                this._repairedAnimation.state.setAnimation(0, C.BUILDING_HIDE, !1),
                                this._moveAndScaleAnimation.play("moveAndScale"),
                                this._genericFadeAnimation.play("fadeOut"),
                                [4, this._dialogService.hideDialog()]);
                            case 1:
                                return t.sent(),
                                e.prototype.close.call(this),
                                De.services.actions.emit("discoveredBuilding." + this._buildingID),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._tryToClose = function(t) {
                    this._canClose && e.prototype._tryToClose.call(this, t)
                }
                ,
                t
            }(yr), Gy = function(e) {
                function t() {
                    var t = e.call(this, {
                        basePopoutType: Bd.CLOSED_ONLY,
                        hasIdleAnimation: !0
                    }) || this;
                    return t._closeContainer.addChild(rr(De.services.resource.getSprite(f.BALLOON_NOTIFICATION_REPAIR), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: .666,
                            y: .666
                        }
                    })),
                    t._closeContainer.position.set(t._closeContainer.position.x, t._closeContainer.position.y),
                    t._background.alpha = 0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t
            }(Gd), Uy = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._activeUndiscoveredPopouts = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Building, Ke.UndiscoveredBuilding, Ke.GridPosition], this._onUndiscoveredBuildingAttached, this._onUndiscoveredBuildingDetached),
                            this.addFamily([Ke.Building, Ke.UndiscoveredBuilding, Ke.InteractionTap, Ke.InteractionPriorityTurn, Ke.GridPosition], this._onInteractionAdded),
                            this.addFamily([Ke.Building, Ke.GridPosition, Ke.UndiscoveredBuilding, Ke.Harvestable], this._onUndiscoveredHarvestableBuildingAdded),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onUndiscoveredHarvestableBuildingAdded = function(e) {
                    var t, i;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r, o, a, s, _ = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return (r = e.getBehavior(Ke.Building)) ? (o = r.ID,
                            (a = De.services.buildings.getBuildingLevelConfig(o).discoverOverlay) ? (s = a.atlasKey,
                            Promise.all([De.services.assetLoader.loadAtlases({
                                alias: s
                            }), De.services.lazyLoad.prioritizeGroup(hn.BUILDING_REPAIRED_ANIMATION)]).then((function() {
                                De.services.navigation.showPopup(xy, {
                                    dialogService: _.services.dialogService,
                                    buildingID: o
                                })
                            }
                            )),
                            null === (i = this._activeUndiscoveredPopouts.get(e)) || void 0 === i || i.destroy(),
                            e.removeBehaviorByType(Ke.UndiscoveredBuilding),
                            e.removeBehaviorByType(Ke.Upgrade),
                            De.services.buildings.setBuildingActive(r.ID, !1),
                            [2]) : (this._logger.error("missing discover overlay config for building ".concat(o)),
                            null === (t = this._activeUndiscoveredPopouts.get(e)) || void 0 === t || t.destroy(),
                            [2])) : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onUndiscoveredBuildingAttached = function(e) {
                    this._addUndiscoveredPopout(e)
                }
                ,
                t.prototype._onInteractionAdded = function(e) {
                    var t, i = this;
                    if (e.getBehavior(Ke.InteractionPriorityTurn).group === Fd.DISCOVER_BUILDING) {
                        var n = e.getBehavior(Ke.Building);
                        n && (De.services.buildings.setBuildingUpgrading(n.ID),
                        De.services.actions.emit("discoveredBuilding." + n.ID),
                        e.removeBehaviorByType(Ke.UndiscoveredBuilding),
                        null === (t = this._activeUndiscoveredPopouts.get(e)) || void 0 === t || t.destroy(),
                        r.TimeDelay.nextFrame().then((function() {
                            i.services.interactionHelper.simulateClick.fire(e)
                        }
                        )))
                    }
                }
                ,
                t.prototype._addUndiscoveredPopout = function(e) {
                    var t = new Gy
                      , i = e.getBehavior(Ke.GridPosition);
                    this.services.mapGridView.getLayer(Yo.POPOUTS).addChild(t);
                    var n = this.services.axonometricProjection.getWorldPosition(i.column, i.row);
                    t.position.copyFrom(n),
                    t.show(!0),
                    this._activeUndiscoveredPopouts.set(e, t)
                }
                ,
                t.prototype._onUndiscoveredBuildingDetached = function(e) {
                    var t;
                    null === (t = this._activeUndiscoveredPopouts.get(e)) || void 0 === t || t.destroy()
                }
                ,
                t
            }(Pd), Fy = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._maskFillValue = 0,
                    t._activeUi = {
                        spine: void 0,
                        fill: void 0
                    },
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.PickupBuildingStart], this._onBuildingPickupStarted, this._onLongpressCanceledOrEnded),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onBuildingPickupStarted = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, o, a = this;
                        return (0,
                        n.__generator)(this, (function(s) {
                            switch (s.label) {
                            case 0:
                                return this._clearActiveUi(),
                                t = e.getBehavior(Ke.GridPosition),
                                i = e.getBehavior(Ke.PickupBuildingStart),
                                (o = this.services.axonometricProjection.getWorldPosition(t.column, t.row)).y -= 300,
                                this._activeUi.spine = De.services.resource.getSpine(se.PICKUP_BUILDING),
                                this._activeUi.spine.state.setAnimation(0, z.ARROW_IN, !1),
                                this._activeUi.spine.state.addListener({
                                    complete: function() {
                                        return (0,
                                        n.__awaiter)(a, void 0, void 0, (function() {
                                            var t, r = this;
                                            return (0,
                                            n.__generator)(this, (function(n) {
                                                return this._activeUi.spine && (this._activeUi.fill = rr(De.services.resource.getSprite(f.ICON_ARROW_FILLING), {
                                                    anchor: {
                                                        x: .5,
                                                        y: .5
                                                    },
                                                    position: {
                                                        x: 0,
                                                        y: -15
                                                    }
                                                }),
                                                t = (new Xe.Graphics).beginFill(0).drawRect(-this._activeUi.fill.width / 2, this._activeUi.fill.height / 2, this._activeUi.fill.width, 0).endFill(),
                                                this._activeUi.fill.mask = t,
                                                this._activeUi.spine.addChild(this._activeUi.fill, t),
                                                this._maskFillValue = 0,
                                                this._timeline = lr.gsap.timeline(),
                                                this._timeline.add(lr.gsap.to(this, {
                                                    _maskFillValue: -this._activeUi.fill.height - 55,
                                                    duration: i.pickupTime / 1e3
                                                })),
                                                this._timeline.eventCallback("onUpdate", (function() {
                                                    r._activeUi.fill && r._activeUi.spine && (t.clear(),
                                                    t.beginFill(0).drawRect(-r._activeUi.fill.width / 2, r._activeUi.fill.height / 2, r._activeUi.fill.width, r._maskFillValue).endFill())
                                                }
                                                )),
                                                this._timeline.eventCallback("onComplete", (function() {
                                                    r._onTimerComplete(e)
                                                }
                                                ))),
                                                [2]
                                            }
                                            ))
                                        }
                                        ))
                                    }
                                }),
                                [4, r.TimeDelay.after(100).promise];
                            case 1:
                                return s.sent(),
                                this._activeUi.spine && (this.services.mapGridView.getLayer(Yo.FLOATERS).addChild(this._activeUi.spine),
                                this._activeUi.spine.position.copyFrom(o)),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onLongpressCanceledOrEnded = function() {
                    this._clearActiveUi()
                }
                ,
                t.prototype._onTimerComplete = function(e) {
                    var t = this;
                    this._timeline && this._timeline.kill(),
                    e.addBehavior(new Ki),
                    this._activeUi.spine && (this._activeUi.fill && (this._activeUi.spine.removeChild(this._activeUi.fill),
                    this._activeUi.fill.destroy()),
                    this._activeUi.spine.state.setAnimation(0, z.ARROW_OUT, !1),
                    this._activeUi.spine.state.addListener({
                        complete: function() {
                            return (0,
                            n.__awaiter)(t, void 0, void 0, (function() {
                                return (0,
                                n.__generator)(this, (function(e) {
                                    switch (e.label) {
                                    case 0:
                                        return [4, r.TimeDelay.nextFrame()];
                                    case 1:
                                        return e.sent(),
                                        this._clearActiveUi(),
                                        [2]
                                    }
                                }
                                ))
                            }
                            ))
                        }
                    }))
                }
                ,
                t.prototype._clearActiveUi = function() {
                    this._timeline && this._timeline.kill(),
                    this._activeUi.spine && (this._activeUi.spine.destroy(),
                    this._activeUi.spine = void 0)
                }
                ,
                t
            }(Pd), My = "BUBBLE_SPINE", Vy = "BUBBLE_CONTENT", Hy = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadSpines(se.BALLOON_DETACHED_OBJECTS)];
                            case 1:
                                return e.sent(),
                                this.addFamily([Ke.StorageBubblePop], this._initiateBubblePop),
                                this.addFamily([Ke.StorageBubble, Ke.StorageBubbleShowContent], this._showContent),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showContent = function(e) {
                    var t = e.getBehavior(Ke.StorageBubbleShowContent);
                    e.removeBehaviorByType(Ke.StorageBubbleShowContent);
                    var i = e.getBehavior(Ke.StorageBubble);
                    if (i) {
                        var n = this.services.storageBubble.getBubbleContainers(e).contentContainer;
                        this._addContentPreviews(e, n, i, t.enableInteraction)
                    }
                }
                ,
                t.prototype._initiateBubblePop = function(e) {
                    var t = this;
                    e.removeBehaviorByType(Ke.StorageBubblePop);
                    var i = this.services.storageBubble.getBubbleContainers(e)
                      , o = i.bubbleSpine;
                    i.contentContainer.removeChildren(),
                    o.state.clearListeners(),
                    o.state.clearTracks(),
                    o.state.setAnimation(0, A.POP, !1),
                    o.state.addListener({
                        complete: function() {
                            return (0,
                            n.__awaiter)(t, void 0, void 0, (function() {
                                return (0,
                                n.__generator)(this, (function(t) {
                                    switch (t.label) {
                                    case 0:
                                        return [4, r.TimeDelay.nextFrame()];
                                    case 1:
                                        return t.sent(),
                                        o.destroy(),
                                        e.destroy(),
                                        this.services.mapGridView.getLayer(Yo.STORAGE_BUBBLES).removeChild(e),
                                        this.services.storageBubble.removeBubble(e),
                                        [2]
                                    }
                                }
                                ))
                            }
                            ))
                        }
                    })
                }
                ,
                t.prototype._addContentPreviews = function(e, t, i, n) {
                    void 0 === n && (n = !0),
                    t.removeChildren();
                    for (var r = lr.gsap.timeline(), o = Math.min(3, i.content.length), a = 240 / (o + 1), s = a / 2 * (o - 1), _ = i.content.length - 1; _ >= i.content.length - o; _--)
                        if (i.content[_]) {
                            var c = this._getSpriteForContent(i.content[_])
                              , l = ds(c, 200).scale.clone()
                              , u = o - (i.content.length - _);
                            c.x += s - u * a,
                            c.y += 100 - 10 * u,
                            r.add(lr.gsap.set(c.scale, {
                                x: 0,
                                y: 0
                            }), 0),
                            r.add(lr.gsap.to(c.scale, {
                                x: l.x,
                                y: l.y,
                                duration: .3
                            }), 0),
                            t.addChild(c)
                        }
                    r.eventCallback("onComplete", (function() {
                        r.kill(),
                        !e.hasBehavior(Ke.StorageBubbleInteractable) && n && e.addBehavior(new xi({}))
                    }
                    ))
                }
                ,
                t.prototype._getSpriteForContent = function(e) {
                    var t, i = De.services.blueprintCollection.getBlueprint(e.blueprint), n = f.OVERLAY_BONUS_FRIEND, r = i.components.sprite || {}, o = i.components.spine || {}, a = i.components.building || {};
                    a.ID ? n = {
                        alias: De.services.buildings.getBuildingLevelConfig(a.ID).visualKeys.active
                    } : r.alias ? n = {
                        alias: r.alias
                    } : o.alias && o.startingState && o.uiImage && (n = {
                        alias: o.uiImage
                    });
                    var s = De.services.resource.getSprite(n);
                    s.pivot.copyFrom(r.pivot || vi.pivot),
                    s.anchor.set(.5, 1),
                    s.position.set(0);
                    var _ = (null === (t = e.data) || void 0 === t ? void 0 : t.upgradeCard) || {};
                    if (_ && _.targetObjectTreeIngredient) {
                        var c = rr(De.services.resource.getSprite(df[_.targetObjectTreeIngredient]), {
                            anchor: {
                                x: .5,
                                y: .5
                            }
                        });
                        s.addChild(c)
                    }
                    return s
                }
                ,
                t
            }(Pd), jy = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._interactionStartTime = 0,
                    t._interactionStartPosition = new Xe.Point,
                    t._isDragging = !1,
                    t._dragOffset = new Xe.Point,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._family = this.addFamily([Ke.StorageBubble, Ke.StorageBubbleInteractable], this._onBubbleBehaviorAttached, this._onBubbleBehaviorRemoved),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onBubbleBehaviorAttached = function(e) {
                    e.interactive = !0,
                    e.hitArea = new Xe.Circle(0,0,150),
                    e.on("pointerdown", this._onBubblePointerDown, this),
                    e.on("pointermove", this._onBubblePointerMove, this),
                    e.on("pointerupoutside", this._onBubblePointerUp, this),
                    e.on("pointerup", this._onBubblePointerUp, this)
                }
                ,
                t.prototype._onBubbleBehaviorRemoved = function(e) {
                    e.interactive = !1,
                    e.off("pointerdown", this._onBubblePointerDown, this),
                    e.off("pointermove", this._onBubblePointerMove, this),
                    e.off("pointerupoutside", this._onBubblePointerUp, this),
                    e.off("pointerup", this._onBubblePointerUp, this)
                }
                ,
                t.prototype._onBubblePointerDown = function(e) {
                    if (!this._activeInteractionTarget) {
                        var t = this._getGameobjectMatchingInteraction(e);
                        if (t) {
                            this._activeInteractionTarget = t,
                            this._interactionStartTime = Date.now(),
                            this._isDragging = !1,
                            this._dragOffset.copyFrom(e.data.getLocalPosition(this._activeInteractionTarget));
                            var i = e.data.getLocalPosition(this._activeInteractionTarget.parent);
                            this._interactionStartPosition.copyFrom(i)
                        }
                    }
                }
                ,
                t.prototype._onBubblePointerMove = function(e) {
                    if (this._activeInteractionTarget === e.currentTarget) {
                        var t = e.data.getLocalPosition(this._activeInteractionTarget.parent);
                        if (!this._isDragging) {
                            var i = this._interactionStartPosition.x - t.x
                              , n = this._interactionStartPosition.y - t.y;
                            i * i + n * n > 100 && (this._isDragging = !0)
                        }
                        this._isDragging && (t.x -= this._dragOffset.x,
                        t.y -= this._dragOffset.y,
                        this._activeInteractionTarget.replaceBehavior(new Pi({
                            position: t
                        })))
                    }
                }
                ,
                t.prototype._onBubblePointerUp = function(e) {
                    if (this._activeInteractionTarget !== e.currentTarget)
                        return this._logger.warn("pointer up on wrong target"),
                        void (this._activeInteractionTarget = void 0);
                    if (this._isDragging) {
                        this._activeInteractionTarget.removeBehaviorByType(Ke.StorageBubbleDrag);
                        var t = new ki({});
                        this._activeInteractionTarget.addBehavior(t),
                        this._activeInteractionTarget.removeBehavior(t)
                    } else if (Date.now() - this._interactionStartTime < 300) {
                        var i = new Mi({});
                        this._activeInteractionTarget.addBehavior(i),
                        this._activeInteractionTarget.removeBehavior(i)
                    }
                    this._activeInteractionTarget = void 0
                }
                ,
                t.prototype._getGameobjectMatchingInteraction = function(e) {
                    var t;
                    return this._family.forEach((function(i) {
                        i === e.currentTarget && (t = i)
                    }
                    )),
                    t
                }
                ,
                t.prototype._updateBubblePosition = function(e, t, i) {
                    e.position.copyFrom(t),
                    i && e.replaceBehavior(new Ii(t))
                }
                ,
                t
            }(Pd), Ky = 150, Wy = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._EDGE_PAN_DELAY = 500,
                    t._PAN_ACCELERATION_SENSITIVITY = .5,
                    t._PAN_MAX_SPEED = 50,
                    t._startDragTime = 0,
                    t._currentPanAcceleration = 0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.update = function(e, t) {
                    if (this._currentDraggedObject && this._currentDraggedObject.transform) {
                        var i = this._currentDraggedObject.position
                          , n = this.services.cameraService.getWorldToScreenPosition(i)
                          , r = !1;
                        if (this._isPositionOnPanningZone(n) ? r = Date.now() - this._startDragTime > this._EDGE_PAN_DELAY : this._currentPanAcceleration = 0,
                        r) {
                            var o = this._getMoveTranslation(this._currentDraggedObject);
                            this.services.cameraService.moveBy(o.scale(this._currentPanAcceleration)),
                            this._currentPanAcceleration = Math.min(this._currentPanAcceleration + e * this._PAN_ACCELERATION_SENSITIVITY, this._PAN_MAX_SPEED),
                            this._currentDraggedObject.position.copyFrom(this.services.cameraService.getScreenToWorldPosition(n))
                        }
                    }
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this.addFamily([Ke.StorageBubbleDrag], this._onBubbleDragBehaviorAttached),
                            this.addFamily([Ke.StorageBubbleDrop], this._onBubbleDropBehaviorAttached),
                            v.GroupsCore.Updateables.add(this),
                            (e = De.services.resource.getJson(_e.CAMERA_CONFIG)) && (0,
                            r.isNumber)(e.EDGE_PAN_DELAY) ? (this._EDGE_PAN_DELAY = e.EDGE_PAN_DELAY,
                            this._PAN_ACCELERATION_SENSITIVITY = e.PAN_ACCELERATION_SENSITIVITY,
                            this._PAN_MAX_SPEED = e.PAN_MAX_SPEED) : this._logger.error("invalid camera config, missing EDGE_PAN_DELAY"),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return v.GroupsCore.Updateables.remove(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onBubbleDragBehaviorAttached = function(e) {
                    this._currentDraggedObject || (this._currentDraggedObject = e,
                    this._startDragTime = Date.now(),
                    this._currentPanAcceleration = 0);
                    var t = e.getBehavior(Ke.StorageBubbleDrag);
                    this._updateBubblePosition(e, t.position, !1)
                }
                ,
                t.prototype._onBubbleDropBehaviorAttached = function(e) {
                    this._currentDraggedObject = void 0,
                    this._updateBubblePosition(e, e.position, !0)
                }
                ,
                t.prototype._updateBubblePosition = function(e, t, i) {
                    e.position.copyFrom(t),
                    i && e.replaceBehavior(new Ii(t))
                }
                ,
                t.prototype._isPositionOnPanningZone = function(e) {
                    var t = this.services.cameraService.getScreenBounds()
                      , i = -.5 * t.width
                      , n = .5 * t.width
                      , r = -.5 * t.height
                      , o = .5 * t.height;
                    return e.x <= i + Ky || e.y <= r + Ky || e.x >= n - Ky || e.y >= o - Ky
                }
                ,
                t.prototype._getMoveTranslation = function(e) {
                    var t = this.services.cameraService.getWorldToScreenPosition(e.position);
                    return v.Vector2.fromPoint(t).normalize().scale(-1)
                }
                ,
                t
            }(Pd), zy = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._family = this.addFamily([Ke.StorageBubble, Ke.StorageBubbleTap, Ke.StorageBubbleInteractable, Ke.WorldPosition], this._onStorageBubbleTapped),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onStorageBubbleTapped = function(e) {
                    var t = e.getBehavior(Ke.StorageBubble)
                      , i = e.getBehavior(Ke.WorldPosition)
                      , r = this.services.gridFilter.getEmptyCells().length;
                    if (0 !== r) {
                        for (var o = t.content.concat([]), a = this.services.visibleCells.getClosestEmptyToTheCenter(!0), s = []; r > 0 && o.length > 0; ) {
                            var _ = o.pop()
                              , c = De.services.gameObjectFactory.createFromSerializedData(_);
                            if (null !== c) {
                                var l = c.getBehavior(Ke.ExtendedTile);
                                if (l && (l.width > 1 || l.height > 1)) {
                                    var u = this.services.gridFilter.getClosestAvailable2x2CellSquare(a);
                                    if (!u) {
                                        s.push(_);
                                        continue
                                    }
                                    u.bottom.content = new ev,
                                    l.width > 1 && (u.left.content = new ev,
                                    r -= 1),
                                    l.height > 1 && (u.right.content = new ev,
                                    r -= 1),
                                    l.width > 1 && l.height > 1 && (u.top.content = new ev,
                                    r -= 1),
                                    this._spawnExtendedObject(c, u.bottom, new Xe.Point(i.x,i.y)),
                                    r -= 1
                                } else
                                    this._spawnObject(c, a, new Xe.Point(i.x,i.y)),
                                    r--
                            } else
                                this._logger.error("failed to create gameobject for storage bubble content with blueprint id ".concat(_.blueprint))
                        }
                        if (o.length > 0 || s.length > 0) {
                            this._showNotEnoughSpaceFloater();
                            var d = new Bi({
                                content: (0,
                                n.__spreadArray)((0,
                                n.__spreadArray)([], o, !0), s, !0)
                            });
                            e.replaceBehavior(d),
                            e.replaceBehavior(new Ui({
                                enableInteraction: !0
                            }))
                        } else
                            e.removeBehaviorByType(Ke.StorageBubbleInteractable),
                            e.addBehavior(new Gi({}))
                    } else
                        this._showNotEnoughSpaceFloater()
                }
                ,
                t.prototype._spawnObject = function(e, t, i) {
                    this._worldService.addGameObject(e),
                    e.addBehavior(new tt({
                        startPosition: i
                    }));
                    var n = new et({
                        rootPosition: t
                    });
                    e.addBehavior(n),
                    e.addBehavior(new Hi)
                }
                ,
                t.prototype._spawnExtendedObject = function(e, t, i) {
                    this._worldService.addGameObject(e),
                    e.addBehavior(new tt({
                        startPosition: i
                    }));
                    var n = new $t({
                        targetPosition: t
                    });
                    e.addBehavior(n),
                    e.addBehavior(new Hi)
                }
                ,
                t.prototype._showNotEnoughSpaceFloater = function() {
                    var e = v.Vector2.fromPoint(this.services.cameraService.getCameraPosition())
                      , t = this.services.cameraService.getCameraScale();
                    e.x /= t.x,
                    e.y /= t.y,
                    new rf(this.services.mapGridView.getLayer(Yo.FLOATERS),e,{
                        text: De.services.localization.getText(ce.NOT_ENOUGH_SPACE),
                        styles: vn.warningText
                    })
                }
                ,
                t
            }(Pd), Yy = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.update = function(e, t) {
                    var i = this._familyUpdate.getGameObjects();
                    if (i.length > 0)
                        for (var n = 0, r = i; n < r.length; n++) {
                            var o = r[n]
                              , a = o.getBehavior(Ke.Interpolation)
                              , s = a.endPosition.clone()
                              , _ = a.dragType === Ut.SLOW ? .12 : .4
                              , c = s.substract(a.startPosition).scale(e * _).add(a.startPosition)
                              , l = o.position.clone()
                              , u = new v.Vector2(l.x,l.y).distance(a.endPosition)
                              , d = c.distance(a.endPosition)
                              , h = d > u;
                            o.position = c,
                            a.startPosition = c,
                            (h || d <= .1) && (o.position.copyFrom(a.endPosition),
                            o.hasBehavior(Ke.InteractionDrag) || o.removeBehavior(a))
                        }
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._familyUpdate = this.addFamily([Ke.Interpolation]),
                            v.GroupsCore.Updateables.add(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return v.GroupsCore.Updateables.remove(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Pd), Jy = i(2213), Xy = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._rainToObjectMap = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.RainImpact, Ke.GridPosition, Ke.ExtendedTile], this._addRainImpactAnimation, this._deleteRainImpactAnimation),
                            this.addFamily([Ke.RainImpact, Ke.Building, Ke.InteractionPick], this._deleteRainImpactAnimation),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._rainToObjectMap.forEach((function(e) {
                                return e.destroy()
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._addRainImpactAnimation = function(e) {
                    var t = "delivery_truck" === e.getBlueprintID();
                    if ((e.hasBehavior(Ke.Building) || e.hasBehavior(Ke.HeavyObject) || e.hasBehavior(Ke.Trainstation) || t) && !this._rainToObjectMap.get(e)) {
                        var i = e.getBehavior(Ke.GridPosition)
                          , n = [De.services.resource.getTexture(t ? f.RAIN_SPATTER_TRAIN01 : f.RAIN_SPATTER_01), De.services.resource.getTexture(t ? f.RAIN_SPATTER_TRAIN02 : f.RAIN_SPATTER_02), De.services.resource.getTexture(t ? f.RAIN_SPATTER_TRAIN03 : f.RAIN_SPATTER_03)]
                          , r = new Jy.AnimatedSprite(n,!0);
                        r.animationSpeed = .33,
                        r.loop = !0,
                        r.play(),
                        r.anchor.set(.5);
                        var o = this.services.axonometricProjection.getWorldPosition(i.column, i.row);
                        r.position.copyFrom(o),
                        e.getBehavior(Ke.ExtendedTile).height > 1 && !t ? r.position.y -= 125 : t ? (r.position.y -= 125,
                        r.position.x += 125) : (r.scale.set(.7),
                        r.position.y += 50),
                        this.services.mapGridView.getLayer(Yo.WORLD_ANIMATION).addChild(r),
                        this._rainToObjectMap.set(e, r)
                    }
                }
                ,
                t.prototype._deleteRainImpactAnimation = function(e) {
                    var t;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            return this._rainToObjectMap.get(e) ? (null === (t = this._rainToObjectMap.get(e)) || void 0 === t || t.destroy(),
                            this._rainToObjectMap.delete(e),
                            [2]) : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Pd), qy = function(e) {
                function t(t) {
                    var i, n = this;
                    return (n = e.call(this, t) || this).priority = _r.IMMEDIATE,
                    n._name = "ItemsMissingPopup",
                    n._headerSize = {
                        width: 1e3 / 1.5,
                        height: 75
                    },
                    n._popupSize = {
                        width: 1e3,
                        height: 750
                    },
                    n._totalCost = 0,
                    n._missingItems = t.missingItems,
                    n._marketplaceService = t.marketPlaceService,
                    n._gridFilter = t.gridFilter,
                    n._worldService = t.worldService,
                    n._mapGridView = t.mapGridView,
                    n._visibleCells = t.visibleCells,
                    n._storageBubble = t.storageBubble,
                    n._onSuccesfullPurchaseCallback = t.onSuccesfullPurchaseCallback,
                    n._targetObject = t.targetObject,
                    null === (i = n._targetObject) || void 0 === i || i.onBehaviorAdded.addListener(n._onTargetObjectBehaviorAdded, n),
                    n.addServices({}),
                    n._createPopup(),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._close = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return null === (e = this._targetObject) || void 0 === e || e.onBehaviorAdded.removeListener(this._onTargetObjectBehaviorAdded, this),
                                this._button.onClick((function() {}
                                )),
                                [4, this.close()];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createPopup = function() {
                    var e = this._createPopupBackground()
                      , t = this._createPopupContent()
                      , i = this._createPurchaseButton({
                        position: {
                            x: 0,
                            y: 275
                        }
                    });
                    this._content.addChild(e),
                    this._content.addChild(t),
                    this._content.addChild(i)
                }
                ,
                t.prototype._createPopupBackground = function() {
                    var e = this
                      , t = new Ar({
                        size: this._popupSize,
                        headerSize: this._headerSize,
                        headerText: ce.MISSING_INGREDIENTS_POPUP_HEADER,
                        headerStyle: vn.popoutTitle
                    });
                    return t.onCloseClick((function() {
                        return e._close()
                    }
                    )),
                    t
                }
                ,
                t.prototype._createPopupContent = function() {
                    var e = new Xe.Container;
                    return this._createPurchaseText({
                        parent: e,
                        text: nr(Ly || (Ly = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.MISSING_INGREDIENTS_POPUP_MESSAGE),
                        position: {
                            x: 0,
                            y: -200
                        }
                    }),
                    this._createMissingIngredientIcons({
                        parent: e,
                        missingItems: this._missingItems
                    }),
                    e
                }
                ,
                t.prototype._createPurchaseText = function(e) {
                    var t = e.parent
                      , i = e.text
                      , n = e.position
                      , r = new Xe.Text(i,vn.darkMedium);
                    r.anchor.x = .5,
                    r.anchor.y = .5,
                    r.y = n.y,
                    r.x = n.x,
                    t.addChild(r)
                }
                ,
                t.prototype._createIcon = function(e) {
                    var t = e.parent
                      , i = e.position
                      , n = e.asset
                      , r = rr(De.services.resource.getSprite(n), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: i.x,
                            y: i.y
                        }
                    });
                    return t.addChild(r),
                    r
                }
                ,
                t.prototype._createIngredientAmountText = function(e) {
                    var t = e.parent
                      , i = e.position
                      , n = e.amount
                      , r = new Xe.Text("".concat(n),vn.darkMedium);
                    r.anchor.x = .5,
                    r.anchor.y = .5,
                    r.y = i.y,
                    r.x = i.x,
                    t.addChild(r)
                }
                ,
                t.prototype._createMissingIngredientIcons = function(e) {
                    var t = this
                      , i = e.parent
                      , n = e.missingItems;
                    n.forEach((function(e, r) {
                        var o = {
                            x: -225 * r + 112.5 * (n.length - 1),
                            y: 0
                        }
                          , a = new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN02_9SLICE),10,10,10,10);
                        a.setSizes({
                            width: 200,
                            height: 200
                        }),
                        a.anchor.x = .5,
                        a.anchor.y = .5,
                        a.x = o.x,
                        a.y = o.y,
                        i.addChild(a);
                        var s = t._createIcon({
                            parent: i,
                            position: o,
                            asset: e.image
                        });
                        t._updateTotalCost({
                            item: e
                        }),
                        t._createIngredientAmountText({
                            parent: s,
                            amount: e.totalRequired - e.currentAmount,
                            position: {
                                x: 0,
                                y: o.y + 150
                            }
                        })
                    }
                    ))
                }
                ,
                t.prototype._updateTotalCost = function(e) {
                    var t = e.item
                      , i = De.services.resource.getJson(_e.ITEM_PURCHASE_COSTS_CONFIG).ingredients.filter((function(e) {
                        return e.key === t.objectName
                    }
                    ))[0]
                      , n = i ? i.costPerUnit : 0;
                    this._totalCost += n * (t.totalRequired - t.currentAmount)
                }
                ,
                t.prototype._createPurchaseButton = function(e) {
                    var t = e.position
                      , i = new Xe.Container;
                    return this._button = new uc({
                        name: "purchase",
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE
                    },{
                        buttonSizes: {
                            width: 225,
                            height: 80
                        }
                    },{
                        text: "".concat(this._totalCost),
                        textStyle: vn.buttonLabel,
                        alignment: "left",
                        position: {
                            x: 10,
                            y: -5
                        }
                    },{
                        iconImage: f.ICON_BTN_GEM,
                        iconAlignment: "right",
                        iconPosition: {
                            x: -10,
                            y: -5
                        },
                        iconScale: {
                            x: 1,
                            y: 1
                        }
                    }),
                    this._button.onClick(this._attemptPayment.bind(this)),
                    this._button.x = t.x,
                    this._button.y = t.y,
                    i.addChild(this._button),
                    i
                }
                ,
                t.prototype._attemptPayment = function() {
                    this._reportAnalytics();
                    var e = {
                        amount: this._totalCost,
                        key: Cn.GEMS
                    };
                    De.services.inventory.hasEnoughItems([e]) ? (De.services.inventory.spendAmount(e.key, this._totalCost),
                    this._onSuccesfullPayment()) : this._marketplaceService.openMarketplaceShop(Ua.GEMS)
                }
                ,
                t.prototype._onSuccesfullPayment = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return (0,
                                r.isUndefined)(this._onSuccesfullPurchaseCallback) ? [3, 2] : [4, this._close()];
                            case 1:
                                return e.sent(),
                                this._onSuccesfullPurchaseCallback(),
                                [2];
                            case 2:
                                return this._spawnPurchasedItems(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._spawnPurchasedItems = function() {
                    var e = this
                      , t = [];
                    this._missingItems.forEach((function(i) {
                        if (Object.values(Sn).indexOf(i.objectName) > -1)
                            De.services.inventory.addAmount(i.objectName, i.totalRequired - i.currentAmount);
                        else {
                            for (var n = e._gridFilter.getEmptyCells().length, r = i.totalRequired - i.currentAmount; n > 0 && r > 0; )
                                e._spawnGridItem(i),
                                r--,
                                n--;
                            for (; r > 0; )
                                t.push(i.objectName),
                                r--
                        }
                    }
                    )),
                    t.length > 0 && this._storageBubble.createBubbleAndShowContent(t.map((function(e) {
                        return {
                            blueprint: e,
                            data: {}
                        }
                    }
                    ))),
                    this._close()
                }
                ,
                t.prototype._spawnGridItem = function(e) {
                    var t = De.services.gameObjectFactory.createById(e.objectName);
                    this._worldService.addGameObject(t),
                    t.addBehavior(new Oi);
                    var i = new et({
                        rootPosition: this._visibleCells.getClosestEmptyToTheCenter(!0)
                    });
                    t.addBehavior(i),
                    t.addBehavior(new Hi),
                    this._mapGridView.getLayer(Yo.MAIN).addChild(t)
                }
                ,
                t.prototype._onTargetObjectBehaviorAdded = function(e) {
                    e.behavior.type === Ke.ObjectDestruction && this._close()
                }
                ,
                t.prototype._reportAnalytics = function() {
                    if (this._targetObject) {
                        var e = this._targetObject.getBehavior(Ke.CrateReward);
                        e && De.services.analytics.design.reportRewardedMissingKeysPopupPurchasePressed(e.crateRewardLevel)
                    }
                }
                ,
                t
            }(yr), Qy = function(e) {
                function t(t) {
                    var i = this;
                    t.expansionHeight += 75,
                    (i = e.call(this, t) || this)._timer = De.services.timer.getTimerByID(t.timerID),
                    i._timer.onUpdate.addListener(i.onUpdate, i);
                    var o = r.StringUtility.formatMilliseconds(i._timer.remainingTime, {
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        },
                        showSecondsBelowMilliseconds: 36e5
                    });
                    return i._headerText = new Xe.Text(nr(By || (By = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.REWARD_POPOUT_HEADER_TEXT, o),vn.darkMedium),
                    i._headerText.anchor.set(.5, .5),
                    i._headerText.position.set(0, 150),
                    i._openContainer.addChild(i._headerText),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this),
                    this._timer.onUpdate.removeListener(this.onUpdate, this)
                }
                ,
                t.prototype.onUpdate = function() {
                    var e = r.StringUtility.formatMilliseconds(this._timer.remainingTime, {
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        },
                        showSecondsBelowMilliseconds: 36e5
                    });
                    this._headerText.text = nr(Py || (Py = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.REWARD_POPOUT_HEADER_TEXT, e)
                }
                ,
                t
            }(_m), Zy = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._popoutStore = new zd,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.CrateReward, Ke.InteractionTap, Ke.CoolDown], this._onCrateRewardTapped),
                            this._crateFamily = this.addFamily([Ke.GridPosition, Ke.CrateReward], this._onCrateRewardAdded, this._removePopout),
                            this.addFamily([Ke.CrateReward, Ke.CooldownFinishedTrigger], this._onCooldownFinished),
                            this.addFamily([Ke.CrateRewardKey]),
                            this.services.mapGrid.onContentAdded.addListener(this._updatePopouts, this),
                            this.services.mapGrid.onContentRemoved.addListener(this._updatePopouts, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.mapGrid.onContentAdded.removeListener(this._updatePopouts, this),
                            this.services.mapGrid.onContentRemoved.removeListener(this._updatePopouts, this),
                            this._crateFamily.getGameObjects().forEach((function(e) {
                                e.getChildByName(Gv, !0).destroy()
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onCrateRewardAdded = function(e) {
                    var t = e.getBehavior(Ke.CrateReward);
                    if (!e.getBehavior(Ke.CoolDown)) {
                        var i = De.services.timer.addTimer(1e3 * t.crateRewardLifetime, "RewardCrateCooldown");
                        e.addBehavior(new at({
                            timerId: i.id
                        }))
                    }
                }
                ,
                t.prototype._onCooldownFinished = function(e) {
                    e.addBehavior(new ti({}))
                }
                ,
                t.prototype._onCrateRewardTapped = function(e) {
                    var t = e.getBehavior(Ke.GridPosition)
                      , i = this._popoutStore.get(t);
                    if (e.getBehavior(Ke.CrateReward).crateRewardUnlockRequirement)
                        if (i)
                            this.services.popout.showPopout(i);
                        else {
                            var n = this._createPopout(e);
                            this.services.popout.showPopout(n)
                        }
                    else
                        this._openCrate(e)
                }
                ,
                t.prototype._createPopout = function(e) {
                    var t = this
                      , i = e.getBehavior(Ke.CrateReward)
                      , n = e.getBehavior(Ke.CoolDown)
                      , r = e.getBehavior(Ke.GridPosition)
                      , o = i.crateRewardUnlockRequirement.map((function(e) {
                        var i = e.blueprintID
                          , n = e.amount;
                        return {
                            objectName: i,
                            image: us(i),
                            totalRequired: n,
                            currentAmount: t.services.gridFilter.getBlueprintCount(i)
                        }
                    }
                    ))
                      , a = new Qy({
                        basePopoutType: Bd.OPEN_ONLY,
                        expansionWidth: 590,
                        expansionHeight: 476,
                        requirements: o,
                        timerID: n.timerId,
                        titleText: this._getCrateRewardPopoutTitleText(i.crateRewardLevel),
                        buttonCTA: ce.REWARD_POPOUT_BUTTON_TEXT
                    })
                      , s = this.services.axonometricProjection.getWorldPosition(r.column, r.row);
                    return a.position.copyFrom(s),
                    a.onButtonAction.addListener((function() {
                        return t._onCrateOpenButtonPressed(e, a)
                    }
                    ), this),
                    a.onHelpIconPressed.addListener((function(i) {
                        return t._openDiscoveryPopup(i, e)
                    }
                    ), this),
                    this.services.popout.registerPopout(a),
                    this._popoutStore.add(r, a),
                    a
                }
                ,
                t.prototype._removePopout = function(e, t) {
                    if (void 0 === t && (t = null),
                    t || (t = e.getBehavior(Ke.GridPosition)),
                    t) {
                        var i = this._popoutStore.remove(t);
                        i && (this.services.popout.hidePopout(i),
                        this.services.popout.unregisterPopout(i))
                    } else
                        this._logger.error("Can't remove popup for object that has no gridposition")
                }
                ,
                t.prototype._updatePopouts = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return t.sent(),
                                this._crateFamily.forEach((function(t) {
                                    return (0,
                                    n.__awaiter)(e, void 0, void 0, (function() {
                                        var e, i, r, o;
                                        return (0,
                                        n.__generator)(this, (function(a) {
                                            switch (a.label) {
                                            case 0:
                                                return t.getBehavior(Ke.CrateReward).crateRewardUnlockRequirement ? (e = t.getBehavior(Ke.GridPosition),
                                                (i = this._popoutStore.get(e)) || (i = this._createPopout(t)),
                                                r = i.requirements.every((function(e) {
                                                    return e.currentAmount >= e.totalRequired
                                                }
                                                )),
                                                i.requirements = this._updateRequirements((0,
                                                n.__spreadArray)([], i.requirements, !0)),
                                                o = i.requirements.every((function(e) {
                                                    return e.currentAmount >= e.totalRequired
                                                }
                                                )),
                                                r || !o ? [3, 2] : [4, this.services.cameraService.animateCameraToCell(this.services.mapGrid.getCell(e))]) : [2];
                                            case 1:
                                                a.sent(),
                                                this.services.popout.showPopout(i),
                                                a.label = 2;
                                            case 2:
                                                return [2]
                                            }
                                        }
                                        ))
                                    }
                                    ))
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateRequirements = function(e) {
                    var t = this;
                    return e.forEach((function(e) {
                        e.currentAmount = t.services.gridFilter.getBlueprintCount(e.objectName)
                    }
                    )),
                    e
                }
                ,
                t.prototype._getCrateRewardPopoutTitleText = function(e) {
                    switch (e) {
                    case lt.BRONZE:
                        return ce.REWARD_POPOUT_TITLE_BRONZE;
                    case lt.SILVER:
                        return ce.REWARD_POPOUT_TITLE_SILVER;
                    case lt.GOLD:
                        return ce.REWARD_POPOUT_TITLE_GOLD;
                    case lt.GOLDEN_CARROT:
                    case lt.GOLDEN_PUMPKIN:
                    case lt.GOLDEN_CHRISTMAS:
                    case lt.DAILY_CHALLENGE:
                        return ce.REWARD_POPOUT_TITLE_EVENT;
                    case lt.DAILY_BONUS:
                    default:
                        return ce.REWARD_POPOUT_TITLE_BRONZE
                    }
                }
                ,
                t.prototype._onCrateOpenButtonPressed = function(e, t) {
                    var i = e.getBehavior(Ke.CrateReward);
                    if (i) {
                        if (!this.services.gridFilter.hasEnoughItems(i.crateRewardUnlockRequirement))
                            return this.services.popout.hidePopout(t),
                            void this._openMissingItemsPopup(e);
                        this.services.popout.hidePopout(t),
                        t.onButtonAction.removeAllListeners(),
                        this._openCrate(e)
                    } else
                        this.services.popout.hidePopout(t)
                }
                ,
                t.prototype._openCrate = function(e) {
                    var t = this
                      , i = e.getBehavior(Ke.CrateReward)
                      , n = e.getBehavior(Ke.CoolDown);
                    De.services.analytics.design.reportRewardedChestUnlocked(i.crateRewardLevel),
                    i.crateRewardUnlockRequirement && this._removeItemsFromGrid(i.crateRewardUnlockRequirement),
                    De.services.timer.getTimerByID(n.timerId).cancel(),
                    e.removeBehaviorByType(Ke.CoolDown),
                    e.removeBehaviorByType(Ke.Movable);
                    var o = e.getChildByName(Gv, !0);
                    o.state.setAnimation(0, i.openingAnimation, !1),
                    o.state.addListener({
                        complete: function() {
                            r.TimeDelay.nextFrame().then((function() {
                                o.destroy(),
                                t._spawnRewardItems(e),
                                t._worldService.removeGameObject(e)
                            }
                            ))
                        }
                    })
                }
                ,
                t.prototype._openMissingItemsPopup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = e.getBehavior(Ke.CrateReward),
                                i = [],
                                t.crateRewardUnlockRequirement.forEach((function(e) {
                                    var t = o.services.gridFilter.getBlueprintCount(e.blueprintID);
                                    t >= e.amount || i.push({
                                        objectName: e.blueprintID,
                                        image: us(e.blueprintID),
                                        totalRequired: e.amount,
                                        currentAmount: t
                                    })
                                }
                                )),
                                [4, De.services.assetLoader.loadJsons(_e.ITEM_PURCHASE_COSTS_CONFIG)];
                            case 1:
                                return n.sent(),
                                r = function() {
                                    i.forEach((function(e) {
                                        var t = De.services.blueprintCollection.getBlueprint(e.objectName).components.crateRewardKey;
                                        if (t) {
                                            var i = e.totalRequired - e.currentAmount;
                                            De.services.analytics.design.reportAmountOfMissingKeysPurchased(t.tier, i)
                                        }
                                    }
                                    )),
                                    De.services.analytics.design.reportRewardedMissingKeysPopupPurchaseComplete(t.crateRewardLevel),
                                    o._openCrate(e)
                                }
                                ,
                                De.services.navigation.showPopup(qy, {
                                    missingItems: i,
                                    marketPlaceService: this.services.marketplaceService,
                                    gridFilter: this.services.gridFilter,
                                    worldService: this.services.world,
                                    mapGridView: this.services.mapGridView,
                                    visibleCells: this.services.visibleCells,
                                    storageBubble: this.services.storageBubble,
                                    onSuccesfullPurchaseCallback: r,
                                    targetObject: e
                                }),
                                De.services.analytics.design.reportRewardedMissingKeysPopupAppeared(t.crateRewardLevel),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._removeItemsFromGrid = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        for (var i = e.blueprintID, n = e.amount, r = t.services.gridFilter.getCellsWithBlueprint(i), o = 0; o < n; o++) {
                            var a = r[o];
                            if (a) {
                                var s = t.services.mapGrid.getCell(a.column, a.row);
                                (null == s ? void 0 : s.content) && t._worldService.removeGameObject(s.content)
                            }
                        }
                    }
                    ))
                }
                ,
                t.prototype._spawnRewardItems = function(e) {
                    var t = e.getBehavior(Ke.CrateReward)
                      , i = e.getBehavior(Ke.GridPosition);
                    if (t) {
                        for (var n = this.services.gridFilter.getEmptyCells().length, r = this.services.randomLoot.getRandomLoot(e.getBlueprintID(), t.crateRewardContent, FE.REWARD_CRATE); r.length > 0; )
                            this._spawnReward(r.shift(), i),
                            n--;
                        n <= 0 && this._showNotEnoughSpaceFloater()
                    } else
                        this._logger.error("cannot find crateRewardBehavior")
                }
                ,
                t.prototype._spawnReward = function(e, t) {
                    var i = De.services.gameObjectFactory.createById(e);
                    this._worldService.addGameObject(i),
                    i.addBehavior(new Oi),
                    i.addBehavior(new et({
                        rootPosition: t
                    })),
                    i.addBehavior(new Hi),
                    this.services.mapGridView.getLayer(Yo.MAIN).addChild(i),
                    this._reportAnalytics(i)
                }
                ,
                t.prototype._openDiscoveryPopup = function(e, t) {
                    this._removePopout(t),
                    De.services.discovery.openDiscoveryPopup(this.services.upgradeCard, e)
                }
                ,
                t.prototype._showNotEnoughSpaceFloater = function() {
                    var e = v.Vector2.fromPoint(this.services.cameraService.getCameraPosition())
                      , t = this.services.cameraService.getCameraScale();
                    e.x /= t.x,
                    e.y /= t.y,
                    new rf(this.services.mapGridView.getLayer(Yo.FLOATERS),e,{
                        text: De.services.localization.getText(ce.NOT_ENOUGH_SPACE),
                        styles: vn.warningText
                    })
                }
                ,
                t.prototype._reportAnalytics = function(e) {
                    var t = e.getObjectIdAndTier()
                      , i = t.id
                      , n = t.tier;
                    "toolbox" !== i || (0,
                    r.isUndefined)(n) || De.services.analytics.design.reportToolboxSpawned(n),
                    "greenhouse" !== i || (0,
                    r.isUndefined)(n) || De.services.analytics.design.reportGreenhousePieceSpawned(n)
                }
                ,
                t
            }(Pd), $y = function() {
                function e(e) {
                    this.animationDone = new r.Event,
                    this._logger = r.Logger.Of("WorldToLifeAnimation"),
                    this._dependencies = e,
                    this.initialize()
                }
                return e.prototype.initiateEnding = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.getPlayingTime = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, 0]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), eT = i(5807), tT = function() {}, iT = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n.animationDone = new r.Event,
                    n._movementOffset = t,
                    n._dependencies = i,
                    n._initialize(),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.update = function(e, t) {
                    (0,
                    eT.isUndefined)(this._animationContainer) || (this._animationContainer.position.set(this._animationContainer.position.x += 1 * this._movementOffset.x * e, this._animationContainer.position.y += 1 * this._movementOffset.y * e),
                    this._animationContainer.position.x > this._dependencies.cameraService.getCameraMaxBounds().maxX + 50 && this.animationDone.fire(this))
                }
                ,
                t.prototype.destroy = function() {
                    this._animationContainer.destroy()
                }
                ,
                t.prototype._initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, o, a;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._animationContainer = new Xe.Container,
                                e = De.services.resource.getSpine(se.BUTTERFLIES),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return n.sent(),
                                e.skeleton.findSlot("butterfly_01").color.setFromString(r.ArrayUtility.getRandomItem(rT)),
                                e.skeleton.findSlot("butterfly_1").color.setFromString(r.ArrayUtility.getRandomItem(rT)),
                                t = this._dependencies.mapGridView.getLayer(Yo.WORLD_ANIMATION),
                                i = this._dependencies.cameraService.getCameraMaxBounds().minX - 25,
                                o = r.Random.int(-this._dependencies.cameraService.getCameraMaxBounds().minY, -this._dependencies.cameraService.getCameraMaxBounds().maxY),
                                a = v.Vector2.fromPoint(new Xe.Point(i,o)),
                                this._animationContainer.addChild(e),
                                this._animationContainer.position.copyFrom(a),
                                e.state.setAnimation(0, I.ANIMATION, !0),
                                t.addChild(this._animationContainer),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(tT), nT = function(e) {
                function t(t, i, n) {
                    var o = e.call(this) || this;
                    return o.animationDone = new r.Event,
                    o._idleOnTile = !1,
                    o._dependencies = t,
                    o._settings = i,
                    o._butterfliesController = n,
                    o._movementOffset = new v.Vector2(r.Random.float(o._settings.minMoveOffsetX, o._settings.maxMoveOffsetX),r.Random.float(o._settings.minMoveOffsetY, o._settings.maxMoveOffsetY)),
                    o._dependencies.interactionService.onGestureTap.addListener(o._onGestureTap, o),
                    o._dependencies.mapGrid.onContentAdded.addListener(o._onGameobjectAdded, o),
                    o._initialize(),
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.update = function(e, t) {
                    ve(this._animationContainer) || (this._idleOnTile || this._timeline || this._animationContainer.position.set(this._animationContainer.position.x += 1 * this._movementOffset.x * e, this._animationContainer.position.y += 1 * this._movementOffset.y * e),
                    this._animationContainer.position.x > this._dependencies.cameraService.getCameraMaxBounds().maxX + 50 && this.animationDone.fire(this))
                }
                ,
                t.prototype.destroy = function() {
                    this._dependencies.interactionService.onGestureTap.removeListener(this._onGestureTap, this),
                    this._dependencies.mapGrid.onContentAdded.removeListener(this._onGameobjectAdded, this),
                    this._timeline && (this._timeline.kill(),
                    this._timeline = void 0),
                    this._animationContainer.destroy()
                }
                ,
                t.prototype._initialize = function() {
                    this._animationContainer = new Xe.Container,
                    this._butterflies = De.services.resource.getSpine(se.BUTTERFLIES_ON_TILE),
                    this._butterflies.skeleton.findSlot("butterfly_01").color.setFromString(r.ArrayUtility.getRandomItem(rT));
                    var e = this._dependencies.mapGridView.getLayer(Yo.WORLD_ANIMATION)
                      , t = this._dependencies.cameraService.getCameraMaxBounds().minX - 25
                      , i = r.Random.int(-this._dependencies.cameraService.getCameraMaxBounds().maxY, -this._dependencies.cameraService.getCameraMaxBounds().minY)
                      , n = v.Vector2.fromPoint(new Xe.Point(t,i));
                    this._animationContainer.addChild(this._butterflies),
                    this._animationContainer.position.copyFrom(n),
                    this._setTimelineData(),
                    this._butterflies.state.setAnimation(0, S.FLY, !0),
                    e.addChild(this._animationContainer)
                }
                ,
                t.prototype._setTimelineData = function() {
                    var e = this;
                    this._idleOnTile = !1;
                    var t = (0,
                    n.__spreadArray)([], this._butterfliesController.singleButterflyGridTargets, !0);
                    this._targetCell && t.push(this._targetCell);
                    var i = this._dependencies.gridFilter.getEmptyCells().filter((function(e) {
                        return -1 === t.indexOf(e)
                    }
                    ));
                    if (this._targetCell = r.ArrayUtility.getRandomItem(i),
                    ve(this._targetCell))
                        this._continueTowardsEdge();
                    else {
                        this._butterfliesController.singleButterflyGridTargets.push(this._targetCell);
                        var o = this._dependencies.axonometricProjection.getWorldPosition(this._targetCell.column, this._targetCell.row);
                        o.y += 75;
                        var a = .1 + v.Vector2.substract(this._animationContainer.position, o).length() / 40;
                        this._timeline = lr.gsap.timeline(),
                        this._timeline.add(lr.gsap.to(this._animationContainer, {
                            x: o.x,
                            y: o.y,
                            duration: a,
                            ease: as.bJ.easeNone
                        })),
                        this._timeline.eventCallback("onComplete", (function() {
                            e._arrivedAtTile()
                        }
                        )),
                        this._timeline.eventCallback("onUpdate", (function() {
                            v.Vector2.substract(e._animationContainer.position, o).length() < 35 && e._butterflies.state.tracks[0].animation.name !== S.DESCEND && e._butterflies.state.setAnimation(0, S.DESCEND, !1)
                        }
                        )),
                        this._timeline.play(),
                        o.x <= this._animationContainer.position.x ? this._animationContainer.scale.set(-1, 1) : this._animationContainer.scale.set(1, 1)
                    }
                }
                ,
                t.prototype._arrivedAtTile = function() {
                    this._butterflies.state.clearTracks(),
                    this._butterflies.state.setAnimation(0, S.IDLE, !0),
                    this._idleOnTile = !0,
                    this._timeline && this._timeline.kill()
                }
                ,
                t.prototype._onGestureTap = function(e) {
                    if (this._idleOnTile && this._targetCell) {
                        var t = this._dependencies.cameraService.getScreenToWorldPosition(e.startPosition)
                          , i = this._dependencies.axonometricProjection.getProjectedIndices(t);
                        i.column === this._targetCell.column && i.row === this._targetCell.row && this._continueAnimation()
                    }
                }
                ,
                t.prototype._onGameobjectAdded = function(e) {
                    if (this._targetCell) {
                        var t = e.getBehavior(Ke.GridPosition);
                        t && t.column === this._targetCell.column && t.row === this._targetCell.row && this._continueAnimation()
                    }
                }
                ,
                t.prototype._continueAnimation = function() {
                    this._targetCell && this._butterfliesController.singleButterflyGridTargets.splice(this._butterfliesController.singleButterflyGridTargets.indexOf(this._targetCell), 1),
                    this._timeline && (this._timeline.kill(),
                    this._timeline = void 0),
                    r.Random.int(0, 100) < this._settings.butterflyOnTilePickNewTileChance ? (this._idleOnTile && (this._butterflies.state.setAnimation(0, S.ASCEND, !1),
                    this._butterflies.state.setAnimation(1, S.FLY, !0),
                    this._idleOnTile = !1),
                    this._setTimelineData()) : this._continueTowardsEdge()
                }
                ,
                t.prototype._continueTowardsEdge = function() {
                    this._movementOffset = new v.Vector2(r.Random.float(this._settings.minMoveOffsetX, this._settings.maxMoveOffsetX),r.Random.float(this._settings.minMoveOffsetY, this._settings.maxMoveOffsetY)),
                    this._animationContainer.scale.set(1, 1),
                    this._idleOnTile && (this._butterflies.state.setAnimation(0, S.ASCEND, !1),
                    this._butterflies.state.setAnimation(1, S.FLY, !0),
                    this._idleOnTile = !1)
                }
                ,
                t
            }(tT), rT = ["ffc9c9", "b4dbff", "889ac5", "ffd565", "ff804a", "a9ff96", "b88348", "7aff5c"];
            !function(e) {
                e.SINGLE = "SINGLE",
                e.DOUBLE = "DOUBLE"
            }(ky || (ky = {}));
            var oT, aT = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.animationType = oT.BUTTERFLIES,
                    t.name = "butterflies",
                    t.persistance = !1,
                    t._activeButterflies = [],
                    t._singleButterflyGridTargets = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "singleButterflyGridTargets", {
                    get: function() {
                        return this._singleButterflyGridTargets
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.BUTTERFLIES)];
                            case 1:
                                return e.sent(),
                                this._settings = De.services.resource.getJsonCopy(_e.WORLD_TO_LIFE_BUTTERFLIES_SETTINGS),
                                this._addButterflyAnimations(),
                                this._setupListeners(),
                                v.GroupsCore.Updateables.add(this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._activeButterflies.forEach((function(e) {
                                return e.destroy()
                            }
                            )),
                            v.GroupsCore.Updateables.remove(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.update = function(e, t) {
                    this._activeButterflies.forEach((function(i) {
                        return i.update(e, t)
                    }
                    ))
                }
                ,
                t.prototype.quitBeforeAnimationEnd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._activeButterflies.forEach((function(e) {
                                return e.destroy()
                            }
                            )),
                            this.animationDone.fire(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._addButterflyAnimations = function() {
                    this._activeButterflies.push(new iT(new v.Vector2(r.Random.float(this._settings.minMoveOffsetX, this._settings.maxMoveOffsetX),r.Random.float(this._settings.minMoveOffsetY, this._settings.maxMoveOffsetY)),this._dependencies));
                    for (var e = 0; e < r.Random.int(4, 10); e++)
                        this._activeButterflies.push(new nT(this._dependencies,this._settings,this))
                }
                ,
                t.prototype._setupListeners = function() {
                    var e = this;
                    this._activeButterflies.forEach((function(t) {
                        return t.animationDone.listenOnce(e._onButterflyAnimationDone, e)
                    }
                    ))
                }
                ,
                t.prototype._onButterflyAnimationDone = function(e) {
                    e.destroy(),
                    this._activeButterflies.splice(this._activeButterflies.indexOf(e), 1),
                    this._activeButterflies.length <= 0 && this.animationDone.fire(this)
                }
                ,
                t
            }($y), sT = i(2213), _T = 100, cT = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    t.onComplete = new r.Event,
                    t._historyX = [],
                    t._historyY = [],
                    t._points = [],
                    t._counter = {
                        x: 0,
                        y: 0
                    },
                    t._time = 3500,
                    t._animationLifeTime = 0,
                    t._yOffset = r.Random.int(1, 2.5),
                    t._fading = !1,
                    t._trailTexture = De.services.resource.getTexture(f.WIND_TRAIL);
                    for (var i = 0; i < _T; i++)
                        t._points.push(new sT.Point(0,0));
                    return t._rope = new sT.SimpleRope(t._trailTexture,t._points),
                    t._rope.blendMode = sT.BLEND_MODES.ADD,
                    t._rope.alpha = 0,
                    t._rope.autoUpdate = !1,
                    t.addChild(t._rope),
                    t._playTrail(),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.update = function(e, t) {
                    this._rope && (this._animationLifeTime += t,
                    this._counter.x += t / 2,
                    this._counter.y += this._yOffset + Math.cos(this._animationLifeTime / 500),
                    this._updateTrail(this._counter),
                    this._animationLifeTime > 500 && !this._rope.autoUpdate && (this._rope.autoUpdate = !0,
                    lr.gsap.to(this._rope, {
                        alpha: .3,
                        duration: 2
                    })),
                    this._animationLifeTime > this._time && !this._fading && (this._fadeOutWind(),
                    this._fading = !0))
                }
                ,
                t.prototype.destroy = function() {
                    var t;
                    e.prototype.destroy.call(this, {
                        children: !0
                    }),
                    null === (t = this._fadeOutTween) || void 0 === t || t.kill()
                }
                ,
                t.prototype._fadeOutWind = function() {
                    this._fadeOutTween = lr.gsap.to(this._rope, {
                        alpha: 0,
                        duration: 2,
                        onComplete: this._onWindComplete.bind(this)
                    })
                }
                ,
                t.prototype._createHistorySize = function() {
                    for (var e = 0; e < 50; e++)
                        this._historyX.push(0),
                        this._historyY.push(0)
                }
                ,
                t.prototype._playTrail = function() {
                    this._createHistorySize(),
                    this._counter.x = 0,
                    this._counter.y = 0
                }
                ,
                t.prototype._updateTrail = function(e) {
                    this._historyX.pop(),
                    this._historyX.unshift(e.x),
                    this._historyY.pop(),
                    this._historyY.unshift(e.y);
                    for (var t = 0; t < _T; t++) {
                        var i = this._points[t]
                          , n = this._cubicInterpolation(this._historyX, t / _T * 50)
                          , r = this._cubicInterpolation(this._historyY, t / _T * 50);
                        i.x = n,
                        i.y = r
                    }
                }
                ,
                t.prototype._cubicInterpolation = function(e, t, i) {
                    void 0 === i && (i = 1);
                    var n = Math.floor(t)
                      , r = [this._getTangent(n, i, e), this._getTangent(n + 1, i, e)]
                      , o = [this._clipInput(n, e), this._clipInput(n + 1, e)]
                      , a = (t -= n) * t
                      , s = t * a;
                    return (2 * s - 3 * a + 1) * o[0] + (s - 2 * a + t) * r[0] + (-2 * s + 3 * a) * o[1] + (s - a) * r[1]
                }
                ,
                t.prototype._getTangent = function(e, t, i) {
                    return t * (this._clipInput(e + 1, i) - this._clipInput(e - 1, i)) / 2
                }
                ,
                t.prototype._clipInput = function(e, t) {
                    return e < 0 && (e = 0),
                    e > t.length - 1 && (e = t.length - 1),
                    t[e]
                }
                ,
                t.prototype._onWindComplete = function() {
                    this.onComplete.fire(this)
                }
                ,
                t
            }(Xe.Container), lT = function(e) {
                function t(t, i) {
                    void 0 === i && (i = !1);
                    var n = e.call(this, t) || this;
                    return n.animationType = oT.WIND,
                    n.name = "wind",
                    n.persistance = !1,
                    n._activeWindTrails = [],
                    n._active = !0,
                    n._standaloneAnimation = i,
                    n
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "active", {
                    set: function(e) {
                        this._active = e
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.WIND)];
                            case 1:
                                i.sent(),
                                this._settings = De.services.resource.getJsonCopy(_e.WORLD_TO_LIFE_WIND_SETTINGS),
                                this._standaloneAnimation && r.TimeDelay.after(r.Random.int(this._settings.minWindPlayTime, this._settings.maxWindPlayTime)).promise.then((function() {
                                    t._active = !1
                                }
                                )),
                                e = 0,
                                i.label = 2;
                            case 2:
                                return e < this._settings.activeWindTrails ? (this._createWind(),
                                [4, r.TimeDelay.after(r.Random.int(this._settings.minWindTimeInterval, this._settings.maxWindTimeInterval)).promise]) : [3, 5];
                            case 3:
                                i.sent(),
                                i.label = 4;
                            case 4:
                                return e++,
                                [3, 2];
                            case 5:
                                return v.GroupsCore.Updateables.add(this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return v.GroupsCore.Updateables.remove(this),
                            this._active = !1,
                            e = this._dependencies.mapGridView.getLayer(Yo.WORLD_ANIMATION),
                            this._activeWindTrails.forEach((function(t) {
                                e.removeChild(t),
                                t.destroy()
                            }
                            )),
                            this._activeWindTrails = [],
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.update = function(e, t) {
                    this._activeWindTrails.forEach((function(i) {
                        return i.update(e, t)
                    }
                    ))
                }
                ,
                t.prototype.quitBeforeAnimationEnd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._active = !1,
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createWind = function() {
                    if (this._active) {
                        var e = this._dependencies.mapGridView.getLayer(Yo.WORLD_ANIMATION)
                          , t = new cT
                          , i = r.Random.int(this._dependencies.cameraService.getCameraBounds().left, this._dependencies.cameraService.getCameraBounds().right) - 500
                          , n = r.Random.int(this._dependencies.cameraService.getCameraBounds().bottom, this._dependencies.cameraService.getCameraBounds().top)
                          , o = v.Vector2.fromPoint(new Xe.Point(i,n));
                        t.position.copyFrom(o),
                        t.onComplete.listenOnce(this._onWindComplete, this),
                        this._activeWindTrails.push(t),
                        e.addChild(t)
                    } else
                        this._activeWindTrails.length <= 0 && (this.animationDone.fire(this),
                        this.destroy())
                }
                ,
                t.prototype._onWindComplete = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._activeWindTrails.splice(this._activeWindTrails.indexOf(e), 1),
                                e.destroy(),
                                [4, r.TimeDelay.after(r.Random.int(this._settings.minWindTimeInterval, this._settings.maxWindTimeInterval)).promise];
                            case 1:
                                return t.sent(),
                                this._createWind(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }($y), uT = function() {
                function e(e, t, i, n) {
                    this.animationDone = new r.Event,
                    this._animationLifeTime = 0,
                    this._startPosition = e,
                    this._movementOffset = t,
                    this._mapGridView = i,
                    this._cameraService = n,
                    this._initialize()
                }
                return e.prototype.update = function(e, t) {
                    ve(this._animationContainer) || (this._animationLifeTime += t,
                    this._animationContainer.position.set(this._animationContainer.position.x += 1 * this._movementOffset.x * e, this._animationContainer.position.y += 1 * this._movementOffset.y * e),
                    this._animationContainer.position.set(this._animationContainer.position.x, this._animationContainer.position.y += Math.sin(this._animationLifeTime / 1e3) * (.4 * Math.random() + .1)),
                    this._animationContainer.position.x > this._cameraService.getCameraMaxBounds().maxX && this.animationDone.fire(this))
                }
                ,
                e.prototype.destroy = function() {
                    this._animationContainer.destroy()
                }
                ,
                e.prototype._initialize = function() {
                    this._animationContainer = new Xe.Container;
                    var e = this._mapGridView.getLayer(Yo.WORLD_ANIMATION);
                    this._animationContainer.position.copyFrom(this._startPosition);
                    var t = De.services.resource.getSprite(f.DANDELION);
                    t.position.x += 200 * Math.random(),
                    t.position.y += 200 * Math.random(),
                    this._animationContainer.addChild(t),
                    e.addChild(this._animationContainer)
                }
                ,
                e
            }(), dT = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.animationType = oT.DANDELIONS,
                    t.name = "dandelions",
                    t.persistance = !1,
                    t._dandelions = [],
                    t._active = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.DANDELION)];
                            case 1:
                                return t.sent(),
                                this._settings = De.services.resource.getJsonCopy(_e.WORLD_TO_LIFE_DANDELION_SETTINGS),
                                e = r.Random.int(this._settings.dandelionMinClusterAmount, this._settings.dandelionMaxClusterAmount),
                                this._spawnClusters(e),
                                this._wind = new lT(this._dependencies),
                                v.GroupsCore.Updateables.add(this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._active = !1,
                            this._wind.destroy(),
                            this._dandelions.forEach((function(e) {
                                return e.destroy()
                            }
                            )),
                            v.GroupsCore.Updateables.remove(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.update = function(e, t) {
                    this._dandelions.forEach((function(i) {
                        return i.update(e, t)
                    }
                    ))
                }
                ,
                t.prototype.quitBeforeAnimationEnd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._wind.active = !1,
                            this._active = !1,
                            this._dandelions.forEach((function(e) {
                                return e.destroy()
                            }
                            )),
                            this.animationDone.fire(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._spawnClusters = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                t = 0,
                                i.label = 1;
                            case 1:
                                return t < e ? this._active ? (this._createDandelionCluster(),
                                [4, r.TimeDelay.after(1e3 * r.Random.int(this._settings.minIntervalTimePerCluster, this._settings.maxIntervalTimePerCluster)).promise]) : [2] : [3, 4];
                            case 2:
                                i.sent(),
                                i.label = 3;
                            case 3:
                                return t++,
                                [3, 1];
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createDandelionCluster = function() {
                    for (var e = this._dependencies.cameraService.getCameraBounds().left - r.Random.int(250, 500), t = r.Random.int(this._dependencies.cameraService.getCameraBounds().bottom, this._dependencies.cameraService.getCameraBounds().top), i = v.Vector2.fromPoint(new Xe.Point(e,t)), n = r.Random.int(this._settings.minDandelionAmountPerCluster, this._settings.maxDandelionAmountPerCluster), o = 0; o < n; o++) {
                        var a = new v.Vector2(r.Random.float(this._settings.minDandelionMoveOffsetX, this._settings.maxDandelionMoveOffsetX),r.Random.float(this._settings.minDandelionMoveOffsetY, this._settings.maxDandelionMoveOffsetY))
                          , s = new uT(i,a,this._dependencies.mapGridView,this._dependencies.cameraService);
                        this._dandelions.push(s),
                        s.animationDone.listenOnce(this._dandelionAnimationDone, this)
                    }
                }
                ,
                t.prototype._dandelionAnimationDone = function(e) {
                    var t = this;
                    this._dandelions.splice(this._dandelions.indexOf(e), 1),
                    e.destroy(),
                    this._dandelions.length <= 0 && (this._wind.active = !1,
                    this._wind.animationDone.listenOnce((function() {
                        t.animationDone.fire(t)
                    }
                    ), this))
                }
                ,
                t
            }($y), hT = i(2213), pT = function() {
                function e(e) {
                    this.animationDone = new r.Event,
                    this._rainSprites = [],
                    this._currentAlphaValue = 0,
                    this._isRaining = !1,
                    this._cameraService = e,
                    this.initialize()
                }
                return e.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._createRainOverlay(),
                            this._createShadowOverlay(),
                            this._cameraService.cameraView.addChild(this._graphics),
                            this._rainSprites.forEach((function(t) {
                                return e._cameraService.cameraView.addChild(t)
                            }
                            )),
                            this._isRaining = !0,
                            v.EventManager.resizeScreen.addListener(this._onResize, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.update = function(e, t) {
                    this._transition(e),
                    !this._isRaining && this._currentAlphaValue <= 0 && this.animationDone.fire()
                }
                ,
                e.prototype.initiateEnding = function() {
                    this._isRaining = !1
                }
                ,
                e.prototype.destroy = function() {
                    this._graphics.destroy(),
                    this._rainSprites.forEach((function(e) {
                        return e.destroy()
                    }
                    )),
                    v.EventManager.resizeScreen.removeListener(this._onResize, this)
                }
                ,
                e.prototype._onResize = function() {
                    this._graphics && (this._graphics.width = De.services.canvas.bounds.width,
                    this._graphics.height = De.services.canvas.bounds.height)
                }
                ,
                e.prototype._createRainOverlay = function() {
                    var e = this;
                    this._rainAnimationTextures = [De.services.resource.getTexture(f.RAIN_STREAKS01), De.services.resource.getTexture(f.RAIN_STREAKS02), De.services.resource.getTexture(f.RAIN_STREAKS03)];
                    var t = [0, 1];
                    De.services.canvas.currentOrientation === v.Orientation.Landscape && t.push(-1, 2),
                    t.forEach((function(t) {
                        var i = new hT.AnimatedSprite(e._rainAnimationTextures,!0);
                        i.alpha = e._currentAlphaValue,
                        i.animationSpeed = .33,
                        i.loop = !0,
                        i.play(),
                        i.anchor.set(t, .5),
                        i.rotation = -.25,
                        e._rainSprites.push(i)
                    }
                    ))
                }
                ,
                e.prototype._transition = function(e) {
                    if (this._isRaining ? this._currentAlphaValue < .6 : this._currentAlphaValue > 0) {
                        var t = .01 * e;
                        this._currentAlphaValue += this._isRaining ? t : -t,
                        this._setAlpha()
                    }
                }
                ,
                e.prototype._setAlpha = function() {
                    var e = this;
                    this._currentAlphaValue > .6 && (this._currentAlphaValue = .6),
                    this._currentAlphaValue < 0 && (this._currentAlphaValue = 0),
                    this._graphics && (this._graphics.alpha = .25 * this._currentAlphaValue),
                    this._rainSprites.forEach((function(t) {
                        return t.alpha = e._currentAlphaValue
                    }
                    ))
                }
                ,
                e.prototype._createShadowOverlay = function() {
                    this._graphics = (new Xe.Graphics).beginFill(0, 1).drawRect(-1, -1, 2, 2).endFill(),
                    this._graphics.width = De.services.canvas.bounds.width,
                    this._graphics.height = De.services.canvas.bounds.height,
                    this._graphics.interactive = !1,
                    this._graphics.alpha = .25 * this._currentAlphaValue
                }
                ,
                e
            }(), vT = i(2213), gT = function() {
                function e(e, t, i) {
                    this.isActive = !1,
                    this._animation = new Xe.Container,
                    this._animationTextures = [],
                    this._mapGridView = e,
                    this._visibleCells = t,
                    this._axonometricProjection = i,
                    this.initialize(),
                    this._playSplatter()
                }
                return e.prototype.initialize = function() {
                    this._animationTextures = [De.services.resource.getTexture(f.RAIN_HIT_01), De.services.resource.getTexture(f.RAIN_HIT_02), De.services.resource.getTexture(f.RAIN_HIT_03), De.services.resource.getTexture(f.RAIN_HIT_04)],
                    this.isActive = !0
                }
                ,
                e.prototype.destroy = function() {
                    this.isActive = !1,
                    this._animation.destroy()
                }
                ,
                e.prototype.initiateEnding = function() {
                    this.isActive = !1
                }
                ,
                e.prototype._playSplatter = function() {
                    var e = this;
                    if (this.isActive) {
                        var t = this._mapGridView.getLayer(Yo.WORLD_ANIMATION)
                          , i = this._createHitAnimation()
                          , n = this._getRandomPositionOnEmptyCell();
                        n ? (this._animation.position.copyFrom(n),
                        this._animation.addChild(i),
                        t.addChild(this._animation),
                        i.play(),
                        i.onComplete = function() {
                            e._playSplatter()
                        }
                        ) : setTimeout((function() {
                            e._playSplatter()
                        }
                        ), 100)
                    } else
                        this._animation.destroy()
                }
                ,
                e.prototype._createHitAnimation = function() {
                    var e = new vT.AnimatedSprite(this._animationTextures,!0);
                    return e.gotoAndStop(0),
                    e.animationSpeed = .15,
                    e.loop = !1,
                    e
                }
                ,
                e.prototype._getRandomPositionOnEmptyCell = function() {
                    var e = this._visibleCells.getEmptyCells();
                    if (e.length <= 0)
                        return null;
                    var t = e[Math.floor(Math.random() * e.length)]
                      , i = this._axonometricProjection.getWorldPosition(t.column, t.row);
                    return i.x += 100 * Math.random() - 50,
                    i
                }
                ,
                e
            }(), fT = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.animationType = oT.RAIN,
                    t.name = "Rain",
                    t.persistance = !0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.RAIN)];
                            case 1:
                                return e.sent(),
                                this._settings = De.services.resource.getJsonCopy(_e.WORLD_TO_LIFE_RAIN_SETTINGS),
                                this._rainOverlay = new pT(this._dependencies.cameraService),
                                this._rainSpatters = new gT(this._dependencies.mapGridView,this._dependencies.visibleCells,this._dependencies.axonometricProjection),
                                this._rainStreaks = De.services.resource.getSpine(se.RAIN_STREAK),
                                this._rainStreaks.state.setAnimation(0, Y.RAIN_STREAKS, !0),
                                this._rainStreaks.rotation = -.25,
                                this._dependencies.cameraService.cameraView.addChild(this._rainStreaks),
                                this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.ExtendedTile]).forEach((function(e) {
                                    var t;
                                    return null === (t = e.content) || void 0 === t ? void 0 : t.addBehavior(new zi({}))
                                }
                                )),
                                v.GroupsCore.Updateables.add(this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    var e, t;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            return null === (e = this._rainOverlay) || void 0 === e || e.destroy(),
                            null === (t = this._rainSpatters) || void 0 === t || t.destroy(),
                            this._dependencies.cameraService.cameraView.removeChild(this._rainStreaks),
                            this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.RainImpact]).forEach((function(e) {
                                var t;
                                return null === (t = e.content) || void 0 === t ? void 0 : t.removeBehaviorByType(Ke.RainImpact)
                            }
                            )),
                            v.GroupsCore.Updateables.remove(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.update = function(e, t) {
                    this._rainOverlay.update(e, t)
                }
                ,
                t.prototype.getPlayingTime = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.RAIN)];
                            case 1:
                                return e.sent(),
                                [2, 1e3 * r.Random.int(this._settings.minRainTime, this._settings.maxRainTime)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.initiateEnding = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._rainOverlay.animationDone.listenOnce((function() {
                                e.animationDone.fire(e)
                            }
                            ), this),
                            this._rainOverlay.initiateEnding(),
                            this._rainSpatters.initiateEnding(),
                            this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.RainImpact]).forEach((function(e) {
                                var t;
                                return null === (t = e.content) || void 0 === t ? void 0 : t.removeBehaviorByType(Ke.RainImpact)
                            }
                            )),
                            this._dependencies.cameraService.cameraView.removeChild(this._rainStreaks),
                            this._rainStreaks.destroy(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.quitBeforeAnimationEnd = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._rainOverlay.initiateEnding(),
                            this._rainSpatters.initiateEnding(),
                            this._dependencies.gridFilter.getFilledCellsWithBehaviors([Ke.RainImpact]).forEach((function(e) {
                                var t;
                                return null === (t = e.content) || void 0 === t ? void 0 : t.removeBehaviorByType(Ke.RainImpact)
                            }
                            )),
                            this._dependencies.cameraService.cameraView.removeChild(this._rainStreaks),
                            this._rainStreaks.destroy(),
                            this.animationDone.fire(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }($y);
            !function(e) {
                e.DANDELIONS = "dandelions",
                e.BUTTERFLIES = "butterflies",
                e.RAIN = "rain",
                e.WIND = "wind"
            }(oT || (oT = {}));
            var ET, mT, yT, TT, AT, CT, IT, ST, OT, bT, RT, wT, DT, NT, LT, BT, PT, kT, xT, GT, UT, FT, MT, VT, HT, jT, KT, WT, zT, YT, JT, XT, qT, QT, ZT, $T, eA, tA, iA, nA, rA = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._weightList = [],
                    t._activeAnimations = [],
                    t._activeTimerAnimations = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "model", {
                    get: function() {
                        return De.services.worldToLifeService.model
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.onInitialize = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.WORLD_TO_LIFE)];
                            case 1:
                                return i.sent(),
                                this._inclusionRules = De.services.resource.getJsonCopy(_e.WORLD_TO_LIFE_ANIMATION_INCLUSION_RULES),
                                this._settings = De.services.resource.getJsonCopy(_e.WORLD_TO_LIFE_SETTINGS),
                                this._spawnChance = De.services.resource.getJsonCopy(_e.WORLD_TO_LIFE_ANIMATION_CHANCE_TO_SPAWN),
                                Object.values(oT).forEach((function(e) {
                                    return t._weightList.push({
                                        key: e,
                                        weight: t._spawnChance[e]
                                    })
                                }
                                )),
                                this.model.allActiveAnimations.forEach((function(e) {
                                    var i = De.services.timer.getTimerByID(e.timerId);
                                    if (i && !i.isFinished) {
                                        var n = t._getAnimationInstance(e.animation);
                                        t._logger.info("restoring ".concat(n.name, " animation")),
                                        t._activeTimerAnimations.set(i.id, n),
                                        i.onTimerFinished.addListener(t._animationTimerFinished, t)
                                    } else
                                        t.model.removeAnimation(e.timerId)
                                }
                                )),
                                (0,
                                r.isUndefined)(this.model.intervalTimer) ? (this.model.intervalTimer = void 0,
                                this._createIntervalTimer()) : (this._intervalTimer = De.services.timer.getTimerByID(this.model.intervalTimer),
                                null === (e = this._intervalTimer) || void 0 === e || e.onTimerFinished.addListener(this._onIntervalTimerFinished, this)),
                                De.services.worldToLifeService.onAnimationStartRequested.addListener(this._onAnimationStartRequested, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._activeAnimations.forEach((function(e) {
                                return e.destroy()
                            }
                            )),
                            this._activeAnimations = [],
                            this._activeTimerAnimations.forEach((function(e) {
                                return e.destroy()
                            }
                            )),
                            this._activeTimerAnimations.clear(),
                            null === (e = this._intervalTimer) || void 0 === e || e.onTimerFinished.removeListener(this._onIntervalTimerFinished, this),
                            De.services.worldToLifeService.onAnimationStartRequested.removeListener(this._onAnimationStartRequested, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._spawnRandomAnimation = function() {
                    var e = this._getRandomAnimation();
                    e ? this._spawnAnimation(e) : (this._logger.info("No available animation to spawn"),
                    (0,
                    r.isUndefined)(this.model.intervalTimer) && (0,
                    r.isNull)(this._intervalTimer) ? this._createIntervalTimer() : this._logger.error("cannot set new interval timer"))
                }
                ,
                t.prototype._getRandomAnimation = function() {
                    var e = [];
                    if (0 === this._activeAnimations.length && 0 === this._activeTimerAnimations.size)
                        e = (0,
                        n.__spreadArray)([], this._weightList, !0);
                    else {
                        for (var t = [], i = 0; i < this._activeAnimations.length; i++)
                            t.push(this._activeAnimations[i].animationType);
                        this._activeTimerAnimations.forEach((function(e) {
                            return t.push(e.animationType)
                        }
                        )),
                        e = this._getWeightedInclusionList(t)
                    }
                    if (0 !== e.length)
                        return UE(e)
                }
                ,
                t.prototype._getWeightedInclusionList = function(e) {
                    for (var t = this, i = [], n = 0; n < e.length; n++)
                        (this._inclusionRules[e[n]] || []).forEach((function(n) {
                            for (var r = 0; r < e.length; r++)
                                if (-1 === (t._inclusionRules[e[r]] || []).indexOf(n))
                                    return;
                            if (!i.find((function(e) {
                                return e.key === n
                            }
                            )) && -1 === e.indexOf(n)) {
                                var o = t._weightList.find((function(e) {
                                    return e.key === n
                                }
                                ));
                                o && i.push(o)
                            }
                        }
                        ));
                    return i
                }
                ,
                t.prototype._spawnAnimation = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = this._getAnimationInstance(e),
                                this._logger.info("spawning ".concat(t.name, " animation")),
                                t.persistance ? [4, t.getPlayingTime()] : [3, 2];
                            case 1:
                                return i = n.sent(),
                                (r = De.services.timer.addTimer(i, "WorldToLifeAnimationTimer: ".concat(e))).onTimerFinished.addListener(this._animationTimerFinished, this),
                                this.model.addAnimation({
                                    animation: oT.RAIN,
                                    timerId: r.id
                                }),
                                this._activeTimerAnimations.set(r.id, t),
                                [3, 3];
                            case 2:
                                this._activeAnimations.push(t),
                                t.animationDone.addListener(this._onAnimationFinished, this),
                                n.label = 3;
                            case 3:
                                return this._createIntervalTimer(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._animationTimerFinished = function(e) {
                    this.model.removeAnimation(e.id);
                    var t = this._activeTimerAnimations.get(e.id);
                    t && (t.animationDone.addListener(this._onAnimationFinished, this),
                    t.initiateEnding(),
                    this._activeTimerAnimations.delete(e.id))
                }
                ,
                t.prototype._onAnimationFinished = function(e) {
                    this._logger.info("removing ".concat(e.name, " animation")),
                    this._activeAnimations.indexOf(e) > -1 && this._activeAnimations.splice(this._activeAnimations.indexOf(e), 1),
                    e.animationDone.removeListener(this._onAnimationFinished, this),
                    e.destroy()
                }
                ,
                t.prototype._getAnimationInstance = function(e) {
                    switch (e) {
                    case oT.RAIN:
                        return new fT(this.services);
                    case oT.DANDELIONS:
                        return new dT(this.services);
                    case oT.BUTTERFLIES:
                        return new aT(this.services);
                    case oT.WIND:
                        return new lT(this.services,!0);
                    default:
                        return new fT(this.services)
                    }
                }
                ,
                t.prototype._onAnimationStartRequested = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createIntervalTimer = function() {
                    (0,
                    r.isUndefined)(this.model.intervalTimer) || this._logger.warn("interval timer already present in model"),
                    (0,
                    r.isNull)(this._intervalTimer) || this._logger.warn("interval timer already present in system"),
                    this._intervalTimer = De.services.timer.addTimer(1e3 * r.Random.int(this._settings.animationMinIntervalTime, this._settings.animationMaxIntervalTime), "WorldToLifeIntervalTimer"),
                    this._logger.info("created interval timer of ".concat(this._intervalTimer.remainingTime, " ms")),
                    this._intervalTimer.onTimerFinished.addListener(this._onIntervalTimerFinished, this),
                    this.model.intervalTimer = this._intervalTimer.id
                }
                ,
                t.prototype._onIntervalTimerFinished = function() {
                    this._logger.info("interval timer finished, trying to spawn animation"),
                    this._removeIntervalTimer(),
                    this._spawnRandomAnimation()
                }
                ,
                t.prototype._removeIntervalTimer = function() {
                    var e;
                    this._logger.info("removing interval timer"),
                    null === (e = this._intervalTimer) || void 0 === e || e.onTimerFinished.removeListener(this._onIntervalTimerFinished, this),
                    this._intervalTimer = null,
                    this.model.intervalTimer = void 0
                }
                ,
                t
            }(Pd), oA = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.UpgradeCard, Ke.AutoPlace], this._onAutoPlace),
                            this.addFamily([Ke.UpgradeCard, Ke.MergeResult], this._onMergeResult),
                            this.addFamily([Ke.UpgradeCard, Ke.GridPosition], this._onGridPosition),
                            this.addFamily([Ke.UpgradeCard, Ke.LootReceived], this._executeLootComplete),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onAutoPlace = function(e) {
                    var t = e.getBehavior(Ke.UpgradeCard);
                    if ((0,
                    r.isUndefined)(t.targetObjectTreeIngredient)) {
                        var i = e.getBehavior(Ke.AutoPlace);
                        if (i) {
                            var n = this.services.mapGrid.getContent(i.rootPosition.column, i.rootPosition.row);
                            if (n) {
                                var o = De.services.blueprintGraphService.getCollectItemFromBlueprint(n.getBlueprintID());
                                o ? this._updateUpgradeCardObject(e, t, o) : this._logger.error("No target object found for ".concat(n.getBlueprintID()))
                            } else
                                this._logger.error("No content found for ".concat(i.rootPosition.column, ", ").concat(i.rootPosition.row))
                        } else
                            this._logger.error("No autoplace behavior found")
                    }
                }
                ,
                t.prototype._onMergeResult = function(e) {
                    var t, i = this, n = e.getBehavior(Ke.UpgradeCard);
                    if ((0,
                    r.isUndefined)(n.targetObjectTreeIngredient)) {
                        var o = e.getBehavior(Ke.MergeResult);
                        if (o) {
                            var a = null === (t = o.originalContent) || void 0 === t ? void 0 : t.getBehavior(Ke.UpgradeCard);
                            if (a) {
                                var s = a.targetObjectTreeIngredient;
                                s ? (o.objectsToSpawn.forEach((function(e) {
                                    i._updateUpgradeCardObject(e, n, s)
                                }
                                )),
                                this._reportAnalytics(o.objectsToSpawn[0], o.originalContent)) : this._logger.error("No target object found on original upgrade card behavior")
                            } else
                                this._logger.error("No upgrade card behavior found on original content")
                        } else
                            this._logger.error("No merge result behavior found")
                    }
                }
                ,
                t.prototype._reportAnalytics = function(e, t) {
                    if (t) {
                        var i = e.getTier();
                        i && De.services.analytics.design.reportUpgradeCardMerged(t.getBlueprintID(), i)
                    }
                }
                ,
                t.prototype._addLootableBehavior = function(e, t, i) {
                    this.services.upgradeCard.model.getItemTier(i) >= 3 && e.addBehavior(new jt({
                        loot: t.sellForLoot
                    }))
                }
                ,
                t.prototype._executeLootComplete = function(e) {
                    e.addBehavior(new ti({}))
                }
                ,
                t.prototype._updateUpgradeCardObject = function(e, t, i) {
                    e.replaceBehavior(new Ti({
                        sellForLoot: t.sellForLoot,
                        targetObjectTreeIngredient: i
                    }));
                    var n = e.getBehavior(Ke.Mergeable);
                    n && (0,
                    r.isUndefined)(n.targetSpecification) && e.replaceBehavior(new qt({
                        target: n.target,
                        expReward: n.expReward,
                        targetSpecification: e.getBlueprintID() + i
                    })),
                    this._addLootableBehavior(e, t, i)
                }
                ,
                t.prototype._onGridPosition = function(e) {
                    var t = e.getBehavior(Ke.UpgradeCard);
                    (0,
                    r.isUndefined)(t.targetObjectTreeIngredient)
                }
                ,
                t
            }(Pd), aA = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.UpgradeCard, Ke.InteractionTap, Ke.GridPosition], this._onInteractionAdded),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onInteractionAdded = function(e) {
                    var t = this
                      , i = e.getBehavior(Ke.UpgradeCard);
                    if (!(0,
                    r.isUndefined)(i.targetObjectTreeIngredient) && !e.hasBehavior(Ke.Lootable)) {
                        var n = e.getBehavior(Ke.GridPosition);
                        if (this.services.onboarding.isTrackCompleted(Lo.UPGRADE_CARD_INTRODUCTION))
                            this.services.upgradeCard.onUpgradeCardClicked(e, {
                                column: n.column,
                                row: n.row
                            });
                        else {
                            var o = function() {
                                t.services.upgradeCard.onUpgradeCardIntroClosed.removeListener(o, t),
                                t.services.upgradeCard.onUpgradeCardClicked(e, {
                                    column: n.column,
                                    row: n.row
                                })
                            };
                            this.services.upgradeCard.onUpgradeCardIntroClosed.addListener(o, this)
                        }
                    }
                }
                ,
                t
            }(Pd), sA = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    i._titleTextAsset = t.titleTextAsset,
                    i._buttonTextAsset = t.buttonTextAsset;
                    var n = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: 350
                    });
                    return n.style = vn.lightMedium,
                    i._title = new v.Label(De.services.localization.getText(i._titleTextAsset),n),
                    i._title.anchor.set(.5, .5),
                    i._title.position.set(0, 50),
                    i._openContainer.addChild(i._title),
                    i.storeButton = i._openContainer.addChild(new fr({
                        name: "remove",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: i._expansionWidth - 30,
                            height: 90
                        }
                    },{
                        text: i._buttonTextAsset,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })),
                    i.storeButton.position.set(0, i._expansionHeight - i.storeButton.height / 2),
                    De.services.localization.onLanguageChanged.addListener(i._updateTexts, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    De.services.localization.onLanguageChanged.removeListener(this._updateTexts, this)
                }
                ,
                t.prototype._updateTexts = function() {
                    this._title.text = De.services.localization.getText(this._titleTextAsset),
                    this._title.style.fontFamily = vn.currentFontFamily,
                    this.storeButton.updateText(De.services.localization.getText(this._buttonTextAsset)),
                    this.storeButton.updateTextStyle({
                        fontFamily: vn.currentFontFamily
                    })
                }
                ,
                t
            }(Gd), _A = [{
                name: "animate_content",
                duration: 1,
                repeat: 0,
                keyframes: {
                    spawnable: [{
                        time: 0,
                        duration: 0,
                        ease: "none",
                        params: {
                            position: {
                                x: "+=0",
                                y: "+=0"
                            }
                        }
                    }, {
                        time: .2,
                        duration: .3,
                        ease: "circ.out",
                        params: {
                            alpha: 1,
                            position: {
                                y: "$topPoint"
                            }
                        }
                    }, {
                        time: .2,
                        duration: .55,
                        ease: "none",
                        params: {
                            position: {
                                x: "$arrivalPoint"
                            }
                        }
                    }, {
                        time: .55,
                        duration: .35,
                        ease: "circ.in",
                        params: {
                            position: {
                                y: "$arrivalPoint"
                            }
                        },
                        event: "updateLayer"
                    }, {
                        time: 0,
                        duration: .5,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 1.5,
                                y: 1.5
                            }
                        }
                    }, {
                        time: .8,
                        duration: .2,
                        ease: "sine.inOut",
                        params: {
                            scale: {
                                x: 0,
                                y: 0
                            }
                        }
                    }],
                    topPoint: [],
                    arrivalPoint: []
                }
            }], cA = function() {
                function e(e, t, i, n) {
                    this.onAnimationComplete = new r.Event,
                    this._content = new Xe.Sprite(e.texture),
                    this._content.anchor.copyFrom(e.anchor),
                    this._startPosition = e.position,
                    this._startContainer = t,
                    this._targetPosition = i,
                    this._targetContainer = n,
                    this._setupAnimation()
                }
                return e.prototype._setupAnimation = function() {
                    var e = this;
                    this._targetContainer.addChild(this._content);
                    var t = this._startContainer.toGlobal(this._startPosition);
                    this._content.position = this._targetContainer.toLocal(t);
                    var i = new ur(_A);
                    i.setTargets({
                        spawnable: this._content,
                        topPoint: {
                            position: {
                                x: this._content.position.x,
                                y: Math.min(this._content.position.y - (this._content.height / 2 + 100), this._targetPosition.y - 100)
                            }
                        },
                        arrivalPoint: {
                            position: {
                                x: this._targetPosition.x,
                                y: this._targetPosition.y
                            }
                        }
                    }),
                    i.onEnd.addListener((function() {
                        e._targetContainer.removeChild(e._content),
                        e._content.destroy(),
                        e.onAnimationComplete.fire()
                    }
                    ), null),
                    i.play("animate_content")
                }
                ,
                e
            }(), lA = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._popoutStore = new zd,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.addFamily([Ke.Decorative, Ke.InteractionTap, Ke.GridPosition], this._onDecorativeTapped),
                            this.addFamily([Ke.Building, Ke.Decorative, Ke.PickupBuildingStart, Ke.GridPosition], this._onBuildingPickStart),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onDecorativeTapped = function(e) {
                    var t = e.getBehavior(Ke.Building);
                    if (!t || De.services.buildings.isBuildingActive(t.ID)) {
                        this._logger.info("decorative tapped");
                        var i = e.getBehavior(Ke.GridPosition)
                          , n = this._popoutStore.get(i);
                        if (n)
                            return this.services.popout.showPopout(n),
                            void De.services.analytics.design.reportStoragePopoutShown();
                        var r = t ? {
                            alias: De.services.buildings.getBuildingConfigProperty(t.ID, "nameKey")
                        } : ce.ONBOARDING_DECORATIVE_OBJECT_HEADER;
                        this._createPopout(e, i, r)
                    }
                }
                ,
                t.prototype._createPopout = function(e, t, i) {
                    var n = this
                      , r = new sA({
                        expansionWidth: 400,
                        expansionHeight: 200,
                        basePopoutType: Bd.OPEN_ONLY,
                        titleTextAsset: i,
                        buttonTextAsset: ce.BUTTON_MOVE_TO_STORAGE
                    });
                    r.storeButton.onClick((function() {
                        De.services.analytics.design.reportStoragePopoutMoveToStorageButtonPressed(),
                        n._removePopout(e, t),
                        n.services.storage.isEmptySlotAvailable() ? (e.addBehavior(new ti({})),
                        n.services.storage.storeObject(e),
                        n._animateObjectToStorage(e)) : n.services.storage.openStorageIsFullPopup(e.getBlueprintID())
                    }
                    )),
                    r.position.copyFrom(e.position),
                    r.open(!1),
                    this.services.popout.registerPopout(r),
                    this.services.popout.showPopout(r),
                    De.services.analytics.design.reportStoragePopoutShown(),
                    this._popoutStore.add(t, r)
                }
                ,
                t.prototype._removePopout = function(e, t) {
                    if (void 0 === t && (t = null),
                    t || (t = e.getBehavior(Ke.GridPosition)),
                    t) {
                        var i = this._popoutStore.remove(t);
                        i && (this.services.popout.hidePopout(i),
                        this.services.popout.unregisterPopout(i))
                    } else
                        this._logger.error("Can't remove popup for object that has no gridposition")
                }
                ,
                t.prototype._animateObjectToStorage = function(e) {
                    var t = this;
                    return new Promise((function(i) {
                        var n = t.services.hudService.hudContainer.getUIelement(Ns.StorageButtonUI)
                          , r = e.getChildByName("maincontainer");
                        r.visible = !1;
                        var o = r.getChildByName("mainsprite");
                        new cA(o,r,n.position,n.parent).onAnimationComplete.addListener((function() {
                            i()
                        }
                        ), t)
                    }
                    ))
                }
                ,
                t.prototype._onBuildingPickStart = function(e) {
                    var t = e.getBehavior(Ke.GridPosition);
                    this._removePopout(e, t)
                }
                ,
                t
            }(Pd), uA = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._version = 1,
                    t._name = "OrdersModel",
                    t._currentOrders = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "currentOrders", {
                    get: function() {
                        return this._currentOrders
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.getOrderByBuilding = function(e) {
                    return this._currentOrders.find((function(t) {
                        return t.buildingID === e
                    }
                    ))
                }
                ,
                t.prototype.setOrderState = function(e, t) {
                    var i = this.getOrderByBuilding(e);
                    i ? (i.state = t,
                    this.saveData()) : this._logger.warn("trying to change state of non existing order")
                }
                ,
                t.prototype.setOrderTimer = function(e, t) {
                    var i = this.getOrderByBuilding(e);
                    i ? (i.timerId = t,
                    this.saveData()) : this._logger.warn("trying to set timer of non existing order")
                }
                ,
                t.prototype.addOrder = function(e) {
                    this._currentOrders.includes(e) ? this._logger.warn("order already added to model") : (this._currentOrders.push(e),
                    this.saveData())
                }
                ,
                t.prototype.removeOrderTimer = function(e) {
                    var t = this.getOrderByBuilding(e);
                    t && t.timerId ? (t.timerId = void 0,
                    this.saveData()) : this._logger.warn("non existing order or timer already undefined")
                }
                ,
                t.prototype.removeOrder = function(e) {
                    var t = this._currentOrders.indexOf(e);
                    -1 !== t ? (this._currentOrders.splice(t, 1),
                    this.saveData()) : this._logger.warn("order can't be removed from model")
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        return t.addOrder(e)
                    }
                    ))
                }
                ,
                t.prototype.onDataSave = function() {
                    return this._currentOrders
                }
                ,
                t
            }($n), dA = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.onOrderStateChange = new r.Event,
                    t.onOrderRewarded = new r.Event,
                    t.onNewOrder = new r.Event,
                    t._isClaiming = !1,
                    t._autoSaveService = De.services.autosave,
                    t._inventory = De.services.inventory,
                    t._buildings = De.services.buildings,
                    t._timerService = De.services.timer,
                    t._recipes = De.services.recipes,
                    t._experienceService = De.services.experience,
                    t._notificationService = De.services.notifications,
                    t._ordersModel = new uA,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "isClaiming", {
                    get: function() {
                        return this._isClaiming
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.onBuildingUnpaused = function(e) {
                    this._buildings.isWorkshop(e) && this._createOrderForBuilding(e)
                }
                ,
                t.prototype.openOrdersPopup = function(e) {
                    var t = this;
                    if ((0,
                    r.isUndefined)(e)) {
                        var i = this.getBuildingsWithActiveOrders().filter((function(e) {
                            return !!t.getOrderByBuilding(e)
                        }
                        )).map((function(e) {
                            return t.getOrderByBuilding(e)
                        }
                        ));
                        e = i[0].buildingID
                    }
                    De.services.lazyLoad.prioritizeGroup(hn.ORDERS_POPUP).then((function() {
                        De.services.navigation.showPopup(Ic, {
                            buildingID: e,
                            ordersService: t,
                            marketplaceService: t.services.marketplaceService,
                            onboardingService: t.services.onboarding,
                            upgradeCard: t.services.upgradeCard
                        })
                    }
                    ))
                }
                ,
                t.prototype.getCurrentOrders = function() {
                    return this._ordersModel.currentOrders
                }
                ,
                t.prototype.getBuildingsWithActiveOrders = function() {
                    return this._ordersModel.currentOrders.map((function(e) {
                        return e.buildingID
                    }
                    ))
                }
                ,
                t.prototype.getOrderByBuilding = function(e) {
                    return this._ordersModel.getOrderByBuilding(e)
                }
                ,
                t.prototype.startOrder = function(e) {
                    var t = this._ordersModel.getOrderByBuilding(e);
                    if (t)
                        if (t.state === ps.STARTABLE && this._canAffordOrder(t))
                            if (this._recipes.hasRecipe(t.recipe)) {
                                var i = this._recipes.getRecipe(t.recipe);
                                this._inventory.deductItems(i.ingredients),
                                this._ordersModel.setOrderState(t.buildingID, ps.IN_PROGRESS);
                                var r = 1e3 * i.duration
                                  , o = this._timerService.addTimer(r, "Order_".concat(t.buildingID));
                                this._ordersModel.setOrderTimer(t.buildingID, o.id),
                                o.onTimerFinished.addListener(this._onTimerFinished, this),
                                this.onOrderStateChange.fire(t);
                                var a = nr(ET || (ET = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), {
                                    alias: i.ID
                                });
                                this._logger.info("Order for the product ".concat(a, " has just started!")),
                                this._notificationService.createMessageForOrder(e, t, i, r)
                            } else
                                this._logger.error("invalid recipe key ".concat(t.recipe));
                        else
                            this._logger.error("order for building ".concat(e, " is not startable"));
                    else
                        this._logger.error("can't start order for building ".concat(e, " because it doesn't exist"))
                }
                ,
                t.prototype.rewardOrder = function(e) {
                    var t = this
                      , i = this._ordersModel.getOrderByBuilding(e);
                    if (i)
                        if (i.state === ps.COMPLETE) {
                            if (!this._isClaiming) {
                                var n = this.services.gridFilter.getFilledCellsWithBehaviors([Ke.Building]).find((function(t) {
                                    var i, n;
                                    return (null === (n = null === (i = t.content) || void 0 === i ? void 0 : i.getBehavior(Ke.Building)) || void 0 === n ? void 0 : n.ID) === e
                                }
                                ));
                                n ? (this._isClaiming = !0,
                                this.services.cameraService.animateCameraToCell(n).then((function() {
                                    i && (t.onOrderRewarded.fire(i),
                                    De.services.discovery.onOrderRewarded.fire(i)),
                                    t._isClaiming = !1
                                }
                                ))) : this._logger.error("no cell holding building ".concat(e))
                            }
                        } else
                            this._logger.error("order for buildingID ".concat(e, " is not complete"));
                    else
                        this._logger.error("can't reward order for buildingID ".concat(e, " because it doesn't exist"))
                }
                ,
                t.prototype.consumeOrder = function(e) {
                    var t = this._ordersModel.getOrderByBuilding(e);
                    t ? (this._ordersModel.removeOrder(t),
                    this._buildings.startCooldown(e),
                    this._updateButtonVisual()) : this._logger.error("can't consume order for buildingID ".concat(e, " because it doesn't exist"))
                }
                ,
                t.prototype.finishOrder = function(e) {
                    e.timerId && this._handleFinishedOrderTimer(e)
                }
                ,
                t.prototype.openMissingIngredientPopup = function(e) {
                    var t = this;
                    De.services.assetLoader.loadJsons(_e.ITEM_PURCHASE_COSTS_CONFIG).then((function() {
                        De.services.navigation.isPopupTypeOpen(Ic) && De.services.navigation.showPopup(qy, {
                            missingItems: e,
                            marketPlaceService: t.services.marketplaceService,
                            gridFilter: t.services.gridFilter,
                            worldService: t.services.world,
                            mapGridView: t.services.mapGridView,
                            visibleCells: t.services.visibleCells,
                            storageBubble: t.services.storageBubble
                        })
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._initialize(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._checkBuildingCooldownStates(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return Object.keys(Sn).forEach((function(t) {
                                e._inventory.getInventoryItem(Sn[t]).onChanged.removeListener(e._onIngredientsChanged, e)
                            }
                            )),
                            this._buildings.onBuildingStateChanged.removeListener(this._onBuildingStateChanged, this),
                            this._buildings.onCooldownFinished.removeListener(this._onBuildingCooldownFinished, this),
                            this._autoSaveService.unregisterModel(this._ordersModel),
                            this._ordersModel.currentOrders.forEach((function(t) {
                                var i;
                                t.timerId && (null === (i = e._timerService.getTimerByID(t.timerId)) || void 0 === i || i.onTimerFinished.removeListener(e._onTimerFinished, e))
                            }
                            )),
                            this._experienceService.onLevelUp.removeListener(this._onLevelUp, this),
                            this.onOrderStateChange.removeListener(this._createOrderAction, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onIngredientsChanged = function() {
                    for (var e = 0; e < this._ordersModel.currentOrders.length; e++) {
                        var t = this._ordersModel.currentOrders[e];
                        if (t.state === ps.AVAILABLE || t.state === ps.STARTABLE) {
                            var i = this._canAffordOrder(t) ? ps.STARTABLE : ps.AVAILABLE;
                            t.state !== i && (this._ordersModel.setOrderState(t.buildingID, i),
                            this.onOrderStateChange.fire(t))
                        }
                    }
                }
                ,
                t.prototype._onBuildingStateChanged = function(e) {
                    this._buildings.isWorkshop(e) && De.services.buildings.getBuildingState(e) === sv.ACTIVE && !this.services.onboarding.isBuildingPaused(e) && this._createOrderForBuilding(e)
                }
                ,
                t.prototype._onTimerFinished = function(e) {
                    var t = this._ordersModel.currentOrders.find((function(t) {
                        return t.timerId === e.id
                    }
                    ));
                    t && this._handleFinishedOrderTimer(t)
                }
                ,
                t.prototype._handleFinishedOrderTimer = function(e) {
                    this._ordersModel.setOrderState(e.buildingID, ps.COMPLETE),
                    this._ordersModel.removeOrderTimer(e.buildingID),
                    this.onOrderStateChange.fire(e),
                    this._notificationService.cancelMessage(Vr.ORDER_COMPLETE, e.recipe)
                }
                ,
                t.prototype._onBuildingCooldownFinished = function(e) {
                    this._createOrderForBuilding(e)
                }
                ,
                t.prototype._checkBuildingCooldownStates = function() {
                    var e = this;
                    this._buildings.activeBuildings.forEach((function(t) {
                        e._buildings.isBuildingInCoolDownState(t) || e.getOrderByBuilding(t) || e._createOrderForBuilding(t)
                    }
                    ))
                }
                ,
                t.prototype._onLevelUp = function() {
                    var e = this;
                    this._buildings.activeBuildings.filter((function(t) {
                        return !!e._buildings.isWorkshop(t) && !e._ordersModel.getOrderByBuilding(t) && !e._buildings.isBuildingInCoolDownState(t)
                    }
                    )).forEach((function(t) {
                        return e._createOrderForBuilding(t)
                    }
                    ))
                }
                ,
                t.prototype._createOrderForBuilding = function(e) {
                    var t = this;
                    if (!this.services.onboarding.isBuildingPaused(e)) {
                        var i = this._buildings.getAvailableRecipes(e)
                          , n = this._experienceService.getAvailableRecipes()
                          , r = i.filter((function(e) {
                            return n.includes(e)
                        }
                        ));
                        if (0 !== (r = r.filter((function(e) {
                            return t._recipes.hasRecipe(e)
                        }
                        ))).length) {
                            var o = this._getOrderFromRecipeList(r, e);
                            if (!o) {
                                var a = this._getIngredientsOnMap();
                                if (a.length > 0) {
                                    var s = this._getProximityScores(a)
                                      , _ = this._getProximityResultList(s);
                                    o = this._getOrderFromRecipeList(r, e, _)
                                } else
                                    o = {
                                        buildingID: e,
                                        recipe: this._getSortedOrderList(r, e)[0].orderID,
                                        state: ps.AVAILABLE
                                    }
                            }
                            this._ordersModel.addOrder(o),
                            this.onNewOrder.fire(o),
                            this._updateButtonVisual(),
                            this._onIngredientsChanged()
                        } else
                            this._logger.warn("No recipes available for buildingID ".concat(e))
                    }
                }
                ,
                t.prototype._getOrderFromRecipeList = function(e, t, i) {
                    var n = null
                      , r = this._getSortedOrderList(e, t, i)
                      , o = this._getAffordableOrders(r);
                    return o && o.length > 1 ? n = this._getRandomAffordableOrder(o, t) : i && (n = {
                        buildingID: t,
                        recipe: r[0].orderID,
                        state: ps.AVAILABLE
                    }),
                    n
                }
                ,
                t.prototype._getSortedOrderList = function(e, t, i) {
                    var n = this;
                    return e.map((function(e) {
                        return {
                            orderID: e,
                            fillPercentage: n._getFillPercentageForOrder({
                                buildingID: t,
                                recipe: e,
                                state: ps.STARTABLE
                            }, i),
                            rewardAmount: n._getCoinRewardAmountForRecipe(e)
                        }
                    }
                    )).sort((function(e, t) {
                        return t.fillPercentage - e.fillPercentage
                    }
                    ))
                }
                ,
                t.prototype._getAffordableOrders = function(e) {
                    return e.filter((function(e) {
                        return 100 === e.fillPercentage
                    }
                    ))
                }
                ,
                t.prototype._getFillPercentageForOrder = function(e, t) {
                    var i = this
                      , n = 0;
                    if (!this._recipes.hasRecipe(e.recipe))
                        return this._logger.error("invalid recipe key ".concat(e.recipe)),
                        n;
                    var r = this._recipes.getRecipe(e.recipe);
                    if (this._inventory.hasEnoughItems(r.ingredients))
                        n = 100;
                    else {
                        var o = 0
                          , a = 0;
                        r.ingredients.forEach((function(e) {
                            o += e.amount,
                            a += i._inventory.hasAmount(e.key, e.amount) ? e.amount : i._inventory.getAmount(e.key),
                            t && t[e.key] && (a += t[e.key])
                        }
                        )),
                        n = a / o * 100
                    }
                    return n
                }
                ,
                t.prototype._getRandomAffordableOrder = function(e, t) {
                    return {
                        buildingID: t,
                        recipe: r.ArrayUtility.getRandomItem(e).orderID,
                        state: ps.STARTABLE
                    }
                }
                ,
                t.prototype._getOrderWithHighestReward = function(e, t) {
                    return {
                        buildingID: t,
                        recipe: (0,
                        n.__spreadArray)([], e, !0).sort((function(e, t) {
                            return t.rewardAmount - e.rewardAmount
                        }
                        ))[0].orderID,
                        state: ps.STARTABLE
                    }
                }
                ,
                t.prototype._getProximityScores = function(e) {
                    var t = new Map;
                    return e.forEach((function(e) {
                        var i = De.services.blueprintGraphService.getCollectItemFromBlueprint(e)
                          , n = parseFloat(e.split("_")[1]) - 1
                          , r = t.get(i);
                        t.set(i, void 0 !== r ? r + Math.pow(3, n) : Math.pow(3, n))
                    }
                    )),
                    t
                }
                ,
                t.prototype._getProximityResultList = function(e) {
                    var t = {};
                    return e.forEach((function(e, i) {
                        e && (t[i] = e / 27 * 4)
                    }
                    )),
                    t
                }
                ,
                t.prototype._getCoinRewardAmountForRecipe = function(e) {
                    var t = this._recipes.getRecipe(e)
                      , i = 0;
                    return t.reward.forEach((function(e) {
                        var t = De.services.blueprintCollection.getBlueprint(e).components[Ke.Collectable];
                        if (t) {
                            var n = t.reward.reduce((function(e, t) {
                                var i = t.key
                                  , n = t.amount;
                                return i === Cn.COINS ? e += n : e
                            }
                            ), 0);
                            i += n
                        }
                    }
                    )),
                    i
                }
                ,
                t.prototype._getIngredientsOnMap = function() {
                    var e = this.services.gridFilter.getFilledCellsWithBehaviors([Ke.Crop]).map((function(e) {
                        var t;
                        return null === (t = e.content) || void 0 === t ? void 0 : t.getBlueprintID()
                    }
                    ))
                      , t = this.services.gridFilter.getFilledCellsWithBehaviors([Ke.Animal]).map((function(e) {
                        var t;
                        return null === (t = e.content) || void 0 === t ? void 0 : t.getBlueprintID()
                    }
                    ));
                    return (0,
                    n.__spreadArray)((0,
                    n.__spreadArray)([], e, !0), t, !0).filter((function(e) {
                        return 4 !== parseFloat(e.split("_")[1])
                    }
                    ))
                }
                ,
                t.prototype._canAffordOrder = function(e) {
                    if (!this._recipes.hasRecipe(e.recipe))
                        return this._logger.error("invalid recipe key ".concat(e.recipe)),
                        !1;
                    var t = this._recipes.getRecipe(e.recipe);
                    return this._inventory.hasEnoughItems(t.ingredients)
                }
                ,
                t.prototype._initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return Object.keys(Sn).forEach((function(t) {
                                    e._inventory.getInventoryItem(Sn[t]).onChanged.addListener(e._onIngredientsChanged, e)
                                }
                                )),
                                this._buildings.onBuildingStateChanged.addListener(this._onBuildingStateChanged, this),
                                this._buildings.onCooldownFinished.addListener(this._onBuildingCooldownFinished, this),
                                [4, this._autoSaveService.registerModel(this._ordersModel)];
                            case 1:
                                return t.sent(),
                                this._ordersModel.currentOrders.forEach((function(t) {
                                    t.timerId && e._timerService.getTimerByID(t.timerId).onTimerFinished.addListener(e._onTimerFinished, e)
                                }
                                )),
                                this._experienceService.onLevelUp.addListener(this._onLevelUp, this),
                                this.onOrderStateChange.addListener(this._createOrderAction, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createOrderAction = function(e) {
                    if (e.state === ps.COMPLETE || e.state === ps.IN_PROGRESS) {
                        var t = e.state === ps.COMPLETE ? "complete" : "start";
                        De.services.actions.emit("order.".concat(t, ".").concat(e.buildingID, ".").concat(e.recipe))
                    }
                }
                ,
                t.prototype._updateButtonVisual = function() {
                    this.getCurrentOrders().length > 0 ? this.services.hudService.showHudElement(Ns.OrderButtonUI) : this.services.hudService.hideHudElement(Ns.OrderButtonUI)
                }
                ,
                t
            }(Go), hA = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._shovelableCells = [],
                    t._nonShovelableCells = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.highlightRemovableTiles = function() {
                    var e = this;
                    this._shovelableCells = this.services.gridFilter.getFilledCellsWithBehaviors([Ke.Shovelable]);
                    var t = this.services.gridFilter.getFilledCells();
                    this._nonShovelableCells = t.filter((function(t) {
                        return !e._shovelableCells.includes(t)
                    }
                    )),
                    this._shovelableCells.forEach((function(e) {
                        e.content
                    }
                    )),
                    this._nonShovelableCells.forEach((function(e) {
                        e.content && (e.content.alpha = .5)
                    }
                    ))
                }
                ,
                t.prototype.resetAllTiles = function() {
                    this._shovelableCells.forEach((function(e) {
                        e.content
                    }
                    )),
                    this._nonShovelableCells.forEach((function(e) {
                        e.content && (e.content.alpha = 1)
                    }
                    ))
                }
                ,
                Object.defineProperty(t.prototype, "shovelableCells", {
                    get: function() {
                        return this._shovelableCells
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "nonShovelableCells", {
                    get: function() {
                        return this._nonShovelableCells
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), pA = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "DailyChallengeModel",
                    t._version = 1,
                    t._task = "",
                    t._localizedTask = "",
                    t._currentAmount = 0,
                    t._mainChallenge = {
                        rewards: [],
                        collected: !1
                    },
                    t._targets = [],
                    t._timerID = void 0,
                    t._timerStarted = 0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "data", {
                    get: function() {
                        return {
                            task: this._task,
                            localizedTask: this._localizedTask,
                            currentAmount: this._currentAmount,
                            mainChallenge: this._mainChallenge,
                            targets: this._targets,
                            timerID: this._timerID,
                            timerStarted: this._timerStarted
                        }
                    },
                    set: function(e) {
                        this._task = e.task,
                        this._localizedTask = e.localizedTask,
                        this._currentAmount = e.currentAmount,
                        this._mainChallenge = e.mainChallenge,
                        this._targets = e.targets,
                        this._timerID = e.timerID,
                        this._timerStarted = e.timerStarted,
                        this.saveData()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.clearData = function() {
                    this._task = "",
                    this._localizedTask = "",
                    this._currentAmount = 0,
                    this._mainChallenge = {
                        rewards: [],
                        collected: !1
                    },
                    this._targets = [],
                    this._timerID = void 0,
                    this._timerStarted = 0,
                    this.saveData()
                }
                ,
                t.prototype.addProgress = function() {
                    this._currentAmount++,
                    this.saveData()
                }
                ,
                t.prototype.setMainTaskCompleted = function() {
                    this._mainChallenge.collected = !0,
                    this.saveData()
                }
                ,
                t.prototype.setSubTargetCollected = function(e) {
                    this._targets[e].collected = !0,
                    this.saveData()
                }
                ,
                t.prototype.getFinishedTargets = function() {
                    return this._targets.filter((function(e) {
                        return e.collected
                    }
                    ))
                }
                ,
                t.prototype.getFirstUnclaimedReward = function() {
                    var e = this;
                    return this._targets.find((function(t) {
                        return e._currentAmount >= t.amount && !t.collected
                    }
                    ))
                }
                ,
                t.prototype.hasUnclaimedRewards = function() {
                    var e = this;
                    return this._targets.reduce((function(t, i) {
                        return e._currentAmount >= i.amount ? t += 1 : t += 0
                    }
                    ), 0) >= this._targets.length || this._targets.some((function(t) {
                        return e._currentAmount >= t.amount && !t.collected
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._task = e.task,
                    this._localizedTask = e.localizedTask,
                    this._currentAmount = e.currentAmount,
                    this._mainChallenge = e.mainChallenge,
                    this._targets = e.targets,
                    this._timerID = e.timerID,
                    this._timerStarted = e.timerStarted
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        task: this._task,
                        localizedTask: this._localizedTask,
                        currentAmount: this._currentAmount,
                        mainChallenge: this._mainChallenge,
                        targets: this._targets,
                        timerID: this._timerID,
                        timerStarted: this._timerStarted
                    }
                }
                ,
                t
            }($n), vA = Lo.REGAIN_CONTROL_TRACK, gA = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.featureActive = vp.platform.loginStrategy.isUserLoggedIn(),
                    t.startChallengeOutsideOfWindow = void 0,
                    t.onDailyChallengeTaskActionPerformed = new r.Event,
                    t.onNewDailyChallengeTaskStarted = new r.Event,
                    t.onDailyChallengeTaskRewardClaimed = new r.Event,
                    t.onDailyChallengeTaskRewardReady = new r.Event,
                    t._model = new pA,
                    t._config = void 0,
                    t._timer = void 0,
                    t._popup = void 0,
                    t._timeWindowInterval = void 0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "model", {
                    get: function() {
                        return this._model
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.openDailyChallengePopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return (0,
                                r.isUndefined)(this._config) ? (this._logger.warn("no config file, cannot open popup."),
                                [2]) : [4, this._canShowPopup()];
                            case 1:
                                return i.sent() ? (e = this,
                                [4, De.services.navigation.showPopup(bg, {
                                    challengeData: this._model.data,
                                    dailyChallengeService: this,
                                    storageBubble: this.services.storageBubble,
                                    mapGridView: this.services.mapGridView
                                }, !1)]) : [2];
                            case 2:
                                return e._popup = i.sent(),
                                this._popup.onClosed.addListener((function() {
                                    t._popup = void 0
                                }
                                ), this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.mainTaskRewardCollected = function() {
                    this.model.setMainTaskCompleted(),
                    this.onDailyChallengeTaskRewardClaimed.fire()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this.featureActive ? [4, Promise.all([De.services.autosave.registerModel(this._model), De.services.lazyLoad.prioritizeGroup(hn.DAILY_CHALLENGE)])] : [2];
                            case 1:
                                return t.sent(),
                                e = this,
                                [4, De.services.nakamaConfigurationLoadService.loadConfiguration(Eu.DAILY_CHALLENGE)];
                            case 2:
                                return e._config = t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    var e = this;
                    if ((0,
                    r.isUndefined)(this._config))
                        return this.services.hudService.hideHudElement(Ns.DailyChallengeButtonUI, !0),
                        void this._logger.warn("Could not load config file. Disabling feature.");
                    (0,
                    r.isUndefined)(this._model.data.timerID) ? De.services.onboardingGameService.onboardingRunningAtStartSession.then((function(t) {
                        t ? De.services.onboardingGameService.onInteractionReadyEvent.listenOnce((function() {
                            e._prepareChallenge(e._config, !0)
                        }
                        ), e) : e._prepareChallenge(e._config, !0)
                    }
                    )) : (this._addListeners(),
                    this._showButton(this._model.data))
                }
                ,
                t.prototype.onDestroy = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return De.services.autosave.unregisterModel(this._model),
                            De.services.actions.off(this._model.data.task, this._onActionPerformed, this),
                            null === (e = this._timer) || void 0 === e || e.onTimerFinished.removeListener(this._onTimerFinished, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._prepareChallenge = function(e, t, i) {
                    if (void 0 === t && (t = !1),
                    void 0 === i && (i = !1),
                    !i && e.activeTimeWindow && !this._isWithinTimeWindow(e.activeTimeWindow))
                        return this._logger.warn("Cannot start new challenge, time window is not active."),
                        void this.services.hudService.hideHudElement(Ns.DailyChallengeButtonUI, t);
                    this._startNewChallenge(e)
                }
                ,
                t.prototype._onTimerFinished = function(e) {
                    var t;
                    e.id === (null === (t = this._timer) || void 0 === t ? void 0 : t.id) && (e.onTimerFinished.removeListener(this._onTimerFinished, this),
                    this._timer = void 0,
                    De.services.actions.off(this._model.data.task, this._onActionPerformed, this),
                    this._model.clearData(),
                    this._popup && this._popup.close(),
                    this._prepareChallenge(this._config))
                }
                ,
                t.prototype._startNewChallenge = function(e) {
                    var t = this._createNewDailyChallenge(e);
                    this._model.data = t,
                    this._addListeners(),
                    this._showButton(t),
                    this.onNewDailyChallengeTaskStarted.fire(t),
                    this.openDailyChallengePopup(),
                    De.services.analytics.design.dailyChallengeStarted(t.task)
                }
                ,
                t.prototype._addListeners = function() {
                    (0,
                    r.isUndefined)(this._model.data.timerID) ? this._logger.error("No timerID found in model data, cannot add listeners.") : (this._timer = De.services.timer.getTimerByID(this._model.data.timerID),
                    this._timer.onTimerFinished.listenOnce(this._onTimerFinished, this),
                    De.services.actions.on(this._model.data.task, this._onActionPerformed, this))
                }
                ,
                t.prototype._showButton = function(e) {
                    this.services.hudService.hudContainer.getUIelement(Ns.DailyChallengeButtonUI).challengeActive(e),
                    this.services.hudService.showHudElement(Ns.DailyChallengeButtonUI)
                }
                ,
                t.prototype._createNewDailyChallenge = function(e) {
                    var t = r.ArrayUtility.getRandomItem(e.taskpool);
                    return {
                        task: t.taskAction,
                        localizedTask: t.localizedTask,
                        currentAmount: 0,
                        mainChallenge: {
                            rewards: e.completeRewards,
                            collected: !1
                        },
                        targets: this._createDailyChallengeTargets(t.targets, e.rewardsPerTask),
                        timerID: De.services.timer.addTimer(864e5).id,
                        timerStarted: Date.now()
                    }
                }
                ,
                t.prototype._createDailyChallengeTargets = function(e, t) {
                    for (var i = De.services.experience.getLevel(), n = e.find((function(e) {
                        return !(e.levelSegment.min && i < e.levelSegment.min || e.levelSegment.max && i > e.levelSegment.max)
                    }
                    )), r = [], o = 0; o < t.length; o++)
                        r.push({
                            amount: n.baseValue + n.increasePerTask * o,
                            reward: t[o],
                            collected: !1,
                            id: o + 1
                        });
                    return r
                }
                ,
                t.prototype._onActionPerformed = function() {
                    if (this._model.addProgress(),
                    this._model.hasUnclaimedRewards()) {
                        var e = this._model.getFirstUnclaimedReward();
                        if (!(0,
                        r.isUndefined)(e)) {
                            this.onDailyChallengeTaskRewardReady.fire(e),
                            e.collected = !0;
                            var t = (Date.now() - this._model.data.timerStarted) / 36e5
                              , i = Math.round(100 * t) / 100;
                            De.services.analytics.design.dailyChallengeSubTaskCompleted(this._model.data.task, e.id, i)
                        }
                    } else
                        this.onDailyChallengeTaskActionPerformed.fire()
                }
                ,
                t.prototype._isWithinTimeWindow = function(e) {
                    var t = this
                      , i = Date.now();
                    if (i > e.end)
                        return !1;
                    if (i < e.start) {
                        var n = e.start - i;
                        return this._timeWindowInterval = setTimeout((function() {
                            t._prepareChallenge(t._config)
                        }
                        ), n),
                        !1
                    }
                    return !0
                }
                ,
                t.prototype._canShowPopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return (e = this.services.onboarding.isTrackCompleted(vA)) || this.services.onboarding.onTrackCompleted.listenOnce((function() {
                                t.openDailyChallengePopup()
                            }
                            ), this),
                            [2, e]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), fA = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "TimedEventModel",
                    t._version = 1,
                    t._data = {},
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.isEventActive = function(e) {
                    var t = this._data[e];
                    return !(0,
                    r.isUndefined)(t) && t.endTime > Date.now()
                }
                ,
                t.prototype.getActiveEvents = function() {
                    return Object.entries(this._data).filter((function(e) {
                        return e[1].endTime > Date.now()
                    }
                    )).map((function(e) {
                        var t = e[0]
                          , i = e[1];
                        return {
                            type: t,
                            eventConfigurationData: i.eventConfiguration,
                            startTime: i.startTime,
                            endTime: i.endTime
                        }
                    }
                    ))
                }
                ,
                t.prototype.getEndedEvents = function() {
                    return Object.entries(this._data).filter((function(e) {
                        return e[1].endTime < Date.now()
                    }
                    )).map((function(e) {
                        return e[0]
                    }
                    ))
                }
                ,
                t.prototype.getEventByTimerID = function(e) {
                    return Object.values(this._data).find((function(t) {
                        return t.timerId === e
                    }
                    ))
                }
                ,
                t.prototype.getEventSavedData = function(e) {
                    return this._data[e]
                }
                ,
                t.prototype.setEventSavedData = function(e, t) {
                    this._data[e] = t;
                    var i = De.services.timer.getTimerByID(t.timerId);
                    null == i || i.onTimerFastForwarded.addListener(this._onTimerFastForwarded, this),
                    this.saveData()
                }
                ,
                t.prototype.deleteEventSavedData = function(e) {
                    delete this._data[e],
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    var t = this;
                    this._data = e,
                    Object.values(this._data).forEach((function(e) {
                        De.services.timer.getTimerByID(e.timerId).onTimerFastForwarded.addListener(t._onTimerFastForwarded, t)
                    }
                    ))
                }
                ,
                t.prototype.onDataSave = function() {
                    return this._data
                }
                ,
                t.prototype._onTimerFastForwarded = function(e) {
                    var t = this.getEventByTimerID(e.id);
                    (0,
                    r.isUndefined)(t) || (t.endTime = Date.now() + e.remainingTime,
                    this.saveData())
                }
                ,
                t
            }($n), EA = function(e) {
                function t(t) {
                    var i = this
                      , n = De.services.resource.getTexture(f.OVERLAY_LEFT_BUTTONBACKGROUND)
                      , r = new cr(n,1,n.height / 2,n.width - 1,n.height / 2);
                    return r.width = t.eventButtonSettings.drawerWidth,
                    r.anchor.set(.5),
                    r.position.copyFrom(t.eventButtonSettings.drawerImagePosition),
                    (i = e.call(this, {
                        name: "extraWorker",
                        buttonIdle: t.buttonProperties.buttonIdle,
                        buttonActive: t.buttonProperties.buttonActive,
                        targetPressedScale: 1.316,
                        backdropContent: [r],
                        uiHeight: t.buttonProperties.uiHeight,
                        hitArea: t.buttonProperties.hitArea
                    }) || this)._buttonContainer.position.set(i._buttonContainer.position.x + t.eventButtonSettings.buttonPositionOffset.x, i._buttonContainer.position.y + t.eventButtonSettings.buttonPositionOffset.y),
                    i._drawerImage = r,
                    i._timer = De.services.timer.getTimerByID(t.eventData.timerID),
                    i._createVisuals(t),
                    i._extraContent = t.eventButtonSettings.extraContent,
                    i.addContent(t.eventButtonSettings.extraContent),
                    i._extraContent.position.copyFrom(t.eventButtonSettings.extraContentPosition),
                    i._timer.onUpdate.addListener(i._onUpdate, i),
                    i._timer.onTimerFinished.addListener(i._onTimerFinished, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function() {
                    this._timer.onTimerFinished.removeListener(this._onTimerFinished, this),
                    this._timer.onUpdate.removeListener(this._onUpdate, this)
                }
                ,
                t.prototype._createVisuals = function(e) {
                    var t = new cr(De.services.resource.getTexture(f.BG_POPUP_EVENT_TIMER),37,28,37,28);
                    t.setSizes(e.eventData.timerBackgroundSize ? e.eventData.timerBackgroundSize : {
                        width: 198,
                        height: 66
                    }),
                    t.anchor.set(.5, 0),
                    t.position.set(this._drawerImage.width / 2 - t.width / 2 - 20, this.height / 2 - 10),
                    e.eventData.timerBackgroundOffset && t.position.set(t.position.x + e.eventData.timerBackgroundOffset.x, t.position.y + e.eventData.timerBackgroundOffset.y),
                    this.addContent(t);
                    var i = rr(De.services.resource.getSprite(f.ICON_EVENT_TIMER), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: e.eventData.timervisualOffset ? e.eventData.timervisualOffset : {
                            x: 33,
                            y: 32
                        },
                        scale: {
                            x: .7,
                            y: .7
                        }
                    });
                    t.addChild(i);
                    var n = new v.LabelSettings({
                        fitHeight: 60,
                        fitWidth: 125,
                        fitToBox: !0
                    });
                    n.style = vn.lightSmall,
                    this._text = t.addChild(new v.Label("",n)),
                    this._text.position.set(t.width / 2 + i.width / 2, i.position.y),
                    this._text.anchor.set(.5, .5)
                }
                ,
                t.prototype._onUpdate = function() {
                    this._text.text = Pn({
                        remainingTime: this._timer.remainingTime
                    })
                }
                ,
                t.prototype._onTimerFinished = function() {
                    this.destroy()
                }
                ,
                t
            }(hr), mA = {
                headerText: ce.CD_POPOUT_BUTTON_COMPLETE,
                headerBackground: f.POPUP_EVENTHEADER_EXTRAWORKER,
                headerStyle: vn.eventPopupTitleBlue,
                showCloseButton: !0,
                tapToCloseAlternative: !0,
                tapToCloseText: ce.TAP_TO_CONTINUE,
                tapToCloseAnimated: !0,
                content: new Xe.Container
            }, yA = function() {
                function e(e, t, i, n) {
                    this._showCloseButton = !0,
                    this._logger = r.Logger.Of(this.constructor.name),
                    this._model = e,
                    this._services = t,
                    this._hudService = n,
                    this._eventConfiguration = (0,
                    r.isUndefined)(i) ? this.getDefaultEventConfiguration() : i
                }
                return Object.defineProperty(e.prototype, "eventConfiguration", {
                    get: function() {
                        return this._eventConfiguration
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.destroy = function() {}
                ,
                e.prototype.setSavedData = function(e) {
                    this._eventSavedData = e,
                    this._data = e.eventData
                }
                ,
                e.prototype.getRemainingEventTime = function() {
                    return De.services.timer.getTimerByID(this._eventSavedData.timerId).remainingTime
                }
                ,
                e.prototype.startEvent = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return t || e ? [4, this._decoratePopupContent(e ? this._getEventStartPopupContent.bind(this, this._eventSavedData.timerId) : this._getEventProgressPopupContent.bind(this, this._eventSavedData.timerId))] : [3, 2];
                            case 1:
                                i.sent(),
                                i.label = 2;
                            case 2:
                                return (0,
                                r.isUndefined)(this._popup) ? [3, 4] : (e ? De.services.analytics.design.reportTimedEventPopupInitiated(this.eventType) : De.services.analytics.design.reportTimedEventPopupAutomaticallyOpened(this.eventType),
                                [4, this._awaitOnPopupClosed()]);
                            case 3:
                                i.sent(),
                                i.label = 4;
                            case 4:
                                return this._createEventButton(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.enableCloseButton = function() {
                    var e;
                    null === (e = this._popup) || void 0 === e || e.enableCloseButton()
                }
                ,
                e.prototype.disableCloseButton = function() {
                    var e;
                    null === (e = this._popup) || void 0 === e || e.disableCloseButton()
                }
                ,
                e.prototype.endEvent = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._closePopup(!0)];
                            case 1:
                                return e.sent(),
                                this._removeEventButton(),
                                [4, this._decoratePopupContent(this._getEventEndedPopupContent.bind(this))];
                            case 2:
                                return e.sent(),
                                [4, this._awaitOnPopupClosed()];
                            case 3:
                                return e.sent(),
                                this._model.deleteEventSavedData(this.eventType),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._openPopup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return t = this,
                                [4, De.services.navigation.showPopup(Dv, (0,
                                n.__assign)((0,
                                n.__assign)({}, this._popupProperties), {
                                    onClose: this._onCloseButtonPressed,
                                    showCloseButton: this._showCloseButton,
                                    content: e
                                }), !0)];
                            case 1:
                                return t._popup = i.sent(),
                                this._popup.onClosed.listenOnce(this._onPopupClosed, this),
                                [4, this._awaitOnPopupOpened()];
                            case 2:
                                return i.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._setEventInactive = function() {
                    this._eventActive = !1,
                    this._removeEventButton()
                }
                ,
                e.prototype._onEventButtonClicked = function() {
                    this._openPopup(this._getEventProgressPopupContent(this._eventSavedData.timerId)),
                    De.services.analytics.design.reportTimedEventPopupManuallyOpened(this.eventType)
                }
                ,
                e.prototype._saveData = function() {
                    this._model.setEventSavedData(this.eventType, this._eventSavedData)
                }
                ,
                e.prototype._createEventButton = function() {
                    var e;
                    if (this._eventActive) {
                        var t = this._getEventButtonProperties();
                        (0,
                        r.isNull)(t) || (this._button = new EA(t),
                        this._button.onClick(this._onEventButtonClicked.bind(this)),
                        null === (e = this._hudService.hudContainer.getDrawerElement(i_.LeftDrawer)) || void 0 === e || e.addElement(this._button))
                    }
                }
                ,
                e.prototype._removeEventButton = function() {
                    var e;
                    this._button && (null === (e = this._hudService.hudContainer.getDrawerElement(i_.LeftDrawer)) || void 0 === e || e.removeElement(this._button),
                    this._button = void 0)
                }
                ,
                e.prototype._awaitOnPopupOpened = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return (0,
                            r.isUndefined)(this._popup) ? [2] : [2, new Promise((function(t) {
                                e._popup.onOpened.listenOnce((function() {
                                    t()
                                }
                                ), e)
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._awaitOnPopupClosed = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return (0,
                            r.isUndefined)(this._popup) ? [2] : [2, new Promise((function(t) {
                                e._popup.onClosed.listenOnce((function() {
                                    t()
                                }
                                ), e)
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._closePopup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return (0,
                                r.isUndefined)(this._popup) ? [2] : (this._popup.close(),
                                e ? [4, this._awaitOnPopupClosed()] : [3, 2]);
                            case 1:
                                t.sent(),
                                t.label = 2;
                            case 2:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._onPopupClosed = function() {
                    this._popup = void 0
                }
                ,
                e.prototype._decoratePopupContent = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._eventActive ? [2, this._openPopup(e())] : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), TA = {
                headerText: ce.EVENT_CHOPCHOP_HEADER,
                headerBackground: f.POPUP_EVENTHEADER_EXTRAWORKER,
                headerStyle: vn.eventPopupTitleBlue,
                showCloseButton: !0,
                tapToCloseAlternative: !1,
                tapToCloseText: ce.TAP_TO_CONTINUE,
                tapToCloseAnimated: !0,
                content: new Xe.Container
            }, AA = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t, i, n, i.hudService) || this;
                    return r.eventType = Xi.BONUS_WORKER,
                    r._popupProperties = TA,
                    r._eventActive = !0,
                    r._popupLabelSettings = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: r._getPopupImage().width - 100,
                        fitHeight: 300
                    }),
                    r._popupLabelSettings.style = vn.darkBrownMedium,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createDefaultEventSavedData = function() {
                    var e = this._services.gameWorkers.addNewWorker(void 0, "ChopChopEventWorker").id;
                    return Promise.resolve({
                        extraWorkerID: e
                    })
                }
                ,
                t.prototype.startEvent = function(t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, e.prototype.startEvent.call(this, t, i)];
                            case 1:
                                return n.sent(),
                                null == (r = this._services.gameWorkers.getWorkerByID(this._data.extraWorkerID)) || r.onStateChanged.listenOnce((function() {
                                    De.services.analytics.design.reportFreeExtraWorkerUsed()
                                }
                                ), this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.endEvent = function() {
                    var t, i;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return o = this._services.gameWorkers.getWorkerByID(null !== (i = null === (t = this._data) || void 0 === t ? void 0 : t.extraWorkerID) && void 0 !== i ? i : -1),
                                (0,
                                r.isUndefined)(o) || this._services.gameWorkers.removeWorkerFromModel(o),
                                [4, e.prototype.endEvent.call(this)];
                            case 1:
                                return n.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getDefaultEventConfiguration = function() {
                    return {}
                }
                ,
                t.prototype._onCloseButtonPressed = function() {}
                ,
                t.prototype._getEventStartPopupContent = function(e) {
                    var t = this
                      , i = this._getEventProgressPopupContent(e)
                      , r = i.height + 30
                      , o = new fr({
                        name: "extraWorkerLET'sGO",
                        buttonIdle: f.BTN_EVENT_GREEN_IDLE,
                        buttonActive: f.BTN_EVENT_GREEN_DOWN
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, wv),
                        buttonSizes: {
                            width: 480,
                            height: 142
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: ce.EVENT_CHOPCHOP_ACTIVE_BUTTON,
                        position: {
                            x: 0,
                            y: -7
                        }
                    });
                    return r += o.height / 2,
                    o.position.set(0, r),
                    o.on("pointerdown", (function() {
                        var e;
                        return null === (e = t._popup) || void 0 === e ? void 0 : e.close()
                    }
                    )),
                    i.addChild(o),
                    i
                }
                ,
                t.prototype._getEventProgressPopupContent = function(e) {
                    var t = new Xe.Container
                      , i = 10
                      , r = pg(e);
                    return r.position.set(0, i + r.height / 2),
                    t.addChild(r),
                    i += r.height + 15,
                    t.addChild(rr(this._getPopupImage(), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: i
                        }
                    })),
                    i += this._getPopupImage().height + 30,
                    t.addChild(rr(new v.Label(nr(mT || (mT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHOPCHOP_ACTIVE_BODY),this._popupLabelSettings), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: i
                        }
                    })),
                    t
                }
                ,
                t.prototype._getEventEndedPopupContent = function() {
                    var e = new Xe.Container
                      , t = 50;
                    e.addChild(rr(new v.Label(nr(yT || (yT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHOPCHOP_ENDED_HEADER),this._popupLabelSettings), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 50
                        }
                    })),
                    t += 70,
                    e.addChild(rr(this._getPopupImage(), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: t
                        }
                    })),
                    t += this._getPopupImage().height + 30;
                    var i = new Xe.Container;
                    i.addChild(rr(new v.Label(nr(TT || (TT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHOPCHOP_ENDED_BODY),this._popupLabelSettings), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 0
                        }
                    })),
                    i.position.set(0, t + i.height / 2),
                    e.addChild(i),
                    t += i.height;
                    var r = (new Xe.Graphics).beginFill(16777215).drawShape(new Xe.Rectangle(0,0,30,30)).endFill();
                    return r.alpha = 0,
                    r.position.set(0, t),
                    e.addChild(r),
                    e
                }
                ,
                t.prototype._getEventButtonProperties = function() {
                    return {
                        buttonProperties: {
                            name: "ChopChopEventButton",
                            buttonIdle: f.BTN_HUD_EVENT_EXTRAWORKER_IDLE,
                            buttonActive: f.BTN_HUD_EVENT_EXTRAWORKER_DOWN,
                            uiHeight: 300
                        },
                        eventData: {
                            timerID: this._eventSavedData.timerId
                        },
                        eventButtonSettings: {
                            drawerWidth: 265,
                            drawerImagePosition: new Xe.Point(-25,43),
                            buttonPositionOffset: new Xe.Point(20,0),
                            extraContent: new Xe.Container,
                            extraContentPosition: new Xe.Point(0,0)
                        }
                    }
                }
                ,
                t.prototype._getPopupImage = function() {
                    return this._model.isEventActive(Xi.GOLDEN_PUMPKIN) ? De.services.resource.getSprite(f.ICON_EVENTIMAGE_EXTRAWORKER_HALLOWEEN) : this._model.isEventActive(Xi.GOLDEN_CHRISTMAS) ? De.services.resource.getSprite(f.ICON_EVENTIMAGE_EXTRAWORKER_CHRISTMAS) : De.services.resource.getSprite(f.ICON_EVENTIMAGE_EXTRAWORKER_START)
                }
                ,
                t
            }(yA), CA = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "BaseGoldenItemEventInfoPopup",
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createPopup = function() {
                    this._createBackground(),
                    this._createInfo(),
                    this._createTapToContinue()
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    this._backGround.onCloseClick(this.close.bind(this)),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerdown", this._tryToClose, this)
                }
                ,
                t.prototype._createBackground = function() {
                    this._backGround = new Ar({
                        size: {
                            width: this._customWidth ? this._customWidth : 1080,
                            height: this._customHeight ? this._customHeight : 1200
                        },
                        headerSize: {
                            width: 720,
                            height: 75
                        },
                        headerText: this._popupTitle,
                        customHeaderTextPosition: new Xe.Point(0,-539),
                        headerStyle: vn.popupTitle,
                        customNineslice: f.POPUP_BG_CONCENT_9SLICE,
                        customNinesliceOptions: {
                            leftWidth: 200,
                            topHeight: 200,
                            rightWidth: 200,
                            bottomHeight: 200
                        },
                        showCloseButton: !1
                    }),
                    this._content.addChild(this._backGround)
                }
                ,
                t.prototype._createInfo = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 160,
                        fitWidth: 830.7692307692307,
                        style: vn.darkMedium
                    })
                      , t = void 0;
                    (0,
                    r.isUndefined)(this._popupHelpHeader) || (t = rr(new v.Label(this._popupHelpHeader,e), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -this._backGround.height / 2 + 200
                        }
                    }),
                    this._content.addChild(t));
                    var i = rr(De.services.resource.getSprite(this._explanationIcon), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: t ? t.y + t.height / 2 + 50 : -this._backGround.height / 2 + 175
                        }
                    })
                      , n = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 150,
                        fitWidth: 270,
                        style: vn.darkMedium
                    })
                      , o = i.position.y + i.height
                      , a = this._backGround.width / 3 - 25
                      , s = rr(new v.Label(this._step1Text,n), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: -a,
                            y: o
                        }
                    })
                      , _ = rr(new v.Label(this._step2Text,n), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: o
                        }
                    })
                      , c = rr(new v.Label(this._step3Text,n), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: a,
                            y: o
                        }
                    });
                    this._content.addChild(i, s, _, c),
                    this._inputBlocker.interactive = !0,
                    this._inputBlocker.on("pointerup", this._tryToClose, this)
                }
                ,
                t.prototype._createTapToContinue = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, r.TimeDelay.after(1e3).promise];
                            case 1:
                                return t.sent(),
                                (e = new fl).position.set(0, 640),
                                this._content.addChild(e),
                                this._content.interactive = !0,
                                this._content.on("pointerup", this.close, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr), IA = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._name = "GoldenCarrotEventInfoPopup",
                    i._customWidth = void 0,
                    i._customHeight = void 0,
                    i._popupTitle = ce.SHOVEL_POPUP_HEADER,
                    i._popupHelpHeader = nr(AT || (AT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GOLDENCARROT_HELP_HEADER),
                    i._explanationIcon = f.ICON_POPUP_GOLDENCARROT_EXPLANATION,
                    i._step1Text = nr(CT || (CT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GOLDENCARROT_HELP_STEP_1),
                    i._step2Text = nr(IT || (IT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GOLDENCARROT_HELP_STEP_2),
                    i._step3Text = nr(ST || (ST = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.GOLDENCARROT_HELP_STEP_3),
                    i._exitButtonText = nr(OT || (OT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAP_TO_CONTINUE),
                    i.createPopup(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(CA), SA = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return e.trys.push([0, 2, , 3]),
                                De.services.inventory.addAmount(this.dependencies.itemData.key, this.dependencies.itemData.amount, !1),
                                this._spawnRewardFloater(),
                                [4, this._spawnRewardAnimation()];
                            case 1:
                                return e.sent(),
                                [2, {
                                    result: $_.SUCCESS,
                                    reason: "SUCCESS"
                                }];
                            case 2:
                                return e.sent(),
                                [2, {
                                    result: $_.FAIL,
                                    reason: "INSUFFICIENT_ITEMS"
                                }];
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.finalize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._spawnRewardAnimation = function() {
                    var e = this;
                    return new Promise((function(t) {
                        var i = De.services.navigation.layers.popup.container
                          , o = e.dependencies.parent.toGlobal(new Xe.Point(0,0))
                          , a = De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter(e.dependencies.itemData)
                          , s = a.target
                          , _ = a.icon
                          , c = s.toGlobal(new Xe.Point(0,0))
                          , l = new Lr(De.services.resource.getSprite(_),i.toLocal(o),i.toLocal(c),e.dependencies.itemData.amount,i);
                        l.onAnimationComplete.addListener((function() {
                            return (0,
                            n.__awaiter)(e, void 0, void 0, (function() {
                                return (0,
                                n.__generator)(this, (function(e) {
                                    switch (e.label) {
                                    case 0:
                                        return De.services.inventory.getInventoryItem(this.dependencies.itemData.key).updateVisuals(),
                                        [4, r.TimeDelay.after(550).promise];
                                    case 1:
                                        return e.sent(),
                                        t(),
                                        [2]
                                    }
                                }
                                ))
                            }
                            ))
                        }
                        ), null),
                        l.animate()
                    }
                    ))
                }
                ,
                t.prototype._spawnRewardFloater = function() {
                    var e = this.dependencies.parent.toGlobal(new Xe.Point(0,0))
                      , t = De.services.navigation.layers.popup.container
                      , i = t.toLocal(e);
                    new of(t,i,{
                        amount: this.dependencies.itemData.amount,
                        icon: De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter(this.dependencies.itemData).icon,
                        styles: vn.mergeBonusText
                    })
                }
                ,
                t
            }(rc), OA = i(2213), bA = 30, RA = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t, i, n, i.hudService) || this;
                    return r._hoursChestStaysActiveAfterEventEnds = 48,
                    r._goldenItemFamilyFilter = [Ke.GoldenItem, Ke.GridPosition],
                    r._lootableFamilyFilter = [Ke.Lootable, Ke.GridPosition],
                    r._goldenItemInteractionFamilyFilter = [Ke.GoldenItem, Ke.GridPosition, Ke.InteractionTap],
                    r._eventActive = !0,
                    r._popupButtonSettings = {
                        xOffset: 0,
                        width: 480
                    },
                    r._textAnimationTimeline = lr.gsap.timeline(),
                    r._textAnimation = null,
                    r._currentState = {
                        number: 0
                    },
                    r._rewardImages = [],
                    r._eventChestEndTime = 60 * r._hoursChestStaysActiveAfterEventEnds * 60 * 1e3,
                    r._popupActiveBodyText = "Collect X amount of [item] to open a special reward chest with amazing rewards!",
                    r._popupProgressBodyText = "Collect X amount of [item] to open a special reward chest with amazing rewards!",
                    r._buttonClaim = ce.EVENT_GOLDENCARROT_BUTTON_CLAIMREWARD,
                    r._popupEndedCompleteBodyText = "Well done you managed to collect all the rewards. Keep an eye out for next event!",
                    r._popupEndedIncompleteBodyText = "unfortunatly you've missed out on rewards... Keep an eye out for next event!",
                    r._buttonClose = ce.CLOSE,
                    r._hudButtonIdle = f.BTN_HUD_DEFAULT_IDLE,
                    r._hudButtonActive = f.BTN_HUD_DEFAULT_DOWN,
                    r._pillIcon = f.ICON_BTN_GOLDENCARROT,
                    r._hudButtonCustomHitArea = new OA.Rectangle(-100,-80,235,270),
                    r._buttonGotIt = ce.EVENT_GOLDENCARROT_BUTTON_GOTIT,
                    r._popupImage = f.ICON_EVENTIMAGE_GOLDENCARROT,
                    r._progressBarBackgroundAsset = f.UI_PROGRESSBAR_EVENTS_BACKGROUND,
                    r._progressBarFillAsset = f.UI_PROGRESSBAR_EVENTS_FILL,
                    r._progressBarRewardBalloon = f.UI_PROGRESSBAR_EVENTS_GOAL,
                    r._progressBarRewardBalloonInactive = f.UI_PROGRESSBAR_EVENTS_GOAL_SEPIA,
                    r._progressBarSmallRewardBalloon = f.UI_PROGRESSBAR_EVENTS_SMALLGIFT_CHRISTMAS,
                    r._progressBarSmallRewardIcon = f.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS,
                    r._progressBarCounterBalloon = f.UI_PROGRESSBAR_EVENTS_COUNTER,
                    r._fadeFillMeterIcons = !1,
                    r._showFillMeterCounter = !0,
                    r._progressBarStartImage = f.OBJ_ANIMAL_CHICKEN_00,
                    r._goalItems = [{
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_golden_carrot"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_GOLDENCARROT_LOOTCHEST,
                            inactive: f.ICON_PROGRESSBAR_GOLDENCARROT_LOOTCHEST
                        },
                        unlockedAtAmount: 15,
                        iconScale: .8,
                        balloonScale: 1.2,
                        claimed: !1
                    }, {
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_key_golden_carrot"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_GOLDENCARROT_KEY,
                            inactive: f.ICON_PROGRESSBAR_GOLDENCARROT_KEY
                        },
                        unlockedAtAmount: 30,
                        claimed: !1
                    }],
                    r._popupLabelSettings = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 980,
                        fitHeight: 300,
                        style: vn.darkBrownMedium
                    }),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createDefaultEventSavedData = function() {
                    return Promise.resolve({
                        itemAmount: 0,
                        claimedAtAmount: []
                    })
                }
                ,
                t.prototype.startEvent = function(t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._setGoalItems(),
                                this._eventSavedData.eventData.itemAmount < this.eventConfiguration.maxAmount && (this.eventConfiguration.itemConfiguration.contextData.forEach((function(e) {
                                    r._services.randomLoot.addTemporaryLootContextItems(e.lootContext, [e.weightedItem])
                                }
                                )),
                                this._goldenItemFamily = new __(this._services.world,new c_(this._goldenItemFamilyFilter)),
                                this._lootableFamily = new __(this._services.world,new c_(this._lootableFamilyFilter)),
                                this._goldenItemInteractionFamily = new __(this._services.world,new c_(this._goldenItemInteractionFamilyFilter)),
                                this._goldenItemInteractionFamily.onGameObjectAdded.addListener(this._onGoldenItemInteractionAdded, this)),
                                [4, e.prototype.startEvent.call(this, t, i)];
                            case 1:
                                return n.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.endEvent = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._setGoalItems(),
                                this._showCloseButton = !1,
                                this._eventConfiguration.itemConfiguration.contextData.forEach((function(e) {
                                    t._services.randomLoot.removeTemporaryLootContextItems(e.lootContext, [e.weightedItem])
                                }
                                )),
                                this._removeGoldenItems(),
                                [4, e.prototype.endEvent.call(this)];
                            case 1:
                                return i.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getDefaultEventConfiguration = function() {
                    return {
                        maxAmount: 30,
                        itemConfiguration: {
                            itemID: "golden_carrot",
                            contextData: [{
                                lootContext: FE.CRATE,
                                weightedItem: {
                                    weight: 800,
                                    key: "golden_carrot"
                                }
                            }, {
                                lootContext: FE.CROP,
                                weightedItem: {
                                    weight: 800,
                                    key: "golden_carrot"
                                }
                            }]
                        }
                    }
                }
                ,
                t.prototype._getEventStartPopupContent = function(e) {
                    var t = this
                      , i = new Xe.Container
                      , n = i.addChild(this._createEventTimerElement(e, 10));
                    i.addChild(this._createPopupInfoButton({
                        x: 5 + n.position.x + n.width / 2,
                        y: n.position.y
                    }));
                    var r = i.addChild(this._createTextBlock(this._popupActiveBodyText, n.position.y + n.height / 2))
                      , o = i.addChild(this._createSharedContent(r.position.y + r.height + bA))
                      , a = this._createPopupButton(this._buttonGotIt, o.position.y + o.height + bA);
                    return a.on("pointerdown", (function() {
                        var e;
                        return null === (e = t._popup) || void 0 === e ? void 0 : e.close()
                    }
                    )),
                    i.addChild(a),
                    i
                }
                ,
                t.prototype._getEventProgressPopupContent = function(e) {
                    var t = new Xe.Container
                      , i = t.addChild(this._createEventTimerElement(e, 10));
                    t.addChild(this._createPopupInfoButton({
                        x: 5 + i.position.x + i.width / 2,
                        y: i.position.y
                    }));
                    var n = t.addChild(this._createTextBlock(this._popupProgressBodyText, i.position.y + i.height / 2))
                      , r = t.addChild(this._createSharedContent(n.position.y + n.height + bA))
                      , o = this._isAnyRewardClaimable(this._data.itemAmount) ? this._buttonClaim : this._buttonGotIt
                      , a = this._createPopupButton(o, r.position.y + r.height + bA);
                    return a.on("pointerdown", this._onButtonPressed.bind(this)),
                    t.addChild(a),
                    t
                }
                ,
                t.prototype._getEventEndedPopupContent = function() {
                    var e = this;
                    this._fadeFillMeterIcons = !0;
                    var t = this._getMaxAmount() <= this._getCollectedAmount()
                      , i = new Xe.Container
                      , n = i.addChild(this._createEventTimerElement(null, 10))
                      , r = t ? this._popupEndedCompleteBodyText : this._popupEndedIncompleteBodyText
                      , o = i.addChild(this._createTextBlock(r, n.position.y + n.height / 2))
                      , a = i.addChild(this._createSharedContent(o.position.y + o.height + bA))
                      , s = this._createPopupButton(this._buttonClose, a.position.y + a.height + bA);
                    return s.on("pointerdown", (function() {
                        return e._onButtonPressed()
                    }
                    )),
                    i.addChild(s),
                    i
                }
                ,
                t.prototype._getEventButtonProperties = function() {
                    return {
                        buttonProperties: {
                            name: "GoldenItemEventButton",
                            buttonIdle: this._hudButtonIdle,
                            buttonActive: this._hudButtonActive,
                            uiHeight: 300,
                            hitArea: this._hudButtonCustomHitArea
                        },
                        eventData: {
                            timerID: this._eventSavedData.timerId,
                            timervisualOffset: new Xe.Point(33,100),
                            timerBackgroundSize: {
                                width: 198,
                                height: 132
                            },
                            timerBackgroundOffset: new Xe.Point(0,-35)
                        },
                        eventButtonSettings: {
                            drawerWidth: 265,
                            drawerImagePosition: new Xe.Point(-25,15),
                            buttonPositionOffset: new Xe.Point(20,0),
                            extraContent: this._createButtonVisuals(),
                            extraContentPosition: new Xe.Point(15,90)
                        }
                    }
                }
                ,
                t.prototype._getCollectedAmount = function() {
                    return this._data.itemAmount
                }
                ,
                t.prototype._getMaxAmount = function() {
                    return this._eventConfiguration.maxAmount
                }
                ,
                t.prototype._showInfo = function() {
                    De.services.lazyLoad.prioritizeGroup(hn.EVENTS_GOLDENCARROT).then((function() {
                        return De.services.navigation.showPopup(IA, {})
                    }
                    ))
                }
                ,
                t.prototype._createPopupButton = function(e, t) {
                    var i = new fr({
                        name: "GoldenItemEventButton",
                        buttonIdle: f.BTN_EVENT_GREEN_IDLE,
                        buttonActive: f.BTN_EVENT_GREEN_DOWN
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, wv),
                        buttonSizes: {
                            width: this._popupButtonSettings.width,
                            height: 142
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: e,
                        position: {
                            x: 0,
                            y: -7
                        }
                    });
                    return i.position.set(this._popupButtonSettings.xOffset, t + i.height / 2),
                    i
                }
                ,
                t.prototype._createButtonVisuals = function() {
                    this._buttonVisuals = new Xe.Container;
                    var e = new cr(De.services.resource.getTexture(f.BTN_EVENT_WHITEPILL_9SLICE),32,0,30,0);
                    e.setSizes({
                        width: 178,
                        height: 66
                    }),
                    e.position.set(0, 0),
                    e.anchor.set(.5),
                    this._buttonVisuals.addChild(e);
                    var t = this._data.itemAmount.toString();
                    return this._buttonCounter = new Xe.Text(String(t),vn.darkSmall),
                    this._buttonCounter.anchor.set(.5),
                    this._buttonCounter.position.set(e.position.x + e.width / 2, e.height / 2),
                    e.addChild(this._buttonCounter),
                    this._buttonNotificationIcon = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    this._buttonNotificationIcon.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK_ORDERSBUTTON, !0),
                    this._buttonNotificationIcon.position.set(85, -105),
                    this._buttonNotificationIcon.visible = this._isAnyRewardClaimable(this._data.itemAmount),
                    this._buttonVisuals.addChild(this._buttonNotificationIcon),
                    this._buttonVisuals
                }
                ,
                t.prototype._removeGoldenItems = function() {
                    var e, t, i, n, r, o = this;
                    null === (e = this._goldenItemFamily) || void 0 === e || e.getGameObjects().forEach((function(e) {
                        e.addBehavior(new ti({}))
                    }
                    )),
                    null === (t = this._goldenItemInteractionFamily) || void 0 === t || t.onGameObjectAdded.removeListener(this._onGoldenItemInteractionAdded, this),
                    null === (i = this._goldenItemInteractionFamily) || void 0 === i || i.destroy(),
                    null === (n = this._goldenItemFamily) || void 0 === n || n.destroy(),
                    null === (r = this._lootableFamily) || void 0 === r || r.getGameObjects().forEach((function(e) {
                        var t = e.getBehavior(Ke.Lootable);
                        o._itemToCollect.forEach((function(i) {
                            if (-1 !== t.loot.indexOf(i)) {
                                var n = t.loot.filter((function(e) {
                                    return e !== i
                                }
                                ));
                                e.replaceBehavior(new jt({
                                    loot: n
                                })),
                                0 === n.length && e.addBehavior(new ji({}))
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._setGoalItems = function() {
                    var e = this._eventSavedData.eventData;
                    this._goalItems.forEach((function(t) {
                        -1 !== e.claimedAtAmount.indexOf(t.unlockedAtAmount) && (t.claimed = !0)
                    }
                    ))
                }
                ,
                t.prototype._getPopupImageAsset = function() {
                    return this._popupImage
                }
                ,
                t.prototype._onButtonPressed = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._isAnyRewardClaimable(this._data.itemAmount) && this._popup ? (this._popup.popupLocked = !0,
                                this.disableCloseButton(),
                                [4, this._claimRewardsButtonBehavior()]) : [3, 2];
                            case 1:
                                t.sent(),
                                this._popup.popupLocked = !1,
                                t.label = 2;
                            case 2:
                                return null === (e = this._popup) || void 0 === e || e.close(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onGoldenItemInteractionAdded = function(e) {
                    if (this._itemToCollect.includes(e.getBlueprintID())) {
                        this._updateSavedData();
                        var t = e.getChildByName(Gv, !0)
                          , i = this._services.hudService.hudContainer
                          , n = this._services.cameraService
                          , r = zm(e, t, 1, this._buttonVisuals, i, n, void 0, this._onAnimationComplete.bind(this))
                          , o = new Hm(e);
                        o.addToQueue(r),
                        o.play(),
                        e.addBehavior(new ti({})),
                        this._isAnyRewardClaimable(this._data.itemAmount) && this._addNotificationIconToHud()
                    }
                }
                ,
                t.prototype._addNotificationIconToHud = function() {
                    this._buttonNotificationIcon && (this._buttonNotificationIcon.visible = !0)
                }
                ,
                t.prototype._removeNotificationIconFromHud = function() {
                    this._buttonNotificationIcon && (this._buttonNotificationIcon.visible = !1)
                }
                ,
                t.prototype._onAnimationComplete = function() {
                    vg(this._data.itemAmount, this._currentState.number, this._textAnimationTimeline, this._textAnimation, this._currentState, this._buttonCounter, 1, this._buttonIcon),
                    gg(this._buttonVisuals),
                    this._data.itemAmount >= this._eventConfiguration.maxAmount && this._onMaxAmountReached()
                }
                ,
                t.prototype._updateSavedData = function() {
                    this._data.itemAmount += 1,
                    this._saveData(),
                    this._data.itemAmount >= this._eventConfiguration.maxAmount && this._onMaxAmountReached()
                }
                ,
                t.prototype._onMaxAmountReached = function() {
                    var e = this;
                    this._eventConfiguration.itemConfiguration.contextData.forEach((function(t) {
                        e._services.randomLoot.removeTemporaryLootContextItems(t.lootContext, [t.weightedItem])
                    }
                    )),
                    this._removeGoldenItems()
                }
                ,
                t.prototype._createSharedContent = function(e) {
                    var t = new Xe.Container
                      , i = this._createPopupImage(0);
                    t.addChild(i);
                    var n = this._goalItems.filter((function(e) {
                        if (!e.claimed)
                            return e
                    }
                    ))
                      , o = function(e) {
                        e.fadeIcons;
                        var t = e.collectedAmount
                          , i = e.maxAmount
                          , n = e.size
                          , o = e.startIcon
                          , a = e.goalIcons
                          , s = e.showCounter
                          , _ = void 0 === s || s
                          , c = e.yPosition
                          , l = void 0 === c ? 0 : c
                          , u = e.progressBarBackgroundAsset
                          , d = void 0 === u ? f.UI_PROGRESSBAR_EVENTS_BACKGROUND : u
                          , h = e.progressBarFillAsset
                          , p = void 0 === h ? f.UI_PROGRESSBAR_EVENTS_FILL : h
                          , g = e.progressBarRewardBalloon
                          , E = void 0 === g ? f.UI_PROGRESSBAR_EVENTS_GOAL : g
                          , m = e.progressBarRewardBalloonTailSize
                          , y = void 0 === m ? 40 : m
                          , T = e.progressBarCounterBalloon
                          , A = void 0 === T ? f.UI_PROGRESSBAR_EVENTS_COUNTER : T
                          , C = (void 0 === e.progressBarSmallRewardBalloon && f.UI_PROGRESSBAR_EVENTS_SMALLGIFT_CHRISTMAS,
                        e.progressBarRewardBalloonInactive)
                          , I = void 0 === C ? f.UI_PROGRESSBAR_EVENTS_GOAL_SEPIA : C
                          , S = (void 0 === e.progressBarSmallRewardIcon && f.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS,
                        [])
                          , O = 0
                          , b = new cr(De.services.resource.getTexture(d),54,51,54,61);
                        b.setSizes(n),
                        b.anchor.set(.5);
                        var R = b.addChild(new Xe.Container)
                          , w = b.width - 38
                          , D = new v.LabelSettings({
                            fitToBox: !0,
                            fitWidth: 150,
                            fitHeight: 110
                        });
                        D.style = vn.turquoiseSmall,
                        R.addChild(rr(new v.Label(i.toString(),D), {
                            anchor: {
                                x: 1,
                                y: .5
                            },
                            position: {
                                x: w,
                                y: b.height / 2 - 7.5
                            }
                        }));
                        var N = new cr(De.services.resource.getTexture(p),35,33,35,33);
                        N.anchor.set(0, .5),
                        N.position.set(19, N.height - 17),
                        N.setSizes({
                            width: w,
                            height: N.height
                        }),
                        R.addChild(N);
                        var L = w * (t / i)
                          , B = N.addChild((new Xe.Graphics).beginFill(16777215).drawRect(0, 0, L, N.height).endFill());
                        if (N.mask = B,
                        o) {
                            var P = De.services.resource.getSprite(o);
                            rr(P, {
                                anchor: {
                                    x: .5,
                                    y: .5
                                },
                                position: {
                                    x: 19,
                                    y: P.height / 2 - 15
                                }
                            }),
                            R.addChild(P)
                        }
                        if (a) {
                            var k = 0
                              , x = !0
                              , G = !0;
                            a.forEach((function(e) {
                                var n;
                                is(e.reward) ? (n = function(e, t, i, n, o, a, s, _, c, l, u) {
                                    var d = new Xe.Container;
                                    t.addChild(d),
                                    d.position.set(Math.min(o, o * (e.unlockedAtAmount / a)) + 17, 30);
                                    var h = !e.claimed && u >= e.unlockedAtAmount || !l
                                      , p = rr(De.services.resource.getSprite(h ? s : _));
                                    p.anchor.set(.5, 1),
                                    p.scale.set(e.balloonScale || 1),
                                    d.addChild(p);
                                    var g = e.balloonScale ? c * e.balloonScale : c
                                      , E = De.services.resource.getSprite(h || (0,
                                    r.isUndefined)(e.visuals.inactive) ? e.visuals.active : e.visuals.inactive);
                                    if (E.anchor.set(.5),
                                    E.position.set(p.x, p.y - p.height / 2 - g / 2),
                                    e.iconScale && E.scale.set(e.iconScale),
                                    d.addChild(E),
                                    !e.claimed && u >= e.unlockedAtAmount) {
                                        var m = De.services.resource.getSprite(f.ICON_NOTIFICATION_ATTENTION);
                                        m.anchor.set(.5),
                                        m.scale.set(.5),
                                        m.position.set(p.width / 3, -p.height),
                                        d.addChild(m)
                                    }
                                    var y = new v.LabelSettings({
                                        fitToBox: !0,
                                        fitWidth: 150,
                                        fitHeight: 110
                                    });
                                    if (d.position.x < o - p.width / 2) {
                                        y.style = vn.getBoldTextStyle(0, 31, "center", !1);
                                        var T = (new Xe.Graphics).beginFill(0).drawRect(0, 0, 4, 62.5).endFill();
                                        if (T.position.set(d.position.x, 25.5),
                                        t.addChild(T),
                                        e.unlockedAtAmount > u) {
                                            var A = "".concat(Math.min(e.unlockedAtAmount, a));
                                            y.style = vn.turquoiseSmall;
                                            var C = new v.Label(A,y);
                                            C.anchor.set(.5),
                                            C.position.set(d.position.x, i.height / 2 - 7.5),
                                            t.addChild(C)
                                        }
                                    }
                                    return n.push(E),
                                    d
                                }(e, R, b, S, w, i, E, I, y, !x, t),
                                x = t >= e.unlockedAtAmount) : (n = function(e, t, i, n, o, a, s, _) {
                                    var c = Math.min(o, o * (e.unlockedAtAmount / a)) + 17
                                      , l = !e.claimed && _ >= e.unlockedAtAmount || !s
                                      , u = (new Xe.Graphics).beginFill(0).drawRect(0, 0, 4, 190).endFill();
                                    u.position.set(c, 15),
                                    t.addChild(u);
                                    var d = new Xe.Container;
                                    d.position.set(c, 30),
                                    t.addChild(d);
                                    var h = De.services.resource.getSprite(l || (0,
                                    r.isUndefined)(e.visuals.inactive) ? e.visuals.active : e.visuals.inactive);
                                    if (h.anchor.set(.5, 1),
                                    h.position.set(-10, 255),
                                    d.addChild(h),
                                    !e.claimed && _ >= e.unlockedAtAmount) {
                                        var p = De.services.resource.getSprite(f.ICON_NOTIFICATION_ATTENTION);
                                        p.anchor.set(.5),
                                        p.scale.set(.5),
                                        p.position.set(h.position.x + 37.5, h.position.y - 60),
                                        d.addChild(p)
                                    }
                                    var g = new v.LabelSettings({
                                        fitToBox: !0,
                                        fitWidth: 150,
                                        fitHeight: 110
                                    });
                                    if (d.position.x < o - h.width / 2 && (g.style = vn.getBoldTextStyle(0, 31, "center", !1),
                                    e.unlockedAtAmount > _)) {
                                        var E = "".concat(Math.min(e.unlockedAtAmount, a));
                                        g.style = vn.turquoiseSmall;
                                        var m = new v.Label(E,g);
                                        m.anchor.set(.5),
                                        m.position.set(d.position.x, i.height / 2 - 7.5),
                                        t.addChild(m)
                                    }
                                    return n.push(h),
                                    d
                                }(e, R, b, S, w, i, !G, t),
                                G = t >= e.unlockedAtAmount),
                                k = Math.max(k, n.height / 2)
                            }
                            )),
                            O += k / 2
                        }
                        if (_) {
                            var U = R.addChild(rr(De.services.resource.getSprite(A), {
                                anchor: {
                                    x: .5,
                                    y: 0
                                },
                                position: {
                                    x: Math.min(w, L + 19),
                                    y: b.height
                                }
                            }));
                            D.style = vn.darkBrownSmall;
                            var F = Math.min(t, i).toString();
                            U.addChild(rr(new v.Label(F,D), {
                                anchor: {
                                    x: .5,
                                    y: .5
                                },
                                position: {
                                    x: 0,
                                    y: U.height / 2 + 10
                                }
                            })),
                            O -= U.height / 2
                        }
                        var M = new Xe.Container;
                        M.addChild(b),
                        M.y += O,
                        M.y += M.height / 2;
                        var V = new Xe.Container;
                        return l && (V.y = l),
                        V.addChild(M),
                        {
                            meter: V,
                            goalIcons: S
                        }
                    }({
                        yPosition: i.position.y + i.height + bA,
                        size: {
                            width: 880,
                            height: 114
                        },
                        maxAmount: this._getMaxAmount(),
                        collectedAmount: this._getCollectedAmount(),
                        goalIcons: n,
                        startIcon: this._progressBarStartImage,
                        showCounter: this._showFillMeterCounter,
                        fadeIcons: this._fadeFillMeterIcons,
                        progressBarBackgroundAsset: this._progressBarBackgroundAsset,
                        progressBarFillAsset: this._progressBarFillAsset,
                        progressBarRewardBalloon: this._progressBarRewardBalloon,
                        progressBarRewardBalloonInactive: this._progressBarRewardBalloonInactive,
                        progressBarCounterBalloon: this._progressBarCounterBalloon
                    });
                    return t.position.y = e,
                    t.addChild(o.meter),
                    this._rewardImages = o.goalIcons,
                    t
                }
                ,
                t.prototype._createPopupInfoButton = function(e) {
                    var t = this
                      , i = new hr({
                        name: "GoldenItemEventButton",
                        buttonIdle: f.ICON_HELP,
                        buttonActive: f.ICON_HELP
                    });
                    return i.position.set(e.x + i.width / 2, e.y),
                    i.on("pointerdown", (function() {
                        var e;
                        null === (e = t._popup) || void 0 === e || e.close(),
                        t._showInfo()
                    }
                    )),
                    i
                }
                ,
                t.prototype._createPopupImage = function(e) {
                    var t = this._getPopupImage();
                    return t.anchor.set(.5, 0),
                    t.position.set(0, e),
                    t
                }
                ,
                t.prototype._getPopupImage = function() {
                    return De.services.resource.getSprite(this._getPopupImageAsset())
                }
                ,
                t.prototype._createEventTimerElement = function(e, t) {
                    var i = pg(e);
                    return i.position.set(0, t + i.height / 2),
                    i
                }
                ,
                t.prototype._createTextBlock = function(e, t) {
                    return rr(new v.Label(e,this._popupLabelSettings), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: t
                        }
                    })
                }
                ,
                t.prototype._claimRewardsButtonBehavior = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, o, a, s, _, c, l, u = this;
                        return (0,
                        n.__generator)(this, (function(d) {
                            switch (d.label) {
                            case 0:
                                e = [],
                                t = this._goalItems.filter((function(e) {
                                    if (!e.claimed)
                                        return e
                                }
                                )),
                                i = function(i) {
                                    var a, s;
                                    return (0,
                                    n.__generator)(this, (function(_) {
                                        switch (_.label) {
                                        case 0:
                                            return i.unlockedAtAmount <= o._getCollectedAmount() && !i.claimed ? (a = t.indexOf(i),
                                            o._data.claimedAtAmount.push(i.unlockedAtAmount),
                                            o._saveData(),
                                            i.claimed = !0,
                                            is(i.reward) ? (o._currentBubble || (o._currentBubble = o._services.storageBubble.createBubble()),
                                            s = i.reward.data[0],
                                            e.push((function() {
                                                return (0,
                                                n.__awaiter)(u, void 0, void 0, (function() {
                                                    return (0,
                                                    n.__generator)(this, (function(e) {
                                                        return [2, this._services.rewardService.giveObjectRewardWithAnimation({
                                                            rewardBlueprintID: s,
                                                            blueprintComponents: this._prepareObjectReward(s),
                                                            container: this._popup,
                                                            animationEndEvent: this._popup.onClosed,
                                                            bubble: this._currentBubble,
                                                            bubblePosition: new Xe.Point(0,-200),
                                                            image: this._rewardImages[a]
                                                        })]
                                                    }
                                                    ))
                                                }
                                                ))
                                            }
                                            ))) : e.push((function() {
                                                return (0,
                                                n.__awaiter)(u, void 0, void 0, (function() {
                                                    return (0,
                                                    n.__generator)(this, (function(e) {
                                                        return [2, this._showClaimInventoryRewardAnimation(i.reward.data)]
                                                    }
                                                    ))
                                                }
                                                ))
                                            }
                                            )),
                                            [4, r.TimeDelay.nextFrame()]) : [3, 2];
                                        case 1:
                                            _.sent(),
                                            o._removeNotificationIconFromHud(),
                                            o._sendAnalyticsEvent(i),
                                            _.label = 2;
                                        case 2:
                                            return [2]
                                        }
                                    }
                                    ))
                                }
                                ,
                                o = this,
                                a = 0,
                                s = t,
                                d.label = 1;
                            case 1:
                                return a < s.length ? (_ = s[a],
                                [5, i(_)]) : [3, 4];
                            case 2:
                                d.sent(),
                                d.label = 3;
                            case 3:
                                return a++,
                                [3, 1];
                            case 4:
                                c = 0,
                                l = e,
                                d.label = 5;
                            case 5:
                                return c < l.length ? [4, (0,
                                l[c])()] : [3, 8];
                            case 6:
                                d.sent(),
                                d.label = 7;
                            case 7:
                                return c++,
                                [3, 5];
                            case 8:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._showClaimInventoryRewardAnimation = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, new SA({
                                    itemData: e,
                                    parent: this._popup
                                }).execute()];
                            case 1:
                                return t = n.sent(),
                                i = t.result,
                                r = t.reason,
                                i !== $_.SUCCESS && this._logger.error("error while executing reward strategy: ".concat(r)),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._prepareObjectReward = function(e) {
                    var t = {}
                      , i = De.services.blueprintCollection.getBlueprint(e).components.crateReward;
                    if (i) {
                        var n = De.services.timer.addTimer(this.getRemainingEventTime() + this._eventChestEndTime);
                        switch (i.crateRewardLevel) {
                        case lt.GOLDEN_CARROT:
                        case lt.GOLDEN_PUMPKIN:
                        case lt.GOLDEN_CHRISTMAS:
                            t = {
                                cooldown: {
                                    timerId: n.id
                                }
                            }
                        }
                    }
                    return t
                }
                ,
                t.prototype._isAnyRewardClaimable = function(e) {
                    var t = !1;
                    return this._goalItems.forEach((function(i) {
                        i.claimed || i.unlockedAtAmount <= e && !i.claimed && (t = !0)
                    }
                    )),
                    t
                }
                ,
                t.prototype._sendAnalyticsEvent = function(e) {
                    var t = this;
                    if (is(e.reward)) {
                        var i = De.services.blueprintCollection.getBlueprint(e.reward.data[0])
                          , n = function(n, r) {
                            i.components[n] && (r(i.components[n]),
                            e.claimedAnalyticEvent && De.services.analytics.design.reportGoldenEventItemRewardClaimed(t._analyticsEventName, e.claimedAnalyticEvent))
                        };
                        n("crateRewardKey", (function(e) {
                            De.services.analytics.design.reportKeyTypeSpawned(e.tier)
                        }
                        )),
                        n("crateReward", (function(e) {
                            De.services.analytics.design.reportRewardedChestSpawned(e.crateRewardLevel)
                        }
                        ))
                    }
                }
                ,
                t
            }(yA), wA = {
                headerText: ce.EVENT_GOLDENCARROT_HEADER,
                headerBackground: f.POPUP_EVENTHEADER_GOLDENCARROT,
                headerStyle: vn.eventPopupTitleGold,
                showCloseButton: !0,
                tapToCloseAlternative: !1,
                tapToCloseText: ce.TAP_TO_CONTINUE,
                tapToCloseAnimated: !0,
                content: new Xe.Container,
                popupBackground: f.POPUP_BACKGROUND_EVENT_9SLICE
            }, DA = ["golden_carrot"], NA = function(e) {
                function t(t, i, r) {
                    var o = e.call(this, t, i, r) || this;
                    return o.eventType = Xi.GOLDEN_CARROT,
                    o._analyticsEventName = St.GOLDENCARROT,
                    o._popupProperties = wA,
                    o._itemToCollect = DA,
                    o._goldenItemInteractionFamilyFilter = [Ke.GoldenItem, Ke.GridPosition, Ke.InteractionTap],
                    o._popupActiveBodyText = nr(bT || (bT = (0,
                    n.__makeTemplateObject)(["", "", "}"], ["", "", "}"])), ce.EVENT_GOLDENCARROT_BODY_ACTIVE, o._getMaxAmount()),
                    o._popupProgressBodyText = nr(RT || (RT = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.EVENT_GOLDENCARROT_BODY_ACTIVE, o._getMaxAmount()),
                    o._buttonClaim = ce.EVENT_GOLDENCARROT_BUTTON_CLAIMREWARD,
                    o._popupEndedCompleteBodyText = nr(wT || (wT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_GOLDENCARROT_BODY_COMPLETE),
                    o._popupEndedIncompleteBodyText = nr(DT || (DT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_GOLDENCARROT_BODY_INCOMPLETE),
                    o._hudButtonIdle = f.BTN_HUD_EVENT_GOLDENCARROT_IDLE,
                    o._hudButtonActive = f.BTN_HUD_EVENT_GOLDENCARROT_DOWN,
                    o._pillIcon = f.ICON_BTN_GOLDENCARROT,
                    o._buttonGotIt = ce.EVENT_GOLDENCARROT_BUTTON_GOTIT,
                    o._popupImage = f.ICON_EVENTIMAGE_GOLDENCARROT,
                    o._progressBarStartImage = f.ICON_PROGRESSBAR_EVENT_CARROT_BIG,
                    o._progressBarBackgroundAsset = f.UI_PROGRESSBAR_EVENTS_BACKGROUND,
                    o._progressBarFillAsset = f.UI_PROGRESSBAR_EVENTS_FILL,
                    o._progressBarRewardBalloon = f.UI_PROGRESSBAR_EVENTS_GOAL,
                    o._progressBarCounterBalloon = f.UI_PROGRESSBAR_EVENTS_COUNTER,
                    o._goalItems = [{
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_golden_carrot"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_GOLDENCARROT_LOOTCHEST
                        },
                        unlockedAtAmount: 15,
                        iconScale: .7,
                        balloonScale: 1.2,
                        claimed: !1
                    }, {
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_key_golden_carrot"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_GOLDENCARROT_KEY
                        },
                        unlockedAtAmount: 50,
                        claimed: !1
                    }],
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getDefaultEventConfiguration = function() {
                    return {
                        maxAmount: 50,
                        itemConfiguration: {
                            itemID: "golden_carrot",
                            contextData: [{
                                lootContext: FE.CRATE,
                                weightedItem: {
                                    weight: 800,
                                    key: "golden_carrot"
                                }
                            }, {
                                lootContext: FE.CROP,
                                weightedItem: {
                                    weight: 800,
                                    key: "golden_carrot"
                                }
                            }]
                        }
                    }
                }
                ,
                t.prototype.startEvent = function(t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.EVENTS_GOLDENCARROT)];
                            case 1:
                                return n.sent(),
                                [2, e.prototype.startEvent.call(this, t, i)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onCloseButtonPressed = function() {}
                ,
                t.prototype._getEventButtonProperties = function() {
                    return {
                        buttonProperties: {
                            name: "GoldenItemEventButton",
                            buttonIdle: this._hudButtonIdle,
                            buttonActive: this._hudButtonActive,
                            uiHeight: 300,
                            hitArea: this._hudButtonCustomHitArea
                        },
                        eventData: {
                            timerID: this._eventSavedData.timerId,
                            timervisualOffset: new Xe.Point(33,100),
                            timerBackgroundSize: {
                                width: 198,
                                height: 132
                            },
                            timerBackgroundOffset: new Xe.Point(0,-37)
                        },
                        eventButtonSettings: {
                            drawerWidth: 265,
                            drawerImagePosition: new Xe.Point(-25,15),
                            buttonPositionOffset: new Xe.Point(20,0),
                            extraContent: this._createButtonVisuals(),
                            extraContentPosition: new Xe.Point(15,95)
                        }
                    }
                }
                ,
                t
            }(RA), LA = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._customHeight = 1250,
                    i._name = "GoldenChristmasEventInfoPopup",
                    i._popupTitle = ce.EVENT_CHRISTMAS_HELP_HEADER,
                    i._popupHelpHeader = nr(NT || (NT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_HELP_SUBTEXT),
                    i._explanationIcon = f.ICON_POPUP_CHRISTMAS_EXPLANATION,
                    i._step1Text = nr(LT || (LT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_HELP_STEP_1),
                    i._step2Text = nr(BT || (BT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_HELP_STEP_2),
                    i._step3Text = nr(PT || (PT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_HELP_STEP_3),
                    i._exitButtonText = nr(kT || (kT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAP_TO_CONTINUE),
                    i.createPopup(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(CA), BA = {
                popupBackground: f.POPUP_BACKGROUND_EVENT_9SLICE_CHRISTMAS,
                headerBackground: f.POPUP_EVENTHEADER_CHRISTMAS,
                tapToCloseText: ce.TAP_TO_CONTINUE,
                headerText: ce.EVENT_CHRISTMAS_HEADER,
                headerStyle: vn.eventPopupTitleChristmas,
                showCloseButton: !0,
                tapToCloseAlternative: !1,
                tapToCloseAnimated: !0,
                content: new Xe.Container
            }, PA = ["golden_jingleball_1", "golden_jingleball_2", "golden_jingleball_3", "golden_jingleball_4"], kA = function(e) {
                function t(t, i, r) {
                    var o = e.call(this, t, i, r) || this;
                    return o.eventType = Xi.GOLDEN_CHRISTMAS,
                    o._analyticsEventName = St.GOLDENCHRISTMAS,
                    o._popupProperties = BA,
                    o._itemToCollect = PA,
                    o._goldenItemInteractionFamilyFilter = [Ke.GoldenItem, Ke.GridPosition, Ke.InteractionTap],
                    o._mapGrid = i.mapGrid,
                    o._gridFilter = i.gridFilter,
                    o._popupActiveBodyText = nr(xT || (xT = (0,
                    n.__makeTemplateObject)(["", "", "}"], ["", "", "}"])), ce.EVENT_CHRISTMAS_BODY_ACTIVE, o._getMaxAmount()),
                    o._popupProgressBodyText = nr(GT || (GT = (0,
                    n.__makeTemplateObject)(["", "", "}"], ["", "", "}"])), ce.EVENT_CHRISTMAS_BODY_ACTIVE, o._getMaxAmount()),
                    o._buttonClaim = ce.EVENT_CHRISTMAS_BUTTON_CLAIMREWARD,
                    o._popupEndedCompleteBodyText = nr(UT || (UT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_BODY_COMPLETE),
                    o._popupEndedIncompleteBodyText = nr(FT || (FT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_BODY_INCOMPLETE),
                    o._hudButtonIdle = f.BTN_HUD_EVENT_CHRISTMAS_IDLE,
                    o._hudButtonActive = f.BTN_HUD_EVENT_CHRISTMAS_DOWN,
                    o._buttonGotIt = ce.EVENT_HALLOWEEN_BUTTON_GOTIT,
                    o._popupImage = f.ICON_EVENTIMAGE_CHRISTMAS1,
                    o._progressBarBackgroundAsset = f.UI_PROGRESSBAR_EVENTS_BACKGROUND_CHRISTMAS,
                    o._progressBarRewardBalloon = f.UI_PROGRESSBAR_EVENTS_GOAL_CHRISTMAS,
                    o._progressBarSmallRewardBalloon = f.UI_PROGRESSBAR_EVENTS_SMALLGIFT_CHRISTMAS,
                    o._progressBarSmallRewardIcon = f.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS,
                    o._progressBarCounterBalloon = f.UI_PROGRESSBAR_EVENTS_COUNTER_CHRISTMAS,
                    o._progressBarStartImage = f.ICON_PROGRESSBAR_EVENT_JINGLEBALL,
                    o._goalItems = o._getGoalItems(),
                    o._halloweenButtonText = nr(MT || (MT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_SHOP_ANNOUNCEMENT_BUTTON),
                    o._family = new __(o._services.world,new c_([Ke.GoldenItem, Ke.GridPosition])),
                    o._family.onGameObjectAdded.addListener(o._onGoldenItemSpawned, o),
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getDefaultEventConfiguration = function() {
                    return {
                        maxAmount: 1475,
                        itemConfiguration: {
                            itemID: "golden_jingleball_1",
                            contextData: [{
                                lootContext: FE.CRATE,
                                weightedItem: {
                                    weight: 1e5,
                                    key: "golden_christmas_tree_1",
                                    unsuccessfulAttemptsThreshhold: 0,
                                    increaseWeightAmount: 0,
                                    cooldownDuration: 10,
                                    spawnFromLevel: 6
                                }
                            }]
                        }
                    }
                }
                ,
                t.prototype.startEvent = function(t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            return e.prototype.startEvent.call(this, t, i),
                            this._fixChestTimers(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._removeGoldenItems = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._removeObjectsWithBlueprints(["golden_christmas_tree_1", "golden_christmas_tree_2", "golden_christmas_tree_3", "golden_christmas_tree_4"]),
                            e.prototype._removeGoldenItems.call(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onCloseButtonPressed = function() {}
                ,
                t.prototype._getEventProgressPopupContent = function(t) {
                    var i = this._getMaxAmount() <= this._getCollectedAmount();
                    if (this._popupProgressBodyText = i ? nr(VT || (VT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_BODY_COMPLETE) : nr(HT || (HT = (0,
                    n.__makeTemplateObject)(["", "", "}"], ["", "", "}"])), ce.EVENT_CHRISTMAS_BODY_ACTIVE, this._getMaxAmount()),
                    this._services.marketplaceService.isShopEnabled(Fa.CHRISTMAS)) {
                        this._popupButtonSettings.xOffset = 250,
                        this._popupButtonSettings.width = 300;
                        var r = e.prototype._getEventProgressPopupContent.call(this, t);
                        this._popupButtonSettings.xOffset = 0,
                        this._popupButtonSettings.width = 480;
                        var o = this._createEventShopButton(r.height);
                        return r.addChild(o),
                        r
                    }
                    return e.prototype._getEventProgressPopupContent.call(this, t)
                }
                ,
                t.prototype._showInfo = function() {
                    De.services.navigation.showPopup(LA, {})
                }
                ,
                t.prototype._getPopupImageAsset = function() {
                    var e = this._goalItems.find((function(e) {
                        return is(e.reward) && "reward_crate_jingleballs_1" === e.reward.data[0]
                    }
                    ));
                    return !(0,
                    r.isUndefined)(e) && e.claimed ? f.ICON_EVENTIMAGE_CHRISTMAS2 : f.ICON_EVENTIMAGE_CHRISTMAS1
                }
                ,
                t.prototype._createEventShopButton = function(e) {
                    var t = this
                      , i = new fr({
                        name: "GoldenItemEventButton",
                        buttonIdle: f.BTN_EVENT_GREEN_CHRISTMAS_IDLE,
                        buttonActive: f.BTN_EVENT_GREEN_CHRISTMAS_DOWN
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, wv),
                        buttonSizes: {
                            width: 480,
                            height: 142
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: this._halloweenButtonText,
                        position: {
                            x: 0,
                            y: -7
                        }
                    });
                    return i.position.set(-150, e - i.height / 2),
                    i.onClick((function() {
                        return t._openEventShop()
                    }
                    )),
                    i
                }
                ,
                t.prototype._onGoldenItemSpawned = function(e) {
                    if (this._itemToCollect.includes(e.getBlueprintID())) {
                        var t = e.getBehavior(Ke.GoldenItem);
                        De.services.analytics.design.reportGoldenItemSpawned(t.keyType)
                    }
                }
                ,
                t.prototype._openEventShop = function() {
                    var e, t, i = this;
                    (null === (e = this._popup) || void 0 === e ? void 0 : e.popupLocked) ? null === (t = this._popup) || void 0 === t || t.onClosed.listenOnce((function() {
                        i._services.marketplaceService.openMarketplaceShop(Fa.CHRISTMAS)
                    }
                    ), this) : this._services.marketplaceService.openMarketplaceShop(Fa.CHRISTMAS)
                }
                ,
                t.prototype._removeObjectsWithBlueprints = function(e) {
                    var t = this;
                    ((0,
                    r.isArray)(e) ? e : [e]).forEach((function(e) {
                        t._gridFilter.getCellsWithBlueprint(e).forEach((function(e) {
                            var i, n;
                            null === (n = null === (i = t._mapGrid.getCell(e.column, e.row)) || void 0 === i ? void 0 : i.content) || void 0 === n || n.addBehavior(new ti({}))
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getGoalItems = function() {
                    return [{
                        reward: {
                            type: Va.INVENTORY,
                            data: {
                                key: Cn.CRATES,
                                amount: 75
                            }
                        },
                        visuals: {
                            active: f.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS,
                            inactive: f.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS_SEPIA
                        },
                        iconScale: .5,
                        balloonScale: 1.3,
                        claimed: !1,
                        unlockedAtAmount: 150,
                        claimedAnalyticEvent: "1_minigift_crates"
                    }, {
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_jingleballs_1"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_CHRISTMAS_LOOTCHEST,
                            inactive: f.ICON_PROGRESSBAR_CHRISTMAS_LOOTCHEST_SEPIA
                        },
                        balloonScale: 1.3,
                        claimed: !1,
                        unlockedAtAmount: 325,
                        claimedAnalyticEvent: "2_chest"
                    }, {
                        reward: {
                            type: Va.INVENTORY,
                            data: {
                                key: Cn.ENERGY,
                                amount: 125
                            }
                        },
                        visuals: {
                            active: f.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS,
                            inactive: f.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS_SEPIA
                        },
                        iconScale: .5,
                        balloonScale: 1.3,
                        claimed: !1,
                        unlockedAtAmount: 475,
                        claimedAnalyticEvent: "3_minigift_energy"
                    }, {
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_key_jingleballs"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_CHRISTMAS_KEY,
                            inactive: f.ICON_PROGRESSBAR_CHRISTMAS_KEY_SEPIA
                        },
                        balloonScale: .9,
                        claimed: !1,
                        unlockedAtAmount: 650,
                        claimedAnalyticEvent: "4_key"
                    }, {
                        reward: {
                            type: Va.INVENTORY,
                            data: {
                                key: Cn.GEMS,
                                amount: 50
                            }
                        },
                        visuals: {
                            active: f.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS,
                            inactive: f.UI_PROGRESSBAR_EVENTS_SMALLGIFTGIFT_CHRISTMAS_SEPIA
                        },
                        iconScale: .5,
                        balloonScale: 1.3,
                        claimed: !1,
                        unlockedAtAmount: 900,
                        claimedAnalyticEvent: "5_minigift_gems"
                    }, {
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_jingleballs_2"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_CHRISTMAS_LOOTCHEST,
                            inactive: f.ICON_PROGRESSBAR_CHRISTMAS_LOOTCHEST_SEPIA
                        },
                        balloonScale: 1.3,
                        claimed: !1,
                        unlockedAtAmount: 1100,
                        claimedAnalyticEvent: "6_chest"
                    }, {
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_key_jingleballs"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_CHRISTMAS_KEY,
                            inactive: f.ICON_PROGRESSBAR_CHRISTMAS_KEY_SEPIA
                        },
                        balloonScale: .9,
                        claimed: !1,
                        unlockedAtAmount: 1475,
                        claimedAnalyticEvent: "7_key"
                    }]
                }
                ,
                t.prototype._fixChestTimers = function() {
                    var e = this;
                    new __(this._services.world,new c_([Ke.CrateReward])).getGameObjects().forEach((function(t) {
                        if (t.getBehavior(Ke.CrateReward).crateRewardLevel === lt.GOLDEN_CHRISTMAS) {
                            var i = t.getBehavior(Ke.CoolDown);
                            null !== i && De.services.timer.getTimerByID(i.timerId).fastForward(e.getRemainingEventTime() + e._eventChestEndTime)
                        }
                    }
                    ))
                }
                ,
                t
            }(RA), xA = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._name = "GoldenPumpkinEventInfoPopup",
                    i._customWidth = void 0,
                    i._customHeight = void 0,
                    i._popupTitle = ce.EVENT_HALLOWEEN_HELP_HEADER,
                    i._popupHelpHeader = nr(jT || (jT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_HALLOWEEN_HELP_SUBTEXT),
                    i._explanationIcon = f.ICON_POPUP_GOLDENPUMPKIN_EXPLANATION,
                    i._step1Text = nr(KT || (KT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_HALLOWEEN_HELP_STEP_1),
                    i._step2Text = nr(WT || (WT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_HALLOWEEN_HELP_STEP_2),
                    i._step3Text = nr(zT || (zT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_HALLOWEEN_HELP_STEP_3),
                    i._exitButtonText = nr(YT || (YT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAP_TO_CONTINUE),
                    i.createPopup(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t
            }(CA), GA = {
                headerText: ce.EVENT_HALLOWEEN_HEADER,
                headerBackground: f.POPUP_EVENTHEADER_GOLDENPUMPKIN,
                headerStyle: vn.eventPopupTitleGold,
                showCloseButton: !0,
                tapToCloseAlternative: !1,
                tapToCloseText: ce.TAP_TO_CONTINUE,
                tapToCloseAnimated: !0,
                content: new Xe.Container,
                popupBackground: f.POPUP_BACKGROUND_EVENT_9SLICE_HALLOWEEN
            }, UA = ["golden_pumpkin"], FA = function(e) {
                function t(t, i, r) {
                    var o = e.call(this, t, i, r) || this;
                    return o.eventType = Xi.GOLDEN_PUMPKIN,
                    o._analyticsEventName = St.GOLDENPUMPKIN,
                    o._popupProperties = GA,
                    o._itemToCollect = UA,
                    o._goldenItemInteractionFamilyFilter = [Ke.GoldenItem, Ke.GridPosition, Ke.InteractionTap],
                    o._popupActiveBodyText = nr(JT || (JT = (0,
                    n.__makeTemplateObject)(["", "", "}"], ["", "", "}"])), ce.EVENT_HALLOWEEN_BODY_ACTIVE, o._getMaxAmount()),
                    o._popupProgressBodyText = nr(XT || (XT = (0,
                    n.__makeTemplateObject)(["", "", "}"], ["", "", "}"])), ce.EVENT_HALLOWEEN_BODY_ACTIVE, o._getMaxAmount()),
                    o._buttonClaim = ce.EVENT_HALLOWEEN_BUTTON_CLAIMREWARD,
                    o._popupEndedCompleteBodyText = nr(qT || (qT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_HALLOWEEN_BODY_COMPLETE),
                    o._popupEndedIncompleteBodyText = nr(QT || (QT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_HALLOWEEN_BODY_INCOMPLETE),
                    o._hudButtonIdle = f.BTN_HUD_EVENT_GOLDENPUMPKIN_IDLE,
                    o._hudButtonActive = f.BTN_HUD_EVENT_GOLDENPUMPKIN_DOWN,
                    o._buttonGotIt = ce.EVENT_HALLOWEEN_BUTTON_GOTIT,
                    o._popupImage = f.ICON_EVENTIMAGE_GOLDENPUMPKIN,
                    o._progressBarBackgroundAsset = f.UI_PROGRESSBAR_EVENTS_BACKGROUND_HALLOWEEN,
                    o._progressBarRewardBalloon = f.UI_PROGRESSBAR_EVENTS_GOAL_HALLOWEEN,
                    o._progressBarCounterBalloon = f.UI_PROGRESSBAR_EVENTS_COUNTER_HALLOWEEN,
                    o._progressBarStartImage = f.ICON_PROGRESSBAR_EVENT_PUMPKIN,
                    o._goalItems = [{
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_golden_pumpkin_1"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_GOLDENPUMPKIN_LOOTCHEST
                        },
                        unlockedAtAmount: 50,
                        iconScale: .7,
                        balloonScale: 1.2,
                        claimed: !1
                    }, {
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_key_golden_pumpkin"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_GOLDENPUMPKIN_KEY
                        },
                        unlockedAtAmount: 125,
                        claimed: !1
                    }, {
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_golden_pumpkin_2"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_GOLDENPUMPKIN_LOOTCHEST
                        },
                        unlockedAtAmount: 175,
                        iconScale: .7,
                        balloonScale: 1.2,
                        claimed: !1
                    }, {
                        reward: {
                            type: Va.OBJECT,
                            data: ["reward_crate_key_golden_pumpkin"]
                        },
                        visuals: {
                            active: f.ICON_PROGRESSBAR_GOLDENPUMPKIN_KEY
                        },
                        unlockedAtAmount: 250,
                        claimed: !1
                    }],
                    o._halloweenButtonText = nr(ZT || (ZT = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_HALLOWEEN_SHOP_ANNOUNCEMENT_BUTTON),
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getDefaultEventConfiguration = function() {
                    return {
                        maxAmount: 250,
                        itemConfiguration: {
                            itemID: "golden_pumpkin",
                            contextData: [{
                                lootContext: FE.CRATE,
                                weightedItem: {
                                    weight: 1e5,
                                    key: "golden_pumpkin",
                                    unsuccessfulAttemptsThreshhold: 0,
                                    increaseWeightAmount: 0,
                                    cooldownDuration: 20,
                                    spawnFromLevel: 1
                                }
                            }]
                        }
                    }
                }
                ,
                t.prototype._onCloseButtonPressed = function() {}
                ,
                t.prototype._getEventProgressPopupContent = function(t) {
                    var i = this._getMaxAmount() <= this._getCollectedAmount();
                    if (this._popupProgressBodyText = i ? nr($T || ($T = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_HALLOWEEN_BODY_COMPLETE) : nr(eA || (eA = (0,
                    n.__makeTemplateObject)(["", "", "}"], ["", "", "}"])), ce.EVENT_HALLOWEEN_BODY_ACTIVE, this._getMaxAmount()),
                    this._services.marketplaceService.isShopEnabled(Fa.HALLOWEEN)) {
                        this._popupButtonSettings.xOffset = 250,
                        this._popupButtonSettings.width = 300;
                        var r = e.prototype._getEventProgressPopupContent.call(this, t);
                        this._popupButtonSettings.xOffset = 0,
                        this._popupButtonSettings.width = 480;
                        var o = this._createEventShopButton(r.height);
                        return r.addChild(o),
                        r
                    }
                    return e.prototype._getEventProgressPopupContent.call(this, t)
                }
                ,
                t.prototype._showInfo = function() {
                    De.services.navigation.showPopup(xA, {})
                }
                ,
                t.prototype._createEventShopButton = function(e) {
                    var t = this
                      , i = new fr({
                        name: "GoldenItemEventButton",
                        buttonIdle: f.BTN_EVENT_PURPLE_IDLE,
                        buttonActive: f.BTN_EVENT_PURPLE_DOWN
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, wv),
                        buttonSizes: {
                            width: 480,
                            height: 142
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: this._halloweenButtonText,
                        position: {
                            x: 0,
                            y: -7
                        }
                    });
                    return i.position.set(-150, e - i.height / 2),
                    i.onClick((function() {
                        return t._openEventShop()
                    }
                    )),
                    i
                }
                ,
                t.prototype._openEventShop = function() {
                    var e;
                    null === (e = this._popup) || void 0 === e || e.close(),
                    this._services.marketplaceService.openMarketplaceShop(Fa.HALLOWEEN)
                }
                ,
                t
            }(RA), MA = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._logger = Ie.Of("IAPStrategy"),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r = this;
                        return (0,
                        n.__generator)(this, (function(o) {
                            switch (o.label) {
                            case 0:
                                return e = $_.SUCCESS,
                                t = "SUCCESS",
                                vp.platform.loginStrategy.isUserLoggedIn() ? [3, 2] : [4, De.services.signInBonus.openSignInBonusPopup("automatic")];
                            case 1:
                                return o.sent() || vp.platform.loginStrategy.attemptLogin().then((function(e) {
                                    e === be.SUCCESS && IO()
                                }
                                )),
                                [2, {
                                    result: $_.FAIL,
                                    reason: "USER_NOT_LOGGED_IN"
                                }];
                            case 2:
                                return [4, this._checkUnconsumedPurchase()];
                            case 3:
                                return (i = o.sent()) ? (this._paymentData = i,
                                [2, {
                                    result: e = $_.SUCCESS,
                                    reason: t
                                }]) : [4, this.dependencies.iap.purchaseItem({
                                    amount: 1,
                                    sku: this.dependencies.productId
                                }).then((function(t) {
                                    r._paymentData = t,
                                    e = $_.SUCCESS
                                }
                                )).catch((function(i) {
                                    return (0,
                                    n.__awaiter)(r, void 0, void 0, (function() {
                                        var r;
                                        return (0,
                                        n.__generator)(this, (function(n) {
                                            switch (n.label) {
                                            case 0:
                                                return "USER_INPUT" !== i.code ? (this._logger.error(JSON.stringify(i)),
                                                this._logger.warn(JSON.stringify(i)),
                                                e = $_.ERROR) : e = $_.FAIL,
                                                t = i.code,
                                                [4, this._checkUnconsumedPurchase()];
                                            case 1:
                                                return (r = n.sent()) && (this._paymentData = r),
                                                e = r ? $_.SUCCESS : $_.FAIL,
                                                t = r ? "SUCCESS" : i.code,
                                                [2]
                                            }
                                        }
                                        ))
                                    }
                                    ))
                                }
                                ))];
                            case 4:
                                return o.sent(),
                                [2, {
                                    result: e,
                                    reason: t
                                }]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.finalize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                if (!this._paymentData)
                                    throw new Error("Cannot finalize IAPStrategy without payment data");
                                return [4, this.dependencies.iap.consumePurchase(this._paymentData)];
                            case 1:
                                return e.sent(),
                                this._paymentData = void 0,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._checkUnconsumedPurchase = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this.dependencies.iap.getUnconsumedPurchases()];
                            case 1:
                                return e = n.sent(),
                                t = e.find((function(e) {
                                    return void 0 !== e.items.find((function(e) {
                                        return e.sku === i.dependencies.productId
                                    }
                                    ))
                                }
                                )),
                                [2, t]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(rc);
            function VA(e) {
                var t = pg(e);
                return t.position.set(0, 48),
                t
            }
            function HA(e, t) {
                var i = rr(De.services.resource.getSprite(f.ICON_EVENTIMAGE_PIGGYBANK_START), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: 0,
                        y: e.position.y + 365
                    }
                });
                i.addChild(rr(De.services.resource.getSprite(f.ICON_PROGRESSBAR_EVENT_ENERGY_BIG), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    scale: {
                        x: .75,
                        y: .75
                    },
                    position: {
                        x: -80,
                        y: -i.position.y / 2 - 25
                    }
                }));
                var n = new v.LabelSettings({
                    fitToBox: !0,
                    fitWidth: 150,
                    fitHeight: 110
                });
                return n.style = vn.darkBrownExtraLarge,
                i.addChild(rr(new v.Label(t.toString(),n), {
                    anchor: {
                        x: 0,
                        y: .5
                    },
                    position: {
                        x: -20,
                        y: -i.position.y / 2 - 25
                    }
                })),
                i
            }
            function jA(e, t, i) {
                var n = new v.LabelSettings({
                    fitToBox: !0,
                    fitWidth: i,
                    fitHeight: 300
                });
                n.style = vn.darkBrownMedium;
                var r = new v.Label(t,n);
                return r.anchor.set(.5),
                r.position.set(0, e.position.y + e.height / 2 + r.height / 2 + 20),
                r
            }
            function KA(e, t, i, n, r) {
                var o = new cr(De.services.resource.getTexture(f.UI_PROGRESSBAR_EVENTS_BACKGROUND),54,51,54,61);
                o.setSizes(t),
                o.anchor.set(.5);
                var a = o.addChild(new Xe.Container)
                  , s = o.width - 38
                  , _ = new v.LabelSettings({
                    fitToBox: !0,
                    fitWidth: 150,
                    fitHeight: 110
                });
                _.style = vn.turquoiseSmall,
                a.addChild(rr(new v.Label(i.toString(),_), {
                    anchor: {
                        x: 1,
                        y: .5
                    },
                    position: {
                        x: s,
                        y: o.height / 2 - 7.5
                    }
                }));
                var c = new cr(De.services.resource.getTexture(f.UI_PROGRESSBAR_EVENTS_FILL),35,33,35,33);
                c.anchor.set(0, .5),
                c.position.set(19, c.height - 17),
                c.setSizes({
                    width: s,
                    height: c.height
                }),
                a.addChild(c);
                var l = s * (r / i)
                  , u = c.addChild((new Xe.Graphics).beginFill(16777215).drawRect(0, 0, l, c.height).endFill());
                c.mask = u;
                var d = new Xe.Point(c.width * (n / i) + 19,30);
                a.addChild((new Xe.Graphics).lineStyle(4, 0).moveTo(d.x, d.y - 20).lineTo(d.x, d.y + (c.height - 12.5)).endFill());
                var h = a.addChild(rr(De.services.resource.getSprite(f.UI_PROGRESSBAR_EVENTS_GOAL), {
                    anchor: {
                        x: .5,
                        y: 1
                    },
                    position: d
                }));
                h.addChild(rr(De.services.resource.getSprite(f.ICON_LEVELUP_LOCK_UNLOCKED), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: 0,
                        y: -100
                    }
                })),
                r >= n && h.addChild(rr(De.services.resource.getSprite(f.ICON_TASKS_CHECKMARK), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    scale: {
                        x: .4,
                        y: .4
                    },
                    position: {
                        x: 65,
                        y: -120
                    }
                }));
                var p = a.addChild(rr(De.services.resource.getSprite(f.UI_PROGRESSBAR_EVENTS_GOAL), {
                    anchor: {
                        x: .5,
                        y: 1
                    },
                    position: {
                        x: s,
                        y: 30
                    }
                }));
                p.addChild(rr(De.services.resource.getSprite(f.ICON_PROGRESSBAR_EVENT_ENERGY_SMALL), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: 0,
                        y: -87
                    }
                }));
                var g = De.services.resource.getSprite(f.ICON_PROGRESSBAR_EVENT_ENERGY_BIG);
                rr(g, {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: 19,
                        y: g.height / 2 - 15
                    }
                }),
                a.addChild(g);
                var E = a.addChild(rr(De.services.resource.getSprite(f.UI_PROGRESSBAR_EVENTS_COUNTER), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: Math.min(s, c.width * (r / i) + 19),
                        y: o.height + 20
                    }
                }));
                return _.style = vn.darkBrownSmall,
                E.addChild(rr(new v.Label(r.toString(),_), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: 0,
                        y: 10
                    }
                })),
                o.position.set(0, e.position.y + e.height / 2 + o.height / 2 + p.height - 10),
                o
            }
            function WA(e, t, i, n) {
                var r = new uc({
                    name: "PiggyBankButton",
                    buttonIdle: f.BTN_EVENT_GREEN_IDLE,
                    buttonActive: f.BTN_EVENT_GREEN_DOWN,
                    buttonInactive: f.BTN_EVENT_GREY_INACTIVE
                },{
                    buttonCorners: {
                        leftWidth: 74,
                        topHeight: 65,
                        rightWidth: 74,
                        bottomHeight: 72
                    },
                    buttonSizes: {
                        width: 500,
                        height: 142
                    }
                },{
                    text: t,
                    textStyle: vn.buttonLabel,
                    position: {
                        x: 0,
                        y: -5
                    }
                },{
                    iconImage: f.ICON_LEVELUP_LOCK_LOCKED,
                    iconPosition: {
                        x: -225,
                        y: -10
                    },
                    iconScale: n ? {
                        x: -1,
                        y: 1
                    } : {
                        x: 0,
                        y: 0
                    }
                });
                return r.position.set(0, e.position.y + 220),
                i && (r.interactive = !1,
                r.disable()),
                r
            }
            function zA(e) {
                var t = rr(De.services.resource.getSprite(f.ICON_STICKER_DISCOUNT_PIGGYBANK), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: e.position.x + e.width / 2 + 70,
                        y: e.position.y + 50
                    }
                })
                  , i = new Xe.Container
                  , r = new v.LabelSettings({
                    fitToBox: !0,
                    fitWidth: t.width - 50
                });
                r.style = vn.eventDiscountTextExtraSmall;
                var o = i.addChild(rr(new v.Label(nr(tA || (tA = (0,
                n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_PIGGYBANK_DISCOUNT_STICKER_TOPTEXT),r), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: 0,
                        y: -50
                    }
                }));
                r.style = vn.eventDiscountTextExtraLarge;
                var a = i.addChild(rr(new v.Label(nr(iA || (iA = (0,
                n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_PIGGYBANK_DISCOUNT_STICKER_DISCOUNT),r), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: 0,
                        y: o.position.y + o.height
                    }
                }));
                return r.style = vn.eventDiscountTextMedium,
                i.addChild(rr(new v.Label(nr(nA || (nA = (0,
                n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_PIGGYBANK_DISCOUNT_STICKER_BOTTOMTEXT),r), {
                    anchor: {
                        x: .5,
                        y: .5
                    },
                    position: {
                        x: 0,
                        y: a.position.y + a.height / 2
                    }
                })),
                i.position.set(10, -25),
                i.angle = 15,
                t.addChild(i),
                t
            }
            var YA, JA, XA, qA, QA, ZA, $A, eC, tC, iC, nC, rC, oC, aC, sC, _C, cC = (0,
            n.__assign)((0,
            n.__assign)({}, mA), {
                headerText: ce.EVENT_PIGGYBANK_HEADER,
                headerBackground: f.POPUP_EVENTHEADER_PIGGYBANK,
                tapToCloseAlternative: !1,
                headerStyle: vn.eventPopupTitleYellow
            }), lC = function(e) {
                function t(t, i, n) {
                    var r = e.call(this, t, i, n, i.hudService) || this;
                    return r.eventType = Xi.PIGGYBANK,
                    r._popupProperties = cC,
                    r._eventActive = !0,
                    r._textAnimationTimeline = lr.gsap.timeline(),
                    r._textAnimation = null,
                    r._currentState = {
                        number: 0
                    },
                    r._popupLabelSettings = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: r._getPopupImage().width - 100,
                        fitHeight: 300
                    }),
                    r._popupLabelSettings.style = vn.darkBrownMedium,
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createDefaultEventSavedData = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, {
                                collectedAmount: 0,
                                purchased: !1
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getDefaultEventConfiguration = function() {
                    return {
                        inventoryCurrency: Cn.ENERGY,
                        unlockBankTarget: 60,
                        maxBankAmount: 100,
                        shopId: "1212414364053807135"
                    }
                }
                ,
                t.prototype.startEvent = function(t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._data.purchased ? (this._setEventInactive(),
                                [2]) : [4, e.prototype.startEvent.call(this, t, i)];
                            case 1:
                                return n.sent(),
                                De.services.actions.on("spend.".concat(this._eventConfiguration.inventoryCurrency), this._onCurrencySpend, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onCloseButtonPressed = function() {}
                ,
                t.prototype._getEventStartPopupContent = function(e) {
                    var t = new Xe.Container
                      , i = t.addChild(VA(e))
                      , r = t.addChild(HA(i, this._data.collectedAmount))
                      , o = t.addChild(jA(r, nr(YA || (YA = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_PIGGYBANK_ACTIVE_BODY), this._getPopupImage().width - 100))
                      , a = t.addChild(KA(o, {
                        width: this._getPopupImage().width - 100,
                        height: 114
                    }, this._eventConfiguration.maxBankAmount, this._eventConfiguration.unlockBankTarget, this._data.collectedAmount));
                    return t.addChild(WA(a, ce.EVENT_PIGGYBANK_ACTIVE_BUTTON, !1, !1)).onClick((function() {
                        De.services.navigation.closeTopPopup()
                    }
                    )),
                    this._popupProperties.popupSizeOffsets = {
                        width: 0,
                        height: 0
                    },
                    t
                }
                ,
                t.prototype._getEventProgressPopupContent = function(e) {
                    var t = new Xe.Container
                      , i = t.addChild(VA(e))
                      , r = t.addChild(HA(i, this._data.collectedAmount))
                      , o = t.addChild(jA(r, nr(JA || (JA = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_PIGGYBANK_ACTIVE_BODY), this._getPopupImage().width - 100))
                      , a = t.addChild(KA(o, {
                        width: this._getPopupImage().width - 100,
                        height: 114
                    }, this._eventConfiguration.maxBankAmount, this._eventConfiguration.unlockBankTarget, this._data.collectedAmount))
                      , s = t.addChild(this._getPurchaseButton(a, this._data.collectedAmount < this._eventConfiguration.unlockBankTarget, this._data.collectedAmount < this._eventConfiguration.unlockBankTarget));
                    return t.addChild(zA(s)),
                    this._popupProperties.popupSizeOffsets = {
                        width: 0,
                        height: -100
                    },
                    t
                }
                ,
                t.prototype._getEventEndedPopupContent = function() {
                    var e = this._data.collectedAmount >= this._eventConfiguration.unlockBankTarget
                      , t = new Xe.Container
                      , i = t.addChild(rr(new v.Label(nr(XA || (XA = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHOPCHOP_ENDED_HEADER),this._popupLabelSettings), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 50
                        }
                    }))
                      , r = t.addChild(HA(i, this._data.collectedAmount))
                      , o = t.addChild(jA(r, e ? nr(qA || (qA = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.EVENT_PIGGYBANK_ENDED_BODY, this._data.collectedAmount) : nr(QA || (QA = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_PIGGYBANK_ENDED_BELOW_THRESHHOLD), this._getPopupImage().width - 100))
                      , a = t.addChild(KA(o, {
                        width: this._getPopupImage().width - 100,
                        height: 114
                    }, this._eventConfiguration.maxBankAmount, this._eventConfiguration.unlockBankTarget, this._data.collectedAmount));
                    if (e) {
                        var s = t.addChild(this._getPurchaseButton(a, !1, !1));
                        t.addChild(zA(s))
                    }
                    return this._popupProperties.popupSizeOffsets = {
                        width: 0,
                        height: e ? -100 : 100
                    },
                    t
                }
                ,
                t.prototype._getEventButtonProperties = function() {
                    return {
                        buttonProperties: {
                            name: "PiggyBank",
                            buttonIdle: f.BTN_HUD_EVENT_PIGGYBANK_IDLE,
                            buttonActive: f.BTN_HUD_EVENT_PIGGYBANK_DOWN,
                            uiHeight: 300
                        },
                        eventData: {
                            timerID: this._eventSavedData.timerId,
                            timervisualOffset: new Xe.Point(33,100),
                            timerBackgroundSize: {
                                width: 198,
                                height: 132
                            },
                            timerBackgroundOffset: new Xe.Point(0,-35)
                        },
                        eventButtonSettings: {
                            drawerWidth: 265,
                            drawerImagePosition: new Xe.Point(-25,15),
                            buttonPositionOffset: new Xe.Point(20,0),
                            extraContent: this._createButtonVisuals(),
                            extraContentPosition: new Xe.Point(15,90)
                        }
                    }
                }
                ,
                t.prototype._getPurchaseButton = function(e, t, i) {
                    var r = this._getShopProduct()
                      , o = WA(e, (null == r ? void 0 : r.price.formattedAmount) || nr(ZA || (ZA = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.BUTTON_UNAVAILABLE), t, i);
                    return r ? o.onClick(this._onPurchaseButtonClicked.bind(this, o)) : o.disable(),
                    o
                }
                ,
                t.prototype._getShopProduct = function() {
                    return (0,
                    r.isUndefined)(this._shopProduct) && this._setShopProduct(),
                    this._shopProduct
                }
                ,
                t.prototype._setShopProduct = function() {
                    var e = this
                      , t = De.services.iap.catalog.find((function(t) {
                        return t.sku === e._eventConfiguration.shopId
                    }
                    ));
                    (0,
                    r.isUndefined)(t) ? this._logger.error("Could not find product with id ".concat(this._eventConfiguration.shopId)) : this._shopProduct = t
                }
                ,
                t.prototype._onPurchaseButtonClicked = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a, s;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                e.disable(),
                                this._popup.popupLocked = !0,
                                n.label = 1;
                            case 1:
                                return n.trys.push([1, 3, , 4]),
                                De.services.analytics.design.reportPiggyBankPurchaseButtonPressed(),
                                [4, (t = new MA({
                                    iap: De.services.iap,
                                    productId: this._shopProduct.sku
                                })).execute()];
                            case 2:
                                if (i = n.sent(),
                                r = i.result,
                                o = i.reason,
                                r !== $_.SUCCESS)
                                    throw this._logger.warn("Purchase failed: ".concat(o)),
                                    new Error("".concat(o));
                                return De.services.inventory.addAmount(this._eventConfiguration.inventoryCurrency, this._data.collectedAmount, !1),
                                t.finalize(),
                                a = 10 * ((_ = this._data.collectedAmount / this._eventConfiguration.maxBankAmount * 10) - Math.floor(_) < .5 ? Math.floor(_) : Math.ceil(_)),
                                De.services.analytics.design.reportPiggyBankPurchaseSuccessful(a),
                                this._popup.popupLocked = !1,
                                this._onSuccessfulPurchase(),
                                [3, 4];
                            case 3:
                                return s = n.sent(),
                                this._logger.error("Purchase failed: ".concat(s)),
                                e.enable(),
                                this._popup.popupLocked = !1,
                                [3, 4];
                            case 4:
                                return [2]
                            }
                            var _
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onSuccessfulPurchase = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._data.purchased = !0,
                                this._saveData(),
                                this._setEventInactive(),
                                this._eventActive = !1,
                                [4, null === (e = this._popup) || void 0 === e ? void 0 : e.close()];
                            case 1:
                                return t.sent(),
                                this._animateRewards(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._animateRewards = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o, a, s, _, c = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return e = new Xe.Point(0,0),
                            t = De.services.navigation.layers.popup.container,
                            i = t.toGlobal(e || new Xe.Point(0,0)),
                            r = De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter({
                                amount: this._data.collectedAmount,
                                key: this._eventConfiguration.inventoryCurrency
                            }),
                            o = r.target,
                            a = r.icon,
                            s = o.toGlobal(new Xe.Point(0,0)),
                            (_ = new Lr(De.services.resource.getSprite(a),t.toLocal(i),t.toLocal(s),this._data.collectedAmount,t)).onAnimationComplete.addListener((function() {
                                De.services.inventory.getInventoryItem(c._eventConfiguration.inventoryCurrency).updateVisuals()
                            }
                            ), null),
                            _.animate(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getPopupImage = function() {
                    return De.services.resource.getSprite(f.ICON_EVENTIMAGE_PIGGYBANK_START)
                }
                ,
                t.prototype._createButtonVisuals = function() {
                    this._buttonVisuals = new Xe.Container;
                    var e = new cr(De.services.resource.getTexture(f.BTN_EVENT_WHITEPILL_9SLICE),32,0,30,0);
                    e.setSizes({
                        width: 178,
                        height: 66
                    }),
                    e.position.set(0, 0),
                    e.anchor.set(.5),
                    this._buttonVisuals.addChild(e),
                    this._buttonEnergyIcon = rr(De.services.resource.getSprite(f.ICON_PROGRESSBAR_EVENT_ENERGY_SMALL), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        scale: {
                            x: .8,
                            y: .8
                        },
                        position: {
                            x: e.position.x + 40,
                            y: e.height / 2 - 10
                        }
                    }),
                    e.addChild(this._buttonEnergyIcon);
                    var t = this._data.collectedAmount.toString();
                    return this._buttonCounter = new Xe.Text(String(t),vn.darkSmall),
                    this._buttonCounter.anchor.set(.5),
                    this._buttonCounter.position.set(e.position.x + e.width / 2 + this._buttonEnergyIcon.width / 2, e.height / 2),
                    e.addChild(this._buttonCounter),
                    this._buttonVisuals
                }
                ,
                t.prototype._onCurrencySpend = function(e) {
                    var t = e.split(".");
                    if ("spend" === t[0] && t[1] === this._eventConfiguration.inventoryCurrency && t.length >= 5) {
                        var i = parseInt(t[2])
                          , n = parseInt(t[3])
                          , o = parseInt(t[4])
                          , a = this._services.mapGrid.getCell(n, o);
                        if (!a || (0,
                        r.isNull)(a.content))
                            return;
                        this._updateSavedData(i) && this._animateCurrency(i, a.content)
                    }
                }
                ,
                t.prototype._updateSavedData = function(e) {
                    if (this._data.collectedAmount >= this._eventConfiguration.maxBankAmount)
                        return !1;
                    var t = this._data.collectedAmount;
                    return this._data.collectedAmount = Math.min(this._data.collectedAmount += e, this._eventConfiguration.maxBankAmount),
                    this._saveData(),
                    t < this._eventConfiguration.unlockBankTarget && this._data.collectedAmount >= this._eventConfiguration.unlockBankTarget && De.services.analytics.design.reportPiggyBankPurchaseButtonUnlocked(),
                    !0
                }
                ,
                t.prototype._animateCurrency = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, r, o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return i = {
                                    amount: e,
                                    key: this._eventConfiguration.inventoryCurrency
                                },
                                r = De.services.resource.getSprite(qa[i.key]),
                                o = this._buttonCounter,
                                [4, this._playAnimation(r, t, i, o, this._hudService.hudContainer)];
                            case 1:
                                return n.sent(),
                                vg(this._data.collectedAmount, this._currentState.number, this._textAnimationTimeline, this._textAnimation, this._currentState, this._buttonCounter, .8, this._buttonEnergyIcon),
                                gg(this._buttonVisuals),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._playAnimation = function(e, t, i, n, r) {
                    return new Promise((function(o) {
                        var a = t.parent.toGlobal(t)
                          , s = new Xe.Sprite(e.texture);
                        s.position = r.toLocal(a),
                        s.anchor = e.anchor.clone(),
                        r.addChild(s);
                        var _ = De.services.resource.getSpine(se.CLAIM_CURRENCY);
                        _.visible = !1,
                        _.position = r.toLocal(a),
                        r.addChild(_);
                        var c = new ur(Vv);
                        c.setTargets({
                            container: s
                        });
                        var l = n.parent.toGlobal(n)
                          , u = new Lr(s,r.toLocal(a),r.toLocal(l),i.amount,r);
                        u.onAnimationSpawn.addListener((function() {
                            _.visible = !0,
                            _.state.setAnimation(0, "disappear_effect", !1)
                        }
                        ), null),
                        u.onAnimationComplete.addListener((function() {
                            c.dispose(),
                            _.destroy(),
                            s.destroy(),
                            o()
                        }
                        ), null),
                        u.animate(),
                        c.play("disappear"),
                        c.onEnd.addListener((function() {
                            c.dispose()
                        }
                        ), null)
                    }
                    ))
                }
                ,
                t
            }(yA), uC = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getPurchasedData = function() {
                    return this._model.getEventSavedData(this.eventType).purchasedItems
                }
                ,
                t.prototype.itemPurchased = function(e) {
                    this._data.purchasedItems.includes(e) && this._logger.error("Item already purchased: ", e),
                    this._data.purchasedItems.push(e),
                    this._saveData()
                }
                ,
                t.prototype.isItemPurchased = function(e) {
                    return this._data.purchasedItems.includes(e)
                }
                ,
                t.prototype.createDefaultEventSavedData = function() {
                    return Promise.resolve({
                        purchasedItems: []
                    })
                }
                ,
                t.prototype.startEvent = function(t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._services.marketplaceService.enableShop(this._marketplaceShopID, this),
                                [4, e.prototype.startEvent.call(this, t, i)];
                            case 1:
                                return n.sent(),
                                this._services.hudService.hudContainer.getUIelement(Ns.MarketplaceButtonUI).setShopToFocus(this._marketplaceShopID),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.endEvent = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._model.deleteEventSavedData(this.eventType),
                            this._services.marketplaceService.disableShop(this._marketplaceShopID),
                            this._services.hudService.hudContainer.getUIelement(Ns.MarketplaceButtonUI).setShopToFocus(Ua.CRATES),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onCloseButtonPressed = function() {
                    De.services.analytics.design.reportShopPopupCloseButtonPressed(this.eventType)
                }
                ,
                t.prototype._onShopButtonPressed = function() {
                    De.services.analytics.design.reportShopPopupShopButtonPressed(this.eventType),
                    this._openEventShop()
                }
                ,
                t.prototype._getEventProgressPopupContent = function(e) {
                    var t = this
                      , i = new Xe.Container
                      , r = 10
                      , o = pg(e);
                    o.position.set(0, r + o.height / 2),
                    i.addChild(o),
                    r += o.height + 15,
                    i.addChild(rr(this._getPopupImage(), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: r
                        }
                    })),
                    r += this._getPopupImage().height + 30,
                    i.addChild(rr(new v.Label(this._popupBodyText,this._popupLabelSettings), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: r
                        }
                    })),
                    r = i.height + 30;
                    var a = new fr({
                        name: "".concat(this.eventType, " button"),
                        buttonIdle: this._popupButtonIdle,
                        buttonActive: this._popupButtonActive
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, wv),
                        buttonSizes: {
                            width: 480,
                            height: 142
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: this._popupButtonText,
                        position: {
                            x: 0,
                            y: -7
                        }
                    });
                    return r += a.height / 2,
                    a.position.set(0, r),
                    a.onClick((function() {
                        t._onShopButtonPressed()
                    }
                    )),
                    i.addChild(a),
                    i
                }
                ,
                t.prototype._getPopupImage = function() {
                    return De.services.resource.getSprite(this._eventImage)
                }
                ,
                t.prototype._openEventShop = function() {
                    var e;
                    null === (e = this._popup) || void 0 === e || e.close(),
                    this._services.marketplaceService.openMarketplaceShop(this._marketplaceShopID)
                }
                ,
                t.prototype._getEventStartPopupContent = function(e) {
                    return this._getEventProgressPopupContent(e)
                }
                ,
                t.prototype._getEventEndedPopupContent = function() {
                    return new Xe.Container
                }
                ,
                t.prototype._getEventButtonProperties = function() {
                    return null
                }
                ,
                t
            }(yA), dC = {
                headerText: ce.EVENT_BLACK_FRIDAY_SHOP_ANNOUNCEMENT_HEADER,
                headerBackground: f.POPUP_EVENTHEADER_BLACKFRIDAY,
                headerStyle: vn.eventPopupTitleBlack,
                showCloseButton: !0,
                tapToCloseAlternative: !1,
                tapToCloseText: ce.TAP_TO_CONTINUE,
                tapToCloseAnimated: !0,
                content: new Xe.Container,
                popupBackground: f.POPUP_BACKGROUND_BLACKFRIDAY_9SLICE
            }, hC = function(e) {
                function t(t, i, r) {
                    var o = e.call(this, t, i, r, i.hudService) || this;
                    return o.eventType = Xi.BLACK_FRIDAY_SHOP,
                    o._marketplaceShopID = Fa.BLACK_FRIDAY,
                    o._popupProperties = dC,
                    o._eventActive = !0,
                    o._eventImage = f.ICON_EVENTIMAGE_BLACKFRIDAY,
                    o._popupBodyText = nr($A || ($A = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_BLACK_FRIDAY_SHOP_ANNOUNCEMENT_BODY),
                    o._popupButtonText = ce.EVENT_BLACK_FRIDAY_SHOP_ANNOUNCEMENT_BUTTON,
                    o._popupButtonIdle = f.BTN_EVENT_BLACKFRIDAY_IDLE,
                    o._popupButtonActive = f.BTN_EVENT_BLACKFRIDAY_ACTIVE,
                    o._popupLabelSettings = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: o._getPopupImage().width - 100,
                        fitHeight: 300
                    }),
                    o._popupLabelSettings.style = vn.darkBrownMedium,
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createDefaultEventSavedData = function() {
                    return Promise.resolve({
                        purchasedItems: []
                    })
                }
                ,
                t.prototype.startEvent = function(t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._services.marketplaceService.enableShop(Fa.BLACK_FRIDAY, this),
                                [4, e.prototype.startEvent.call(this, t, i)];
                            case 1:
                                return n.sent(),
                                this._services.hudService.hudContainer.getUIelement(Ns.MarketplaceButtonUI).showBlackFridayVisuals(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.endEvent = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._model.deleteEventSavedData(this.eventType),
                            this._services.marketplaceService.disableShop(Fa.BLACK_FRIDAY),
                            this._services.hudService.hudContainer.getUIelement(Ns.MarketplaceButtonUI).hideEventVisuals(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getDefaultEventConfiguration = function() {
                    return {}
                }
                ,
                t
            }(uC), pC = {
                headerText: ce.EVENT_CHRISTMAS_DEALS_SHOP_ANNOUNCEMENT_HEADER,
                headerBackground: f.POPUP_EVENTHEADER_CHRISTMASSPECIALS,
                headerStyle: vn.eventPopupTitleChristmas,
                showCloseButton: !0,
                tapToCloseAlternative: !1,
                tapToCloseText: ce.TAP_TO_CONTINUE,
                tapToCloseAnimated: !0,
                content: new Xe.Container,
                popupBackground: f.POPUP_BACKGROUND_EVENT_9SLICE_CHRISTMAS
            }, vC = function(e) {
                function t(t, i, r) {
                    var o = e.call(this, t, i, r, i.hudService) || this;
                    return o.eventType = Xi.CHRISTMAS_DEALS_SHOP,
                    o._marketplaceShopID = Fa.CHRISTMAS_DEALS,
                    o._popupProperties = pC,
                    o._eventActive = !0,
                    o._eventImage = f.ICON_EVENTIMAGE_CHRISTMASSPECIAL,
                    o._popupBodyText = nr(eC || (eC = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_DEALS_SHOP_ANNOUNCEMENT_BODY),
                    o._popupButtonText = ce.EVENT_BLACK_FRIDAY_SHOP_ANNOUNCEMENT_BUTTON,
                    o._popupButtonIdle = f.BTN_EVENT_GREEN_CHRISTMAS_IDLE,
                    o._popupButtonActive = f.BTN_EVENT_GREEN_CHRISTMAS_DOWN,
                    o._popupLabelSettings = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: o._getPopupImage().width - 100,
                        fitHeight: 300
                    }),
                    o._popupLabelSettings.style = vn.darkBrownMedium,
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createDefaultEventSavedData = function() {
                    return Promise.resolve({
                        purchasedItems: []
                    })
                }
                ,
                t.prototype.startEvent = function(t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._services.marketplaceService.enableShop(Fa.CHRISTMAS_DEALS, this),
                                [4, e.prototype.startEvent.call(this, t, i)];
                            case 1:
                                return n.sent(),
                                this._services.hudService.hudContainer.getUIelement(Ns.MarketplaceButtonUI).showChristmasDealsVisuals(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.endEvent = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._model.deleteEventSavedData(this.eventType),
                            this._services.marketplaceService.disableShop(Fa.CHRISTMAS_DEALS),
                            this._services.hudService.hudContainer.getUIelement(Ns.MarketplaceButtonUI).hideEventVisuals(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getDefaultEventConfiguration = function() {
                    return {}
                }
                ,
                t
            }(uC), gC = {
                headerText: ce.EVENT_CHRISTMAS_SHOP_ANNOUNCEMENT_HEADER,
                headerStyle: vn.eventPopupTitleChristmas,
                headerBackground: f.POPUP_EVENTHEADER_CHRISTMAS,
                popupBackground: f.POPUP_BACKGROUND_EVENT_9SLICE_CHRISTMAS,
                tapToCloseText: ce.TAP_TO_CONTINUE,
                content: new Xe.Container,
                showCloseButton: !0,
                tapToCloseAlternative: !1,
                tapToCloseAnimated: !0
            }, fC = function(e) {
                function t(t, i, r) {
                    var o = e.call(this, t, i, r, i.hudService) || this;
                    return o.eventType = Xi.CHRISTMAS_SHOP,
                    o._marketplaceShopID = Fa.CHRISTMAS,
                    o._popupProperties = gC,
                    o._eventActive = !0,
                    o._eventImage = f.ICON_EVENTIMAGE_CHRISTMASSHOP,
                    o._popupBodyText = nr(tC || (tC = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_CHRISTMAS_SHOP_ANNOUNCEMENT_BODY),
                    o._popupButtonText = ce.EVENT_CHRISTMAS_SHOP_ANNOUNCEMENT_BUTTON,
                    o._popupButtonIdle = f.BTN_EVENT_GREEN_IDLE,
                    o._popupButtonActive = f.BTN_EVENT_GREEN_DOWN,
                    o._popupLabelSettings = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: o._getPopupImage().width - 100,
                        fitHeight: 300
                    }),
                    o._popupLabelSettings.style = vn.darkBrownMedium,
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getDefaultEventConfiguration = function() {
                    return {}
                }
                ,
                t
            }(uC), EC = {
                popupBackground: f.POPUP_BACKGROUND_EVENT_9SLICE_HALLOWEEN,
                headerBackground: f.POPUP_EVENTHEADER_GOLDENPUMPKIN,
                headerText: ce.EVENT_HALLOWEEN_SHOP_ANNOUNCEMENT_HEADER,
                headerStyle: vn.eventPopupTitleGold,
                tapToCloseText: ce.TAP_TO_CONTINUE,
                content: new Xe.Container,
                showCloseButton: !0,
                tapToCloseAlternative: !1,
                tapToCloseAnimated: !0
            }, mC = function(e) {
                function t(t, i, r) {
                    var o = e.call(this, t, i, r, i.hudService) || this;
                    return o.eventType = Xi.HALLOWEEN_SHOP,
                    o._marketplaceShopID = Fa.HALLOWEEN,
                    o._popupProperties = EC,
                    o._eventActive = !0,
                    o._eventImage = f.ICON_EVENTIMAGE_HALLOWEENSHOP,
                    o._popupBodyText = nr(iC || (iC = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EVENT_HALLOWEEN_SHOP_ANNOUNCEMENT_BODY),
                    o._popupButtonText = ce.EVENT_HALLOWEEN_SHOP_ANNOUNCEMENT_BUTTON,
                    o._popupButtonIdle = f.BTN_EVENT_PURPLE_IDLE,
                    o._popupButtonActive = f.BTN_EVENT_PURPLE_DOWN,
                    o._popupLabelSettings = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: o._getPopupImage().width - 100,
                        fitHeight: 300
                    }),
                    o._popupLabelSettings.style = vn.darkBrownMedium,
                    o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getDefaultEventConfiguration = function() {
                    return {}
                }
                ,
                t
            }(uC), yC = ((nC = {})[Xi.BONUS_WORKER] = AA,
            nC[Xi.PIGGYBANK] = lC,
            nC[Xi.GOLDEN_CARROT] = NA,
            nC[Xi.GOLDEN_PUMPKIN] = FA,
            nC[Xi.GOLDEN_CHRISTMAS] = kA,
            nC[Xi.HALLOWEEN_SHOP] = mC,
            nC[Xi.CHRISTMAS_SHOP] = fC,
            nC[Xi.BLACK_FRIDAY_SHOP] = hC,
            nC[Xi.CHRISTMAS_DEALS_SHOP] = vC,
            nC), TC = ((rC = {})[Xi.BONUS_WORKER] = hn.EVENTS_CHOPCHOP,
            rC[Xi.PIGGYBANK] = hn.EVENTS_PIGGYBANK,
            rC[Xi.GOLDEN_CARROT] = hn.EVENTS_GOLDENCARROT,
            rC[Xi.GOLDEN_PUMPKIN] = hn.EVENTS_GOLDENPUMPKIN,
            rC[Xi.GOLDEN_CHRISTMAS] = hn.EVENTS_GOLDENCHRISTMAS,
            rC[Xi.HALLOWEEN_SHOP] = hn.EVENTS_GOLDENPUMPKIN,
            rC[Xi.CHRISTMAS_SHOP] = hn.EVENTS_GOLDENCHRISTMAS,
            rC[Xi.BLACK_FRIDAY_SHOP] = hn.EVENTS_BLACKFRIDAY,
            rC[Xi.CHRISTMAS_DEALS_SHOP] = hn.EVENTS_CHRISTMAS_DEALS,
            rC), AC = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._model = new fA,
                    t._eventInstances = new Map,
                    t._endedEventTimers = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "model", {
                    get: function() {
                        return this._model
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.isEventActive = function(e) {
                    return this._model.isEventActive(e)
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.registerModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.EVENTS)];
                            case 1:
                                return e.sent(),
                                [4, this._handleEndedEvents()];
                            case 2:
                                return e.sent(),
                                [4, this._handleActiveEvents()];
                            case 3:
                                return e.sent(),
                                De.services.timedEventFetcherService.eventStarted.addListener(this._onEventStarted, this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return De.services.autosave.unregisterModel(this._model),
                            this._eventInstances.forEach((function(t, i) {
                                t.destroy(),
                                i.onTimerFinished.removeListener(e._onEventTimerEnded, e)
                            }
                            )),
                            this._eventInstances.clear(),
                            De.services.timedEventFetcherService.eventStarted.removeListener(this._onEventStarted, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._handleEndedEvents = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._model.getEndedEvents().forEach((function(t) {
                                return (0,
                                n.__awaiter)(e, void 0, void 0, (function() {
                                    var e, i;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        switch (n.label) {
                                        case 0:
                                            if (e = this._model.getEventSavedData(t),
                                            (0,
                                            r.isUndefined)(e))
                                                throw new Error("No saved data found for event type ".concat(t));
                                            return [4, De.services.lazyLoad.prioritizeGroup(TC[t])];
                                        case 1:
                                            return n.sent(),
                                            (i = this._createEventInstance(t, e.eventConfiguration)).setSavedData(e),
                                            this._endEvent(i),
                                            [2]
                                        }
                                    }
                                    ))
                                }
                                ))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._handleActiveEvents = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o, a, s;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e = De.services.timedEventFetcherService.checkedForActiveEvents,
                                [4, De.services.timedEventFetcherService.fetchActiveTimedEvents()];
                            case 1:
                                t = n.sent(),
                                i = this._model.getActiveEvents(),
                                r = t.filter((function(e) {
                                    return !i.some((function(t) {
                                        return t.type === e.type && t.endTime === e.endTime
                                    }
                                    ))
                                }
                                )).concat(i),
                                o = 0,
                                a = r,
                                n.label = 2;
                            case 2:
                                return o < a.length ? (s = a[o],
                                [4, this._startEvent(s, !e)]) : [3, 5];
                            case 3:
                                n.sent(),
                                n.label = 4;
                            case 4:
                                return o++,
                                [3, 2];
                            case 5:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createEventInstance = function(e, t) {
                    return new (0,
                    yC[e])(this._model,this.services,t,this.services.hudService)
                }
                ,
                t.prototype._startEvent = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i, o, a, s, _, c, l, u, d = this;
                        return (0,
                        n.__generator)(this, (function(h) {
                            switch (h.label) {
                            case 0:
                                return (0,
                                r.isUndefined)(yC[e.type]) ? (this._logger.warn("Event type ".concat(e.type, " is not supported in this build!")),
                                [2]) : (this._logger.info("Attempting to start event ".concat(e.type, "... ")),
                                De.services.inventory.getAmount(An.LEVEL) < 6 ? (this._logger.warn("...unable to start event ".concat(e.type, ", player level is too low. Will start event on level up.")),
                                De.services.experience.onLevelUp.listenOnce((function() {
                                    return (0,
                                    n.__awaiter)(d, void 0, void 0, (function() {
                                        return (0,
                                        n.__generator)(this, (function(t) {
                                            return this._startEvent(e, !0),
                                            [2]
                                        }
                                        ))
                                    }
                                    ))
                                }
                                ), this),
                                [3, 7]) : [3, 1]);
                            case 1:
                                return this._logger.info("...starting event, ".concat(e.type)),
                                [4, De.services.lazyLoad.prioritizeGroup(TC[e.type])];
                            case 2:
                                return h.sent(),
                                i = this._createEventInstance(e.type, e.eventConfigurationData),
                                o = this._model.getEventSavedData(e.type),
                                a = void 0,
                                s = !1,
                                (0,
                                r.isUndefined)(o) ? (_ = e.endTime,
                                [4, De.services.timer.currentServerTime]) : [3, 5];
                            case 3:
                                return c = h.sent(),
                                l = Date.now() - c,
                                a = De.services.timer.addTimer(_ + l - Date.now(), e.type),
                                u = {},
                                [4, i.createDefaultEventSavedData()];
                            case 4:
                                return u.eventData = h.sent(),
                                u.eventConfiguration = i.eventConfiguration,
                                u.startTime = e.startTime,
                                u.endTime = e.endTime,
                                u.timerId = a.id,
                                o = u,
                                s = !0,
                                this._model.setEventSavedData(e.type, o),
                                [3, 6];
                            case 5:
                                a = De.services.timer.getTimerByID(o.timerId),
                                h.label = 6;
                            case 6:
                                i.setSavedData(o),
                                i.startEvent(s, t),
                                a.onTimerFinished.addListener(this._onEventTimerEnded, this),
                                this._eventInstances.set(a, i),
                                h.label = 7;
                            case 7:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onEventStarted = function(e) {
                    this._model.isEventActive(e.type) ? this._logger.error("Event ".concat(e.type, " is already active.")) : this._startEvent(e, !0)
                }
                ,
                t.prototype._endEvent = function(e) {
                    e.endEvent()
                }
                ,
                t.prototype._onEventTimerEnded = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return t.sent(),
                                this.services.onboarding.activeTrackKey ? (this._endedEventTimers.push(e),
                                De.services.onboardingGameService.onInteractionReadyEvent.addListener(this._onInteractionReady, this),
                                this.services.onboarding.onTrackCanceled.addListener(this._onInteractionReady, this),
                                [2]) : (this._endEvent(this._eventInstances.get(e)),
                                e.onTimerFinished.removeListener(this._onEventTimerEnded, this),
                                this._eventInstances.delete(e),
                                [2])
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onInteractionReady = function() {
                    var e = this;
                    De.services.onboardingGameService.onInteractionReadyEvent.removeListener(this._onInteractionReady, this),
                    this.services.onboarding.onTrackCanceled.removeListener(this._onInteractionReady, this),
                    this._endedEventTimers.forEach((function(t) {
                        e._onEventTimerEnded(t)
                    }
                    )),
                    this._endedEventTimers = []
                }
                ,
                t
            }(Go), CC = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getTrainStationIncentiviseButtons = function() {
                    return []
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), IC = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._version = 2,
                    t._name = "MarketplaceModel",
                    t._stock = {},
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.setStock = function(e, t) {
                    this._stock[e] = t,
                    this.saveData()
                }
                ,
                t.prototype.getStock = function(e) {
                    var t;
                    return null !== (t = this._stock[e]) && void 0 !== t ? t : -1
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._stock = (0,
                    n.__assign)({}, e.stock)
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        stock: (0,
                        n.__assign)({}, this._stock)
                    }
                }
                ,
                t
            }($n), SC = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, {
                                result: $_.SUCCESS,
                                reason: "SUCCESS"
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(rc), OC = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.dependencies.inventory.hasEnoughItems([this.dependencies.cost]) ? (this.dependencies.inventory.deductItems([this.dependencies.cost]),
                            [2, {
                                result: $_.SUCCESS,
                                reason: "SUCCESS"
                            }]) : [2, {
                                result: $_.FAIL,
                                reason: "INSUFFICIENT_ITEMS"
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(rc), bC = function(e) {
                function t(t, i, n) {
                    var r = e.call(this) || this;
                    return r._additionalText = new v.Label(""),
                    r._errorAnimationTimeline = lr.gsap.timeline(),
                    r._services = n,
                    r._config = t,
                    r._size = i,
                    r._createMainUI(),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.disableButton = function() {
                    this._button.disable()
                }
                ,
                t.prototype.enableButton = function() {
                    this._button.enable()
                }
                ,
                t.prototype._errorAnimation = function(e) {
                    var t = e.onComplete
                      , i = e.objectToAnimate;
                    if (!this._errorAnimationTimeline.isActive()) {
                        var n = i.transform.position.x
                          , r = i.alpha;
                        i.alpha = .4;
                        this._errorAnimationTimeline.clear(),
                        this._errorAnimationTimeline.add(lr.gsap.to(i.transform.position, {
                            x: n + 20,
                            duration: .075
                        })),
                        this._errorAnimationTimeline.add(lr.gsap.to(i.transform.position, {
                            x: n - 20,
                            duration: .15
                        })),
                        this._errorAnimationTimeline.add(lr.gsap.to(i.transform.position, {
                            x: n,
                            duration: .075
                        })),
                        this._errorAnimationTimeline.add(lr.gsap.to(i.transform.position, {
                            x: n,
                            duration: .3,
                            onComplete: function() {
                                i.alpha = r,
                                i.transform.position.x = n,
                                t()
                            }
                        })),
                        this._errorAnimationTimeline.play()
                    }
                }
                ,
                t.prototype._createMainUI = function() {
                    if (this._productImage = this.addChild(rr(De.services.resource.getSprite({
                        alias: this._config.image
                    }), {
                        position: {
                            x: 0,
                            y: 0
                        },
                        anchor: {
                            x: 0,
                            y: 0
                        }
                    })),
                    ns(this._config.reward)) {
                        if (this._stickerContainer = this.addChild(new Xe.Container),
                        !this._config.isBestDeal) {
                            var e = new v.LabelSettings({
                                fitToBox: !0,
                                fitHeight: 100,
                                fitWidth: this._config.sale ? 130 : 80
                            });
                            if (e.style = vn[this._config.starTextStyle],
                            this._stickerText = rr(new v.Label("x".concat(this._config.reward.data.amount),e), {
                                anchor: {
                                    x: .5,
                                    y: .5
                                }
                            }),
                            this._stickerContainer.addChild(this._stickerText),
                            this._config.sale) {
                                var t = new v.LabelSettings({
                                    fitToBox: !0,
                                    fitHeight: 100,
                                    fitWidth: 130
                                });
                                t.style = vn[this._config.starTextStyle],
                                this._stickerContainer.addChild(rr(new v.Label(nr(oC || (oC = (0,
                                n.__makeTemplateObject)(["", ""], ["", ""])), Qa[this._config.reward.data.key]).toUpperCase(),t), {
                                    anchor: {
                                        x: .5,
                                        y: .5
                                    },
                                    position: {
                                        x: 0,
                                        y: 50
                                    }
                                }))
                            }
                        }
                        this._stickerContainer.position.x = 100,
                        this._stickerContainer.position.y = 100,
                        this.recreateSticker()
                    }
                    this.createAdditionalText(),
                    this.createButton()
                }
                ,
                t
            }(Xe.Container), RC = {
                width: 250,
                height: 80
            }, wC = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onButtonClicked = function(e) {
                    this._button.onClick(e)
                }
                ,
                t.prototype.insufficientFundsAnimation = function(e) {
                    this._errorAnimation({
                        objectToAnimate: this._button,
                        onComplete: e
                    })
                }
                ,
                t.prototype.recreateSticker = function() {
                    if (this._config.isBestDeal && this._stickerContainer) {
                        var e = new v.LabelSettings({
                            fitToBox: !0,
                            fitHeight: 100,
                            fitWidth: 120
                        });
                        e.style = vn.darkOrangeLarge,
                        this._stickerText = rr(new v.Label("x".concat(this._config.reward.data.amount),e), {
                            anchor: {
                                x: .5,
                                y: .5
                            }
                        }),
                        this._stickerText.position.set(20, 50),
                        this._stickerContainer.addChild(this._stickerText);
                        var t = new v.LabelSettings({
                            fitToBox: !0,
                            fitHeight: 95,
                            fitWidth: 140
                        });
                        t.style = vn[this._config.starTextStyle],
                        t.style.leading = 5;
                        var i = new v.Label(nr(aC || (aC = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.MARKETPLACE_BEST_DEAL),t);
                        i.position.set(12.5, -20),
                        i.anchor.set(.5),
                        i.rotation = -.2,
                        this._stickerContainer.addChild(i)
                    }
                }
                ,
                t.prototype.createAdditionalText = function() {}
                ,
                t.prototype.createButton = function() {
                    this._buttonPosition = {
                        x: 10 + RC.width / 2,
                        y: this._productImage.height - (10 + RC.height / 2)
                    },
                    this._config.payment.type === Ma.IAP ? this._createIAPButton() : this._createInventoryButton()
                }
                ,
                t.prototype._createIAPButton = function() {
                    var e, t, i, n, r, o;
                    if ($a(this._config)) {
                        var a = this._config.payment.productId
                          , s = De.services.iap.catalog.find((function(e) {
                            return e.sku === a
                        }
                        ))
                          , _ = s ? s.price.formattedAmount : ce.BUTTON_UNAVAILABLE;
                        vp.platform.loginStrategy.isUserLoggedIn() || (_ = "$ ".concat(this._config.payment.trackingValue)),
                        this._button = new fr({
                            name: "purchaseIAP-".concat(this._config.id),
                            buttonIdle: (null === (e = this._config.customButtonAssets) || void 0 === e ? void 0 : e.idle) ? null === (t = this._config.customButtonAssets) || void 0 === t ? void 0 : t.idle : f.BTN_DEFAULT_GREEN_IDLE,
                            buttonActive: (null === (i = this._config.customButtonAssets) || void 0 === i ? void 0 : i.active) ? null === (n = this._config.customButtonAssets) || void 0 === n ? void 0 : n.active : f.BTN_DEFAULT_GREEN_ACTIVE,
                            buttonInactive: (null === (r = this._config.customButtonAssets) || void 0 === r ? void 0 : r.inactive) ? null === (o = this._config.customButtonAssets) || void 0 === o ? void 0 : o.inactive : f.BTN_DEFAULT_GREY_INACTIVE
                        },{
                            buttonSizes: RC
                        },{
                            textStyle: this._config.customButtonTextStyle ? vn[this._config.customButtonTextStyle] : vn.buttonLabel,
                            text: _,
                            position: {
                                x: 0,
                                y: -7
                            }
                        }),
                        this._button.position.set(this._buttonPosition.x, this._buttonPosition.y),
                        !s && vp.platform.loginStrategy.isUserLoggedIn() && this._button.disable(),
                        this.addChild(this._button)
                    }
                }
                ,
                t.prototype._createInventoryButton = function() {
                    var e, t, i, n, r, o;
                    es(this._config) && (this._button = new uc({
                        name: "purchaseInventory-".concat(this._config.id),
                        buttonIdle: (null === (e = this._config.customButtonAssets) || void 0 === e ? void 0 : e.idle) ? null === (t = this._config.customButtonAssets) || void 0 === t ? void 0 : t.idle : f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: (null === (i = this._config.customButtonAssets) || void 0 === i ? void 0 : i.active) ? null === (n = this._config.customButtonAssets) || void 0 === n ? void 0 : n.active : f.BTN_DEFAULT_BLUE_ACTIVE,
                        buttonInactive: (null === (r = this._config.customButtonAssets) || void 0 === r ? void 0 : r.inactive) ? null === (o = this._config.customButtonAssets) || void 0 === o ? void 0 : o.inactive : f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: RC
                    },{
                        text: this._config.payment.amount.toString(),
                        textStyle: this._config.customButtonTextStyle ? vn[this._config.customButtonTextStyle] : vn.buttonLabel,
                        alignment: "left",
                        position: {
                            x: 0,
                            y: -5
                        }
                    },{
                        iconImage: f.ICON_BTN_GEM,
                        iconAlignment: "right",
                        iconPosition: {
                            x: -10,
                            y: -5
                        }
                    }),
                    this._button.position.set(this._buttonPosition.x, this._buttonPosition.y),
                    this.addChild(this._button))
                }
                ,
                t
            }(bC), DC = {
                width: 300,
                height: 80
            }, NC = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createButton = function() {
                    this._config.payment.type === Ma.IAP ? this._createIAPButton() : this._config.payment.type === Ma.Inventory && this._createInventoryButton(),
                    this._button.position.set(10 + DC.width / 2, this._productImage.height - (10 + DC.height / 2))
                }
                ,
                t.prototype._createInventoryButton = function() {
                    var e, t, i, n, r, o;
                    es(this._config) && (this._services.marketplaceService.isLimitedItemPurchased(this._config) ? (this._button = new fr({
                        name: "_claimButton",
                        buttonIdle: f.BTN_DEFAULT_GREY_INACTIVE,
                        buttonActive: f.BTN_DEFAULT_GREY_INACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: DC
                    },{
                        text: ce.MARKETPLACE_LIMITED_ITEM_PURCHASED,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        },
                        alignment: "center",
                        fitBoxSizes: {
                            width: 190,
                            height: 75
                        }
                    }),
                    this._button.disable()) : this._button = new uc({
                        name: "purchaseInventory-".concat(this._config.id),
                        buttonIdle: (null === (e = this._config.customButtonAssets) || void 0 === e ? void 0 : e.idle) ? null === (t = this._config.customButtonAssets) || void 0 === t ? void 0 : t.idle : f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: (null === (i = this._config.customButtonAssets) || void 0 === i ? void 0 : i.active) ? null === (n = this._config.customButtonAssets) || void 0 === n ? void 0 : n.active : f.BTN_DEFAULT_BLUE_ACTIVE,
                        buttonInactive: (null === (r = this._config.customButtonAssets) || void 0 === r ? void 0 : r.inactive) ? null === (o = this._config.customButtonAssets) || void 0 === o ? void 0 : o.inactive : f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: DC
                    },{
                        text: this._config.payment.amount.toString(),
                        textStyle: vn.buttonLabel,
                        alignment: "left",
                        position: {
                            x: 0,
                            y: -5
                        }
                    },{
                        iconImage: f.ICON_BTN_GEM,
                        iconAlignment: "right",
                        iconPosition: {
                            x: -10,
                            y: -5
                        }
                    }),
                    this.addChild(this._button))
                }
                ,
                t.prototype._createIAPButton = function() {
                    var e, t, i, n, r, o;
                    if ($a(this._config)) {
                        var a = this._config.payment.productId
                          , s = De.services.iap.catalog.find((function(e) {
                            return e.sku === a
                        }
                        ));
                        if (this._services.marketplaceService.isLimitedItemPurchased(this._config))
                            this._button = new fr({
                                name: "_button",
                                buttonIdle: f.BTN_DEFAULT_GREY_INACTIVE,
                                buttonActive: f.BTN_DEFAULT_GREY_INACTIVE,
                                buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                            },{
                                buttonSizes: DC
                            },{
                                text: ce.MARKETPLACE_LIMITED_ITEM_PURCHASED,
                                textStyle: vn.buttonLabel,
                                position: {
                                    x: 0,
                                    y: -5
                                },
                                alignment: "center",
                                fitBoxSizes: {
                                    width: 190,
                                    height: 75
                                }
                            }),
                            this._button.disable();
                        else {
                            var _ = s ? s.price.formattedAmount : ce.BUTTON_UNAVAILABLE;
                            vp.platform.loginStrategy.isUserLoggedIn() || (_ = "$ ".concat(this._config.payment.trackingValue)),
                            this._button = new fr({
                                name: "purchaseIAP-".concat(this._config.id),
                                buttonIdle: (null === (e = this._config.customButtonAssets) || void 0 === e ? void 0 : e.idle) ? null === (t = this._config.customButtonAssets) || void 0 === t ? void 0 : t.idle : f.BTN_DEFAULT_GREEN_IDLE,
                                buttonActive: (null === (i = this._config.customButtonAssets) || void 0 === i ? void 0 : i.active) ? null === (n = this._config.customButtonAssets) || void 0 === n ? void 0 : n.active : f.BTN_DEFAULT_GREEN_ACTIVE,
                                buttonInactive: (null === (r = this._config.customButtonAssets) || void 0 === r ? void 0 : r.inactive) ? null === (o = this._config.customButtonAssets) || void 0 === o ? void 0 : o.inactive : f.BTN_DEFAULT_GREY_INACTIVE
                            },{
                                buttonSizes: DC
                            },{
                                textStyle: vn.buttonLabel,
                                text: _,
                                position: {
                                    x: 0,
                                    y: -5
                                }
                            }),
                            !s && vp.platform.loginStrategy.isUserLoggedIn() && this._button.disable()
                        }
                    }
                    this.addChild(this._button)
                }
                ,
                t
            }(wC), LC = {
                width: 300,
                height: 130
            }, BC = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onButtonClicked = function(e) {
                    this._button.onClick(e)
                }
                ,
                t.prototype.insufficientFundsAnimation = function(e) {
                    this._errorAnimation({
                        objectToAnimate: this._button,
                        onComplete: e
                    })
                }
                ,
                t.prototype.recreateSticker = function() {
                    this._stickerContainer && (this._stickerContainer.position.set(125, this._productImage.height / 2 + 178),
                    this._stickerContainer.rotation = -.2)
                }
                ,
                t.prototype.createAdditionalText = function() {
                    if (this._config.sale) {
                        var e = new v.LabelSettings({
                            fitToBox: !0,
                            fitHeight: 80,
                            fitWidth: this._productImage.width - 50
                        });
                        e.style = vn[this._config.sale.bannerStyle],
                        this._additionalText = new v.Label(nr(sC || (sC = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), this._config.sale.bannerText),e),
                        this._additionalText.position.set(this._productImage.width / 2, 160),
                        this._additionalText.anchor.set(.5, .5),
                        this.addChild(this._additionalText)
                    }
                }
                ,
                t.prototype.createButton = function() {
                    this._buttonPosition = {
                        x: this._productImage.width / 2,
                        y: this._productImage.height - (30 + LC.height / 2)
                    },
                    this._config.payment.type === Ma.IAP ? this._createIAPButton() : this._createInventoryButton()
                }
                ,
                t.prototype._createIAPButton = function() {
                    var e, t, i, n, o, a, s, _;
                    if ($a(this._config)) {
                        var c = this._config.payment.productId
                          , l = De.services.iap.catalog.find((function(e) {
                            return e.sku === c
                        }
                        ))
                          , u = l ? l.price.formattedAmount : ce.BUTTON_UNAVAILABLE;
                        vp.platform.loginStrategy.isUserLoggedIn() || (u = "$ ".concat(this._config.payment.trackingValue));
                        var d = new Xe.Container
                          , h = !(0,
                        r.isUndefined)(l) && !(0,
                        r.isUndefined)(this._getDiscountPrice());
                        if (h) {
                            var p = this._getDiscountPrice()
                              , g = new v.LabelSettings({
                                fitToBox: !0,
                                fitHeight: 80,
                                fitWidth: 120
                            });
                            g.style = (null === (e = this._config.sale) || void 0 === e ? void 0 : e.discountStyle) ? vn[null === (t = this._config.sale) || void 0 === t ? void 0 : t.discountStyle] : vn.darkGreenMedium,
                            d.addChild(new v.Label(p,g)).anchor.set(.5),
                            d.addChild(rr(De.services.resource.getSprite(f.UI_BTN_PRICE_LINE), {
                                anchor: {
                                    x: .5,
                                    y: .5
                                }
                            })),
                            d.position.set(0, -35),
                            d.alpha = .5
                        }
                        this._button = new fr({
                            name: "purchaseIAP-".concat(this._config.id),
                            buttonIdle: (null === (i = this._config.customButtonAssets) || void 0 === i ? void 0 : i.idle) ? null === (n = this._config.customButtonAssets) || void 0 === n ? void 0 : n.idle : f.BTN_DEFAULT_GREEN_IDLE,
                            buttonActive: (null === (o = this._config.customButtonAssets) || void 0 === o ? void 0 : o.active) ? null === (a = this._config.customButtonAssets) || void 0 === a ? void 0 : a.active : f.BTN_DEFAULT_GREEN_ACTIVE,
                            buttonInactive: (null === (s = this._config.customButtonAssets) || void 0 === s ? void 0 : s.inactive) ? null === (_ = this._config.customButtonAssets) || void 0 === _ ? void 0 : _.inactive : f.BTN_DEFAULT_GREY_INACTIVE
                        },{
                            buttonSizes: LC
                        },{
                            textStyle: this._config.customButtonTextStyle ? vn[this._config.customButtonTextStyle] : vn.buttonLabel,
                            text: u,
                            position: {
                                x: 0,
                                y: h ? 17 : -5
                            }
                        },d),
                        this._button.position.set(this._buttonPosition.x, this._buttonPosition.y),
                        !l && vp.platform.loginStrategy.isUserLoggedIn() && this._button.disable(),
                        this.addChild(this._button)
                    }
                }
                ,
                t.prototype._createInventoryButton = function() {
                    var e, t, i, n, r, o;
                    es(this._config) && (this._button = new uc({
                        name: "purchaseInventory-".concat(this._config.id),
                        buttonIdle: (null === (e = this._config.customButtonAssets) || void 0 === e ? void 0 : e.idle) ? null === (t = this._config.customButtonAssets) || void 0 === t ? void 0 : t.idle : f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: (null === (i = this._config.customButtonAssets) || void 0 === i ? void 0 : i.active) ? null === (n = this._config.customButtonAssets) || void 0 === n ? void 0 : n.active : f.BTN_DEFAULT_BLUE_ACTIVE,
                        buttonInactive: (null === (r = this._config.customButtonAssets) || void 0 === r ? void 0 : r.inactive) ? null === (o = this._config.customButtonAssets) || void 0 === o ? void 0 : o.inactive : f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: LC
                    },{
                        text: this._config.payment.amount.toString(),
                        textStyle: this._config.customButtonTextStyle ? vn[this._config.customButtonTextStyle] : vn.buttonLabel,
                        alignment: "left",
                        position: {
                            x: 0,
                            y: -5
                        }
                    },{
                        iconImage: f.ICON_BTN_GEM,
                        iconAlignment: "right",
                        iconPosition: {
                            x: -10,
                            y: -5
                        }
                    }),
                    this._button.position.set(this._buttonPosition.x, this._buttonPosition.y),
                    this.addChild(this._button))
                }
                ,
                t.prototype._getDiscountPrice = function() {
                    var e, t = null === (e = this._config.sale) || void 0 === e ? void 0 : e.discountComparison, i = De.services.iap.catalog.find((function(e) {
                        return e.sku === t
                    }
                    ));
                    if (i)
                        return i.price.formattedAmount;
                    r.Logger.Of("ShopItemSale").warn("Product with id ".concat(t, " not found, cannot display pre-discount price."))
                }
                ,
                t
            }(bC), PC = {
                width: 300,
                height: 130
            }, kC = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createButton = function() {
                    this._buttonPosition = {
                        x: this._productImage.width / 2,
                        y: this._productImage.height - (30 + PC.height / 2)
                    },
                    this._config.payment.type === Ma.IAP ? this._createIAPButton() : this._config.payment.type === Ma.Inventory && this._createInventoryButton(),
                    this._button.position.set(this._buttonPosition.x, this._buttonPosition.y)
                }
                ,
                t.prototype._createInventoryButton = function() {
                    es(this._config) && (this._services.marketplaceService.isLimitedItemPurchased(this._config) ? (this._button = new fr({
                        name: "_button",
                        buttonIdle: f.BTN_DEFAULT_GREY_INACTIVE,
                        buttonActive: f.BTN_DEFAULT_GREY_INACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: PC
                    },{
                        text: ce.MARKETPLACE_LIMITED_ITEM_PURCHASED,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        },
                        alignment: "center",
                        fitBoxSizes: {
                            width: 190,
                            height: 75
                        }
                    }),
                    this._button.disable()) : this._button = new uc({
                        name: "purchaseInventory-".concat(this._config.id),
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE
                    },{
                        buttonSizes: PC
                    },{
                        text: this._config.payment.amount.toString(),
                        textStyle: vn.buttonLabel,
                        alignment: "left",
                        position: {
                            x: 0,
                            y: -5
                        }
                    },{
                        iconImage: f.ICON_BTN_GEM,
                        iconAlignment: "right",
                        iconPosition: {
                            x: -10,
                            y: -5
                        }
                    })),
                    this.addChild(this._button)
                }
                ,
                t.prototype._createIAPButton = function() {
                    var e, t, i, n, o, a, s, _;
                    if ($a(this._config)) {
                        var c = this._config.payment.productId
                          , l = De.services.iap.catalog.find((function(e) {
                            return e.sku === c
                        }
                        ));
                        if (this._services.marketplaceService.isLimitedItemPurchased(this._config))
                            this._button = new fr({
                                name: "_button",
                                buttonIdle: f.BTN_DEFAULT_GREY_INACTIVE,
                                buttonActive: f.BTN_DEFAULT_GREY_INACTIVE,
                                buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                            },{
                                buttonSizes: PC
                            },{
                                text: ce.MARKETPLACE_LIMITED_ITEM_PURCHASED,
                                textStyle: vn.buttonLabel,
                                position: {
                                    x: 0,
                                    y: -5
                                },
                                alignment: "center",
                                fitBoxSizes: {
                                    width: 190,
                                    height: 75
                                }
                            }),
                            this._button.disable();
                        else {
                            var u = l ? l.price.formattedAmount : ce.BUTTON_UNAVAILABLE;
                            vp.platform.loginStrategy.isUserLoggedIn() || (u = "$ ".concat(this._config.payment.trackingValue));
                            var d = new Xe.Container
                              , h = !(0,
                            r.isUndefined)(l) && !(0,
                            r.isUndefined)(this._getDiscountPrice());
                            if (h) {
                                var p = this._getDiscountPrice()
                                  , g = new v.LabelSettings({
                                    fitToBox: !0,
                                    fitHeight: 80,
                                    fitWidth: 120
                                });
                                g.style = (null === (e = this._config.sale) || void 0 === e ? void 0 : e.discountStyle) ? vn[null === (t = this._config.sale) || void 0 === t ? void 0 : t.discountStyle] : vn.darkGreenMedium,
                                d.addChild(new v.Label(p,g)).anchor.set(.5),
                                d.addChild(rr(De.services.resource.getSprite(f.UI_BTN_PRICE_LINE), {
                                    anchor: {
                                        x: .5,
                                        y: .5
                                    }
                                })),
                                d.position.set(0, -35)
                            }
                            this._button = new fr({
                                name: "purchaseIAP-".concat(this._config.id),
                                buttonIdle: (null === (i = this._config.customButtonAssets) || void 0 === i ? void 0 : i.idle) ? null === (n = this._config.customButtonAssets) || void 0 === n ? void 0 : n.idle : f.BTN_DEFAULT_GREEN_IDLE,
                                buttonActive: (null === (o = this._config.customButtonAssets) || void 0 === o ? void 0 : o.active) ? null === (a = this._config.customButtonAssets) || void 0 === a ? void 0 : a.active : f.BTN_DEFAULT_GREEN_ACTIVE,
                                buttonInactive: (null === (s = this._config.customButtonAssets) || void 0 === s ? void 0 : s.inactive) ? null === (_ = this._config.customButtonAssets) || void 0 === _ ? void 0 : _.inactive : f.BTN_DEFAULT_GREY_INACTIVE
                            },{
                                buttonSizes: PC
                            },{
                                textStyle: vn.buttonLabel,
                                text: u,
                                position: {
                                    x: 0,
                                    y: h ? 17 : -5
                                }
                            },d),
                            !l && vp.platform.loginStrategy.isUserLoggedIn() && this._button.disable()
                        }
                    }
                    this.addChild(this._button)
                }
                ,
                t
            }(BC), xC = i(9538);
            !function(e) {
                e[e.COMPLETED = 0] = "COMPLETED",
                e[e.IN_PROGRESS = 1] = "IN_PROGRESS"
            }(_C || (_C = {}));
            var GC, UC, FC, MC, VC, HC, jC, KC, WC, zC = function(e) {
                function t(t, i, n, r) {
                    var o, a, s = this;
                    (s = e.call(this, t, i, n) || this).timerState = _C.COMPLETED,
                    s._timeIcon = De.services.resource.getSprite(f.ICON_TIMER),
                    s._notification = De.services.resource.getSpine(se.NOTIFICATION_ATTENTION),
                    s._buttonProperties = t,
                    s._timerProperties = r,
                    s._textProperties = n,
                    s._timeIcon.anchor.set(0, .5),
                    s._timeIcon.position.set(-s.width / 2 + 15, -5),
                    s._baseIcon = r.icon ? De.services.resource.getSprite(r.icon) : void 0,
                    null === (o = s._baseIcon) || void 0 === o || o.anchor.set(0, .5),
                    null === (a = s._baseIcon) || void 0 === a || a.position.set(-s.width / 2 + 15, -2),
                    s._baseIcon && s.addContent(s._baseIcon);
                    var _ = new v.LabelSettings({
                        fitHeight: 90,
                        fitWidth: 300,
                        fitToBox: !0
                    });
                    _.style = vn.lightMedium;
                    var c = new v.Label("00H 00M 00S",_);
                    return c.position.y = 0,
                    s._timerLabel = c,
                    s._updateLabelToText(),
                    s._notification.position.set(s.width / 2, -20),
                    s.enable(),
                    s._timerProperties.hasNotification && s._showNotification(),
                    s
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t)
                }
                ,
                t.prototype.setTimer = function(e) {
                    this.addContent(this._timeIcon),
                    this._baseIcon && this.removeContent(this._baseIcon),
                    this.timerState = _C.IN_PROGRESS,
                    this.updateTimeLabel(e);
                    var t = new Xe.Point(25,-5);
                    this.updateText(this._timerLabel.text, t),
                    this.disable(),
                    this._timerProperties.hasNotification && this._hideNotification()
                }
                ,
                t.prototype.onTimerCompleted = function() {
                    this.removeContent(this._timeIcon),
                    this.timerState = _C.COMPLETED,
                    this._updateLabelToText(),
                    this.updateButtonTexture(this._buttonProperties.buttonIdle, this._buttonProperties.buttonActive),
                    this.enable(),
                    this._timerProperties.hasNotification && this._showNotification()
                }
                ,
                t.prototype.updateTimeLabel = function(e) {
                    var t = e.remainingTime;
                    this._timerLabel.text = r.StringUtility.formatMilliseconds(t, {
                        showSecondsBelowMilliseconds: 36e5,
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        }
                    }),
                    this.updateText(this._timerLabel.text)
                }
                ,
                t.prototype._updateLabelToText = function() {
                    this._baseIcon && this.addContent(this._baseIcon),
                    (0,
                    r.isString)(this._textProperties.text) ? this._timerLabel.text = this._textProperties.text : this._timerLabel.text = nr(GC || (GC = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), this._textProperties.text);
                    var e = this._baseIcon ? this._baseIcon.width / 2 : 0
                      , t = new Xe.Point(e,-5);
                    this.updateText(this._timerLabel.text, t)
                }
                ,
                t.prototype._showNotification = function() {
                    this._notification.state.setAnimation(0, V.NOTIFICATION_EXCLAMATIONMARK, !0),
                    this.addChild(this._notification)
                }
                ,
                t.prototype._hideNotification = function() {
                    this._notification.state.clearTracks(),
                    this.removeChild(this._notification)
                }
                ,
                t
            }(fr), YC = {
                width: 300,
                height: 80
            }, JC = {
                width: 250,
                height: 80
            }, XC = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onButtonClicked = function(e) {
                    this._onButtonClickedCallback = e,
                    this._button.onClick(e)
                }
                ,
                t.prototype.insufficientFundsAnimation = function(e) {
                    this._errorAnimation({
                        objectToAnimate: this._button,
                        onComplete: e
                    })
                }
                ,
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this, t),
                    this._removeTimer()
                }
                ,
                t.prototype.recreateSticker = function() {}
                ,
                t.prototype.createAdditionalText = function() {
                    var e = new xC.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 200,
                        fitWidth: this._size.width - 50
                    });
                    if (this._config.renewable && this._config.renewable.amount > 1) {
                        var t = this._services.stockItem.amount;
                        e.style = t > 0 ? vn.darkExtraSmall : vn.brightRedExtraSmall,
                        this._rvAmountText = new v.Label(t.toString(),e),
                        this._rvAmountText.position.set(this._productImage.width - 20, 12),
                        this._rvAmountText.anchor.set(1, 0),
                        this.addChild(this._rvAmountText),
                        e.style = vn.darkExtraSmall,
                        this._rvLeftText = new v.Label(nr(UC || (UC = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.MARKETPLACE_RV_LEFT),e),
                        this._rvLeftText.position.set(this._rvAmountText.x - (this._rvAmountText.width + 5), 12),
                        this._rvLeftText.anchor.set(1, 0),
                        this.addChild(this._rvLeftText)
                    }
                }
                ,
                t.prototype.createButton = function() {
                    var e;
                    this._config.renewable && (Za(this._config) && !De.services.adsService.isRewardedAdsSupported() ? this._button = this._getUnavailableButton() : (this._button = new zC({
                        name: "purchaseTime_".concat(this._config.id),
                        buttonIdle: this._config.renewable.buttonInactive,
                        buttonActive: this._config.renewable.buttonActive,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: YC
                    },{
                        text: this._config.renewable.buttonText,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        },
                        alignment: "center",
                        fitBoxSizes: {
                            width: 190,
                            height: 75
                        }
                    },{
                        hasNotification: (e = this._config,
                        e.payment.type === Ma.FREE),
                        icon: Za(this._config) ? f.ICON_BTN_VIDEO_WHITE : void 0
                    }),
                    this._button.position.set(10 + YC.width / 2, this._productImage.height - (10 + YC.height / 2))),
                    this.addChild(this._button),
                    this._services.stockItem.onChanged.addListener(this._updateItemState, this),
                    this._updateItemState())
                }
                ,
                t.prototype._getUnavailableButton = function() {
                    var e = new zC({
                        name: "purchaseTime_".concat(this._config.id),
                        buttonIdle: f.BTN_DEFAULT_GREY_INACTIVE,
                        buttonActive: f.BTN_DEFAULT_GREY_INACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: JC
                    },{
                        text: ce.BUTTON_UNAVAILABLE,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -7
                        },
                        alignment: "center"
                    },{
                        hasNotification: !1,
                        icon: void 0
                    });
                    return e.position.set(10 + JC.width / 2, this._productImage.height - (10 + YC.height / 2)),
                    e.disable(),
                    e
                }
                ,
                t.prototype._updateItemState = function() {
                    var e = this._services.stockItem
                      , t = e.amount
                      , i = t <= 0
                      , n = De.services.resourceRegeneration.getGenerator(e.key).timerId;
                    ge(n) || (this._timer = De.services.timer.getTimerByID(n),
                    i && (this._button.setTimer(this._timer),
                    this._timer.onUpdate.addListener(this._button.updateTimeLabel, this._button)),
                    this._timer.onTimerFinished.addListener(this._onTimerFinished, this)),
                    this._stickerContainer && (this._stickerContainer.alpha = i ? .5 : 1),
                    this._productImage.alpha = i ? .5 : 1,
                    this._additionalText.alpha = i ? .5 : 1,
                    this._updateRvAmountText(t)
                }
                ,
                t.prototype._updateRvAmountText = function(e) {
                    this._config.renewable && this._config.renewable.amount > 1 && this._rvAmountText && (this._rvAmountText.text = e.toString(),
                    this._rvAmountText.style = e > 0 ? vn.darkExtraSmall : vn.brightRedExtraSmall)
                }
                ,
                t.prototype._onTimerFinished = function() {
                    this._button.onTimerCompleted(),
                    this._button.onClick(this._onButtonClickedCallback),
                    this._removeTimer(),
                    this._updateItemState()
                }
                ,
                t.prototype._removeTimer = function() {
                    this._timer && (this._timer.onUpdate.removeListener(this._button.updateTimeLabel, this._button),
                    this._timer.onTimerFinished.removeListener(this._onTimerFinished, this),
                    this._timer = void 0)
                }
                ,
                t
            }(bC), qC = function(e) {
                function t(t, i, n, o, a, s, _) {
                    var c = e.call(this, t) || this;
                    return c._scrollContainers = new Map,
                    c._logger = r.Logger.Of("MarketplaceTabGroup"),
                    c._tabOptions = t,
                    c._data = t.data,
                    c._marketplaceService = i,
                    c._mapGridView = n,
                    c._storageBubbleService = o,
                    c._rewardService = a,
                    c._popup = s,
                    c._addTabContents(),
                    c.switchToTab(_),
                    c
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.destroy = function(t) {
                    e.prototype.destroy.call(this),
                    this._removeScrollablesFromUpdateables()
                }
                ,
                t.prototype._spawnNotEnoughGemsTextFloater = function() {
                    var e = new Xe.Point(0,0)
                      , t = vn.warningText;
                    t.fontSize = 80;
                    var i = nr(FC || (FC = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.RESOURCE_GEMS)
                      , r = nr(MC || (MC = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.INSUFFICIENT_RESOURCES, i);
                    new rf(De.services.navigation.layers.popup.container,e,{
                        styles: t,
                        text: r
                    })
                }
                ,
                t.prototype._addTabContents = function() {
                    var e = this;
                    this._data.forEach((function(t) {
                        if (0 !== t.items.length) {
                            var i, n = e._filterMarketplaceFieldData(t.items), r = e._createScrollableContainer(t.name), o = 0;
                            n.forEach((function(t) {
                                t.sale ? (i = e._createSaleField(t)).position.set(0, 0) : ((i = e._createField(t)).position.set(494, o),
                                o = o + 306 + 20),
                                r.container.addContent(i)
                            }
                            )),
                            e.addTabContent(t.name, r.container),
                            e.addTabContent(t.name, r.mask)
                        }
                    }
                    )),
                    this._addScrollablesToUpdateables()
                }
                ,
                t.prototype._filterMarketplaceFieldData = function(e) {
                    return e.find((function(e) {
                        return ts(e)
                    }
                    )) ? e.filter((function(e) {
                        return De.services.adsService.isRewardedAdsSupported() && !ts(e) || !De.services.adsService.isRewardedAdsSupported() && !Za(e)
                    }
                    )) : e
                }
                ,
                t.prototype._createScrollableContainer = function(e) {
                    var t = new v.ScrollableContainer({
                        friction: .8,
                        autoFitContent: !0
                    });
                    t.position.set(15, 0),
                    t.setBounds(new Xe.Rectangle(0,20,this.contentSize.width,this.contentSize.height - 90));
                    var i = (new Xe.Graphics).beginFill(16777215).drawShape(new Xe.Rectangle(0,20,this.contentSize.width,this.contentSize.height - 20)).endFill();
                    return t.mask = i,
                    this._scrollContainers.set(e, t),
                    {
                        container: t,
                        mask: i
                    }
                }
                ,
                t.prototype._createField = function(e) {
                    var t, i = new Xe.Container, n = this._marketplaceService, r = {
                        width: 464,
                        height: 306
                    };
                    if (e.renewable) {
                        var o = n.getStockItem(e.id);
                        t = i.addChild(new XC(e,r,{
                            marketplaceService: n,
                            stockItem: o
                        }))
                    } else
                        t = e.isLimited ? i.addChild(new NC(e,r,{
                            marketplaceService: n
                        })) : i.addChild(new wC(e,r,{
                            marketplaceService: n
                        }));
                    return t.onButtonClicked(nc(this._onShopItemClick.bind(this, {
                        item: e,
                        shopItem: t
                    }))),
                    i
                }
                ,
                t.prototype._createSaleField = function(e) {
                    var t = new Xe.Container
                      , i = this._marketplaceService
                      , n = {
                        width: 484,
                        height: 998
                    };
                    if (e) {
                        var r = void 0;
                        (r = e.isLimited ? t.addChild(new kC(e,n,{
                            marketplaceService: i
                        })) : t.addChild(new BC(e,n,{
                            marketplaceService: i
                        }))).onButtonClicked(nc(this._onShopItemClick.bind(this, {
                            item: e,
                            shopItem: r
                        })))
                    }
                    return t
                }
                ,
                t.prototype._getItemStrategy = function(e) {
                    return $a(e) ? new MA({
                        iap: De.services.iap,
                        productId: e.payment.productId
                    }) : Za(e) ? new Uh({
                        adsService: De.services.adsService
                    },"marketplace_".concat(e.id)) : es(e) ? new OC({
                        inventory: De.services.inventory,
                        cost: {
                            key: e.payment.key,
                            amount: e.payment.amount
                        }
                    }) : new SC({})
                }
                ,
                t.prototype._onShopItemClick = function(e) {
                    var t = e.item
                      , i = e.shopItem;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, r, o, a, s, _ = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return i.disableButton(),
                                De.services.analytics.design.marketplaceItemClicked("tap", t.id),
                                [4, (e = this._getItemStrategy(t)).execute()];
                            case 1:
                                if (r = n.sent(),
                                o = r.result,
                                a = r.reason,
                                o !== $_.SUCCESS)
                                    return i.enableButton(),
                                    es(t) && t.payment.key === Cn.GEMS && (this._spawnNotEnoughGemsTextFloater(),
                                    i.insufficientFundsAnimation((function() {
                                        _.switchToTab(Ua.GEMS)
                                    }
                                    ))),
                                    De.services.analytics.design.marketplaceItemClicked("fail", t.id, a),
                                    [2];
                                this._marketplaceService.hasStock(t.id) && (this._marketplaceService.getStockItem(t.id).amount -= 1),
                                n.label = 2;
                            case 2:
                                return n.trys.push([2, 4, , 5]),
                                [4, this._rewardService.rewardMarketplaceItem({
                                    item: t,
                                    marketplacePopup: this._popup,
                                    popupClosedEvent: this._popup.onClosed,
                                    parent: this.parent,
                                    bubblePosition: new Xe.Point(0,-200)
                                })];
                            case 3:
                                return n.sent(),
                                [3, 5];
                            case 4:
                                return s = n.sent(),
                                this._logger.error("error while executing reward strategy: ".concat(s)),
                                [3, 5];
                            case 5:
                                try {
                                    this._marketplaceService.purchaseItem(t),
                                    this._marketplaceService.closeMarketplaceShop(),
                                    this._sendPurchaseAnalytics(t),
                                    De.services.autosave.forceSave(),
                                    e.finalize()
                                } catch (e) {
                                    this._logger.error("error while finalizing shop purchase: ".concat(e)),
                                    De.services.navigation.closeAllPopups()
                                }
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._sendPurchaseAnalytics = function(e) {
                    e.reward.type === Va.INVENTORY ? this._sendItemPurchaseAnalytics(e) : e.reward.type === Va.OBJECT ? this._sendObjectPurchaseAnalytics(e) : this._logger.warn("No analytics for reward type: ".concat(e.reward.type))
                }
                ,
                t.prototype._sendObjectPurchaseAnalytics = function(e) {
                    this._activeTabKey && Xi[this._activeTabKey] && De.services.analytics.design.reportEventMarketplaceItemPurchased(Xi[this._activeTabKey], e.id)
                }
                ,
                t.prototype._sendItemPurchaseAnalytics = function(e) {
                    var t = e.reward.data;
                    De.services.analytics.design.marketplaceItemClicked("obtain", e.id),
                    De.services.analytics.source.purchaseFromMarketPlace(t.amount, mp[t.key.toLocaleUpperCase()]),
                    $a(e) ? De.services.analytics.business.marketplaceGemPack(e) : es(e) && e.payment.key === Cn.GEMS && De.services.analytics.sink.gemsForMarketplaceItem(t.amount)
                }
                ,
                t.prototype._addScrollablesToUpdateables = function() {
                    this._scrollContainers.forEach((function(e) {
                        v.GroupsCore.Updateables.add(e)
                    }
                    ))
                }
                ,
                t.prototype._removeScrollablesFromUpdateables = function() {
                    this._scrollContainers.forEach((function(e) {
                        v.GroupsCore.Updateables.remove(e)
                    }
                    ))
                }
                ,
                t
            }(tc), QC = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    i.priority = _r.IMMEDIATE,
                    i._name = "MarketPlacePopup",
                    i._popupSize = {
                        width: 998,
                        height: 1200
                    },
                    i._tabContentGroupSize = {
                        width: 998,
                        height: 1100
                    },
                    i._tabHeaders = [],
                    i._content.addChild(i._createBackground());
                    var r = i._options.marketplaceService.getMarketplacePopupData();
                    r.forEach((function(e) {
                        var t;
                        try {
                            t = nr(VC || (VC = (0,
                            n.__makeTemplateObject)(["", ""], ["", ""])), ce[e.name.toLocaleUpperCase()])
                        } catch (n) {
                            t = e.name,
                            i._logger.error("No localization entry found for shop name of key: ".concat(e.name.toLocaleUpperCase()))
                        }
                        i._tabHeaders.push({
                            key: e.name,
                            label: t
                        })
                    }
                    ));
                    var o = new qC({
                        headers: i._tabHeaders,
                        width: i._tabContentGroupSize.width,
                        height: i._tabContentGroupSize.height,
                        tabHeight: 60,
                        tabSpacing: 2,
                        data: r
                    },i._options.marketplaceService,i._options.mapGridView,i._options.storageBubbleService,i._options.rewardService,i,i._options.shopToFocus);
                    return o.position.x = -.5 * i._popupSize.width,
                    o.position.y = -.5 * i._popupSize.height + 100,
                    i._content.addChild(o),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    De.services.analytics.design.marketplacePopupStatus("show"),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    this._options.marketplaceService.finishUnconsumedPurchases().finally((function() {
                        e()
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerdown", this._tryToClose, this)
                }
                ,
                t.prototype._createBackground = function() {
                    var e = new Ar({
                        size: {
                            width: this._popupSize.width,
                            height: this._popupSize.height
                        },
                        headerSize: {
                            width: 998 / 1.5,
                            height: 90
                        },
                        headerText: ce.MARKET_PLACE_POPUP_HEADER,
                        headerStyle: vn.popupTitle
                    });
                    return e.onCloseClick(this.close.bind(this)),
                    e
                }
                ,
                t
            }(yr), ZC = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._config = {
                        shops: {
                            Crates: {
                                items: []
                            },
                            Energy: {
                                items: []
                            },
                            Gems: {
                                items: []
                            },
                            Halloween: {
                                items: []
                            },
                            Christmas: {
                                items: []
                            },
                            Valentines: {
                                items: []
                            },
                            BlackFriday: {
                                items: []
                            },
                            ChristmasDeals: {
                                items: []
                            }
                        }
                    },
                    t._enabledTemporaryShops = new Map,
                    t._unconsumedPurchaseCheckInterval = -1,
                    t._autoSaveService = De.services.autosave,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t._initializeStock = function(e) {
                    e.items.filter((function(e) {
                        return e.renewable
                    }
                    )).forEach((function(e) {
                        if (e.renewable) {
                            var i = t._stockItems.get(e.id);
                            i || (-1 === t._model.getStock(e.id) && t._model.setStock(e.id, e.renewable.amount),
                            i = new og(e.id),
                            t._stockItems.set(e.id, i),
                            i.amount = t._model.getStock(e.id),
                            i.onChanged.addListener((function() {
                                return t._model.setStock(e.id, i.amount)
                            }
                            ), void 0)),
                            De.services.resourceRegeneration.hasGenerator(e.id) || De.services.resourceRegeneration.createGenerator(e.id, {
                                MAX_AMOUNT: e.renewable.amount,
                                SPAWN_INTERVAL: e.renewable.duration,
                                AMOUNT_PER_INTERVAL: 1
                            }, i)
                        }
                    }
                    ))
                }
                ,
                t.prototype.isShopEnabled = function(e) {
                    return this._enabledTemporaryShops.has(e)
                }
                ,
                t.prototype.enableShop = function(e, t) {
                    this.isShopEnabled(e) || this._enabledTemporaryShops.set(e, t)
                }
                ,
                t.prototype.isLimitedItemPurchased = function(e) {
                    var t = this
                      , i = !1;
                    return this._enabledTemporaryShops.forEach((function(n, r) {
                        i || t._config.shops[r].items.includes(e) && (i = n.isItemPurchased(e.id))
                    }
                    )),
                    i
                }
                ,
                t.prototype.purchaseItem = function(e) {
                    var t = this;
                    this._enabledTemporaryShops.forEach((function(i, n) {
                        t._config.shops[n].items.includes(e) && i.itemPurchased(e.id)
                    }
                    ))
                }
                ,
                t.prototype.disableShop = function(e) {
                    this.isShopEnabled(e) && this._enabledTemporaryShops.delete(e)
                }
                ,
                t.prototype.openMarketplaceShop = function(e) {
                    return void 0 === e && (e = Ua.CRATES),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._openShopPopup(QC, {
                                marketplaceService: this,
                                storageBubbleService: this.services.storageBubble,
                                mapGridView: this.services.mapGridView,
                                rewardService: this.services.rewardService,
                                shopToFocus: e
                            }),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.closeMarketplaceShop = function() {
                    De.services.navigation.closeAllPopups()
                }
                ,
                t.prototype.getItemConfigsByShop = function(e) {
                    return this._config.shops[e].items.find((function(e) {
                        return ts(e)
                    }
                    )) ? this._config.shops[e].items.filter((function(e) {
                        return De.services.adsService.isRewardedAdsSupported() && !ts(e) || !De.services.adsService.isRewardedAdsSupported() && !Za(e)
                    }
                    )) : this._config.shops[e].items
                }
                ,
                t.prototype.getMarketplacePopupData = function() {
                    var e = this
                      , t = [];
                    return Object.entries(Fa).forEach((function(i) {
                        if (e._enabledTemporaryShops.has(i[1])) {
                            var n = Fa[i[0]];
                            t.push({
                                name: n,
                                items: e._config.shops[n].items
                            })
                        }
                    }
                    )),
                    Object.entries(Ua).forEach((function(i) {
                        var n = Ua[i[0]];
                        t.push({
                            name: n,
                            items: e._config.shops[n].items
                        })
                    }
                    )),
                    t
                }
                ,
                t.prototype.getItemConfigByID = function(e) {
                    return this._getAllItems().find((function(t) {
                        return t.id === e
                    }
                    ))
                }
                ,
                t.prototype.getItemConfigByProductId = function(e) {
                    return this._getAllItems().find((function(t) {
                        return $a(t) && t.payment.productId === e
                    }
                    ))
                }
                ,
                t.prototype.hasStock = function(e) {
                    return t._stockItems.has(e)
                }
                ,
                t.prototype.getStockItem = function(e) {
                    return t._stockItems.get(e) || (this._logger.error("no stock set up for ".concat(e)),
                    new og(e))
                }
                ,
                t.prototype.finishUnconsumedPurchases = function() {
                    return this._finishUnconsumedPurchases()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, Promise.all([De.services.assetLoader.loadJsons(_e.MARKETPLACE_SHOPS_CONFIG), De.services.assetLoader.loadJsons(_e.MARKETPLACE_ITEMS_CONFIG), this._autoSaveService.registerModel(t._model)])];
                            case 1:
                                return e.sent(),
                                this._shopsConfig = r.ObjectUtility.deepCopy(De.services.resource.getJson(_e.MARKETPLACE_SHOPS_CONFIG)),
                                this._itemsConfig = r.ObjectUtility.deepCopy(De.services.resource.getJson(_e.MARKETPLACE_ITEMS_CONFIG)),
                                t._initializeStock(this._itemsConfig),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return Object.keys(this._config.shops).forEach((function(t) {
                                (0,
                                r.isUndefined)(e._shopsConfig.shops[t]) ? e._logger.warn("No marketplace shop config found for ".concat(t, ", make sure to update marketplace_shops_config.yaml if this is unintended")) : e._config.shops[t].items = e._mergeConfigs(e._shopsConfig.shops[t], e._itemsConfig)
                            }
                            )),
                            this._finishUnconsumedPurchases(),
                            this._unconsumedPurchaseCheckInterval = setInterval(this._finishUnconsumedPurchases.bind(this), 6e4),
                            De.services.iap.onUnhandledPurchase.addListener(this._finishPurchase, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._autoSaveService.unregisterModel(t._model),
                            De.services.iap.onUnhandledPurchase.removeListener(this._finishPurchase, this),
                            clearInterval(this._unconsumedPurchaseCheckInterval),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._openShopPopup = function(e, t) {
                    De.services.navigation.closeAllPopups(),
                    De.services.lazyLoad.prioritizeGroup(hn.MARKETPLACE).then((function() {
                        return De.services.navigation.showPopup(e, t)
                    }
                    ))
                }
                ,
                t.prototype._mergeConfigs = function(e, t) {
                    var i = this
                      , n = [];
                    return Object.entries(e).forEach((function(e) {
                        var r = e[0]
                          , o = e[1]
                          , a = t.items.find((function(e) {
                            return e.id === r
                        }
                        ));
                        a ? n.push(Object.assign({}, a, o)) : i._logger.error("No marketplace item found with id of" + r)
                    }
                    )),
                    n
                }
                ,
                t.prototype._getAllItems = function() {
                    var e = [];
                    for (var t in this._config.shops)
                        e.push.apply(e, this._config.shops[t].items);
                    return e
                }
                ,
                t.prototype._finishUnconsumedPurchases = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, De.services.iap.getUnconsumedPurchases()];
                            case 1:
                                return e = i.sent(),
                                [4, Promise.all(e.map((function(e) {
                                    return (0,
                                    n.__awaiter)(t, void 0, void 0, (function() {
                                        return (0,
                                        n.__generator)(this, (function(t) {
                                            return this._finishPurchase(e),
                                            [2]
                                        }
                                        ))
                                    }
                                    ))
                                }
                                ))).catch((function() {}
                                ))];
                            case 2:
                                return i.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._finishPurchase = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (t = this.getItemConfigByProductId(e.items[0].sku)) ? [3, 4] : (this._logger.error("unclaimed purchase with productID ".concat(e.items[0].sku, ", but no matching shop config found")),
                                [3, 3]);
                            case 1:
                                return this._logger.warn("unclaimed purchase with productID ".concat(e.items[0].sku, ", but no matching shop config found. Consuming purchase nevertheless")),
                                [4, De.services.iap.consumePurchase(e)];
                            case 2:
                                n.sent(),
                                n.label = 3;
                            case 3:
                                return [2];
                            case 4:
                                return is(t.reward) ? (i = [],
                                t.reward.data.forEach((function(e) {
                                    var t = De.services.blueprintCollection.getBlueprint(e).components;
                                    i.push({
                                        blueprint: e,
                                        data: t
                                    })
                                }
                                )),
                                this.services.storageBubble.createBubbleAndShowContent(i),
                                [3, 7]) : [3, 5];
                            case 5:
                                return ns(t.reward) ? [4, this.services.rewardService.giveInventoryReward({
                                    reward: t.reward.data,
                                    parent: this.services.cameraService.cameraView
                                })] : [3, 7];
                            case 6:
                                n.sent(),
                                n.label = 7;
                            case 7:
                                return [4, De.services.autosave.forceSave()];
                            case 8:
                                return n.sent(),
                                [4, De.services.iap.consumePurchase(e)];
                            case 9:
                                return n.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t._model = new IC,
                t._stockItems = new Map,
                t
            }(Go), $C = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "FreebieOfferPopup",
                    i._itemPositions = new Map,
                    i._options = {
                        popupHeader: ce.FREEBIEOFFER_HEADER,
                        infoImage: f.ICON_FREEBIE_OFFERS,
                        infoText: ce.FREEBIEOFFER_BODY
                    },
                    i._productData = t.productData,
                    i._service = t.service,
                    i.onOpened.listenOnce((function() {
                        return i._service.popupShown()
                    }
                    ), i),
                    i.onClosed.listenOnce((function() {
                        return i._service.popupClosed()
                    }
                    ), i),
                    i._timer = De.services.timer.getTimerByID(t.timerId),
                    i._createBackground(),
                    i._createHeader(),
                    i._createInfo(),
                    i._createOfferVisual(),
                    i._createTimer(),
                    i._createPriceButton(),
                    i._timer.onUpdate.addListener(i._updateTimer, i),
                    i._timer.onTimerFinished.addListener(i.close, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.onDestroy = function() {
                    this._timer.onUpdate.removeListener(this._updateTimer, this),
                    this._timer.onTimerFinished.removeListener(this.close, this),
                    this._inputBlocker.interactive = !1
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype._createBackground = function() {
                    var e = this
                      , t = this._getBackgroundSize();
                    this._backGround = new Ar({
                        size: t,
                        headerSize: {
                            width: t.width / 1.5,
                            height: 75
                        },
                        headerStyle: vn.popupTitle,
                        showCloseButton: !0
                    }),
                    this._content.addChild(this._backGround),
                    this._backGround.onCloseClick((function() {
                        return e.close()
                    }
                    ))
                }
                ,
                t.prototype._createHeader = function() {
                    var e = new Xe.Container
                      , t = rr(De.services.resource.getSprite(f.ICON_FREEBIE_POPUPHEADER), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -480
                        }
                    });
                    e.addChild(t);
                    var i = new v.LabelSettings({
                        fitToBox: !1
                    });
                    i.style = vn.lightBoldMedium,
                    e.addChild(rr(new v.Label(nr(HC || (HC = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), this._options.popupHeader),i), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: -386
                        }
                    })),
                    this._content.addChild(e)
                }
                ,
                t.prototype._createTimer = function() {
                    var e = new Xe.Container
                      , t = De.services.resource.getSprite(f.BG_FREEBIE_TIMERRIBBON);
                    e.addChild(rr(t, {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: t.width / 2 - 500 - 20,
                            y: 400 - t.height / 2 - 10
                        }
                    }));
                    var i = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 75,
                        fitWidth: t.width - 50
                    });
                    i.style = vn.lightMedium;
                    var r = new v.Label(nr(jC || (jC = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FREEBIEOFFER_2XVALUE),i);
                    r.anchor.set(.5, .5),
                    r.position.set(t.position.x, t.position.y - 40),
                    e.addChild(r);
                    var o = De.services.resource.getSprite(f.ICON_TIMER);
                    e.addChild(rr(o, {
                        anchor: {
                            x: 1,
                            y: .5
                        },
                        position: {
                            x: -410,
                            y: t.position.y + 20
                        }
                    })),
                    this._timerText = new v.Label("00H 00M 00S",i),
                    this._timerText.anchor.set(0, .5),
                    this._timerText.position.set(-390, t.position.y + 24),
                    e.addChild(this._timerText),
                    this._content.addChild(e)
                }
                ,
                t.prototype._updateTimer = function() {
                    this._timerText.text = r.StringUtility.formatMilliseconds(this._timer.remainingTime, {
                        alwaysShowHours: !0,
                        alwaysShowMinutes: !0,
                        forceDoubleDigits: !0,
                        appendTimeUnits: {
                            hours: "H",
                            minutes: "M",
                            seconds: "S"
                        }
                    })
                }
                ,
                t.prototype._getBackgroundSize = function() {
                    var e = De.services.resource.getSprite(this._options.infoImage).width + 10
                      , t = De.services.resource.getSprite(this._options.infoImage).height + 75 + 200;
                    return {
                        width: Math.max(e, 1e3),
                        height: Math.max(t, 800)
                    }
                }
                ,
                t.prototype._createInfo = function() {
                    if (this._content.addChild(rr(De.services.resource.getSprite(this._options.infoImage), {
                        anchor: {
                            x: .5,
                            y: 0
                        },
                        position: {
                            x: 0,
                            y: -205
                        }
                    })),
                    this._options.infoText) {
                        var e = new v.LabelSettings({
                            fitToBox: !0,
                            fitHeight: 75,
                            fitWidth: this._getBackgroundSize().width / 1.2
                        });
                        e.style = vn.darkMedium,
                        this._content.addChild(rr(new v.Label(nr(KC || (KC = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), this._options.infoText),e), {
                            anchor: {
                                x: .5,
                                y: 0
                            },
                            position: {
                                x: 0,
                                y: -293
                            }
                        }))
                    }
                }
                ,
                t.prototype._createOfferVisual = function() {
                    var e = new Xe.Container;
                    e.position.set(0, 55);
                    var t = De.services.resource.getSprite(f.ICON_FREEBIE_OFFERS).width
                      , i = new v.LabelSettings({
                        fitHeight: 135,
                        fitWidth: 300,
                        fitToBox: !0
                    });
                    i.style = vn.darkSmall;
                    for (var n = 1; n <= 3; n++) {
                        var r = this._productData.reward[n - 1].amount.toString()
                          , o = new v.Label(r,i);
                        o.anchor.set(.5);
                        var a = 10 * (2 - n);
                        o.position.set(-t / 3 + (n - 1) * t / 3 - a, 100),
                        this._itemPositions.set(this._productData.reward[n - 1].key, o.position),
                        e.addChild(o)
                    }
                    this._content.addChild(e)
                }
                ,
                t.prototype._createPriceButton = function() {
                    var e = this._productData.id
                      , t = De.services.iap.catalog.find((function(t) {
                        return t.sku === e
                    }
                    ))
                      , i = t ? 200 : 300
                      , n = new fr({
                        name: "purchaseIAP-".concat(this._productData.id),
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: {
                            width: i,
                            height: 90
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: t ? t.price.formattedAmount : ce.BUTTON_UNAVAILABLE,
                        position: {
                            x: 0,
                            y: -5
                        }
                    });
                    n.position.set(500 - i / 2 - 50, 310),
                    t || n.disable(),
                    n.onClick(this._onButtonClicked.bind(this)),
                    this._content.addChild(n)
                }
                ,
                t.prototype._onButtonClicked = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return De.services.analytics.design.reportFreebieOfferPurchaseButtonPressed(),
                                [4, new MA({
                                    iap: De.services.iap,
                                    productId: this._productData.id
                                }).execute()];
                            case 1:
                                return e = n.sent(),
                                t = e.result,
                                i = e.reason,
                                t !== $_.SUCCESS ? (this._logger.warn("Purchase failed: ".concat(i)),
                                [2]) : (this._productData.reward.forEach((function(e) {
                                    De.services.inventory.addAmount(e.key, e.amount, !1)
                                }
                                )),
                                this._service.specialOfferPurchased(),
                                De.services.analytics.design.reportFreebieOfferPurchaseComplete(),
                                De.services.analytics.business.freebieOfferPurchased(this._productData),
                                [4, this.close()]);
                            case 2:
                                return n.sent(),
                                this._animateRewards(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._animateRewards = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._productData.reward.forEach((function(t) {
                                return (0,
                                n.__awaiter)(e, void 0, void 0, (function() {
                                    var e, i, r, o, a, s, _, c;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        return e = this._itemPositions.get(t.key),
                                        i = De.services.navigation.layers.popup.container,
                                        r = i.toGlobal(e || new Xe.Point(0,0)),
                                        o = De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter({
                                            amount: t.amount,
                                            key: t.key
                                        }),
                                        a = o.target,
                                        s = o.icon,
                                        _ = a.toGlobal(new Xe.Point(0,0)),
                                        (c = new Lr(De.services.resource.getSprite(s),i.toLocal(r),i.toLocal(_),t.amount,i)).onAnimationComplete.addListener((function() {
                                            De.services.inventory.getInventoryItem(t.key).updateVisuals()
                                        }
                                        ), null),
                                        c.animate(),
                                        [2]
                                    }
                                    ))
                                }
                                ))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(yr);
            !function(e) {
                e.ACTIVE_NOT_SEEN = "activeNotSeen",
                e.ACTIVE_SEEN = "activeSeen",
                e.COMPLETED = "completed"
            }(WC || (WC = {}));
            var eI, tI, iI, nI, rI, oI, aI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "SpecialOfferModel",
                    t._version = 1,
                    t._specialOffers = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getActiveSpecialOffer = function() {
                    return this._specialOffers.find((function(e) {
                        return e.state !== WC.COMPLETED
                    }
                    ))
                }
                ,
                t.prototype.getSpecialOfferById = function(e) {
                    return this._specialOffers.find((function(t) {
                        return t.id === e
                    }
                    ))
                }
                ,
                t.prototype.addSpecialOffer = function(e) {
                    this._specialOffers.push(e),
                    this.saveData()
                }
                ,
                t.prototype.updateSpecialOffer = function(e) {
                    var t = this.getSpecialOfferById(e.id);
                    t && (t.state = e.state,
                    t.timerId = e.timerId,
                    this.saveData())
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._specialOffers = e.specialOffers
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        specialOffers: this._specialOffers
                    }
                }
                ,
                t
            }($n), sI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.specialOfferActive = new r.Event,
                    t._model = new aI,
                    t._hasMadePurchase = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.hasActiveSpecialOffer = function() {
                    if (this._currentSpecialOffer && this._currentSpecialOffer.timerId) {
                        var e = De.services.timer.getTimerByID(this._currentSpecialOffer.timerId).remainingTime > 0;
                        return this._currentSpecialOffer.state === WC.ACTIVE_SEEN && e
                    }
                    return !1
                }
                ,
                t.prototype.openSpecialOfferPopup = function() {
                    var e;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._currentSpecialOfferProductData && (null === (e = this._currentSpecialOffer) || void 0 === e ? void 0 : e.timerId) ? [4, De.services.lazyLoad.prioritizeGroup(hn.SPECIAL_OFFER)] : [3, 2];
                            case 1:
                                t.sent(),
                                De.services.navigation.showPopup($C, {
                                    service: this,
                                    productData: this._currentSpecialOfferProductData,
                                    timerId: this._currentSpecialOffer.timerId
                                }),
                                t.label = 2;
                            case 2:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.popupShown = function() {
                    var e;
                    (null === (e = this._currentSpecialOffer) || void 0 === e ? void 0 : e.state) === WC.ACTIVE_NOT_SEEN && this._setCurrentSpecialOfferState(WC.ACTIVE_SEEN)
                }
                ,
                t.prototype.popupClosed = function() {
                    this.services.hudService.showHudElement(Ns.SpecialOfferButtonUI)
                }
                ,
                t.prototype.specialOfferPurchased = function() {
                    if (this._currentSpecialOffer && this._currentSpecialOffer.timerId) {
                        var e = De.services.timer.getTimerByID(this._currentSpecialOffer.timerId);
                        e && e.forceComplete()
                    }
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.SPECIAL_OFFER)];
                            case 1:
                                return e.sent(),
                                [4, De.services.autosave.registerModel(this._model)];
                            case 2:
                                return e.sent(),
                                this._config = De.services.resource.getJsonCopy(_e.SPECIAL_OFFER_CONFIG),
                                this._hasMadePurchase = De.services.analytics.model.totalSpent > 0,
                                this._currentSpecialOfferProductData = this._getSpecialOfferData(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    var e, t, i, n = this;
                    this.services.hudService.hideHudElement(Ns.SpecialOfferButtonUI, !0),
                    (0,
                    r.isNull)(this._currentSpecialOfferProductData) || (this._currentSpecialOffer = this._model.getSpecialOfferById(this._currentSpecialOfferProductData.id),
                    this._hasMadePurchase && (0,
                    r.isUndefined)(this._currentSpecialOffer) || (null === (e = this._currentSpecialOffer) || void 0 === e ? void 0 : e.state) !== WC.COMPLETED && ((null === (t = this._currentSpecialOffer) || void 0 === t ? void 0 : t.state) === WC.ACTIVE_SEEN ? (De.services.visitorReward.hasRewards() ? this.services.hudService.showHudElement(Ns.SpecialOfferButtonUI) : De.services.onboardingGameService.onboardingRunningAtStartSession.then((function(e) {
                        var t;
                        e || (null === (t = n._currentSpecialOffer) || void 0 === t ? void 0 : t.state) !== WC.ACTIVE_SEEN || (De.services.analytics.design.reportFreebieOfferPopupAutoOpened(),
                        n.openSpecialOfferPopup())
                    }
                    )),
                    this._currentSpecialOffer.timerId && De.services.timer.getTimerByID(this._currentSpecialOffer.timerId).onTimerFinished.addListener(this._onTimerComplete, this),
                    this.specialOfferActive.fire(this._currentSpecialOffer)) : (De.services.analytics.totalMoneySpentIncreased.addListener(this._onTotalMoneySpentIncreased, this),
                    (null === (i = this.services.mapAreaService.getMapArea("A7")) || void 0 === i ? void 0 : i.state) !== Cc.UNLOCKED ? this.services.mapAreaService.onAreaStateChange.addListener(this._onAreaStateChange, this) : De.services.inventory.onRunOutOfResources.addListener(this._openSpecialOfferPopupFirstTime, this))))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.mapAreaService.onAreaStateChange.removeListener(this._onAreaStateChange, this),
                            De.services.inventory.onRunOutOfResources.removeListener(this._openSpecialOfferPopupFirstTime, this),
                            De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getSpecialOfferData = function() {
                    return null
                }
                ,
                t.prototype._setCurrentSpecialOfferState = function(e) {
                    this._currentSpecialOffer && this._currentSpecialOffer.state !== e && (this._currentSpecialOffer.state = e,
                    this._model.updateSpecialOffer(this._currentSpecialOffer))
                }
                ,
                t.prototype._onTimerComplete = function(e) {
                    this._currentSpecialOffer && this._currentSpecialOffer.timerId === e.id && (this._setCurrentSpecialOfferState(WC.COMPLETED),
                    this._currentSpecialOffer.timerId = void 0,
                    this._model.updateSpecialOffer(this._currentSpecialOffer),
                    !De.services.friends.isVisitingFriend && this.services.hudService.hudContainer && this.services.hudService.hideHudElement(Ns.SpecialOfferButtonUI)),
                    e.onTimerFinished.removeListener(this._onTimerComplete, this)
                }
                ,
                t.prototype._onAreaStateChange = function(e) {
                    "A7" === e.area.id && e.area.state === Cc.UNLOCKED && (this.services.mapAreaService.onAreaStateChange.removeListener(this._onAreaStateChange, this),
                    De.services.inventory.onRunOutOfResources.addListener(this._openSpecialOfferPopupFirstTime, this))
                }
                ,
                t.prototype._openSpecialOfferPopupFirstTime = function() {
                    if (De.services.inventory.onRunOutOfResources.removeListener(this._openSpecialOfferPopupFirstTime, this),
                    !this._currentSpecialOffer && this._currentSpecialOfferProductData) {
                        var e = De.services.timer.addTimer(this._currentSpecialOfferProductData.duration, this._currentSpecialOfferProductData.id)
                          , t = {
                            id: this._currentSpecialOfferProductData.id,
                            state: WC.ACTIVE_NOT_SEEN,
                            timerId: e.id
                        };
                        this._model.addSpecialOffer(t),
                        e.onTimerFinished.addListener(this._onTimerComplete, this),
                        this._currentSpecialOffer = t,
                        this.specialOfferActive.fire(this._currentSpecialOffer),
                        De.services.analytics.design.reportFreebieOfferInitialized(),
                        this.openSpecialOfferPopup()
                    }
                }
                ,
                t.prototype._onTotalMoneySpentIncreased = function() {
                    (0,
                    r.isUndefined)(this._currentSpecialOffer) && (this.services.mapAreaService.onAreaStateChange.removeListener(this._onAreaStateChange, this),
                    De.services.inventory.onRunOutOfResources.removeListener(this._openSpecialOfferPopupFirstTime, this))
                }
                ,
                t
            }(Go), _I = {
                topHeight: 64,
                rightWidth: 75,
                bottomHeight: 72,
                leftWidth: 75
            }, cI = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.NORMAL,
                    i._name = "StorageIsFullPopup",
                    i._contentHeight = 120,
                    i._storageService = t.storageService,
                    i._createBackground(),
                    i._createItemVisual(t.blueprintID),
                    i._createExplanationText(),
                    i._createButton(),
                    i._popupBackground.resize({
                        width: 1e3,
                        height: i._contentHeight
                    }),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    De.services.analytics.design.reportStorageIsFullPopupShown(),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBackground = function() {
                    var e = this;
                    this._popupBackground = new Ar({
                        size: {
                            width: 1e3,
                            height: 1350
                        },
                        headerSize: {
                            width: 666.6666666666666,
                            height: 75
                        },
                        headerText: ce.STORAGE_IS_FULL,
                        customHeaderTextPosition: new Xe.Point(0,-614),
                        headerStyle: vn.popupTitle,
                        customNineslice: f.POPUP_BG_CONCENT_9SLICE,
                        customNinesliceOptions: {
                            leftWidth: 200,
                            topHeight: 200,
                            rightWidth: 200,
                            bottomHeight: 200
                        },
                        showCloseButton: !1
                    }),
                    this._popupBackground.onCloseClick((function() {
                        return e.close()
                    }
                    )),
                    this._content.addChild(this._popupBackground)
                }
                ,
                t.prototype._createItemVisual = function(e) {
                    var t = De.services.blueprintCollection.getBlueprint(e)
                      , i = De.services.buildings.getBuildingLevelConfig(t.id);
                    this._gameObjectVisual = rr(De.services.resource.getSprite({
                        alias: i.visualKeys.active
                    }), {
                        anchor: {
                            x: .5,
                            y: 0
                        }
                    }),
                    this._gameObjectVisual.position.set(0, -515),
                    this._content.addChild(this._gameObjectVisual),
                    this._contentHeight += this._gameObjectVisual.height + 160
                }
                ,
                t.prototype._createExplanationText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 700,
                        style: vn.darkMedium
                    });
                    this._explanationText = rr(new v.Label(nr(eI || (eI = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.STORAGE_IS_FULL_BODY),e), {
                        anchor: {
                            x: .5,
                            y: 0
                        }
                    }),
                    this._explanationText.position.set(0, this._gameObjectVisual.y + this._gameObjectVisual.height + 50),
                    this._content.addChild(this._explanationText),
                    this._contentHeight += this._explanationText.height + 50
                }
                ,
                t.prototype._createButton = function() {
                    var e = this;
                    this._button = this.addChild(new fr({
                        name: "purchase button",
                        buttonIdle: f.BTN_EVENT_GREEN_IDLE,
                        buttonActive: f.BTN_EVENT_GREEN_DOWN
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, _I),
                        buttonSizes: {
                            width: 400,
                            height: 142
                        }
                    },{
                        text: ce.BUTTON_VIEW_STORAGE,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })),
                    this._button.position.set(0, this._explanationText.y + this._explanationText.height + this._button.height / 2 + 50),
                    this._content.addChild(this._button),
                    this._contentHeight += this._button.height + 50,
                    this._button.onClick((function() {
                        e._button.disable(),
                        e._storageService.openStoragePopup()
                    }
                    ))
                }
                ,
                t
            }(yr), lI = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._name = "StorageOnboardingPopup",
                    i._popupHelpHeader = void 0,
                    i._customWidth = 1120,
                    i._popupTitle = ce.DECORATION_STORAGE,
                    i._explanationIcon = f.ICON_POPUP_STORAGE_EXPLANATION,
                    i._step1Text = nr(tI || (tI = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.STORAGE_EXPLANATION_STEP_1),
                    i._step2Text = nr(iI || (iI = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.STORAGE_EXPLANATION_STEP_2),
                    i._step3Text = nr(nI || (nI = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.STORAGE_EXPLANATION_STEP_3),
                    i._exitButtonText = nr(rI || (rI = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.TAP_TO_CONTINUE),
                    i.createPopup(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.show = function(t) {
                    De.services.analytics.design.reportStorageOnboardingPopupShown(),
                    e.prototype.show.call(this, t)
                }
                ,
                t
            }(CA);
            !function(e) {
                e.LOCKED = "locked",
                e.EMPTY = "empty",
                e.FILLED = "filled"
            }(oI || (oI = {}));
            var uI, dI, hI, pI, vI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "StorageModel",
                    t._version = 1,
                    t._slots = [],
                    t._hasSeenOnboarding = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "slots", {
                    get: function() {
                        return this._slots
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "hasSeenOnboarding", {
                    get: function() {
                        return this._hasSeenOnboarding
                    },
                    set: function(e) {
                        this._hasSeenOnboarding = e,
                        this.saveData()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.getFilledItems = function() {
                    return this._slots.filter((function(e) {
                        return e.state === oI.FILLED
                    }
                    ))
                }
                ,
                t.prototype.getFirstEmptySlot = function() {
                    return this._slots.find((function(e) {
                        return e.state === oI.EMPTY
                    }
                    ))
                }
                ,
                t.prototype.isStored = function(e) {
                    return this._slots.some((function(t) {
                        var i;
                        return (null === (i = t.object) || void 0 === i ? void 0 : i.blueprint) === e
                    }
                    ))
                }
                ,
                t.prototype.addItem = function(e) {
                    var t = this.getFirstEmptySlot();
                    if (t) {
                        t.state = oI.FILLED;
                        var i = De.services.blueprintCollection.getBlueprint(e.getBlueprintID()).components;
                        t.object = e.serialize(i)
                    } else
                        this._logger.error("no empty slots");
                    this.saveData()
                }
                ,
                t.prototype.removeItem = function(e) {
                    e.state = oI.EMPTY,
                    e.object = void 0,
                    this.saveData()
                }
                ,
                t.prototype.unlockNewSlot = function(e) {
                    e.state === oI.LOCKED && (e.state = oI.EMPTY,
                    this.saveData())
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons([_e.STORAGE_CONFIG])];
                            case 1:
                                return t.sent(),
                                this._config = De.services.resource.getJsonCopy(_e.STORAGE_CONFIG),
                                this._config.slots.forEach((function(t) {
                                    e._slots.push(t)
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._hasSeenOnboarding = e.hasSeenOnboarding,
                    this._slots = e.slots
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        hasSeenOnboarding: this._hasSeenOnboarding,
                        slots: this._slots
                    }
                }
                ,
                t
            }($n), gI = {
                topHeight: 64,
                rightWidth: 75,
                bottomHeight: 72,
                leftWidth: 75
            }, fI = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return t.state === oI.FILLED ? i._createRestoreVisuals(t) : t.state === oI.LOCKED && i._createPurchaseVisuals(t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.slotEmptied = function() {
                    this.button.destroy(),
                    this.visual.destroy()
                }
                ,
                t.prototype._createRestoreVisuals = function(e) {
                    var t = De.services.blueprintCollection.getBlueprint(e.object.blueprint)
                      , i = f.ICON_LEVELUP_LOCK_LOCKED;
                    t.components.building ? i = {
                        alias: De.services.buildings.getBuildingLevelConfig(t.id).visualKeys.active
                    } : t.components.sprite && (i = {
                        alias: t.components.sprite.alias
                    }),
                    this.visual = this.addChild(ds(rr(De.services.resource.getSprite(i), {
                        anchor: {
                            x: .5,
                            y: 1
                        }
                    }), 190)),
                    this.visual.position.set(0, -25),
                    this.button = this.addChild(new fr({
                        name: "remove",
                        buttonIdle: f.BTN_EVENT_BLUEFB_IDLE,
                        buttonActive: f.BTN_EVENT_BLUEFB_DOWN
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, gI),
                        buttonSizes: {
                            width: 270,
                            height: 142
                        }
                    },{
                        text: ce.STORAGE_PLACE,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })),
                    this.button.position.set(0, 70)
                }
                ,
                t.prototype._createPurchaseVisuals = function(e) {
                    this.visual = this.addChild(rr(De.services.resource.getSprite(f.ICON_LEVELUP_LOCK_LOCKED), {
                        anchor: {
                            x: .5,
                            y: 1
                        },
                        position: {
                            x: 0,
                            y: -25
                        }
                    })),
                    e.cost ? this.button = this.addChild(new uc({
                        name: "purchase button",
                        buttonIdle: f.BTN_EVENT_GREEN_IDLE,
                        buttonActive: f.BTN_EVENT_GREEN_DOWN
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, gI),
                        buttonSizes: {
                            width: 270,
                            height: 142
                        }
                    },{
                        text: e.cost.amount.toString(),
                        textStyle: vn.buttonLabel,
                        alignment: "left",
                        position: {
                            x: 0,
                            y: -5
                        }
                    },{
                        iconImage: za[e.cost.key],
                        iconPosition: {
                            x: -60,
                            y: -4
                        }
                    })) : this.button = this.addChild(new fr({
                        name: "purchase button",
                        buttonIdle: f.BTN_EVENT_GREEN_IDLE,
                        buttonActive: f.BTN_EVENT_GREEN_DOWN
                    },{
                        buttonCorners: (0,
                        n.__assign)({}, gI),
                        buttonSizes: {
                            width: 270,
                            height: 142
                        }
                    },{
                        text: ce.NATURE_TIMER_BUTTON,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })),
                    this.button.position.set(0, 70)
                }
                ,
                t
            }(Xe.Container), EI = function(e) {
                function t(t) {
                    var i = e.call(this, {}) || this;
                    return i.priority = _r.NORMAL,
                    i._name = "StoragePopup",
                    i._headerSize = {
                        width: 516.4,
                        height: 75
                    },
                    i._popupSize = {
                        width: 1291,
                        height: 1881
                    },
                    i._popupClosing = !1,
                    i._storageService = t.storageService,
                    i._storageBubbleService = t.storageBubbleService,
                    i._rewardService = t.rewardService,
                    i._createBackground(),
                    i._scrollContainer = i._createScrollableContainer(),
                    i._fillScrollContainer(t.items),
                    i._scrollbar = i._createScrollbar(),
                    i._addBottomGradient(),
                    i._createPopupInfoButton(),
                    i._inputBlocker.off("pointerup", void 0, i),
                    i.onOpened.listenOnce((function() {
                        return (0,
                        n.__awaiter)(i, void 0, void 0, (function() {
                            return (0,
                            n.__generator)(this, (function(e) {
                                return this._inputBlocker.once("pointerup", this.close, this),
                                [2]
                            }
                            ))
                        }
                        ))
                    }
                    ), i),
                    v.GroupsCore.Updateables.add(i._scrollContainer),
                    v.GroupsCore.Updateables.add(i._scrollbar),
                    i._boundScrollCallback = i._onScroll.bind(i),
                    addEventListener("wheel", i._boundScrollCallback),
                    i._resizePopupContent(),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    De.services.analytics.design.reportStoragePopupShown(),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    removeEventListener("wheel", this._boundScrollCallback),
                    v.GroupsCore.Updateables.remove(this._scrollContainer),
                    v.GroupsCore.Updateables.remove(this._scrollbar)
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._popupClosing = !0,
                            e.prototype.close.call(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._createBackground = function() {
                    var e = this
                      , t = new Ar({
                        size: {
                            width: this._popupSize.width,
                            height: this._popupSize.height
                        },
                        headerSize: {
                            width: this._headerSize.width,
                            height: this._headerSize.height
                        },
                        headerText: ce.DECORATION_STORAGE,
                        customHeaderTextPosition: new Xe.Point(0,-this._popupSize.height / 2 + 259),
                        headerStyle: vn.dullPurpleExtraLarge,
                        customNineslice: f.POPUP_STORAGE_FRAME,
                        customNinesliceOptions: {
                            leftWidth: 645,
                            topHeight: 658,
                            rightWidth: 645,
                            bottomHeight: 586
                        },
                        customCloseButtonPosition: new Xe.Point(this._popupSize.width / 2 - 170.5,-this._popupSize.height / 2 + 287.5),
                        customCloseButtonIdle: f.BTN_CLOSE_BIG_IDLE,
                        customCloseButtonActive: f.BTN_CLOSE_BIG_DOWN
                    });
                    t.onCloseClick((function() {
                        return e.close()
                    }
                    ));
                    var i = new cr(De.services.resource.getTexture(f.POPUP_STORAGE_BACKGROUND),469,160,469,126);
                    i.anchor.set(.5),
                    i.setSizes({
                        width: 1014.5,
                        height: 1248.5
                    }),
                    i.position.set(-4, 59),
                    t.addChild(i),
                    this._content.addChild(t)
                }
                ,
                t.prototype._createScrollableContainer = function() {
                    var e = this._content.addChild(new v.ScrollableContainer({
                        friction: .8,
                        autoFitContent: !0
                    }));
                    e.position.set(-511.5, -561),
                    e.setBounds(new Xe.Rectangle(0,0,1015.5,1244.5));
                    var t = (new Xe.Graphics).beginFill(16777215).drawShape(new Xe.Rectangle(0,0,1060,1244.5)).endFill();
                    return this._content.addChild(t),
                    t.position.set(-511.5, -561),
                    e.mask = t,
                    e
                }
                ,
                t.prototype._createScrollbar = function() {
                    var e = De.services.resource.getTexture(f.UI_SCROLLBAR_STORAGE);
                    return this._content.addChild(new Vl({
                        inputAreaParent: this._content,
                        scrollableContainer: this._scrollContainer,
                        texture: e,
                        yOffset: -63,
                        xOffset: -39,
                        debug: !1
                    }))
                }
                ,
                t.prototype._fillScrollContainer = function(e) {
                    var t = (new Xe.Graphics).beginFill(0, 0).drawShape(new Xe.Rectangle(0,0,50,50)).endFill();
                    this._scrollContainer.addContent(t);
                    for (var i = Math.ceil(e.length / 3), n = 0, r = 0; r < i; r++) {
                        var o = De.services.resource.getSprite(f.POPUP_STORAGE_SHELF);
                        o.anchor.set(.5),
                        o.position.set(507.75, 395 * r + 275),
                        this._scrollContainer.addContent(o);
                        for (var a = 0; a < 3; a++) {
                            var s = e[n];
                            if (s) {
                                var _ = o.addChild(new fI(s));
                                _.position.set(290 * a - 290, 0),
                                this._addItemOnClickEvent(_, s),
                                n++
                            }
                        }
                        if (r === i - 1) {
                            var c = (new Xe.Graphics).beginFill(0, 0).drawShape(new Xe.Rectangle(0,0,50,50)).endFill();
                            c.position.set(0, o.position.y + 100),
                            this._scrollContainer.addContent(c)
                        }
                    }
                }
                ,
                t.prototype._addBottomGradient = function() {
                    var e = new cr(De.services.resource.getTexture(f.POPUP_STORAGE_GRADIENTBOTTOM),0,86,0,86);
                    e.anchor.set(.5, 1),
                    e.setSizes({
                        width: 1014.5,
                        height: 230
                    }),
                    e.position.set(0, 688),
                    this._content.addChild(e)
                }
                ,
                t.prototype._addItemOnClickEvent = function(e, t) {
                    var i = this;
                    t.state === oI.FILLED ? e.button.onClick((function() {
                        return (0,
                        n.__awaiter)(i, void 0, void 0, (function() {
                            return (0,
                            n.__generator)(this, (function(i) {
                                switch (i.label) {
                                case 0:
                                    return this._popupClosing || !(0,
                                    r.isUndefined)(this._currentBubble) ? [2] : (De.services.analytics.design.reportStoragePopupPlaceButtonPressed(),
                                    e.button.hide(),
                                    [4, this._restoreItem(t, e.visual)]);
                                case 1:
                                    return i.sent(),
                                    [4, this._storageService.removeFromStorage(t)];
                                case 2:
                                    return i.sent(),
                                    e.slotEmptied(),
                                    this.close(),
                                    [2]
                                }
                            }
                            ))
                        }
                        ))
                    }
                    )) : t.state === oI.LOCKED && e.button.onClick((function() {
                        i._popupClosing || (t.cost ? De.services.inventory.hasAmount(t.cost.key, t.cost.amount) && (De.services.inventory.spendAmount(t.cost.key, t.cost.amount),
                        i._storageService.unlockNewSlot(t),
                        e.slotEmptied()) : (i._storageService.unlockNewSlot(t),
                        e.slotEmptied()))
                    }
                    ))
                }
                ,
                t.prototype._restoreItem = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this._currentBubble || (this._currentBubble = this._storageBubbleService.createBubble()),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return i.sent(),
                                [2, this._rewardService.giveObjectRewardWithAnimation({
                                    rewardBlueprintID: e.object.blueprint,
                                    blueprintComponents: {},
                                    container: this,
                                    animationEndEvent: this.onClosed,
                                    bubble: this._currentBubble,
                                    bubblePosition: new Xe.Point(0,-200),
                                    image: t
                                })]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onScroll = function(e) {
                    this._scrollContainer.stopAnimation();
                    var t = new Xe.Point(this._scrollContainer.getPosition().x,this._scrollContainer.getPosition().y - e.deltaY);
                    this._scrollContainer.setPosition(t)
                }
                ,
                t.prototype._createPopupInfoButton = function() {
                    var e = this
                      , t = this._content.addChild(new hr({
                        name: "storage popup info button",
                        buttonIdle: f.ICON_HELP,
                        buttonActive: f.ICON_HELP
                    }));
                    t.position.set(291.75, -736),
                    t.on("pointerdown", (function() {
                        e.close(),
                        e._storageService.openOnboardingPopup()
                    }
                    ))
                }
                ,
                t
            }(yr), mI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.storageUpdated = new r.Event,
                    t._model = new vI,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "slots", {
                    get: function() {
                        return this._model.slots
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "filledSlots", {
                    get: function() {
                        return this.slots.filter((function(e) {
                            return e.state === oI.FILLED
                        }
                        ))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.hasSeenOnboarding = function() {
                    return this._model.hasSeenOnboarding
                }
                ,
                t.prototype.canShowButton = function() {
                    return this._model.getFilledItems().length > 0 || this._isDecorativePresent()
                }
                ,
                t.prototype.isEmptySlotAvailable = function() {
                    return this.slots.some((function(e) {
                        return e.state === oI.EMPTY
                    }
                    ))
                }
                ,
                t.prototype.storeObject = function(e) {
                    this._model.addItem(e),
                    this.storageUpdated.fire(),
                    De.services.analytics.design.reportStorageOccupiedSlots(this._model.getFilledItems().length)
                }
                ,
                t.prototype.isStored = function(e) {
                    return this._model.isStored(e)
                }
                ,
                t.prototype.removeFromStorage = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._model.removeItem(e),
                            this.storageUpdated.fire(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openOnboardingPopup = function(e) {
                    return void 0 === e && (e = !1),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, De.services.navigation.closeAllPopups()];
                            case 1:
                                return n.sent(),
                                [4, De.services.lazyLoad.prioritizeGroup(hn.STORAGE)];
                            case 2:
                                return n.sent(),
                                [4, De.services.navigation.showPopup(lI, {})];
                            case 3:
                                return t = n.sent(),
                                this._model.hasSeenOnboarding = !0,
                                e && t.onClosed.addListener((function() {
                                    i.openStoragePopup()
                                }
                                ), this),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openStoragePopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.navigation.closeAllPopups()];
                            case 1:
                                return t.sent(),
                                De.services.lazyLoad.prioritizeGroup(hn.STORAGE).then((function() {
                                    return De.services.navigation.showPopup(EI, {
                                        storageService: e,
                                        storageBubbleService: e.services.storageBubble,
                                        mapGridView: e.services.mapGridView,
                                        cameraService: e.services.cameraService,
                                        rewardService: e.services.rewardService,
                                        items: e.slots
                                    })
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.openStorageIsFullPopup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, De.services.navigation.closeAllPopups()];
                            case 1:
                                return i.sent(),
                                De.services.lazyLoad.prioritizeGroup(hn.STORAGE).then((function() {
                                    return De.services.navigation.showPopup(cI, {
                                        storageService: t,
                                        blueprintID: e
                                    })
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.unlockNewSlot = function(e) {
                    this._model.unlockNewSlot(e)
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    var e = this;
                    this.services.hudService.hideHudElement(Ns.StorageButtonUI, !0),
                    r.TimeDelay.nextFrame().then((function() {
                        e.canShowButton() ? e.services.hudService.showHudElement(Ns.StorageButtonUI) : (De.services.buildings.onBuildingStateChanged.addListener(e._onTrigger, e),
                        e._setupDecorativeFamilyListener(),
                        e._setupStorageBubbleFamilyListener())
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    var e, t, i, r;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            return De.services.autosave.unregisterModel(this._model),
                            De.services.buildings.onBuildingStateChanged.removeListener(this._onTrigger, this),
                            null === (e = this._bubbleFamily) || void 0 === e || e.onGameObjectAdded.removeListener(this._onTrigger, this),
                            null === (t = this._decoFamily) || void 0 === t || t.onGameObjectAdded.removeListener(this._onTrigger, this),
                            null === (i = this._bubbleFamily) || void 0 === i || i.destroy(),
                            null === (r = this._decoFamily) || void 0 === r || r.destroy(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._setupDecorativeFamilyListener = function() {
                    this._decoFamily = new __(this.services.world,new c_([Ke.Decorative])),
                    this._decoFamily.onGameObjectAdded.addListener(this._onTrigger, this)
                }
                ,
                t.prototype._setupStorageBubbleFamilyListener = function() {
                    this._bubbleFamily = new __(this.services.world,new c_([Ke.StorageBubble])),
                    this._bubbleFamily.onGameObjectAdded.addListener(this._onTrigger, this)
                }
                ,
                t.prototype._isDecorativePresent = function() {
                    return this._hasDecorativeObjectInBubble() || this._hasRepairedDecorativeBuildingOnGrid() || this._hasDecorativeObjectOnGrid()
                }
                ,
                t.prototype._hasDecorativeObjectOnGrid = function() {
                    return this.services.gridFilter.getFilledCellsWithBehaviors([Ke.Decorative]).some((function(e) {
                        var t;
                        return !(null === (t = e.content) || void 0 === t ? void 0 : t.hasBehavior(Ke.Building))
                    }
                    ))
                }
                ,
                t.prototype._hasRepairedDecorativeBuildingOnGrid = function() {
                    return this.services.gridFilter.getFilledCellsWithBehaviors([Ke.Decorative, Ke.Building]).some((function(e) {
                        var t, i = null === (t = e.content) || void 0 === t ? void 0 : t.getBehavior(Ke.Building);
                        return i && De.services.buildings.isBuildingActive(i.ID)
                    }
                    ))
                }
                ,
                t.prototype._hasDecorativeObjectInBubble = function() {
                    return this.services.storageBubble.getBubblesWithBehaviors([Ke.Decorative]).length > 0
                }
                ,
                t.prototype._onTrigger = function() {
                    var e, t, i, o;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return n.sent(),
                                this.canShowButton() && (this.services.hudService.showHudElement(Ns.StorageButtonUI),
                                De.services.buildings.onBuildingStateChanged.removeListener(this._onTrigger, this),
                                null === (e = this._bubbleFamily) || void 0 === e || e.onGameObjectAdded.removeListener(this._onTrigger, this),
                                null === (t = this._decoFamily) || void 0 === t || t.onGameObjectAdded.removeListener(this._onTrigger, this),
                                null === (i = this._bubbleFamily) || void 0 === i || i.destroy(),
                                null === (o = this._decoFamily) || void 0 === o || o.destroy()),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), yI = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._taskService = De.services.tasks,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._taskService.onNewTaskTracked.addListener(this._onNewTaskTracked, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    var e = this;
                    (0,
                    r.isUndefined)(this._taskService.trackedTask) ? this.services.hudService.hideHudElement(Ns.TaskButtonUI, !0) : De.services.onboardingGameService.onboardingRunningAtStartSession.then((function(t) {
                        t || e.services.hudService.showHudElement(Ns.TaskButtonUI)
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._taskService.onNewTaskTracked.removeListener(this._onNewTaskTracked, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onNewTaskTracked = function(e) {
                    (0,
                    r.isUndefined)(e) ? this.services.hudService.hideHudElement(Ns.TaskButtonUI) : (0,
                    r.isUndefined)(this.services.onboarding.activeTrackKey) && this.services.hudService.showHudElement(Ns.TaskButtonUI)
                }
                ,
                t
            }(Go), TI = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.HIGH,
                    i._name = "ExtraWorkerPopup",
                    i._gameWorkerService = t.gameWorkerService,
                    i._marketplaceService = t.marketplaceService,
                    i._extraWorkerConfig = t.extraWorkerConfig,
                    i._displayingTrialWorker = !1,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    this._createHeader(),
                    this._createWorkerCount(),
                    this._createSubText(),
                    this._createButtons(),
                    e(),
                    De.services.analytics.design.reportExtraWorkerOverlayAction("show")
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createHeader = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 400,
                        fitWidth: De.services.canvas.width
                    });
                    e.style = vn.lightExtraLarge,
                    this._headerText = new v.Label(nr(uI || (uI = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.EXTRA_WORKER_POPUP_HEADER),e),
                    this._headerText.anchor.set(.5),
                    this._headerText.position.set(0, De.services.canvas.top + (De.services.canvas.targetOrientation === v.Orientation.Landscape ? 150 : 200)),
                    this._content.addChild(this._headerText)
                }
                ,
                t.prototype._createWorkerCount = function() {
                    this._character = De.services.resource.getSprite(f.ICON_CHARACTER_WORKER),
                    this._character.scale.set(De.services.canvas.targetOrientation === v.Orientation.Landscape ? 1.25 : 1.5),
                    this._character.anchor.set(.5),
                    this._character.position.set(0, this._headerText.position.y + this._character.height / 2 + (De.services.canvas.targetOrientation === v.Orientation.Landscape ? 100 : 150)),
                    this._content.addChild(this._character);
                    var e = "0/" + this._gameWorkerService.workerAmount;
                    this._pillboxText = new Xe.Text(String(e),vn.lightBoldLarge),
                    this._pillboxText.anchor.set(.5),
                    this._pillboxText.position.set(this._character.position.x, this._character.position.y + this._character.height / 2 + 100),
                    this._pillBox = new cr(De.services.resource.getTexture(f.POPUP_BG_BLACK_9SLICE),5,0,5,0),
                    this._pillBox.setSizes({
                        width: this._pillboxText.width + 100,
                        height: this._pillBox.height + 100
                    }),
                    this._pillBox.position.set(this._pillboxText.position.x, this._pillboxText.position.y),
                    this._pillBox.anchor.set(.5),
                    this._content.addChild(this._pillBox),
                    this._content.addChild(this._pillboxText)
                }
                ,
                t.prototype._createSubText = function() {
                    var e = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 400,
                        fitWidth: De.services.canvas.width / 2 + 100
                    });
                    e.style = vn.lightBoldLarge,
                    this._subText = new v.Label(nr(dI || (dI = (0,
                    n.__makeTemplateObject)(["", "", ""], ["", "", ""])), ce.EXTRA_WORKER_POPUP_SUBTEXT, this._displayingTrialWorker ? this._extraWorkerConfig.freeWorkerTime.days : this._extraWorkerConfig.extraWorkerTime.days),e),
                    this._subText.anchor.set(.5),
                    this._subText.position.set(0, this._pillBox.position.y + (De.services.canvas.targetOrientation === v.Orientation.Landscape ? 150 : 200)),
                    this._content.addChild(this._subText)
                }
                ,
                t.prototype._createButtons = function() {
                    var e = this;
                    this._displayingTrialWorker ? this._purchaseButton = new fr({
                        name: "extraWorkerTrial",
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE
                    },{
                        buttonSizes: {
                            width: 300,
                            height: 90
                        }
                    },{
                        textStyle: vn.buttonLabel,
                        text: ce.MARKET_BUTTON_TEXT,
                        position: {
                            x: 0,
                            y: -5
                        }
                    }) : this._purchaseButton = new uc({
                        name: "extraWorkerPurchase",
                        buttonIdle: f.BTN_DEFAULT_BLUE_IDLE,
                        buttonActive: f.BTN_DEFAULT_BLUE_ACTIVE
                    },{
                        buttonSizes: {
                            width: 300,
                            height: 90
                        }
                    },{
                        text: this._extraWorkerConfig.extraWorkerCost.amount.toString(),
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 35,
                            y: -5
                        }
                    },{
                        iconImage: za[this._extraWorkerConfig.extraWorkerCost.key],
                        iconPosition: {
                            x: -75,
                            y: -5
                        },
                        iconScale: {
                            x: 1.25,
                            y: 1.25
                        }
                    }),
                    this._purchaseButton.position.set(this._subText.position.x, this._subText.position.y + (De.services.canvas.targetOrientation === v.Orientation.Landscape ? 150 : 300)),
                    this._purchaseButton.onClick((function() {
                        if (e._displayingTrialWorker || De.services.analytics.design.reportExtraWorkerOverlayAction("purchasePressed"),
                        De.services.inventory.hasAmount(e._extraWorkerConfig.extraWorkerCost.key, e._extraWorkerConfig.extraWorkerCost.amount)) {
                            var t = e._displayingTrialWorker ? e._extraWorkerConfig.freeWorkerTime : e._extraWorkerConfig.extraWorkerTime;
                            De.services.inventory.deductItems([{
                                key: e._extraWorkerConfig.extraWorkerCost.key,
                                amount: e._extraWorkerConfig.extraWorkerCost.amount
                            }]);
                            var i = 24 * t.days * 60 * 60 * 1e3;
                            i += 60 * t.hours * 60 * 1e3,
                            i += 60 * t.minutes * 1e3,
                            e._gameWorkerService.addNewWorker(i, "PurchasedWorker"),
                            e._displayingTrialWorker ? De.services.analytics.design.reportExtraWorkerOverlayAction("activateTrial") : (De.services.analytics.design.reportExtraWorkerOverlayAction("purchaseComplete"),
                            De.services.analytics.design.reportExtraWorkersActive(e._gameWorkerService.workerAmount - 1)),
                            e.close()
                        } else
                            e._marketplaceService.openMarketplaceShop(Ua.GEMS)
                    }
                    )),
                    this._content.addChild(this._purchaseButton),
                    this._cancelButton = new Xe.Text(nr(hI || (hI = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.HEAVY_OBJECT_OVERLAY_CLOSE),vn.lightBoldMedium),
                    this._cancelButton.anchor.set(.5),
                    this._cancelButton.position.set(this._purchaseButton.position.x, this._purchaseButton.position.y + (De.services.canvas.targetOrientation === v.Orientation.Landscape ? 100 : 150)),
                    this._cancelButton.interactive = !0,
                    this._cancelButton.addListener("pointertap", (function() {
                        e.close()
                    }
                    )),
                    this._content.addChild(this._cancelButton)
                }
                ,
                t
            }(yr);
            !function(e) {
                e[e.FREE = 0] = "FREE",
                e[e.BUSY = 1] = "BUSY"
            }(pI || (pI = {}));
            var AI, CI, II = function() {
                function e(e) {
                    var t = e.id
                      , i = e.state
                      , n = e.position
                      , o = e.timerID
                      , a = e.tag;
                    this.onStateChanged = new r.Event,
                    this.removeAfterTask = !1,
                    this._id = t,
                    this._state = i,
                    this._position = n,
                    this._timerID = o,
                    this._tag = a,
                    this._logger = Ie.Of("GameWorker with ID: ".concat(t))
                }
                return Object.defineProperty(e.prototype, "state", {
                    get: function() {
                        return this._state
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "id", {
                    get: function() {
                        return this._id
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "position", {
                    get: function() {
                        return (0,
                        n.__assign)({}, this._position)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "timerID", {
                    get: function() {
                        return this._timerID
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.setAsBusy = function(e) {
                    this._changeState(pI.BUSY, e)
                }
                ,
                e.prototype.setAsFree = function() {
                    this._changeState(pI.FREE, {
                        column: -1,
                        row: -1
                    })
                }
                ,
                e.prototype.setAsRemoveAfterTask = function() {
                    this.removeAfterTask = !0
                }
                ,
                e.prototype.serialize = function() {
                    return {
                        id: this._id,
                        state: this._state,
                        position: (0,
                        n.__assign)({}, this._position),
                        timerID: this._timerID,
                        tag: this._tag
                    }
                }
                ,
                e.prototype._changeState = function(e, t) {
                    e !== this._state ? (this._state = e,
                    this._position = t,
                    this.onStateChanged.fire(this)) : this._logger.warn("setting to the same state is ignored!")
                }
                ,
                e
            }(), SI = Rp({
                2: function(e) {
                    return {
                        workers: e,
                        nextWorkerID: 1,
                        freeWorkerClaimed: !1
                    }
                }
            }), OI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onWorkersStateChanged = new r.Event,
                    t._name = "GameWorkersModel",
                    t._version = 2,
                    t._workers = [],
                    t._nextWorkerID = 1,
                    t._freeWorkerClaimed = !1,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "workers", {
                    get: function() {
                        return this._workers
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "freeWorkerClaimed", {
                    get: function() {
                        return this._freeWorkerClaimed
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.addNewWorker = function(e, t) {
                    this._nextWorkerID += 1;
                    var i = new II({
                        id: this._nextWorkerID,
                        state: pI.FREE,
                        position: {
                            row: -1,
                            column: -1
                        },
                        timerID: e,
                        tag: t
                    });
                    return i.onStateChanged.addListener(this._onWorkerStateChanged, this),
                    this._workers.push(i),
                    this._freeWorkerClaimed || (this._freeWorkerClaimed = !0),
                    this._onWorkerStateChanged(i),
                    i
                }
                ,
                t.prototype.removeWorker = function(e) {
                    e.onStateChanged.removeListener(this._onWorkerStateChanged, this),
                    this._workers.splice(this._workers.indexOf(e), 1),
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons(_e.WORKERS_CONFIG)];
                            case 1:
                                return t.sent(),
                                [4, De.services.resource.getJson(_e.WORKERS_CONFIG)];
                            case 2:
                                return e = t.sent(),
                                this.onDataReceive(this._getDefaultData(e)),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    var t = this;
                    this._workers = e.workers.map((function(e) {
                        return new II(e)
                    }
                    )),
                    this._workers.forEach((function(e) {
                        return e.onStateChanged.addListener(t._onWorkerStateChanged, t)
                    }
                    )),
                    this._nextWorkerID = e.nextWorkerID,
                    this._freeWorkerClaimed = e.freeWorkerClaimed
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        workers: this._workers.map((function(e) {
                            return e.serialize()
                        }
                        )),
                        nextWorkerID: this._nextWorkerID,
                        freeWorkerClaimed: this._freeWorkerClaimed
                    }
                }
                ,
                t.prototype.migrateData = function(e) {
                    return SI(e, 2)
                }
                ,
                t.prototype._onWorkerStateChanged = function(e) {
                    this.saveData(),
                    this.onWorkersStateChanged.fire(e)
                }
                ,
                t.prototype._getDefaultData = function(e) {
                    var t = this
                      , i = e.DEFAULT_AMOUNT;
                    return {
                        workers: Array.from({
                            length: i
                        }, (function(e, i) {
                            return {
                                id: t._nextWorkerID,
                                state: pI.FREE,
                                position: {
                                    row: -1,
                                    column: -1
                                }
                            }
                        }
                        )),
                        nextWorkerID: this._nextWorkerID,
                        freeWorkerClaimed: this._freeWorkerClaimed
                    }
                }
                ,
                t
            }($n), bI = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.onWorkersStateChanged = new r.Event,
                    t.onWorkerRemoved = new r.Event,
                    t._model = new OI,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "workerAmount", {
                    get: function() {
                        return this._model.workers.length
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "getTotalFreeWorkers", {
                    get: function() {
                        return this._model.workers.filter((function(e) {
                            return e.state === pI.FREE
                        }
                        )).length
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "freeWorkerClaimed", {
                    get: function() {
                        return this._model.freeWorkerClaimed
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.openExtraWorkerPopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons(_e.EXTRA_WORKER_CONFIG)];
                            case 1:
                                return t.sent(),
                                e = De.services.resource.getJsonCopy(_e.EXTRA_WORKER_CONFIG),
                                De.services.navigation.showPopup(TI, {
                                    gameWorkerService: this,
                                    marketplaceService: this.services.marketplaceService,
                                    extraWorkerConfig: e
                                }, !1),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.animateToLootableSourceObject = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return 0 === (e = this.services.gridFilter.getFilledCellsWithBehaviors([Ke.Lootable, Ke.GridPosition, Ke.InteractionPriorityTurn, Ke.MapSource])).length ? [2] : (t = this.services.mapGrid.getContent(e[0].column, e[0].row)) ? (i = t.getBehavior(Ke.GridPosition),
                            (r = this.services.mapGrid.getCell(i.column, i.row)) ? (this.services.cameraService.animateCameraToCell(r).then((function() {
                                o.services.interactionHelper.simulateClick.fire(t)
                            }
                            )),
                            [2]) : [2]) : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.animateToMapSourceAndShowArrows = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return e = this.services.gridFilter.getClosestCellWithBehaviors([Ke.MapSource], this.services.visibleCells.getCenterCellPosition()),
                                [4, this.services.cameraService.animateCameraToCell(e).then((function() {
                                    t.services.gridFilter.getFilledCellsWithBehaviors([Ke.MapSource]).forEach((function(e) {
                                        var t;
                                        return null === (t = e.content) || void 0 === t ? void 0 : t.addBehavior(new Li({}))
                                    }
                                    )),
                                    t.services.interactionService.onGestureTapStart.listenOnce((function() {
                                        t.services.gridFilter.getFilledCellsWithBehaviors([Ke.ArrowPointer]).forEach((function(e) {
                                            var t;
                                            return null === (t = e.content) || void 0 === t ? void 0 : t.removeBehaviorByType(Ke.ArrowPointer)
                                        }
                                        ))
                                    }
                                    ), t)
                                }
                                ))];
                            case 1:
                                return i.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showNoAvailableWorkFloater = function() {
                    var e = v.Vector2.fromPoint(this.services.cameraService.getCameraPosition())
                      , t = this.services.cameraService.getCameraScale();
                    e.x /= t.x,
                    e.y /= t.y,
                    new rf(this.services.mapGridView.getLayer(Yo.PREVIEW_UI),e,{
                        text: nr(AI || (AI = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.WORKER_NO_WORK_AVAILABLE),
                        styles: vn.warningText
                    })
                }
                ,
                t.prototype.hasEnoughWorkers = function(e) {
                    return this._model.workers.filter((function(e) {
                        return e.state === pI.FREE
                    }
                    )).length >= e
                }
                ,
                t.prototype.getFreeWorker = function() {
                    return this._model.workers.find((function(e) {
                        return e.state === pI.FREE
                    }
                    )) || null
                }
                ,
                t.prototype.getWorkerByID = function(e) {
                    return this._model.workers.find((function(t) {
                        return t.id === e
                    }
                    ))
                }
                ,
                t.prototype.getWorkerByTimerID = function(e) {
                    return this._model.workers.find((function(t) {
                        return t.timerID === e
                    }
                    ))
                }
                ,
                t.prototype.addNewWorker = function(e, t) {
                    var i;
                    return (0,
                    r.isUndefined)(e) || (i = De.services.timer.addTimer(e)).onTimerFinished.addListener(this._workerTimerFinished, this),
                    this._model.addNewWorker(null == i ? void 0 : i.id, t)
                }
                ,
                t.prototype.removeWorkerFromModel = function(e) {
                    this._removeWorkerFromModel(e)
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.autosave.registerModel(this._model)];
                            case 1:
                                return t.sent(),
                                this._model.onWorkersStateChanged.addListener(this._onWorkersStateChanged, this),
                                this._model.workers.forEach((function(t) {
                                    if (t.timerID) {
                                        var i = De.services.timer.getTimerByID(t.timerID);
                                        i.isFinished ? e._workerTimerFinished(i) : i.onTimerFinished.addListener(e._workerTimerFinished, e)
                                    }
                                }
                                )),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    this._freeOrphanedWorkers()
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._model.onWorkersStateChanged.removeListener(this._onWorkersStateChanged, this),
                            De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._workerTimerFinished = function(e) {
                    var t = this.getWorkerByTimerID(e.id);
                    (null == t ? void 0 : t.state) === pI.FREE ? this._removeWorkerFromModel(t) : null == t || t.setAsRemoveAfterTask()
                }
                ,
                t.prototype._onWorkersStateChanged = function(e) {
                    e.removeAfterTask && this._removeWorkerFromModel(e),
                    this.onWorkersStateChanged.fire(e)
                }
                ,
                t.prototype._removeWorkerFromModel = function(e) {
                    this._model.removeWorker(e),
                    this.onWorkerRemoved.fire(e),
                    De.services.autosave.forceSave()
                }
                ,
                t.prototype._freeOrphanedWorkers = function() {
                    var e = this;
                    r.TimeDelay.after(500).promise.then((function() {
                        e._model.workers.filter((function(e) {
                            return e.state === pI.BUSY
                        }
                        )).forEach((function(t) {
                            var i = t.position
                              , n = e.services.mapGrid.getContent(i.column, i.row);
                            return n ? n.getBehavior(Ke.CoolDown) ? void 0 : (e._logger.error("Orphaned worker freed! (no cooldown)"),
                            void t.setAsFree()) : (e._logger.error("Orphaned worker freed! (no gameobject)"),
                            void t.setAsFree())
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go);
            !function(e) {
                e[e.OVERRIDE = 0] = "OVERRIDE",
                e[e.INSERT = 1] = "INSERT",
                e[e.BEFORE = 2] = "BEFORE",
                e[e.AFTER = 3] = "AFTER"
            }(CI || (CI = {}));
            var RI, wI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "CrateContentModel",
                    t._version = 1,
                    t._queue = [],
                    t._receivedValuables = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getAll = function() {
                    return this._queue.map((function(e) {
                        return {
                            remaining: e.remaining,
                            blueprint: e.blueprint
                        }
                    }
                    ))
                }
                ,
                t.prototype.addToQueue = function(e, t, i) {
                    void 0 === t && (t = 0),
                    void 0 === i && (i = CI.AFTER);
                    for (var n = void 0, r = 0, o = {
                        blueprint: e,
                        remaining: t
                    }; r < this._queue.length; r++) {
                        if (this._queue[r].remaining === t) {
                            n = this._queue[r];
                            break
                        }
                        if (this._queue[r].remaining > t)
                            break
                    }
                    if (n)
                        switch (i) {
                        case CI.INSERT:
                            this._shiftBackwardsFrom(r),
                            this._queue.splice(r, 0, o);
                            break;
                        case CI.OVERRIDE:
                            this._queue.splice(r, 1, o);
                            break;
                        case CI.BEFORE:
                            this._addBefore(o, r);
                            break;
                        default:
                        case CI.AFTER:
                            this._addAfter(o, r)
                        }
                    else
                        this._queue.splice(r, 0, o);
                    this.saveData()
                }
                ,
                t.prototype.pop = function() {
                    if (0 === this._queue.length)
                        return null;
                    var e = null;
                    return 0 === this._queue[0].remaining && (e = this._queue[0].blueprint,
                    this._queue.shift()),
                    this._queue.forEach((function(e) {
                        return e.remaining--
                    }
                    )),
                    this.saveData(),
                    e
                }
                ,
                t.prototype.contains = function(e) {
                    if (Array.isArray(e)) {
                        for (var t = function(t) {
                            if (i._queue.some((function(i) {
                                return i.blueprint === e[t]
                            }
                            )))
                                return {
                                    value: !0
                                }
                        }, i = this, n = 0; n < e.length; n++) {
                            var r = t(n);
                            if ("object" == typeof r)
                                return r.value
                        }
                        return !1
                    }
                    return this._queue.some((function(t) {
                        return t.blueprint === e
                    }
                    ))
                }
                ,
                t.prototype.hasValuableReceived = function(e) {
                    return !!this._receivedValuables.find((function(t) {
                        return t === e
                    }
                    ))
                }
                ,
                t.prototype.addValuableReceived = function(e) {
                    this._receivedValuables.push(e),
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._queue = e.queue,
                    this._receivedValuables = e.receivedValuables || [],
                    this._sortContent()
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        queue: this._queue,
                        receivedValuables: this._receivedValuables
                    }
                }
                ,
                t.prototype._addAfter = function(e, t) {
                    for (var i = t; this._queue[i] && this._queue[i].remaining === e.remaining; )
                        e.remaining++,
                        i++;
                    this._queue.splice(i, 0, e)
                }
                ,
                t.prototype._shiftBackwardsFrom = function(e) {
                    for (var t = e, i = this._queue[e].remaining; this._queue[t] && this._queue[t].remaining <= i + 1; )
                        i++,
                        t++;
                    for (var n = e; n < t; n++)
                        this._queue[n].remaining++
                }
                ,
                t.prototype._addBefore = function(e, t) {
                    var i = t;
                    for (e.remaining -= 1; i > 0 && this._queue[i - 1].remaining === e.remaining; )
                        i--,
                        e.remaining--;
                    this._queue.splice(i, 0, e),
                    0 === i && this._shiftBackwardsFrom(0)
                }
                ,
                t.prototype._sortContent = function() {
                    this._queue.sort((function(e, t) {
                        return e.remaining - t.remaining
                    }
                    ))
                }
                ,
                t
            }($n), DI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._model = new wI,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getGameObject = function() {
                    var e = this._model.pop();
                    if (e) {
                        if (De.services.blueprintCollection.hasBlueprint(e))
                            return De.services.gameObjectFactory.createById(e);
                        this._logger.warn("cannot spawned forced object with unknown blueprint ".concat(e))
                    }
                    var t = this.services.randomLoot.getRandomContentForCrate();
                    return De.services.gameObjectFactory.createById(t)
                }
                ,
                t.prototype.queueContent = function(e, t, i) {
                    void 0 === t && (t = 0),
                    void 0 === i && (i = CI.AFTER),
                    this._model.addToQueue(e, t, i)
                }
                ,
                t.prototype.doesQueueContain = function(e) {
                    return this._model.contains(e)
                }
                ,
                t.prototype.hasValuableReceived = function(e) {
                    return this._model.hasValuableReceived(e)
                }
                ,
                t.prototype.addValuableReceived = function(e) {
                    this._model.addValuableReceived(e)
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go);
            !function(e) {
                e.TICKETS = "tickets"
            }(RI || (RI = {}));
            var NI, LI = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons([_e.CRATE_CONTENT_CONFIG, _e.CRATE_CONTENT_VALUABLE_SPAWN_CONFIG])];
                            case 1:
                                return e.sent(),
                                this._config = De.services.resource.getJson(_e.CRATE_CONTENT_CONFIG),
                                this._valuableSpawnConfig = De.services.resource.getJsonCopy(_e.CRATE_CONTENT_VALUABLE_SPAWN_CONFIG),
                                this._crateContentService = this.services.crateContent,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    var e = this;
                    De.services.inventory.getInventoryItem(Cn.TICKETS).onChanged.addListener(this._onTicketsChanged, this),
                    this._doInitialTicketCheck(),
                    this._valuableSpawnConfig.forEach((function(t) {
                        e.services.crateContent.hasValuableReceived(t.valuableID) || (e.services.crateContent.queueContent(t.blueprintId, t.delay, CI.INSERT),
                        e.services.crateContent.addValuableReceived(t.valuableID))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.inventory.getInventoryItem(Cn.TICKETS).onChanged.removeListener(this._onTicketsChanged, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._doInitialTicketCheck = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, o, a, s;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e = this._config.contents.find((function(e) {
                                    return e.id === RI.TICKETS
                                }
                                )),
                                e ? [4, r.TimeDelay.nextFrame()] : [2];
                            case 1:
                                return n.sent(),
                                t = De.services.inventory.getInventoryItem(Cn.TICKETS),
                                i = this._crateContentService.doesQueueContain(e.blueprints),
                                o = 0 !== this.services.gridFilter.getBlueprintCount(e.blueprints[0]),
                                i || o || (0 === t.amount ? (a = e.first_delay,
                                s = r.ArrayUtility.getRandomItem(e.blueprints),
                                this.services.crateContent.queueContent(s, a, CI.INSERT)) : this._queueContent(e, t.amount)),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onTicketsChanged = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return n.sent(),
                                t = e.current,
                                (i = this._config.contents.find((function(e) {
                                    return e.id === RI.TICKETS
                                }
                                ))) ? (this.services.gridFilter.getBlueprintCount(i.blueprints[0]) + t >= i.max_items || this._queueContent(i, t),
                                [2]) : [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._queueContent = function(e, t) {
                    if (!(t >= e.max_items || this._crateContentService.doesQueueContain(e.blueprints))) {
                        var i = r.Random.int(e.min_delay, e.max_delay)
                          , n = r.ArrayUtility.getRandomItem(e.blueprints);
                        this.services.crateContent.queueContent(n, i, CI.INSERT)
                    }
                }
                ,
                t
            }(Go), BI = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.openDailyBonusPopup = function() {}
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return t._onOpenPopupEvent.addListener(this._onDailyBonusCheatExecuted, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    De.services.dailyBonusService.checkedThisSession || this._waitForOnboarding()
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._waitForOnboarding = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return De.services.inventory.getAmount(An.LEVEL) < 1 ? (De.services.actions.on("levelUp.".concat(1), this._waitForOnboarding, this),
                                [3, 3]) : [3, 1];
                            case 1:
                                return [4, De.services.onboardingGameService.onboardingRunningAtStartSession];
                            case 2:
                                e.sent() ? De.services.onboardingGameService.onInteractionReadyEvent.listenOnce(this._onInteractionReady, this) : this._onInteractionReady(),
                                e.label = 3;
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onInteractionReady = function() {
                    De.services.dailyBonusService.checkIfPopupShouldBeShown(this.services.storageBubble, this.services.mapGridView, this.services.rewardService)
                }
                ,
                t.prototype._onDailyBonusCheatExecuted = function() {
                    De.services.dailyBonusService.checkIfPopupShouldBeShown(this.services.storageBubble, this.services.mapGridView, this.services.rewardService, !0)
                }
                ,
                t._onOpenPopupEvent = new r.Event,
                t
            }(Go), PI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "DetachedObjectsModel",
                    t._version = 1,
                    t._store = {},
                    t._detachedRunTimeObjects = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getStoredObjectData = function() {
                    return this._store
                }
                ,
                t.prototype.getDefaultPosition = function() {
                    return {
                        row: -1,
                        column: -1
                    }
                }
                ,
                t.prototype.addDetachedObject = function(e, t) {
                    this._detachedRunTimeObjects.push({
                        origin: e,
                        gameObject: t
                    }),
                    this._saveState(e, t)
                }
                ,
                t.prototype.deleteDetachedObject = function(e) {
                    var t = this;
                    this._detachedRunTimeObjects.filter((function(t) {
                        return t.gameObject === e
                    }
                    )).forEach((function(e) {
                        t._deleteState(e.origin),
                        t._detachedRunTimeObjects.splice(t._detachedRunTimeObjects.indexOf(e), 1)
                    }
                    ))
                }
                ,
                t.prototype.getDetachedObject = function(e) {
                    return this._detachedRunTimeObjects.find((function(t) {
                        return t.gameObject === e
                    }
                    ))
                }
                ,
                t.prototype.clear = function() {
                    this._store = {},
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._store = e
                }
                ,
                t.prototype.onDataSave = function() {
                    return this._store
                }
                ,
                t.prototype._saveState = function(e, t) {
                    var i = e.column
                      , n = e.row
                      , r = {}
                      , o = t.getBlueprintID();
                    De.services.blueprintCollection.hasBlueprint(o) && (r = De.services.blueprintCollection.getBlueprint(o).components),
                    this._store[ql(i, n)] = t.serialize(r),
                    this.saveData()
                }
                ,
                t.prototype._deleteState = function(e) {
                    var t = ql(e.column, e.row);
                    this._store[t] && (delete this._store[t],
                    this.saveData())
                }
                ,
                t
            }($n), kI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._model = new PI,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.addGameObject = function(e, t) {
                    this._model.getDetachedObject(e) ? this._logger.warn("DetachedObjectService.addGameObject:: detached object already added") : this._model.addDetachedObject(t, e)
                }
                ,
                t.prototype.removeDetachedGameObject = function(e) {
                    var t = this._model.getDetachedObject(e);
                    t ? this._model.deleteDetachedObject(t.gameObject) : this._logger.warn("DetachedObjectService.removeGameObject:: detached object wasn't added")
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    this._restoreDetachedObjects()
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._restoreDetachedObjects = function() {
                    var e = this._model.getStoredObjectData();
                    for (var t in e) {
                        var i = e[t]
                          , n = Ql(t)
                          , r = De.services.gameObjectFactory.createFromSerializedData(i);
                        r ? (r.addBehavior(new Rt(n)),
                        this.services.world.addGameObject(r),
                        this.services.mapGrid.setContent(n.column, n.row, r)) : this._logger.warn("could not restore detached object!")
                    }
                    this._model.clear()
                }
                ,
                t
            }(Go), xI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "StorageBubbleModel",
                    t._version = 1,
                    t._registeredObjects = [],
                    t._currentData = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.registerGameObject = function(e) {
                    this._registeredObjects.includes(e) ? this._logger.error("Can't add object to model as it is already registered!") : (this._registeredObjects.push(e),
                    e.onBehaviorAdded.addListener(this._onObjectUpdated, this),
                    e.onBehaviorRemoved.addListener(this._onObjectUpdated, this),
                    this.saveData())
                }
                ,
                t.prototype.unregisterGameObject = function(e) {
                    this._registeredObjects.includes(e) ? (this._registeredObjects.splice(this._registeredObjects.indexOf(e), 1),
                    e.onBehaviorAdded.removeListener(this._onObjectUpdated, this),
                    e.onBehaviorRemoved.removeListener(this._onObjectUpdated, this),
                    this.saveData()) : this._logger.error("Can't remove object from model as it is not registered!")
                }
                ,
                t.prototype.getRegisteredObjects = function() {
                    return this._registeredObjects.concat([])
                }
                ,
                t.prototype.getCurrentData = function() {
                    return this._currentData
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._currentData = e
                }
                ,
                t.prototype.onDataSave = function() {
                    return this._currentData = this._registeredObjects.map((function(e) {
                        return e.serialize({})
                    }
                    )).filter((function(e) {
                        return !!e
                    }
                    )),
                    this._currentData
                }
                ,
                t.prototype._onObjectUpdated = function(e) {
                    e.behavior.serializable && this.saveData()
                }
                ,
                t
            }($n), GI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._model = new xI,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.createBubbleAndShowContent = function(e) {
                    var t = this.createBubble(e);
                    return t.addBehavior(new Fi({})),
                    t
                }
                ,
                t.prototype.createBubble = function(e) {
                    void 0 === e && (e = []);
                    var t = new ev;
                    return t.addBehavior(new Bi({
                        content: e
                    })),
                    t.addBehavior(new Ii(this.services.cameraService.getScreenToWorldPosition(new Xe.Point(0,0)))),
                    t.scale.copyFrom(this.services.cameraService.getCameraScale()),
                    this.getBubbleContainers(t),
                    this.services.world.addGameObject(t),
                    this._model.registerGameObject(t),
                    t
                }
                ,
                t.prototype.removeBubble = function(e) {
                    this._model.unregisterGameObject(e)
                }
                ,
                t.prototype.getBubblesWithBlueprints = function(e) {
                    return this._model.getRegisteredObjects().filter((function(t) {
                        var i = t.getBehavior(Ke.StorageBubble);
                        return !!i && e.every((function(e) {
                            return i.content.some((function(t) {
                                return t.blueprint === e
                            }
                            ))
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getBubblesWithBehaviors = function(e) {
                    var t = [];
                    return this._model.getRegisteredObjects().filter((function(i) {
                        var n = i.getBehavior(Ke.StorageBubble);
                        n && n.content.forEach((function(n) {
                            var r = De.services.blueprintCollection.getBlueprint(n.blueprint).components;
                            e.some((function(e) {
                                return r[e]
                            }
                            )) && t.push(i)
                        }
                        ))
                    }
                    )),
                    t
                }
                ,
                t.prototype.getBubbleContainers = function(e) {
                    var t = e.getChildByName(My);
                    t || (t = e.addChild(De.services.resource.getSpine(se.BALLOON_DETACHED_OBJECTS)),
                    this.services.mapGridView.getLayer(Yo.STORAGE_BUBBLES).addChild(e),
                    t.state.setAnimation(0, A.APPEAR, !1),
                    t.state.addListener({
                        complete: function() {
                            t.state.clearListeners(),
                            t.state.setAnimation(0, A.IDLE, !0),
                            e.hasBehavior(Ke.StorageBubbleShowContentTrigger) && (e.removeBehaviorByType(Ke.StorageBubbleShowContentTrigger),
                            e.addBehavior(new Ui({
                                enableInteraction: !0
                            })))
                        }
                    })),
                    t.name = My,
                    t.scale.set(.5);
                    var i = e.getChildByName(Vy) || e.addChild(new Xe.Container);
                    return i.name = Vy,
                    {
                        bubbleSpine: t,
                        contentContainer: i
                    }
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, Promise.all([De.services.autosave.registerModel(this._model), De.services.assetLoader.loadSpines(se.BALLOON_DETACHED_OBJECTS)])];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {
                    var e = this
                      , t = [];
                    this._model.getCurrentData().forEach((function(i) {
                        var n = De.services.gameObjectFactory.createFromSerializedData(i);
                        n ? t.push(n) : e._logger.warn("could not restore storage bubble!")
                    }
                    )),
                    t.forEach((function(t) {
                        e._model.registerGameObject(t),
                        e.services.world.addGameObject(t),
                        t.addBehavior(new Ui({
                            enableInteraction: !0
                        }))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.autosave.unregisterModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), UI = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._version = 1,
                    t._name = "UserStatsModel",
                    t._currentUserData = {
                        totalSpawnedCrates: 0,
                        totalMergedAnimals: 0,
                        totalMergedCrops: 0,
                        totalBonusMerges: 0,
                        totalNormalMerges: 0,
                        totalHarvestedItems: 0,
                        totalCollectedIngredients: 0,
                        totalCompletedOrders: 0,
                        totalUnlockedAreas: 0,
                        totalSpentEnergy: 0,
                        totalSpentCoins: 0,
                        totalSpentGems: 0,
                        totalChoppedTrees: 0,
                        totalMinedRocks: 0,
                        totalRemovedTrees: 0,
                        totalRemovedRocks: 0,
                        totalWatchedRV: 0,
                        totalTripsToFriends: 0,
                        totalHelpedFriends: 0,
                        totalPlayedDays: 0
                    },
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.registerUserStat = function(e, t) {
                    ve(this._currentUserData[e]) || t > 0 && (this._currentUserData[e] += t,
                    this.saveData())
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._currentUserData = e
                }
                ,
                t.prototype.onDataSave = function() {
                    return this._currentUserData
                }
                ,
                t
            }($n), FI = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._userStatsModel = new UI,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.registerUserStat = function(e, t) {
                    this._userStatsModel.registerUserStat(e, t)
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.registerModel(this._userStatsModel),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.autosave.unregisterModel(this._userStatsModel),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), MI = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, o = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return n.trys.push([0, 3, , 4]),
                                e = [],
                                this.dependencies.rewards.forEach((function(t) {
                                    var i = De.services.blueprintCollection.getBlueprint(t).components;
                                    e.push({
                                        blueprint: t,
                                        data: i
                                    })
                                }
                                )),
                                t = this.dependencies.storageBubble.createBubbleAndShowContent(e),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return n.sent(),
                                this.dependencies.container.addChild(t),
                                t.position.copyFrom(this.dependencies.bubblePosition),
                                [4, r.TimeDelay.after(1e3).promise];
                            case 2:
                                return n.sent(),
                                this.dependencies.onClosed.listenOnce((function() {
                                    var e = t.toGlobal(new Xe.Point(0,0), void 0, !0)
                                      , i = o.dependencies.mapGridView.getLayer(Yo.STORAGE_BUBBLES);
                                    t.position = i.toLocal(e),
                                    i.addChild(t),
                                    t.scale.set(1)
                                }
                                ), this),
                                [2, {
                                    result: $_.SUCCESS,
                                    reason: "SUCCESS"
                                }];
                            case 3:
                                return i = n.sent(),
                                [2, {
                                    result: $_.FAIL,
                                    reason: JSON.stringify(i)
                                }];
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.finalize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(rc), VI = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this.dependencies.bubble ? (e = this.dependencies.bubble.getBehavior(Ke.StorageBubble),
                                this.dependencies.bubble.replaceBehavior(new Bi({
                                    content: e.content.concat([this.dependencies.serializedGameObject])
                                }))) : (this.dependencies.bubble = this.dependencies.storageBubble.createBubble([this.dependencies.serializedGameObject]),
                                this.dependencies.bubble.scale.copyFrom(this.dependencies.cameraService.getCameraScale())),
                                [4, r.TimeDelay.nextFrame()];
                            case 1:
                                return i.sent(),
                                this.dependencies.onAnimationEnd.listenOnce((function() {
                                    if (t.dependencies.bubble) {
                                        var e = t.dependencies.bubble.toGlobal(new Xe.Point(0,0), void 0, !0)
                                          , i = t.dependencies.mapGridView.getLayer(Yo.STORAGE_BUBBLES);
                                        t.dependencies.bubble.position = i.toLocal(e),
                                        i.addChild(t.dependencies.bubble),
                                        t.dependencies.bubble.scale.set(1),
                                        t.dependencies.bubble.addBehavior(new xi({}))
                                    }
                                }
                                ), this),
                                [2, new Promise((function(e) {
                                    if (t.dependencies.bubble) {
                                        var i = t.dependencies.storageBubble.getBubbleContainers(t.dependencies.bubble).contentContainer;
                                        t.dependencies.container.addChild(t.dependencies.bubble),
                                        t.dependencies.bubble.position.set(t.dependencies.bubblePosition.x, t.dependencies.bubblePosition.y);
                                        var o = new BE(t.dependencies.image,t.dependencies.image.parent,i.position,i.parent);
                                        t.dependencies.image.alpha = 0,
                                        o.onAnimationComplete.addListener((function() {
                                            return (0,
                                            n.__awaiter)(t, void 0, void 0, (function() {
                                                return (0,
                                                n.__generator)(this, (function(t) {
                                                    switch (t.label) {
                                                    case 0:
                                                        return !this.dependencies.bubble || this.dependencies.bubble.hasBehavior(Ke.StorageBubbleShowContent) ? [3, 2] : (this.dependencies.bubble.addBehavior(new Ui({
                                                            enableInteraction: !1
                                                        })),
                                                        [4, r.TimeDelay.after(500).promise]);
                                                    case 1:
                                                        t.sent(),
                                                        e({
                                                            result: $_.SUCCESS,
                                                            reason: "SUCCESS"
                                                        }),
                                                        t.label = 2;
                                                    case 2:
                                                        return [2]
                                                    }
                                                }
                                                ))
                                            }
                                            ))
                                        }
                                        ), t)
                                    } else
                                        e({
                                            result: $_.FAIL,
                                            reason: "bubble wasn't found"
                                        })
                                }
                                ))]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.finalize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(rc), HI = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.rewardMarketplaceItem = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return is(e.item.reward) ? [2, this.giveObjectReward({
                                    rewards: e.item.reward.data,
                                    container: e.marketplacePopup,
                                    animationEndEvent: e.popupClosedEvent,
                                    bubblePosition: e.bubblePosition
                                })] : [3, 1];
                            case 1:
                                return ns(e.item.reward) ? [2, this.giveInventoryReward({
                                    reward: e.item.reward.data,
                                    parent: e.parent
                                })] : [3, 2];
                            case 2:
                                return [4, new SC({}).execute()];
                            case 3:
                                t.sent(),
                                t.label = 4;
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.giveObjectRewardWithAnimation = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return t = new VI({
                                storageBubble: this.services.storageBubble,
                                mapGridView: this.services.mapGridView,
                                cameraService: this.services.cameraService,
                                serializedGameObject: {
                                    blueprint: e.rewardBlueprintID,
                                    data: e.blueprintComponents
                                },
                                container: e.container,
                                onAnimationEnd: e.animationEndEvent,
                                bubble: e.bubble,
                                bubblePosition: e.bubblePosition,
                                image: e.image
                            }),
                            [2, this._executeStrategy(t)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.giveObjectReward = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return t = new MI({
                                storageBubble: this.services.storageBubble,
                                mapGridView: this.services.mapGridView,
                                rewards: e.rewards,
                                container: e.container,
                                onClosed: e.animationEndEvent,
                                bubblePosition: e.bubblePosition
                            }),
                            [2, this._executeStrategy(t)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.giveInventoryReward = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return t = new SA({
                                itemData: e.reward,
                                parent: e.parent
                            }),
                            [2, this._executeStrategy(t)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onStart = function() {}
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._executeStrategy = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, new Promise((function(t, i) {
                                e.execute().then((function(e) {
                                    var n = e.result
                                      , r = e.reason;
                                    n === $_.SUCCESS && t(),
                                    n !== $_.FAIL && n !== $_.ERROR || i("Strategy failed with reason: ".concat(r))
                                }
                                )).catch((function(e) {
                                    i("Strategy failed with error: ".concat(JSON.stringify(e)))
                                }
                                )).finally((function() {
                                    e.finalize()
                                }
                                ))
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Go), jI = function() {
                function e(e, t) {
                    this._logger = r.Logger.Of("GameplayMapScreenEventHandler"),
                    this._firedFirstMergeEvent = !1,
                    this._firedFirstBonusMergeEvent = !1,
                    this._systems = e,
                    this._services = t,
                    this._items = {
                        coins: De.services.inventory.getInventoryItem(Cn.COINS),
                        gems: De.services.inventory.getInventoryItem(Cn.GEMS),
                        energy: De.services.inventory.getInventoryItem(Cn.ENERGY)
                    }
                }
                return e.prototype.start = function() {
                    this._setupListeners("addListener")
                }
                ,
                e.prototype.destroy = function() {
                    this._setupListeners("removeListener")
                }
                ,
                e.prototype._setupListeners = function(e) {
                    var t, i, n, r, o, a;
                    null === (t = this._findSystem($E)) || void 0 === t || t.onMerge[e](this._onMerge, this),
                    null === (i = this._findSystem(hm)) || void 0 === i || i.onItemLoot[e](this._onLootGranted, this),
                    null === (n = this._findSystem(pm)) || void 0 === n || n.onItemHarvest[e](this._onHarvest, this),
                    null === (r = this._findSystem(vm)) || void 0 === r || r.onItemCollect[e](this._onItemCollect, this),
                    null === (o = this._findSystem(Dm)) || void 0 === o || o.onSourceDepleted[e](this._onSourceDepleted, this),
                    null === (a = this._findSystem(Dm)) || void 0 === a || a.onSourceMined[e](this._onSourceMined, this),
                    this._services.ordersService.onOrderStateChange[e](this._onOrderChange, this),
                    this._services.ordersService.onOrderRewarded[e](this._onOrderRewarded, this),
                    this._services.mapAreaService.onAreaStateChange[e](this._onAreaStateChange, this),
                    De.services.adsService.onAdFinish[e](this._onRewardedAdFinish, this),
                    De.services.experience.onLevelUp[e](this._onLevelup, this),
                    this._items.coins.onChanged[e](this._onItemChange, this),
                    this._items.gems.onChanged[e](this._onItemChange, this),
                    this._items.energy.onChanged[e](this._onItemChange, this)
                }
                ,
                e.prototype._findSystem = function(e) {
                    return function(e, t) {
                        return e.find((function(e) {
                            return e instanceof t
                        }
                        ))
                    }(this._systems, e)
                }
                ,
                e.prototype._onMerge = function(e) {
                    this._services.userStats.registerUserStat("totalNormalMerges", e.mergeResult.normalMerges),
                    this._services.userStats.registerUserStat("totalBonusMerges", e.mergeResult.bonusMerges);
                    var t = e.mergeResult.normalMerges > 0;
                    this._fireMergeResultDesignAnalytics(t),
                    De.services.analytics.source.itemSpawn(e.blueprintId, e.mergeResult.bonusMerges)
                }
                ,
                e.prototype._fireMergeResultDesignAnalytics = function(e) {
                    this._firedFirstMergeEvent || e || (this._firedFirstMergeEvent = !0,
                    De.services.analytics.design.mergeResult(!1)),
                    !this._firedFirstBonusMergeEvent && e && (this._firedFirstBonusMergeEvent = !0,
                    De.services.analytics.design.mergeResult(!0))
                }
                ,
                e.prototype._onLootGranted = function(e) {
                    var t = new Map;
                    e.loot.forEach((function(e) {
                        var i, n = null !== (i = t.get(e)) && void 0 !== i ? i : 0;
                        t.set(e, n + 1)
                    }
                    )),
                    t.forEach((function(e, t) {
                        De.services.analytics.source.itemSpawn(t, e)
                    }
                    ))
                }
                ,
                e.prototype._onHarvest = function(e) {
                    this._services.userStats.registerUserStat("totalHarvestedItems", 1)
                }
                ,
                e.prototype._onItemCollect = function(e) {
                    var t = this;
                    e.rewards.forEach((function(e) {
                        Sn[e.key] && t._services.userStats.registerUserStat("totalCollectedIngredients", 1),
                        e.key === Cn.GEMS && De.services.analytics.source.collect(e.amount, e.key)
                    }
                    ))
                }
                ,
                e.prototype._onOrderChange = function(e) {
                    e.state === ps.COMPLETE && this._services.userStats.registerUserStat("totalCompletedOrders", 1)
                }
                ,
                e.prototype._onOrderRewarded = function(e) {
                    De.services.analytics.design.orderStatus($i.COLLECT)
                }
                ,
                e.prototype._onAreaStateChange = function(e) {
                    e.area.requirements.buy;
                    var t = e.area;
                    switch (t.state) {
                    case Cc.UNLOCKED:
                        this._services.userStats.registerUserStat("totalUnlockedAreas", 1),
                        De.services.analytics.design.areaProgress("purchased", t.id);
                        break;
                    case Cc.UNLOCKABLE:
                        De.services.analytics.design.areaProgress("revealed", t.id)
                    }
                }
                ,
                e.prototype._onSourceDepleted = function(e) {
                    e.blueprintId.includes(Kt.ROCK) ? this._services.userStats.registerUserStat("totalRemovedRocks", 1) : e.blueprintId.includes(Kt.TREE) && this._services.userStats.registerUserStat("totalRemovedTrees", 1)
                }
                ,
                e.prototype._onSourceMined = function(e) {
                    e.blueprintId.includes(Kt.ROCK) ? this._services.userStats.registerUserStat("totalMinedRocks", 1) : e.blueprintId.includes(Kt.TREE) && this._services.userStats.registerUserStat("totalChoppedTrees", 1)
                }
                ,
                e.prototype._onRewardedAdFinish = function() {
                    this._services.userStats.registerUserStat("totalWatchedRV", 1)
                }
                ,
                e.prototype._onItemChange = function(e) {
                    var t = e.old - e.current;
                    switch (e.key) {
                    case Cn.COINS:
                        this._services.userStats.registerUserStat("totalSpentCoins", t);
                        break;
                    case Cn.GEMS:
                        this._services.userStats.registerUserStat("totalSpentGems", t);
                        break;
                    case Cn.ENERGY:
                        this._services.userStats.registerUserStat("totalSpentEnergy", t)
                    }
                }
                ,
                e.prototype._onLevelup = function(e) {
                    e.rewards.forEach((function(e) {
                        De.services.analytics.source.levelUPRewards(e.amount, e.key)
                    }
                    ))
                }
                ,
                e
            }(), KI = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.name = "GameplayMapScreen",
                    i._commonEvents = {
                        spawnCrates: new r.Event,
                        openOrders: new r.Event,
                        energyRequest: new r.Event,
                        hudElementClicked: new r.Event
                    },
                    i._viewSettings = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return i = this._viewSettings.mapConfig,
                                [4, this._prepareServices(i)];
                            case 1:
                                return n.sent(),
                                [4, e.prototype.initialize.call(this)];
                            case 2:
                                return n.sent(),
                                [4, this._prepareSystems(i)];
                            case 3:
                                return n.sent(),
                                this.services.mapGrid.enableSaving(),
                                t(),
                                this._setupOnboarding(),
                                this._eventHandler = new jI(this._systems,this.services),
                                this._eventHandler.start(),
                                [4, De.services.visitorReward.showNewRewards()];
                            case 4:
                                return n.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.show = function(e) {
                    if (this._systems.forEach((function(e) {
                        return e.activate()
                    }
                    )),
                    this.services.cameraService.addViewToParent(this),
                    this.services.mapGridView.addViewToParent(this.services.cameraService.worldView),
                    this._options.startOnTrainStation) {
                        var t = this.services.gridFilter.getCellPositionsWithBehaviors([Ke.Trainstation])[0];
                        t && this.services.cameraService.teleportCameraToCell(t)
                    }
                    this.resize({
                        bounds: De.services.canvas.bounds,
                        orientation: De.services.canvas.currentOrientation
                    }),
                    De.services.audio.playBackgroundMusic(),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    Object.values(this._systems).forEach((function(e) {
                        return e.dectivate()
                    }
                    )),
                    this._cheatPanel && this._cheatPanel.hide(),
                    e()
                }
                ,
                t.prototype.resize = function(e) {
                    this._cheatPanel && this._cheatPanel.resize(e)
                }
                ,
                t.prototype.onDestroy = function() {
                    Object.values(this._systems).forEach((function(e) {
                        return e.destroy()
                    }
                    )),
                    this._cheatPanel && this._cheatPanel.destroy(),
                    this._eventHandler.destroy()
                }
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype._prepareServices = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return De.services.resourceRegeneration.hasGenerator(rs) || (t = De.services.resourceRegeneration.createGenerator(rs, De.services.resource.getJson(_e.ENERGY_REGENERATION_CONFIG), De.services.inventory.getInventoryItem(Cn.ENERGY), !1),
                            De.services.notificationsObserver.addRegenerationObservables(t),
                            De.services.resourceRegeneration.startGenerator(rs)),
                            De.services.resourceRegeneration.hasGenerator(os) || (t = De.services.resourceRegeneration.createGenerator(os, De.services.resource.getJson(_e.CRATE_REGENERATION_CONFIG), De.services.inventory.getInventoryItem(Cn.CRATES), !1),
                            De.services.notificationsObserver.addRegenerationObservables(t),
                            De.services.resourceRegeneration.startGenerator(os)),
                            this.addServices((0,
                            n.__assign)({
                                tiledMap: new cE(e),
                                axonometricProjection: new iE(e.tilewidth,e.tileheight),
                                popout: new Yd(this._commonEvents.hudElementClicked),
                                mapAreaService: new aE,
                                premiumAreaService: new _E,
                                crateContent: new DI,
                                crateQueue: new LI,
                                gameWorkers: new bI,
                                mapGrid: new Cf(Wo.main,!0),
                                world: new uE,
                                detachedObjects: new kI,
                                gridFilter: new Ef,
                                mapGridView: new tE,
                                cameraService: new eE,
                                interactionService: new Mo,
                                interactionWhitelistService: new Bf,
                                interactionHelper: new nE,
                                visibleCells: new lE,
                                shovelService: new hA,
                                highlightTileService: new bE,
                                hudService: new qs(this._commonEvents),
                                ordersService: new dA,
                                marketplaceService: new ZC,
                                onboarding: new Xf,
                                dialogService: new Pf,
                                gameMapTaskService: new yI,
                                userStats: new FI,
                                randomLoot: new ZE,
                                storageBubble: new GI,
                                dailyBonus: new BI,
                                upgradeCard: new $f,
                                specialOfferService: new sI,
                                storage: new mI,
                                timedEventService: new AC,
                                dailyChallenge: new gA,
                                rewardService: new HI,
                                incentivise: new CC
                            }, vp.platform.gameplayMapServices())),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._prepareSystems = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return (e = [new Wg, new pE, new gE, new fE, new Jg, new Mv, new RE, new wE, new Xg, new DE, new NE, new PE, new kE, new xE, new GE, new $E, new em, new im, new nm(this._commonEvents.spawnCrates), new rm, new sf, new om(this._commonEvents.openOrders), new am, new lm, new dm, new hm, new pm, new gf, new vm, new gm, new fm, new Em, new Om, new Rm, new wm, new Dm, new Um, new Mm, new Vm, new uf, new Iy, new Sy, new by, new wy, new qg(De.services.buildings), new Uy, new Fy, new Hy, new jy, new Wy, new zy, new jd((t = {},
                                t[Fd.FRIEND_REWARD] = Ke.FriendReward,
                                t[Fd.LOOT] = Ke.Lootable,
                                t[Fd.UPGRADE_BUILDING] = Ke.Upgrade,
                                t[Fd.DISCOVER_BUILDING] = Ke.UndiscoveredBuilding,
                                t[Fd.ORDER] = Ke.Order,
                                t[Fd.COLLECT] = Ke.Collectable,
                                t[Fd.RESOURCE_GATE] = Ke.ResourceGate,
                                t[Fd.TRAINSTATION] = Ke.Trainstation,
                                t[Fd.COOLDOWN] = Ke.CoolDown,
                                t[Fd.HEAVY_OBJECT] = Ke.HeavyObject,
                                t)), new Yy, new Xy, new Zy, new rA, new oA, new hf, new aA, new lA]).push.apply(e, vp.platform.gameplayMapSystems()),
                                [4, Promise.all([e.map((function(e) {
                                    return e.initialize(i.services, i.services.world)
                                }
                                ))])];
                            case 1:
                                return n.sent(),
                                this._systems = e,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._setupOnboarding = function() {
                    this.services.onboarding.addSequenceTracks(vp.platform.onboardingTracksStrategy.getMapSequenceTracks()),
                    this.services.onboarding.addTracks(vp.platform.onboardingTracksStrategy.getMapTracks())
                }
                ,
                t
            }(Er), WI = function() {
                function e(e, t) {
                    this._viewCurrent = null,
                    this._viewQueued = null,
                    this._typeCurrent = null,
                    this.name = e,
                    this.container = t
                }
                return Object.defineProperty(e.prototype, "currentView", {
                    get: function() {
                        return this._viewCurrent
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "hudContainer", {
                    get: function() {
                        return this._hudContainer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.instantiateView = function(e, t) {
                    var i = this._createView(e, t);
                    return this._viewQueued ? (this._destroy(this._viewQueued),
                    this._viewQueued = i) : this._viewCurrent ? (this._viewQueued = i,
                    this.remove()) : (this.onFilled(),
                    this._viewCurrent = i,
                    this._tryShowView(this._viewCurrent)),
                    this._hudContainer = i,
                    i
                }
                ,
                e.prototype.hasViewType = function(e) {
                    return this._typeCurrent === e
                }
                ,
                e.prototype.remove = function() {
                    if (this._viewCurrent) {
                        var e = this._viewCurrent;
                        this._viewCurrent = null,
                        e.beforeHide(this._onRemoved.bind(this))
                    }
                }
                ,
                e.prototype.back = function() {}
                ,
                e.prototype.clear = function() {
                    this.remove()
                }
                ,
                e.prototype.onFilled = function() {}
                ,
                e.prototype.onEmptied = function() {}
                ,
                e.prototype._createView = function(e, t) {
                    this._typeCurrent = e;
                    var i = new e(t);
                    return i.init(this),
                    this.container.addChild(i),
                    i.onAddedToLayer(),
                    i
                }
                ,
                e.prototype._onRemoved = function(e) {
                    this._destroy(e),
                    this._viewQueued ? (this._viewCurrent = this._viewQueued,
                    this._viewQueued = null,
                    this._tryShowView(this._viewCurrent)) : (this._typeCurrent = null,
                    null == this._viewCurrent && this.onEmptied())
                }
                ,
                e.prototype._tryShowView = function(e) {
                    e.canShow() ? e.beforeShow() : e.autoShow(!0)
                }
                ,
                e.prototype._destroy = function(e) {
                    e.destroy();
                    var t = e;
                    t && t.parent && t.parent.removeChild(t)
                }
                ,
                e
            }();
            !function(e) {
                e.LEFT = "left",
                e.BOTTOM = "bottom"
            }(NI || (NI = {}));
            var zI, YI, JI, XI, qI, QI = {
                width: 700,
                height: 210
            }, ZI = (Math.PI,
            {
                x: QI.width / 2,
                y: 0,
                rotation: -Math.PI / 2
            }), $I = {
                x: 285,
                y: QI.height / 2,
                rotation: 0
            }, eS = function(e) {
                function t(t) {
                    var i = t.line
                      , n = t.tailSide
                      , r = e.call(this) || this;
                    return r._line = i,
                    r._createBackground(n),
                    r._createText(i),
                    r
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.updateText = function() {
                    if ((0,
                    r.isArray)(this._line)) {
                        var e = this._line.map((function(e) {
                            return De.services.localization.getText(e)
                        }
                        ))
                          , t = r.StringUtility.formatString.apply(r.StringUtility, (0,
                        n.__spreadArray)([e[0]], e.splice(1), !1));
                        this._label.text = t
                    } else
                        this._label.text = nr(zI || (zI = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), this._line);
                    this._label.style.fontFamily = vn.currentFontFamily,
                    rr(this._label, {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    })
                }
                ,
                t.prototype._createBackground = function(e) {
                    var t = this.addChild(new cr(De.services.resource.getTexture(f.POPUP_NOTIFICATION_9SLICE)));
                    t.anchor.set(.5),
                    t.setSizes((0,
                    n.__assign)({}, QI));
                    var i = this.addChild(De.services.resource.getSprite(f.UI_POPOUT_TAIL))
                      , r = e === NI.BOTTOM ? $I : ZI
                      , o = r.x
                      , a = r.y
                      , s = r.rotation;
                    i.anchor.set(.5, 0),
                    i.position.set(o, a),
                    i.rotation = s
                }
                ,
                t.prototype._createText = function(e) {
                    var t = new v.LabelSettings({
                        fitHeight: .9 * QI.height,
                        fitWidth: .9 * QI.width,
                        fitToBox: !0
                    });
                    t.style = vn.darkMedium;
                    var i = "";
                    if ((0,
                    r.isArray)(e)) {
                        var o = e.map((function(e) {
                            return De.services.localization.getText(e)
                        }
                        ));
                        i = r.StringUtility.formatString.apply(r.StringUtility, (0,
                        n.__spreadArray)([o[0]], o.splice(1), !1))
                    } else
                        i = nr(YI || (YI = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), e);
                    this._label = new v.Label(i,t),
                    this.addChild(rr(this._label, {
                        anchor: {
                            x: .5,
                            y: .5
                        }
                    }))
                }
                ,
                t
            }(Xe.Container), tS = function(e, t) {
                var i = t.from
                  , r = t.to
                  , o = t.duration
                  , a = t.delay
                  , s = void 0 === a ? 0 : a
                  , _ = t.reverseEasing
                  , c = void 0 !== _ && _;
                return e.position.copyFrom(i),
                lr.gsap.timeline({}).to(e, (0,
                n.__assign)((0,
                n.__assign)({}, r), {
                    duration: o,
                    delay: s,
                    ease: c ? as.eJ.easeIn : as.eJ.easeOut
                })).pause()
            }, iS = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._currentDialogPosition = Ry.BOTTOM,
                    i._logger = r.Logger.Of("DialogSequenceScene"),
                    i.addServices({}),
                    i._currentDialog = {
                        npc: {
                            image: "avatar_130",
                            line: "I am your father!",
                            positionPortrait: Ry.BOTTOM,
                            positionLandscape: Ry.BOTTOM
                        },
                        waitForInput: !0
                    },
                    i._onSkipButtonPressed = t.skipButtonEvent,
                    i.hitArea = (new Xe.Rectangle).copyFrom(De.services.canvas.bounds),
                    i.interactive = !1,
                    i.interactiveChildren = !1,
                    De.services.localization.onLanguageChanged.addListener(i._updateTexts, i),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.resize = function(e) {
                    this.hitArea = (new Xe.Rectangle).copyFrom(e.bounds)
                }
                ,
                t.prototype.onDestroy = function() {
                    this.removeAllListeners(),
                    this._dialogElements = {},
                    De.services.localization.onLanguageChanged.removeListener(this._updateTexts, this)
                }
                ,
                t.prototype.setCurrentDialogData = function(e) {
                    this._currentDialog = e,
                    De.services.canvas.targetOrientation === v.Orientation.Portrait ? this._currentDialogPosition = e.npc.positionPortrait : this._currentDialogPosition = e.npc.positionLandscape
                }
                ,
                t.prototype.showDialog = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, this._startDialog(e)];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hideDialog = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._endDialog()];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onClick = function(e) {
                    this.interactive = !0,
                    this.on("pointerdown", e)
                }
                ,
                t.prototype.removeOnClick = function() {
                    this.interactive = !1,
                    this.removeAllListeners()
                }
                ,
                t.prototype._startDialog = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._dialogElements = this._getSingleDialogElements(this._currentDialog, e),
                                this.addChild(this._dialogElements.npcAvatar, this._dialogElements.npcBalloon, this._dialogElements.playerBalloon),
                                this._dialogElements.skipButton && this.addChild(this._dialogElements.skipButton),
                                [4, this._animateDialogs(this._dialogElements, !0)];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._endDialog = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._animateDialogs(this._dialogElements, !1)];
                            case 1:
                                return e.sent(),
                                this.removeChildren(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getSingleDialogElements = function(e, t) {
                    var i, n, o = this, a = e.npc, s = e.waitForInput, _ = s ? new fl : new Xe.Container, c = (0,
                    r.isArray)(a.line) ? [{
                        alias: a.line[0]
                    }, {
                        alias: a.line[1]
                    }] : {
                        alias: a.line
                    }, l = new eS({
                        line: c,
                        tailSide: NI.LEFT
                    }), u = rr(De.services.resource.getSprite({
                        alias: a.image
                    }), {
                        anchor: {
                            x: .5,
                            y: 1
                        }
                    }), d = De.services.canvas, h = d.bottom, p = d.top, v = this._currentDialogPosition === Ry.TOP;
                    this._currentDialogPosition === Ry.MIDDLE_BOTTOM && (h -= 200),
                    t && ((i = new fr({
                        name: "skip",
                        buttonIdle: f.BTN_DEFAULT_ORANGE_IDLE,
                        buttonActive: f.BTN_DEFAULT_ORANGE_ACTIVE,
                        buttonInactive: f.BTN_DEFAULT_GREY_INACTIVE
                    },{
                        buttonSizes: {
                            width: 375,
                            height: 75
                        }
                    },{
                        text: ce.ONBOARDING_SKIP,
                        textStyle: vn.lightSmall,
                        position: {
                            x: 0,
                            y: -7.5
                        },
                        alignment: "center"
                    })).onClick((function() {
                        o._onSkipButtonPressed.fire()
                    }
                    )),
                    n = tS(i, {
                        from: {
                            x: 360,
                            y: v ? p - 550 : h + 650
                        },
                        to: {
                            x: 360,
                            y: v ? p + 650 : h - 50
                        },
                        duration: .7,
                        delay: s ? 2 : 1
                    }));
                    var g = this._getTweens(v, p, h, _, l, u);
                    return {
                        npcAvatar: u,
                        npcAvatarTween: g.npcAvatarTween,
                        npcBalloon: l,
                        npcBalloonTween: g.npcBalloonTween,
                        playerBalloon: _,
                        playerBalloonTween: g.playerBalloonTween,
                        skipButton: i,
                        skipButtonTween: n
                    }
                }
                ,
                t.prototype._animateDialogs = function(e, t) {
                    var i = e.npcAvatarTween
                      , r = e.npcBalloonTween
                      , o = e.playerBalloonTween
                      , a = e.skipButtonTween;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return i && r && o ? t ? [4, Promise.all([i.play(), r.play(), o.play(), null == a ? void 0 : a.play()])] : [3, 2] : (this._logger.warn("DialogElements are undefined"),
                                [2]);
                            case 1:
                                return e.sent(),
                                [3, 4];
                            case 2:
                                return [4, Promise.all([i.reverse(), r.reverse(), o.reverse(), null == a ? void 0 : a.reverse()])];
                            case 3:
                                e.sent(),
                                e.label = 4;
                            case 4:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateTexts = function() {
                    var e, t;
                    this._dialogElements && (null === (e = this._dialogElements.skipButton) || void 0 === e || e.updateText(nr(JI || (JI = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.ONBOARDING_SKIP)),
                    null === (t = this._dialogElements.skipButton) || void 0 === t || t.updateTextStyle({
                        fontFamily: vn.currentFontFamily
                    }),
                    this._dialogElements.npcBalloon.updateText())
                }
                ,
                t.prototype._getTweens = function(e, t, i, n, r, o) {
                    var a = this._currentDialogPosition === Ry.BOTTOM_RIGHT ? 750 : 0
                      , s = 360 + a
                      , _ = -195 + a;
                    return {
                        npcAvatarTween: tS(o, {
                            from: {
                                x: s,
                                y: e ? t - 550 : i + 650
                            },
                            to: {
                                x: s,
                                y: e ? t + 600 : i - 100
                            },
                            duration: .7
                        }),
                        npcBalloonTween: tS(r, {
                            from: {
                                x: _,
                                y: e ? t - 425 : i + 375
                            },
                            to: {
                                x: _,
                                y: e ? t + 325 : i - 375
                            },
                            duration: .7,
                            delay: .2
                        }),
                        playerBalloonTween: tS(n, {
                            from: {
                                x: _,
                                y: i + 300
                            },
                            to: {
                                x: _,
                                y: i - 200
                            },
                            duration: .7,
                            delay: 1
                        })
                    }
                }
                ,
                t
            }(Er), nS = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i._logger = r.Logger.Of("SplashScreen"),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._setupSplashScreen(),
                            this.interactive = !0,
                            CO.analytics.design.startLoading(an.SPLASH_SCREEN),
                            e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.show = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r, o, a, s, _;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = new Re("SplashScreen",!1),
                                i = vp.platform.entryPointHandler,
                                this._checkOfflineStatus() ? (this._logger.warn("Showing disconnected screen"),
                                this._handleOfflineMode(),
                                [2]) : [4, this._loginUser()];
                            case 1:
                                return n.sent() ? (IO(),
                                [2]) : [4, this._initializePlayer(t)];
                            case 2:
                                return n.sent(),
                                [4, this._initializeBackend(t, i)];
                            case 3:
                                return n.sent(),
                                r = this._getNakamaInfo(),
                                o = r.backendSDK,
                                a = r.nakamaProvider,
                                s = r.nakamaId,
                                _ = r.analyticsId,
                                this._provideNakamaInfoToSentry(o, _),
                                [4, this._initializeServices(t, o, s, a)];
                            case 4:
                                return n.sent(),
                                [4, this._logGameVersionAndStartSession(o, s)];
                            case 5:
                                return n.sent(),
                                [4, this._performLazyLoading(t)];
                            case 6:
                                return n.sent(),
                                [4, this._handleEntryPoint(t, o, i)];
                            case 7:
                                return n.sent(),
                                [4, this._startNewSession()];
                            case 8:
                                return n.sent(),
                                t.end(),
                                e(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    var t;
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            return this.interactive = !1,
                            null === (t = De.services) || void 0 === t || t.analytics.design.completeLoading(an.SPLASH_SCREEN),
                            e(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.resize = function() {}
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype._setupSplashScreen = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o, a, s, _;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, CO.assetLoader.loadAtlases(CO.canvas.targetOrientation === v.Orientation.Landscape ? g.SPLASH_LANDSCAPE : g.SPLASH_PORTRAIT)];
                            case 1:
                                return n.sent(),
                                CO.canvas.targetOrientation === v.Orientation.Landscape ? (e = {
                                    asset: f.BG_LOADING_LANDSCAPE
                                },
                                t = {
                                    asset: f.LOGO_FMV_LANDSCAPE,
                                    minScale: 1.5,
                                    yOffset: 50
                                },
                                r = {
                                    asset: f.COPY_LOGOS_LANDSCAPE,
                                    scale: 1.5,
                                    anchor: {
                                        x: .25,
                                        y: .3
                                    }
                                },
                                i = {
                                    yPosition: 280
                                }) : (e = {
                                    asset: f.BG_LOADING_PORTRAIT
                                },
                                t = {
                                    asset: f.LOGO_FMV_PORTRAIT,
                                    minScale: 1.25,
                                    yOffset: 100
                                },
                                r = {
                                    asset: f.COPY_LOGOS_PORTRAIT,
                                    scale: 1,
                                    anchor: {
                                        x: .5,
                                        y: 1
                                    }
                                },
                                i = {
                                    yPosition: 120
                                }),
                                o = this._createSplashBackground(e),
                                a = this._createGameLogo(t),
                                s = this._createLoadingAnimationHead(i),
                                _ = this._createFooterLogos(r),
                                this.addChild(o, a, s, _),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._provideNakamaInfoToSentry = function(e, t) {
                    var i = this;
                    Zn.setUserInfo(t),
                    ze.USE_NAKAMA ? e.configuration.getOrFetchConfigFile("sentry_filter").then((function(e) {
                        if (!e)
                            return i._logger.error("failed to fetch Sentry filter configuration from Nakama"),
                            void Zn.error("failed to fetch Sentry filter configuration from Nakama");
                        e.errorFilters && Zn.addErrorFilters(e.errorFilters),
                        e.throttleRate && Zn.setThrottleRate(e.throttleRate)
                    }
                    )).catch((function(e) {
                        i._logger.error("failed to fetch Sentry filter configuration from Nakama"),
                        Zn.error("failed to fetch Sentry filter configuration from Nakama")
                    }
                    )) : this._logger.warn("Nakama is not enabled, so Sentry filter configuration was not fetched")
                }
                ,
                t.prototype._createSplashBackground = function(e) {
                    var t = e.asset
                      , i = new Xe.Sprite(CO.resource.getTexture(t))
                      , n = Math.max(CO.canvas.width / i.width, CO.canvas.height / i.height);
                    return i.scale.set(n),
                    i.anchor.set(.5, .5),
                    i
                }
                ,
                t.prototype._createGameLogo = function(e) {
                    var t = e.asset
                      , i = e.minScale
                      , n = e.yOffset
                      , r = new Xe.Sprite(CO.resource.getTexture(t))
                      , o = Math.min(CO.canvas.width / (r.width + 200), i);
                    return r.scale.set(o),
                    r.anchor.set(.5, 0),
                    r.position.set(0, CO.canvas.top + n),
                    r
                }
                ,
                t.prototype._createLoadingAnimationHead = function(e) {
                    var t = e.yPosition
                      , i = CO.resource.getSpine(se.THROBBER_COW);
                    return i.state.setAnimation(0, ie.ANIMATION, !0),
                    i.position.set(0, t),
                    i
                }
                ,
                t.prototype._createFooterLogos = function(e) {
                    var t = e.asset
                      , i = e.scale
                      , n = e.anchor
                      , r = new Xe.Sprite(CO.resource.getTexture(t));
                    return r.anchor.set(n.x, n.y),
                    r.position.set(0, CO.canvas.bottom - 100),
                    r.scale.set(i),
                    r
                }
                ,
                t.prototype._handleOfflineMode = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return CO.lazyLoad.prioritizeGroup(hn.DISCONNECTION).then((function() {
                                return CO.navigation.showNoConnectionOverlay()
                            }
                            )),
                            setInterval((function() {
                                navigator.onLine && location.reload()
                            }
                            ), 1e3),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._checkOfflineStatus = function() {
                    var e = !1;
                    return navigator.onLine || (this._logger.error("No internet connection at launch"),
                    ze.disableNakama(),
                    e = !0),
                    e
                }
                ,
                t.prototype._loginUser = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return (e = vp.platform.loginStrategy).isUserLoggedIn() ? [2, !1] : [4, e.attemptLogin()];
                            case 1:
                                switch (t.sent()) {
                                case be.SUCCESS:
                                    return [2, !0];
                                case be.ALREADY_LOGGED_IN:
                                    return [2, !1];
                                case be.USER_CANCELLED:
                                case be.UNKNOWN:
                                case be.FAILURE:
                                    return ze.disableNakama(),
                                    [2, !1]
                                }
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._initializePlayer = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return t = "initializePlayer",
                                i = vp.platform.initializePlatform,
                                e.startTask(t),
                                this._logger.info("Initializing the player"),
                                [4, i.initializePlayer(CO.analytics)];
                            case 1:
                                return n.sent(),
                                this._logger.info("Player initialized"),
                                e.endTask(t),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._initializeBackend = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return i = "intializeBackend",
                                e.startTask(i),
                                t.handleEntryPointPreload(CO.analytics),
                                [4, bp.initialize(CO.analytics)];
                            case 1:
                                return n.sent(),
                                e.endTask(i),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._getNakamaInfo = function() {
                    return {
                        backendSDK: bp.backendSDK,
                        nakamaProvider: bp.nakamaProvider,
                        nakamaId: bp.nakamaId,
                        analyticsId: bp.analyticsId
                    }
                }
                ,
                t.prototype._initializeServices = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return o = "intializeServices",
                                e.startTask(o),
                                [4, CO.initialize(t, i, r)];
                            case 1:
                                return n.sent(),
                                e.endTask(o),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._logGameVersionAndStartSession = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [3, 2];
                            case 1:
                                t = i.sent(),
                                e.info("Game Version: ".concat("1.46.0-1")),
                                e.info("Game Net Version: ".concat(s.Gf.NET_VERSION)),
                                e.info("Game Back End Version: ".concat(t)),
                                i.label = 2;
                            case 2:
                                return CO.analytics.design.startNewDaySession(),
                                CO.analytics.design.startNewSession(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._performLazyLoading = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return t = "lazyLoad",
                                e.startTask(t),
                                [4, De.services.lazyLoad.getLoadingPromise([hn.MAP_JSON, hn.MAP_RESOURCES, hn.MAIN_UI, hn.MAIN_HUD, hn.INGREDIENTS, hn.FONTS, hn.DECALS, hn.MAIN_SPINE_AND_SHARED_2, hn.BUILDING_PICKUP, hn.UPGRADE_CARD, hn.GREENHOUSE, hn.FLOWERS, hn.MERGE_BONUS_EFFECT], !0)];
                            case 1:
                                return i.sent(),
                                e.endTask(t),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._handleEntryPoint = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return r = "entryPoint",
                                e.startTask(r),
                                [4, i.handleEntryPointPostLoad(t)];
                            case 1:
                                return n.sent(),
                                e.endTask(r),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._startNewSession = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.navigation.showGameplayMap()];
                            case 1:
                                return e.sent(),
                                De.services.analytics.incrementSession(),
                                De.services.analytics.design.startNewSession(),
                                De.services.analytics.design.reportEconomyAtStartSession(De.services.inventory.getInventoryItem(Cn.COINS).amount, De.services.inventory.getInventoryItem(Cn.GEMS).amount),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(v.View), rS = {
                logoShowBeforeHide: 1500,
                delayAfterHideAnimation: 100
            }, oS = [Lv, bg, Dv, Kv], aS = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.onPopupOpened = new r.Event,
                    i.onPopupClosed = new r.Event,
                    i.onDialogClosed = new r.Event,
                    i.onSceneChanged = new r.Event,
                    i.layers = {},
                    i._mapAsset = {
                        alias: "map_facebook"
                    },
                    i._currentMapScene = null,
                    i._showPopupCallbackQueue = new Map,
                    i._handledPopupCallbackQueue = !1,
                    i._layerManager = new v.LayerManager([],t),
                    i._instantiateLayers(t),
                    i._viewManager = new dg(i._layerManager,{
                        paths: new Map
                    }),
                    i._navigationModel = new xr,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "currentMapScene", {
                    get: function() {
                        var e = this;
                        return new Promise((function(t) {
                            e._currentMapScene ? t(e._currentMapScene) : e.onSceneChanged.listenOnce((function(e) {
                                t(e.scene)
                            }
                            ), e)
                        }
                        ))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._popupLayer.onPopupOpenend.addListener((function(t) {
                                return e.onPopupOpened.fire(t)
                            }
                            ), this),
                            this._popupLayer.onPopupClosed.addListener((function(t) {
                                return e.onPopupClosed.fire(t)
                            }
                            ), this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showSplash = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._viewManager.showView(nS, rS, ug.SPLASH),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showSpinnerOverlay = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._viewManager.showView(hg, {}, ug.TRANSITION),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.clearTransitionLayer = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._layerManager.getLayer(ug.TRANSITION).clear(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.clearFakeAdScreen = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._layerManager.getLayer(ug.FAKE_AD).clear(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroyCurrentMap = function() {
                    this._viewManager.removeView(ug.MAIN)
                }
                ,
                t.prototype.destroyAllLayers = function() {
                    var e = this;
                    Object.keys(ug).forEach((function(t) {
                        e._layerManager.getLayer(ug[t]).clear(),
                        e._viewManager.removeView(ug[t])
                    }
                    ))
                }
                ,
                t.prototype.showGameplayMap = function(e) {
                    return void 0 === e && (e = !1),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return this._layerManager.getLayer(ug.TRANSITION).clear(),
                            this._navigationModel.changeScene(wr.MAIN),
                            t = this._viewManager.showView(KI, {
                                mapConfig: this.services.resource.getJsonCopy(this._mapAsset),
                                startOnTrainStation: e
                            }, ug.MAIN),
                            this._changeScene(t, wr.MAIN),
                            [2, this._promiseNonNullView(t)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showFriendsMap = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.VISITOR_ACTIONS)];
                            case 1:
                                return t.sent(),
                                this._layerManager.getLayer(ug.TRANSITION).clear(),
                                this._navigationModel.changeScene(wr.FRIEND),
                                e = this._viewManager.showView(dE, {
                                    mapConfig: this.services.resource.getJsonCopy(this._mapAsset),
                                    startOnTrainStation: !0
                                }, ug.MAIN),
                                this._changeScene(e, wr.FRIEND),
                                [2, this._promiseNonNullView(e)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showTransitionScreen = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._layerManager.getLayer(ug.HUD).clear(),
                                [4, this.services.lazyLoad.prioritizeGroup(hn.TRANSITION_SCREEN)];
                            case 1:
                                return n.sent(),
                                o = this._viewManager.showView(xg, {
                                    playerData: t,
                                    friendsData: i,
                                    timeDelay: e,
                                    direction: r
                                }, ug.TRANSITION),
                                [2, this._promiseNonNullView(o)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showFakeAdScreen = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this.services.lazyLoad.prioritizeGroup(hn.FAKE_ADS)];
                            case 1:
                                return n.sent(),
                                r = this._viewManager.showView(Kg, {
                                    isInterstitialAd: e,
                                    succesCallback: t,
                                    failCallback: i
                                }, ug.FAKE_AD),
                                [2, this._promiseNonNullView(r)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showPopup = function(e, t, i) {
                    return void 0 === i && (i = !1),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r = this;
                        return (0,
                        n.__generator)(this, (function(o) {
                            return this._currentMapScene && this._currentMapScene.state !== v.ViewState.SHOWN || this._currentMapScene && this._currentMapScene.state === v.ViewState.SHOWN && !this._handledPopupCallbackQueue ? [2, new Promise((function(o, a) {
                                var s = r._showPopupCallbackQueue.get(e) || [];
                                s.push((function() {
                                    return (0,
                                    n.__awaiter)(r, void 0, void 0, (function() {
                                        return (0,
                                        n.__generator)(this, (function(n) {
                                            return this._showPopup(e, t, i).then((function(e) {
                                                o(e)
                                            }
                                            )).catch((function(e) {
                                                a(e)
                                            }
                                            )),
                                            [2]
                                        }
                                        ))
                                    }
                                    ))
                                }
                                )),
                                r._showPopupCallbackQueue.set(e, s)
                            }
                            ))] : [2, this._showPopup(e, t, i)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showPremiumPopup = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, De.services.lazyLoad.prioritizeGroup(hn.PREMIUM_POPUP)];
                            case 1:
                                return n.sent(),
                                r = this._viewManager.showView(Bg, {
                                    area: e,
                                    premiumAreaStateService: t,
                                    marketplaceService: i
                                }, ug.POPUP, !1),
                                [2, this._promiseNonNullView(r)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showToast = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            return this._viewManager.showView(e, t, ug.POPUP, !0),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.isPopupTypeOpen = function(e) {
                    var t = this._popupLayer.currentView;
                    return !!t && t instanceof e
                }
                ,
                t.prototype.isAnyPopupOpen = function() {
                    return !!this._popupLayer.currentView
                }
                ,
                t.prototype.isDialogOpen = function() {
                    var e;
                    return !!(null === (e = this._layerManager.getLayer(ug.ONBOARDING).currentView) || void 0 === e ? void 0 : e.children.length)
                }
                ,
                t.prototype.showHUD = function(e, t) {
                    return this._viewManager.showView(e, t, ug.HUD, !1)
                }
                ,
                t.prototype.showConversation = function(e) {
                    return this._viewManager.showView(iS, {
                        skipButtonEvent: e
                    }, ug.ONBOARDING, !1)
                }
                ,
                t.prototype.hideConversation = function() {
                    this._layerManager.getLayer(ug.ONBOARDING).clear(),
                    this.onDialogClosed.fire()
                }
                ,
                t.prototype.closeTopPopup = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._popupLayer.closeTopPopup(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.closeAllPopups = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._popupLayer.closeAllPopups(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                Object.defineProperty(t.prototype, "currentSceneIndex", {
                    get: function() {
                        return this._navigationModel.currentSceneIndex
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "popupLayer", {
                    get: function() {
                        return this._popupLayer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "hudLayer", {
                    get: function() {
                        return this._hudLayer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.resetCurrentSceneIndex = function() {
                    this._navigationModel.changeScene(wr.MAIN)
                }
                ,
                t.prototype.setChosenFriendDestination = function(e) {
                    this._navigationModel.chosenFriendData = e
                }
                ,
                t.prototype.getChosenFriendDestination = function() {
                    return this._navigationModel.chosenFriendData
                }
                ,
                t.prototype.showNoConnectionOverlay = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e = this._viewManager.showView(Dg, {}, ug.DISCONNECTION),
                            [2, this._promiseNonNullView(e)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.showSaveFailedOverlay = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return e = this._viewManager.showView(Ng, {}, ug.DISCONNECTION),
                            [2, this._promiseNonNullView(e)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hideNoConnectionOverlay = function() {
                    this._viewManager.layerManager.getLayer(ug.DISCONNECTION).clear()
                }
                ,
                t.prototype.hideSaveFailedOverlay = function() {
                    this._viewManager.layerManager.getLayer(ug.DISCONNECTION).clear()
                }
                ,
                t.prototype._showPopup = function(e, t, i) {
                    return void 0 === i && (i = !1),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return r = this._viewManager.showView(e, t, ug.POPUP, i),
                            [2, this._promiseNonNullView(r)]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._instantiateLayers = function(e) {
                    var t = this;
                    Object.values(ug).forEach((function(i) {
                        var n = new Xe.Container;
                        if (e.addChild(n),
                        t._isLayerName(i)) {
                            var r = void 0;
                            i === ug.POPUP ? (r = t._layerManager.instantiateLayer(i, n, Rg),
                            t._popupLayer = r) : i === ug.HUD ? (r = t._layerManager.instantiateLayer(i, n, WI),
                            t._hudLayer = r) : r = t._layerManager.instantiateLayer(i, n),
                            t.layers[i.id] = r
                        }
                    }
                    ))
                }
                ,
                t.prototype._isLayerName = function(e) {
                    return !!e.id
                }
                ,
                t.prototype._changeScene = function(e, t) {
                    var i = this;
                    this._currentMapScene = e,
                    this.onSceneChanged.fire({
                        scene: e,
                        index: t
                    }),
                    this._handledPopupCallbackQueue = !1,
                    e.onSceneShowPromise.then((function() {
                        i._showPopupsAtSceneShow()
                    }
                    ))
                }
                ,
                t.prototype._promiseNonNullView = function(e) {
                    return e ? Promise.resolve(e) : Promise.reject("view was not instantiated")
                }
                ,
                t.prototype._showPopupsAtSceneShow = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, o, a, s = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, r.TimeDelay.after(2500).promise];
                            case 1:
                                for (n.sent(),
                                e = [],
                                t = function(t) {
                                    t && e.push.apply(e, t.map((function(e) {
                                        return e()
                                    }
                                    )))
                                }
                                ,
                                i = 0,
                                o = oS; i < o.length; i++)
                                    a = o[i],
                                    t(this._showPopupCallbackQueue.get(a)),
                                    this._showPopupCallbackQueue.delete(a);
                                return this._showPopupCallbackQueue.forEach((function(e, i) {
                                    t(e),
                                    s._showPopupCallbackQueue.delete(i)
                                }
                                )),
                                [4, Promise.all(e)];
                            case 2:
                                return n.sent(),
                                this._handledPopupCallbackQueue = !0,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se), sS = function() {
                function e() {}
                return e.prototype.initialize = function(e) {}
                ,
                e.prototype.start = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype.destroy = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype.addRegenerationObservables = function(e) {}
                ,
                e.prototype.removeRegenerationObservable = function(e) {}
                ,
                e
            }(), _S = function() {
                function e() {}
                return e.prototype.initialize = function(e) {}
                ,
                e.prototype.start = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype.destroy = function() {
                    return Promise.resolve()
                }
                ,
                e.prototype.createMessageForOrder = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, !0]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.createMessageForResourceHarvest = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, !0]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.createMessageForObserver = function(e, t, i, r, o, a) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, !0]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.addMessage = function(e, t, i, r) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, !0]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.cancelMessage = function(e, t) {}
                ,
                e.prototype.buildImageUrl = function(e) {
                    for (var t = [], i = 1; i < arguments.length; i++)
                        t[i - 1] = arguments[i];
                    return ""
                }
                ,
                e
            }(), cS = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._name = "LastVisitedNpcModel",
                    i._version = 1,
                    i._data = [],
                    i._npcPlayers = [],
                    i._npcPlayers = (0,
                    n.__spreadArray)([], t, !0),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getDataForNpc = function(e) {
                    return this._data.find((function(t) {
                        return t.playerId === e
                    }
                    )) || (this._logger.warn("LastVisitedNpcModel: could not find NPC data with id: ".concat(e)),
                    {
                        playerId: e,
                        lastVisitedTime: 0
                    })
                }
                ,
                t.prototype.setVisitedTimeForNpc = function(e, t) {
                    var i = this._data.find((function(t) {
                        return t.playerId === e
                    }
                    ));
                    if (!i)
                        throw new Error("LastVisitedNpcModel: could not find NPC with id: ".concat(e));
                    i.lastVisitedTime = t,
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.onDataReceive(this._getDefaultData()),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    var t = this;
                    e.forEach((function(e) {
                        var i = t._data.find((function(t) {
                            return t.playerId === e.playerId
                        }
                        ));
                        i ? i.lastVisitedTime < e.lastVisitedTime && (i.lastVisitedTime = e.lastVisitedTime) : t._data.push(e)
                    }
                    ))
                }
                ,
                t.prototype.onDataSave = function() {
                    return this._data
                }
                ,
                t.prototype._getDefaultData = function() {
                    return this._npcPlayers.map((function(e) {
                        return {
                            playerId: e.id,
                            lastVisitedTime: 0
                        }
                    }
                    ))
                }
                ,
                Object.defineProperty(t.prototype, "dataContainer", {
                    get: function() {
                        return De.services.playerData.playerDataContainer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }($n), lS = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._npcModel = new tg,
                    t._npcPlayers = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.assetLoader.loadJsons(_e.NPC_PLAYERS)];
                            case 1:
                                return e.sent(),
                                this._staticNPCData = this.services.resource.getJson(_e.NPC_PLAYERS),
                                this._npcPlayers = this._staticNPCData.map((function(e) {
                                    return {
                                        id: e.jsonID,
                                        name: nr(XI || (XI = (0,
                                        n.__makeTemplateObject)(["", ""], ["", ""])), e.localizationKey),
                                        photo: e.photo.alias.toUpperCase()
                                    }
                                }
                                )),
                                this._lastVisitedNpcModel = new cS(this._npcPlayers),
                                [4, this.services.autosave.registerModel(this._lastVisitedNpcModel)];
                            case 2:
                                return e.sent(),
                                this.getAllNPC(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.autosave.unregisterModel(this._lastVisitedNpcModel),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getLastVisitedTimeForNpc = function(e) {
                    return this._lastVisitedNpcModel.getDataForNpc(e)
                }
                ,
                t.prototype.visitedNpc = function(e) {
                    var t = this._npcModel.getPlayerByPlatformId(e);
                    if (t) {
                        var i = Date.now();
                        t.lastVisitedTime = i,
                        this._lastVisitedNpcModel.setVisitedTimeForNpc(e, i),
                        "NPC_2" === e && De.services.analytics.design.reportGaryVisited()
                    }
                }
                ,
                t.prototype.getPlayerDataByPlatformId = function(e) {
                    return this._npcModel.getPlayerByPlatformId(e)
                }
                ,
                t.prototype.getRandomNPC = function() {
                    return this._getCachedNpcProfile(r.Random.pick(this._npcPlayers))
                }
                ,
                t.prototype.getAllNPC = function() {
                    var e = this;
                    return this._npcPlayers.map((function(t) {
                        return e._getCachedNpcProfile(t)
                    }
                    ))
                }
                ,
                t.prototype.getRepeatableNPCs = function() {
                    var e = this;
                    return this._staticNPCData.filter((function(e) {
                        return !e.visitableFromLevel || De.services.experience.getLevel() >= e.visitableFromLevel && e.repeatable
                    }
                    )).map((function(t) {
                        return e._getCachedNpcProfile(e._npcPlayers.find((function(e) {
                            return e.id === t.jsonID
                        }
                        )))
                    }
                    ))
                }
                ,
                t.prototype.getOneTimeVisitableNPCs = function() {
                    var e = this;
                    return this._staticNPCData.filter((function(t) {
                        return t.visitableFromLevel && De.services.experience.getLevel() >= t.visitableFromLevel && !1 === t.repeatable && 0 === e._lastVisitedNpcModel.getDataForNpc(t.jsonID).lastVisitedTime
                    }
                    )).map((function(t) {
                        return e._getCachedNpcProfile(e._npcPlayers.find((function(e) {
                            return e.id === t.jsonID
                        }
                        )))
                    }
                    ))
                }
                ,
                t.prototype._getCachedNpcProfile = function(e) {
                    var t = this._npcModel.getPlayerByPlatformId(e.id);
                    return t || ((t = this._npcModel.createPlayerProfile({
                        platformId: e.id,
                        name: e.name,
                        photoUrl: e.photo,
                        isRealPlayer: !1
                    })).lastVisitedTime = this.getLastVisitedTimeForNpc(t.platformId).lastVisitedTime),
                    t
                }
                ,
                t
            }(Se), uS = Rp({
                2: function(e) {
                    return {
                        completedTracks: e,
                        hiddenHudElements: []
                    }
                },
                3: function(e) {
                    var t = e.completedTracks.indexOf("REPAIR_BUILDING_TRACK");
                    return t > -1 && (e.completedTracks.splice(t, 1),
                    e.completedTracks.push("REPAIR_BUILDING_TRACK_1", "REPAIR_BUILDING_TRACK_2")),
                    e
                },
                4: function(e) {
                    var t = e.completedTracks.indexOf("MERGE_BONUS_TRACK_2")
                      , i = e.completedTracks.indexOf("AWAIT_LEVELUP");
                    return t > -1 && e.completedTracks.push("REGAIN_CONTROL_TRACK", "AWAIT_LEVELUP_3"),
                    i > -1 && (e.completedTracks.splice(i, 1),
                    e.completedTracks.push("AWAIT_LEVELUP_2")),
                    e
                },
                5: function(e) {
                    return e.completedTracks.indexOf("HARVEST_TRACK_2") > -1 && e.completedTracks.push("HARVEST_TRACK_3", "HARVEST_TRACK_4", "HARVEST_TRACK_5"),
                    e
                },
                6: function(e) {
                    var t = e.completedTracks.indexOf("REPAIR_BUILDING_TRACK_2")
                      , i = e.completedTracks.indexOf("REPAIR_BUILDING_TRACK_1");
                    return t > -1 ? e.completedTracks.push("REPAIR_BUILDING_TRACK_3") : i > -1 && e.completedTracks.push("REPAIR_BUILDING_TRACK_2"),
                    e
                },
                7: function(e) {
                    return e.completedTracks.indexOf("ORDER_TRACK_4") > -1 && e.completedTracks.push("ORDER_TRACK_5"),
                    e
                },
                8: function(e) {
                    return (0,
                    n.__assign)({
                        pausedBuildings: []
                    }, e)
                },
                9: function(e) {
                    return (0,
                    n.__assign)({
                        cameraState: Ca.ENABLED
                    }, e)
                },
                10: function(e) {
                    return e.completedTracks.indexOf(Lo.FRIEND_ACTIVITIES_TRACK) > -1 && e.completedTracks.push(Lo.FRIEND_ACTIVITIES_TRACK_2, Lo.FRIEND_ACTIVITIES_TRACK_3, Lo.FRIEND_ACTIVITIES_TRACK_4, Lo.FRIEND_ACTIVITIES_TRACK_5, Lo.FRIEND_ACTIVITIES_FINAL),
                    e
                },
                11: function(e) {
                    return e.completedTracks.indexOf(Lo.HARVEST_TRACK_5) > -1 && e.completedTracks.push(Lo.HARVEST_TRACK_6, Lo.HARVEST_TRACK_7),
                    e
                }
            }), dS = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._name = "OnboardingModel",
                    t._version = 11,
                    t._completedTracks = [],
                    t._hiddenHudElements = [],
                    t._pausedBuildings = [],
                    t._cameraState = Ca.ENABLED,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.isTrackCompleted = function(e) {
                    return this._completedTracks.includes(e)
                }
                ,
                t.prototype.completeTrack = function(e) {
                    this._completedTracks.includes(e) ? this._logger.warn("onboarding track ".concat(e, " was already completed")) : (this._completedTracks.push(e),
                    this.saveData())
                }
                ,
                t.prototype.setHudElementFlag = function(e, t) {
                    var i = this._hiddenHudElements.includes(e);
                    t && !i ? (this._hiddenHudElements.push(e),
                    this.saveData()) : !t && i && (this._hiddenHudElements.splice(this._hiddenHudElements.indexOf(e), 1),
                    this.saveData())
                }
                ,
                t.prototype.getHiddenHud = function() {
                    return (0,
                    n.__spreadArray)([], this._hiddenHudElements, !0)
                }
                ,
                t.prototype.isHudHidden = function(e) {
                    return this._hiddenHudElements.includes(e)
                }
                ,
                t.prototype.flagBuildingAsPaused = function(e, t) {
                    var i = this._pausedBuildings.includes(e);
                    t && !i ? (this._pausedBuildings.push(e),
                    this.saveData()) : !t && i && (this._pausedBuildings.splice(this._pausedBuildings.indexOf(e), 1),
                    this.saveData())
                }
                ,
                t.prototype.getPausedBuildings = function() {
                    return (0,
                    n.__spreadArray)([], this._pausedBuildings, !0)
                }
                ,
                t.prototype.isBuildingPaused = function(e) {
                    return this._pausedBuildings.includes(e)
                }
                ,
                t.prototype.setCameraState = function(e) {
                    this._cameraState = e,
                    this.saveData()
                }
                ,
                t.prototype.getCameraState = function() {
                    return this._cameraState
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._completedTracks = (0,
                    n.__spreadArray)([], e.completedTracks, !0),
                    this._hiddenHudElements = (0,
                    n.__spreadArray)([], e.hiddenHudElements, !0),
                    this._pausedBuildings = (0,
                    n.__spreadArray)([], e.pausedBuildings, !0),
                    this._cameraState = e.cameraState
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        completedTracks: (0,
                        n.__spreadArray)([], this._completedTracks, !0),
                        hiddenHudElements: (0,
                        n.__spreadArray)([], this._hiddenHudElements, !0),
                        pausedBuildings: (0,
                        n.__spreadArray)([], this._pausedBuildings, !0),
                        cameraState: this._cameraState
                    }
                }
                ,
                t.prototype.migrateData = function(e) {
                    return uS(e, 11)
                }
                ,
                Object.defineProperty(t.prototype, "dataContainer", {
                    get: function() {
                        return De.services.playerData.playerDataContainer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t
            }($n), hS = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onInteractionReadyEvent = new r.Event,
                    t.onboardingRunningAtStartSession = new Promise((function(e) {
                        t.onboardingRunningAtStartSessionResolve = e
                    }
                    )),
                    t._model = new dS,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "model", {
                    get: function() {
                        return this._model
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se), pS = function() {
                function e(e, t, i) {
                    this._data = {},
                    this._dataProvider = e,
                    this._dataWriter = t,
                    i && this._migrateData(i)
                }
                return Object.defineProperty(e.prototype, "isSavable", {
                    get: function() {
                        return !(0,
                        r.isUndefined)(this._dataWriter)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.savePlayerData = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._data = (0,
                                n.__assign)((0,
                                n.__assign)({}, this._data), e),
                                this._dataWriter ? [4, this._dataWriter.savePlayerData(e)] : [3, 2];
                            case 1:
                                t.sent(),
                                t.label = 2;
                            case 2:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.getPlayerData = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return [4, this.preloadPlayerData()];
                            case 1:
                                return n.sent(),
                                (0,
                                r.isArray)(e) ? (t = {},
                                e.forEach((function(e) {
                                    return t[e] = i._data[e]
                                }
                                )),
                                [2, t]) : [2, this._data[e]]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.preloadPlayerData = function() {
                    var e = this;
                    return this._loadingPromise || (this._loadingPromise = this._dataProvider.getAllPlayerData().then((function(t) {
                        e._data = t
                    }
                    ))),
                    this._loadingPromise
                }
                ,
                e.prototype.getAvailableIdentifiers = function() {
                    return Object.keys(this._data)
                }
                ,
                e.prototype._migrateData = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, this.preloadPlayerData()];
                            case 1:
                                return i.sent(),
                                this.getAvailableIdentifiers().length > 0 ? [2] : [4, Promise.all(e.map((function(e) {
                                    return e.getAllPlayerData()
                                }
                                )))];
                            case 2:
                                return t = i.sent(),
                                this.savePlayerData(t.reduce((function(e, t) {
                                    return (0,
                                    n.__assign)((0,
                                    n.__assign)({}, e), t)
                                }
                                ), {})),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), vS = function() {
                function e(e) {
                    this._backendSDK = e
                }
                return e.prototype.getAllPlayerData = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, this._backendSDK.playerdata.getAllData()]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), gS = function() {
                function e(e, t) {
                    this._backendSDK = e,
                    this._userID = t
                }
                return e.prototype.getAllPlayerData = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, this._backendSDK.playerdata.getAllData(this._userID)]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), fS = function() {
                function e() {}
                return e.prototype.getAllPlayerData = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2, {}]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), ES = function() {
                function e(e) {
                    this._jsonAsset = e
                }
                return e.prototype.getAllPlayerData = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons(this._jsonAsset)];
                            case 1:
                                return e.sent(),
                                [2, De.services.resource.getJson(this._jsonAsset)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), mS = function() {
                function e(e) {
                    this._backendSDK = e
                }
                return e.prototype.savePlayerData = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            return [2, Promise.race([this._backendSDK.playerdata.savePlayerData(e), new Promise((function(e, t) {
                                return setTimeout((function() {
                                    return t(new Error("Save timed out (".concat(7500, "ms)")))
                                }
                                ), 7500)
                            }
                            ))])]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }();
            !function(e) {
                e[e.PLAYER = 0] = "PLAYER",
                e[e.FRIEND = 1] = "FRIEND"
            }(qI || (qI = {}));
            var yS, TS = function(e) {
                function t(t, i) {
                    var n, r, o = e.call(this) || this;
                    if (o._backendSDK = i,
                    ze.USE_NAKAMA) {
                        var a = [];
                        vp.platform.initializePlatform.player.isNewAccount && a.push(new td),
                        o._dataContainers = ((n = {})[qI.PLAYER] = new pS(new vS(i),new mS(i),a),
                        n[qI.FRIEND] = new pS(new fS),
                        n)
                    } else
                        o._dataContainers = ((r = {})[qI.PLAYER] = new pS(new td,new id),
                        r[qI.FRIEND] = new pS(new fS),
                        r);
                    return o
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                Object.defineProperty(t.prototype, "playerDataContainer", {
                    get: function() {
                        return this._dataContainers[qI.PLAYER]
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "friendDataContainer", {
                    get: function() {
                        return this._dataContainers[qI.FRIEND]
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "currentMapDataContainer", {
                    get: function() {
                        if (De.services.navigation.currentSceneIndex === wr.MAIN)
                            return this._dataContainers[qI.PLAYER];
                        if (De.services.navigation.currentSceneIndex === wr.FRIEND)
                            return this._dataContainers[qI.FRIEND];
                        throw new Error("There is no data provider for the scene ".concat(De.services.navigation.currentSceneIndex))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.setFriendDataContainer = function(e) {
                    this._dataContainers[qI.FRIEND] = e
                }
                ,
                t.prototype.createDataContainerForFriend = function(e) {
                    return e.realPlayer ? e.nakamaId ? new pS(new gS(this._backendSDK,e.nakamaId)) : (this._logger.error("can't create a data container, profile has no nakama id"),
                    new pS(new fS)) : new pS(new ES({
                        alias: "".concat(e.platformId)
                    }))
                }
                ,
                t
            }(Se), AS = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._recipes = {},
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            return this._initializationPromise || (e = [],
                            this._initializationPromise = this.services.assetLoader.loadJsons(_e.RECIPES_INDEX).then((function() {
                                var i = t.services.resource.getJson(_e.RECIPES_INDEX).recipes;
                                e = i.map((function(e) {
                                    return {
                                        alias: e
                                    }
                                }
                                ))
                            }
                            )).then((function() {
                                return t.services.assetLoader.loadJsons(e)
                            }
                            )).then((function() {
                                e.forEach((function(e) {
                                    t._addRecipe(t.services.resource.getJsonCopy(e))
                                }
                                ))
                            }
                            ))),
                            [2, this._initializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hasRecipe = function(e) {
                    return void 0 !== this._recipes[e]
                }
                ,
                t.prototype.getRecipe = function(e) {
                    if (!this.hasRecipe(e))
                        throw new Error("RecipesService.get:: no blueprint with id ".concat(e, "! run call hasBlueprint(").concat(e, "); first"));
                    return this._recipes[e]
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._addRecipe = function(e) {
                    this._recipes[e.ID] = e
                }
                ,
                t
            }(Se), CS = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._name = "RegenerationServiceModel",
                    i._version = 2,
                    i._generatorData = {},
                    i._name = null != t ? t : i._name,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.ensureGeneratorData = function(e) {
                    this._generatorData[e] || (this._generatorData[e] = {
                        lastStartTime: 0,
                        timerId: null
                    })
                }
                ,
                t.prototype.getLastStartTime = function(e) {
                    return this._getGenerator(e).lastStartTime
                }
                ,
                t.prototype.getTimer = function(e) {
                    return this._getGenerator(e).timerId
                }
                ,
                t.prototype.setLastStartTime = function(e, t) {
                    this._getGenerator(e).lastStartTime = t,
                    this.saveData()
                }
                ,
                t.prototype.setTimer = function(e, t) {
                    this._getGenerator(e).timerId = t,
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        function e(e, t) {
                            if (o[e]) {
                                var i = o[e].data;
                                this._generatorData[t] = {
                                    lastStartTime: i.lastSpawnTime,
                                    timerId: i.timerId
                                }
                            }
                        }
                        function t(e, t) {
                            if (o.RewardedRegenerationModel) {
                                var i = o[e].data.find((function(t) {
                                    return t.id === e
                                }
                                ));
                                i && (this._generatorData[t] = {
                                    lastStartTime: i.lastSpawnTime,
                                    timerId: i.timerId
                                })
                            }
                        }
                        var i, r, o, a = this;
                        return (0,
                        n.__generator)(this, (function(s) {
                            switch (s.label) {
                            case 0:
                                return i = [["EnergyRegenerationModel", rs], ["CrateRegenerationModel", os]],
                                r = ["energy_rv", "gem_rv", "crates_rv"],
                                [4, De.services.playerData.playerDataContainer.getPlayerData((0,
                                n.__spreadArray)((0,
                                n.__spreadArray)([this._name], i.map((function(e) {
                                    return e[0]
                                }
                                )), !0), r, !0))];
                            case 1:
                                return (o = s.sent())[this._name] || (i.forEach((function(t) {
                                    return e.call(a, t[0], t[1])
                                }
                                )),
                                r.forEach((function(e) {
                                    return t.call(a, e, e)
                                }
                                ))),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    for (var t in e)
                        this._generatorData[t] = (0,
                        n.__assign)({}, e[t])
                }
                ,
                t.prototype.onDataSave = function() {
                    return this._generatorData
                }
                ,
                t.prototype._getGenerator = function(e) {
                    if (!this._generatorData[e])
                        throw new Error("generator data with key ".concat(e, " does not exist"));
                    return this._generatorData[e]
                }
                ,
                t
            }($n), IS = function() {
                function e(e, t, i, n) {
                    this.onRegeneration = new r.Event,
                    this.onTimerStarted = new r.Event,
                    this.onTimerCancelled = new r.Event,
                    this._timer = null,
                    this.key = e,
                    this._config = t,
                    this._targetItem = i,
                    this._model = n,
                    this._logger = r.Logger.Of("ResourceGenerator_".concat(e))
                }
                return Object.defineProperty(e.prototype, "maxAmount", {
                    get: function() {
                        return this._config.MAX_AMOUNT
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "amountPerInterval", {
                    get: function() {
                        return this._config.AMOUNT_PER_INTERVAL
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "spawnInterval", {
                    get: function() {
                        return 1e3 * this._config.SPAWN_INTERVAL
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "timeBeforeNextSpawn", {
                    get: function() {
                        var e, t;
                        return null !== (t = null === (e = this._timer) || void 0 === e ? void 0 : e.remainingTime) && void 0 !== t ? t : -1
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "timerId", {
                    get: function() {
                        return this._model.getTimer(this.key)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.start = function() {
                    this._model.ensureGeneratorData(this.key);
                    var e = this._model.getTimer(this.key);
                    null !== e && (this._timer = De.services.timer.getTimerByID(e),
                    this._timer.onTimerFinished.addListener(this._handleTimerFinished, this)),
                    this._targetItem.onChanged.addListener(this._handleItemAmountChanged, this),
                    this._calculateOfflineGeneration(),
                    De.services.pageVisibility.onPageFocused.addListener(this._calculateOfflineGeneration, this)
                }
                ,
                e.prototype.destroy = function() {
                    this._timer && this._timer.onTimerFinished.removeListener(this._handleTimerFinished, this),
                    this._targetItem.onChanged.removeListener(this._handleItemAmountChanged, this),
                    this.onTimerCancelled.removeAllListeners(),
                    this.onTimerStarted.removeAllListeners(),
                    this.onRegeneration.removeAllListeners(),
                    De.services.pageVisibility.onPageFocused.removeListener(this._calculateOfflineGeneration, this)
                }
                ,
                e.prototype._calculateOfflineGeneration = function() {
                    if (!(this._targetItem.amount >= this.maxAmount)) {
                        var e = this._model.getLastStartTime(this.key);
                        if (e) {
                            var t = De.services.timer.currentTime - e;
                            if (!(t < this.spawnInterval)) {
                                this._removeTimer();
                                var i = Math.floor(t / this.spawnInterval)
                                  , n = Math.min(i * this.amountPerInterval, this.maxAmount - this._targetItem.amount);
                                if (this._targetItem.amount + n < this.maxAmount) {
                                    var r = e + (i + 1) * this.spawnInterval;
                                    this._startTimer(r - De.services.timer.currentTime)
                                }
                                this._addResource(n)
                            }
                        } else
                            this._recoverFromInvalidState()
                    }
                }
                ,
                e.prototype._handleTimerFinished = function(e) {
                    this._removeTimer();
                    var t = Math.min(this.amountPerInterval, this.maxAmount - this._targetItem.amount);
                    this._addResource(t)
                }
                ,
                e.prototype._handleItemAmountChanged = function(e) {
                    this._targetItem.amount < this.maxAmount && null === this._model.getTimer(this.key) && this._startTimer(),
                    this._targetItem.amount >= this.maxAmount && null !== this._model.getTimer(this.key) && this._removeTimer()
                }
                ,
                e.prototype._startTimer = function(e) {
                    if (this._timer)
                        this._logger.warn("can't start a timer for generator ".concat(this.key, " as it is already running"));
                    else {
                        this._model.setLastStartTime(this.key, De.services.timer.currentTime);
                        var t = De.services.timer.addTimer(null != e ? e : this.spawnInterval, "regenerate_".concat(this.key));
                        this._model.setTimer(this.key, t.id),
                        this.onTimerStarted.fire({
                            generator: this,
                            timerID: t.id
                        }),
                        this._timer = t,
                        this._timer.onTimerFinished.addListener(this._handleTimerFinished, this)
                    }
                }
                ,
                e.prototype._removeTimer = function() {
                    this._timer && (this._model.setTimer(this.key, null),
                    this.onTimerCancelled.fire({
                        generator: this,
                        timerID: -1
                    }),
                    this._timer.onTimerFinished.removeListener(this._handleTimerFinished, this),
                    this._timer = null)
                }
                ,
                e.prototype._addResource = function(e) {
                    this._targetItem.amount += e,
                    this._targetItem.updateVisuals(),
                    this.onRegeneration.fire({
                        amount: e
                    })
                }
                ,
                e.prototype._recoverFromInvalidState = function() {
                    this._logger.error("ResourceGenerator ".concat(this.key, " hit an invalid state!")),
                    this._targetItem.amount = this.maxAmount
                }
                ,
                e
            }(), SS = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._model = new CS,
                    t._generators = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._generators.forEach((function(e) {
                                return e.destroy()
                            }
                            )),
                            this.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getGenerator = function(e) {
                    if (!this._generators.has(e))
                        throw new Error("generator ".concat(e, " does not exist"));
                    return this._generators.get(e)
                }
                ,
                t.prototype.createGenerator = function(e, t, i, n) {
                    if (void 0 === n && (n = !0),
                    this._generators.has(e))
                        return this._logger.warn("generator ".concat(e, " already exists")),
                        this.getGenerator(e);
                    var r = new IS(e,t,i,this._model);
                    return this._generators.set(e, r),
                    n && r.start(),
                    r
                }
                ,
                t.prototype.startGenerator = function(e) {
                    var t;
                    null === (t = this._generators.get(e)) || void 0 === t || t.start()
                }
                ,
                t.prototype.hasGenerator = function(e) {
                    return this._generators.has(e)
                }
                ,
                t
            }(Se), OS = Rp({
                2: function(e) {
                    return {
                        inviteFriendsData: {
                            token: e.inviteFriendsData.token,
                            claims: e.inviteFriendsData.claims.map((function(e) {
                                return e.userid
                            }
                            ))
                        },
                        heavyObjectData: e.heavyObjectData.map((function(e) {
                            return {
                                cell: e.cell,
                                token: e.token,
                                claims: e.claims.map((function(e) {
                                    return e.userid
                                }
                                ))
                            }
                        }
                        ))
                    }
                }
            }), bS = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._version = 2,
                    t._name = "TokensServiceModel",
                    t._inviteFriendsData = {
                        token: "",
                        claims: []
                    },
                    t._heavyObjectData = [],
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "inviteFriendsToken", {
                    get: function() {
                        return this._inviteFriendsData.token
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "inviteFriendsClaims", {
                    get: function() {
                        return this._inviteFriendsData
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "heavyObjectTokens", {
                    get: function() {
                        return this._heavyObjectData
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "heavyObjectClaims", {
                    get: function() {
                        return this._heavyObjectData
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.hasTokenForInvitingFriends = function() {
                    return Boolean(this._inviteFriendsData.token && this._inviteFriendsData.token.length > 1)
                }
                ,
                t.prototype.addTokenForInvitingFriends = function(e) {
                    this._inviteFriendsData.token = e,
                    this.saveData()
                }
                ,
                t.prototype.addClaimsForInvitingFriends = function(e) {
                    var t, i = e.newclaims;
                    (t = this._inviteFriendsData.claims).push.apply(t, Object.keys(i)),
                    this.saveData()
                }
                ,
                t.prototype.hasTokenForHeavyObject = function(e) {
                    var t = e.row
                      , i = e.column;
                    return this._heavyObjectData.some((function(e) {
                        return e.cell.column === i && e.cell.row === t
                    }
                    ))
                }
                ,
                t.prototype.getTokenForHeavyObject = function(e) {
                    var t = e.row
                      , i = e.column
                      , n = this._heavyObjectData.find((function(e) {
                        return e.cell.column === i && e.cell.row === t
                    }
                    ));
                    if (!n)
                        throw new Error("TokensServiceModel: can't get token for column: ".concat(i, ", row: ").concat(t));
                    return n.token
                }
                ,
                t.prototype.addNewTokenForHeavyObject = function(e, t) {
                    this._heavyObjectData.push({
                        cell: {
                            column: e.column,
                            row: e.row
                        },
                        token: t,
                        claims: []
                    }),
                    this.saveData()
                }
                ,
                t.prototype.removeTokenForHeavyObject = function(e, t) {
                    var i = e.row
                      , n = e.column
                      , r = this._heavyObjectData.find((function(e) {
                        return e.token === t && e.cell.column === n && e.cell.row === i
                    }
                    ));
                    r ? (this._heavyObjectData.splice(this._heavyObjectData.indexOf(r), 1),
                    this.saveData()) : this._logger.warn("can't remove the TokenData for HO at row: ".concat(i, ", column: ").concat(n, ", with token: ").concat(t))
                }
                ,
                t.prototype.addClaimsForHeavyObjects = function(e, t) {
                    var i, n = t.newclaims, r = this._heavyObjectData.find((function(t) {
                        return t.token === e
                    }
                    ));
                    if (!r)
                        throw new Error("TokensServiceModel: can't get HeavyObjectTokenData for token: ".concat(e));
                    (i = r.claims).push.apply(i, Object.keys(n)),
                    this.saveData()
                }
                ,
                t.prototype.removeClaims = function(e, t) {
                    this._inviteFriendsData.token === t && (this._inviteFriendsData.claims = this._inviteFriendsData.claims.filter((function(t) {
                        return t !== e
                    }
                    )));
                    var i = this._heavyObjectData.find((function(e) {
                        return e.token === t
                    }
                    ));
                    i && (i.claims = i.claims.filter((function(t) {
                        return t !== e
                    }
                    ))),
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._inviteFriendsData = e.inviteFriendsData,
                    this._heavyObjectData = e.heavyObjectData
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        inviteFriendsData: JSON.parse(JSON.stringify(this._inviteFriendsData)),
                        heavyObjectData: JSON.parse(JSON.stringify(this._heavyObjectData))
                    }
                }
                ,
                t.prototype.migrateData = function(e) {
                    return OS(e, 2)
                }
                ,
                t
            }($n);
            !function(e) {
                e.HEAVY_OBJECT = "help_with_heavy_object",
                e.CRATES_FOR_FRIENDS = "invite_new_friends"
            }(yS || (yS = {}));
            var RS, wS = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._model = new bS,
                    i._internalService = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "inviteFriendsClaims", {
                    get: function() {
                        return this._model.inviteFriendsClaims
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "heavyObjectClaims", {
                    get: function() {
                        return this._model.heavyObjectClaims
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.getTokenForHeavyObject = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._model.hasTokenForHeavyObject(e) ? [3, 2] : (t || this._logger.warn("Creating token for heavy object at ".concat(e.column, ",").concat(e.row, ", but no hitpoints are provided. Defaulting to infinite claims")),
                                [4, this._internalService.createReward(yS.HEAVY_OBJECT, t, void 0, void 0, void 0, !1, !0)]);
                            case 1:
                                i = n.sent(),
                                this._model.addNewTokenForHeavyObject(e, i),
                                n.label = 2;
                            case 2:
                                return [2, this._model.getTokenForHeavyObject(e)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.removeTokenForHeavyObject = function(e, t) {
                    this._model.removeTokenForHeavyObject(e, t)
                }
                ,
                t.prototype.getTokenForInvitingFriends = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return this._model.hasTokenForInvitingFriends() ? [3, 2] : [4, this._internalService.createReward(yS.CRATES_FOR_FRIENDS, void 0, void 0, void 0, void 0, !0)];
                            case 1:
                                e = t.sent(),
                                this._model.addTokenForInvitingFriends(e),
                                t.label = 2;
                            case 2:
                                return [2, this._model.inviteFriendsToken]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return [4, this.services.autosave.registerModel(this._model)];
                            case 1:
                                return t.sent(),
                                [4, Promise.all((0,
                                n.__spreadArray)([this._internalService.getNewRewardClaims(this._model.inviteFriendsToken).then((function(t) {
                                    return e._model.addClaimsForInvitingFriends(t)
                                }
                                )).catch((function(t) {
                                    return e._logger.warn(t)
                                }
                                ))], this._model.heavyObjectTokens.map((function(t) {
                                    var i = t.token;
                                    return e._internalService.getNewRewardClaims(i).then((function(t) {
                                        return e._model.addClaimsForHeavyObjects(i, t)
                                    }
                                    )).catch((function(t) {
                                        return e._logger.warn(t)
                                    }
                                    ))
                                }
                                )), !0))];
                            case 2:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.getRewardData = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                t = null,
                                n.label = 1;
                            case 1:
                                return n.trys.push([1, 3, , 4]),
                                [4, this._internalService.getRewardData(e)];
                            case 2:
                                return t = n.sent(),
                                [3, 4];
                            case 3:
                                return i = n.sent(),
                                this._logger.warn(i),
                                [3, 4];
                            case 4:
                                return [2, t]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.useToken = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                t = null,
                                n.label = 1;
                            case 1:
                                return n.trys.push([1, 3, , 4]),
                                [4, this._internalService.claimReward(e)];
                            case 2:
                                return i = n.sent(),
                                t = i.rewardtype,
                                [3, 4];
                            case 3:
                                return r = n.sent(),
                                this._logger.warn(r),
                                [2, Promise.reject(r)];
                            case 4:
                                return [2, t]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.removeUsedToken = function(e, t) {
                    this._model.removeClaims(e, t)
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.autosave.unregisterModel(this._model),
                            this._internalService = null,
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se), DS = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i._name = "SettingsModel",
                    i._version = 1,
                    i._settings = (0,
                    n.__assign)({}, t),
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.get = function(e) {
                    return this._settings[e]
                }
                ,
                t.prototype.set = function(e, t) {
                    this._settings[e] = t,
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            return e = "AudioServiceModel",
                            t = De.services.playerData,
                            (i = t.playerDataContainer.getPlayerData([this._name, e]))[this._name] ? [2] : i[e] ? (r = i[e].data,
                            this._settings.musicEnabled = r.isMusicEnabled,
                            this._settings.sfxEnabled = r.isSoundEnabled,
                            [2]) : [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._settings = (0,
                    n.__assign)((0,
                    n.__assign)({}, this._settings), e)
                }
                ,
                t.prototype.onDataSave = function() {
                    return (0,
                    n.__assign)({}, this._settings)
                }
                ,
                t
            }($n), NS = {
                musicEnabled: !0,
                sfxEnabled: !0
            }, LS = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._model = new DS(NS),
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.autosave.registerModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this.services.autosave.unregisterModel(this._model)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.get = function(e) {
                    return this._model.get(e)
                }
                ,
                t.prototype.set = function(e, t) {
                    this._model.set(e, t)
                }
                ,
                t
            }(Se);
            !function(e) {
                e.COLLECT = "collect",
                e.MAKE_ITEM = "make_item",
                e.COMPLETE_ORDER = "complete_order",
                e.PURCHASE_LAND = "purchase_land",
                e.OPEN_SUPPLIES = "open_supplies",
                e.REPAIR_BUILDING = "repair_building",
                e.REMOVE_NATURE = "remove_nature"
            }(RS || (RS = {}));
            var BS, PS, kS, xS = function() {
                function e() {}
                return e.prototype.createTask = function(e) {
                    switch (e.type) {
                    case RS.COLLECT:
                        return this._createCollectTask(e);
                    case RS.COMPLETE_ORDER:
                        return this._createOrderTask(e);
                    case RS.MAKE_ITEM:
                        return this._createMakeItemTask(e);
                    case RS.REMOVE_NATURE:
                        return this._createRemoveNatureTask(e);
                    case RS.REPAIR_BUILDING:
                        return this._createRepairBuildingTask(e);
                    case RS.OPEN_SUPPLIES:
                        return this._createOpenSuppliesTask(e);
                    case RS.PURCHASE_LAND:
                        return this._createPurchaseLandTask(e)
                    }
                }
                ,
                e.prototype._createCollectTask = function(e) {
                    var t = De.services.experience.getAvailableCrateContents()
                      , i = r.ArrayUtility.getRandomItem(t)
                      , n = De.services.blueprintGraphService.getCollectableInventoryItemsFromBlueprint(i)
                      , o = De.services.blueprintCollection.getBlueprint(De.services.blueprintGraphService.getCollectItemFromBlueprint(i))
                      , a = r.ArrayUtility.getRandomItem(n).toString()
                      , s = De.services.tasks.getfactoryConfig(e.id);
                    return e.goal.targetValue = this._getTargetValue(s),
                    e.image = {
                        alias: o.components.sprite.alias
                    },
                    e.goal.action = e.goal.action.replace("@", a),
                    e
                }
                ,
                e.prototype._createOrderTask = function(e) {
                    var t = De.services.experience.getAvailableRecipes()
                      , i = De.services.buildings.activeBuildings
                      , n = r.ArrayUtility.getRandomItem(i)
                      , o = De.services.tasks.getfactoryConfig(e.id);
                    if (e.goal.targetValue = this._getTargetValue(o),
                    o.genericThreshold && o.genericThreshold < Math.random()) {
                        var a = De.services.buildings.getAvailableRecipes(n)
                          , s = t.filter((function(e) {
                            return a.includes(e)
                        }
                        ))
                          , _ = r.ArrayUtility.getRandomItem(s)
                          , c = De.services.recipes.getRecipe(_);
                        e.goal.action = e.goal.action.replace("@", n),
                        e.goal.action = e.goal.action.replace("@", _),
                        e.image = c.image
                    } else
                        e.goal.action = this._cleanupTrailingCharacters(e.goal.action),
                        e.image = {
                            alias: "icon_tasks_complete_orders"
                        };
                    return e
                }
                ,
                e.prototype._createMakeItemTask = function(e) {
                    var t = De.services.experience.getAvailableCrateContents()
                      , i = r.ArrayUtility.getRandomItem(t)
                      , n = r.ArrayUtility.getRandomItem([2, 3, 4])
                      , o = De.services.blueprintGraphService.getGraphNameFromBlueprintID(i)
                      , a = "".concat(o, "_").concat(n)
                      , s = De.services.blueprintCollection.getBlueprint(a)
                      , _ = De.services.tasks.getfactoryConfig(e.id);
                    return e.goal.targetValue = this._getTargetValue(_),
                    e.image = {
                        alias: s.components.sprite.alias
                    },
                    e.goal.action = e.goal.action.replace("@", o),
                    e.goal.action = e.goal.action.replace("@", a),
                    e
                }
                ,
                e.prototype._createRemoveNatureTask = function(e) {
                    var t = [];
                    if (De.services.discovery.getDiscoveredItems().concat(De.services.discovery.getUnclaimedItems()).forEach((function(e) {
                        var i = e.split("_")[0];
                        Object.values(Kt).includes(i) && t.push(e)
                    }
                    )),
                    0 !== t.length) {
                        var i = r.ArrayUtility.getRandomItem(t)
                          , n = De.services.tasks.getfactoryConfig(e.id);
                        if (e.goal.targetValue = this._getTargetValue(n),
                        n.genericThreshold && n.genericThreshold < Math.random()) {
                            var o = i.split("_")[0];
                            if (n.genericThreshold < Math.random()) {
                                var a = De.services.blueprintCollection.getBlueprint(i);
                                e.image = {
                                    alias: a.components.sprite.alias
                                },
                                e.goal.action = e.goal.action.replace("@", o),
                                e.goal.action = e.goal.action.replace("@", i)
                            } else
                                e.goal.action = e.goal.action.replace("@", o),
                                e.goal.action = this._cleanupTrailingCharacters(e.goal.action)
                        } else
                            e.goal.action = this._cleanupTrailingCharacters(e.goal.action);
                        return e.image = {
                            alias: "icon_tasks_remove_nature"
                        },
                        e
                    }
                }
                ,
                e.prototype._createRepairBuildingTask = function(e) {
                    var t = De.services.buildings.inactiveBuildings;
                    if (0 !== t.length) {
                        var i = t[t.length - 1]
                          , n = De.services.tasks.getfactoryConfig(e.id);
                        return e.goal.targetValue = this._getTargetValue(n),
                        e.image = {
                            alias: "icon_tasks_repair"
                        },
                        e.goal.action = e.goal.action.replace("@", i),
                        e
                    }
                }
                ,
                e.prototype._createOpenSuppliesTask = function(e) {
                    var t = De.services.tasks.getfactoryConfig(e.id);
                    return e.goal.targetValue = this._getTargetValue(t),
                    e
                }
                ,
                e.prototype._createPurchaseLandTask = function(e) {
                    var t = {
                        id: ""
                    };
                    if (De.services.tasks.requestAreaToUnlock.fire(t),
                    "" !== t.id) {
                        var i = De.services.tasks.getfactoryConfig(e.id);
                        return e.goal.targetValue = this._getTargetValue(i),
                        e
                    }
                }
                ,
                e.prototype._getTargetValue = function(e) {
                    var t = e.noLevelAdaptation ? 1 : De.services.experience.getLevel()
                      , i = Math.floor(Math.random() * (e.target.high * t - e.target.low * t + 1) + e.target.low * t)
                      , n = e.targetValueStep ? e.targetValueStep : 1;
                    return r.NumberUtility.clamp(1, i - i % n, 100)
                }
                ,
                e.prototype._cleanupTrailingCharacters = function(e) {
                    return (e = e.split("@")[0]).slice(0, -1)
                }
                ,
                e
            }(), GS = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._name = "TaskModel",
                    t._version = 1,
                    t._activeTaskData = [],
                    t._completedTasks = [],
                    t._taskQueue = new Map,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "trackedTaskID", {
                    get: function() {
                        return this._trackedTaskID
                    },
                    set: function(e) {
                        this._trackedTaskID = e,
                        this.saveData()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.addTask = function(e) {
                    this.hasTask(e.id) || (this._activeTaskData.push({
                        id: e.id,
                        type: e.type,
                        data: e.getData()
                    }),
                    this.saveData())
                }
                ,
                t.prototype.addToQueue = function(e) {
                    var t = this._taskQueue.get(e.descriptionKey) || [];
                    t.push(e),
                    this._taskQueue.set(e.descriptionKey, t),
                    this.saveData()
                }
                ,
                t.prototype.getTaskFromQueue = function(e) {
                    var t = this._taskQueue.get(e);
                    if ((0,
                    r.isArray)(t) && t.length > 0) {
                        var i = t.shift();
                        if (i)
                            return this._taskQueue.set(e, t),
                            this.saveData(),
                            i;
                        this._logger.error("task queue gave invalid task array with descriptionKey: ".concat(e))
                    }
                }
                ,
                t.prototype.hasTask = function(e) {
                    return void 0 !== this._activeTaskData.find((function(t) {
                        return t.id === e
                    }
                    ))
                }
                ,
                t.prototype.getTasksData = function() {
                    return this._removeUnsupportedTasks(),
                    this._activeTaskData
                }
                ,
                t.prototype.setTaskAsCompleted = function(e) {
                    this._completedTasks.push(e)
                }
                ,
                t.prototype.isTaskCompleted = function(e) {
                    return this._completedTasks.includes(e)
                }
                ,
                t.prototype.forceSave = function() {
                    this.saveData()
                }
                ,
                t.prototype.removeTask = function(e) {
                    this._activeTaskData = this._activeTaskData.filter((function(t) {
                        return t.id !== e
                    }
                    )),
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    for (var t in this._activeTaskData = e.activeTaskData,
                    this._trackedTaskID = e.trackedTaskID,
                    this._completedTasks = e.completedTasks,
                    e.taskQueue)
                        this._taskQueue.set(t, e.taskQueue[t])
                }
                ,
                t.prototype.onDataSave = function() {
                    var e = {};
                    return this._taskQueue.forEach((function(t, i) {
                        e[i] = t
                    }
                    )),
                    {
                        activeTaskData: this._activeTaskData,
                        trackedTaskID: this._trackedTaskID,
                        completedTasks: this._completedTasks,
                        taskQueue: e
                    }
                }
                ,
                t.prototype._removeUnsupportedTasks = function() {
                    var e = this;
                    if (!(this._activeTaskData.length < 1)) {
                        var t = (0,
                        n.__spreadArray)((0,
                        n.__spreadArray)([], De.services.resource.getJson(_e.PREDEFINED_TASKS_CONFIG), !0), De.services.resource.getJson(_e.TASKS_CONFIG), !0).map((function(e) {
                            return e.id
                        }
                        ));
                        this._activeTaskData.forEach((function(i) {
                            if (t.includes(i.id)) {
                                if (i.type === RS.REPAIR_BUILDING) {
                                    var n = i.data.goal.action.replace(/^improveBuilding\.|\.active$/g, "");
                                    if (De.services.buildings.isBuildingActive(n))
                                        return e.removeTask(i.id),
                                        void (e.trackedTaskID === i.id && (e.trackedTaskID = -1))
                                }
                            } else
                                e.removeTask(i.id)
                        }
                        )),
                        this.trackedTaskID && !t.includes(this.trackedTaskID) && (this.trackedTaskID = this._activeTaskData.length > 0 ? this._activeTaskData[0].id : void 0)
                    }
                }
                ,
                t
            }($n), US = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.IMMEDIATE,
                    i._name = "TaskOverviewPopup",
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    var t = this._createBackground();
                    t.addChild(this._createScrollableContainer(t)),
                    this._content.addChild(t),
                    e()
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {
                    this._inputBlocker.interactive = !1,
                    this._inputBlocker.off("pointerdown", this._tryToClose, this),
                    v.GroupsCore.Updateables.remove(this._scrollContainer)
                }
                ,
                t.prototype._createBackground = function() {
                    var e = new Ar({
                        size: {
                            width: 1e3,
                            height: 1100
                        },
                        headerSize: {
                            width: 666.6666666666666,
                            height: 75
                        },
                        headerText: ce.TASK_OVERVIEW_POPUP_TITLE,
                        headerStyle: vn.popupTitle
                    });
                    return e.onCloseClick(this.close.bind(this)),
                    e
                }
                ,
                t.prototype._createScrollableContainer = function(e) {
                    var t = this;
                    this._scrollContainer = new v.ScrollableContainer({
                        friction: .8,
                        autoFitContent: !0
                    }),
                    De.services.tasks.getTasks().forEach((function(e, i) {
                        var n = 0 === i ? 0 : 15
                          , r = t._createTaskContent(e);
                        r.y = t._scrollContainer.getContentBounds().height + n,
                        t._scrollContainer.addContent(r)
                    }
                    )),
                    this._scrollContainer.setBounds(new Xe.Rectangle(-e.width / 2,0,e.width - 25,e.height - 115)),
                    this._scrollContainer.position.set((e.width - this._scrollContainer.getContentBounds().width) / 2, -e.height / 2 + 110),
                    this._scrollContainer.setPosition(new Xe.Point(0,this._scrollContainer.height));
                    var i = this._scrollContainer.addChild((new Xe.Graphics).beginFill(16777215).drawShape(this._scrollContainer.getBounds()).endFill());
                    return this._scrollContainer.mask = i,
                    this._scrollContainer.getContentBounds().height < 1e3 && this._scrollContainer.disableScroll(),
                    v.GroupsCore.Updateables.add(this._scrollContainer),
                    this._scrollContainer
                }
                ,
                t.prototype._createTaskContent = function(e) {
                    var t = new Xe.Container
                      , i = t.addChild(new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN01_9SLICE)));
                    i.setSizes({
                        width: 970,
                        height: 310
                    }),
                    i.anchor.set(.5);
                    var n = t.addChild(De.services.resource.getSprite(f.BG_TASKS_232));
                    n.position.set(n.width / 1.5 - i.width / 2, i.y - 20),
                    n.anchor.set(.5);
                    var r = e.getVisual()
                      , o = Math.min((n.width - 55) / r.width, (n.height - 55) / r.height);
                    r.scale.set(o),
                    n.addChild(r);
                    var a = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 90,
                        fitWidth: 350
                    });
                    a.style = vn.darkMedium;
                    var s = t.addChild(new v.Label(e.description,a));
                    s.anchor.set(0, .5),
                    s.position.set(n.x + (n.width / 2 + 25), i.y);
                    var _ = t.addChild(De.services.resource.getSprite(f.BG_TASKS_PILL));
                    _.anchor.set(.5),
                    _.position.set(n.x, n.y + n.height / 2 + _.height / 5),
                    a.style = vn.darkSmall;
                    var c = t.addChild(new v.Label("".concat(e.goal.currentValue, "/").concat(e.goal.targetValue),a));
                    c.anchor.set(.5),
                    c.position.set(_.x, _.y);
                    var l = t.addChild(this._createRewards(e));
                    return l.position.set(i.width / 2 - l.width / 2, 0),
                    this._showButton = t.addChild(this._createShowButton()),
                    this._showButton.position.set(l.x, i.y + i.height / 2.75),
                    this._showButton.onClick((function() {
                        De.services.analytics.design.reportTaskTrackButtonPressed(),
                        De.services.tasks.trackedTask = e
                    }
                    )),
                    t.position.set(-t.width / 2, 0),
                    t
                }
                ,
                t.prototype._createRewards = function(e) {
                    var t = new Xe.Container
                      , i = t.addChild(new cr(De.services.resource.getTexture(f.POPUP_BG_LIGHTBROWN02_9SLICE)));
                    i.setSizes({
                        width: 250,
                        height: 310
                    }),
                    i.anchor.set(.5);
                    var r = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 100,
                        fitWidth: 400
                    });
                    r.style = vn.darkSmall;
                    var o = t.addChild(new v.Label("".concat(nr(BS || (BS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.REWARDS), ":"),r));
                    return o.anchor.set(.5),
                    o.position.set(0, -120),
                    e.getRewards().forEach((function(e, i) {
                        var n = new Xe.Container;
                        if ("inventory" === e.type) {
                            (a = n.addChild(De.services.resource.getSprite(Ia[e.key]))).anchor.set(1, .5),
                            a.position.set(0, 0),
                            a.scale.set(.4);
                            var o = n.addChild(new v.Label("".concat(e.amount),r));
                            o.anchor.set(0, .5),
                            o.position.set(20, 0)
                        } else {
                            var a, s = e.key.split("_")[0];
                            (a = n.addChild(De.services.resource.getSprite(Ia[s]))).scale.set(.4),
                            a.anchor.set(.5),
                            a.position.set(0, 0)
                        }
                        n.position.set(0, 80 * i - 50),
                        t.addChild(n)
                    }
                    )),
                    t
                }
                ,
                t.prototype._createShowButton = function() {
                    return new fr({
                        name: "show",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: 200,
                            height: 80
                        }
                    },{
                        text: ce.TASK_SHOW_BUTTON,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 0,
                            y: -5
                        }
                    })
                }
                ,
                t
            }(yr), FS = function() {
                function e() {
                    this.id = 0,
                    this.onUpdated = new r.Event,
                    this.onCompleted = new r.Event,
                    this._rewards = []
                }
                return Object.defineProperty(e.prototype, "description", {
                    get: function() {
                        return nr(PS || (PS = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), {
                            alias: this._descriptionKey
                        })
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.getVisual = function() {
                    var e = new Xe.Container
                      , t = De.services.resource.getSprite(this._imageAsset);
                    return t.anchor.set(.5),
                    e.addChild(t),
                    e
                }
                ,
                e.prototype.getRewards = function() {
                    return this._rewards
                }
                ,
                e.prototype.setData = function(e) {
                    this.id = e.id,
                    this.type = e.type,
                    this.goal = e.goal,
                    this._rewards = e.rewards,
                    this._descriptionKey = e.descriptionKey,
                    this._imageAsset = e.image,
                    De.services.actions.on(this.goal.action, this._onAction, this)
                }
                ,
                e.prototype.getData = function() {
                    return {
                        id: this.id,
                        goal: this.goal,
                        image: this._imageAsset,
                        descriptionKey: this._descriptionKey,
                        rewards: this._rewards,
                        type: this.type
                    }
                }
                ,
                e.prototype.destroy = function() {
                    De.services.actions.off(this.goal.action, this._onAction, this)
                }
                ,
                e.prototype._onAction = function() {
                    this.goal.currentValue++,
                    this.goal.currentValue === this.goal.targetValue ? this.onCompleted.fire(this) : this.goal.currentValue < this.goal.targetValue && this.onUpdated.fire(this)
                }
                ,
                e
            }(), MS = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t.onNewTaskTracked = new r.Event,
                    t.requestAreaToUnlock = new r.Event,
                    t._tasks = [],
                    t._taskToBeAnnounced = !1,
                    t._factory = new xS,
                    t._model = new GS,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "factory", {
                    get: function() {
                        return this._factory
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "predefinedTasks", {
                    get: function() {
                        return this._predefinedTasks
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "tasksBlueprints", {
                    get: function() {
                        return this._taskBlueprints
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "trackedTask", {
                    get: function() {
                        var e = this;
                        return this._tasks.find((function(t) {
                            return t.id === e._model.trackedTaskID
                        }
                        ))
                    },
                    set: function(e) {
                        (null == e ? void 0 : e.id) !== this._model.trackedTaskID && (this._model.trackedTaskID = (null == e ? void 0 : e.id) || void 0,
                        this.onNewTaskTracked.fire(e))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.isTrackingTask = function() {
                    return !(0,
                    r.isUndefined)(this.trackedTask)
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return [4, Promise.all([De.services.autosave.registerModel(this._model), De.services.assetLoader.loadJsons(_e.PREDEFINED_TASKS_CONFIG), De.services.assetLoader.loadJsons(_e.TASKS_CONFIG), De.services.assetLoader.loadJsons(_e.TASK_FACTORY_CONFIG)])];
                            case 1:
                                return i.sent(),
                                e = De.services.resource.getJson(_e.PREDEFINED_TASKS_CONFIG),
                                (0,
                                r.isNull)(e) || (this._predefinedTasks = e.filter((function(e) {
                                    return !t._model.isTaskCompleted(e.id)
                                }
                                )),
                                this._setPredefinedTaskTriggers(),
                                this._predefinedTasks.forEach((function(e) {
                                    if (e.type === RS.REPAIR_BUILDING) {
                                        var i = e.goal.action.replace(/^improveBuilding\.|\.active$/g, "");
                                        De.services.buildings.isBuildingUpgrading(i) && t.addTask(e, !1, !1)
                                    }
                                }
                                )),
                                this._taskBlueprints = De.services.resource.getJson(_e.TASKS_CONFIG),
                                this._factoryConfig = De.services.resource.getJson(_e.TASK_FACTORY_CONFIG),
                                (0,
                                r.isNull)(this._taskBlueprints) || (0,
                                r.isNull)(this._factoryConfig) || (this._model.getTasksData().forEach((function(e) {
                                    t.getTask(e.data.id) || t.addTask(e.data, !1)
                                }
                                )),
                                !this.isTrackingTask() && this._tasks.length > 0 && (this.trackedTask = this._tasks[0]))),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDestroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._tasks.forEach((function(t) {
                                t.destroy(),
                                t.onCompleted.removeListener(e._handleTaskCompleted, e),
                                t.onUpdated.removeListener(e._handleTaskUpdated, e)
                            }
                            )),
                            this._predefinedTasks.forEach((function(t) {
                                t.trigger && (me(t.trigger) ? t.trigger : [t.trigger]).forEach((function(i) {
                                    return De.services.actions.off(i, (function() {
                                        return e.addTask(t, !0, !0)
                                    }
                                    ), e)
                                }
                                ))
                            }
                            )),
                            De.services.autosave.unregisterModel(this._model),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.addTask = function(e, t, i) {
                    if (void 0 === t && (t = !0),
                    void 0 === i && (i = !1),
                    !this.getTask(e.id)) {
                        if (this._isTaskTypeActive(e.descriptionKey))
                            return this._logger.info("ADDING TASK TO QUEUE"),
                            void this._model.addToQueue(e);
                        var n = new FS;
                        return n.setData(e),
                        this._model.addTask(n),
                        this._tasks.push(n),
                        n.onCompleted.listenOnce(this._handleTaskCompleted, this),
                        n.onUpdated.addListener(this._handleTaskUpdated, this),
                        i && (this._openTaskAnnouncementPopup(n),
                        this._taskToBeAnnounced = !0,
                        De.services.analytics.design.reportNewTaskStarted(n.id)),
                        t && (this._model.trackedTaskID = n.id),
                        n
                    }
                    this._logger.error("task with id and type: ".concat(e.id, ": ").concat(e.type, ", already exists"))
                }
                ,
                t.prototype.getTasks = function() {
                    return this._tasks
                }
                ,
                t.prototype.getTask = function(e) {
                    return this._tasks.find((function(t) {
                        return t.id === e
                    }
                    ))
                }
                ,
                t.prototype.getfactoryConfig = function(e) {
                    return this._factoryConfig.find((function(t) {
                        return t.id === e
                    }
                    ))
                }
                ,
                t.prototype.animateTaskRewards = function(e, t) {
                    var i = this;
                    e.getRewards().forEach((function(e) {
                        i._spawnRewardAnimation({
                            key: e.key,
                            amount: e.amount
                        }, t)
                    }
                    ))
                }
                ,
                t.prototype.openOverviewPopup = function() {
                    De.services.navigation.closeAllPopups(),
                    De.services.navigation.showPopup(US, {}),
                    De.services.analytics.design.reportTaskPopupOpened()
                }
                ,
                t.prototype._isTaskTypeActive = function(e) {
                    return !!this._tasks.find((function(t) {
                        return t.getData().descriptionKey === e
                    }
                    ))
                }
                ,
                t.prototype._rewardTask = function(e) {
                    e.getRewards().forEach((function(e) {
                        De.services.inventory.addAmount(e.key, e.amount, !1)
                    }
                    ))
                }
                ,
                t.prototype._handleTaskUpdated = function() {
                    this._model.forceSave()
                }
                ,
                t.prototype._handleTaskCompleted = function(e) {
                    this._model.hasTask(e.id) && (this._openTaskCompletedPopup(e),
                    this._predefinedTasks.find((function(t) {
                        return t.id === e.id
                    }
                    )) && this._model.setTaskAsCompleted(e.id),
                    this._tasks.splice(this._tasks.indexOf(e), 1),
                    this._model.removeTask(e.id),
                    De.services.actions.emit("completeTask.".concat(e.id)),
                    De.services.analytics.design.reportTaskCompleted(e.id));
                    var t = this._model.getTaskFromQueue(e.getData().descriptionKey);
                    t && (this._logger.info("STARTING TASK FROM QUEUE"),
                    this.addTask(t, !0, !0)),
                    e.destroy()
                }
                ,
                t.prototype._openTaskAnnouncementPopup = function(e, t) {
                    return void 0 === t && (t = !1),
                    (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var i = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return De.services.navigation.isDialogOpen() ? (this._scheduleDelayedPopup(this._openTaskAnnouncementPopup, e, t),
                                [3, 3]) : [3, 1];
                            case 1:
                                return [4, De.services.navigation.showPopup(Ea, {
                                    task: e,
                                    startWithBlackBackground: t
                                }, !0)];
                            case 2:
                                n.sent().onClosed.listenOnce((function() {
                                    i._taskToBeAnnounced = !1,
                                    i.onNewTaskTracked.fire(e)
                                }
                                ), this),
                                n.label = 3;
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._openTaskCompletedPopup = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var t = this;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return De.services.navigation.isDialogOpen() ? (this._scheduleDelayedPopup(this._openTaskCompletedPopup, e),
                                [3, 3]) : [3, 1];
                            case 1:
                                return this._rewardTask(e),
                                [4, De.services.navigation.showPopup(wa, {
                                    task: e
                                }, !0)];
                            case 2:
                                i.sent().onClosed.listenOnce((function() {
                                    if (!t._taskToBeAnnounced) {
                                        var e = r.ArrayUtility.getRandomItem(t._tasks);
                                        t.trackedTask = e
                                    }
                                }
                                ), this),
                                i.label = 3;
                            case 3:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._scheduleDelayedPopup = function(e) {
                    for (var t = this, i = [], n = 1; n < arguments.length; n++)
                        i[n - 1] = arguments[n];
                    var r = function() {}
                      , o = function() {
                        e.apply(t, i),
                        De.services.transition.onGoingToFriend.removeListener(r, t)
                    };
                    r = function() {
                        De.services.navigation.onDialogClosed.removeListener(o, t)
                    }
                    ,
                    De.services.navigation.onDialogClosed.listenOnce(o, this),
                    De.services.transition.onGoingToFriend.listenOnce(r, this)
                }
                ,
                t.prototype._setPredefinedTaskTriggers = function() {
                    var e = this;
                    this._predefinedTasks.forEach((function(t) {
                        t.trigger && (me(t.trigger) ? t.trigger : [t.trigger]).forEach((function(i) {
                            return De.services.actions.on(i, (function() {
                                return e.addTask(t, !0, !0)
                            }
                            ), e)
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._spawnRewardAnimation = function(e, t) {
                    var i = De.services.navigation.layers.popup.container
                      , n = t.toGlobal(new Xe.Point(0,0))
                      , r = De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter(e)
                      , o = r.target
                      , a = r.icon
                      , s = o.toGlobal(new Xe.Point(0,0))
                      , _ = new Lr(De.services.resource.getSprite(a),i.toLocal(n),i.toLocal(s),e.amount,i);
                    _.animate(),
                    _.onAnimationComplete.addListener((function() {
                        e.key === An.EXP && De.services.navigation.hudLayer.hudContainer.getUIelement(Ns.RankBarUI).AnimateRankBar(),
                        De.services.inventory.getInventoryItem(e.key).updateVisuals()
                    }
                    ), this)
                }
                ,
                t
            }(Se);
            !function(e) {
                e.ACTIVE = "ACTIVE",
                e.PAUSED = "PAUSED",
                e.FINISHED = "FINISHED",
                e.CANCELED = "CANCELED"
            }(kS || (kS = {}));
            var VS, HS, jS, KS, WS, zS, YS, JS, XS, qS, QS, ZS, $S, eO, tO = function() {
                function e(e, t, i, n, o) {
                    var a, s = this;
                    this.onTimerFinished = new r.Event,
                    this.onTimerPaused = new r.Event,
                    this.onTimerResumed = new r.Event,
                    this.onTimerDeleted = new r.Event,
                    this.onTimerFastForwarded = new r.Event,
                    this.onUpdate = new r.Event,
                    this._label = "",
                    this._state = kS.ACTIVE,
                    this._logger = Ie.Of("Timer", ((a = {})[Ae.INFO] = ["color:#177222"],
                    a)),
                    this._onFinish = function() {
                        s._switchState(kS.FINISHED) && s.onTimerFinished.fire(s)
                    }
                    ,
                    this._clock = e,
                    this._id = t,
                    this._startTime = n,
                    this._duration = i,
                    this._remaining = Math.max(i - (this._clock.currentTime - this._startTime), 0),
                    fe(o) && (this._label = o),
                    this._logger.info("CREATED ".concat(this._label ? "'" + this._label + "' " : "", "id: ").concat(t, ", duration: ").concat(i))
                }
                return e.prototype.update = function() {
                    this._state === kS.ACTIVE && (this._remaining = Math.max(this._duration - (this._clock.currentTime - this._startTime), 0),
                    0 !== this._remaining ? this.onUpdate.fire(this) : this._onFinish())
                }
                ,
                e.prototype.fastForward = function(e) {
                    this._duration -= this._remaining - e,
                    this._remaining = Math.max(this._duration - (this._clock.currentTime - this._startTime), 0),
                    this.onTimerFastForwarded.fire(this)
                }
                ,
                e.prototype.pause = function() {
                    return !!this._switchState(kS.PAUSED) && (this.onTimerPaused.fire(this),
                    !0)
                }
                ,
                e.prototype.resume = function() {
                    return !!this._switchState(kS.ACTIVE) && (this._startTime = this._clock.currentTime - (this._duration - this._remaining),
                    this.onTimerResumed.fire(this),
                    !0)
                }
                ,
                e.prototype.cancel = function() {
                    return !!this._switchState(kS.CANCELED) && (this.onTimerDeleted.fire(this),
                    !0)
                }
                ,
                e.prototype.forceComplete = function() {
                    return this._onFinish(),
                    !0
                }
                ,
                Object.defineProperty(e.prototype, "id", {
                    get: function() {
                        return this._id
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "label", {
                    get: function() {
                        return this._label
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "remainingTime", {
                    get: function() {
                        return this._remaining
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "completionPercent", {
                    get: function() {
                        var e = 1 - this._remaining / this._duration;
                        return Math.min(Number(e.toFixed(2)), 100)
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "isActive", {
                    get: function() {
                        return this._state === kS.ACTIVE
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "isPaused", {
                    get: function() {
                        return this._state === kS.PAUSED
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "isCanceled", {
                    get: function() {
                        return this._state === kS.CANCELED
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "isFinished", {
                    get: function() {
                        return this._state === kS.FINISHED
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.serialize = function() {
                    return {
                        id: this.id,
                        started: this._startTime,
                        state: this._state,
                        label: this._label,
                        duration: this._duration
                    }
                }
                ,
                e.prototype._switchState = function(e) {
                    var t = "".concat(this._state, "->").concat(e);
                    switch (t) {
                    case "ACTIVE->PAUSED":
                    case "PAUSED->ACTIVE":
                    case "ACTIVE->CANCELED":
                    case "PAUSED->CANCELED":
                    case "ACTIVE->FINISHED":
                    case "PAUSED->FINISHED":
                        this._state = e;
                        break;
                    default:
                        return this._logger.error("Transition ".concat(t, " for timer ").concat(this._label ? "'" + this._label + "' " : "", "id: ").concat(this.id, " is forbidden because it has no sense.")),
                        !1
                    }
                    return this._logger.info("".concat(e, " ").concat(this._label ? "'" + this._label + "' " : "", "id: ").concat(this.id, ", remaining: ").concat(this.remainingTime)),
                    !0
                }
                ,
                e
            }(), iO = Rp({
                2: function(e) {
                    var t = Date.now();
                    return {
                        timers: e.timers.map((function(e) {
                            return {
                                id: e.id,
                                started: e.started,
                                duration: Math.max(e.remaining - (t - e.started), 0),
                                state: e.state,
                                label: e.label
                            }
                        }
                        )),
                        nextTimerId: e.nextTimerId
                    }
                }
            }), nO = function(e) {
                function t(t) {
                    var i = e.call(this) || this;
                    return i.onTimerFinished = new r.Event,
                    i.onTimerPaused = new r.Event,
                    i.onTimerResumed = new r.Event,
                    i.onTimerDeleted = new r.Event,
                    i._version = 2,
                    i._name = "TimerModel",
                    i._timers = new Map,
                    i._nextTimeId = 1,
                    i._clock = t,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.addTimer = function(e, t, i) {
                    var n = null != i ? i : this._nextTimeId
                      , r = this._createTimer(e, n, t);
                    return this._nextTimeId += 1,
                    this.saveData(),
                    r
                }
                ,
                t.prototype.getTimerByID = function(e) {
                    return this._timers.get(e) || null
                }
                ,
                t.prototype.getAllTimers = function() {
                    return Array.from(this._timers).map((function(e) {
                        return e[0],
                        e[1]
                    }
                    ))
                }
                ,
                t.prototype.updateTimers = function() {
                    this._timers.forEach((function(e) {
                        return e.update()
                    }
                    ))
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    var t = this;
                    this._nextTimeId = e.nextTimerId,
                    e.timers.forEach((function(e) {
                        var i = t._createTimer(e.duration, e.id, e.label, e.started);
                        e.state === kS.PAUSED && i.pause()
                    }
                    ))
                }
                ,
                t.prototype.onDataSave = function() {
                    var e = {
                        nextTimerId: this._nextTimeId,
                        timers: []
                    };
                    return this._timers.forEach((function(t) {
                        return e.timers.push(t.serialize())
                    }
                    )),
                    e
                }
                ,
                t.prototype.migrateData = function(e) {
                    return iO(e, this._version)
                }
                ,
                t.prototype._onTimerFinishedHandler = function(e) {
                    this._timers.delete(e.id),
                    this.onTimerFinished.fire(e),
                    this.saveData()
                }
                ,
                t.prototype._onTimerPausedHandler = function(e) {
                    this.onTimerPaused.fire(e),
                    this.saveData()
                }
                ,
                t.prototype._onTimerResumedHandler = function(e) {
                    this.onTimerResumed.fire(e),
                    this.saveData()
                }
                ,
                t.prototype._onTimerDeletedHandler = function(e) {
                    this._timers.delete(e.id),
                    this.onTimerDeleted.fire(e),
                    this.saveData()
                }
                ,
                t.prototype._createTimer = function(e, t, i, n) {
                    var r = new tO(this._clock,t,e,n || this._clock.currentTime,i);
                    return this._timers.set(t, r),
                    r.onTimerFinished.addListener(this._onTimerFinishedHandler, this),
                    r.onTimerPaused.addListener(this._onTimerPausedHandler, this),
                    r.onTimerResumed.addListener(this._onTimerResumedHandler, this),
                    r.onTimerDeleted.addListener(this._onTimerDeletedHandler, this),
                    r.onTimerFastForwarded.addListener(this.saveData, this),
                    r
                }
                ,
                t
            }($n), rO = "https://".concat("1187013846746005515.discordsays.com/nakama", "/api/time"), oO = function() {
                function e() {
                    this._timeDifference = 0
                }
                return Object.defineProperty(e.prototype, "currentTime", {
                    get: function() {
                        return Date.now() + this._timeDifference
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.sync = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r, o;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e = Date.now(),
                                [4, fetch(rO, {
                                    headers: {
                                        "Content-Type": "application/json"
                                    }
                                })];
                            case 1:
                                return t = n.sent(),
                                i = Date.now() - e,
                                [4, t.json()];
                            case 2:
                                return r = n.sent().serverTime,
                                o = r - e + Math.floor(i / 2),
                                this._timeDifference = o,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), aO = function() {
                function e() {}
                return Object.defineProperty(e.prototype, "currentTime", {
                    get: function() {
                        return Date.now()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.sync = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), sO = function() {
                function e(e) {
                    this._backendSDK = e
                }
                return Object.defineProperty(e.prototype, "currentTime", {
                    get: function() {
                        return this._backendSDK.time.getServerTime()
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.sync = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), _O = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n.tick = new r.Event,
                    n.onTimerFinished = new r.Event,
                    n.onTimerPaused = new r.Event,
                    n.onTimerResumed = new r.Event,
                    n.onTimerDeleted = new r.Event,
                    n._elapsedMS = 0,
                    n.UPDATE_INTERVAL = 500,
                    n._clock = new aO,
                    n._serverClock = ze.USE_NAKAMA ? new sO(i) : new oO,
                    n._updatableGroup = t,
                    n._timerModel = new nO(n._clock),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._intializationPromise || (this._timerModel.onTimerFinished.addListener(this._onTimerFinishedHandler, this),
                            this._timerModel.onTimerPaused.addListener(this._onTimerPausedHandler, this),
                            this._timerModel.onTimerResumed.addListener(this._onTimerResumedHandler, this),
                            this._timerModel.onTimerDeleted.addListener(this._onTimerDeletedHandler, this),
                            this._updatableGroup.add(this),
                            this._intializationPromise = this.services.autosave.registerModel(this._timerModel)),
                            [2, this._intializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.services.autosave.unregisterModel(this._timerModel),
                            this._updatableGroup.remove(this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.addTimer = function(e, t) {
                    return this._timerModel.addTimer(e, t)
                }
                ,
                t.prototype.getTimerByID = function(e) {
                    var t = this._timerModel.getTimerByID(e);
                    return t || (t = this._timerModel.addTimer(0, void 0, e)),
                    t
                }
                ,
                t.prototype.getAllTimers = function() {
                    return this._timerModel.getAllTimers()
                }
                ,
                t.prototype.update = function(e, t) {
                    this._elapsedMS += t,
                    this._elapsedMS < this.UPDATE_INTERVAL || (this.tick.fire(t),
                    this._elapsedMS = 0,
                    this._timerModel.updateTimers())
                }
                ,
                Object.defineProperty(t.prototype, "currentTime", {
                    get: function() {
                        return this._clock.currentTime
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "currentServerTime", {
                    get: function() {
                        var e = this;
                        return this._serverClock.sync().then((function() {
                            return e._serverClock.currentTime
                        }
                        ))
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype._onTimerFinishedHandler = function(e) {
                    this.onTimerFinished.fire(e)
                }
                ,
                t.prototype._onTimerPausedHandler = function(e) {
                    this.onTimerPaused.fire(e)
                }
                ,
                t.prototype._onTimerResumedHandler = function(e) {
                    this.onTimerResumed.fire(e)
                }
                ,
                t.prototype._onTimerDeletedHandler = function(e) {
                    this.onTimerDeleted.fire(e)
                }
                ,
                t
            }(Se), cO = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t.onGoingToFriend = new r.Event,
                    t.arrivedAtFriendFarm = new r.Event,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, De.services.assetLoader.loadJsons(_e.TRANSITION_SCREEN_ADS_CONFIG)];
                            case 1:
                                return e.sent(),
                                this._interstitialConfig = De.services.resource.getJson(_e.TRANSITION_SCREEN_ADS_CONFIG),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.goToFriendsFarm = function(e) {
                    var t = this;
                    this.onGoingToFriend.fire(),
                    this._onDepartureSounds();
                    var i = r.TimeDelay.after(1e3 * this._interstitialConfig.TRANSITION_TIME)
                      , n = this.services.friends.fetchOwnProfile();
                    this.services.navigation.setChosenFriendDestination(e),
                    this.services.playerData.setFriendDataContainer(this.services.playerData.createDataContainerForFriend(e)),
                    this.services.playerData.friendDataContainer.preloadPlayerData(),
                    this.services.friends.visitFriendFarm(e),
                    this.services.navigation.showTransitionScreen(i, n, e, Og.FRIEND_FARM).then((function() {
                        return t.services.navigation.destroyCurrentMap()
                    }
                    )),
                    i.promise.then((function() {
                        t._onArriveSounds(),
                        t.services.navigation.showFriendsMap(),
                        t.arrivedAtFriendFarm.fire()
                    }
                    ))
                }
                ,
                t.prototype.goToOwnFarm = function() {
                    var e, t = this, i = this.services.navigation.getChosenFriendDestination();
                    if (!ge(i)) {
                        this._onDepartureSounds();
                        var n = r.TimeDelay.after(1e3 * this._interstitialConfig.TRANSITION_TIME)
                          , o = this.services.friends.fetchOwnProfile();
                        this.services.friends.completeVisitFriendFarm(),
                        null === (e = vp.platform.customUpdate) || void 0 === e || e.sendPostVisit(i, a.GameUpdateStrategy.IMMEDIATE),
                        this.services.navigation.showTransitionScreen(n, o, i, Og.OWN_FARM).then((function() {
                            return t.services.navigation.destroyCurrentMap()
                        }
                        )),
                        n.promise.then((function() {
                            t._onArriveSounds(),
                            t.services.navigation.showGameplayMap(!0)
                        }
                        ))
                    }
                }
                ,
                t.prototype._onDepartureSounds = function() {
                    De.services.audio.playSoundEffect(m.TRAIN_MOVING_LOOP)
                }
                ,
                t.prototype._onArriveSounds = function() {
                    De.services.audio.stopSoundEffect(m.TRAIN_MOVING_LOOP),
                    De.services.audio.playSoundEffect(m.TRAIN_TRAVEL_COMPLETE)
                }
                ,
                t
            }(Se), lO = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._version = 1,
                    t._name = "UserFeedbackModel",
                    t._hasOpenedFeedbackForm = !1,
                    t._feedbackId = 0,
                    t._deviceAmountPlayedOn = 0,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "hasOpenedFeedbackForm", {
                    get: function() {
                        return this._hasOpenedFeedbackForm
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "deviceAmountPlayedOn", {
                    get: function() {
                        return this._deviceAmountPlayedOn
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.getNextId = function() {
                    return this._feedbackId += 1,
                    this.saveData(),
                    this._feedbackId
                }
                ,
                t.prototype.registerFeedbackOpen = function() {
                    this._hasOpenedFeedbackForm || (this._hasOpenedFeedbackForm = !0,
                    this.saveData())
                }
                ,
                t.prototype.checkDevicePlayedOn = function() {
                    var e = l("PLAYED_ON_DEVICE");
                    (0,
                    r.isNull)(e) && (u("PLAYED_ON_DEVICE", e = "yes"),
                    this._deviceAmountPlayedOn += 1,
                    this.saveData())
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    var t, i;
                    this._hasOpenedFeedbackForm = e.hasOpenedFeedbackForm,
                    this._feedbackId = null !== (t = e.feedbackId) && void 0 !== t ? t : 0,
                    this._deviceAmountPlayedOn = null !== (i = e.deviceAmountPlayedOn) && void 0 !== i ? i : 0
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        hasOpenedFeedbackForm: this._hasOpenedFeedbackForm,
                        feedbackId: this._feedbackId,
                        deviceAmountPlayedOn: this._deviceAmountPlayedOn
                    }
                }
                ,
                t
            }($n), uO = function(e) {
                function t(t, i) {
                    var n = e.call(this) || this;
                    return n._categoryOptionTexts = {
                        unselected: ce.FEEDBACK_CATEGORY_UNSELECTED,
                        purchases: ce.FEEDBACK_CATEGORY_PURCHASES,
                        "losing progress": ce.FEEDBACK_CATEGORY_LOSING_PROGRESS,
                        "disappearing items": ce.FEEDBACK_CATEGORY_DISAPPEARING_ITEMS,
                        "visiting friends": ce.FEEDBACK_CATEGORY_VISITING_FRIENDS,
                        "removing heavy objects": ce.FEEDBACK_CATEGORY_REMOVING_HEAVY_OBJECTS,
                        "keys & chests": ce.FEEDBACK_CATEGORY_KEYS_CHESTS,
                        "extra workers": ce.FEEDBACK_CATEGORY_EXTRA_WORKERS,
                        "game loading": ce.FEEDBACK_CATEGORY_GAME_LOADING,
                        "something else": ce.FEEDBACK_CATEGORY_SOMETHING_ELSE
                    },
                    n._buttonCancelCallback = n._onButtonCancel.bind(n),
                    n._buttonSubmitCallback = n._onButtonSubmit.bind(n),
                    n._formChangeCallback = n._onFormChange.bind(n),
                    n._nakamaId = t,
                    n._backendSDK = i,
                    n._userFeedbackModel = new lO,
                    n._modalConfirmation = document.querySelector("#confirmation-modal"),
                    n._buttonConfirmationDialog = document.querySelector("#button-confirmation"),
                    n._confirmationReason = document.querySelector("#confirmation-reason"),
                    n._confirmationHeader = document.querySelector("#confirmation-header"),
                    n._buttonClose = document.querySelector("#button-close"),
                    n._feedbackHeader = document.querySelector("#feedback-title"),
                    n._feedbackLabel = document.querySelector("#feedback-label"),
                    n._modalFeedback = document.querySelector("#feedback-modal"),
                    n._buttonCancel = document.querySelector("#button-cancel"),
                    n._buttonSubmit = document.querySelector("#button-submit"),
                    n._feedbackTextArea = document.querySelector("#feedback-text"),
                    n._categoryHeader = document.querySelector("#category-header"),
                    n._categorySelect = document.querySelector("#category-select"),
                    n._modalFeedback.addEventListener("wheel", (function(e) {
                        e.stopPropagation()
                    }
                    ), {
                        passive: !1
                    }),
                    n._toggleButton(n._buttonSubmit, !1),
                    n
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._userFeedbackModel.initialize(),
                                [4, De.services.autosave.registerModel(this._userFeedbackModel)];
                            case 1:
                                return e.sent(),
                                this._userFeedbackModel.checkDevicePlayedOn(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hasSeenFeedbackForm = function() {
                    return this._userFeedbackModel.hasOpenedFeedbackForm
                }
                ,
                t.prototype.openFeedbackDialog = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return vp.platform.loginStrategy.isUserLoggedIn() ? [3, 2] : [4, De.services.signInBonus.openSignInBonusPopup("automatic")];
                            case 1:
                                return e.sent() || vp.platform.loginStrategy.attemptLogin().then((function(e) {
                                    e === be.SUCCESS && IO()
                                }
                                )),
                                [2];
                            case 2:
                                return De.services.analytics.design.feedbackFormTriggeredStatus(un.OPENED),
                                this._userFeedbackModel.registerFeedbackOpen(),
                                this._buttonCancel.addEventListener("click", this._buttonCancelCallback),
                                this._buttonClose.addEventListener("click", this._buttonCancelCallback),
                                this._buttonSubmit.addEventListener("click", this._buttonSubmitCallback),
                                this._feedbackTextArea.addEventListener("keyup", this._formChangeCallback),
                                this._categorySelect.addEventListener("change", this._formChangeCallback),
                                this._toggleButton(this._buttonSubmit, !1),
                                this._toggleButton(this._buttonCancel, !0),
                                [2, this._toggleModal(this._modalFeedback, !0)]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.closeFeedbackDialog = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._buttonClose.removeEventListener("click", this._buttonCancelCallback),
                                this._buttonCancel.removeEventListener("click", this._buttonCancelCallback),
                                this._buttonSubmit.removeEventListener("click", this._buttonSubmitCallback),
                                this._feedbackTextArea.removeEventListener("keyup", this._formChangeCallback),
                                this._categorySelect.removeEventListener("change", this._formChangeCallback),
                                this._buttonConfirmationDialog.onclick = null,
                                [4, this._toggleModal(this._modalFeedback, !1)];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.localization.onLanguageChanged.addListener(this._updateTexts, this),
                            this.addCategoryOptions(),
                            this._updateTexts(),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return De.services.localization.onLanguageChanged.removeListener(this._updateTexts, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._updateTexts = function() {
                    var e = this;
                    this._feedbackHeader.textContent = nr(VS || (VS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FEEDBACK_HEADER_TEXT),
                    this._feedbackLabel.textContent = nr(HS || (HS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FEEDBACK_LABEL),
                    this._categoryHeader.textContent = nr(jS || (jS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FEEDBACK_CATEGORY_PROBLEM_WITH),
                    Object.keys(this._categoryOptionTexts).forEach((function(t, i) {
                        e._categorySelect.options.item(i).textContent = nr(KS || (KS = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), e._categoryOptionTexts[t])
                    }
                    )),
                    this._feedbackTextArea.placeholder = nr(WS || (WS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FEEDBACK_BOX_PLACEHOLDER),
                    this._buttonCancel.textContent = nr(zS || (zS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.CANCEL),
                    this._buttonSubmit.textContent = nr(YS || (YS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FEEDBACK_SUBMIT)
                }
                ,
                t.prototype._resetForm = function() {
                    this._categorySelect.selectedIndex = 0,
                    this._feedbackTextArea.value = "",
                    this._resetButton(this._buttonCancel),
                    this._resetButton(this._buttonSubmit)
                }
                ,
                t.prototype._onButtonCancel = function(e) {
                    this.closeFeedbackDialog()
                }
                ,
                t.prototype._onButtonSubmit = function(e) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return this._categorySelect.selectedIndex > 0 ? (this._buttonSubmit.setAttribute("aria-busy", "true"),
                                this._toggleButton(this._buttonSubmit, !1),
                                this._toggleButton(this._buttonCancel, !1),
                                e = {
                                    v: "1.46.0-1"
                                },
                                r = {
                                    category: this._categorySelect.options[this._categorySelect.selectedIndex].value,
                                    feedback: this._feedbackTextArea.value.slice(0, 300),
                                    screenshot: De.services.canvas.renderer.plugins.extract.base64(null, "image/jpeg", .3),
                                    game_version: "1.46.0-1",
                                    ping: De.services.connection.ping.toString(),
                                    session_duration: ((Date.now() - De.services.analytics.startTime) / 1e3 / 60).toString()
                                },
                                [4, vp.platform.deviceStrategy.getDevice()]) : [3, 7];
                            case 1:
                                return r.device = n.sent(),
                                r.no_connection_overlay_show_amount = De.services.analytics.noConnectionOverlayShowAmount.toString(),
                                r.userAgent = navigator.userAgent,
                                r.deviceAmountPlayedOn = this._userFeedbackModel.deviceAmountPlayedOn.toString(),
                                [4, fp(e)];
                            case 2:
                                r.image_quality = n.sent().qualitySetting.alias,
                                t = r,
                                n.label = 3;
                            case 3:
                                return n.trys.push([3, 6, , 7]),
                                i = this._userFeedbackModel.getNextId(),
                                [4, this._backendSDK.userFeedback.save(i.toString(), t)];
                            case 4:
                                return n.sent(),
                                [4, this._toggleModal(this._modalFeedback, !1)];
                            case 5:
                                return n.sent(),
                                this._showSuccessDialog(),
                                [3, 7];
                            case 6:
                                return n.sent(),
                                this._showFailureDialog(),
                                [3, 7];
                            case 7:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.addCategoryOptions = function() {
                    var e = this;
                    Object.keys(this._categoryOptionTexts).forEach((function(t) {
                        var i = document.createElement("option");
                        i.value = t,
                        i.textContent = nr(JS || (JS = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), e._categoryOptionTexts[t]),
                        e._categorySelect.add(i)
                    }
                    ))
                }
                ,
                t.prototype._onFormChange = function(e) {
                    this._toggleButton(this._buttonSubmit, this._validateFields())
                }
                ,
                t.prototype._validateFields = function() {
                    return this._categorySelect.selectedIndex > 0 && this._feedbackTextArea.value.trim().length > 0
                }
                ,
                t.prototype._toggleButton = function(e, t) {
                    t && De.services.analytics.design.feedbackFormTriggeredStatus(un.AVAILABLE),
                    e.removeAttribute("enabled"),
                    e.removeAttribute("disabled");
                    var i = t ? "enabled" : "disabled";
                    e.setAttribute(i, "")
                }
                ,
                t.prototype._resetButton = function(e) {
                    e.removeAttribute("enabled"),
                    e.removeAttribute("disabled"),
                    this._buttonSubmit.removeAttribute("aria-busy")
                }
                ,
                t.prototype._showSuccessDialog = function() {
                    var e = this;
                    De.services.analytics.design.feedbackFormTriggeredStatus(un.SUBMISSIONCOMPLETE),
                    this._confirmationReason.textContent = nr(XS || (XS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FEEDBACK_SUCCES_TEXT),
                    this._confirmationHeader.textContent = nr(qS || (qS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FEEDBACK_SUCCES_HEADER),
                    this._toggleModal(this._modalConfirmation, !0),
                    this._buttonConfirmationDialog.onclick = function() {
                        return (0,
                        n.__awaiter)(e, void 0, void 0, (function() {
                            return (0,
                            n.__generator)(this, (function(e) {
                                switch (e.label) {
                                case 0:
                                    return [4, this._toggleModal(this._modalConfirmation, !1)];
                                case 1:
                                    return e.sent(),
                                    this._resetForm(),
                                    [2]
                                }
                            }
                            ))
                        }
                        ))
                    }
                }
                ,
                t.prototype._showFailureDialog = function() {
                    var e = this;
                    De.services.analytics.design.feedbackFormTriggeredStatus(un.SUBMISSIONFAILED, "emptyTextBox"),
                    this._confirmationReason.textContent = nr(QS || (QS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FEEDBACK_FAILED_TEXT),
                    this._confirmationHeader.textContent = nr(ZS || (ZS = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.FEEDBACK_FAILED_HEADER),
                    this._toggleModal(this._modalConfirmation, !0),
                    this._buttonConfirmationDialog.onclick = function() {
                        return (0,
                        n.__awaiter)(e, void 0, void 0, (function() {
                            return (0,
                            n.__generator)(this, (function(e) {
                                switch (e.label) {
                                case 0:
                                    return [4, this._toggleModal(this._modalConfirmation, !1)];
                                case 1:
                                    return e.sent(),
                                    [4, this._toggleModal(this._modalFeedback, !0)];
                                case 2:
                                    return e.sent(),
                                    this._toggleButton(this._buttonSubmit, this._validateFields()),
                                    this._resetButton(this._buttonCancel),
                                    [2]
                                }
                            }
                            ))
                        }
                        ))
                    }
                }
                ,
                t.prototype._toggleModal = function(e, t) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(i) {
                            return [2, new Promise((function(i) {
                                t ? (e.setAttribute("open", ""),
                                document.documentElement.classList.add("modal-is-open", "modal-is-opening"),
                                setTimeout((function() {
                                    document.documentElement.classList.remove("modal-is-opening"),
                                    i()
                                }
                                ), 400)) : (document.documentElement.classList.add("modal-is-closing"),
                                setTimeout((function() {
                                    e.removeAttribute("open"),
                                    document.documentElement.classList.remove("modal-is-closing", "modal-is-open"),
                                    i()
                                }
                                ), 400))
                            }
                            ))]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(Se), dO = "travel_summary_double_reward_button", hO = function(e) {
                function t(t) {
                    var i = e.call(this, t) || this;
                    return i.priority = _r.NORMAL,
                    i._name = "TravelSummaryRewardPopup",
                    i._combinedRewards = new Map,
                    i._closing = !1,
                    i._doubleRewardsReceived = !1,
                    i._itemPositions = new Map,
                    i
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onAddedToLayer = function() {}
                ,
                t.prototype.show = function(e) {
                    this._combineRewards();
                    var t = new Xe.Container
                      , i = this._createDestinationInfo();
                    i.y = t.height,
                    t.addChild(i);
                    var n = this._createReward();
                    n.y = t.height + 20,
                    t.addChild(n),
                    De.services.adsService.isRewardedAdsSupported() ? this._addDoubleRewardButton(t) : this._addBottomCloseButton(t);
                    var r = this._createBg(t.height + 40);
                    r.addChild(t),
                    t.position.set(0, 70 - t.height / 2),
                    this._content.addChild(r),
                    e()
                }
                ,
                t.prototype.close = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(t) {
                            switch (t.label) {
                            case 0:
                                return e.prototype.close.call(this),
                                [4, this._onClose()];
                            case 1:
                                return t.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.hide = function(e) {
                    e()
                }
                ,
                t.prototype.onDestroy = function() {}
                ,
                t.prototype._createBg = function(e) {
                    var t = new Ar({
                        size: {
                            width: 920,
                            height: e + 140
                        },
                        headerSize: {
                            width: 920 / 1.5,
                            height: 120
                        },
                        headerText: ce.VISIT_FRIENDS_SUMMARY_HEADER,
                        headerStyle: vn.popupTitle
                    });
                    return t.position.set(0, -25),
                    t.onCloseClick(this.close.bind(this)),
                    t
                }
                ,
                t.prototype._createDestinationInfo = function() {
                    var e = new Xe.Container
                      , t = new v.LabelSettings({
                        fitToBox: !0,
                        fitHeight: 150,
                        fitWidth: 800
                    });
                    t.style = vn.popupHeader;
                    var i = new v.Label(nr($S || ($S = (0,
                    n.__makeTemplateObject)(["", ""], ["", ""])), ce.VISIT_FRIENDS_SUMMARY_DESTINATION),t);
                    i.anchor.set(.5),
                    i.position.set(0, 10),
                    e.addChild(i);
                    var r = rr(this._options.player.getPhoto(), {
                        anchor: {
                            x: .5,
                            y: .5
                        },
                        position: {
                            x: 0,
                            y: 195
                        }
                    });
                    if (e.addChild(r),
                    this._options.isBonus) {
                        var o = rr(De.services.resource.getSprite(f.OVERLAY_BONUS_FRIEND), {
                            anchor: {
                                x: .5,
                                y: .5
                            },
                            position: {
                                x: 115,
                                y: 270
                            }
                        });
                        e.addChild(o);
                        var a = new v.LabelSettings({
                            fitToBox: !0,
                            fitWidth: 800
                        });
                        a.style = vn.lightExtraSmall;
                        var s = new v.Label(nr(eO || (eO = (0,
                        n.__makeTemplateObject)(["", ""], ["", ""])), ce.VISIT_FRIENDS_SUMMARY_X2),a);
                        s.anchor.set(.5),
                        o.addChild(s)
                    }
                    var _ = new v.LabelSettings({
                        fitToBox: !0,
                        fitWidth: 800
                    });
                    _.style = vn.darkMedium;
                    var c = new v.Label(this._options.player.name,_);
                    return c.anchor.set(.5),
                    c.y = 375,
                    e.addChild(c),
                    e
                }
                ,
                t.prototype._createReward = function() {
                    var e = this
                      , t = new Xe.Container
                      , i = 0
                      , n = 0;
                    return this._combinedRewards.forEach((function(r, o) {
                        var a = {
                            key: o,
                            amount: r
                        }
                          , s = t.addChild(new cp(a));
                        if (n % 3 == 0) {
                            var _ = (Math.min(e._combinedRewards.size - n, 3) - 1) / 2;
                            i = -(_ * s.width + 15 * _)
                        }
                        var c = new Xe.Point(i + n % 3 * (s.width + 15),Math.floor(n / 3) * (s.height + 15));
                        s.position.set(c.x, c.y),
                        s.pivot.set(s.width / 2, 0),
                        e._itemPositions.set(o, c),
                        n++
                    }
                    )),
                    t.position.set(3.75, 70),
                    t
                }
                ,
                t.prototype._combineRewards = function() {
                    var e = this;
                    this._options.reward.forEach((function(t) {
                        var i, n = null !== (i = e._combinedRewards.get(t.key)) && void 0 !== i ? i : 0;
                        e._combinedRewards.set(t.key, n + t.amount)
                    }
                    ))
                }
                ,
                t.prototype._createDoubleRewardButton = function(e) {
                    var t = e.size
                      , i = new Xe.Container
                      , n = new uc({
                        name: "doubleReward",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: t.width,
                            height: t.height
                        }
                    },{
                        text: ce.VISIT_FRIENDS_SUMMARY_DOUBLE_REWARDS_BUTTON,
                        textStyle: vn.buttonLabel,
                        position: {
                            x: 50,
                            y: -5
                        },
                        alignment: "center",
                        fitBoxSizes: {
                            height: 125,
                            width: 445
                        }
                    },{
                        iconImage: f.ICON_BTN_VIDEO_WHITE,
                        iconPosition: {
                            x: -t.width / 2 + 50,
                            y: 0
                        },
                        iconAlignment: "left"
                    });
                    return n.onClick(this._doubleRewardClicked.bind(this)),
                    n.y = 0,
                    i.addChild(n),
                    i
                }
                ,
                t.prototype._createBottomCloseButton = function(e) {
                    var t = e.size
                      , i = new Xe.Container
                      , n = new fr({
                        name: "closeButton",
                        buttonIdle: f.BTN_DEFAULT_GREEN_IDLE,
                        buttonActive: f.BTN_DEFAULT_GREEN_ACTIVE
                    },{
                        buttonSizes: {
                            width: t.width,
                            height: t.height
                        }
                    },{
                        text: ce.CLOSE,
                        textStyle: vn.buttonLabel,
                        alignment: "center",
                        fitBoxSizes: {
                            height: 125,
                            width: 445
                        }
                    });
                    return n.onClick(this.close.bind(this)),
                    n.y = 0,
                    i.addChild(n),
                    i
                }
                ,
                t.prototype._doubleRewardClicked = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, this._showRewardedVideo()];
                            case 1:
                                return e.sent(),
                                this.close(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._addDoubleRewards = function() {
                    this._combinedRewards.forEach((function(e, t) {
                        De.services.inventory.addAmount(t, e)
                    }
                    ))
                }
                ,
                t.prototype._showRewardedVideo = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, new Uh({
                                    adsService: De.services.adsService
                                },dO).execute()];
                            case 1:
                                return e.sent().result !== $_.SUCCESS || (this._doubleRewardsReceived = !0),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._onClose = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return this._closing ? [2] : (this._closing = !0,
                                this._animateRewards(),
                                [4, r.TimeDelay.after(900).promise]);
                            case 1:
                                return e.sent(),
                                this._options.closeCallback && this._options.closeCallback(),
                                [4, r.TimeDelay.after(100).promise];
                            case 2:
                                return e.sent(),
                                this._doubleRewardsReceived && this._addDoubleRewards(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._animateRewards = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e = this;
                        return (0,
                        n.__generator)(this, (function(t) {
                            return this._combinedRewards.forEach((function(t, i) {
                                return (0,
                                n.__awaiter)(e, void 0, void 0, (function() {
                                    var e, r, o, a, s, _, c;
                                    return (0,
                                    n.__generator)(this, (function(n) {
                                        return e = this._itemPositions.get(i),
                                        r = De.services.navigation.layers.popup.container,
                                        o = r.toGlobal(e || new Xe.Point(0,0)),
                                        a = De.services.navigation.hudLayer.hudContainer.getRewardIconAndCounter({
                                            amount: t,
                                            key: i
                                        }),
                                        s = a.target,
                                        _ = a.icon,
                                        c = s.toGlobal(new Xe.Point(0,0)),
                                        new Lr(De.services.resource.getSprite(_),r.toLocal(o),r.toLocal(c),t,r).animate(),
                                        [2]
                                    }
                                    ))
                                }
                                ))
                            }
                            )),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._addDoubleRewardButton = function(e) {
                    var t = this._createDoubleRewardButton({
                        size: {
                            width: 600,
                            height: 150
                        }
                    });
                    t.y = e.height + 100,
                    e.addChild(t),
                    De.services.analytics.design.rvAppear(dO)
                }
                ,
                t.prototype._addBottomCloseButton = function(e) {
                    var t = this._createBottomCloseButton({
                        size: {
                            width: 600,
                            height: 150
                        }
                    });
                    t.y = e.height + 100,
                    e.addChild(t)
                }
                ,
                t
            }(yr), pO = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._version = 1,
                    t._name = "VisitorRewardModel",
                    t._rewards = [],
                    t._player = null,
                    t
                }
                return (0,
                n.__extends)(t, e),
                Object.defineProperty(t.prototype, "rewards", {
                    get: function() {
                        return this._rewards
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "player", {
                    get: function() {
                        return this._player
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "dataContainer", {
                    get: function() {
                        return De.services.playerData.playerDataContainer
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.addReward = function(e, t) {
                    this._player = e,
                    this._rewards.push(t),
                    this.saveData()
                }
                ,
                t.prototype.clearReward = function() {
                    this._rewards.length = 0,
                    this._rewards = [],
                    this._player = null,
                    this.saveData()
                }
                ,
                t.prototype.onInitialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.onDataReceive = function(e) {
                    this._rewards = e.reward,
                    this._player = e.player
                }
                ,
                t.prototype.onDataSave = function() {
                    return {
                        reward: this._rewards,
                        player: this._player
                    }
                }
                ,
                t
            }($n), vO = function(e) {
                function t() {
                    var t = e.call(this) || this;
                    return t._model = new pO,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.getRewardByType = function(e) {
                    return this._actionsMapConfig.ACTIVITIES_LIST.find((function(t) {
                        return t.activityType === e
                    }
                    ))
                }
                ,
                Object.defineProperty(t.prototype, "maxActivities", {
                    get: function() {
                        return this._actionsMapConfig.MAX_ACTIVITIES
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(t.prototype, "activitiesListConfig", {
                    get: function() {
                        return this._actionsMapConfig.ACTIVITIES_LIST
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                t.prototype.getRewardAsset = function(e) {
                    var t;
                    return (t = {},
                    t[ju.HeavyObject] = f.ICON_BALLOON_HEAVYOBJ,
                    t[ju.Crop] = f.ICON_BALLOON_WATERCROPS,
                    t[ju.Animal] = f.ICON_BALLOON_PETANIMALS,
                    t[ju.Building] = f.ICON_BALLOON_BOOSTBUILDING,
                    t[ju.Nature] = f.ICON_BALLOON_HUGTREE,
                    t[ju.Truck] = f.ICON_BALLOON_UNLOADDELIVERY,
                    t)[e]
                }
                ,
                t.prototype.hasRewards = function() {
                    return Boolean(this._model.rewards.length && this._model.player)
                }
                ,
                t.prototype.showNewRewards = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t;
                        return (0,
                        n.__generator)(this, (function(i) {
                            switch (i.label) {
                            case 0:
                                return this.hasRewards() ? [4, De.services.friends.fetchProfile({
                                    platformuserid: this._model.player
                                })] : [3, 2];
                            case 1:
                                (e = i.sent()) ? (t = !De.services.friends.hasVisitedToday(e),
                                this._openRewardPopup(e, this._model.rewards, t)) : this._logger.error("Cannot find myself in a player's model which is very wrong!"),
                                i.label = 2;
                            case 2:
                                return [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.addReward = function(e) {
                    var t = this.services.friends.visitingFriend;
                    t && (0 === this._model.rewards.length && this._onFirstReward(t),
                    this._model.addReward(t.platformId, e))
                }
                ,
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this._initializationPromise || (this._initializationPromise = this._initialize()),
                            [2, this._initializationPromise]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._initialize = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, Promise.all([this.services.autosave.registerModel(this._model)])];
                            case 1:
                                return e.sent(),
                                [4, Promise.all([this.services.assetLoader.loadJsons(_e.VISIT_FARM_ACTIVITIES_AND_REWARDS)])];
                            case 2:
                                return e.sent(),
                                this._actionsMapConfig = this.services.resource.getJson(_e.VISIT_FARM_ACTIVITIES_AND_REWARDS),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._openRewardPopup = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r, o = this;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return r = {
                                    player: e,
                                    reward: t,
                                    isBonus: i,
                                    closeCallback: function() {
                                        return o._addRewardsToModel()
                                    }
                                },
                                [4, De.services.lazyLoad.prioritizeGroup(hn.LEVEL_UP).then((function() {
                                    o.services.navigation.showPopup(hO, r)
                                }
                                ))];
                            case 1:
                                return n.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype._addRewardsToModel = function() {
                    var e = this;
                    this._model.rewards.forEach((function(t) {
                        e.services.inventory.addAmount(t.key, t.amount)
                    }
                    )),
                    this._model.clearReward()
                }
                ,
                t.prototype._onFirstReward = function(e) {
                    var t;
                    De.services.inventory.spendAmount(Cn.TICKETS, 1),
                    null === (t = vp.platform.customUpdate) || void 0 === t || t.sendPostVisit(e, a.GameUpdateStrategy.LAST)
                }
                ,
                t
            }(Se), gO = function() {
                function e(e, t, i, n, o) {
                    void 0 === o && (o = 1e3),
                    this.strategyChanged = new r.Event,
                    this._type = O_.NONE,
                    this._cost = {
                        amount: 0,
                        key: Cn.COINS
                    },
                    this.gaItemID = n,
                    this._config = t,
                    this._timer = e,
                    this._placement = null != i ? i : "",
                    this._onUpdate(e),
                    e.onUpdate.addListener(this._onUpdate, this),
                    e.onTimerFinished.addListener(this.destroy, this),
                    this._updateInterval = o,
                    this._lastUpdate = e.remainingTime
                }
                return Object.defineProperty(e.prototype, "cost", {
                    get: function() {
                        return this._cost
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "strategy", {
                    get: function() {
                        return this._strategy
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "type", {
                    get: function() {
                        return this._type
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.destroy = function() {
                    this.strategyChanged.removeAllListeners(),
                    this._timer.onTimerFinished.removeListener(this.destroy, this),
                    this._timer.onUpdate.removeListener(this._onUpdate, this)
                }
                ,
                e.prototype._onUpdate = function(e) {
                    var t, i, n;
                    if (!(this._lastUpdate - e.remainingTime < this._updateInterval && this.type !== O_.NONE)) {
                        this._lastUpdate = e.remainingTime;
                        var r = this._type
                          , o = this._config
                          , a = o.FREE
                          , s = o.RV
                          , _ = e.remainingTime / 1e3
                          , c = !!a
                          , l = !!s && De.services.adsService.isRewardedAdsSupported();
                        c && _ > 0 && _ <= a.to ? (t = this.onFreeCalculated(e, this._config),
                        this._type = t[0],
                        this._strategy = t[1],
                        this._cost = t[2]) : l && _ > (null == a ? void 0 : a.to) && _ <= s.to ? (i = this.onRVCalculated(e, this._config),
                        this._type = i[0],
                        this._strategy = i[1],
                        this._cost = i[2]) : (n = this.onPayedCalculated(e, this._config),
                        this._type = n[0],
                        this._strategy = n[1],
                        this._cost = n[2]),
                        (this._type === O_.BUY || r !== this._type) && this.strategyChanged.fire(this._type)
                    }
                }
                ,
                e
            }(), fO = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.execute = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return this.dependencies.inventory.hasEnoughItems([this.dependencies.cost]) ? (this.dependencies.inventory.deductItems([this.dependencies.cost]),
                            this.dependencies.analytics.sink.gemsForFF(this.dependencies.cost.amount, this.dependencies.analyticsItemID),
                            [2, {
                                result: $_.SUCCESS,
                                reason: "SUCCESS"
                            }]) : [2, {
                                result: $_.FAIL,
                                reason: "INSUFFICIENT_ITEMS"
                            }]
                        }
                        ))
                    }
                    ))
                }
                ,
                t
            }(rc), EO = function(e) {
                function t(t, i, n, r, o) {
                    return void 0 === o && (o = 1e3),
                    e.call(this, t, i, n, r, o) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onFreeCalculated = function() {
                    return [O_.FREE, new SC({}), {
                        amount: 0,
                        key: Cn.COINS
                    }]
                }
                ,
                t.prototype.onRVCalculated = function() {
                    return [O_.RV, new Uh({
                        adsService: De.services.adsService
                    },this._placement), {
                        amount: 0,
                        key: Cn.COINS
                    }]
                }
                ,
                t.prototype.onPayedCalculated = function(e, t) {
                    var i = t.RV
                      , r = t.FORMULA
                      , o = t.FREE
                      , a = e.remainingTime / 1e3
                      , s = {
                        amount: i && De.services.adsService.isRewardedAdsSupported() ? Math.ceil((a - i.to) / r.per) * r.amount : Math.ceil((a - o.to) / r.per) * r.amount,
                        key: r.key
                    };
                    return [O_.BUY, new fO((0,
                    n.__assign)({
                        analyticsItemID: this.gaItemID,
                        cost: (0,
                        n.__assign)({}, s)
                    }, De.services)), s]
                }
                ,
                t
            }(gO), mO = function(e) {
                function t() {
                    return null !== e && e.apply(this, arguments) || this
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.onFreeCalculated = function() {
                    return [O_.FREE, new SC({}), {
                        amount: 0,
                        key: Cn.COINS
                    }]
                }
                ,
                t.prototype.onRVCalculated = function() {
                    return [O_.RV, new SC({}), {
                        amount: 0,
                        key: Cn.COINS
                    }]
                }
                ,
                t.prototype.onPayedCalculated = function() {
                    return [O_.BUY, new SC({}), {
                        amount: 0,
                        key: Cn.COINS
                    }]
                }
                ,
                t
            }(gO), yO = function(e) {
                function t() {
                    var t = null !== e && e.apply(this, arguments) || this;
                    return t._alwaysReturnFreeTracker = !1,
                    t._currenNatureRemovalConfig = _e.FF_NATURE_REMOVAL_CONFIG,
                    t
                }
                return (0,
                n.__extends)(t, e),
                t.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return [4, Promise.all([this.services.assetLoader.loadJsons(_e.FF_ORDERS_CONFIG), this.services.assetLoader.loadJsons(this._currenNatureRemovalConfig), this.services.assetLoader.loadJsons(_e.FF_HARVEST_REGENERATION_CONFIG), this.services.assetLoader.loadJsons(_e.FF_GREENHOUSE_REGENERATION_CONFIG)])];
                            case 1:
                                return e.sent(),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                t.prototype.createTrackerForOnboarding = function(e) {
                    var t = this.services.timer.getTimerByID(e);
                    return new mO(t,this.services.resource.getJson(_e.FF_ORDERS_CONFIG))
                }
                ,
                t.prototype.createTrackerForOrders = function(e) {
                    return this._alwaysReturnFreeTracker ? this.createTrackerForOnboarding(e) : this._getTracker(e, _e.FF_ORDERS_CONFIG, "fastForwardOrder", Bp.FAST_FORWARD_ORDER)
                }
                ,
                t.prototype.createTrackerForNatureObjects = function(e) {
                    return this._getTracker(e, this._currenNatureRemovalConfig, "fastForwardNature", Bp.FAST_FORWARD_NATURE)
                }
                ,
                t.prototype.createTrackerForToolboxObjects = function(e) {
                    return this._getTracker(e, this._currenNatureRemovalConfig, "fastForwardToolbox", Bp.FAST_FORWARD_TOOLBOX)
                }
                ,
                t.prototype.createTrackerForRegeneration = function(e) {
                    return this._getTracker(e, _e.FF_HARVEST_REGENERATION_CONFIG, "fastForwardHarvest", Bp.FAST_FORWARD_HARVEST)
                }
                ,
                t.prototype.createTrackerForGreenhouse = function(e) {
                    return this._getTracker(e, _e.FF_GREENHOUSE_REGENERATION_CONFIG, "fastForwardGreenhouse", Bp.FAST_FORWARD_GREENHOUSE)
                }
                ,
                t.prototype.setFreeTrackerStatus = function(e) {
                    this._alwaysReturnFreeTracker = e
                }
                ,
                t.prototype._getTracker = function(e, t, i, r) {
                    var o = this.services.timer.getTimerByID(e)
                      , a = this.services.resource.getJson(t);
                    return new EO(o,(0,
                    n.__assign)({}, a),i,r)
                }
                ,
                t
            }(Se), TO = function() {
                function e() {
                    this._screenContainerElement = document.getElementById("rotate-device-container"),
                    this._imageElement = document.getElementById("rotate-device-image"),
                    this._screenContainerElement.style.visibility = "hidden"
                }
                return e.prototype.toggle = function() {
                    this._screenContainerElement.style.visibility = De.services.canvas.targetOrientation !== De.services.canvas.currentOrientation ? "visible" : "hidden"
                }
                ,
                e.prototype.start = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return v.EventManager.resizeScreen.addListener(this.toggle, this),
                            this._imageElement.src = CO.canvas.targetOrientation === v.Orientation.Landscape ? "raw_images/icon_rotatescreen_p2l.png" : "raw_images/icon_rotatescreen_l2p.png",
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.destroy = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            return v.EventManager.resizeScreen.removeListener(this.toggle, this),
                            [2]
                        }
                        ))
                    }
                    ))
                }
                ,
                e
            }(), AO = function() {
                function e() {}
                return Object.defineProperty(e.prototype, "assetLoader", {
                    get: function() {
                        return this._assetLoader
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "lazyLoad", {
                    get: function() {
                        return this._lazyLoad
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "rotateDeviceScreen", {
                    get: function() {
                        return this._rotateDeviceScreen
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "navigation", {
                    get: function() {
                        return this._navigation
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "resource", {
                    get: function() {
                        return this._resource
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "canvas", {
                    get: function() {
                        return this._canvas
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                Object.defineProperty(e.prototype, "analytics", {
                    get: function() {
                        return this._analytics
                    },
                    enumerable: !1,
                    configurable: !0
                }),
                e.prototype.destroyNonCriticalServices = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        return (0,
                        n.__generator)(this, (function(e) {
                            switch (e.label) {
                            case 0:
                                return (0,
                                r.isUndefined)(this._nonCriticalServices) ? [2] : [4, Promise.all(Object.values(this._nonCriticalServices).map((function(e) {
                                    return Oe(e) ? e.destroy() : Promise.resolve()
                                }
                                )))];
                            case 1:
                                return e.sent(),
                                this._nonCriticalServices = void 0,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.InitializeCriticalServices = function() {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var e, t, i, r;
                        return (0,
                        n.__generator)(this, (function(n) {
                            switch (n.label) {
                            case 0:
                                return e = window.innerWidth > window.innerHeight,
                                i = this,
                                [4, fp(t = {
                                    v: "1.46.0-1"
                                })];
                            case 1:
                                return i._runtimeSettings = n.sent(),
                                this._resource = new Wp,
                                this._assetLoader = new Kp(this._runtimeSettings,this._resource),
                                this._assetLoader.setQueryParams(t),
                                [4, this._assetLoader.loadJsonDictionary()];
                            case 2:
                                n.sent(),
                                n.label = 3;
                            case 3:
                                return this._lazyLoad = new En,
                                this._lazyLoad.initialize({
                                    assetLoader: this._assetLoader
                                }),
                                this._canvas = new ng(this._runtimeSettings.qualitySetting,this._runtimeSettings.assetManifest.designDimensions,e ? v.Orientation.Landscape : v.Orientation.Portrait,{
                                    preserveDrawingBuffer: !0
                                }),
                                this._lazyLoad.addGroups([{
                                    id: hn.SPLASH,
                                    assets: {
                                        atlases: [e ? g.SPLASH_LANDSCAPE : g.SPLASH_PORTRAIT],
                                        spines: [se.THROBBER_COW]
                                    }
                                }]),
                                this._setupLazyLoadGroups(),
                                r = new Xe.Container,
                                this._canvas.stage.addChild(r),
                                this._navigation = new aS(r),
                                this._rotateDeviceScreen = new TO,
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype.initializeAnalyticService = function() {
                    this._analytics = new jp
                }
                ,
                e.prototype.initialize = function(e, t, i) {
                    return (0,
                    n.__awaiter)(this, void 0, void 0, (function() {
                        var r, o, a, s, _, c, l, u, d, h, p, g, f, E, m, y, T, A, C, I, S, O, b, R, w, D, N, L, B, P, k, x, G, U, F, M, V, H, j, K, W, z, Y, J;
                        return (0,
                        n.__generator)(this, (function(X) {
                            switch (X.label) {
                            case 0:
                                return r = new lS,
                                o = new ig(e),
                                a = new Sv(i),
                                s = new TS(i,e),
                                _ = new qp,
                                c = new rg,
                                l = new Pe,
                                u = new _O(v.GroupsCore.Updateables,e),
                                d = new sg("InventoryModel",Object.values((0,
                                n.__assign)((0,
                                n.__assign)((0,
                                n.__assign)((0,
                                n.__assign)({}, Cn), Sn), An), In)),((J = {})[An.LEVEL] = 1,
                                J[Cn.ENERGY] = 50,
                                J[Cn.CRATES] = 60,
                                J)),
                                h = new Jp,
                                p = new AS,
                                g = new Qp,
                                f = new tv,
                                E = new iv,
                                m = new Zv,
                                y = new Av,
                                T = new yO,
                                A = new uO(t,e),
                                C = new wS(e.rewards),
                                I = new _S,
                                S = new sS,
                                O = new tr(vp.platform.adStrategies),
                                b = new lg,
                                R = new cg,
                                w = new Cv,
                                D = new vO,
                                N = new cO,
                                L = new hS,
                                B = new MS,
                                P = new Ip,
                                k = new Jv,
                                x = new Xp,
                                G = new $v,
                                U = new Tp,
                                F = new SS,
                                M = new LS,
                                V = new _g,
                                H = new kv(e),
                                j = new Ov,
                                K = new Du(e),
                                W = ze.USE_NAKAMA ? new Qv(e) : new qv(e),
                                z = {
                                    assetLoader: this._assetLoader,
                                    lazyLoad: this._lazyLoad,
                                    navigation: this._navigation,
                                    resource: this._resource,
                                    canvas: this._canvas,
                                    analytics: this._analytics
                                },
                                Y = {
                                    localization: l,
                                    transition: N,
                                    inventory: d,
                                    autosave: _,
                                    playerData: s,
                                    blueprintCollection: g,
                                    gameObjectFactory: f,
                                    recipes: p,
                                    buildings: y,
                                    experience: m,
                                    friends: o,
                                    adsService: O,
                                    cheats: w,
                                    timer: u,
                                    fastForward: T,
                                    token: C,
                                    visitorReward: D,
                                    notifications: I,
                                    notificationsObserver: S,
                                    imageExtract: c,
                                    npcService: r,
                                    connection: a,
                                    blueprintGraphService: E,
                                    audio: h,
                                    onboardingGameService: L,
                                    discovery: k,
                                    actions: P,
                                    tasks: B,
                                    pageVisibility: x,
                                    fps: G,
                                    iap: b,
                                    iframePopup: R,
                                    userFeedback: A,
                                    worldToLifeService: U,
                                    resourceRegeneration: F,
                                    settings: M,
                                    timedEventFetcherService: W,
                                    signInBonus: V,
                                    dailyBonusService: H,
                                    consent: j,
                                    nakamaConfigurationLoadService: K
                                },
                                this._nonCriticalServices = vp.platform.gameServiceProvider.getServices(Y, e),
                                De.addServices((0,
                                n.__assign)((0,
                                n.__assign)({}, this._nonCriticalServices), z)),
                                De.initialize(),
                                this._rotateDeviceScreen.start(),
                                this.analytics.design.startLoading(an.INITIALIZE_GAME_SERVICES),
                                [4, De.startServices([["connection", "playerData", "iap"], ["autosave", "canvas", "resource", "nakamaConfigurationLoadService"], ["settings"], ["imageExtract", "localization", "onboardingGameService", "worldToLifeService"], ["timer", "analytics", "inventory", "npcService", "friends", "audio", "recipes", "blueprintCollection", "experience", "adsService", "fps", "pageVisibility"], ["gameObjectFactory", "blueprintGraphService", "resourceRegeneration"], ["buildings", "fastForward", "lazyLoad", "discovery"], ["token", "notifications", "notificationsObserver", "navigation", "cheats", "userFeedback", "actions", "tasks"], ["visitorReward", "transition", "iframePopup", "timedEventFetcherService", "signInBonus", "consent", "dailyBonusService"]])];
                            case 1:
                                return X.sent(),
                                [4, De.services.consent.consentResult()];
                            case 2:
                                return X.sent() && (De.services.analytics.startSession(),
                                Zn.enableSentryLogging()),
                                De.services.lazyLoad.loadAllFonts(),
                                this.analytics.design.completeLoading(an.INITIALIZE_GAME_SERVICES),
                                [2]
                            }
                        }
                        ))
                    }
                    ))
                }
                ,
                e.prototype._setupLazyLoadGroups = function() {
                    var e = window.innerWidth > window.innerHeight;
                    this._lazyLoad.addGroups([{
                        id: hn.MAP_JSON,
                        assets: {
                            jsons: [{
                                alias: "map_facebook"
                            }, _e.CRATE_REGENERATION_CONFIG, _e.ENERGY_REGENERATION_CONFIG]
                        }
                    }, {
                        id: hn.MAP_RESOURCES,
                        assets: {
                            atlases: [g.MAP_RESOURCES]
                        }
                    }, {
                        id: hn.MAIN_SPINE_AND_SHARED_1,
                        assets: {
                            atlases: [g.SHARED]
                        }
                    }, {
                        id: hn.MAIN_UI,
                        assets: {
                            atlases: [g.UI]
                        }
                    }, {
                        id: hn.MAIN_HUD,
                        assets: {
                            atlases: [g.MAIN_HUD]
                        }
                    }, {
                        id: hn.UPGRADE_CARD,
                        assets: {
                            atlases: [g.UPGRADE_CARD]
                        }
                    }, {
                        id: hn.UPGRADE_CARD_OVERLAY,
                        assets: {
                            atlases: [g.UPGRADE_CARD_OVERLAY]
                        }
                    }, {
                        id: hn.INGREDIENTS,
                        assets: {
                            atlases: [g.INGREDIENTS]
                        }
                    }, {
                        id: hn.DISCONNECTION,
                        assets: {
                            spines: [se.THROBBER_LOOP]
                        }
                    }, {
                        id: hn.MAIN_SPINE_AND_SHARED_2,
                        assets: {
                            spines: [se.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP, se.CRATE_BUTTON, se.ORDER_HOURGLASS, se.NOTIFICATION_ATTENTION, se.SLEEP, se.AXE, se.PICK_AXE, se.CRATES_ADDED_UI, se.READY_TO_HARVEST, se.CRATE_SPAWN_ON_GRID, se.DUST_CLOUD, se.CLAIM_CURRENCY, se.REWARD_CRATES, se.REWARD_CRATES_CARROT, se.REWARD_CRATES_PUMPKIN, se.REWARD_CRATES_JINGLEBALLS, se.LOGIN_BONUS_GIFTBOX]
                        }
                    }, {
                        id: hn.DECALS,
                        assets: {
                            atlases: [g.DECALS]
                        }
                    }, {
                        id: hn.CUSTOM_UPDATE,
                        assets: {
                            atlases: [g.CU_IMAGES]
                        }
                    }, {
                        id: hn.SETTINGS_POPUP,
                        assets: {
                            atlases: [g.SETTINGS_POPUP, g.LANGUAGE_FLAGS],
                            jsons: [_e.LOCALIZATION_FLAGS_CONFIG]
                        }
                    }, {
                        id: hn.ORDERS_POPUP,
                        assets: {
                            atlases: [g.ORDERS_POPUP]
                        }
                    }, {
                        id: hn.MARKETPLACE,
                        assets: {
                            atlases: [g.MARKETPLACE]
                        }
                    }, {
                        id: hn.SHOVEL_POPUP,
                        assets: {
                            atlases: [g.SHOVEL_POPUP]
                        }
                    }, {
                        id: hn.SHOVEL_ANIMATION,
                        assets: {
                            spines: [se.SHOVEL]
                        }
                    }, {
                        id: hn.FRIENDS_FOR_CRATES,
                        assets: {
                            atlases: [g.FRIENDS_FOR_CRATES]
                        }
                    }, {
                        id: hn.TRANSITION_SCREEN,
                        assets: {
                            atlases: [e ? g.TRANSITIONSCREEN_LANDSCAPE : g.TRANSITIONSCREEN_PORTRAIT],
                            spines: [se.VISITFRIENDS_LOADING_INDICATOR]
                        }
                    }, {
                        id: hn.VISITOR_ACTIONS,
                        assets: {
                            atlases: [g.VISTOR_ACTIONS],
                            spines: [se.VISIT_FARM_PARTICLE]
                        }
                    }, {
                        id: hn.LEVEL_UP,
                        assets: {
                            atlases: [g.LEVELUPREWARDS],
                            spines: [se.LEVEL_UP_REWARDS_SEQUENCE, se.LEVEL_UP_REWARD_LIGHT_BEAM_LOOP]
                        }
                    }, {
                        id: hn.BUILDING_REPAIRED_ANIMATION,
                        assets: {
                            atlases: [g.REPAIR_DECORATIONS],
                            spines: [se.BUILDING_REPAIR]
                        }
                    }, {
                        id: hn.ONBOARDING,
                        assets: {
                            atlases: [g.ONBOARDING],
                            spines: [se.ONBOARDING_ARROW, se.HOW_TO_PLAY_ACTION, se.CONFETTI]
                        }
                    }, {
                        id: hn.CUSTOM_SHARE,
                        assets: {
                            atlases: [g.CS_IMAGES]
                        }
                    }, {
                        id: hn.TRAIN_STEAM,
                        assets: {
                            spines: [se.TRAIN_STEAM]
                        }
                    }, {
                        id: hn.DISCOVERY,
                        assets: {
                            atlases: [g.DISCOVERY],
                            spines: [se.GIFT_DISCOVERYBOOK, se.DISCOVERY_BOOK_ARROW],
                            jsons: [_e.DISCOVERY_TAB_DATA]
                        }
                    }, {
                        id: hn.FAKE_ADS,
                        assets: {
                            atlases: [g.FAKE_ADS]
                        }
                    }, {
                        id: hn.FREEBIE,
                        assets: {
                            atlases: [g.FREEBIE]
                        }
                    }, {
                        id: hn.PREMIUM_POPUP,
                        assets: {
                            atlases: [g.PREMIUM_POPUP]
                        }
                    }, {
                        id: hn.PREMIUM_LAND,
                        assets: {
                            atlases: [g.PREMIUM_LAND]
                        }
                    }, {
                        id: hn.HEAVY_OBJECT_OVERLAY,
                        assets: {
                            atlases: [g.HEAVY_OBJECT_OVERLAY]
                        }
                    }, {
                        id: hn.MUSIC,
                        assets: {
                            sounds: [E.MAIN_MUSIC_LOOP, E.AMBIENCE_FARM]
                        }
                    }, {
                        id: hn.SFX,
                        assets: {
                            sounds: [E.MAIN_MUSIC_LOOP, E.SFX]
                        }
                    }, {
                        id: hn.MERGE_EFFECT,
                        assets: {
                            spines: [se.MERGE_EFFECT]
                        }
                    }, {
                        id: hn.MERGE_BONUS_EFFECT,
                        assets: {
                            spines: [se.MERGE_BONUS_EFFECT, se.LUCKY_MERGE_EFFECT],
                            jsons: [_e.LUCKY_MERGE_CONFIG]
                        }
                    }, {
                        id: hn.OBJECT_REGENERATION,
                        assets: {
                            spines: [se.OBJECT_REGENERATION]
                        }
                    }, {
                        id: hn.BUILDING_PICKUP,
                        assets: {
                            spines: [se.PICKUP_BUILDING]
                        }
                    }, {
                        id: hn.GREENHOUSE,
                        assets: {
                            atlases: [g.GREENHOUSE]
                        }
                    }, {
                        id: hn.FLOWERS,
                        assets: {
                            atlases: [g.FLOWERS]
                        }
                    }, {
                        id: hn.GREENHOUSE_MERGE_CHAIN_INTRO,
                        assets: {
                            atlases: [g.GREENHOUSE_MERGE_CHAIN_INTRO]
                        }
                    }, {
                        id: hn.CONSENT,
                        assets: {
                            atlases: [g.CONSENT]
                        }
                    }, {
                        id: hn.EVENTS,
                        assets: {
                            atlases: [g.EVENTS_SHARED]
                        }
                    }, {
                        id: hn.EVENTS_CHOPCHOP,
                        assets: {
                            atlases: [g.EVENTS_CHOPCHOP]
                        }
                    }, {
                        id: hn.EVENTS_PIGGYBANK,
                        assets: {
                            atlases: [g.EVENTS_PIGGYBANK],
                            spines: [se.STAREFFECT]
                        }
                    }, {
                        id: hn.DAILY_BONUS,
                        assets: {
                            atlases: [g.DAILY_BONUS]
                        }
                    }, {
                        id: hn.EVENTS_GOLDENCARROT,
                        assets: {
                            atlases: [g.EVENTS_GOLDENCARROT]
                        }
                    }, {
                        id: hn.EVENTS_GOLDENPUMPKIN,
                        assets: {
                            atlases: [g.EVENTS_GOLDENPUMPKIN]
                        }
                    }, {
                        id: hn.EVENTS_GOLDENCHRISTMAS,
                        assets: {
                            atlases: [g.EVENTS_GOLDENCHRISTMAS]
                        }
                    }, {
                        id: hn.EVENTS_BLACKFRIDAY,
                        assets: {
                            atlases: [g.EVENTS_BLACKFRIDAY]
                        }
                    }, {
                        id: hn.EVENTS_CHRISTMAS_DEALS,
                        assets: {
                            atlases: [g.EVENTS_CHRISTMAS_DEALS]
                        }
                    }, {
                        id: hn.WORLD_TO_LIFE,
                        assets: {
                            jsons: [_e.WORLD_TO_LIFE_SETTINGS, _e.WORLD_TO_LIFE_ANIMATION_INCLUSION_RULES, _e.WORLD_TO_LIFE_ANIMATION_CHANCE_TO_SPAWN]
                        }
                    }, {
                        id: hn.RAIN,
                        assets: {
                            atlases: [g.RAIN],
                            spines: [se.RAIN_STREAK],
                            jsons: [_e.WORLD_TO_LIFE_RAIN_SETTINGS]
                        }
                    }, {
                        id: hn.SPECIAL_OFFER,
                        assets: {
                            jsons: [_e.SPECIAL_OFFER_CONFIG]
                        }
                    }, {
                        id: hn.DANDELION,
                        assets: {
                            atlases: [g.DANDELION],
                            jsons: [_e.WORLD_TO_LIFE_DANDELION_SETTINGS]
                        }
                    }, {
                        id: hn.WIND,
                        assets: {
                            atlases: [g.WIND],
                            jsons: [_e.WORLD_TO_LIFE_WIND_SETTINGS]
                        }
                    }, {
                        id: hn.BUTTERFLIES,
                        assets: {
                            atlases: [g.SHARED],
                            jsons: [_e.WORLD_TO_LIFE_BUTTERFLIES_SETTINGS],
                            spines: [se.BUTTERFLIES, se.BUTTERFLIES_ON_TILE]
                        }
                    }, {
                        id: hn.DAILY_CHALLENGE,
                        assets: {
                            atlases: [g.DAILY_CHALLENGE]
                        }
                    }, {
                        id: hn.AD_BLOCK,
                        assets: {
                            atlases: [g.AD_BLOCK]
                        }
                    }, {
                        id: hn.STORAGE,
                        assets: {
                            atlases: [g.STORAGE]
                        }
                    }, {
                        id: hn.CONTROLLED_RANDOMNESS,
                        assets: {
                            jsons: [_e.CONTROLLED_RANDOMNESS_CRATE_CONFIG, _e.CONTROLLED_RANDOMNESS_COINS_CONFIG, _e.CONTROLLED_RANDOMNESS_GEMS_CONFIG, _e.CONTROLLED_RANDOMNESS_ITEM_TIER_CONFIG, _e.CONTROLLED_RANDOMNESS_REWARD_CRATE_CONFIG, _e.CONTROLLED_RANDOMNESS_REWARD_CRATE_KEY_CONFIG]
                        }
                    }])
                }
                ,
                e
            }(), CO = new AO;
            function IO() {
                return (0,
                n.__awaiter)(this, void 0, void 0, (function() {
                    return (0,
                    n.__generator)(this, (function(e) {
                        switch (e.label) {
                        case 0:
                            return CO.navigation.closeAllPopups(),
                            CO.navigation.destroyAllLayers(),
                            [4, CO.destroyNonCriticalServices()];
                        case 1:
                            return e.sent(),
                            CO.analytics.destroy(),
                            CO.initializeAnalyticService(),
                            CO.navigation.resetCurrentSceneIndex(),
                            ze.reset(),
                            [4, CO.navigation.showSplash()];
                        case 2:
                            return e.sent(),
                            [2]
                        }
                    }
                    ))
                }
                ))
            }
            (0,
            n.__awaiter)(void 0, void 0, void 0, (function() {
                var e;
                return (0,
                n.__generator)(this, (function(t) {
                    switch (t.label) {
                    case 0:
                        return window.addEventListener("contextmenu", (function(e) {
                            return e.preventDefault(),
                            !1
                        }
                        ), !1),
                        function() {
                            (0,
                            n.__awaiter)(this, void 0, void 0, (function() {
                                return (0,
                                n.__generator)(this, (function(e) {
                                    switch (e.label) {
                                    case 0:
                                        return [4, Zn.start()];
                                    case 1:
                                        e.sent(),
                                        e.label = 2;
                                    case 2:
                                        return Ie.setLogLevel(Ae.ERROR),
                                        r.Logger.setLogLevel(r.LogLevel.ERROR),
                                        [2]
                                    }
                                }
                                ))
                            }
                            ))
                        }(),
                        CO.initializeAnalyticService(),
                        [4, CO.InitializeCriticalServices()];
                    case 1:
                        return t.sent(),
                        e = CO.lazyLoad.getLoadingPromise([hn.SPLASH, hn.MAIN_SPINE_AND_SHARED_1]),
                        [4, vp.platform.initializePlatform.initializeSDK(CO.analytics, e)];
                    case 2:
                        return t.sent(),
                        [4, CO.navigation.showSplash()];
                    case 3:
                        return t.sent(),
                        [2]
                    }
                }
                ))
            }
            ))
        }
    }, i = {};
    function n(e) {
        var r = i[e];
        if (void 0 !== r)
            return r.exports;
        var o = i[e] = {
            id: e,
            loaded: !1,
            exports: {}
        };
        return t[e].call(o.exports, o, o.exports, n),
        o.loaded = !0,
        o.exports
    }
    n.m = t,
    e = [],
    n.O = (t,i,r,o)=>{
        if (!i) {
            var a = 1 / 0;
            for (l = 0; l < e.length; l++) {
                for (var [i,r,o] = e[l], s = !0, _ = 0; _ < i.length; _++)
                    (!1 & o || a >= o) && Object.keys(n.O).every((e=>n.O[e](i[_]))) ? i.splice(_--, 1) : (s = !1,
                    o < a && (a = o));
                if (s) {
                    e.splice(l--, 1);
                    var c = r();
                    void 0 !== c && (t = c)
                }
            }
            return t
        }
        o = o || 0;
        for (var l = e.length; l > 0 && e[l - 1][2] > o; l--)
            e[l] = e[l - 1];
        e[l] = [i, r, o]
    }
    ,
    n.n = e=>{
        var t = e && e.__esModule ? ()=>e.default : ()=>e;
        return n.d(t, {
            a: t
        }),
        t
    }
    ,
    n.d = (e,t)=>{
        for (var i in t)
            n.o(t, i) && !n.o(e, i) && Object.defineProperty(e, i, {
                enumerable: !0,
                get: t[i]
            })
    }
    ,
    n.g = function() {
        if ("object" == typeof globalThis)
            return globalThis;
        try {
            return this || new Function("return this")()
        } catch (e) {
            if ("object" == typeof window)
                return window
        }
    }(),
    n.hmd = e=>((e = Object.create(e)).children || (e.children = []),
    Object.defineProperty(e, "exports", {
        enumerable: !0,
        set: ()=>{
            throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: " + e.id)
        }
    }),
    e),
    n.o = (e,t)=>Object.prototype.hasOwnProperty.call(e, t),
    n.r = e=>{
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
            value: "Module"
        }),
        Object.defineProperty(e, "__esModule", {
            value: !0
        })
    }
    ,
    (()=>{
        var e = {
            179: 0
        };
        n.O.j = t=>0 === e[t];
        var t = (t,i)=>{
            var r, o, [a,s,_] = i, c = 0;
            if (a.some((t=>0 !== e[t]))) {
                for (r in s)
                    n.o(s, r) && (n.m[r] = s[r]);
                if (_)
                    var l = _(n)
            }
            for (t && t(i); c < a.length; c++)
                o = a[c],
                n.o(e, o) && e[o] && e[o][0](),
                e[o] = 0;
            return n.O(l)
        }
          , i = self.webpackChunkfarm_merge = self.webpackChunkfarm_merge || [];
        i.forEach(t.bind(null, 0)),
        i.push = t.bind(null, i.push.bind(i))
    }
    )();
    var r = n.O(void 0, [531, 863, 466], (()=>n(9529)));
    r = n.O(r)
}
)();
